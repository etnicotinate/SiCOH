LAMMPS (2 Aug 2023 - Update 2)
  using 6 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs


variable       Tl equal 300.0   # low temperature
variable       Th equal 2200.0  # high temperature
variable       Td equal 50.0  # damping time
variable       Ph equal 10.0  # damping time
variable       nrun equal 100  # number of steps
variable       nequil equal 5*${nrun}  # 30
variable       nequil equal 5*100  
variable       nheat equal 5*${nrun}   # 30
variable       nheat equal 5*100   
# variable       ncool equal 60*${nrun}  # 60
variable       nthermo equal ${nrun}
variable       nthermo equal 100

# Read the initial sctructure (without suffix)
box tilt large

The 'box' command has been removed and will be ignored

variable structure string 333SiCOH
read_data       ${structure}.data
read_data       333SiCOH.data
Reading data file ...
  triclinic box = (0 0 0) to (19.0492 14.0575 17.55) with tilt (-10.7944 1.3894 -3.3406)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  1 by 1 by 2 MPI processor grid
  reading atoms ...
  373 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_data CPU = 0.009 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff C H O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

fix myask2 all acks2/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
fix bondinfo all reaxff/bonds 100 bonds.reaxff

neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Print system info
thermo          ${nthermo}
thermo          100
thermo_style    custom step temp press density vol


# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
fix min1 all nve
minimize 1.0e-6 1.0e-6 100 1000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix acks2/reaxff command: doi:10.1137/18M1224684

@Article{O'Hearn2020,
 author = {K. A. {O'Hearn} and A. Alperen and H. M. Aktulga},
 title = {Fast Solvers for Charge Distribution Models on Shared Memory Platforms},
 journal = {SIAM J.\ Sci.\ Comput.},
 year =    2020,
 volume =  42,
 number =  1,
 pages =   {1--22}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Switching to 'neigh_modify every 1 delay 0 check yes' setting during minimization
WARNING: Fix acks2/reaxff group is not charge neutral, net charge = 39.36 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 6 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix acks2/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 207.1 | 207.4 | 207.6 Mbytes
   Step          Temp          Press         Density         Volume    
         0   0              150465.82      1.1428982      4699.6115    
       100   0             -2760.5561      1.1428982      4699.6115    
Loop time of 13.1562 on 12 procs for 100 steps with 373 atoms

92.5% CPU use with 2 MPI tasks x 6 OpenMP threads

Minimization stats:
  Stopping criterion = max iterations
  Energy initial, next-to-last, final = 
     -32999.2561692292  -35589.2985621279   -35590.038552019
  Force two-norm initial, final = 2383.4149 102.07902
  Force max component initial, final = 750.18956 37.94433
  Final line search alpha, max atom move = 0.0034793344 0.13202101
  Iterations, force evaluations = 100 216

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 5.6436     | 5.707      | 5.7704     |   2.7 | 43.38
Bond    | 3.1309e-05 | 3.954e-05  | 4.7771e-05 |   0.0 |  0.00
Neigh   | 0.030586   | 0.031314   | 0.032041   |   0.4 |  0.24
Comm    | 0.02604    | 0.089463   | 0.15289    |  21.2 |  0.68
Output  | 4.0243e-05 | 4.7724e-05 | 5.5206e-05 |   0.0 |  0.00
Modify  | 7.3226     | 7.3233     | 7.324      |   0.0 | 55.66
Other   |            | 0.005046   |            |       |  0.04

Nlocal:          186.5 ave         189 max         184 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:           4807 ave        4809 max        4805 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:        94913.5 ave       96205 max       93622 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 189827
Ave neighs/atom = 508.91957
Ave special neighs/atom = 0
Neighbor list builds = 1
Dangerous builds not checked
unfix min1
reset_timestep 0
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333SiCOH_opt.data
System init for write_data ...

# Save trajectory
#dump dump1 all custom 500 dump_opt.lammpstrj id type x y z q
dump dump1 all custom ${nthermo} dump_all.lammpstrj   id   type  q x y z
dump dump1 all custom 100 dump_all.lammpstrj   id   type  q x y z
# dump dump2 all dcd ${nthermo} dump.dcd

# equilibration at low T
print "*****Equilibration starts.*****"
*****Equilibration starts.*****
velocity        all create ${Tl} 12345
velocity        all create 300 12345
fix             equil1 all npt temp ${Tl} ${Tl} ${Td} tri ${Ph} ${Ph} ${Td}
fix             equil1 all npt temp 300 ${Tl} ${Td} tri ${Ph} ${Ph} ${Td}
fix             equil1 all npt temp 300 300 ${Td} tri ${Ph} ${Ph} ${Td}
fix             equil1 all npt temp 300 300 50 tri ${Ph} ${Ph} ${Td}
fix             equil1 all npt temp 300 300 50 tri 10 ${Ph} ${Td}
fix             equil1 all npt temp 300 300 50 tri 10 10 ${Td}
fix             equil1 all npt temp 300 300 50 tri 10 10 50
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
run             ${nequil}
run             500
Per MPI rank memory allocation (min/avg/max) = 205.5 | 205.8 | 206.1 Mbytes
   Step          Temp          Press         Density         Volume    
         0   300            475.15261      1.1428982      4699.6115    
       100   227.72582     -6652.4683      1.1392971      4714.466     
       200   292.12382      3522.8765      1.1152877      4815.9569    
       300   333.87784      2965.4737      1.0976244      4893.457     
       400   323.74879      5084.0414      1.0968198      4897.0467    
       500   325.43068     -6214.5245      1.0626755      5054.3909    
Loop time of 41.1802 on 12 procs for 500 steps with 373 atoms

Performance: 0.525 ns/day, 45.756 hours/ns, 12.142 timesteps/s, 4.529 katom-step/s
93.3% CPU use with 2 MPI tasks x 6 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 19.148     | 19.234     | 19.321     |   2.0 | 46.71
Bond    | 0.00010822 | 0.00011867 | 0.00012911 |   0.0 |  0.00
Neigh   | 1.861      | 1.8916     | 1.9222     |   2.2 |  4.59
Comm    | 0.15718    | 0.24414    | 0.33109    |  17.6 |  0.59
Output  | 0.003298   | 0.0043035  | 0.0053091  |   1.5 |  0.01
Modify  | 19.765     | 19.794     | 19.823     |   0.7 | 48.07
Other   |            | 0.01158    |            |       |  0.03

Nlocal:          186.5 ave         196 max         177 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:         4443.5 ave        4444 max        4443 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:        87401.5 ave       91436 max       83367 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 174803
Ave neighs/atom = 468.64075
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked

# Heat to high T
print "*****Heating starts.*****"
*****Heating starts.*****
unfix           equil1
fix             heat1 all npt temp ${Tl} ${Th} ${Td} tri ${Ph} ${Ph} ${Td}
fix             heat1 all npt temp 300 ${Th} ${Td} tri ${Ph} ${Ph} ${Td}
fix             heat1 all npt temp 300 2200 ${Td} tri ${Ph} ${Ph} ${Td}
fix             heat1 all npt temp 300 2200 50 tri ${Ph} ${Ph} ${Td}
fix             heat1 all npt temp 300 2200 50 tri 10 ${Ph} ${Td}
fix             heat1 all npt temp 300 2200 50 tri 10 10 ${Td}
fix             heat1 all npt temp 300 2200 50 tri 10 10 50
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
run             ${nheat}
run             500
Per MPI rank memory allocation (min/avg/max) = 206.1 | 206.5 | 207 Mbytes
   Step          Temp          Press         Density         Volume    
       500   325.43068     -6214.5195      1.0626755      5054.3909    
       600   390.82399     -3596.7192      1.0913625      4921.534     
WARNING: Fix acks2/reaxff BiCGStab convergence failed after 400 iterations at step 676 (src/REAXFF/fix_acks2_reaxff.cpp:606)
WARNING: Fix acks2/reaxff BiCGStab convergence failed after 400 iterations at step 677 (src/REAXFF/fix_acks2_reaxff.cpp:606)
       700   465.21394     -6884.3872      1.0957908      4901.6449    
WARNING: Fix acks2/reaxff BiCGStab convergence failed after 400 iterations at step 701 (src/REAXFF/fix_acks2_reaxff.cpp:606)
WARNING: Fix acks2/reaxff BiCGStab convergence failed after 400 iterations at step 702 (src/REAXFF/fix_acks2_reaxff.cpp:606)
WARNING: Fix acks2/reaxff BiCGStab convergence failed after 400 iterations at step 703 (src/REAXFF/fix_acks2_reaxff.cpp:606)
WARNING: Fix acks2/reaxff BiCGStab convergence failed after 400 iterations at step 704 (src/REAXFF/fix_acks2_reaxff.cpp:606)
       800   548.1315      -3313.2325      1.0741951      5000.1881    
       900   755.35097      15309.748      1.0765932      4989.0501    
WARNING: Fix acks2/reaxff BiCGStab convergence failed after 400 iterations at step 1000 (src/REAXFF/fix_acks2_reaxff.cpp:606)
      1000   980.32104     -464.32738      1.0930239      4914.0533    
Loop time of 44.0174 on 12 procs for 500 steps with 373 atoms

Performance: 0.491 ns/day, 48.908 hours/ns, 11.359 timesteps/s, 4.237 katom-step/s
92.8% CPU use with 2 MPI tasks x 6 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 19.884     | 19.927     | 19.97      |   1.0 | 45.27
Bond    | 0.00010769 | 0.00010943 | 0.00011116 |   0.0 |  0.00
Neigh   | 1.7359     | 1.7492     | 1.7625     |   1.0 |  3.97
Comm    | 0.21642    | 0.25895    | 0.30148    |   8.4 |  0.59
Output  | 0.0032701  | 0.0042862  | 0.0053022  |   1.6 |  0.01
Modify  | 22.054     | 22.066     | 22.078     |   0.3 | 50.13
Other   |            | 0.01158    |            |       |  0.03

Nlocal:          186.5 ave         188 max         185 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Nghost:         4249.5 ave        4279 max        4220 min
Histogram: 1 0 0 0 0 0 0 0 0 1
Neighs:          90460 ave       91465 max       89455 min
Histogram: 1 0 0 0 0 0 0 0 0 1

Total # of neighbors = 180920
Ave neighs/atom = 485.04021
Ave special neighs/atom = 0
Neighbor list builds = 50
Dangerous builds not checked














# # middle equilibration at high T
# print "*****Middle equilibration starts.*****"
# velocity        all create ${Tl} 12345
# unfix             heat1
# fix             equil2 all npt temp ${Th} ${Th} ${Td} tri 1.0 1.0 ${Td}
# # 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
# run             ${nequil}

# # cool down to low T
# print "*****Cooling starts.*****"
# unfix           equil2
# fix             cool1 all npt temp ${Th} ${Tl} ${Td} tri 1.0 1.0 ${Td}
# # 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
# run             ${ncool}

# # final equilibration at low T
# print "*****final equilibration starts.*****"
# unfix             cool1
# fix             equil3 all npt temp ${Tl} ${Tl} ${Td} tri 1.0 1.0 ${Td}
# # 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
# run             ${nequil}

# write_data ${structure}-an.data


Total wall time: 0:01:38
