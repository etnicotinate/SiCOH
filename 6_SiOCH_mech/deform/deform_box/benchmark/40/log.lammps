LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 40*${nthermo}       # steps of equilibration run 10
variable nequil equal 40*100       
variable nrun equal 40*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 40*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-EXP-11-vasp
read_data       ${structure}.data
read_data       333-EXP-11-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.008 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.364 | 6.364 | 6.364 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 8.32159e-05 on 8 procs for 1 steps with 274 atoms

55.3% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.118e-06  | 2.0256e-06 | 2.863e-06  |   0.0 |  2.43
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 3.701e-06  | 4.8625e-06 | 6.426e-06  |   0.0 |  5.84
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 7.633e-05  |            |       | 91.72

Nlocal:          34.25 ave          40 max          23 min
Histogram: 1 0 0 0 0 0 2 3 1 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-EXP-11-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
run ${nequil}
run 4000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -8.2 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109.8 | 110.8 | 111.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -29524.072      53373.102      1.4594291      3472.1201    
       100   940.83325     -30895.433     -22221.566      1.4594291      3472.1201    
       200   655.32859     -31410.555     -8415.0945      1.4594291      3472.1201    
       300   492.44705     -31703.584     -1794.1004      1.4594291      3472.1201    
       400   382.80684     -31863.571     -399.08344      1.4594291      3472.1201    
       500   340.51122     -31988.881     -4396.9622      1.4594291      3472.1201    
       600   278.76054     -32030.093     -12030.124      1.4594291      3472.1201    
       700   252.54387     -32039.073     -16008.085      1.4594291      3472.1201    
       800   303.17696     -32059.227     -7196.0812      1.4594291      3472.1201    
       900   316.31868     -32035.623      1880.9547      1.4594291      3472.1201    
      1000   302.25251     -32011.681      399.58501      1.4594291      3472.1201    
      1100   315.72134     -32030.621     -1937.705       1.4594291      3472.1201    
      1200   304.92451     -32062.996     -4858.2292      1.4594291      3472.1201    
      1300   271.27974     -32068.968     -12188.651      1.4594291      3472.1201    
      1400   282.30555     -32083.975     -5263.1535      1.4594291      3472.1201    
      1500   284.15138     -32063.957     -2027.0405      1.4594291      3472.1201    
      1600   304.84901     -32054.903     -8468.5027      1.4594291      3472.1201    
      1700   320.05144     -32056.724     -12833.076      1.4594291      3472.1201    
      1800   304.8515      -32060.022     -6647.9777      1.4594291      3472.1201    
      1900   292.71773     -32083.757     -1193.4113      1.4594291      3472.1201    
      2000   272.13786     -32083.142      6047.8677      1.4594291      3472.1201    
      2100   289.96718     -32084.631      9390.5456      1.4594291      3472.1201    
      2200   287.75492     -32058.426     -9151.3398      1.4594291      3472.1201    
      2300   335.25197     -32079.165     -16200.698      1.4594291      3472.1201    
      2400   310.32653     -32067.983      2160.6232      1.4594291      3472.1201    
      2500   290.62987     -32076.478     -2874.5909      1.4594291      3472.1201    
      2600   291.63604     -32096.204      1291.0485      1.4594291      3472.1201    
      2700   278.45821     -32085.212      2152.4342      1.4594291      3472.1201    
      2800   295.16014     -32075.293      11384.18       1.4594291      3472.1201    
      2900   321.3704      -32074.659      4968.7777      1.4594291      3472.1201    
      3000   317.98161     -32069.827      4987.1493      1.4594291      3472.1201    
      3100   315.69129     -32093.196     -2919.9481      1.4594291      3472.1201    
      3200   272.69984     -32080.299     -10479.085      1.4594291      3472.1201    
      3300   295.4357      -32094.378     -2307.7923      1.4594291      3472.1201    
      3400   306.68136     -32082.661      166.83382      1.4594291      3472.1201    
      3500   303.62197     -32071.67      -7119.6858      1.4594291      3472.1201    
      3600   295.73041     -32073.133     -3795.8248      1.4594291      3472.1201    
      3700   277.22679     -32074.502     -11588.427      1.4594291      3472.1201    
      3800   297.79238     -32096.778     -7570.1459      1.4594291      3472.1201    
      3900   281.6086      -32077.626     -6662.3657      1.4594291      3472.1201    
      4000   300.60001     -32070.467      2359.5495      1.4594291      3472.1201    
Loop time of 152.223 on 8 procs for 4000 steps with 274 atoms

Performance: 1.135 ns/day, 21.142 hours/ns, 26.277 timesteps/s, 7.200 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 89.638     | 113.75     | 128.05     | 137.2 | 74.73
Bond    | 0.010796   | 0.011614   | 0.0123     |   0.5 |  0.01
Neigh   | 6.3743     | 8.0926     | 8.988      |  34.3 |  5.32
Comm    | 1.9684     | 16.287     | 40.382     | 362.6 | 10.70
Output  | 0.0020514  | 0.002239   | 0.0034354  |   1.0 |  0.00
Modify  | 13.116     | 13.996     | 15.739     |  26.2 |  9.19
Other   |            | 0.08135    |            |       |  0.05

Nlocal:          34.25 ave          44 max          26 min
Histogram: 3 0 0 0 1 1 0 1 1 1
Nghost:        2830.75 ave        2851 max        2814 min
Histogram: 2 0 1 1 1 0 0 2 0 1
Neighs:        18945.9 ave       23992 max       14588 min
Histogram: 3 0 0 0 1 1 0 1 0 2

Total # of neighbors = 151567
Ave neighs/atom = 553.16423
Ave special neighs/atom = 0
Neighbor list builds = 400
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333-EXP-11-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.8189
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 12.842
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 16.0755

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.4312
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 1.195
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -8.3798

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 16.8189
variable dlen equal lx-${len0}
variable dlen equal lx-16.8189
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.8189
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.168189 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.168189 xy delta 0.083798 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.168189 xy delta 0.083798 xz delta -0.01195 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 4000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 110 | 110.4 | 110.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300.60001     -32070.467      2359.5288      1.4594291      3472.1201    
       100   294.07811     -32057.601      5641.5768      1.459794       3471.2521    
       200   302.44983     -32074.498     -17531.795      1.4601592      3470.3841    
       300   302.50127     -32078.006      7591.7521      1.4605245      3469.516     
       400   309.93431     -32084.071      2333.0225      1.46089        3468.648     
       500   325.00652     -32094.127     -3590.5673      1.4612557      3467.78      
       600   297.59655     -32073.532     -6149.5195      1.4616215      3466.912     
       700   316.00878     -32094.853     -4217.6709      1.4619876      3466.0439    
       800   284.67457     -32078.716     -1793.9675      1.4623538      3465.1759    
       900   291.32369     -32088.785      4236.9415      1.4627202      3464.3079    
      1000   298.04108     -32086.976     -3706.9354      1.4630868      3463.4398    
      1100   308.67952     -32086.042      3428.5633      1.4634536      3462.5718    
      1200   301.02538     -32076.055     -8813.9252      1.4638206      3461.7038    
      1300   302.48576     -32080.665     -10801.27       1.4641877      3460.8357    
      1400   302.94133     -32088.204      925.21664      1.464555       3459.9677    
      1500   289.52448     -32085.775     -11349.844      1.4649226      3459.0997    
      1600   287.36409     -32079.032     -12351.376      1.4652903      3458.2317    
      1700   318.03415     -32094.666     -4248.5227      1.4656581      3457.3636    
      1800   299.38239     -32077.462      3178.7406      1.4660262      3456.4956    
      1900   285.18349     -32059.35      -3408.601       1.4663945      3455.6276    
      2000   315.79681     -32077.196     -2447.1365      1.4667629      3454.7595    
      2100   310.21206     -32081.136     -10814.864      1.4671315      3453.8915    
      2200   285.66197     -32074.017     -9876.201       1.4675003      3453.0235    
      2300   295.58978     -32091.284      1973.4668      1.4678693      3452.1554    
      2400   299.08621     -32096.257     -2740.7186      1.4682385      3451.2874    
      2500   299.65767     -32092.542     -12883.926      1.4686079      3450.4194    
      2600   280.66933     -32063.174     -1041.4085      1.4689775      3449.5514    
      2700   309.1507      -32082.093     -2002.7439      1.4693472      3448.6833    
      2800   310.58635     -32093.814     -9599.5142      1.4697171      3447.8153    
      2900   284.00376     -32083.457      4896.8012      1.4700872      3446.9473    
      3000   280.04545     -32079.326      6762.4158      1.4704575      3446.0792    
      3100   306.93912     -32092.452      10693.767      1.470828       3445.2112    
      3200   326.50441     -32114.23       3890.4481      1.4711987      3444.3432    
      3300   297.21407     -32111.169     -12535.237      1.4715695      3443.4751    
      3400   294.3885      -32112.069     -1401.5439      1.4719406      3442.6071    
      3500   314.41675     -32107.519     -3378.071       1.4723118      3441.7391    
      3600   323.42244     -32091.237      7174.1457      1.4726832      3440.8711    
      3700   331.19928     -32104.481     -2670.9239      1.4730549      3440.003     
      3800   306.39788     -32110.671     -1993.4654      1.4734267      3439.135     
      3900   302.64942     -32112.279      5221.2816      1.4737986      3438.267     
      4000   295.36324     -32107.26      -5452.6886      1.4741708      3437.3989    
Loop time of 157.501 on 8 procs for 4000 steps with 274 atoms

Performance: 1.097 ns/day, 21.875 hours/ns, 25.397 timesteps/s, 6.959 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 92.381     | 117.09     | 132.48     | 145.9 | 74.34
Bond    | 0.010254   | 0.011514   | 0.012867   |   0.8 |  0.01
Neigh   | 6.3358     | 8.219      | 9.2627     |  39.4 |  5.22
Comm    | 1.7391     | 17.148     | 41.856     | 381.2 | 10.89
Output  | 0.010833   | 0.012481   | 0.013837   |   1.0 |  0.01
Modify  | 13.91      | 14.939     | 16.826     |  29.4 |  9.49
Other   |            | 0.08575    |            |       |  0.05

Nlocal:          34.25 ave          41 max          25 min
Histogram: 2 1 0 0 0 0 1 0 1 3
Nghost:           2816 ave        2824 max        2793 min
Histogram: 1 0 0 0 0 0 1 0 3 3
Neighs:        19152.6 ave       22651 max       14214 min
Histogram: 2 1 0 0 0 0 0 1 1 3

Total # of neighbors = 153221
Ave neighs/atom = 559.20073
Ave special neighs/atom = 0
Neighbor list builds = 400
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.8189
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.168189 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.168189 xy delta -0.083798 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.168189 xy delta -0.083798 xz delta 0.01195 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 4000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 110 | 110.4 | 110.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300.60001     -32070.467      2359.5288      1.4594291      3472.1201    
       100   294.04208     -32057.638      5649.2838      1.4590643      3472.9882    
       200   301.02685     -32072.858     -15366.665      1.4586997      3473.8562    
       300   302.726       -32078.284      5904.9762      1.4583353      3474.7242    
       400   309.28907     -32082.107      4104.3671      1.4579711      3475.5923    
       500   312.73222     -32085.271     -8219.4701      1.4576071      3476.4603    
       600   296.38026     -32078.875     -5217.5643      1.4572432      3477.3283    
       700   311.72694     -32100.007     -363.93873      1.4568796      3478.1963    
       800   295.74696     -32096.012     -7205.1816      1.4565161      3479.0644    
       900   289.77126     -32097.667      4357.5885      1.4561528      3479.9324    
      1000   283.96956     -32080.739     -3960.1765      1.4557896      3480.8004    
      1100   294.41147     -32070.992     -3439.8446      1.4554267      3481.6685    
      1200   306.12731     -32066.757     -2293.2476      1.4550639      3482.5365    
      1300   282.86318     -32057.967      2485.2451      1.4547013      3483.4045    
      1400   295.78498     -32092.042     -3643.1378      1.4543389      3484.2726    
      1500   289.98482     -32100.012     -16153.005      1.4539767      3485.1406    
      1600   308.21726     -32110.102     -15688.649      1.4536146      3486.0086    
      1700   305.76168     -32092.366      689.24822      1.4532528      3486.8766    
      1800   309.22557     -32079.875     -13319.808      1.4528911      3487.7447    
      1900   300.33314     -32065.437     -13862.625      1.4525296      3488.6127    
      2000   287.51821     -32060.707     -3962.7279      1.4521683      3489.4807    
      2100   288.61995     -32075.89      -17292.198      1.4518071      3490.3488    
      2200   273.82113     -32077.219     -8129.7275      1.4514461      3491.2168    
      2300   299.06401     -32091.902     -11865.396      1.4510854      3492.0848    
      2400   317.94594     -32088.357     -10637.893      1.4507247      3492.9529    
      2500   318.50586     -32081.079     -1548.7873      1.4503643      3493.8209    
      2600   309.75563     -32083.002     -14614.766      1.4500041      3494.6889    
      2700   294.56849     -32082.186     -4466.3942      1.449644       3495.5569    
      2800   277.43085     -32075.517     -8556.4477      1.4492841      3496.425     
      2900   298.33669     -32091.278     -1845.0784      1.4489244      3497.293     
      3000   299.80996     -32079.789     -7859.765       1.4485649      3498.161     
      3100   299.7001      -32063.961     -4628.3751      1.4482055      3499.0291    
      3200   311.33537     -32077.512     -1140.0405      1.4478463      3499.8971    
      3300   291.81938     -32088.914      3281.6517      1.4474873      3500.7651    
      3400   307.75329     -32104.733      215.45475      1.4471285      3501.6332    
      3500   281.5631      -32078.109     -11779.731      1.4467699      3502.5012    
      3600   296.43754     -32084.754      1558.8736      1.4464114      3503.3692    
      3700   310.6045      -32095.746     -4107.1322      1.4460531      3504.2372    
      3800   299.25675     -32086.112      4102.1044      1.445695       3505.1053    
      3900   286.10663     -32083.847     -5041.7193      1.4453371      3505.9733    
      4000   284.6925      -32110.695     -11789.982      1.4449793      3506.8413    
Loop time of 152.526 on 8 procs for 4000 steps with 274 atoms

Performance: 1.133 ns/day, 21.184 hours/ns, 26.225 timesteps/s, 7.186 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.011     | 108.19     | 128.14     | 161.2 | 70.93
Bond    | 0.011065   | 0.011948   | 0.013066   |   0.6 |  0.01
Neigh   | 6.3099     | 7.7359     | 8.994      |  40.0 |  5.07
Comm    | 2.298      | 22.265     | 42.48      | 355.6 | 14.60
Output  | 0.011604   | 0.01329    | 0.014635   |   1.0 |  0.01
Modify  | 12.978     | 14.215     | 15.65      |  29.5 |  9.32
Other   |            | 0.09007    |            |       |  0.06

Nlocal:          34.25 ave          44 max          18 min
Histogram: 1 0 0 1 1 0 1 2 0 2
Nghost:        2797.38 ave        2824 max        2760 min
Histogram: 2 0 0 0 1 1 0 1 1 2
Neighs:        18730.6 ave       23836 max       10071 min
Histogram: 1 0 0 1 1 0 1 2 0 2

Total # of neighbors = 149845
Ave neighs/atom = 546.87956
Ave special neighs/atom = 0
Neighbor list builds = 400
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 12.842
variable dlen equal ly-${len0}
variable dlen equal ly-12.842
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.842
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.12842 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.12842 yz delta -0.004312 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 4000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 110 | 110.4 | 110.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300.60001     -32070.467      2359.5288      1.4594291      3472.1201    
       100   294.1014      -32057.619      5626.6769      1.459794       3471.2521    
       200   301.47995     -32073.866     -16330.087      1.4601592      3470.3841    
       300   306.37667     -32081.59       7212.432       1.4605245      3469.516     
       400   313.63298     -32086.08       898.93996      1.46089        3468.648     
       500   312.68749     -32084.057     -2530.6201      1.4612557      3467.78      
       600   281.14031     -32062.039     -4040.0995      1.4616215      3466.912     
       700   303.48169     -32091.861     -427.65499      1.4619876      3466.0439    
       800   284.12232     -32090.817      836.18883      1.4623538      3465.1759    
       900   274.75465     -32086.152      7681.56        1.4627202      3464.3079    
      1000   286.71425     -32079.978     -2543.2215      1.4630868      3463.4398    
      1100   327.8931      -32090.564     -6170.0826      1.4634536      3462.5718    
      1200   310.31595     -32071.865      951.06599      1.4638206      3461.7038    
      1300   304.09338     -32080.649     -3749.1898      1.4641877      3460.8357    
      1400   295.76296     -32096.348     -2844.2937      1.464555       3459.9677    
      1500   283.45428     -32095.75      -4626.3797      1.4649226      3459.0997    
      1600   299.90117     -32099.033     -12106.768      1.4652903      3458.2317    
      1700   310.18809     -32101.366     -9272.4856      1.4656581      3457.3636    
      1800   277.98274     -32074.486     -18954.023      1.4660262      3456.4956    
      1900   320.59713     -32098.836      1463.5497      1.4663945      3455.6276    
      2000   301.49139     -32081.694     -8.6688379      1.4667629      3454.7595    
      2100   301.83664     -32094.163      5093.9932      1.4671315      3453.8915    
      2200   295.07587     -32094.178     -8897.8085      1.4675003      3453.0235    
      2300   288.3983      -32085.336     -7637.7366      1.4678693      3452.1554    
      2400   322.49439     -32098.592     -4446.2454      1.4682385      3451.2874    
      2500   314.23132     -32095.331      382.49193      1.4686079      3450.4194    
      2600   293.98078     -32094.017      1245.5206      1.4689775      3449.5514    
      2700   289.2383      -32096.319     -4742.5968      1.4693472      3448.6833    
      2800   290.35006     -32088.294     -2311.3534      1.4697171      3447.8153    
      2900   317.74636     -32094.612     -3876.485       1.4700872      3446.9473    
      3000   322.95242     -32085.108     -2907.2111      1.4704575      3446.0792    
      3100   323.55888     -32085.823     -5685.3979      1.470828       3445.2112    
      3200   303.59081     -32093.504     -8656.2631      1.4711987      3444.3432    
      3300   282.31243     -32097.058     -5844.8859      1.4715695      3443.4751    
      3400   287.99847     -32094.436     -7968.2143      1.4719406      3442.6071    
      3500   306.39775     -32090.834      2269.1915      1.4723118      3441.7391    
      3600   296.49184     -32076.519      4532.2243      1.4726832      3440.8711    
      3700   282.72741     -32072.074     -9982.764       1.4730549      3440.003     
      3800   279.54781     -32070.846      19.444821      1.4734267      3439.135     
      3900   324.22926     -32079.896     -5544.1007      1.4737986      3438.267     
      4000   347.47817     -32076.674     -1021.277       1.4741708      3437.3989    
Loop time of 156.927 on 8 procs for 4000 steps with 274 atoms

Performance: 1.101 ns/day, 21.795 hours/ns, 25.490 timesteps/s, 6.984 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 92.037     | 116.25     | 131.87     | 142.9 | 74.08
Bond    | 0.010349   | 0.011675   | 0.013155   |   0.8 |  0.01
Neigh   | 6.368      | 8.2309     | 9.2179     |  40.3 |  5.25
Comm    | 1.9508     | 17.572     | 41.788     | 367.6 | 11.20
Output  | 0.010824   | 0.012523   | 0.013935   |   1.0 |  0.01
Modify  | 13.772     | 14.761     | 16.63      |  30.3 |  9.41
Other   |            | 0.08536    |            |       |  0.05

Nlocal:          34.25 ave          42 max          20 min
Histogram: 1 0 0 1 0 1 2 0 1 2
Nghost:        2846.25 ave        2873 max        2822 min
Histogram: 2 0 1 0 1 2 0 0 0 2
Neighs:        19148.2 ave       23293 max       11415 min
Histogram: 1 0 0 1 0 1 2 0 1 2

Total # of neighbors = 153186
Ave neighs/atom = 559.07299
Ave special neighs/atom = 0
Neighbor list builds = 400
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.842
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.12842 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.12842 yz delta 0.004312 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 4000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 110 | 110.4 | 110.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300.60001     -32070.467      2359.5288      1.4594291      3472.1201    
       100   294.0083      -32057.63       5654.794       1.4590643      3472.9882    
       200   301.44358     -32073.538     -18610.196      1.4586997      3473.8562    
       300   303.04403     -32078.501      6309.7479      1.4583353      3474.7242    
       400   310.33797     -32082.664      4989.72        1.4579711      3475.5923    
       500   313.35238     -32084.157      63.958975      1.4576071      3476.4603    
       600   299.90625     -32079.439      557.37037      1.4572432      3477.3283    
       700   301.26903     -32095.51      -7023.7517      1.4568796      3478.1963    
       800   284.70023     -32092.916      4337.5425      1.4565161      3479.0644    
       900   272.67959     -32081.147     -7507.0913      1.4561528      3479.9324    
      1000   298.00851     -32085.881     -9249.815       1.4557896      3480.8004    
      1100   322.50188     -32091.849     -2405.3405      1.4554267      3481.6685    
      1200   322.44802     -32088.049      2135.0991      1.4550639      3482.5365    
      1300   282.34696     -32067.249     -10357.848      1.4547013      3483.4045    
      1400   295.66124     -32088.062     -1879.7543      1.4543389      3484.2726    
      1500   287.15574     -32078.958      17396.163      1.4539767      3485.1406    
      1600   314.08475     -32090.518     -4510.1416      1.4536146      3486.0086    
      1700   288.98113     -32077.763     -8437.5045      1.4532528      3486.8766    
      1800   300.94524     -32102.605     -4221.0411      1.4528911      3487.7447    
      1900   275.92783     -32090.837     -818.30592      1.4525296      3488.6127    
      2000   289.75876     -32096.08      -1515.2427      1.4521683      3489.4807    
      2100   274.95205     -32074.685      171.44899      1.4518071      3490.3488    
      2200   290.87319     -32070.996     -3143.7907      1.4514461      3491.2168    
      2300   310.59362     -32074.029     -4752.2461      1.4510854      3492.0848    
      2400   286.13429     -32070.795     -10338.274      1.4507247      3492.9529    
      2500   290.78311     -32102.594     -2889.496       1.4503643      3493.8209    
      2600   272.96958     -32101.155      322.97182      1.4500041      3494.6889    
      2700   315.47402     -32116.815     -7101.7875      1.449644       3495.5569    
      2800   300.81284     -32083.408     -3100.9233      1.4492841      3496.425     
      2900   326.48037     -32093.044     -4426.598       1.4489244      3497.293     
      3000   300.75442     -32082.299     -10998.877      1.4485649      3498.161     
      3100   314.1209      -32113.054     -5847.3411      1.4482055      3499.0291    
      3200   306.23622     -32117.147     -9280.9873      1.4478463      3499.8971    
      3300   311.78271     -32128.98       5221.6032      1.4474873      3500.7651    
      3400   303.65052     -32120.178      897.80973      1.4471285      3501.6332    
      3500   308.47468     -32101.674     -8292.5126      1.4467699      3502.5012    
      3600   325.17175     -32106.871      1345.1074      1.4464114      3503.3692    
      3700   310.74142     -32112.89      -1498.3691      1.4460531      3504.2372    
      3800   278.26068     -32105.346     -4592.3392      1.445695       3505.1053    
      3900   281.48054     -32101.587     -6923.8674      1.4453371      3505.9733    
      4000   335.9848      -32108.701     -3998.6149      1.4449793      3506.8413    
Loop time of 153.212 on 8 procs for 4000 steps with 274 atoms

Performance: 1.128 ns/day, 21.279 hours/ns, 26.108 timesteps/s, 7.153 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 85.242     | 116.48     | 128.79     | 133.0 | 76.03
Bond    | 0.010906   | 0.011933   | 0.013483   |   0.8 |  0.01
Neigh   | 6.289      | 8.1633     | 8.9497     |  31.1 |  5.33
Comm    | 2.137      | 14.467     | 45.725     | 377.5 |  9.44
Output  | 0.010794   | 0.012421   | 0.014029   |   1.0 |  0.01
Modify  | 13.214     | 13.982     | 15.845     |  23.7 |  9.13
Other   |            | 0.09179    |            |       |  0.06

Nlocal:          34.25 ave          43 max          21 min
Histogram: 1 1 0 0 1 0 1 1 1 2
Nghost:        2769.62 ave        2790 max        2741 min
Histogram: 1 0 0 2 2 0 0 0 0 3
Neighs:        18742.6 ave       23389 max       11761 min
Histogram: 1 1 0 0 1 0 1 1 2 1

Total # of neighbors = 149941
Ave neighs/atom = 547.22993
Ave special neighs/atom = 0
Neighbor list builds = 400
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 16.0755
variable dlen equal lz-${len0}
variable dlen equal lz-16.0755
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.0755
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -0.160755 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 4000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 110 | 110.4 | 110.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300.60001     -32070.467      2359.5288      1.4594291      3472.1201    
       100   294.00096     -32057.546      5653.4165      1.459794       3471.2521    
       200   301.54322     -32073.914     -17825.204      1.4601592      3470.3841    
       300   304.44003     -32080.505      5039.7776      1.4605245      3469.516     
       400   310.15381     -32082.935      1385.9935      1.46089        3468.648     
       500   315.46224     -32085.404     -4401.8702      1.4612557      3467.78      
       600   287.71713     -32065.66      -6831.9537      1.4616215      3466.912     
       700   299.2672      -32084.486      4695.1385      1.4619876      3466.0439    
       800   305.02031     -32100.432      6679.3385      1.4623538      3465.1759    
       900   275.50034     -32081.337      5507.8633      1.4627202      3464.3079    
      1000   293.90585     -32083.429      2453.4101      1.4630868      3463.4398    
      1100   299.6424      -32070.365     -10125.839      1.4634536      3462.5718    
      1200   297.21471     -32065.11      -1304.4951      1.4638206      3461.7038    
      1300   311.63037     -32088.382     -4112.3032      1.4641877      3460.8357    
      1400   304.24435     -32099.896     -15568.151      1.464555       3459.9677    
      1500   277.23735     -32085.851     -9979.681       1.4649226      3459.0997    
      1600   300.32374     -32097.851      681.49314      1.4652903      3458.2317    
      1700   293.37383     -32078.061     -7427.4081      1.4656581      3457.3636    
      1800   315.17535     -32090.28      -3610.3506      1.4660262      3456.4956    
      1900   308.69616     -32096.704      5650.2353      1.4663945      3455.6276    
      2000   288.70222     -32094.117     -4882.2317      1.4667629      3454.7595    
      2100   280.42595     -32084.456      9600.4691      1.4671315      3453.8915    
      2200   308.42125     -32097.101     -2230.5594      1.4675003      3453.0235    
      2300   320.88616     -32091.846     -1959.8047      1.4678693      3452.1554    
      2400   301.14802     -32079.164     -5433.4599      1.4682385      3451.2874    
      2500   302.40277     -32093.848      5085.5789      1.4686079      3450.4194    
      2600   293.71695     -32098.804     -1487.2418      1.4689775      3449.5514    
      2700   287.39217     -32094.365     -9460.9391      1.4693472      3448.6833    
      2800   307.93961     -32093.979     -5649.097       1.4697171      3447.8153    
      2900   304.77781     -32069.639     -4766.5571      1.4700872      3446.9473    
      3000   319.10838     -32076.242     -12542.8        1.4704575      3446.0792    
      3100   309.96035     -32079.659      8196.591       1.470828       3445.2112    
      3200   282.0566      -32078.862     -7110.4225      1.4711987      3444.3432    
      3300   301.78383     -32097.325      10177.111      1.4715695      3443.4751    
      3400   313.01288     -32087.441     -5324.8151      1.4719406      3442.6071    
      3500   314.6084      -32056.147      3551.3041      1.4723118      3441.7391    
      3600   318.55052     -32068.701     -7569.806       1.4726832      3440.8711    
      3700   307.99956     -32076.981     -1448.0973      1.4730549      3440.003     
      3800   300.03283     -32077.371     -8471.9767      1.4734267      3439.135     
      3900   314.36342     -32096.514     -11356.41       1.4737986      3438.267     
      4000   304.22615     -32105.724      12740.534      1.4741708      3437.3989    
Loop time of 155.867 on 8 procs for 4000 steps with 274 atoms

Performance: 1.109 ns/day, 21.648 hours/ns, 25.663 timesteps/s, 7.032 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 85.582     | 118.01     | 131.12     | 158.9 | 75.71
Bond    | 0.010748   | 0.011681   | 0.013021   |   0.7 |  0.01
Neigh   | 6.3957     | 8.3777     | 9.1393     |  38.4 |  5.37
Comm    | 1.9892     | 15.12      | 47.574     | 444.4 |  9.70
Output  | 0.012033   | 0.013946   | 0.015819   |   1.1 |  0.01
Modify  | 13.496     | 14.239     | 16.205     |  29.3 |  9.14
Other   |            | 0.09027    |            |       |  0.06

Nlocal:          34.25 ave          43 max          21 min
Histogram: 1 1 0 0 0 1 0 3 1 1
Nghost:         2849.5 ave        2876 max        2822 min
Histogram: 2 0 0 0 2 0 2 0 1 1
Neighs:          19124 ave       23726 max       12000 min
Histogram: 1 1 0 0 1 0 0 3 1 1

Total # of neighbors = 152992
Ave neighs/atom = 558.36496
Ave special neighs/atom = 0
Neighbor list builds = 400
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.0755
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 0.160755 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 4000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 110 | 110.4 | 110.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300.60001     -32070.467      2359.5288      1.4594291      3472.1201    
       100   294.0446      -32057.64       5673.8168      1.4590643      3472.9882    
       200   301.63634     -32073.749     -17505.475      1.4586997      3473.8562    
       300   303.16363     -32078.06       7094.3146      1.4583353      3474.7242    
       400   306.71508     -32080.616      2470.878       1.4579711      3475.5923    
       500   318.25614     -32090.248     -4181.6077      1.4576071      3476.4603    
       600   296.45851     -32076.215     -2819.5863      1.4572432      3477.3283    
       700   304.6655      -32088.654     -632.58139      1.4568796      3478.1963    
       800   290.36447     -32084.239     -6234.4473      1.4565161      3479.0644    
       900   280.7269      -32081.01       1706.7873      1.4561528      3479.9324    
      1000   284.07699     -32073.981     -6769.5048      1.4557896      3480.8004    
      1100   311.46242     -32076.04      -2323.0275      1.4554267      3481.6685    
      1200   308.22224     -32065.505     -5273.7386      1.4550639      3482.5365    
      1300   317.3055      -32084.295     -15221.687      1.4547013      3483.4045    
      1400   305.04074     -32104.177     -16483.273      1.4543389      3484.2726    
      1500   276.09126     -32096.171     -12568.259      1.4539767      3485.1406    
      1600   303.27793     -32105.161     -897.89322      1.4536146      3486.0086    
      1700   308.99926     -32087.293     -4768.0825      1.4532528      3486.8766    
      1800   291.77        -32061.105     -15068.654      1.4528911      3487.7447    
      1900   282.39585     -32052.802     -6468.2023      1.4525296      3488.6127    
      2000   284.90339     -32057.71      -10093.443      1.4521683      3489.4807    
      2100   280.69857     -32058.412      6495.1935      1.4518071      3490.3488    
      2200   312.65274     -32084.516     -2964.9163      1.4514461      3491.2168    
      2300   306.82042     -32089.876     -4523.8385      1.4510854      3492.0848    
      2400   305.22063     -32096.928     -857.39401      1.4507247      3492.9529    
      2500   302.84263     -32099.661     -8133.1525      1.4503643      3493.8209    
      2600   301.60441     -32096.98      -13804.335      1.4500041      3494.6889    
      2700   290.00189     -32080.874      9761.088       1.449644       3495.5569    
      2800   317.95323     -32086.797     -5330.3635      1.4492841      3496.425     
      2900   328.63613     -32086.672     -2479.0409      1.4489244      3497.293     
      3000   294.20886     -32070.072     -4948.5151      1.4485649      3498.161     
      3100   309.46548     -32091.682     -6513.0854      1.4482055      3499.0291    
      3200   311.93768     -32105.939     -309.52214      1.4478463      3499.8971    
      3300   289.95077     -32098.914      1299.1692      1.4474873      3500.7651    
      3400   280.34047     -32086.024      5527.6521      1.4471285      3501.6332    
      3500   305.14866     -32074.651     -18084.299      1.4467699      3502.5012    
      3600   309.3997      -32075.881     -5087.1415      1.4464114      3503.3692    
      3700   296.58093     -32073.53      -5882.8854      1.4460531      3504.2372    
      3800   306.48624     -32098.091     -8731.4981      1.445695       3505.1053    
      3900   270.63502     -32094.591     -7761.0002      1.4453371      3505.9733    
      4000   290.42337     -32111.656     -15179.796      1.4449793      3506.8413    
Loop time of 153.582 on 8 procs for 4000 steps with 274 atoms

Performance: 1.125 ns/day, 21.331 hours/ns, 26.045 timesteps/s, 7.136 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 84.67      | 114.82     | 129.29     | 157.3 | 74.76
Bond    | 0.011023   | 0.011886   | 0.013469   |   0.8 |  0.01
Neigh   | 6.2969     | 8.1462     | 8.9635     |  38.0 |  5.30
Comm    | 1.969      | 16.469     | 46.643     | 415.8 | 10.72
Output  | 0.011431   | 0.013095   | 0.014742   |   1.0 |  0.01
Modify  | 13.245     | 14.037     | 15.87      |  28.7 |  9.14
Other   |            | 0.0888     |            |       |  0.06

Nlocal:          34.25 ave          43 max          26 min
Histogram: 2 1 0 0 0 2 0 1 1 1
Nghost:        2808.25 ave        2826 max        2795 min
Histogram: 2 1 0 1 2 0 0 0 0 2
Neighs:        18779.8 ave       23229 max       14480 min
Histogram: 2 1 0 0 0 1 1 1 1 1

Total # of neighbors = 150238
Ave neighs/atom = 548.31387
Ave special neighs/atom = 0
Neighbor list builds = 400
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 16.8189
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.4312)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.8189
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -0.168189 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 4000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 110 | 110.4 | 110.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300.60001     -32070.467      2359.5288      1.4594291      3472.1201    
       100   294.09687     -32057.687      5639.3644      1.4594291      3472.1201    
       200   301.5121      -32073.873     -17597.323      1.4594291      3472.1201    
       300   303.33799     -32078.531      4461.2426      1.4594291      3472.1201    
       400   308.11366     -32081.764     -168.75206      1.4594291      3472.1201    
       500   319.69208     -32090.388     -4199.3422      1.4594291      3472.1201    
       600   295.06322     -32074.406     -9270.8158      1.4594291      3472.1201    
       700   303.63457     -32086.736     -2691.2897      1.4594291      3472.1201    
       800   292.95008     -32089.359     -4136.5739      1.4594291      3472.1201    
       900   267.66094     -32076.888      4173.589       1.4594291      3472.1201    
      1000   285.87991     -32077.602      151.36324      1.4594291      3472.1201    
      1100   305.94683     -32068.943     -4952.788       1.4594291      3472.1201    
      1200   297.63977     -32051.891     -3819.8795      1.4594291      3472.1201    
      1300   304.05957     -32074.41      -11448.517      1.4594291      3472.1201    
      1400   316.94905     -32114.207     -10133.898      1.4594291      3472.1201    
      1500   279.95525     -32104.655      403.51228      1.4594291      3472.1201    
      1600   278.01757     -32094.844     -6174.8505      1.4594291      3472.1201    
      1700   301.40288     -32087.203      2637.1613      1.4594291      3472.1201    
      1800   304.77731     -32066.13      -7307.3836      1.4594291      3472.1201    
      1900   338.52628     -32088.932      251.53885      1.4594291      3472.1201    
      2000   304.71742     -32085.922      161.72827      1.4594291      3472.1201    
      2100   292.84752     -32091.404      142.58338      1.4594291      3472.1201    
      2200   289.42181     -32095.013      3173.0902      1.4594291      3472.1201    
      2300   286.3929      -32089.315     -6885.182       1.4594291      3472.1201    
      2400   310.59459     -32091.068     -19575.078      1.4594291      3472.1201    
      2500   301.90574     -32068.693     -4193.4578      1.4594291      3472.1201    
      2600   290.2033      -32059.396     -13214.938      1.4594291      3472.1201    
      2700   315.4744      -32107.583      5100.6088      1.4594291      3472.1201    
      2800   308.7464      -32125.06      -10029.337      1.4594291      3472.1201    
      2900   289.76586     -32105.603     -238.88292      1.4594291      3472.1201    
      3000   288.26952     -32082.239     -2991.8132      1.4594291      3472.1201    
      3100   300.00013     -32076.937     -1943.4819      1.4594291      3472.1201    
      3200   312.07719     -32087.859     -6852.8787      1.4594291      3472.1201    
      3300   299.72098     -32106.222     -974.33921      1.4594291      3472.1201    
      3400   282.34662     -32105.337     -6173.4905      1.4594291      3472.1201    
      3500   282.24884     -32096.443     -3972.3097      1.4594291      3472.1201    
      3600   301.24118     -32094.953      7256.2843      1.4594291      3472.1201    
      3700   338.24252     -32118.167      1521.1678      1.4594291      3472.1201    
      3800   285.30521     -32081.935     -12504.858      1.4594291      3472.1201    
      3900   296.42407     -32094.001     -14443.036      1.4594291      3472.1201    
      4000   303.80755     -32102.022      6564.4137      1.4594291      3472.1201    
Loop time of 157.578 on 8 procs for 4000 steps with 274 atoms

Performance: 1.097 ns/day, 21.886 hours/ns, 25.384 timesteps/s, 6.955 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 92.247     | 117.86     | 132.85     | 129.8 | 74.79
Bond    | 0.010686   | 0.011832   | 0.013038   |   0.7 |  0.01
Neigh   | 6.3869     | 8.2523     | 9.3151     |  33.5 |  5.24
Comm    | 1.7835     | 16.793     | 42.423     | 344.3 | 10.66
Output  | 0.011866   | 0.013709   | 0.015439   |   1.0 |  0.01
Modify  | 13.515     | 14.563     | 16.417     |  25.0 |  9.24
Other   |            | 0.08658    |            |       |  0.05

Nlocal:          34.25 ave          45 max          22 min
Histogram: 1 0 1 1 0 2 1 0 0 2
Nghost:        2810.88 ave        2844 max        2777 min
Histogram: 2 1 1 0 0 0 0 2 0 2
Neighs:        18917.8 ave       24519 max       12349 min
Histogram: 1 0 1 1 0 2 1 0 0 2

Total # of neighbors = 151342
Ave neighs/atom = 552.34307
Ave special neighs/atom = 0
Neighbor list builds = 400
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.8189
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 0.168189 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 4000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 110 | 110.4 | 110.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300.60001     -32070.467      2359.5288      1.4594291      3472.1201    
       100   294.11983     -32057.657      5608.1979      1.4594291      3472.1201    
       200   301.21715     -32073.246     -17968.761      1.4594291      3472.1201    
       300   303.09824     -32078.919      5512.0421      1.4594291      3472.1201    
       400   310.98678     -32084.15       697.14895      1.4594291      3472.1201    
       500   323.02278     -32091.634     -1954.9945      1.4594291      3472.1201    
       600   283.65865     -32060.781     -4245.2246      1.4594291      3472.1201    
       700   305.8837      -32087.259     -7312.4273      1.4594291      3472.1201    
       800   299.52074     -32097.321     -1959.3454      1.4594291      3472.1201    
       900   285.04573     -32094.784     -2822.3063      1.4594291      3472.1201    
      1000   291.2803      -32093.328      1996.5327      1.4594291      3472.1201    
      1100   304.90156     -32087.137     -5027.0739      1.4594291      3472.1201    
      1200   308.94285     -32081.399     -5347.0318      1.4594291      3472.1201    
      1300   293.79831     -32073.811     -10881.871      1.4594291      3472.1201    
      1400   298.83748     -32091.5       -2022.2974      1.4594291      3472.1201    
      1500   284.73285     -32093.847     -19460.152      1.4594291      3472.1201    
      1600   295.4418      -32103.334     -10196.743      1.4594291      3472.1201    
      1700   298.53486     -32098.259      2375.4461      1.4594291      3472.1201    
      1800   298.73481     -32082.747     -1293.7331      1.4594291      3472.1201    
      1900   291.84812     -32069.831     -2728.7392      1.4594291      3472.1201    
      2000   299.455       -32073.471     -833.32958      1.4594291      3472.1201    
      2100   314.06966     -32080.788     -6287.8599      1.4594291      3472.1201    
      2200   303.94239     -32084.093     -19009.872      1.4594291      3472.1201    
      2300   290.07363     -32093.404     -1632.2615      1.4594291      3472.1201    
      2400   295.54307     -32104.587     -943.30165      1.4594291      3472.1201    
      2500   295.94536     -32088.25      -9428.3463      1.4594291      3472.1201    
      2600   321.94535     -32084.26      -877.08828      1.4594291      3472.1201    
      2700   317.74122     -32075.989     -2432.3001      1.4594291      3472.1201    
      2800   302.14897     -32080.817      7164.555       1.4594291      3472.1201    
      2900   284.1273      -32082         -5978.2124      1.4594291      3472.1201    
      3000   312.61722     -32103.358     -5282.9797      1.4594291      3472.1201    
      3100   284.8843      -32071.27      -3173.4681      1.4594291      3472.1201    
      3200   326.84616     -32084.868      4139.1417      1.4594291      3472.1201    
      3300   329.29865     -32094.255     -5537.3043      1.4594291      3472.1201    
      3400   296.72921     -32098.411     -1347.7707      1.4594291      3472.1201    
      3500   304.25804     -32105.184     -10288.763      1.4594291      3472.1201    
      3600   309.82723     -32106.006     -16213.659      1.4594291      3472.1201    
      3700   289.3066      -32078.79      -4274.6249      1.4594291      3472.1201    
      3800   319.61025     -32078.555      400.65893      1.4594291      3472.1201    
      3900   309.04105     -32072.069      9392.045       1.4594291      3472.1201    
      4000   287.30038     -32090.552     -14627.95       1.4594291      3472.1201    
Loop time of 157.63 on 8 procs for 4000 steps with 274 atoms

Performance: 1.096 ns/day, 21.893 hours/ns, 25.376 timesteps/s, 6.953 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.706     | 116.67     | 133.17     | 160.9 | 74.02
Bond    | 0.010443   | 0.011667   | 0.013808   |   0.9 |  0.01
Neigh   | 6.3486     | 8.2888     | 9.323      |  42.9 |  5.26
Comm    | 1.4389     | 17.958     | 47.961     | 410.6 | 11.39
Output  | 0.010728   | 0.012276   | 0.013822   |   1.0 |  0.01
Modify  | 13.597     | 14.598     | 16.518     |  32.0 |  9.26
Other   |            | 0.08805    |            |       |  0.06

Nlocal:          34.25 ave          44 max          20 min
Histogram: 1 0 1 0 1 1 1 0 1 2
Nghost:         2814.5 ave        2838 max        2799 min
Histogram: 2 1 2 0 1 0 0 0 0 2
Neighs:        18905.5 ave       23925 max       11347 min
Histogram: 1 0 0 1 1 1 1 0 1 2

Total # of neighbors = 151244
Ave neighs/atom = 551.9854
Ave special neighs/atom = 0
Neighbor list builds = 400
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 12.842
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-1.195)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.842
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -0.12842 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 4000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 110 | 110.4 | 110.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300.60001     -32070.467      2359.5288      1.4594291      3472.1201    
       100   294.09749     -32057.653      5653.2843      1.4594291      3472.1201    
       200   301.61341     -32073.68      -17028.098      1.4594291      3472.1201    
       300   303.3669      -32078.882      5576.227       1.4594291      3472.1201    
       400   308.79846     -32082.836      3313.5312      1.4594291      3472.1201    
       500   323.96288     -32092.475     -3618.8869      1.4594291      3472.1201    
       600   292.18532     -32067.754     -3305.9389      1.4594291      3472.1201    
       700   321.41598     -32095.63      -2346.6801      1.4594291      3472.1201    
       800   288.76869     -32072.095     -13504.326      1.4594291      3472.1201    
       900   294.13908     -32079.08      -256.76846      1.4594291      3472.1201    
      1000   300.63548     -32082.874      6741.5069      1.4594291      3472.1201    
      1100   302.70172     -32085.512     -1995.3538      1.4594291      3472.1201    
      1200   307.5789      -32094.018      8341.9489      1.4594291      3472.1201    
      1300   298.94118     -32095.406     -6515.5557      1.4594291      3472.1201    
      1400   298.22001     -32090.864     -3523.7284      1.4594291      3472.1201    
      1500   305.70405     -32085.716      4816.2023      1.4594291      3472.1201    
      1600   321.42891     -32099.393     -3979.4682      1.4594291      3472.1201    
      1700   291.24309     -32080.109     -1848.4714      1.4594291      3472.1201    
      1800   316.39787     -32101.129     -408.60036      1.4594291      3472.1201    
      1900   281.84138     -32070.328     -2791.9014      1.4594291      3472.1201    
      2000   307.93589     -32080.744      141.65091      1.4594291      3472.1201    
      2100   310.45812     -32080.375     -1023.1843      1.4594291      3472.1201    
      2200   307.65374     -32082.72      -1807.6155      1.4594291      3472.1201    
      2300   324.02923     -32106.471      4331.5442      1.4594291      3472.1201    
      2400   276.77502     -32082.949     -874.3197       1.4594291      3472.1201    
      2500   283.63677     -32081.571     -8738.314       1.4594291      3472.1201    
      2600   302.67738     -32078.315     -2249.9164      1.4594291      3472.1201    
      2700   298.6616      -32062.991     -1512.2367      1.4594291      3472.1201    
      2800   331.67583     -32101.379      1219.0747      1.4594291      3472.1201    
      2900   290.80116     -32096.728     -4402.978       1.4594291      3472.1201    
      3000   273.58002     -32095.041     -4626.0544      1.4594291      3472.1201    
      3100   294.36501     -32099.714      5666.9356      1.4594291      3472.1201    
      3200   315.65546     -32093.772     -2050.3548      1.4594291      3472.1201    
      3300   340.3372      -32115.737     -3816.4968      1.4594291      3472.1201    
      3400   279.5716      -32083.941     -1681.3357      1.4594291      3472.1201    
      3500   291.43234     -32098         -15260.055      1.4594291      3472.1201    
      3600   296.395       -32100.959     -5458.709       1.4594291      3472.1201    
      3700   305.98        -32097.751     -5746.3517      1.4594291      3472.1201    
      3800   310.16536     -32084.125     -2727.5224      1.4594291      3472.1201    
      3900   324.71799     -32083.026     -2247.5904      1.4594291      3472.1201    
      4000   294.6938      -32072.965     -5645.636       1.4594291      3472.1201    
Loop time of 155.21 on 8 procs for 4000 steps with 274 atoms

Performance: 1.113 ns/day, 21.557 hours/ns, 25.772 timesteps/s, 7.061 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.705     | 115.43     | 130.43     | 156.3 | 74.37
Bond    | 0.010387   | 0.011477   | 0.012781   |   0.7 |  0.01
Neigh   | 6.3349     | 8.1469     | 9.0903     |  37.4 |  5.25
Comm    | 1.9819     | 17.013     | 45.768     | 407.6 | 10.96
Output  | 0.011329   | 0.012971   | 0.014503   |   1.0 |  0.01
Modify  | 13.589     | 14.505     | 16.294     |  27.6 |  9.35
Other   |            | 0.08812    |            |       |  0.06

Nlocal:          34.25 ave          43 max          18 min
Histogram: 1 0 0 1 1 0 0 1 2 2
Nghost:        2812.12 ave        2827 max        2786 min
Histogram: 2 0 0 0 0 1 0 1 0 4
Neighs:          18938 ave       23751 max       10165 min
Histogram: 1 0 0 1 1 0 0 1 2 2

Total # of neighbors = 151504
Ave neighs/atom = 552.93431
Ave special neighs/atom = 0
Neighbor list builds = 400
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.842
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 0.12842 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 4000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 110 | 110.4 | 110.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300.60001     -32070.467      2359.5288      1.4594291      3472.1201    
       100   294.15162     -32057.694      5623.1253      1.4594291      3472.1201    
       200   301.55026     -32073.801     -17587.265      1.4594291      3472.1201    
       300   304.21912     -32079.797      5419.3154      1.4594291      3472.1201    
       400   308.86372     -32082.274      969.09452      1.4594291      3472.1201    
       500   320.72226     -32090.425     -5298.1253      1.4594291      3472.1201    
       600   298.81858     -32075.127     -5052.338       1.4594291      3472.1201    
       700   305.71758     -32082.98       5244.2724      1.4594291      3472.1201    
       800   294.07618     -32079.11      -10788.038      1.4594291      3472.1201    
       900   284.0171      -32080.508      878.42869      1.4594291      3472.1201    
      1000   291.19936     -32086.659     -3042.1404      1.4594291      3472.1201    
      1100   282.46491     -32070.322     -9413.2567      1.4594291      3472.1201    
      1200   293.64854     -32070.11      -8297.4439      1.4594291      3472.1201    
      1300   302.73299     -32080.576     -14062.261      1.4594291      3472.1201    
      1400   318.03593     -32105.043      8592.6824      1.4594291      3472.1201    
      1500   282.53097     -32088.937     -9486.4335      1.4594291      3472.1201    
      1600   294.36651     -32096.93       4920.7792      1.4594291      3472.1201    
      1700   297.34556     -32092.141     -4843.3715      1.4594291      3472.1201    
      1800   285.50046     -32077.797     -5737.1667      1.4594291      3472.1201    
      1900   302.031       -32081.529     -5945.3893      1.4594291      3472.1201    
      2000   306.77225     -32073.504     -12940.794      1.4594291      3472.1201    
      2100   301.38979     -32071.686     -11747.296      1.4594291      3472.1201    
      2200   300.37694     -32088.442     -8972.3494      1.4594291      3472.1201    
      2300   303.53203     -32110.735     -1273.6461      1.4594291      3472.1201    
      2400   285.56768     -32101.667     -609.76533      1.4594291      3472.1201    
      2500   290.11709     -32085.469      5542.5152      1.4594291      3472.1201    
      2600   308.60424     -32073.848     -13025.466      1.4594291      3472.1201    
      2700   302.12975     -32063.366      3482.9095      1.4594291      3472.1201    
      2800   291.28136     -32066.01      -19634.102      1.4594291      3472.1201    
      2900   305.10304     -32097.116     -4190.5159      1.4594291      3472.1201    
      3000   285.83038     -32092.014     -785.68474      1.4594291      3472.1201    
      3100   278.87669     -32090.493     -12392.546      1.4594291      3472.1201    
      3200   291.3123      -32090.336     -10486.939      1.4594291      3472.1201    
      3300   297.68525     -32072.315     -4824.8148      1.4594291      3472.1201    
      3400   323.59938     -32077.55       7158.3789      1.4594291      3472.1201    
      3500   294.05763     -32062.235      2963.5951      1.4594291      3472.1201    
      3600   300.92834     -32094.921      1748.9051      1.4594291      3472.1201    
      3700   278.48074     -32091.188     -6499.7542      1.4594291      3472.1201    
      3800   303.5196      -32097.395     -3813.8383      1.4594291      3472.1201    
      3900   305.77603     -32081.193     -1897.501       1.4594291      3472.1201    
      4000   293.25606     -32064.614     -8078.8545      1.4594291      3472.1201    
Loop time of 154.626 on 8 procs for 4000 steps with 274 atoms

Performance: 1.118 ns/day, 21.476 hours/ns, 25.869 timesteps/s, 7.088 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 105.42     | 119.18     | 129.9      |  84.3 | 77.08
Bond    | 0.010575   | 0.011779   | 0.012832   |   0.7 |  0.01
Neigh   | 7.5026     | 8.3995     | 8.9134     |  17.9 |  5.43
Comm    | 2.1111     | 12.848     | 26.577     | 257.0 |  8.31
Output  | 0.012886   | 0.014948   | 0.016787   |   1.1 |  0.01
Modify  | 13.582     | 14.082     | 15.006     |  13.9 |  9.11
Other   |            | 0.09047    |            |       |  0.06

Nlocal:          34.25 ave          44 max          21 min
Histogram: 1 0 0 2 0 0 2 1 1 1
Nghost:           2793 ave        2820 max        2770 min
Histogram: 1 0 1 1 3 0 1 0 0 1
Neighs:        18915.9 ave       23977 max       11809 min
Histogram: 1 0 0 2 0 0 1 2 1 1

Total # of neighbors = 151327
Ave neighs/atom = 552.28832
Ave special neighs/atom = 0
Neighbor list builds = 400
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 16.0755
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--8.3798)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.0755
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -0.160755 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 4000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 110 | 110.4 | 110.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300.60001     -32070.467      2359.5288      1.4594291      3472.1201    
       100   294.07173     -32057.641      5641.9241      1.4594291      3472.1201    
       200   300.62543     -32073.088     -18054.91       1.4594291      3472.1201    
       300   304.53732     -32079.695      7347.3686      1.4594291      3472.1201    
       400   309.16504     -32082.506      2361.3208      1.4594291      3472.1201    
       500   313.9585      -32085.875     -5240.7245      1.4594291      3472.1201    
       600   298.06966     -32077.013     -10408.788      1.4594291      3472.1201    
       700   301.85904     -32088.765     -4691.5098      1.4594291      3472.1201    
       800   286.91165     -32090.675     -1349.8673      1.4594291      3472.1201    
       900   272.71836     -32086.03       7379.2047      1.4594291      3472.1201    
      1000   287.24615     -32081.597      6107.7147      1.4594291      3472.1201    
      1100   300.76183     -32069.083     -8816.93        1.4594291      3472.1201    
      1200   300.44132     -32063.563     -8276.1602      1.4594291      3472.1201    
      1300   304.886       -32082.343      6321.8651      1.4594291      3472.1201    
      1400   297.5209      -32094.63      -1436.38        1.4594291      3472.1201    
      1500   289.43525     -32089.841     -14384.318      1.4594291      3472.1201    
      1600   293.96376     -32091.029     -9431.4932      1.4594291      3472.1201    
      1700   315.41332     -32098.221     -7413.6345      1.4594291      3472.1201    
      1800   294.54625     -32079.345     -5082.7156      1.4594291      3472.1201    
      1900   307.70024     -32092.125     -6065.9184      1.4594291      3472.1201    
      2000   301.38083     -32084.138      1429.6833      1.4594291      3472.1201    
      2100   282.166       -32068.777     -8255.9917      1.4594291      3472.1201    
      2200   289.35404     -32072.878     -11949.266      1.4594291      3472.1201    
      2300   284.09151     -32067.255      59.632805      1.4594291      3472.1201    
      2400   305.55589     -32084.679     -373.25496      1.4594291      3472.1201    
      2500   305.35633     -32081.838     -6297.349       1.4594291      3472.1201    
      2600   309.16174     -32091.22       4986.0509      1.4594291      3472.1201    
      2700   283.67702     -32075.747      6068.987       1.4594291      3472.1201    
      2800   294.31153     -32077.704     -11332.996      1.4594291      3472.1201    
      2900   312.1097      -32075.101     -15266.966      1.4594291      3472.1201    
      3000   334.53531     -32088.959      10848.626      1.4594291      3472.1201    
      3100   274.29689     -32065.272     -3333.5616      1.4594291      3472.1201    
      3200   305.90634     -32100.815     -967.78833      1.4594291      3472.1201    
      3300   302.91713     -32097.668     -8320.5659      1.4594291      3472.1201    
      3400   304.71198     -32081.515     -7232.8498      1.4594291      3472.1201    
      3500   330.26052     -32071.751     -3486.0419      1.4594291      3472.1201    
      3600   326.1846      -32075.416     -9976.0419      1.4594291      3472.1201    
      3700   275.6799      -32063.508     -6491.6533      1.4594291      3472.1201    
      3800   293.50919     -32083.334     -14832.241      1.4594291      3472.1201    
      3900   297.8951      -32084.078     -9103.3816      1.4594291      3472.1201    
      4000   321.49817     -32093.205     -256.21647      1.4594291      3472.1201    
Loop time of 155.463 on 8 procs for 4000 steps with 274 atoms

Performance: 1.112 ns/day, 21.592 hours/ns, 25.730 timesteps/s, 7.050 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 87.81      | 116.67     | 130.66     | 150.1 | 75.05
Bond    | 0.010428   | 0.011658   | 0.012677   |   0.7 |  0.01
Neigh   | 6.2858     | 8.2148     | 9.1332     |  38.8 |  5.28
Comm    | 2.09       | 16.086     | 44.951     | 404.1 | 10.35
Output  | 0.011322   | 0.012897   | 0.014229   |   0.9 |  0.01
Modify  | 13.469     | 14.38      | 16.311     |  29.5 |  9.25
Other   |            | 0.08616    |            |       |  0.06

Nlocal:          34.25 ave          44 max          24 min
Histogram: 1 2 0 0 0 1 1 1 0 2
Nghost:        2867.12 ave        2892 max        2839 min
Histogram: 1 0 2 1 0 0 0 2 1 1
Neighs:        18957.8 ave       24048 max       13568 min
Histogram: 2 1 0 0 0 1 1 1 0 2

Total # of neighbors = 151662
Ave neighs/atom = 553.51095
Ave special neighs/atom = 0
Neighbor list builds = 400
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.0755
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 0.160755 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 4000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 110 | 110.4 | 110.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300.60001     -32070.467      2359.5288      1.4594291      3472.1201    
       100   294.04085     -32057.602      5646.4177      1.4594291      3472.1201    
       200   302.38329     -32074.174     -17514.572      1.4594291      3472.1201    
       300   304.60409     -32080.045      5244.6499      1.4594291      3472.1201    
       400   313.80473     -32087.062     -539.36513      1.4594291      3472.1201    
       500   322.5653      -32092.817      765.75742      1.4594291      3472.1201    
       600   291.66788     -32068.011     -6153.1157      1.4594291      3472.1201    
       700   318.50258     -32096.816      6020.1299      1.4594291      3472.1201    
       800   289.86016     -32085.717     -9028.3503      1.4594291      3472.1201    
       900   284.41713     -32087.053     -7349.6476      1.4594291      3472.1201    
      1000   297.84033     -32086.645     -613.65803      1.4594291      3472.1201    
      1100   310.29107     -32080.136     -9975.0814      1.4594291      3472.1201    
      1200   300.79062     -32073.586     -700.42907      1.4594291      3472.1201    
      1300   283.92547     -32066.483     -2752.2074      1.4594291      3472.1201    
      1400   301.28419     -32091.245     -3205.061       1.4594291      3472.1201    
      1500   296.38176     -32089.75       3026.9592      1.4594291      3472.1201    
      1600   312.83254     -32092.914     -5143.3788      1.4594291      3472.1201    
      1700   285.9969      -32055.165     -5826.9799      1.4594291      3472.1201    
      1800   316.528       -32075.032      2974.5796      1.4594291      3472.1201    
      1900   296.00818     -32072.93       5300.6099      1.4594291      3472.1201    
      2000   301.24693     -32093.93       8832.2112      1.4594291      3472.1201    
      2100   281.56941     -32082.622      8415.9411      1.4594291      3472.1201    
      2200   296.30053     -32090.618     -15408.244      1.4594291      3472.1201    
      2300   290.58221     -32072.963     -9224.0583      1.4594291      3472.1201    
      2400   339.65989     -32101.302      578.57191      1.4594291      3472.1201    
      2500   305.87626     -32082.485     -6222.4107      1.4594291      3472.1201    
      2600   303.33079     -32098.8        1293.0204      1.4594291      3472.1201    
      2700   283.65915     -32093.882     -6810.0484      1.4594291      3472.1201    
      2800   282.10582     -32080.87      -8956.6811      1.4594291      3472.1201    
      2900   341.36129     -32107.473      1130.1648      1.4594291      3472.1201    
      3000   311.35878     -32086.011      1707.2837      1.4594291      3472.1201    
      3100   294.55006     -32097.19       7585.7576      1.4594291      3472.1201    
      3200   288.52111     -32094.152     -5374.7732      1.4594291      3472.1201    
      3300   306.38097     -32094.059     -5263.2917      1.4594291      3472.1201    
      3400   343.79976     -32113.329     -2630.1634      1.4594291      3472.1201    
      3500   299.08339     -32101.507      5552.3693      1.4594291      3472.1201    
      3600   290.52533     -32110.931     -7821.4654      1.4594291      3472.1201    
      3700   308.31575     -32128.316      5860.3043      1.4594291      3472.1201    
      3800   284.83519     -32117.889      5787.5911      1.4594291      3472.1201    
      3900   283.09384     -32106.716     -17380.24       1.4594291      3472.1201    
      4000   319.74076     -32110.37      -3463.9416      1.4594291      3472.1201    
Loop time of 152.801 on 8 procs for 4000 steps with 274 atoms

Performance: 1.131 ns/day, 21.222 hours/ns, 26.178 timesteps/s, 7.173 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.241     | 117.5      | 128.9      | 114.9 | 76.90
Bond    | 0.010831   | 0.01197    | 0.013139   |   0.7 |  0.01
Neigh   | 6.2876     | 8.3106     | 8.9563     |  29.8 |  5.44
Comm    | 1.8546     | 13.277     | 42.505     | 341.6 |  8.69
Output  | 0.012315   | 0.01397    | 0.015475   |   1.0 |  0.01
Modify  | 12.937     | 13.594     | 15.65      |  23.6 |  8.90
Other   |            | 0.0924     |            |       |  0.06

Nlocal:          34.25 ave          41 max          21 min
Histogram: 1 0 0 1 0 1 0 2 0 3
Nghost:        2789.62 ave        2831 max        2758 min
Histogram: 1 2 0 0 2 1 1 0 0 1
Neighs:        18942.5 ave       22602 max       11839 min
Histogram: 1 0 0 1 1 0 0 2 0 3

Total # of neighbors = 151540
Ave neighs/atom = 553.06569
Ave special neighs/atom = 0
Neighbor list builds = 400
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:33:36
