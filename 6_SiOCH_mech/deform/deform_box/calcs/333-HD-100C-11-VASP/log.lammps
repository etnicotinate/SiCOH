LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.1                  # the deformation magnitude 0.01

# Read the initial sctructure
# box tilt large
variable structure string 333-HD-100C-11-VASP
read_data       ${structure}.data
read_data       333-HD-100C-11-VASP.data
Reading data file ...
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.006 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 4.35485e-05 on 8 procs for 1 steps with 366 atoms

44.8% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.54e-07   | 1.7112e-07 | 2.06e-07   |   0.0 |  0.39
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 1.414e-06  | 1.4991e-06 | 1.583e-06  |   0.0 |  3.44
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 4.188e-05  |            |       | 96.16

Nlocal:          45.75 ave          53 max          35 min
Histogram: 1 0 1 0 1 1 0 1 1 2
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-HD-100C-11-VASP_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 5000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -29.52 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.2 | 139 | 142.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -43876.171      80037.985      1.9939932      3583.6077    
       100   394.17576     -44053.219      17438.286      1.9939932      3583.6077    
       200   353.44894     -44122.092      12299.895      1.9939932      3583.6077    
       300   324.73763     -44187.232      17674.139      1.9939932      3583.6077    
       400   316.60576     -44251.386      26668.937      1.9939932      3583.6077    
       500   311.85452     -44293.493      20499.652      1.9939932      3583.6077    
       600   286.90192     -44299.222      13302.392      1.9939932      3583.6077    
       700   293.9852      -44333.746      6045.8646      1.9939932      3583.6077    
       800   296.58519     -44345.153      18019.463      1.9939932      3583.6077    
       900   311.3918      -44353.462      21599.515      1.9939932      3583.6077    
      1000   297.75059     -44329.901      15334.277      1.9939932      3583.6077    
      1100   290.728       -44325.476      14209.613      1.9939932      3583.6077    
      1200   293.44941     -44350.793      15007.44       1.9939932      3583.6077    
      1300   294.9809      -44369.407      25845.97       1.9939932      3583.6077    
      1400   291.6881      -44370.896      5818.0434      1.9939932      3583.6077    
      1500   293.78555     -44356.303      22209.944      1.9939932      3583.6077    
      1600   299.4853      -44339.745      4633.8131      1.9939932      3583.6077    
      1700   309.0057      -44340.755      7974.3743      1.9939932      3583.6077    
      1800   299.93052     -44359.203      13186.124      1.9939932      3583.6077    
      1900   305.26822     -44389.751      18537.767      1.9939932      3583.6077    
      2000   284.83743     -44366.724      13040.585      1.9939932      3583.6077    
      2100   300.81289     -44367.304      8527.9041      1.9939932      3583.6077    
      2200   307.36822     -44359.291      16552.389      1.9939932      3583.6077    
      2300   310.06431     -44352.431      24597.191      1.9939932      3583.6077    
      2400   288.95655     -44357.024      15415.624      1.9939932      3583.6077    
      2500   278.87469     -44372.916      20698.218      1.9939932      3583.6077    
      2600   298.73446     -44388.666      11724.123      1.9939932      3583.6077    
      2700   292.64405     -44356.357      5051.7517      1.9939932      3583.6077    
      2800   313.35678     -44363.799      14684.432      1.9939932      3583.6077    
      2900   314.86929     -44372.789      25773.11       1.9939932      3583.6077    
      3000   290.50298     -44362.951      19010.829      1.9939932      3583.6077    
      3100   302.83284     -44374.452      11190.244      1.9939932      3583.6077    
      3200   318.7575      -44387.898      14078.193      1.9939932      3583.6077    
      3300   285.58967     -44360.935      12820.052      1.9939932      3583.6077    
      3400   302.9266      -44384.6        21105.288      1.9939932      3583.6077    
      3500   296.79317     -44362.739      21854.813      1.9939932      3583.6077    
      3600   302.17138     -44341.195      15614.069      1.9939932      3583.6077    
      3700   299.59159     -44328.33       18019.469      1.9939932      3583.6077    
      3800   290.12499     -44342.766      18360.41       1.9939932      3583.6077    
      3900   292.53822     -44362.378      15810.006      1.9939932      3583.6077    
      4000   299.26385     -44364.444      15002.903      1.9939932      3583.6077    
      4100   315.32196     -44369.154      12881.398      1.9939932      3583.6077    
      4200   312.40906     -44356.391      15767.577      1.9939932      3583.6077    
      4300   301.35664     -44366.558      18056.829      1.9939932      3583.6077    
      4400   288.24928     -44382.502      19759.841      1.9939932      3583.6077    
      4500   307.14732     -44385.383      22855.548      1.9939932      3583.6077    
      4600   294.81616     -44348.972      32085.663      1.9939932      3583.6077    
      4700   309.38252     -44359.422      11720.901      1.9939932      3583.6077    
      4800   286.45363     -44357.518      16635.276      1.9939932      3583.6077    
      4900   301.39755     -44393.467      18045.285      1.9939932      3583.6077    
      5000   268.0326      -44398.738      18808.476      1.9939932      3583.6077    
Loop time of 304.776 on 8 procs for 5000 steps with 366 atoms

Performance: 0.709 ns/day, 33.864 hours/ns, 16.405 timesteps/s, 6.004 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 199.33     | 236.62     | 260.52     | 146.9 | 77.64
Bond    | 0.0016533  | 0.0020193  | 0.002398   |   0.6 |  0.00
Neigh   | 16.032     | 18.699     | 20.476     |  41.1 |  6.14
Comm    | 2.0663     | 26.021     | 63.367     | 443.3 |  8.54
Output  | 0.002917   | 0.0031211  | 0.0042178  |   0.7 |  0.00
Modify  | 21.588     | 23.324     | 26.044     |  36.6 |  7.65
Other   |            | 0.1045     |            |       |  0.03

Nlocal:          45.75 ave          56 max          33 min
Histogram: 1 0 0 2 1 0 1 2 0 1
Nghost:        3597.62 ave        3701 max        3504 min
Histogram: 2 0 0 1 2 0 1 0 1 1
Neighs:        32811.4 ave       39771 max       23927 min
Histogram: 1 0 0 2 1 0 1 2 0 1

Total # of neighbors = 262491
Ave neighs/atom = 717.18852
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333-HD-100C-11-VASP_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.0372
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.535
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.6074

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.0807
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal -0.1585
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -7.4931

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 15.0372
variable dlen equal lx-${len0}
variable dlen equal lx-15.0372
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*15.0372
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.74931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.01585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.00807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.50372 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.50372 xy delta 0.74931 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.50372 xy delta 0.74931 xz delta 0.01585 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.9 | 143.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   268.0326      -44398.738      18808.45       3583.6077      15.0372        13.535         17.6074      
       100   305.91317     -44431.073      28216.072      3576.4405      15.007126      13.535         17.6074      
       200   297.01693     -44389.915      25052.987      3569.2733      14.977051      13.535         17.6074      
       300   307.30901     -44376.665      23994.356      3562.1061      14.946977      13.535         17.6074      
       400   300.876       -44356.184      11897.108      3554.9389      14.916902      13.535         17.6074      
       500   293.47598     -44362.252      23348.47       3547.7717      14.886828      13.535         17.6074      
       600   287.23997     -44383.493      14975.876      3540.6045      14.856754      13.535         17.6074      
       700   281.1122      -44382.94       21599.052      3533.4372      14.826679      13.535         17.6074      
       800   287.84268     -44364.734      17791.947      3526.27        14.796605      13.535         17.6074      
       900   282.95779     -44335.358      25383.25       3519.1028      14.76653       13.535         17.6074      
      1000   292.26402     -44334.819      37372.389      3511.9356      14.736456      13.535         17.6074      
      1100   324.71697     -44360.643      29104.79       3504.7684      14.706382      13.535         17.6074      
      1200   295.34365     -44339.989      22475.667      3497.6012      14.676307      13.535         17.6074      
      1300   282.57744     -44348.897      30601.974      3490.4339      14.646233      13.535         17.6074      
      1400   289.8428      -44348.107      24640.939      3483.2667      14.616158      13.535         17.6074      
      1500   295.43208     -44330.435      22738.463      3476.0995      14.586084      13.535         17.6074      
      1600   305.41293     -44316.957      13558.037      3468.9323      14.55601       13.535         17.6074      
      1700   313.76493     -44326.738      36796.308      3461.7651      14.525935      13.535         17.6074      
      1800   289.23442     -44330.384      29972.479      3454.5979      14.495861      13.535         17.6074      
      1900   298.01267     -44344.914      36779.514      3447.4307      14.465786      13.535         17.6074      
      2000   289.88963     -44329.637      33139.411      3440.2634      14.435712      13.535         17.6074      
      2100   312.09251     -44334.406      38988.054      3433.0962      14.405638      13.535         17.6074      
      2200   321.54815     -44317.215      53711.239      3425.929       14.375563      13.535         17.6074      
      2300   314.2983      -44295.799      40305.118      3418.7618      14.345489      13.535         17.6074      
      2400   307.64543     -44322.664      32804.518      3411.5946      14.315414      13.535         17.6074      
      2500   296.95189     -44305.998      45726.815      3404.4274      14.28534       13.535         17.6074      
      2600   302.25977     -44314.767      39313.366      3397.2601      14.255266      13.535         17.6074      
      2700   296.49064     -44322.164      39023.584      3390.0929      14.225191      13.535         17.6074      
      2800   300.3137      -44319.169      36039.529      3382.9257      14.195117      13.535         17.6074      
      2900   290.87581     -44319.483      38088.829      3375.7585      14.165042      13.535         17.6074      
      3000   304.24402     -44316.545      46558.605      3368.5913      14.134968      13.535         17.6074      
      3100   278.0248      -44250.654      49615.402      3361.4241      14.104894      13.535         17.6074      
      3200   298.01613     -44248.676      37128.64       3354.2569      14.074819      13.535         17.6074      
      3300   313.48837     -44269.842      42764.797      3347.0896      14.044745      13.535         17.6074      
      3400   297.72659     -44277.247      42252.322      3339.9224      14.01467       13.535         17.6074      
      3500   296.03525     -44260.186      57692.184      3332.7552      13.984596      13.535         17.6074      
      3600   292.41437     -44241.065      54997.422      3325.588       13.954522      13.535         17.6074      
      3700   306.28595     -44239.715      38477.07       3318.4208      13.924447      13.535         17.6074      
      3800   308.97235     -44214.291      68602.087      3311.2536      13.894373      13.535         17.6074      
      3900   299.41292     -44202.091      57209.59       3304.0863      13.864298      13.535         17.6074      
      4000   302.37393     -44230.278      45190.075      3296.9191      13.834224      13.535         17.6074      
      4100   294.433       -44226.379      48305.009      3289.7519      13.80415       13.535         17.6074      
      4200   283.80717     -44219.004      56511.78       3282.5847      13.774075      13.535         17.6074      
      4300   302.74689     -44234.14       47682.085      3275.4175      13.744001      13.535         17.6074      
      4400   277.2216      -44207.616      55469.806      3268.2503      13.713926      13.535         17.6074      
      4500   294.73754     -44207.859      58855.3        3261.083       13.683852      13.535         17.6074      
      4600   308.22226     -44173.7        55987.663      3253.9158      13.653778      13.535         17.6074      
      4700   318.69713     -44168.481      69143.401      3246.7486      13.623703      13.535         17.6074      
      4800   299.28307     -44163.526      74084.502      3239.5814      13.593629      13.535         17.6074      
      4900   293.86538     -44159.278      53698.178      3232.4142      13.563554      13.535         17.6074      
      5000   312.93837     -44180.687      68256.566      3225.247       13.53348       13.535         17.6074      
Loop time of 328.725 on 8 procs for 5000 steps with 366 atoms

Performance: 0.657 ns/day, 36.525 hours/ns, 15.210 timesteps/s, 5.567 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 189.04     | 254.2      | 279.56     | 224.9 | 77.33
Bond    | 0.0017695  | 0.0020426  | 0.002618   |   0.6 |  0.00
Neigh   | 14.917     | 19.538     | 21.446     |  59.5 |  5.94
Comm    | 3.4749     | 28.826     | 93.972     | 667.8 |  8.77
Output  | 0.017679   | 0.019603   | 0.021258   |   0.9 |  0.01
Modify  | 24.112     | 26.023     | 30.656     |  51.7 |  7.92
Other   |            | 0.1161     |            |       |  0.04

Nlocal:          45.75 ave          58 max          37 min
Histogram: 3 1 0 0 0 1 1 0 1 1
Nghost:           3808 ave        3934 max        3703 min
Histogram: 2 0 2 0 0 1 1 0 1 1
Neighs:        36441.9 ave       45766 max       29301 min
Histogram: 2 1 1 0 0 1 1 0 1 1

Total # of neighbors = 291535
Ave neighs/atom = 796.54372
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.005 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*15.0372
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.50372 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.50372 xy delta -0.74931 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.50372 xy delta -0.74931 xz delta -0.01585 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.9 | 143.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   268.0326      -44398.738      18808.45       3583.6077      15.0372        13.535         17.6074      
       100   305.75038     -44431.098      28291.83       3590.775       15.067274      13.535         17.6074      
       200   293.10551     -44397.347      16290.228      3597.9422      15.097349      13.535         17.6074      
       300   297.42176     -44373.247      18178.674      3605.1094      15.127423      13.535         17.6074      
       400   293.75913     -44360.726      18586.01       3612.2766      15.157498      13.535         17.6074      
       500   310.31995     -44365.68       16608.505      3619.4438      15.187572      13.535         17.6074      
       600   317.73223     -44363.342      19431.528      3626.611       15.217646      13.535         17.6074      
       700   306.25012     -44364.756      9461.287       3633.7783      15.247721      13.535         17.6074      
       800   289.36152     -44372.551      4914.1734      3640.9455      15.277795      13.535         17.6074      
       900   284.9855      -44366.221      9019.5204      3648.1127      15.30787       13.535         17.6074      
      1000   295.20446     -44373.805      14157.572      3655.2799      15.337944      13.535         17.6074      
      1100   289.4653      -44369.052     -439.81768      3662.4471      15.368018      13.535         17.6074      
      1200   285.13365     -44366.411      6006.9629      3669.6143      15.398093      13.535         17.6074      
      1300   292.39116     -44376.9       -6271.8522      3676.7815      15.428167      13.535         17.6074      
      1400   282.48126     -44374.308      8421.8938      3683.9488      15.458242      13.535         17.6074      
      1500   280.54009     -44366.624     -4177.7889      3691.116       15.488316      13.535         17.6074      
      1600   325.61003     -44374.107      7125.5285      3698.2832      15.51839       13.535         17.6074      
      1700   319.67637     -44355.596     -12536.571      3705.4504      15.548465      13.535         17.6074      
      1800   323.2931      -44378.768     -14509.663      3712.6176      15.578539      13.535         17.6074      
      1900   295.48033     -44365.722     -5412.4879      3719.7848      15.608614      13.535         17.6074      
      2000   302.23386     -44375.22      -1179.9573      3726.9521      15.638688      13.535         17.6074      
      2100   313.06227     -44379.365     -12821.134      3734.1193      15.668762      13.535         17.6074      
      2200   319.53442     -44359.553     -2434.3895      3741.2865      15.698837      13.535         17.6074      
      2300   311.92708     -44324.781     -12163.263      3748.4537      15.728911      13.535         17.6074      
      2400   317.69972     -44340.281     -387.5064       3755.6209      15.758986      13.535         17.6074      
      2500   288.93648     -44338.563     -9353.9398      3762.7881      15.78906       13.535         17.6074      
      2600   288.37985     -44352.48      -5408.4335      3769.9553      15.819134      13.535         17.6074      
      2700   287.29416     -44357.42      -11786.893      3777.1226      15.849209      13.535         17.6074      
      2800   287.50952     -44344.803     -9455.6753      3784.2898      15.879283      13.535         17.6074      
      2900   298.1704      -44322.607     -20887.158      3791.457       15.909358      13.535         17.6074      
      3000   322.96775     -44326.255     -11855.148      3798.6242      15.939432      13.535         17.6074      
      3100   307.46764     -44324.97      -2668.611       3805.7914      15.969506      13.535         17.6074      
      3200   301.01125     -44329.745     -18585.242      3812.9586      15.999581      13.535         17.6074      
      3300   305.82727     -44331.042     -9461.653       3820.1259      16.029655      13.535         17.6074      
      3400   297.41955     -44330.841     -15558.973      3827.2931      16.05973       13.535         17.6074      
      3500   294.09259     -44347.01      -22512.36       3834.4603      16.089804      13.535         17.6074      
      3600   282.22083     -44337.353     -27895.127      3841.6275      16.119878      13.535         17.6074      
      3700   304.55261     -44311.677     -12670.795      3848.7947      16.149953      13.535         17.6074      
      3800   304.89556     -44295.615     -20077.734      3855.9619      16.180027      13.535         17.6074      
      3900   314.54948     -44308.341     -15868.669      3863.1292      16.210102      13.535         17.6074      
      4000   286.59246     -44295.88      -27021.764      3870.2964      16.240176      13.535         17.6074      
      4100   290.59097     -44285.739     -25640.454      3877.4636      16.27025       13.535         17.6074      
      4200   336.13205     -44297.501     -31969.915      3884.6308      16.300325      13.535         17.6074      
      4300   338.02926     -44271.145     -22534.325      3891.798       16.330399      13.535         17.6074      
      4400   308.27715     -44278.16      -21775.221      3898.9652      16.360474      13.535         17.6074      
      4500   296.77084     -44275.823     -18069.164      3906.1324      16.390548      13.535         17.6074      
      4600   297.07758     -44271.243     -11707.731      3913.2997      16.420622      13.535         17.6074      
      4700   299.16187     -44254.486     -17606.576      3920.4669      16.450697      13.535         17.6074      
      4800   298.4716      -44237.051     -15445.617      3927.6341      16.480771      13.535         17.6074      
      4900   315.09429     -44242.765     -24017.26       3934.8013      16.510846      13.535         17.6074      
      5000   276.29707     -44225.843     -24198.471      3941.9685      16.54092       13.535         17.6074      
Loop time of 285.921 on 8 procs for 5000 steps with 366 atoms

Performance: 0.755 ns/day, 31.769 hours/ns, 17.487 timesteps/s, 6.400 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 169.37     | 228.8      | 242.88     | 149.8 | 80.02
Bond    | 0.0016611  | 0.0020776  | 0.0025413  |   0.6 |  0.00
Neigh   | 12.923     | 17.749     | 18.734     |  43.6 |  6.21
Comm    | 2.5685     | 16.65      | 76.077     | 555.3 |  5.82
Output  | 0.016924   | 0.018989   | 0.020732   |   0.9 |  0.01
Modify  | 21.672     | 22.588     | 27.434     |  38.8 |  7.90
Other   |            | 0.1173     |            |       |  0.04

Nlocal:          45.75 ave          52 max          33 min
Histogram: 1 0 1 0 0 1 1 0 1 3
Nghost:        3384.75 ave        3472 max        3290 min
Histogram: 1 1 0 1 1 1 0 1 1 1
Neighs:        29734.9 ave       33805 max       21657 min
Histogram: 1 0 1 0 0 1 1 0 1 3

Total # of neighbors = 237879
Ave neighs/atom = 649.94262
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.535
variable dlen equal ly-${len0}
variable dlen equal ly-13.535
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.535
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.74931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.01585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.00807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.3535 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.3535 yz delta -0.00807 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.9 | 143.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   268.0326      -44398.738      18808.45       3583.6077      15.0372        13.535         17.6074      
       100   306.14437     -44431.157      28330.012      3576.4405      15.0372        13.50793       17.6074      
       200   294.857       -44389.371      17229.881      3569.2733      15.0372        13.48086       17.6074      
       300   297.31152     -44363.757      27251.219      3562.1061      15.0372        13.45379       17.6074      
       400   293.8141      -44344.964      34184.509      3554.9389      15.0372        13.42672       17.6074      
       500   289.66793     -44344.043      31389.157      3547.7717      15.0372        13.39965       17.6074      
       600   282.4238      -44363.698      26791.106      3540.6045      15.0372        13.37258       17.6074      
       700   290.78129     -44372.299      27835.242      3533.4372      15.0372        13.34551       17.6074      
       800   283.17415     -44342.317      25693.745      3526.27        15.0372        13.31844       17.6074      
       900   283.0392      -44314.652      27093.716      3519.1028      15.0372        13.29137       17.6074      
      1000   311.78607     -44320.335      17926.954      3511.9356      15.0372        13.2643        17.6074      
      1100   338.64822     -44331.372      21800.225      3504.7684      15.0372        13.23723       17.6074      
      1200   306.15249     -44326.626      35321.007      3497.6012      15.0372        13.21016       17.6074      
      1300   300.63993     -44330.03       29394.056      3490.4339      15.0372        13.18309       17.6074      
      1400   302.44239     -44351.176      28202.44       3483.2667      15.0372        13.15602       17.6074      
      1500   300.44559     -44359.956      36734.45       3476.0995      15.0372        13.12895       17.6074      
      1600   295.98764     -44353.589      21709.834      3468.9323      15.0372        13.10188       17.6074      
      1700   301.33624     -44348.431      37518.251      3461.7651      15.0372        13.07481       17.6074      
      1800   305.65272     -44321.369      43314.532      3454.5979      15.0372        13.04774       17.6074      
      1900   316.31517     -44305.132      40580.974      3447.4307      15.0372        13.02067       17.6074      
      2000   306.1223      -44319.269      33898.353      3440.2634      15.0372        12.9936        17.6074      
      2100   293.89739     -44316.502      44517.848      3433.0962      15.0372        12.96653       17.6074      
      2200   312.48553     -44338.62       37631.794      3425.929       15.0372        12.93946       17.6074      
      2300   296.32035     -44330.694      27755.948      3418.7618      15.0372        12.91239       17.6074      
      2400   284.10715     -44328.831      59371.56       3411.5946      15.0372        12.88532       17.6074      
      2500   305.20768     -44359.218      36518.968      3404.4274      15.0372        12.85825       17.6074      
      2600   268.68071     -44342.049      24619.372      3397.2601      15.0372        12.83118       17.6074      
      2700   273.21134     -44325.579      33628.507      3390.0929      15.0372        12.80411       17.6074      
      2800   288.51478     -44302.92       60437.261      3382.9257      15.0372        12.77704       17.6074      
      2900   292.75925     -44300.243      50965.769      3375.7585      15.0372        12.74997       17.6074      
      3000   295.64294     -44308.438      42830.066      3368.5913      15.0372        12.7229        17.6074      
      3100   280.08288     -44294.658      61546.088      3361.4241      15.0372        12.69583       17.6074      
      3200   287.9288      -44317.986      46887.37       3354.2569      15.0372        12.66876       17.6074      
      3300   285.81709     -44321.261      41096.807      3347.0896      15.0372        12.64169       17.6074      
      3400   297.61544     -44306.161      49583.922      3339.9224      15.0372        12.61462       17.6074      
      3500   308.54532     -44278.379      65008.437      3332.7552      15.0372        12.58755       17.6074      
      3600   301.05366     -44258.658      46879.525      3325.588       15.0372        12.56048       17.6074      
      3700   290.91734     -44255.066      62680.851      3318.4208      15.0372        12.53341       17.6074      
      3800   293.96461     -44259.8        55646.363      3311.2536      15.0372        12.50634       17.6074      
      3900   309.3672      -44277.671      46791.534      3304.0863      15.0372        12.47927       17.6074      
      4000   314.90491     -44276.845      52944.682      3296.9191      15.0372        12.4522        17.6074      
      4100   304.61247     -44253.16       52490.955      3289.7519      15.0372        12.42513       17.6074      
      4200   287.33221     -44225.109      52210.662      3282.5847      15.0372        12.39806       17.6074      
      4300   293.36565     -44235.91       65585.588      3275.4175      15.0372        12.37099       17.6074      
      4400   282.96237     -44236.705      60229.081      3268.2503      15.0372        12.34392       17.6074      
      4500   308.27345     -44253.33       54076.868      3261.083       15.0372        12.31685       17.6074      
      4600   302.31155     -44232.075      66548.128      3253.9158      15.0372        12.28978       17.6074      
      4700   315.87718     -44222.397      68082.446      3246.7486      15.0372        12.26271       17.6074      
      4800   312.73953     -44212.241      56553.237      3239.5814      15.0372        12.23564       17.6074      
      4900   282.14015     -44200.944      64748.702      3232.4142      15.0372        12.20857       17.6074      
      5000   305.65523     -44216.321      60428.297      3225.247       15.0372        12.1815        17.6074      
Loop time of 336.702 on 8 procs for 5000 steps with 366 atoms

Performance: 0.642 ns/day, 37.411 hours/ns, 14.850 timesteps/s, 5.435 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 227.59     | 272.47     | 282.39     | 103.7 | 80.92
Bond    | 0.001696   | 0.0020369  | 0.0026347  |   0.6 |  0.00
Neigh   | 18.121     | 21.322     | 22.222     |  26.9 |  6.33
Comm    | 7.1279     | 16.968     | 61.79      | 415.0 |  5.04
Output  | 0.018841   | 0.021264   | 0.023366   |   1.1 |  0.01
Modify  | 24.909     | 25.794     | 29.071     |  25.1 |  7.66
Other   |            | 0.1219     |            |       |  0.04

Nlocal:          45.75 ave          59 max          33 min
Histogram: 1 1 1 0 1 1 1 0 0 2
Nghost:        3992.75 ave        4104 max        3902 min
Histogram: 2 0 0 2 2 0 0 0 0 2
Neighs:        36460.4 ave       46491 max       26493 min
Histogram: 1 1 1 0 1 1 0 1 0 2

Total # of neighbors = 291683
Ave neighs/atom = 796.94809
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.535
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.3535 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.3535 yz delta 0.00807 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.9 | 143.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   268.0326      -44398.738      18808.45       3583.6077      15.0372        13.535         17.6074      
       100   305.55182     -44431.021      28191.622      3590.775       15.0372        13.56207       17.6074      
       200   292.02099     -44394.489      17274.848      3597.9422      15.0372        13.58914       17.6074      
       300   289.46819     -44366.857      17351.866      3605.1094      15.0372        13.61621       17.6074      
       400   297.77771     -44362.33       20631.508      3612.2766      15.0372        13.64328       17.6074      
       500   302.38819     -44358.919      26396.607      3619.4438      15.0372        13.67035       17.6074      
       600   325.83844     -44367.867      10835.663      3626.611       15.0372        13.69742       17.6074      
       700   293.52785     -44357.135      15503.403      3633.7783      15.0372        13.72449       17.6074      
       800   289.15095     -44370.239      11824.997      3640.9455      15.0372        13.75156       17.6074      
       900   293.55816     -44366.275      5647.1618      3648.1127      15.0372        13.77863       17.6074      
      1000   303.53351     -44354.17       8701.1521      3655.2799      15.0372        13.8057        17.6074      
      1100   314.23981     -44348.531      8258.474       3662.4471      15.0372        13.83277       17.6074      
      1200   314.1186      -44362.701     -4907.8698      3669.6143      15.0372        13.85984       17.6074      
      1300   306.22088     -44379.759      3924.8659      3676.7815      15.0372        13.88691       17.6074      
      1400   282.67038     -44363.91       21616.218      3683.9488      15.0372        13.91398       17.6074      
      1500   297.73586     -44367.667      7023.0789      3691.116       15.0372        13.94105       17.6074      
      1600   320.11995     -44359.18       4962.6825      3698.2832      15.0372        13.96812       17.6074      
      1700   314.09316     -44320.371     -7953.2599      3705.4504      15.0372        13.99519       17.6074      
      1800   335.44017     -44354.323     -500.5611       3712.6176      15.0372        14.02226       17.6074      
      1900   313.48432     -44372.315     -219.90359      3719.7848      15.0372        14.04933       17.6074      
      2000   283.53432     -44358.377     -271.49136      3726.9521      15.0372        14.0764        17.6074      
      2100   296.05138     -44369.58      -5333.8958      3734.1193      15.0372        14.10347       17.6074      
      2200   290.90243     -44342.911     -229.99819      3741.2865      15.0372        14.13054       17.6074      
      2300   301.13486     -44331.969      3880.08        3748.4537      15.0372        14.15761       17.6074      
      2400   313.70416     -44344.182     -8659.8485      3755.6209      15.0372        14.18468       17.6074      
      2500   292.94312     -44360.466     -4061.6533      3762.7881      15.0372        14.21175       17.6074      
      2600   288.06295     -44348.82       2281.843       3769.9553      15.0372        14.23882       17.6074      
      2700   318.38454     -44364.699     -8350.5624      3777.1226      15.0372        14.26589       17.6074      
      2800   303.927       -44320.451     -6985.814       3784.2898      15.0372        14.29296       17.6074      
      2900   316.31655     -44327.035     -17432.643      3791.457       15.0372        14.32003       17.6074      
      3000   277.75289     -44323.139     -17610.354      3798.6242      15.0372        14.3471        17.6074      
      3100   318.408       -44372.149     -13545.059      3805.7914      15.0372        14.37417       17.6074      
      3200   287.66703     -44334.584     -14015.437      3812.9586      15.0372        14.40124       17.6074      
      3300   285.11105     -44304.671     -10865.59       3820.1259      15.0372        14.42831       17.6074      
      3400   304.839       -44286.55      -7448.4646      3827.2931      15.0372        14.45538       17.6074      
      3500   309.03481     -44291.833     -16185.372      3834.4603      15.0372        14.48245       17.6074      
      3600   314.72263     -44314.323     -14193.325      3841.6275      15.0372        14.50952       17.6074      
      3700   298.31772     -44299.984     -6729.3301      3848.7947      15.0372        14.53659       17.6074      
      3800   295.4545      -44289.771     -17717.168      3855.9619      15.0372        14.56366       17.6074      
      3900   310.66572     -44310.193     -14820.412      3863.1292      15.0372        14.59073       17.6074      
      4000   273.7349      -44290.385     -21297.047      3870.2964      15.0372        14.6178        17.6074      
      4100   289.28758     -44300.646     -10817.448      3877.4636      15.0372        14.64487       17.6074      
      4200   323.71965     -44289.542     -10875.254      3884.6308      15.0372        14.67194       17.6074      
      4300   315.25786     -44263.556     -22452.31       3891.798       15.0372        14.69901       17.6074      
      4400   324.06082     -44288.429     -19507.403      3898.9652      15.0372        14.72608       17.6074      
      4500   300.87927     -44271.752     -26354.777      3906.1324      15.0372        14.75315       17.6074      
      4600   293.02369     -44252.144     -22599.861      3913.2997      15.0372        14.78022       17.6074      
      4700   312.41208     -44256.722     -22253.916      3920.4669      15.0372        14.80729       17.6074      
      4800   309.73733     -44234.032     -28852.611      3927.6341      15.0372        14.83436       17.6074      
      4900   301.71783     -44227.884     -20887.76       3934.8013      15.0372        14.86143       17.6074      
      5000   302.83741     -44249.06      -29800.827      3941.9685      15.0372        14.8885        17.6074      
Loop time of 283.38 on 8 procs for 5000 steps with 366 atoms

Performance: 0.762 ns/day, 31.487 hours/ns, 17.644 timesteps/s, 6.458 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 163.06     | 225.38     | 239.72     | 158.5 | 79.53
Bond    | 0.0016328  | 0.0020049  | 0.0025715  |   0.5 |  0.00
Neigh   | 13.958     | 18.389     | 19.45      |  39.4 |  6.49
Comm    | 2.5911     | 16.915     | 79.209     | 578.1 |  5.97
Output  | 0.017356   | 0.019863   | 0.021812   |   1.0 |  0.01
Modify  | 21.478     | 22.549     | 27.031     |  36.0 |  7.96
Other   |            | 0.1201     |            |       |  0.04

Nlocal:          45.75 ave          55 max          35 min
Histogram: 1 0 0 1 1 2 1 0 0 2
Nghost:           3284 ave        3362 max        3201 min
Histogram: 2 0 2 0 0 0 0 0 2 2
Neighs:        29708.9 ave       35475 max       22898 min
Histogram: 1 0 1 0 2 1 1 0 0 2

Total # of neighbors = 237671
Ave neighs/atom = 649.37432
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.6074
variable dlen equal lz-${len0}
variable dlen equal lz-17.6074
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.6074
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.74931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.01585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.00807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -1.76074 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.9 | 143.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   268.0326      -44398.738      18808.45       3583.6077      15.0372        13.535         17.6074      
       100   305.87683     -44431.125      28342.352      3576.4405      15.0372        13.535         17.572185    
       200   295.94375     -44391.293      19521.917      3569.2733      15.0372        13.535         17.53697     
       300   304.57323     -44372.891      21990.223      3562.1061      15.0372        13.535         17.501756    
       400   316.13167     -44373.373      21905.562      3554.9389      15.0372        13.535         17.466541    
       500   285.83294     -44345.663      24762.827      3547.7717      15.0372        13.535         17.431326    
       600   300.17716     -44382.538      18211.92       3540.6045      15.0372        13.535         17.396111    
       700   286.36104     -44375.041      23699.317      3533.4372      15.0372        13.535         17.360896    
       800   294.67858     -44371.847      24194.246      3526.27        15.0372        13.535         17.325682    
       900   301.76664     -44353.46       19893.947      3519.1028      15.0372        13.535         17.290467    
      1000   310.17546     -44350.539      24346.615      3511.9356      15.0372        13.535         17.255252    
      1100   287.53262     -44358.722      37617.589      3504.7684      15.0372        13.535         17.220037    
      1200   281.14385     -44360.509      26499.392      3497.6012      15.0372        13.535         17.184822    
      1300   295.71107     -44348.859      24501.462      3490.4339      15.0372        13.535         17.149608    
      1400   317.78183     -44344.363      27569.362      3483.2667      15.0372        13.535         17.114393    
      1500   288.30577     -44308.619      24910.673      3476.0995      15.0372        13.535         17.079178    
      1600   295.62412     -44326.989      23138.265      3468.9323      15.0372        13.535         17.043963    
      1700   281.1837      -44340.175      31153.383      3461.7651      15.0372        13.535         17.008748    
      1800   289.04627     -44345.044      42381.396      3454.5979      15.0372        13.535         16.973534    
      1900   292.05647     -44326.079      30906.081      3447.4307      15.0372        13.535         16.938319    
      2000   306.3439      -44311.514      28771.207      3440.2634      15.0372        13.535         16.903104    
      2100   300.83031     -44313.263      33629.679      3433.0962      15.0372        13.535         16.867889    
      2200   304.3895      -44329.647      27133.529      3425.929       15.0372        13.535         16.832674    
      2300   293.86557     -44306.306      28698.635      3418.7618      15.0372        13.535         16.79746     
      2400   293.43241     -44300.233      32109.972      3411.5946      15.0372        13.535         16.762245    
      2500   301.43673     -44309.732      29575.668      3404.4274      15.0372        13.535         16.72703     
      2600   285.35236     -44316.658      34811.633      3397.2601      15.0372        13.535         16.691815    
      2700   277.50295     -44296.652      21244.682      3390.0929      15.0372        13.535         16.6566      
      2800   294.30067     -44289.299      32657.054      3382.9257      15.0372        13.535         16.621386    
      2900   300.00582     -44281.504      40461.052      3375.7585      15.0372        13.535         16.586171    
      3000   301.60583     -44276.894      40359.109      3368.5913      15.0372        13.535         16.550956    
      3100   331.65097     -44298.23       47523.001      3361.4241      15.0372        13.535         16.515741    
      3200   278.45858     -44261.855      39861.627      3354.2569      15.0372        13.535         16.480526    
      3300   302.21722     -44287.785      60994.623      3347.0896      15.0372        13.535         16.445312    
      3400   298.50341     -44270.234      44192.033      3339.9224      15.0372        13.535         16.410097    
      3500   302.34348     -44271.006      46308.983      3332.7552      15.0372        13.535         16.374882    
      3600   291.07664     -44270.099      50751.68       3325.588       15.0372        13.535         16.339667    
      3700   271.56206     -44278.667      55153.119      3318.4208      15.0372        13.535         16.304452    
      3800   283.78408     -44269.028      53567.074      3311.2536      15.0372        13.535         16.269238    
      3900   304.80754     -44264.794      64549.724      3304.0863      15.0372        13.535         16.234023    
      4000   308.78506     -44242.997      53336.58       3296.9191      15.0372        13.535         16.198808    
      4100   302.2256      -44228.306      53981.824      3289.7519      15.0372        13.535         16.163593    
      4200   291.87171     -44234.74       53010.019      3282.5847      15.0372        13.535         16.128378    
      4300   284.54583     -44225.562      38477.621      3275.4175      15.0372        13.535         16.093164    
      4400   292.93758     -44217.649      58468.93       3268.2503      15.0372        13.535         16.057949    
      4500   300.51518     -44205.506      73507.246      3261.083       15.0372        13.535         16.022734    
      4600   318.30878     -44208.554      65246.402      3253.9158      15.0372        13.535         15.987519    
      4700   283.3321      -44179.936      59138.35       3246.7486      15.0372        13.535         15.952304    
      4800   294.92513     -44192.294      53299.687      3239.5814      15.0372        13.535         15.91709     
      4900   293.18316     -44178.793      74397.445      3232.4142      15.0372        13.535         15.881875    
      5000   300.58578     -44189.58       69425.423      3225.247       15.0372        13.535         15.84666     
Loop time of 334.284 on 8 procs for 5000 steps with 366 atoms

Performance: 0.646 ns/day, 37.143 hours/ns, 14.957 timesteps/s, 5.474 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 243.23     | 269.63     | 281.44     |  81.5 | 80.66
Bond    | 0.0016369  | 0.0020393  | 0.0027385  |   0.7 |  0.00
Neigh   | 18.985     | 20.821     | 21.853     |  22.0 |  6.23
Comm    | 5.7308     | 17.525     | 43.875     | 319.1 |  5.24
Output  | 0.017843   | 0.020263   | 0.022341   |   1.0 |  0.01
Modify  | 25.075     | 26.163     | 28.057     |  20.2 |  7.83
Other   |            | 0.1227     |            |       |  0.04

Nlocal:          45.75 ave          56 max          39 min
Histogram: 3 1 0 0 1 0 0 1 1 1
Nghost:         3851.5 ave        3929 max        3789 min
Histogram: 2 0 2 0 0 2 0 0 0 2
Neighs:        36408.6 ave       43936 max       31501 min
Histogram: 3 1 0 0 1 0 0 1 1 1

Total # of neighbors = 291269
Ave neighs/atom = 795.81694
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.6074
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 1.76074 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.9 | 143.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   268.0326      -44398.738      18808.45       3583.6077      15.0372        13.535         17.6074      
       100   305.78724     -44431.09       28190.074      3590.775       15.0372        13.535         17.642615    
       200   298.14695     -44394.875      17014.17       3597.9422      15.0372        13.535         17.67783     
       300   305.85574     -44375.893      16713.933      3605.1094      15.0372        13.535         17.713044    
       400   298.62711     -44360.275      7463.8439      3612.2766      15.0372        13.535         17.748259    
       500   295.73978     -44359.97       18936.595      3619.4438      15.0372        13.535         17.783474    
       600   298.71015     -44387.261      11510.487      3626.611       15.0372        13.535         17.818689    
       700   294.80919     -44394.729      13131.402      3633.7783      15.0372        13.535         17.853904    
       800   303.7779      -44391.757      6272.3848      3640.9455      15.0372        13.535         17.889118    
       900   305.07668     -44359.029      4842.0121      3648.1127      15.0372        13.535         17.924333    
      1000   290.6706      -44340.566      2425.5202      3655.2799      15.0372        13.535         17.959548    
      1100   318.51761     -44369.261     -4137.6108      3662.4471      15.0372        13.535         17.994763    
      1200   306.75845     -44372.212      3053.7154      3669.6143      15.0372        13.535         18.029978    
      1300   303.98851     -44384.222      2691.5674      3676.7815      15.0372        13.535         18.065192    
      1400   298.31671     -44377.602     -10522.853      3683.9488      15.0372        13.535         18.100407    
      1500   305.49565     -44368.232     -5135.4466      3691.116       15.0372        13.535         18.135622    
      1600   295.98194     -44352.483     -668.30901      3698.2832      15.0372        13.535         18.170837    
      1700   310.43315     -44377.741      3483.3619      3705.4504      15.0372        13.535         18.206052    
      1800   286.8751      -44383.754     -895.98775      3712.6176      15.0372        13.535         18.241266    
      1900   282.10468     -44369.332     -14704.111      3719.7848      15.0372        13.535         18.276481    
      2000   297.4839      -44359.088     -1714.3804      3726.9521      15.0372        13.535         18.311696    
      2100   301.3034      -44337.472     -6.1117674      3734.1193      15.0372        13.535         18.346911    
      2200   314.10527     -44344.765     -5695.4535      3741.2865      15.0372        13.535         18.382126    
      2300   295.18874     -44361.599     -19629.704      3748.4537      15.0372        13.535         18.41734     
      2400   297.89991     -44369.661     -652.14532      3755.6209      15.0372        13.535         18.452555    
      2500   309.59225     -44376.601     -6754.2792      3762.7881      15.0372        13.535         18.48777     
      2600   292.30622     -44341.269     -8798.897       3769.9553      15.0372        13.535         18.522985    
      2700   297.3758      -44321.035     -17653.083      3777.1226      15.0372        13.535         18.5582      
      2800   307.32279     -44315.481     -8451.2044      3784.2898      15.0372        13.535         18.593414    
      2900   304.23952     -44342.081     -8575.5546      3791.457       15.0372        13.535         18.628629    
      3000   288.50059     -44341.808     -17809.173      3798.6242      15.0372        13.535         18.663844    
      3100   290.98537     -44331.031     -14786.508      3805.7914      15.0372        13.535         18.699059    
      3200   321.25419     -44337.101     -7646.2796      3812.9586      15.0372        13.535         18.734274    
      3300   316.10831     -44310.934     -18383.994      3820.1259      15.0372        13.535         18.769488    
      3400   300.7264      -44301.411     -19614.902      3827.2931      15.0372        13.535         18.804703    
      3500   281.89001     -44313.122     -10463.925      3834.4603      15.0372        13.535         18.839918    
      3600   275.66195     -44301.844     -22561.768      3841.6275      15.0372        13.535         18.875133    
      3700   298.77704     -44303.148     -22626.135      3848.7947      15.0372        13.535         18.910348    
      3800   312.21711     -44293.201     -18802.247      3855.9619      15.0372        13.535         18.945562    
      3900   319.12769     -44295.556     -15121.535      3863.1292      15.0372        13.535         18.980777    
      4000   283.69019     -44281.412     -31321.921      3870.2964      15.0372        13.535         19.015992    
      4100   314.44506     -44316.547     -11190.763      3877.4636      15.0372        13.535         19.051207    
      4200   303.67524     -44303.665     -21286.736      3884.6308      15.0372        13.535         19.086422    
      4300   293.97088     -44297.607     -21331.48       3891.798       15.0372        13.535         19.121636    
      4400   278.02345     -44291.23      -8775.9138      3898.9652      15.0372        13.535         19.156851    
      4500   280.30446     -44298.587     -27980.883      3906.1324      15.0372        13.535         19.192066    
      4600   297.10388     -44282.614     -17626.102      3913.2997      15.0372        13.535         19.227281    
      4700   310.62943     -44262.821     -13019.614      3920.4669      15.0372        13.535         19.262496    
      4800   303.03896     -44250.129     -19591.496      3927.6341      15.0372        13.535         19.29771     
      4900   315.11481     -44271.918     -27610.085      3934.8013      15.0372        13.535         19.332925    
      5000   298.58046     -44265.901     -19570.828      3941.9685      15.0372        13.535         19.36814     
Loop time of 286.85 on 8 procs for 5000 steps with 366 atoms

Performance: 0.753 ns/day, 31.872 hours/ns, 17.431 timesteps/s, 6.380 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 190.15     | 230.58     | 243.48     | 110.7 | 80.38
Bond    | 0.0017347  | 0.0020441  | 0.0023311  |   0.4 |  0.00
Neigh   | 13.965     | 17.188     | 18.666     |  32.2 |  5.99
Comm    | 3.2043     | 16.141     | 56.582     | 418.8 |  5.63
Output  | 0.019019   | 0.021325   | 0.023425   |   1.0 |  0.01
Modify  | 21.27      | 22.797     | 26.018     |  27.9 |  7.95
Other   |            | 0.1162     |            |       |  0.04

Nlocal:          45.75 ave          52 max          40 min
Histogram: 2 0 1 0 0 1 3 0 0 1
Nghost:           3353 ave        3503 max        3230 min
Histogram: 1 1 1 1 1 0 1 1 0 1
Neighs:        29744.2 ave       33552 max       25796 min
Histogram: 2 0 1 0 0 1 1 2 0 1

Total # of neighbors = 237954
Ave neighs/atom = 650.14754
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 15.0372
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.0807)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*15.0372
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.74931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.01585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.00807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -1.50372 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.9 | 143.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   268.0326      -44398.738      18808.45       3583.6077      15.0372        13.535         17.6074      
       100   305.84803     -44431.082      28220.455      3583.6077      15.0372        13.535         17.6074      
       200   294.86091     -44395.474      17803.334      3583.6077      15.0372        13.535         17.6074      
       300   304.12151     -44379.544      15260.478      3583.6077      15.0372        13.535         17.6074      
       400   300.98036     -44365.396      20644.941      3583.6077      15.0372        13.535         17.6074      
       500   282.37952     -44336.774      21170.873      3583.6077      15.0372        13.535         17.6074      
       600   322.97728     -44369.449      17978.336      3583.6077      15.0372        13.535         17.6074      
       700   303.97892     -44362.503      15607.915      3583.6077      15.0372        13.535         17.6074      
       800   280.3683      -44359.532      14418.64       3583.6077      15.0372        13.535         17.6074      
       900   299.95398     -44375.079      20901.489      3583.6077      15.0372        13.535         17.6074      
      1000   297.12321     -44344.165      3186.6544      3583.6077      15.0372        13.535         17.6074      
      1100   318.25883     -44347.551      17526.983      3583.6077      15.0372        13.535         17.6074      
      1200   295.11601     -44333.118      13080.08       3583.6077      15.0372        13.535         17.6074      
      1300   293.53865     -44376.952      12259.79       3583.6077      15.0372        13.535         17.6074      
      1400   298.6345      -44387.242      22610.461      3583.6077      15.0372        13.535         17.6074      
      1500   294.77759     -44374.2        18247.027      3583.6077      15.0372        13.535         17.6074      
      1600   314.30843     -44371.15       15109.328      3583.6077      15.0372        13.535         17.6074      
      1700   299.05814     -44345.645      17817.887      3583.6077      15.0372        13.535         17.6074      
      1800   300.54511     -44374.013      31763.037      3583.6077      15.0372        13.535         17.6074      
      1900   288.8524      -44385.708      20329.041      3583.6077      15.0372        13.535         17.6074      
      2000   299.64082     -44390.002      14515.246      3583.6077      15.0372        13.535         17.6074      
      2100   308.16444     -44384.3        25009.433      3583.6077      15.0372        13.535         17.6074      
      2200   300.74578     -44362.242      12391.671      3583.6077      15.0372        13.535         17.6074      
      2300   314.52847     -44338.521      17199.04       3583.6077      15.0372        13.535         17.6074      
      2400   317.44753     -44328.544      17983.447      3583.6077      15.0372        13.535         17.6074      
      2500   296.73615     -44335.273      13848.945      3583.6077      15.0372        13.535         17.6074      
      2600   319.798       -44372.07       9794.2173      3583.6077      15.0372        13.535         17.6074      
      2700   293.39368     -44360.41       16791.108      3583.6077      15.0372        13.535         17.6074      
      2800   291.95895     -44365.381      10917.487      3583.6077      15.0372        13.535         17.6074      
      2900   285.66813     -44349.152      10191.481      3583.6077      15.0372        13.535         17.6074      
      3000   300.14144     -44325.723      18618.784      3583.6077      15.0372        13.535         17.6074      
      3100   308.4703      -44323.706      25491.042      3583.6077      15.0372        13.535         17.6074      
      3200   314.3693      -44352.089      12911.299      3583.6077      15.0372        13.535         17.6074      
      3300   289.8467      -44348.32       17184.426      3583.6077      15.0372        13.535         17.6074      
      3400   298.25373     -44353.919      15599.333      3583.6077      15.0372        13.535         17.6074      
      3500   312.95296     -44359.84       22449.188      3583.6077      15.0372        13.535         17.6074      
      3600   289.82134     -44331.322      24295.63       3583.6077      15.0372        13.535         17.6074      
      3700   287.58888     -44349.615      18829.424      3583.6077      15.0372        13.535         17.6074      
      3800   296.82571     -44381.284      10908.904      3583.6077      15.0372        13.535         17.6074      
      3900   268.29271     -44354.154      17345.186      3583.6077      15.0372        13.535         17.6074      
      4000   298.17003     -44349.954      22131.208      3583.6077      15.0372        13.535         17.6074      
      4100   299.80913     -44332.573      18006.75       3583.6077      15.0372        13.535         17.6074      
      4200   282.05232     -44312.26       14495.459      3583.6077      15.0372        13.535         17.6074      
      4300   313.68279     -44352.196      11957.004      3583.6077      15.0372        13.535         17.6074      
      4400   299.95126     -44361.644      18627.321      3583.6077      15.0372        13.535         17.6074      
      4500   288.04561     -44358.118      15918.138      3583.6077      15.0372        13.535         17.6074      
      4600   292.83786     -44348.775      6987.2306      3583.6077      15.0372        13.535         17.6074      
      4700   291.38649     -44331.548      7969.1171      3583.6077      15.0372        13.535         17.6074      
      4800   304.63378     -44330.515     -1234.7562      3583.6077      15.0372        13.535         17.6074      
      4900   289.00888     -44311.901      16963.033      3583.6077      15.0372        13.535         17.6074      
      5000   312.99084     -44349.218      3381.3987      3583.6077      15.0372        13.535         17.6074      
Loop time of 300.59 on 8 procs for 5000 steps with 366 atoms

Performance: 0.719 ns/day, 33.399 hours/ns, 16.634 timesteps/s, 6.088 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 214.47     | 236.19     | 252.73     |  92.0 | 78.58
Bond    | 0.0016218  | 0.0018886  | 0.0021603  |   0.5 |  0.00
Neigh   | 17.974     | 19.787     | 22.126     |  35.5 |  6.58
Comm    | 3.4079     | 20.005     | 41.726     | 315.9 |  6.66
Output  | 0.018886   | 0.021251   | 0.023336   |   1.0 |  0.01
Modify  | 22.04      | 24.466     | 26.3       |  32.6 |  8.14
Other   |            | 0.115      |            |       |  0.04

Nlocal:          45.75 ave          56 max          35 min
Histogram: 2 0 1 0 0 2 0 1 0 2
Nghost:        3594.88 ave        3704 max        3500 min
Histogram: 1 1 1 0 2 0 1 1 0 1
Neighs:        32819.2 ave       39654 max       25302 min
Histogram: 2 0 1 0 0 2 0 1 0 2

Total # of neighbors = 262554
Ave neighs/atom = 717.36066
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*15.0372
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 1.50372 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.9 | 143.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   268.0326      -44398.738      18808.45       3583.6077      15.0372        13.535         17.6074      
       100   305.83858     -44431.143      28293.47       3583.6077      15.0372        13.535         17.6074      
       200   292.24652     -44391.929      21312.054      3583.6077      15.0372        13.535         17.6074      
       300   293.12851     -44368.293      17554.699      3583.6077      15.0372        13.535         17.6074      
       400   297.11467     -44358.943      29729.429      3583.6077      15.0372        13.535         17.6074      
       500   293.25903     -44346.548      12547.725      3583.6077      15.0372        13.535         17.6074      
       600   299.8597      -44369.984      15090.779      3583.6077      15.0372        13.535         17.6074      
       700   287.00113     -44381.26       16734.496      3583.6077      15.0372        13.535         17.6074      
       800   293.40509     -44379.108      13526.782      3583.6077      15.0372        13.535         17.6074      
       900   301.68692     -44363.465      22534.559      3583.6077      15.0372        13.535         17.6074      
      1000   303.19237     -44352.017      16953.018      3583.6077      15.0372        13.535         17.6074      
      1100   309.80264     -44358.971      5467.4153      3583.6077      15.0372        13.535         17.6074      
      1200   305.97504     -44364.644      23954.75       3583.6077      15.0372        13.535         17.6074      
      1300   301.9004      -44372.414      8283.2532      3583.6077      15.0372        13.535         17.6074      
      1400   305.14152     -44378.464      13958.394      3583.6077      15.0372        13.535         17.6074      
      1500   283.31704     -44370.259      24446.606      3583.6077      15.0372        13.535         17.6074      
      1600   280.94276     -44388.045      19019.793      3583.6077      15.0372        13.535         17.6074      
      1700   296.15676     -44395.497      6163.122       3583.6077      15.0372        13.535         17.6074      
      1800   296.92488     -44357.809      15971.132      3583.6077      15.0372        13.535         17.6074      
      1900   313.68214     -44366.038      19034.737      3583.6077      15.0372        13.535         17.6074      
      2000   299.56992     -44359.113      17368.335      3583.6077      15.0372        13.535         17.6074      
      2100   302.85756     -44388.668      19288.793      3583.6077      15.0372        13.535         17.6074      
      2200   306.67655     -44387.415      10712.216      3583.6077      15.0372        13.535         17.6074      
      2300   311.09975     -44384.447      13535.863      3583.6077      15.0372        13.535         17.6074      
      2400   303.95293     -44382.558      23341.658      3583.6077      15.0372        13.535         17.6074      
      2500   279.98989     -44388.083      21221.202      3583.6077      15.0372        13.535         17.6074      
      2600   280.27672     -44384.127      13507.991      3583.6077      15.0372        13.535         17.6074      
      2700   291.62325     -44372.307      12576.704      3583.6077      15.0372        13.535         17.6074      
      2800   288.89736     -44346.525      16828.488      3583.6077      15.0372        13.535         17.6074      
      2900   297.27444     -44349.825      11323.886      3583.6077      15.0372        13.535         17.6074      
      3000   291.09986     -44346.34       12433.689      3583.6077      15.0372        13.535         17.6074      
      3100   285.00623     -44358.976      6525.7897      3583.6077      15.0372        13.535         17.6074      
      3200   278.67886     -44354.786      17149.272      3583.6077      15.0372        13.535         17.6074      
      3300   308.78807     -44350.122      22367.309      3583.6077      15.0372        13.535         17.6074      
      3400   293.9089      -44315.431      19920.939      3583.6077      15.0372        13.535         17.6074      
      3500   301.52328     -44323.71       33648.154      3583.6077      15.0372        13.535         17.6074      
      3600   308.81725     -44366.594      19381.129      3583.6077      15.0372        13.535         17.6074      
      3700   312.46704     -44378.159      14054.567      3583.6077      15.0372        13.535         17.6074      
      3800   288.20271     -44352.456      13744.419      3583.6077      15.0372        13.535         17.6074      
      3900   286.56186     -44337.995      18078.464      3583.6077      15.0372        13.535         17.6074      
      4000   322.75084     -44338.19       16727.641      3583.6077      15.0372        13.535         17.6074      
      4100   327.8093      -44334.184      15291.66       3583.6077      15.0372        13.535         17.6074      
      4200   311.08117     -44336.348      16500.699      3583.6077      15.0372        13.535         17.6074      
      4300   323.95054     -44359.278      21294.643      3583.6077      15.0372        13.535         17.6074      
      4400   295.14648     -44334.913      27361.509      3583.6077      15.0372        13.535         17.6074      
      4500   303.34526     -44347.663      6283.0849      3583.6077      15.0372        13.535         17.6074      
      4600   284.0573      -44350.615      22007.495      3583.6077      15.0372        13.535         17.6074      
      4700   284.57065     -44358.873      22909.403      3583.6077      15.0372        13.535         17.6074      
      4800   301.77183     -44355.459      6496.962       3583.6077      15.0372        13.535         17.6074      
      4900   306.80224     -44347.863      23094.904      3583.6077      15.0372        13.535         17.6074      
      5000   274.08959     -44312.96       22426.544      3583.6077      15.0372        13.535         17.6074      
Loop time of 221.993 on 8 procs for 5000 steps with 366 atoms

Performance: 0.973 ns/day, 24.666 hours/ns, 22.523 timesteps/s, 8.243 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 159.5      | 168.55     | 178.99     |  61.4 | 75.93
Bond    | 0.001138   | 0.001401   | 0.0020242  |   0.7 |  0.00
Neigh   | 14.664     | 15.637     | 17.131     |  19.2 |  7.04
Comm    | 7.5739     | 18.048     | 27.059     | 187.4 |  8.13
Output  | 0.012255   | 0.013917   | 0.015268   |   0.8 |  0.01
Modify  | 18.179     | 19.641     | 20.636     |  17.2 |  8.85
Other   |            | 0.09969    |            |       |  0.04

Nlocal:          45.75 ave          56 max          31 min
Histogram: 1 0 0 0 2 0 2 1 1 1
Nghost:        3606.12 ave        3692 max        3530 min
Histogram: 2 1 1 0 0 0 1 1 1 1
Neighs:        32792.1 ave       39841 max       22410 min
Histogram: 1 0 0 0 2 1 0 2 1 1

Total # of neighbors = 262337
Ave neighs/atom = 716.76776
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.535
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz--0.1585)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.535
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.74931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.01585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.00807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -1.3535 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.9 | 143.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   268.0326      -44398.738      18808.45       3583.6077      15.0372        13.535         17.6074      
       100   305.83301     -44431.123      28236.242      3583.6077      15.0372        13.535         17.6074      
       200   297.59358     -44393.81       19290.881      3583.6077      15.0372        13.535         17.6074      
       300   292.6899      -44366.399      16814.764      3583.6077      15.0372        13.535         17.6074      
       400   300.50897     -44363.005      21546.517      3583.6077      15.0372        13.535         17.6074      
       500   288.39386     -44346.725      13071.338      3583.6077      15.0372        13.535         17.6074      
       600   307.92253     -44342.97       23183.049      3583.6077      15.0372        13.535         17.6074      
       700   328.08539     -44359.831      18993.704      3583.6077      15.0372        13.535         17.6074      
       800   303.30893     -44369.461      12889.362      3583.6077      15.0372        13.535         17.6074      
       900   313.14181     -44394.671      21161.336      3583.6077      15.0372        13.535         17.6074      
      1000   282.42579     -44368.048      20108.524      3583.6077      15.0372        13.535         17.6074      
      1100   292.98487     -44378.289      21591.26       3583.6077      15.0372        13.535         17.6074      
      1200   287.55707     -44369.955      515.98626      3583.6077      15.0372        13.535         17.6074      
      1300   304.01299     -44363.562      14543.487      3583.6077      15.0372        13.535         17.6074      
      1400   305.30977     -44348.948      11402.562      3583.6077      15.0372        13.535         17.6074      
      1500   311.55294     -44378.279      11890.692      3583.6077      15.0372        13.535         17.6074      
      1600   286.88781     -44376.984      27638.064      3583.6077      15.0372        13.535         17.6074      
      1700   291.52968     -44378.327      16487.044      3583.6077      15.0372        13.535         17.6074      
      1800   304.87777     -44373.068      19200.198      3583.6077      15.0372        13.535         17.6074      
      1900   317.90681     -44369.632      21950.526      3583.6077      15.0372        13.535         17.6074      
      2000   298.64403     -44341.908      8256.8761      3583.6077      15.0372        13.535         17.6074      
      2100   299.89186     -44364.152      6525.5243      3583.6077      15.0372        13.535         17.6074      
      2200   298.45435     -44387.093      17272.071      3583.6077      15.0372        13.535         17.6074      
      2300   298.08762     -44389.33       30884.259      3583.6077      15.0372        13.535         17.6074      
      2400   289.60448     -44367.827      9286.257       3583.6077      15.0372        13.535         17.6074      
      2500   306.74138     -44348.674      25739.229      3583.6077      15.0372        13.535         17.6074      
      2600   314.19318     -44343.319      14154.108      3583.6077      15.0372        13.535         17.6074      
      2700   337.4887      -44381.568      5075.9031      3583.6077      15.0372        13.535         17.6074      
      2800   289.49989     -44348.37       12881.089      3583.6077      15.0372        13.535         17.6074      
      2900   292.29902     -44365.806      6780.8334      3583.6077      15.0372        13.535         17.6074      
      3000   294.11935     -44363.954      12786.608      3583.6077      15.0372        13.535         17.6074      
      3100   288.37017     -44354.451      6282.145       3583.6077      15.0372        13.535         17.6074      
      3200   284.2564      -44328.791      15031.501      3583.6077      15.0372        13.535         17.6074      
      3300   306.37877     -44331.042      20968.858      3583.6077      15.0372        13.535         17.6074      
      3400   310.53744     -44340.152      13464.723      3583.6077      15.0372        13.535         17.6074      
      3500   296.38297     -44360.771      17503.03       3583.6077      15.0372        13.535         17.6074      
      3600   305.82463     -44372.369      17199.674      3583.6077      15.0372        13.535         17.6074      
      3700   307.93092     -44363.824      17708.048      3583.6077      15.0372        13.535         17.6074      
      3800   306.26223     -44356.326      8850.264       3583.6077      15.0372        13.535         17.6074      
      3900   300.60521     -44358.022      6926.7957      3583.6077      15.0372        13.535         17.6074      
      4000   285.90252     -44352.392      14452.002      3583.6077      15.0372        13.535         17.6074      
      4100   314.33118     -44376.924      21031.278      3583.6077      15.0372        13.535         17.6074      
      4200   316.92383     -44356.438      13465.898      3583.6077      15.0372        13.535         17.6074      
      4300   324.57197     -44351.729      15285.495      3583.6077      15.0372        13.535         17.6074      
      4400   290.00376     -44344.1        16668.162      3583.6077      15.0372        13.535         17.6074      
      4500   295.99694     -44366.584      6632.2103      3583.6077      15.0372        13.535         17.6074      
      4600   298.97148     -44364.357      9074.7464      3583.6077      15.0372        13.535         17.6074      
      4700   291.02918     -44347.466      9781.0123      3583.6077      15.0372        13.535         17.6074      
      4800   292.36606     -44317.411      15260.727      3583.6077      15.0372        13.535         17.6074      
      4900   320.19672     -44320.826      15173.404      3583.6077      15.0372        13.535         17.6074      
      5000   300.3326      -44315.55       8105.795       3583.6077      15.0372        13.535         17.6074      
Loop time of 179.321 on 8 procs for 5000 steps with 366 atoms

Performance: 1.205 ns/day, 19.925 hours/ns, 27.883 timesteps/s, 10.205 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 138.71     | 142.97     | 147.27     |  24.2 | 79.73
Bond    | 0.00093981 | 0.0011547  | 0.0014339  |   0.5 |  0.00
Neigh   | 13.466     | 14.331     | 14.865     |  12.3 |  7.99
Comm    | 1.3136     | 5.6384     | 9.9385     | 122.8 |  3.14
Output  | 0.010317   | 0.011899   | 0.013349   |   0.9 |  0.01
Modify  | 15.769     | 16.271     | 17.102     |  11.1 |  9.07
Other   |            | 0.09524    |            |       |  0.05

Nlocal:          45.75 ave          53 max          38 min
Histogram: 2 1 0 0 1 0 0 1 1 2
Nghost:        3583.12 ave        3703 max        3463 min
Histogram: 1 0 2 0 1 1 1 1 0 1
Neighs:        32786.6 ave       37924 max       27169 min
Histogram: 2 1 0 0 1 0 0 1 1 2

Total # of neighbors = 262293
Ave neighs/atom = 716.64754
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.535
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 1.3535 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.9 | 143.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   268.0326      -44398.738      18808.45       3583.6077      15.0372        13.535         17.6074      
       100   305.84603     -44431.126      28272.187      3583.6077      15.0372        13.535         17.6074      
       200   289.0546      -44392.655      20676.703      3583.6077      15.0372        13.535         17.6074      
       300   302.08271     -44379.322      19715.322      3583.6077      15.0372        13.535         17.6074      
       400   301.1436      -44366.389      20904.257      3583.6077      15.0372        13.535         17.6074      
       500   298.34397     -44351.029      16245.671      3583.6077      15.0372        13.535         17.6074      
       600   314.63213     -44365.554      14489.604      3583.6077      15.0372        13.535         17.6074      
       700   284.90836     -44368.292      21264.749      3583.6077      15.0372        13.535         17.6074      
       800   269.90856     -44364.113      17245.764      3583.6077      15.0372        13.535         17.6074      
       900   293.48421     -44371.187      10218.173      3583.6077      15.0372        13.535         17.6074      
      1000   293.11267     -44351.169      25219.613      3583.6077      15.0372        13.535         17.6074      
      1100   333.82544     -44364.057      23863.102      3583.6077      15.0372        13.535         17.6074      
      1200   292.78291     -44320.54       19122.056      3583.6077      15.0372        13.535         17.6074      
      1300   307.42739     -44378.731      20376.493      3583.6077      15.0372        13.535         17.6074      
      1400   293.58648     -44382.744      11286.736      3583.6077      15.0372        13.535         17.6074      
      1500   300.29883     -44386.871      12750.501      3583.6077      15.0372        13.535         17.6074      
      1600   290.42242     -44361.316      6847.9926      3583.6077      15.0372        13.535         17.6074      
      1700   320.63786     -44368.857      16958.863      3583.6077      15.0372        13.535         17.6074      
      1800   309.12716     -44356.143      14573.682      3583.6077      15.0372        13.535         17.6074      
      1900   279.13241     -44362.26       8735.7555      3583.6077      15.0372        13.535         17.6074      
      2000   292.9365      -44380.816      23334.211      3583.6077      15.0372        13.535         17.6074      
      2100   301.10699     -44370.063      13929.651      3583.6077      15.0372        13.535         17.6074      
      2200   299.38689     -44357.411      15578.111      3583.6077      15.0372        13.535         17.6074      
      2300   313.20099     -44376.343      13162.304      3583.6077      15.0372        13.535         17.6074      
      2400   295.15909     -44376.576      2918.7618      3583.6077      15.0372        13.535         17.6074      
      2500   291.34716     -44385.381      19000.72       3583.6077      15.0372        13.535         17.6074      
      2600   296.63496     -44392.778      17459.084      3583.6077      15.0372        13.535         17.6074      
      2700   302.77862     -44380.028      24924.271      3583.6077      15.0372        13.535         17.6074      
      2800   318.5842      -44369.652      14987.651      3583.6077      15.0372        13.535         17.6074      
      2900   293.32309     -44345.499      557.45946      3583.6077      15.0372        13.535         17.6074      
      3000   303.24637     -44375.408      24745.567      3583.6077      15.0372        13.535         17.6074      
      3100   280.39765     -44355.081      17721.698      3583.6077      15.0372        13.535         17.6074      
      3200   311.4203      -44380.688      8360.6235      3583.6077      15.0372        13.535         17.6074      
      3300   300.16555     -44368.079      12204.91       3583.6077      15.0372        13.535         17.6074      
      3400   287.55169     -44358.894      15231.732      3583.6077      15.0372        13.535         17.6074      
      3500   289.76162     -44367.955      13428.064      3583.6077      15.0372        13.535         17.6074      
      3600   292.3012      -44353.644      26534.853      3583.6077      15.0372        13.535         17.6074      
      3700   296.94981     -44334.67       17029.382      3583.6077      15.0372        13.535         17.6074      
      3800   326.57609     -44358.423     -3173.707       3583.6077      15.0372        13.535         17.6074      
      3900   287.42234     -44347.504      11921.354      3583.6077      15.0372        13.535         17.6074      
      4000   282.21013     -44355.093      24432.449      3583.6077      15.0372        13.535         17.6074      
      4100   298.10654     -44362.682      14702.089      3583.6077      15.0372        13.535         17.6074      
      4200   287.83518     -44339.717      23291.262      3583.6077      15.0372        13.535         17.6074      
      4300   308.83223     -44333.277      24443.434      3583.6077      15.0372        13.535         17.6074      
      4400   317.08275     -44324.361      20116.25       3583.6077      15.0372        13.535         17.6074      
      4500   305.77497     -44341.366      10933.282      3583.6077      15.0372        13.535         17.6074      
      4600   275.89389     -44332.583      13625.332      3583.6077      15.0372        13.535         17.6074      
      4700   324.65284     -44388.953      13928.63       3583.6077      15.0372        13.535         17.6074      
      4800   299.2231      -44376.004      5174.0126      3583.6077      15.0372        13.535         17.6074      
      4900   270.82781     -44351.233      18342.535      3583.6077      15.0372        13.535         17.6074      
      5000   312.2565      -44361.542      25764.589      3583.6077      15.0372        13.535         17.6074      
Loop time of 178.887 on 8 procs for 5000 steps with 366 atoms

Performance: 1.207 ns/day, 19.876 hours/ns, 27.951 timesteps/s, 10.230 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 138.68     | 141.24     | 146.57     |  24.7 | 78.96
Bond    | 0.00090814 | 0.0011388  | 0.0014287  |   0.5 |  0.00
Neigh   | 13.585     | 14.302     | 14.747     |  10.4 |  8.00
Comm    | 1.1631     | 6.5027     | 9.0833     | 115.7 |  3.64
Output  | 0.01041    | 0.011933   | 0.013278   |   0.9 |  0.01
Modify  | 16.316     | 16.733     | 17.419     |   9.2 |  9.35
Other   |            | 0.09522    |            |       |  0.05

Nlocal:          45.75 ave          53 max          33 min
Histogram: 1 0 0 0 0 3 0 1 1 2
Nghost:        3587.12 ave        3679 max        3505 min
Histogram: 2 0 0 1 1 1 1 0 1 1
Neighs:        32801.2 ave       38149 max       23906 min
Histogram: 1 0 0 0 1 2 0 2 0 2

Total # of neighbors = 262410
Ave neighs/atom = 716.96721
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.6074
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--7.4931)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.6074
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.74931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.01585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.00807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -1.76074 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.9 | 143.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   268.0326      -44398.738      18808.45       3583.6077      15.0372        13.535         17.6074      
       100   305.79969     -44430.951      28544.559      3583.6077      15.0372        13.535         17.6074      
       200   292.76183     -44394.105      17477.339      3583.6077      15.0372        13.535         17.6074      
       300   294.48732     -44367.503      18055.232      3583.6077      15.0372        13.535         17.6074      
       400   310.54264     -44369.34       17920.914      3583.6077      15.0372        13.535         17.6074      
       500   303.3292      -44361.34       21413.694      3583.6077      15.0372        13.535         17.6074      
       600   283.78663     -44368.681      6927.4796      3583.6077      15.0372        13.535         17.6074      
       700   301.96186     -44403.079      15961.854      3583.6077      15.0372        13.535         17.6074      
       800   291.9133      -44385.628      12158.175      3583.6077      15.0372        13.535         17.6074      
       900   300.97806     -44372.453      10492.044      3583.6077      15.0372        13.535         17.6074      
      1000   289.56494     -44348.066      24434.432      3583.6077      15.0372        13.535         17.6074      
      1100   304.35637     -44360.06       17502.868      3583.6077      15.0372        13.535         17.6074      
      1200   307.88258     -44379.855      24777.304      3583.6077      15.0372        13.535         17.6074      
      1300   294.64037     -44375.421      16118.543      3583.6077      15.0372        13.535         17.6074      
      1400   303.37356     -44377.38       2082.816       3583.6077      15.0372        13.535         17.6074      
      1500   294.95314     -44357.2        17850.516      3583.6077      15.0372        13.535         17.6074      
      1600   310.68527     -44361.755      18345.592      3583.6077      15.0372        13.535         17.6074      
      1700   303.28249     -44345.304      18548.296      3583.6077      15.0372        13.535         17.6074      
      1800   307.84341     -44354.244      9713.0214      3583.6077      15.0372        13.535         17.6074      
      1900   274.46657     -44335.739      10186.225      3583.6077      15.0372        13.535         17.6074      
      2000   291.31928     -44357.185      11251.447      3583.6077      15.0372        13.535         17.6074      
      2100   284.70842     -44333.412      20794.229      3583.6077      15.0372        13.535         17.6074      
      2200   327.61154     -44340.275      29199.764      3583.6077      15.0372        13.535         17.6074      
      2300   307.53359     -44309.789      18695.067      3583.6077      15.0372        13.535         17.6074      
      2400   321.46383     -44347.533      12427.382      3583.6077      15.0372        13.535         17.6074      
      2500   298.29653     -44334.465      20463.751      3583.6077      15.0372        13.535         17.6074      
      2600   291.82926     -44326.013      11769.25       3583.6077      15.0372        13.535         17.6074      
      2700   316.83588     -44348.312      14489.421      3583.6077      15.0372        13.535         17.6074      
      2800   305.3829      -44361.492      17545.605      3583.6077      15.0372        13.535         17.6074      
      2900   279.6548      -44339.541      25097.537      3583.6077      15.0372        13.535         17.6074      
      3000   292.36511     -44334.932      14562.335      3583.6077      15.0372        13.535         17.6074      
      3100   289.28412     -44302.732     -1815.8611      3583.6077      15.0372        13.535         17.6074      
      3200   315.70731     -44313.522      1158.4834      3583.6077      15.0372        13.535         17.6074      
      3300   325.85757     -44326.91       6707.6408      3583.6077      15.0372        13.535         17.6074      
      3400   306.24491     -44315.951      9760.1657      3583.6077      15.0372        13.535         17.6074      
      3500   288.96884     -44305.818      14955.881      3583.6077      15.0372        13.535         17.6074      
      3600   304.11764     -44323.603      18236.997      3583.6077      15.0372        13.535         17.6074      
      3700   304.78809     -44324.98       28265.062      3583.6077      15.0372        13.535         17.6074      
      3800   275.90969     -44320.554      18468.666      3583.6077      15.0372        13.535         17.6074      
      3900   282.74907     -44325.699      20252.766      3583.6077      15.0372        13.535         17.6074      
      4000   305.1076      -44320.642      34279.703      3583.6077      15.0372        13.535         17.6074      
      4100   315.69818     -44319.526      11837.314      3583.6077      15.0372        13.535         17.6074      
      4200   286.35895     -44286.624      10137.676      3583.6077      15.0372        13.535         17.6074      
      4300   303.09699     -44300.919      21800.226      3583.6077      15.0372        13.535         17.6074      
      4400   303.493       -44284.033      16887.781      3583.6077      15.0372        13.535         17.6074      
      4500   322.74074     -44275.716      10899.923      3583.6077      15.0372        13.535         17.6074      
      4600   302.18549     -44270.12       12312.765      3583.6077      15.0372        13.535         17.6074      
      4700   284.00055     -44272.975      19156.078      3583.6077      15.0372        13.535         17.6074      
      4800   291.20962     -44284.603      9048.464       3583.6077      15.0372        13.535         17.6074      
      4900   291.61969     -44278.082      16365.709      3583.6077      15.0372        13.535         17.6074      
      5000   297.21302     -44265.153      18262.849      3583.6077      15.0372        13.535         17.6074      
Loop time of 176.257 on 8 procs for 5000 steps with 366 atoms

Performance: 1.225 ns/day, 19.584 hours/ns, 28.368 timesteps/s, 10.383 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 136.49     | 140.12     | 144.4      |  25.5 | 79.50
Bond    | 0.00088434 | 0.0011194  | 0.0013479  |   0.5 |  0.00
Neigh   | 13.45      | 14.165     | 14.67      |  10.4 |  8.04
Comm    | 1.4283     | 5.7397     | 9.3774     | 127.1 |  3.26
Output  | 0.010482   | 0.011983   | 0.013327   |   0.9 |  0.01
Modify  | 15.646     | 16.126     | 16.813     |   9.4 |  9.15
Other   |            | 0.09399    |            |       |  0.05

Nlocal:          45.75 ave          53 max          37 min
Histogram: 2 1 0 0 0 1 0 0 2 2
Nghost:        3747.12 ave        3852 max        3663 min
Histogram: 1 2 0 1 1 0 1 1 0 1
Neighs:        32767.2 ave       37879 max       26790 min
Histogram: 2 1 0 0 0 1 0 0 2 2

Total # of neighbors = 262138
Ave neighs/atom = 716.22404
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.6074
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 1.76074 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.9 | 139.9 | 143.3 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   268.0326      -44398.738      18808.45       3583.6077      15.0372        13.535         17.6074      
       100   305.88203     -44431.219      28047.507      3583.6077      15.0372        13.535         17.6074      
       200   292.11918     -44389.147      20190.456      3583.6077      15.0372        13.535         17.6074      
       300   300.02938     -44370.219      21918.435      3583.6077      15.0372        13.535         17.6074      
       400   310.3566      -44370.258      12432.747      3583.6077      15.0372        13.535         17.6074      
       500   301.51526     -44365.131      14955.399      3583.6077      15.0372        13.535         17.6074      
       600   293.61498     -44384.794      14704.428      3583.6077      15.0372        13.535         17.6074      
       700   289.08034     -44391.14       14672.364      3583.6077      15.0372        13.535         17.6074      
       800   286.90603     -44378.785      8161.9494      3583.6077      15.0372        13.535         17.6074      
       900   316.18802     -44379.138      8758.7792      3583.6077      15.0372        13.535         17.6074      
      1000   308.25311     -44362.17       24297.572      3583.6077      15.0372        13.535         17.6074      
      1100   306.18927     -44364.958      14631.055      3583.6077      15.0372        13.535         17.6074      
      1200   304.88001     -44374.776      15631.143      3583.6077      15.0372        13.535         17.6074      
      1300   302.54834     -44384.054      18238.811      3583.6077      15.0372        13.535         17.6074      
      1400   291.74125     -44370.028      24386.879      3583.6077      15.0372        13.535         17.6074      
      1500   293.17686     -44363.027      4791.9698      3583.6077      15.0372        13.535         17.6074      
      1600   302.39225     -44360.282      29326.671      3583.6077      15.0372        13.535         17.6074      
      1700   308.50122     -44365.358      14758.237      3583.6077      15.0372        13.535         17.6074      
      1800   288.56944     -44356.888      15514.703      3583.6077      15.0372        13.535         17.6074      
      1900   293.22954     -44368.678      18461.648      3583.6077      15.0372        13.535         17.6074      
      2000   311.59831     -44379.158      14939.992      3583.6077      15.0372        13.535         17.6074      
      2100   298.2213      -44355.464      15702.749      3583.6077      15.0372        13.535         17.6074      
      2200   316.51961     -44365.713      24573.456      3583.6077      15.0372        13.535         17.6074      
      2300   303.59512     -44355.832      25137.954      3583.6077      15.0372        13.535         17.6074      
      2400   300.92914     -44366.329      15671.514      3583.6077      15.0372        13.535         17.6074      
      2500   297.74826     -44377.621      27995.256      3583.6077      15.0372        13.535         17.6074      
      2600   307.66997     -44376.04       16786.434      3583.6077      15.0372        13.535         17.6074      
      2700   318.48219     -44343.615      23871.053      3583.6077      15.0372        13.535         17.6074      
      2800   325.0401      -44339.882      22122.07       3583.6077      15.0372        13.535         17.6074      
      2900   294.89346     -44330.096      20331.204      3583.6077      15.0372        13.535         17.6074      
      3000   303.5972      -44345.993      14452.986      3583.6077      15.0372        13.535         17.6074      
      3100   277.74791     -44319.938      25011.524      3583.6077      15.0372        13.535         17.6074      
      3200   285.45978     -44324.809      17850.877      3583.6077      15.0372        13.535         17.6074      
      3300   306.06853     -44333.669      24754.056      3583.6077      15.0372        13.535         17.6074      
      3400   295.35933     -44330.362      13326.757      3583.6077      15.0372        13.535         17.6074      
      3500   298.5452      -44342.083      17455.024      3583.6077      15.0372        13.535         17.6074      
      3600   292.45259     -44339.103      13856.536      3583.6077      15.0372        13.535         17.6074      
      3700   299.50333     -44335.183      21915.825      3583.6077      15.0372        13.535         17.6074      
      3800   295.76669     -44307.042      31981.575      3583.6077      15.0372        13.535         17.6074      
      3900   320.63756     -44303.153      29197.665      3583.6077      15.0372        13.535         17.6074      
      4000   303.86918     -44280.625      18911.569      3583.6077      15.0372        13.535         17.6074      
      4100   304.26863     -44314.403      3280.9906      3583.6077      15.0372        13.535         17.6074      
      4200   298.09533     -44310.146      4907.9105      3583.6077      15.0372        13.535         17.6074      
      4300   297.36349     -44299.55       205.43675      3583.6077      15.0372        13.535         17.6074      
      4400   305.16771     -44286.641      18162.13       3583.6077      15.0372        13.535         17.6074      
      4500   293.90705     -44257.574      4163.699       3583.6077      15.0372        13.535         17.6074      
      4600   309.86898     -44288.128      13769.116      3583.6077      15.0372        13.535         17.6074      
      4700   297.33849     -44295.308      21673.393      3583.6077      15.0372        13.535         17.6074      
      4800   277.98185     -44278.507      7404.2315      3583.6077      15.0372        13.535         17.6074      
      4900   300.87059     -44284.106      20316.204      3583.6077      15.0372        13.535         17.6074      
      5000   309.38119     -44264.12       14586.585      3583.6077      15.0372        13.535         17.6074      
Loop time of 159.305 on 8 procs for 5000 steps with 366 atoms

Performance: 1.356 ns/day, 17.701 hours/ns, 31.386 timesteps/s, 11.487 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 118.61     | 122.22     | 128.39     |  33.2 | 76.72
Bond    | 0.00081428 | 0.00097848 | 0.0012303  |   0.0 |  0.00
Neigh   | 12.759     | 13.359     | 13.697     |   8.9 |  8.39
Comm    | 1.3379     | 7.541      | 11.165     | 134.4 |  4.73
Output  | 0.011332   | 0.012776   | 0.01407    |   0.8 |  0.01
Modify  | 15.769     | 16.087     | 16.653     |   7.6 | 10.10
Other   |            | 0.08788    |            |       |  0.06

Nlocal:          45.75 ave          56 max          32 min
Histogram: 1 0 1 0 1 2 0 1 0 2
Nghost:        3447.88 ave        3527 max        3368 min
Histogram: 1 1 0 0 3 1 0 0 0 2
Neighs:        32788.4 ave       40272 max       23241 min
Histogram: 1 0 1 0 2 1 0 1 0 2

Total # of neighbors = 262307
Ave neighs/atom = 716.68579
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:56:18
