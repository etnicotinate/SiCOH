LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 30*${nthermo}       # steps of equilibration run 10
variable nequil equal 30*100       
variable nrun equal 30*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 30*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-HD-100C-11-VASP
read_data       ${structure}.data
read_data       333-HD-100C-11-VASP.data
Reading data file ...
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.007 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 5.2852e-05 on 8 procs for 1 steps with 366 atoms

48.0% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.536e-06  | 1.536e-06  | 1.536e-06  |   0.0 |  2.91
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 4.75e-06   | 4.75e-06   | 4.75e-06   |   0.0 |  8.99
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 4.657e-05  |            |       | 88.11

Nlocal:          45.75 ave          53 max          35 min
Histogram: 1 0 1 0 1 1 0 1 1 2
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-HD-100C-11-VASP_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
run ${nequil}
run 3000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -29.52 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.2 | 139 | 142.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -43876.171      80037.985      1.9939932      3583.6077    
       100   394.17576     -44053.219      17438.286      1.9939932      3583.6077    
       200   353.44894     -44122.092      12299.895      1.9939932      3583.6077    
       300   324.73763     -44187.232      17674.139      1.9939932      3583.6077    
       400   316.60576     -44251.386      26668.937      1.9939932      3583.6077    
       500   311.85452     -44293.493      20499.652      1.9939932      3583.6077    
       600   286.90192     -44299.222      13302.392      1.9939932      3583.6077    
       700   293.9852      -44333.746      6045.8646      1.9939932      3583.6077    
       800   296.58519     -44345.153      18019.463      1.9939932      3583.6077    
       900   311.3918      -44353.462      21599.515      1.9939932      3583.6077    
      1000   297.75059     -44329.901      15334.277      1.9939932      3583.6077    
      1100   290.728       -44325.476      14209.613      1.9939932      3583.6077    
      1200   293.44941     -44350.793      15007.44       1.9939932      3583.6077    
      1300   294.9809      -44369.407      25845.97       1.9939932      3583.6077    
      1400   291.6881      -44370.896      5818.0434      1.9939932      3583.6077    
      1500   293.78555     -44356.303      22209.944      1.9939932      3583.6077    
      1600   299.4853      -44339.745      4633.8131      1.9939932      3583.6077    
      1700   309.0057      -44340.755      7974.3743      1.9939932      3583.6077    
      1800   299.93052     -44359.203      13186.124      1.9939932      3583.6077    
      1900   305.26822     -44389.751      18537.767      1.9939932      3583.6077    
      2000   284.83743     -44366.724      13040.585      1.9939932      3583.6077    
      2100   300.81289     -44367.304      8527.9041      1.9939932      3583.6077    
      2200   307.36822     -44359.291      16552.389      1.9939932      3583.6077    
      2300   310.06431     -44352.431      24597.191      1.9939932      3583.6077    
      2400   288.95655     -44357.024      15415.624      1.9939932      3583.6077    
      2500   278.87469     -44372.916      20698.218      1.9939932      3583.6077    
      2600   298.73446     -44388.666      11724.123      1.9939932      3583.6077    
      2700   292.64405     -44356.357      5051.7517      1.9939932      3583.6077    
      2800   313.35678     -44363.799      14684.432      1.9939932      3583.6077    
      2900   314.86929     -44372.789      25773.11       1.9939932      3583.6077    
      3000   290.50298     -44362.951      19010.829      1.9939932      3583.6077    
Loop time of 183.892 on 8 procs for 3000 steps with 366 atoms

Performance: 0.705 ns/day, 34.054 hours/ns, 16.314 timesteps/s, 5.971 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 117.02     | 144.82     | 156.74     | 104.1 | 78.75
Bond    | 0.0081688  | 0.0088026  | 0.0090563  |   0.3 |  0.00
Neigh   | 9.0786     | 11.294     | 12.165     |  28.9 |  6.14
Comm    | 1.4567     | 13.391     | 41.211     | 342.5 |  7.28
Output  | 0.001643   | 0.0017755  | 0.0026468  |   0.8 |  0.00
Modify  | 13.456     | 14.297     | 16.503     |  25.5 |  7.77
Other   |            | 0.07894    |            |       |  0.04

Nlocal:          45.75 ave          55 max          32 min
Histogram: 1 0 0 2 0 1 1 0 0 3
Nghost:        3584.38 ave        3671 max        3504 min
Histogram: 2 0 0 0 3 0 1 0 1 1
Neighs:        32812.8 ave       39143 max       23225 min
Histogram: 1 0 0 2 0 1 0 1 0 3

Total # of neighbors = 262502
Ave neighs/atom = 717.21858
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333-HD-100C-11-VASP_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.0372
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.535
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.6074

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.0807
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal -0.1585
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -7.4931

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 15.0372
variable dlen equal lx-${len0}
variable dlen equal lx-15.0372
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.0372
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.074931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.001585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.000807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.150372 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.150372 xy delta 0.074931 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.150372 xy delta 0.074931 xz delta 0.001585 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.8 | 139.4 | 142.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   290.50298     -44362.951      19010.941      1.9939932      3583.6077    
       100   302.80198     -44374.371      11169.691      1.9946581      3582.4132    
       200   317.26458     -44385.878      15013.857      1.9953234      3581.2187    
       300   284.13819     -44357.881      13205.862      1.9959892      3580.0241    
       400   306.77893     -44388.147      22332.273      1.9966554      3578.8296    
       500   288.86581     -44366.736      23717.053      1.9973221      3577.6351    
       600   305.92455     -44362.987      16109.873      1.9979892      3576.4405    
       700   303.15543     -44345.206      8097.5083      1.9986567      3575.246     
       800   324.65319     -44376.732      17390.464      1.9993247      3574.0515    
       900   291.24445     -44371.067      20991.032      1.9999932      3572.8569    
      1000   285.79658     -44373.444      28080.532      2.0006621      3571.6624    
      1100   292.09732     -44363.327      7977.8967      2.0013314      3570.4679    
      1200   309.98728     -44368.547      14690.7        2.0020012      3569.2733    
      1300   301.40474     -44361.584      10554.362      2.0026714      3568.0788    
      1400   287.33171     -44352.927      18943.39       2.0033421      3566.8842    
      1500   325.39588     -44389.809      15328.847      2.0040133      3565.6897    
      1600   293.10653     -44350.227      19932.25       2.0046849      3564.4952    
      1700   322.67477     -44370.198      18360.509      2.0053569      3563.3006    
      1800   296.65525     -44331.777      25281.375      2.0060294      3562.1061    
      1900   295.62303     -44341.361      21259.761      2.0067023      3560.9116    
      2000   295.59998     -44372.743      13518.047      2.0073757      3559.717     
      2100   303.95576     -44390.952      23156.56       2.0080495      3558.5225    
      2200   307.79763     -44384.162      22013.917      2.0087238      3557.328     
      2300   285.87908     -44340.378      12894.978      2.0093986      3556.1334    
      2400   333.76496     -44353.923      17688.787      2.0100738      3554.9389    
      2500   336.52901     -44366.359      29763.766      2.0107494      3553.7443    
      2600   291.89191     -44345.926      15589.895      2.0114256      3552.5498    
      2700   310.43928     -44384.032      24759.954      2.0121021      3551.3553    
      2800   293.04581     -44383.03       26995.065      2.0127791      3550.1607    
      2900   288.77481     -44377.908      17133.601      2.0134566      3548.9662    
      3000   303.46621     -44355.396      18329.401      2.0141345      3547.7717    
Loop time of 188.224 on 8 procs for 3000 steps with 366 atoms

Performance: 0.689 ns/day, 34.856 hours/ns, 15.938 timesteps/s, 5.833 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 139.36     | 152.85     | 160.45     |  47.0 | 81.20
Bond    | 0.0083719  | 0.0090991  | 0.0096643  |   0.4 |  0.00
Neigh   | 10.679     | 11.883     | 12.51      |  16.5 |  6.31
Comm    | 1.2052     | 8.8247     | 22.333     | 196.1 |  4.69
Output  | 0.0093135  | 0.010655   | 0.012011   |   0.9 |  0.01
Modify  | 13.935     | 14.563     | 15.754     |  14.6 |  7.74
Other   |            | 0.08738    |            |       |  0.05

Nlocal:          45.75 ave          53 max          36 min
Histogram: 1 1 0 1 1 0 1 0 0 3
Nghost:        3605.12 ave        3702 max        3504 min
Histogram: 1 1 0 0 2 1 1 0 0 2
Neighs:          33121 ave       38395 max       26273 min
Histogram: 1 1 0 2 0 0 1 0 0 3

Total # of neighbors = 264968
Ave neighs/atom = 723.95628
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.0372
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.150372 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.150372 xy delta -0.074931 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.150372 xy delta -0.074931 xz delta -0.001585 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.8 | 139.4 | 142.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   290.50298     -44362.951      19010.941      1.9939932      3583.6077    
       100   302.86161     -44374.532      11216.982      1.9933288      3584.8023    
       200   319.04576     -44388.755      13914.599      1.9926648      3585.9968    
       300   290.09691     -44365.633      14888.342      1.9920012      3587.1914    
       400   292.76615     -44373.849      15602.258      1.9913381      3588.3859    
       500   308.55336     -44372.315      14955.036      1.9906754      3589.5804    
       600   318.69388     -44358.444      9081.7314      1.9900132      3590.775     
       700   307.1655      -44347.443      4983.1329      1.9893514      3591.9695    
       800   303.6994      -44374.803      10795.956      1.98869        3593.164     
       900   299.21354     -44380.3        23389.32       1.9880291      3594.3586    
      1000   308.50842     -44388.188      15096.282      1.9873686      3595.5531    
      1100   280.4046      -44352.073      14013.95       1.9867086      3596.7476    
      1200   313.28795     -44360.641      15278.153      1.986049       3597.9422    
      1300   323.46803     -44360.346      10702.193      1.9853898      3599.1367    
      1400   286.06609     -44350.026      23331.447      1.9847311      3600.3312    
      1500   307.95534     -44388.436      15521.03       1.9840728      3601.5258    
      1600   300.69293     -44374.814      14391.54       1.983415       3602.7203    
      1700   290.01682     -44361.553      4942.0865      1.9827576      3603.9149    
      1800   300.61199     -44364.428      7717.3648      1.9821006      3605.1094    
      1900   300.05276     -44358.64       20480.776      1.9814441      3606.3039    
      2000   297.60956     -44379.183      25554.871      1.9807879      3607.4985    
      2100   279.59266     -44372.189      11097.77       1.9801323      3608.693     
      2200   308.29629     -44394.008      6873.8162      1.979477       3609.8875    
      2300   311.28489     -44364.526      12186.514      1.9788222      3611.0821    
      2400   315.41013     -44353.365      11702.92       1.9781679      3612.2766    
      2500   321.22312     -44368.983      12818.763      1.9775139      3613.4711    
      2600   308.39183     -44371.02      -2709.6968      1.9768604      3614.6657    
      2700   305.39174     -44379.398      16899.023      1.9762073      3615.8602    
      2800   300.87398     -44380.892      14453.921      1.9755547      3617.0548    
      2900   298.26823     -44386.292      17827.167      1.9749025      3618.2493    
      3000   292.05314     -44381.579      12375.398      1.9742507      3619.4438    
Loop time of 182.363 on 8 procs for 3000 steps with 366 atoms

Performance: 0.711 ns/day, 33.771 hours/ns, 16.451 timesteps/s, 6.021 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 148.61     | 151.31     | 155.13     |  17.8 | 82.97
Bond    | 0.0087901  | 0.0090588  | 0.0096199  |   0.3 |  0.00
Neigh   | 11.396     | 11.754     | 12.108     |   7.4 |  6.45
Comm    | 1.6659     | 5.5068     | 8.2412     |  94.1 |  3.02
Output  | 0.0098147  | 0.011174   | 0.01249    |   0.9 |  0.01
Modify  | 13.356     | 13.684     | 14.014     |   6.4 |  7.50
Other   |            | 0.08654    |            |       |  0.05

Nlocal:          45.75 ave          54 max          33 min
Histogram: 1 0 1 0 1 1 1 0 0 3
Nghost:           3567 ave        3660 max        3486 min
Histogram: 2 0 1 1 0 1 1 0 1 1
Neighs:          32487 ave       38328 max       23720 min
Histogram: 1 0 1 0 1 1 1 0 0 3

Total # of neighbors = 259896
Ave neighs/atom = 710.09836
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.535
variable dlen equal ly-${len0}
variable dlen equal ly-13.535
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.535
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.074931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.001585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.000807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.13535 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.13535 yz delta -0.000807 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.8 | 139.4 | 142.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   290.50298     -44362.951      19010.941      1.9939932      3583.6077    
       100   302.87157     -44374.459      11196.493      1.9946581      3582.4132    
       200   319.36124     -44388.614      14212.432      1.9953234      3581.2187    
       300   288.74786     -44364.544      13240.62       1.9959892      3580.0241    
       400   293.59719     -44376.58       20691.736      1.9966554      3578.8296    
       500   286.21972     -44373.996      27223.265      1.9973221      3577.6351    
       600   290.38407     -44365.772      18728.315      1.9979892      3576.4405    
       700   299.11352     -44354.309      14155.286      1.9986567      3575.246     
       800   295.10617     -44356.732      11454.433      1.9993247      3574.0515    
       900   282.02961     -44371.873      28444.778      1.9999932      3572.8569    
      1000   270.76461     -44370.709      23374.771      2.0006621      3571.6624    
      1100   306.50816     -44393.229      8237.7332      2.0013314      3570.4679    
      1200   297.54389     -44373.792      17920.807      2.0020012      3569.2733    
      1300   303.90441     -44374.116      11565.958      2.0026714      3568.0788    
      1400   321.24622     -44380.361      26869.832      2.0033421      3566.8842    
      1500   304.53498     -44369.673      25356.245      2.0040133      3565.6897    
      1600   289.68525     -44386.381      27212.956      2.0046849      3564.4952    
      1700   285.26679     -44392.939      21037.262      2.0053569      3563.3006    
      1800   300.23402     -44386.837      16327.269      2.0060294      3562.1061    
      1900   312.73849     -44378.806      25300.84       2.0067023      3560.9116    
      2000   301.2207      -44369.005      16402.051      2.0073757      3559.717     
      2100   297.06654     -44363.311      12046.939      2.0080495      3558.5225    
      2200   295.69038     -44366.903      32441.508      2.0087238      3557.328     
      2300   281.73486     -44385.784      9379.4462      2.0093986      3556.1334    
      2400   304.70104     -44410.131      16238.888      2.0100738      3554.9389    
      2500   287.40468     -44369.486      27517.953      2.0107494      3553.7443    
      2600   293.70186     -44357.969      8357.1938      2.0114256      3552.5498    
      2700   292.86104     -44364.554      12708.811      2.0121021      3551.3553    
      2800   296.28344     -44376.282      10239.11       2.0127791      3550.1607    
      2900   296.9004      -44381.701      9677.2114      2.0134566      3548.9662    
      3000   284.23669     -44377.934      14923.675      2.0141345      3547.7717    
Loop time of 184.769 on 8 procs for 3000 steps with 366 atoms

Performance: 0.701 ns/day, 34.217 hours/ns, 16.236 timesteps/s, 5.943 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 129.58     | 150.22     | 156.75     |  65.1 | 81.30
Bond    | 0.008713   | 0.0089751  | 0.009248   |   0.2 |  0.00
Neigh   | 10.115     | 11.696     | 12.311     |  19.4 |  6.33
Comm    | 2.0927     | 8.6569     | 29.282     | 271.2 |  4.69
Output  | 0.0098559  | 0.011266   | 0.012574   |   0.9 |  0.01
Modify  | 13.499     | 14.092     | 15.695     |  17.6 |  7.63
Other   |            | 0.08402    |            |       |  0.05

Nlocal:          45.75 ave          57 max          32 min
Histogram: 1 0 1 1 1 0 0 1 2 1
Nghost:        3626.75 ave        3719 max        3542 min
Histogram: 2 0 0 0 2 2 0 0 1 1
Neighs:        33146.8 ave       40864 max       23456 min
Histogram: 1 0 1 2 0 0 0 1 2 1

Total # of neighbors = 265174
Ave neighs/atom = 724.51913
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.535
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.13535 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.13535 yz delta 0.000807 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.8 | 139.4 | 142.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   290.50298     -44362.951      19010.941      1.9939932      3583.6077    
       100   302.80286     -44374.441      11185.207      1.9933288      3584.8023    
       200   316.75704     -44385.931      15125.048      1.9926648      3585.9968    
       300   283.77031     -44358.217      9791.5921      1.9920012      3587.1914    
       400   290.95737     -44373.457      20057.378      1.9913381      3588.3859    
       500   293.22526     -44363.527      34004.904      1.9906754      3589.5804    
       600   316.23265     -44361.387      19682.734      1.9900132      3590.775     
       700   323.3827      -44361.436      19186.444      1.9893514      3591.9695    
       800   299.09933     -44364.664      14838.989      1.98869        3593.164     
       900   298.483       -44372.833      16598.806      1.9880291      3594.3586    
      1000   301.55645     -44366.43       9082.2933      1.9873686      3595.5531    
      1100   312.78214     -44364.136      20798.595      1.9867086      3596.7476    
      1200   317.98502     -44368.772      12297.935      1.986049       3597.9422    
      1300   307.39852     -44367.174      15043.158      1.9853898      3599.1367    
      1400   290.93174     -44355.825      20613.347      1.9847311      3600.3312    
      1500   289.10232     -44363.179      25738.303      1.9840728      3601.5258    
      1600   291.0695      -44393.033      14090.856      1.983415       3602.7203    
      1700   268.88743     -44397.664     -9540.1837      1.9827576      3603.9149    
      1800   282.96217     -44401.825      11110.531      1.9821006      3605.1094    
      1900   295.77829     -44387.96       13852.685      1.9814441      3606.3039    
      2000   295.98829     -44374.55       414.74692      1.9807879      3607.4985    
      2100   292.97727     -44358.563      465.47653      1.9801323      3608.693     
      2200   319.01116     -44375.56       379.29855      1.979477       3609.8875    
      2300   318.80865     -44380.672      10987.559      1.9788222      3611.0821    
      2400   286.41136     -44379.448      16974.899      1.9781679      3612.2766    
      2500   286.09511     -44385.273      4653.2363      1.9775139      3613.4711    
      2600   287.68712     -44374.811     -3594.3684      1.9768604      3614.6657    
      2700   307.29689     -44360.533      11120.229      1.9762073      3615.8602    
      2800   323.80203     -44375.716      18134.128      1.9755547      3617.0548    
      2900   291.73831     -44359.118      22483.233      1.9749025      3618.2493    
      3000   289.97033     -44369.102      10769.632      1.9742507      3619.4438    
Loop time of 185.366 on 8 procs for 3000 steps with 366 atoms

Performance: 0.699 ns/day, 34.327 hours/ns, 16.184 timesteps/s, 5.923 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 116.39     | 147.2      | 157.88     |  99.9 | 79.41
Bond    | 0.0078255  | 0.0088606  | 0.0092584  |   0.5 |  0.00
Neigh   | 9.3914     | 11.573     | 12.516     |  27.2 |  6.24
Comm    | 0.9758     | 11.68      | 42.455     | 354.6 |  6.30
Output  | 0.010102   | 0.011519   | 0.012762   |   0.8 |  0.01
Modify  | 13.864     | 14.801     | 17.03      |  24.2 |  7.98
Other   |            | 0.08698    |            |       |  0.05

Nlocal:          45.75 ave          53 max          34 min
Histogram: 1 0 0 0 2 1 1 0 1 2
Nghost:        3555.75 ave        3654 max        3478 min
Histogram: 2 0 0 1 2 0 1 1 0 1
Neighs:        32491.4 ave       37612 max       24407 min
Histogram: 1 0 0 1 1 1 0 1 1 2

Total # of neighbors = 259931
Ave neighs/atom = 710.19399
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.6074
variable dlen equal lz-${len0}
variable dlen equal lz-17.6074
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.6074
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.074931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.001585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.000807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -0.176074 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.8 | 139.4 | 142.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   290.50298     -44362.951      19010.941      1.9939932      3583.6077    
       100   302.88831     -44374.465      11184.366      1.9946581      3582.4132    
       200   319.68894     -44388.755      14170.206      1.9953234      3581.2187    
       300   282.9038      -44357.825      12447.311      1.9959892      3580.0241    
       400   309.98368     -44391.341      24186.354      1.9966554      3578.8296    
       500   297.02109     -44357.194      14025.86       1.9973221      3577.6351    
       600   297.44463     -44332.186      26684.625      1.9979892      3576.4405    
       700   311.80307     -44340.708      5153.1017      1.9986567      3575.246     
       800   299.99033     -44361.659      15147.721      1.9993247      3574.0515    
       900   305.14723     -44383.861      25001.384      1.9999932      3572.8569    
      1000   305.09167     -44383.008      14801.072      2.0006621      3571.6624    
      1100   318.81741     -44383.276      16286.194      2.0013314      3570.4679    
      1200   321.86141     -44364.074      15290.866      2.0020012      3569.2733    
      1300   314.46616     -44343.143      28118.938      2.0026714      3568.0788    
      1400   283.85619     -44331.201      21607.171      2.0033421      3566.8842    
      1500   307.39913     -44379.73       14819.502      2.0040133      3565.6897    
      1600   308.03327     -44393.687      13068.934      2.0046849      3564.4952    
      1700   305.45776     -44396.004      15329.812      2.0053569      3563.3006    
      1800   305.91395     -44388.892      20024.083      2.0060294      3562.1061    
      1900   308.31005     -44362.085      25400.822      2.0067023      3560.9116    
      2000   305.89009     -44350.762      19785.012      2.0073757      3559.717     
      2100   314.98945     -44380.164      8787.9201      2.0080495      3558.5225    
      2200   301.0261      -44393.394      14303.593      2.0087238      3557.328     
      2300   294.62132     -44387.479      16469.371      2.0093986      3556.1334    
      2400   305.02748     -44385.462      8047.9221      2.0100738      3554.9389    
      2500   324.19928     -44390.172      16389.132      2.0107494      3553.7443    
      2600   316.29155     -44382.622      10884.119      2.0114256      3552.5498    
      2700   284.98341     -44367.287      20089.234      2.0121021      3551.3553    
      2800   297.69899     -44420.874      9111.0149      2.0127791      3550.1607    
      2900   281.5449      -44395.476      28806.251      2.0134566      3548.9662    
      3000   294.69338     -44380.724      14240.251      2.0141345      3547.7717    
Loop time of 183.856 on 8 procs for 3000 steps with 366 atoms

Performance: 0.705 ns/day, 34.047 hours/ns, 16.317 timesteps/s, 5.972 katom-step/s
99.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 107.9      | 139.3      | 156.62     | 152.3 | 75.77
Bond    | 0.0081201  | 0.0087792  | 0.0093062  |   0.3 |  0.00
Neigh   | 8.5866     | 10.864     | 12.309     |  40.7 |  5.91
Comm    | 1.2782     | 18.633     | 49.998     | 416.2 | 10.13
Output  | 0.010502   | 0.012169   | 0.013773   |   1.0 |  0.01
Modify  | 13.54      | 14.959     | 17.281     |  35.1 |  8.14
Other   |            | 0.07867    |            |       |  0.04

Nlocal:          45.75 ave          55 max          33 min
Histogram: 1 0 0 2 0 1 1 0 0 3
Nghost:        3604.12 ave        3708 max        3521 min
Histogram: 2 0 1 0 2 0 1 1 0 1
Neighs:        33163.4 ave       39741 max       24221 min
Histogram: 1 0 0 2 0 1 1 0 1 2

Total # of neighbors = 265307
Ave neighs/atom = 724.88251
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.6074
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 0.176074 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.8 | 139.4 | 142.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   290.50298     -44362.951      19010.941      1.9939932      3583.6077    
       100   302.78275     -44374.445      11197.951      1.9933288      3584.8023    
       200   317.47904     -44386.561      15322.661      1.9926648      3585.9968    
       300   287.85446     -44362.944      9438.4146      1.9920012      3587.1914    
       400   303.84447     -44389.818      15601.424      1.9913381      3588.3859    
       500   281.04269     -44377.602      12289.169      1.9906754      3589.5804    
       600   290.77837     -44383.86       16942.109      1.9900132      3590.775     
       700   309.01921     -44373.111      24780.644      1.9893514      3591.9695    
       800   293.96334     -44346.98       16960.68       1.98869        3593.164     
       900   304.98713     -44368.838      30757.327      1.9880291      3594.3586    
      1000   301.89859     -44395.001      18756.942      1.9873686      3595.5531    
      1100   283.53108     -44387.912      8799.3621      1.9867086      3596.7476    
      1200   282.75185     -44368.763      10202.58       1.986049       3597.9422    
      1300   299.65343     -44378.75       17142.851      1.9853898      3599.1367    
      1400   298.01584     -44366.506      7676.2652      1.9847311      3600.3312    
      1500   308.18093     -44366.465      9480.7403      1.9840728      3601.5258    
      1600   291.34213     -44371.58       16767.89       1.983415       3602.7203    
      1700   303.31895     -44406.313      6392.9006      1.9827576      3603.9149    
      1800   298.34349     -44397.181      21438.911      1.9821006      3605.1094    
      1900   295.42526     -44379.613      11611.474      1.9814441      3606.3039    
      2000   309.04921     -44380.346      10392.113      1.9807879      3607.4985    
      2100   321.07463     -44376.162      16319.277      1.9801323      3608.693     
      2200   309.88764     -44373.283      7309.8399      1.979477       3609.8875    
      2300   298.58561     -44393.69       1211.4768      1.9788222      3611.0821    
      2400   287.26465     -44380.791      11660.773      1.9781679      3612.2766    
      2500   308.91168     -44391.475      4710.966       1.9775139      3613.4711    
      2600   311.56812     -44378.084      15100.07       1.9768604      3614.6657    
      2700   301.40741     -44355.735      4667.6159      1.9762073      3615.8602    
      2800   312.59458     -44370.182      13287.195      1.9755547      3617.0548    
      2900   294.08627     -44376.017      15760.559      1.9749025      3618.2493    
      3000   284.22824     -44377.898      1143.078       1.9742507      3619.4438    
Loop time of 182.092 on 8 procs for 3000 steps with 366 atoms

Performance: 0.712 ns/day, 33.721 hours/ns, 16.475 timesteps/s, 6.030 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 102.99     | 142.86     | 154.94     | 132.7 | 78.45
Bond    | 0.0084837  | 0.0088801  | 0.0093007  |   0.3 |  0.00
Neigh   | 8.1602     | 11.162     | 11.989     |  35.4 |  6.13
Comm    | 1.6254     | 13.728     | 53.611     | 428.3 |  7.54
Output  | 0.0098192  | 0.011359   | 0.012801   |   0.9 |  0.01
Modify  | 13.435     | 14.243     | 17.236     |  31.3 |  7.82
Other   |            | 0.08093    |            |       |  0.04

Nlocal:          45.75 ave          54 max          33 min
Histogram: 1 0 0 1 1 1 1 0 0 3
Nghost:        3583.88 ave        3692 max        3486 min
Histogram: 2 0 0 1 2 0 1 0 1 1
Neighs:        32478.2 ave       38196 max       23648 min
Histogram: 1 0 0 1 1 1 1 0 1 2

Total # of neighbors = 259826
Ave neighs/atom = 709.9071
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 15.0372
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.0807)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.0372
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.074931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.001585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.000807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -0.150372 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.8 | 139.4 | 142.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   290.50298     -44362.951      19010.941      1.9939932      3583.6077    
       100   302.82614     -44374.464      11188.958      1.9939932      3583.6077    
       200   318.66765     -44387.892      14386.755      1.9939932      3583.6077    
       300   284.88453     -44360.723      12443.951      1.9939932      3583.6077    
       400   294.51447     -44376.739      14472.816      1.9939932      3583.6077    
       500   290.95158     -44360.474      14771.549      1.9939932      3583.6077    
       600   302.61385     -44348.521      17299.071      1.9939932      3583.6077    
       700   306.29181     -44342.217      22230.956      1.9939932      3583.6077    
       800   294.24983     -44351.045      7551.0275      1.9939932      3583.6077    
       900   303.64397     -44386.404      22200.122      1.9939932      3583.6077    
      1000   279.40134     -44360.912      18801.053      1.9939932      3583.6077    
      1100   305.41151     -44372.714      27332.766      1.9939932      3583.6077    
      1200   307.2969      -44360.273      16012.425      1.9939932      3583.6077    
      1300   307.59923     -44367.567      21340.843      1.9939932      3583.6077    
      1400   288.43901     -44397.116      19926.443      1.9939932      3583.6077    
      1500   287.69393     -44397.171      18239.53       1.9939932      3583.6077    
      1600   289.63316     -44373.136      14994.902      1.9939932      3583.6077    
      1700   312.6599      -44379.271      11981.893      1.9939932      3583.6077    
      1800   292.44211     -44360.668      15302.672      1.9939932      3583.6077    
      1900   287.45435     -44364.147      21320.448      1.9939932      3583.6077    
      2000   294.36695     -44392.506      23935.537      1.9939932      3583.6077    
      2100   286.04866     -44394.85       14052.511      1.9939932      3583.6077    
      2200   309.52329     -44398.371      14262.417      1.9939932      3583.6077    
      2300   290.3872      -44352.569      10726.222      1.9939932      3583.6077    
      2400   291.75675     -44355.878      10879.028      1.9939932      3583.6077    
      2500   298.08203     -44362.752      29806.683      1.9939932      3583.6077    
      2600   311.86943     -44388.128      24624.702      1.9939932      3583.6077    
      2700   283.15138     -44360.81       17759.076      1.9939932      3583.6077    
      2800   313.65742     -44389.746      14458.799      1.9939932      3583.6077    
      2900   294.10747     -44377.32       18798.25       1.9939932      3583.6077    
      3000   274.97014     -44376.795     -5491.1837      1.9939932      3583.6077    
Loop time of 175.453 on 8 procs for 3000 steps with 366 atoms

Performance: 0.739 ns/day, 32.491 hours/ns, 17.099 timesteps/s, 6.258 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 99.176     | 132.13     | 146.9      | 147.4 | 75.31
Bond    | 0.0080318  | 0.0085113  | 0.0090262  |   0.4 |  0.00
Neigh   | 8.2218     | 10.693     | 11.899     |  39.0 |  6.09
Comm    | 3.521      | 18.327     | 51.3       | 395.6 | 10.45
Output  | 0.0096411  | 0.010989   | 0.01238    |   0.9 |  0.01
Modify  | 13.029     | 14.204     | 16.665     |  34.0 |  8.10
Other   |            | 0.07636    |            |       |  0.04

Nlocal:          45.75 ave          55 max          33 min
Histogram: 1 0 1 0 0 3 0 0 1 2
Nghost:        3596.62 ave        3689 max        3509 min
Histogram: 1 1 1 0 2 0 0 1 1 1
Neighs:          32809 ave       39210 max       23974 min
Histogram: 1 0 1 0 1 1 1 0 2 1

Total # of neighbors = 262472
Ave neighs/atom = 717.13661
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.0372
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 0.150372 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.8 | 139.4 | 142.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   290.50298     -44362.951      19010.941      1.9939932      3583.6077    
       100   302.8399      -44374.438      11191.266      1.9939932      3583.6077    
       200   318.85303     -44388.088      13908.461      1.9939932      3583.6077    
       300   287.77814     -44363.517      13661.549      1.9939932      3583.6077    
       400   312.35973     -44395.463      20882.71       1.9939932      3583.6077    
       500   286.24064     -44344.002      25121.086      1.9939932      3583.6077    
       600   314.9488      -44351.5        12237.402      1.9939932      3583.6077    
       700   319.80439     -44356.751      11952.865      1.9939932      3583.6077    
       800   307.49043     -44374.23       13060.017      1.9939932      3583.6077    
       900   312.42243     -44391.056      23800.743      1.9939932      3583.6077    
      1000   306.57418     -44382.106      24560.188      1.9939932      3583.6077    
      1100   284.0274      -44343.123      16153.862      1.9939932      3583.6077    
      1200   314.94094     -44347.055      12994.184      1.9939932      3583.6077    
      1300   332.05417     -44345.689      16043.303      1.9939932      3583.6077    
      1400   331.47703     -44357.472      25015.937      1.9939932      3583.6077    
      1500   297.13656     -44361.766      20980.111      1.9939932      3583.6077    
      1600   287.87862     -44364.521      17851.562      1.9939932      3583.6077    
      1700   284.92866     -44368.265      2812.2824      1.9939932      3583.6077    
      1800   290.96218     -44375.087      6559.1479      1.9939932      3583.6077    
      1900   285.85002     -44365.583      15687.531      1.9939932      3583.6077    
      2000   284.1794      -44349.228      15558.719      1.9939932      3583.6077    
      2100   313.6174      -44364.438      10502.28       1.9939932      3583.6077    
      2200   318.29606     -44369.987      18107.358      1.9939932      3583.6077    
      2300   283.58684     -44358.857      18815.272      1.9939932      3583.6077    
      2400   297.25331     -44394.181      21619.029      1.9939932      3583.6077    
      2500   293.01416     -44391.974      12099.076      1.9939932      3583.6077    
      2600   307.18367     -44375.375      16566.616      1.9939932      3583.6077    
      2700   308.43682     -44358.646      13930.501      1.9939932      3583.6077    
      2800   294.50556     -44352.101      17512.533      1.9939932      3583.6077    
      2900   282.76012     -44352.269      22416.712      1.9939932      3583.6077    
      3000   286.76637     -44371.214      12632.265      1.9939932      3583.6077    
Loop time of 134.648 on 8 procs for 3000 steps with 366 atoms

Performance: 0.963 ns/day, 24.935 hours/ns, 22.280 timesteps/s, 8.155 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 91.754     | 102.05     | 110.72     |  65.5 | 75.79
Bond    | 0.0073371  | 0.0077106  | 0.0082647  |   0.3 |  0.01
Neigh   | 8.1947     | 9.1093     | 9.9461     |  20.7 |  6.77
Comm    | 2.9818     | 11.674     | 21.988     | 193.6 |  8.67
Output  | 0.0066757  | 0.007711   | 0.008631   |   0.7 |  0.01
Modify  | 10.903     | 11.723     | 12.626     |  18.1 |  8.71
Other   |            | 0.07388    |            |       |  0.05

Nlocal:          45.75 ave          54 max          33 min
Histogram: 1 0 0 2 0 1 0 1 1 2
Nghost:        3593.88 ave        3682 max        3506 min
Histogram: 2 0 0 1 0 3 0 0 1 1
Neighs:          32808 ave       38684 max       23901 min
Histogram: 1 0 0 2 0 1 0 1 1 2

Total # of neighbors = 262464
Ave neighs/atom = 717.11475
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.535
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz--0.1585)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.535
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.074931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.001585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.000807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -0.13535 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.8 | 139.4 | 142.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   290.50298     -44362.951      19010.941      1.9939932      3583.6077    
       100   302.83812     -44374.458      11183.734      1.9939932      3583.6077    
       200   317.80774     -44386.794      13860.764      1.9939932      3583.6077    
       300   287.8896      -44364.246      13697.613      1.9939932      3583.6077    
       400   298.58431     -44383.023      18565.536      1.9939932      3583.6077    
       500   288.9389      -44371.717      25871.107      1.9939932      3583.6077    
       600   299.85896     -44364.456      17834.872      1.9939932      3583.6077    
       700   299.49444     -44346.061      14256.318      1.9939932      3583.6077    
       800   298.07562     -44352.121      20077.689      1.9939932      3583.6077    
       900   295.39462     -44378.522      29666.316      1.9939932      3583.6077    
      1000   300.35765     -44391.518      20024.403      1.9939932      3583.6077    
      1100   291.5425      -44362.88       18633.739      1.9939932      3583.6077    
      1200   310.59727     -44362.985      23189.871      1.9939932      3583.6077    
      1300   308.73581     -44364.655      21200.194      1.9939932      3583.6077    
      1400   288.69145     -44354.919      18338.138      1.9939932      3583.6077    
      1500   281.73374     -44361.688      23230.769      1.9939932      3583.6077    
      1600   283.30941     -44372.825      26296.077      1.9939932      3583.6077    
      1700   284.31336     -44381.512      1586.6601      1.9939932      3583.6077    
      1800   285.91696     -44364.515      14964.024      1.9939932      3583.6077    
      1900   312.99582     -44366.641      801.79996      1.9939932      3583.6077    
      2000   317.86402     -44380.167      14299.67       1.9939932      3583.6077    
      2100   295.64716     -44372.666      3662.1605      1.9939932      3583.6077    
      2200   299.65154     -44393.469      16622.061      1.9939932      3583.6077    
      2300   272.69835     -44396.319      26195.334      1.9939932      3583.6077    
      2400   295.60992     -44409.517      17657.644      1.9939932      3583.6077    
      2500   293.51255     -44384.59       11632.389      1.9939932      3583.6077    
      2600   316.59546     -44402.071      5889.9341      1.9939932      3583.6077    
      2700   286.73339     -44362.192      28602.473      1.9939932      3583.6077    
      2800   311.0599      -44370.692      17405.829      1.9939932      3583.6077    
      2900   317.78481     -44357.953      7206.0745      1.9939932      3583.6077    
      3000   331.29165     -44377.756     -109.38296      1.9939932      3583.6077    
Loop time of 107.51 on 8 procs for 3000 steps with 366 atoms

Performance: 1.205 ns/day, 19.909 hours/ns, 27.904 timesteps/s, 10.213 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 83.348     | 85.461     | 88.538     |  20.2 | 79.49
Bond    | 0.0064284  | 0.0067466  | 0.0070037  |   0.3 |  0.01
Neigh   | 8.11       | 8.4208     | 8.7359     |   7.2 |  7.83
Comm    | 0.63781    | 3.7238     | 5.8587     |  97.3 |  3.46
Output  | 0.0055622  | 0.0065096  | 0.0073579  |   0.7 |  0.01
Modify  | 9.5253     | 9.8218     | 10.111     |   6.2 |  9.14
Other   |            | 0.06887    |            |       |  0.06

Nlocal:          45.75 ave          54 max          35 min
Histogram: 1 0 1 2 0 0 0 1 1 2
Nghost:         3599.5 ave        3725 max        3482 min
Histogram: 2 0 0 1 2 0 1 0 1 1
Neighs:        32804.8 ave       38720 max       25301 min
Histogram: 1 1 1 1 0 0 0 0 2 2

Total # of neighbors = 262438
Ave neighs/atom = 717.04372
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.535
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 0.13535 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.8 | 139.4 | 142.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   290.50298     -44362.951      19010.941      1.9939932      3583.6077    
       100   302.82609     -44374.445      11195.123      1.9939932      3583.6077    
       200   318.71332     -44387.909      14010.287      1.9939932      3583.6077    
       300   289.48101     -44365.592      10354.516      1.9939932      3583.6077    
       400   303.46457     -44385.905      21173.77       1.9939932      3583.6077    
       500   294.62045     -44360.295      26877.96       1.9939932      3583.6077    
       600   304.46861     -44345.293      13783.999      1.9939932      3583.6077    
       700   317.84125     -44352.617      10638.074      1.9939932      3583.6077    
       800   291.88697     -44354.035      20117.495      1.9939932      3583.6077    
       900   295.82588     -44373.983      14950.43       1.9939932      3583.6077    
      1000   294.70538     -44371.011      10668.231      1.9939932      3583.6077    
      1100   305.38582     -44366.196      10161.818      1.9939932      3583.6077    
      1200   303.77627     -44348.461      6096.6         1.9939932      3583.6077    
      1300   321.26616     -44336.908      9515.1594      1.9939932      3583.6077    
      1400   311.79629     -44348.193      19750.354      1.9939932      3583.6077    
      1500   312.52337     -44379.322      21907.511      1.9939932      3583.6077    
      1600   298.54336     -44380.315      17154.846      1.9939932      3583.6077    
      1700   294.54406     -44380.712      11633.814      1.9939932      3583.6077    
      1800   287.19815     -44372.791      14352.11       1.9939932      3583.6077    
      1900   297.35402     -44366.874      12816.284      1.9939932      3583.6077    
      2000   320.99589     -44372.623      15663.771      1.9939932      3583.6077    
      2100   294.25989     -44338.083      10712.652      1.9939932      3583.6077    
      2200   287.18938     -44356.461      24342.188      1.9939932      3583.6077    
      2300   302.0198      -44397.583      7175.733       1.9939932      3583.6077    
      2400   290.51303     -44380.725      12774.452      1.9939932      3583.6077    
      2500   315.44882     -44384.309      12758.753      1.9939932      3583.6077    
      2600   294.00856     -44348.328      20841.833      1.9939932      3583.6077    
      2700   284.41979     -44342.946      15793.805      1.9939932      3583.6077    
      2800   276.135       -44370.478      25572.131      1.9939932      3583.6077    
      2900   288.80836     -44407.035      14792.539      1.9939932      3583.6077    
      3000   288.81136     -44389.9        10394.499      1.9939932      3583.6077    
Loop time of 106.679 on 8 procs for 3000 steps with 366 atoms

Performance: 1.215 ns/day, 19.755 hours/ns, 28.122 timesteps/s, 10.293 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 83.012     | 84.698     | 87.791     |  18.3 | 79.40
Bond    | 0.0064857  | 0.0067806  | 0.0071073  |   0.2 |  0.01
Neigh   | 8.1022     | 8.3974     | 8.7029     |   6.9 |  7.87
Comm    | 0.6301     | 3.7326     | 5.4415     |  87.7 |  3.50
Output  | 0.0056321  | 0.0065979  | 0.0074363  |   0.7 |  0.01
Modify  | 9.486      | 9.7673     | 10.042     |   5.9 |  9.16
Other   |            | 0.07011    |            |       |  0.07

Nlocal:          45.75 ave          53 max          35 min
Histogram: 1 1 0 1 0 1 0 0 1 3
Nghost:        3595.38 ave        3687 max        3503 min
Histogram: 2 0 0 0 2 2 0 0 0 2
Neighs:        32791.9 ave       37849 max       25346 min
Histogram: 2 0 0 1 0 1 0 0 1 3

Total # of neighbors = 262335
Ave neighs/atom = 716.7623
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.6074
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--7.4931)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.6074
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.074931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.001585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.000807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -0.176074 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.8 | 139.4 | 142.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   290.50298     -44362.951      19010.941      1.9939932      3583.6077    
       100   302.8957      -44374.508      11189.349      1.9939932      3583.6077    
       200   318.78519     -44388.162      13465.508      1.9939932      3583.6077    
       300   286.83105     -44363.593      9281.6284      1.9939932      3583.6077    
       400   305.09649     -44388.611      25483.854      1.9939932      3583.6077    
       500   290.70015     -44357.477      24851.231      1.9939932      3583.6077    
       600   305.267       -44345.836      12492.5        1.9939932      3583.6077    
       700   308.47422     -44342.274      12658.972      1.9939932      3583.6077    
       800   293.48034     -44350.46       24899.089      1.9939932      3583.6077    
       900   280.47992     -44352.666      17602.145      1.9939932      3583.6077    
      1000   295.07262     -44364.168      14159.628      1.9939932      3583.6077    
      1100   294.93253     -44357.792      21184.952      1.9939932      3583.6077    
      1200   293.24467     -44353.875      24661.29       1.9939932      3583.6077    
      1300   300.04434     -44361.093      10005.691      1.9939932      3583.6077    
      1400   281.49849     -44345.423      22678.719      1.9939932      3583.6077    
      1500   309.94157     -44374.148      18380.532      1.9939932      3583.6077    
      1600   293.84649     -44354.11       17644.758      1.9939932      3583.6077    
      1700   292.3771      -44357.84       9545.6525      1.9939932      3583.6077    
      1800   277.85898     -44367.041      5634.6558      1.9939932      3583.6077    
      1900   276.38503     -44382.707      9451.4068      1.9939932      3583.6077    
      2000   296.36526     -44387.748      11301.624      1.9939932      3583.6077    
      2100   295.88769     -44350.738      15057.782      1.9939932      3583.6077    
      2200   311.84209     -44361.962      2638.3231      1.9939932      3583.6077    
      2300   315.70523     -44375.121      2553.8225      1.9939932      3583.6077    
      2400   304.92083     -44393.022      16679.882      1.9939932      3583.6077    
      2500   272.10611     -44366.755      10628.377      1.9939932      3583.6077    
      2600   299.3446      -44376.597      929.96944      1.9939932      3583.6077    
      2700   298.82295     -44366.014      13008.106      1.9939932      3583.6077    
      2800   302.28336     -44373.562      635.62984      1.9939932      3583.6077    
      2900   299.66026     -44377.017      8967.4498      1.9939932      3583.6077    
      3000   299.58365     -44380.939      13667.355      1.9939932      3583.6077    
Loop time of 104.687 on 8 procs for 3000 steps with 366 atoms

Performance: 1.238 ns/day, 19.386 hours/ns, 28.657 timesteps/s, 10.488 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 80.594     | 82.541     | 85.802     |  20.6 | 78.85
Bond    | 0.0062997  | 0.0065188  | 0.0067952  |   0.2 |  0.01
Neigh   | 8.1007     | 8.4008     | 8.7128     |   6.9 |  8.02
Comm    | 0.66224    | 3.938      | 5.907      |  95.0 |  3.76
Output  | 0.0056927  | 0.0067164  | 0.0075809  |   0.8 |  0.01
Modify  | 9.4373     | 9.7262     | 10.009     |   5.9 |  9.29
Other   |            | 0.06764    |            |       |  0.06

Nlocal:          45.75 ave          55 max          35 min
Histogram: 1 1 0 0 2 0 0 1 2 1
Nghost:        3592.25 ave        3704 max        3492 min
Histogram: 2 0 1 1 0 1 0 2 0 1
Neighs:        32842.6 ave       39377 max       25258 min
Histogram: 1 1 0 1 1 0 0 1 2 1

Total # of neighbors = 262741
Ave neighs/atom = 717.87158
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.6074
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 0.176074 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.8 | 139.4 | 142.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   290.50298     -44362.951      19010.941      1.9939932      3583.6077    
       100   302.77368     -44374.394      11192.633      1.9939932      3583.6077    
       200   317.66822     -44386.551      14692.363      1.9939932      3583.6077    
       300   281.72479     -44353.788      7964.4642      1.9939932      3583.6077    
       400   291.1609      -44369.247      25086.563      1.9939932      3583.6077    
       500   296.2539      -44379.69       14837.395      1.9939932      3583.6077    
       600   286.07569     -44354.997      12303.092      1.9939932      3583.6077    
       700   302.48112     -44349.772      15997.264      1.9939932      3583.6077    
       800   295.06822     -44349.962      9834.044       1.9939932      3583.6077    
       900   295.21172     -44378.012      16998.473      1.9939932      3583.6077    
      1000   314.6048      -44403.793      22996.759      1.9939932      3583.6077    
      1100   279.67883     -44362.087      11807.07       1.9939932      3583.6077    
      1200   299.73604     -44374.287      9075.0543      1.9939932      3583.6077    
      1300   300.76414     -44363.322      22826.875      1.9939932      3583.6077    
      1400   292.12174     -44353.508      8852.0222      1.9939932      3583.6077    
      1500   276.57151     -44359.145      9751.5881      1.9939932      3583.6077    
      1600   269.15013     -44371.832      10033.403      1.9939932      3583.6077    
      1700   305.80249     -44406.717      9667.5798      1.9939932      3583.6077    
      1800   299.60562     -44370.142      18406.604      1.9939932      3583.6077    
      1900   315.38824     -44369.355      11026.194      1.9939932      3583.6077    
      2000   291.33145     -44350.437      24662.798      1.9939932      3583.6077    
      2100   296.82703     -44369.784      20623.112      1.9939932      3583.6077    
      2200   297.30393     -44394.101      24333.551      1.9939932      3583.6077    
      2300   284.35042     -44403.588      12958.976      1.9939932      3583.6077    
      2400   289.25615     -44394.27       1867.5391      1.9939932      3583.6077    
      2500   296.44562     -44369.077      23718.949      1.9939932      3583.6077    
      2600   305.46927     -44375.825      19392.088      1.9939932      3583.6077    
      2700   303.34838     -44374.453      11080.272      1.9939932      3583.6077    
      2800   299.00336     -44385.598      19517.536      1.9939932      3583.6077    
      2900   275.98123     -44383.742      15629.562      1.9939932      3583.6077    
      3000   287.27219     -44388.555      21687.878      1.9939932      3583.6077    
Loop time of 97.3631 on 8 procs for 3000 steps with 366 atoms

Performance: 1.331 ns/day, 18.030 hours/ns, 30.812 timesteps/s, 11.277 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 71.91      | 74.469     | 78.887     |  27.6 | 76.49
Bond    | 0.0052536  | 0.005764   | 0.0060852  |   0.3 |  0.01
Neigh   | 7.9318     | 8.2376     | 8.5345     |   7.4 |  8.46
Comm    | 0.59907    | 5.0251     | 7.5945     | 106.8 |  5.16
Output  | 0.0060978  | 0.0069905  | 0.0078083  |   0.7 |  0.01
Modify  | 9.2642     | 9.553      | 9.836      |   6.4 |  9.81
Other   |            | 0.06571    |            |       |  0.07

Nlocal:          45.75 ave          55 max          31 min
Histogram: 1 0 0 0 1 2 0 2 1 1
Nghost:        3584.62 ave        3680 max        3495 min
Histogram: 2 0 0 0 2 2 0 0 1 1
Neighs:        32821.5 ave       39439 max       22593 min
Histogram: 1 0 0 0 2 1 0 2 1 1

Total # of neighbors = 262572
Ave neighs/atom = 717.40984
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:33:38
