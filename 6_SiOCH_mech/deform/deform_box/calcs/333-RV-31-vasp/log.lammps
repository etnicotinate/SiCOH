LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-RV-31-vasp
read_data       ${structure}.data
read_data       333-RV-31-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.007 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.865 | 6.865 | 6.865 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              276.32109      3675.1532    
         1   300            0              0              276.32109      3675.1532    
Loop time of 4.90248e-05 on 16 procs for 1 steps with 310 atoms

57.1% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.31e-07   | 2.245e-07  | 3.01e-07   |   0.0 |  0.46
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 9.34e-07   | 1.2348e-06 | 1.558e-06  |   0.0 |  2.52
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 4.757e-05  |            |       | 97.02

Nlocal:          38.75 ave          46 max          34 min
Histogram: 1 2 0 1 2 0 1 0 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-RV-31-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = 22.14 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.2 | 122.9 | 123.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -32388.564      119735.25      0              1.4204665      3436.9359    
       100   649.70376     -33544.153     -33915.579     -1719.4008      1.4204665      3436.9359    
       200   476.79489     -33778.038     -14107.441     -5025.7996      1.4204665      3436.9359    
       300   342.32842     -33902.737      13749.128      3415.8679      1.4204665      3436.9359    
       400   333.59749     -33988.225     -4962.9233      3463.175       1.4204665      3436.9359    
       500   335.28364     -34040.923     -10346.316      612.05283      1.4204665      3436.9359    
       600   371.41207     -34115.929     -5933.0208     -3911.6981      1.4204665      3436.9359    
       700   324.66362     -34165.734      15468.01       6751.5532      1.4204665      3436.9359    
       800   372.69229     -34249.833     -1036.285       2495.2362      1.4204665      3436.9359    
       900   309.50036     -34236.482      6206.506       610.7778       1.4204665      3436.9359    
      1000   312.98145     -34243.699     -6311.7807     -1425.4101      1.4204665      3436.9359    
      1100   315.8967      -34262.545      6312.3284      1214.1937      1.4204665      3436.9359    
      1200   296.00175     -34287.253      10887.482      9088.4482      1.4204665      3436.9359    
      1300   306.1473      -34293.804     -1649.2139     -569.38135      1.4204665      3436.9359    
      1400   299.52205     -34290.144      11916.507     -1805.4853      1.4204665      3436.9359    
      1500   291.90122     -34297.595     -1642.8144      3078.4581      1.4204665      3436.9359    
      1600   315.83472     -34316.69      -8170.2555      1107.9542      1.4204665      3436.9359    
      1700   317.41572     -34335.587     -2607.9137     -1655.69        1.4204665      3436.9359    
      1800   309.74088     -34296.888     -21695.196     -2082.6097      1.4204665      3436.9359    
      1900   317.98413     -34319.718     -7811.0453     -3815.7833      1.4204665      3436.9359    
      2000   296.42651     -34312.772      8400.9731      4897.4589      1.4204665      3436.9359    
Loop time of 91.0733 on 16 procs for 2000 steps with 310 atoms

Performance: 0.949 ns/day, 25.298 hours/ns, 21.960 timesteps/s, 6.808 katom-step/s
98.7% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 64.147     | 66.322     | 69.693     |  23.6 | 72.82
Bond    | 0.0006621  | 0.00078755 | 0.00088214 |   0.0 |  0.00
Neigh   | 4.9807     | 5.1465     | 5.2478     |   4.4 |  5.65
Comm    | 5.6281     | 8.9554     | 11.161     |  64.2 |  9.83
Output  | 0.0011121  | 0.0013913  | 0.0031496  |   1.8 |  0.00
Modify  | 10.111     | 10.286     | 10.447     |   3.5 | 11.29
Other   |            | 0.3609     |            |       |  0.40

Nlocal:          38.75 ave          42 max          35 min
Histogram: 1 0 1 0 3 0 0 0 2 1
Nghost:        3109.12 ave        3155 max        3052 min
Histogram: 1 0 0 1 2 0 1 1 1 1
Neighs:        24510.6 ave       26432 max       22292 min
Histogram: 1 0 1 1 2 0 0 0 1 2

Total # of neighbors = 196085
Ave neighs/atom = 632.53226
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]
# use tmp to save constants
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.4114
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 12.7411
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.5034

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-4897.45892819752)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-4897.45892819752)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-4224.81762014123)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-4224.81762014123)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--403.382727489269)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--403.382727489269)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--1204.72034108084)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--1204.72034108084)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-4894.79527897995)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-4894.79527897995)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-1903.51069462413)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-1903.51069462413)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 15.4114
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.4114
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.154114 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.154114 xy delta 0.072027 xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.154114 xy delta 0.072027 xz delta 0.018261 remap x units box
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.2 | 122.3 | 124.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.42651     -34312.772      8400.942       0              3436.9359    
       100   301.29272     -34343.728      2422.3748     -128.89205      3435.2174    
       200   295.91781     -34335.645     -5702.5644      1021.0971      3433.499     
       300   289.74402     -34364.783      1048.1275      1788.6972      3431.7805    
       400   300.98076     -34339.759     -2197.2411      1790.2079      3430.062     
       500   310.82457     -34353.126      2882.8993      1864.1456      3428.3436    
       600   302.7554      -34363.379     -10160.665     -3054.8416      3426.6251    
       700   284.47004     -34360.203     -2511.159       6161.0126      3424.9066    
       800   301.81273     -34390.71       71.164387      7056.9606      3423.1882    
       900   292.99409     -34383.343     -4855.9536     -1908.5035      3421.4697    
      1000   317.52776     -34389.466      2846.03        2211.5184      3419.7512    
      1100   328.26699     -34386.785     -12820.581     -7463.7944      3418.0328    
      1200   276.66883     -34378.996     -11885.466     -1448.0519      3416.3143    
      1300   305.34568     -34404.455     -3617.2567     -1051.2835      3414.5958    
      1400   273.09047     -34398.777      7511.3306      6338.3371      3412.8774    
      1500   286.80028     -34391.279     -2269.9388      3038.7641      3411.1589    
      1600   281.34817     -34403.788     -8313.8876     -356.76209      3409.4404    
      1700   304.72294     -34387.681      21537.273      10220.522      3407.722     
      1800   297.78937     -34395.7        97.469584      7643.3812      3406.0035    
      1900   307.84926     -34393.134     -1623.8379     -2498.3037      3404.285     
      2000   301.44169     -34410.791     -9331.8211     -963.88566      3402.5666    
Loop time of 93.6357 on 16 procs for 2000 steps with 310 atoms

Performance: 0.923 ns/day, 26.010 hours/ns, 21.359 timesteps/s, 6.621 katom-step/s
98.7% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 66.951     | 69.038     | 70.261     |  14.7 | 73.73
Bond    | 0.00067605 | 0.00080829 | 0.00087596 |   0.0 |  0.00
Neigh   | 5.182      | 5.2492     | 5.3493     |   2.8 |  5.61
Comm    | 7.2096     | 8.4095     | 10.554     |  42.4 |  8.98
Output  | 0.0048174  | 0.0087457  | 0.012569   |   3.2 |  0.01
Modify  | 10.395     | 10.519     | 10.609     |   2.3 | 11.23
Other   |            | 0.4107     |            |       |  0.44

Nlocal:          38.75 ave          43 max          37 min
Histogram: 3 2 0 0 0 2 0 0 0 1
Nghost:        3147.75 ave        3177 max        3108 min
Histogram: 1 0 1 0 0 2 1 1 0 2
Neighs:        24761.4 ave       27310 max       23712 min
Histogram: 3 2 0 0 1 1 0 0 0 1

Total # of neighbors = 198091
Ave neighs/atom = 639.00323
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -59.3900740863143
variable C2neg equal ${d2}
variable C2neg equal -46.9910438566198
variable C3neg equal ${d3}
variable C3neg equal -12.054579217345
variable C4neg equal ${d4}
variable C4neg equal -6.35357850497493
variable C5neg equal ${d5}
variable C5neg equal -17.0334602657456
variable C6neg equal ${d6}
variable C6neg equal 0.359455234795655

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.4114
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.154114 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.154114 xy delta -0.072027 xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.154114 xy delta -0.072027 xz delta -0.018261 remap x units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.2 | 122.3 | 124.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.42651     -34312.772      8400.942       0              3436.9359    
       100   301.29272     -34343.728      2419.9536     -129.21533      3438.6544    
       200   294.01505     -34332.896     -3743.7205      199.34205      3440.3729    
       300   292.78538     -34359.492     -7813.5816     -859.64476      3442.0913    
       400   314.9519      -34364.442     -11890.076      1283.3947      3443.8098    
       500   294.5931      -34341.248      995.42867     -3721.5087      3445.5283    
       600   306.29688     -34363.729     -728.71209     -1868.3306      3447.2467    
       700   283.07599     -34370.489     -20349.668     -3217.5473      3448.9652    
       800   290.29771     -34353.092     -2727.2384     -4044.7818      3450.6837    
       900   276.16306     -34349.337      5989.7374      314.0115       3452.4021    
      1000   287.71214     -34341.503     -6558.2446     -7155.4387      3454.1206    
      1100   329.32565     -34338.556     -6818.37       -5168.9733      3455.8391    
      1200   299.35677     -34342.815      635.24463     -1067.1866      3457.5575    
      1300   287.56472     -34360.429      4022.501      -1780.7292      3459.276     
      1400   303.43809     -34367.748      14620.212     -4124.5403      3460.9945    
      1500   299.76037     -34383.786     -10540.788     -3116.4136      3462.7129    
      1600   289.19671     -34373.442      982.40863      141.44934      3464.4314    
      1700   308.76579     -34367.647     -346.59647     -1058.004       3466.1499    
      1800   271.82395     -34358.039     -1327.3746      4082.9633      3467.8683    
      1900   275.25084     -34370.627     -4057.2416     -468.83214      3469.5868    
      2000   302.30278     -34377.957     -8866.4921      2780.7645      3471.3053    
Loop time of 92.7131 on 16 procs for 2000 steps with 310 atoms

Performance: 0.932 ns/day, 25.754 hours/ns, 21.572 timesteps/s, 6.687 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 66.012     | 68.528     | 70.472     |  20.5 | 73.91
Bond    | 0.00064815 | 0.00080305 | 0.0009008  |   0.0 |  0.00
Neigh   | 5.0919     | 5.2584     | 5.3943     |   3.9 |  5.67
Comm    | 6.2769     | 8.2111     | 10.747     |  58.3 |  8.86
Output  | 0.0073865  | 0.011875   | 0.016932   |   3.2 |  0.01
Modify  | 10.185     | 10.336     | 10.457     |   2.9 | 11.15
Other   |            | 0.3679     |            |       |  0.40

Nlocal:          38.75 ave          49 max          33 min
Histogram: 1 1 1 4 0 0 0 0 0 1
Nghost:        3097.62 ave        3126 max        3052 min
Histogram: 1 1 0 0 0 1 1 0 2 2
Neighs:          24277 ave       30312 max       20804 min
Histogram: 1 1 1 4 0 0 0 0 0 1

Total # of neighbors = 194216
Ave neighs/atom = 626.50323
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 21.4474061786611
variable C2pos equal ${d2}
variable C2pos equal 59.2402291951183
variable C3pos equal ${d3}
variable C3pos equal -0.296049037183358
variable C4pos equal ${d4}
variable C4pos equal -7.27053404970124
variable C5pos equal ${d5}
variable C5pos equal 20.6822152840205
variable C6pos equal ${d6}
variable C6pos equal -0.031879822819754

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(-59.3900740863143+${C1pos})
variable C11 equal 0.5*(-59.3900740863143+21.4474061786611)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(-46.9910438566198+${C2pos})
variable C21 equal 0.5*(-46.9910438566198+59.2402291951183)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(-12.054579217345+${C3pos})
variable C31 equal 0.5*(-12.054579217345+-0.296049037183358)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-6.35357850497493+${C4pos})
variable C41 equal 0.5*(-6.35357850497493+-7.27053404970124)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(-17.0334602657456+${C5pos})
variable C51 equal 0.5*(-17.0334602657456+20.6822152840205)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(0.359455234795655+${C6pos})
variable C61 equal 0.5*(0.359455234795655+-0.031879822819754)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 12.7411
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.7411
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.127411 yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.127411 yz delta -0.003384 remap x units box
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.2 | 122.3 | 124.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.42651     -34312.772      8400.942       0              3436.9359    
       100   301.29272     -34343.728      2422.3748     -128.89205      3435.2174    
       200   298.52992     -34337.635     -7090.3353      882.96123      3433.499     
       300   296.11701     -34353.09      -2848.5244      579.29983      3431.7805    
       400   300.76295     -34352.104     -2268.8815      822.50069      3430.062     
       500   280.25668     -34345.043     -8225.2564      2403.721       3428.3436    
       600   290.7642      -34350.787     -8603.214      -3656.4862      3426.6251    
       700   303.53866     -34367.108     -9526.5963     -702.26887      3424.9066    
       800   302.11928     -34398.235     -9046.4129     -251.65841      3423.1882    
       900   302.80524     -34367.056     -3660.6024     -261.39689      3421.4697    
      1000   331.28688     -34387.145     -5797.7684      820.14719      3419.7512    
      1100   315.33888     -34406.21      -6570.004       1484.835       3418.0328    
      1200   310.25564     -34363.584      2886.8557      6570.2625      3416.3143    
      1300   314.18687     -34400.663      1722.747      -2244.4638      3414.5958    
      1400   307.3191      -34378.268     -9453.9958     -3434.0034      3412.8774    
      1500   309.46618     -34400.553     -1444.5515     -6366.9631      3411.1589    
      1600   274.01103     -34384.631      894.66584      1021.3281      3409.4404    
      1700   278.38434     -34395.112     -7552.5846     -8576.6175      3407.722     
      1800   300.00978     -34395.613      19043.66      -1079.1051      3406.0035    
      1900   307.47931     -34417.971     -5947.1907     -7140.3319      3404.285     
      2000   303.81033     -34384.339     -18386.236      1001.2609      3402.5666    
Loop time of 93.542 on 16 procs for 2000 steps with 310 atoms

Performance: 0.924 ns/day, 25.984 hours/ns, 21.381 timesteps/s, 6.628 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 66.657     | 68.899     | 70.694     |  18.2 | 73.66
Bond    | 0.00068829 | 0.00080124 | 0.00086123 |   0.0 |  0.00
Neigh   | 5.156      | 5.2792     | 5.3993     |   3.3 |  5.64
Comm    | 6.7348     | 8.5189     | 10.814     |  52.3 |  9.11
Output  | 0.0094988  | 0.013837   | 0.018823   |   3.0 |  0.01
Modify  | 10.335     | 10.453     | 10.576     |   2.6 | 11.17
Other   |            | 0.377      |            |       |  0.40

Nlocal:          38.75 ave          45 max          34 min
Histogram: 2 1 1 0 2 0 0 0 0 2
Nghost:         3139.5 ave        3170 max        3093 min
Histogram: 1 0 0 1 1 0 2 0 1 2
Neighs:        24757.6 ave       28558 max       21793 min
Histogram: 2 1 1 0 2 0 0 0 0 2

Total # of neighbors = 198061
Ave neighs/atom = 638.90645
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -39.4782262440591
variable C2neg equal ${d2}
variable C2neg equal -11.5552605981663
variable C3neg equal ${d3}
variable C3neg equal -42.5841829878511
variable C4neg equal ${d4}
variable C4neg equal -8.72522886210814
variable C5neg equal ${d5}
variable C5neg equal -14.8072559139764
variable C6neg equal ${d6}
variable C6neg equal 18.3756808656968

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.7411
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.127411 yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.127411 yz delta 0.003384 remap x units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.2 | 122.3 | 124.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.42651     -34312.772      8400.942       0              3436.9359    
       100   301.29272     -34343.728      2419.9536     -129.21533      3438.6544    
       200   283.8187      -34310.927     -8213.6974      671.76083      3440.3729    
       300   278.84741     -34328.232     -17427.627     -903.90632      3442.0913    
       400   303.82242     -34325.782     -15157.72      -823.98141      3443.8098    
       500   283.60675     -34332.781     -5938.0482      1845.9889      3445.5283    
       600   299.20879     -34333.214     -14569.113      1098.5329      3447.2467    
       700   298.55279     -34320.055     -5149.2607     -1715.2161      3448.9652    
       800   303.53063     -34362.336      3413.9171     -4463.1338      3450.6837    
       900   289.43973     -34365.173     -2788.0206      347.93718      3452.4021    
      1000   315.56169     -34353.945      4620.3881      913.35253      3454.1206    
      1100   301.47713     -34372.742     -11804.038      847.64102      3455.8391    
      1200   316.76086     -34389.122      863.86336     -3576.3931      3457.5575    
      1300   266.38011     -34363.181     -12758.473      2814.5807      3459.276     
      1400   313.58265     -34369.898     -4303.2397     -4648.6241      3460.9945    
      1500   307.47222     -34346.34      -7645.872       3105.3617      3462.7129    
      1600   317.72817     -34340.357     -15128.582      1272.144       3464.4314    
      1700   314.67947     -34363.547      1186.3758      2001.0326      3466.1499    
      1800   313.15186     -34376.601      11380.648      656.97591      3467.8683    
      1900   299.07092     -34367.414     -14779.076     -2374.4966      3469.5868    
      2000   308.76417     -34365.528      3386.6612      1768.8022      3471.3053    
Loop time of 92.7562 on 16 procs for 2000 steps with 310 atoms

Performance: 0.931 ns/day, 25.766 hours/ns, 21.562 timesteps/s, 6.684 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 66.194     | 68.641     | 71.109     |  19.8 | 74.00
Bond    | 0.00069358 | 0.00082506 | 0.00089308 |   0.0 |  0.00
Neigh   | 5.0062     | 5.2267     | 5.2985     |   4.0 |  5.63
Comm    | 5.6753     | 8.0876     | 10.484     |  56.9 |  8.72
Output  | 0.0056068  | 0.011055   | 0.016719   |   3.9 |  0.01
Modify  | 10.347     | 10.417     | 10.58      |   2.1 | 11.23
Other   |            | 0.3715     |            |       |  0.40

Nlocal:          38.75 ave          46 max          31 min
Histogram: 1 0 1 0 2 0 3 0 0 1
Nghost:         3063.5 ave        3095 max        3017 min
Histogram: 1 0 0 1 0 1 2 1 1 1
Neighs:        24287.2 ave       28580 max       19558 min
Histogram: 1 0 1 0 2 0 3 0 0 1

Total # of neighbors = 194298
Ave neighs/atom = 626.76774
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 31.7011141410071
variable C2pos equal ${d2}
variable C2pos equal 99.4851920707841
variable C3pos equal ${d3}
variable C3pos equal 40.4371443207924
variable C4pos equal ${d4}
variable C4pos equal -3.22451858481297
variable C5pos equal ${d5}
variable C5pos equal 4.47380091012324
variable C6pos equal ${d6}
variable C6pos equal 6.59899132791369

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(-39.4782262440591+${C1pos})
variable C12 equal 0.5*(-39.4782262440591+31.7011141410071)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(-11.5552605981663+${C2pos})
variable C22 equal 0.5*(-11.5552605981663+99.4851920707841)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(-42.5841829878511+${C3pos})
variable C32 equal 0.5*(-42.5841829878511+40.4371443207924)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-8.72522886210814+${C4pos})
variable C42 equal 0.5*(-8.72522886210814+-3.22451858481297)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(-14.8072559139764+${C5pos})
variable C52 equal 0.5*(-14.8072559139764+4.47380091012324)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(18.3756808656968+${C6pos})
variable C62 equal 0.5*(18.3756808656968+6.59899132791369)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.5034
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.5034
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 -0.175034 remap x units box
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.2 | 122.3 | 124.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.42651     -34312.772      8400.942       0              3436.9359    
       100   301.29272     -34343.728      2422.3748     -128.89205      3435.2174    
       200   282.9341      -34326.462     -5719.9814      1249.2152      3433.499     
       300   278.56415     -34331.742     -6890.1145     -2642.9349      3431.7805    
       400   321.53488     -34381.311      242.54507     -3873.8475      3430.062     
       500   309.74864     -34349.2       -17914.645      2982.097       3428.3436    
       600   325.55482     -34371.827      8718.5139      1624.7649      3426.6251    
       700   298.14431     -34338.053     -3461.6679     -1273.5208      3424.9066    
       800   296.03374     -34356.71       6616.521       4059.4657      3423.1882    
       900   314.6271      -34372.452     -6724.2571      4014.9987      3421.4697    
      1000   291.97313     -34361.636     -7682.6349     -1685.0389      3419.7512    
      1100   307.16033     -34362.754     -15533.37      -961.35866      3418.0328    
      1200   326.40837     -34389.456     -5951.1877      6302.1031      3416.3143    
      1300   307.8828      -34354.477     -5338.2095      2840.6083      3414.5958    
      1400   305.89409     -34386.617      333.26287     -132.64377      3412.8774    
      1500   288.22834     -34374.957     -7103.6895      7793.5631      3411.1589    
      1600   296.79167     -34375.259      6190.1913      5408.511       3409.4404    
      1700   301.6496      -34378.926     -4648.8797      5215.1255      3407.722     
      1800   294.38951     -34379.685      11694.638      6960.4189      3406.0035    
      1900   300.53539     -34394.815      5028.5524      2547.2327      3404.285     
      2000   322.29718     -34377.926      8940.8999     -1056.4201      3402.5666    
Loop time of 93.0119 on 16 procs for 2000 steps with 310 atoms

Performance: 0.929 ns/day, 25.837 hours/ns, 21.503 timesteps/s, 6.666 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 65.718     | 68.473     | 71.073     |  19.1 | 73.62
Bond    | 0.00072203 | 0.00081488 | 0.00086114 |   0.0 |  0.00
Neigh   | 5.0697     | 5.2442     | 5.3856     |   4.4 |  5.64
Comm    | 5.8239     | 8.4281     | 11.156     |  54.3 |  9.06
Output  | 0.0072012  | 0.01106    | 0.015636   |   2.9 |  0.01
Modify  | 10.373     | 10.508     | 10.656     |   3.2 | 11.30
Other   |            | 0.3474     |            |       |  0.37

Nlocal:          38.75 ave          43 max          34 min
Histogram: 1 1 0 1 2 0 0 0 1 2
Nghost:        3130.62 ave        3161 max        3087 min
Histogram: 1 0 0 1 1 1 1 0 1 2
Neighs:        24770.1 ave       27296 max       21817 min
Histogram: 1 1 0 1 2 0 0 0 1 2

Total # of neighbors = 198161
Ave neighs/atom = 639.22903
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -60.3276795784985
variable C2neg equal ${d2}
variable C2neg equal -21.815959935732
variable C3neg equal ${d3}
variable C3neg equal -61.5970289504734
variable C4neg equal ${d4}
variable C4neg equal -7.1629222829179
variable C5neg equal ${d5}
variable C5neg equal -2.48684019038208
variable C6neg equal ${d6}
variable C6neg equal -4.41092399523756

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.5034
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 0.175034 remap x units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.2 | 122.3 | 124.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.42651     -34312.772      8400.942       0              3436.9359    
       100   301.29272     -34343.728      2419.9536     -129.21533      3438.6544    
       200   282.56344     -34325.172     -9750.376       914.19865      3440.3729    
       300   286.29732     -34356.112     -9558.9957     -2946.0374      3442.0913    
       400   295.81292     -34350.552     -5877.8798     -3645.9823      3443.8098    
       500   290.93786     -34365.809     -12074.325     -1650.7362      3445.5283    
       600   282.86329     -34356.979      4271.7484     -1201.3352      3447.2467    
       700   304.1         -34363.392     -2619.4898      9753.6089      3448.9652    
       800   308.5038      -34355.98      -4623.2179     -872.90501      3450.6837    
       900   301.3426      -34362.229     -9743.3382     -2192.4742      3452.4021    
      1000   288.51055     -34378.797     -2367.3252     -4125.3779      3454.1206    
      1100   317.5767      -34389.938      3393.7829     -4512.9749      3455.8391    
      1200   291.12547     -34373.443      6707.0366      1568.2328      3457.5575    
      1300   283.37493     -34406.295     -11699.441     -5720.324       3459.276     
      1400   303.20719     -34394.872     -22107.464     -3085.116       3460.9945    
      1500   280.46505     -34348.182     -18812.973     -2148.2621      3462.7129    
      1600   281.43347     -34367.653     -3636.6668     -1071.9256      3464.4314    
      1700   281.72155     -34381.179     -10212.341     -4333.3502      3466.1499    
      1800   325.50471     -34366.818      5261.0841     -841.03493      3467.8683    
      1900   273.73009     -34339.87       1808.8772     -4361.8485      3469.5868    
      2000   292.44903     -34381.8       -6683.3843     -5051.29        3471.3053    
Loop time of 92.7045 on 16 procs for 2000 steps with 310 atoms

Performance: 0.932 ns/day, 25.751 hours/ns, 21.574 timesteps/s, 6.688 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 66.138     | 68.353     | 70.324     |  15.1 | 73.73
Bond    | 0.00067834 | 0.00080962 | 0.00089202 |   0.0 |  0.00
Neigh   | 5.1869     | 5.2324     | 5.2938     |   1.5 |  5.64
Comm    | 6.3939     | 8.2956     | 10.47      |  42.7 |  8.95
Output  | 0.0047392  | 0.0092503  | 0.013308   |   3.4 |  0.01
Modify  | 10.316     | 10.433     | 10.55      |   2.4 | 11.25
Other   |            | 0.3808     |            |       |  0.41

Nlocal:          38.75 ave          47 max          32 min
Histogram: 1 1 1 0 2 0 1 1 0 1
Nghost:        3110.25 ave        3149 max        3073 min
Histogram: 2 0 0 1 0 1 2 1 0 1
Neighs:        24302.1 ave       29212 max       20236 min
Histogram: 1 1 1 0 2 0 1 1 0 1

Total # of neighbors = 194417
Ave neighs/atom = 627.15161
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 100.805698314621
variable C2pos equal ${d2}
variable C2pos equal 73.3418340426111
variable C3pos equal ${d3}
variable C3pos equal 150.931840066407
variable C4pos equal ${d4}
variable C4pos equal 5.58742222989121
variable C5pos equal ${d5}
variable C5pos equal 15.0539769747627
variable C6pos equal ${d6}
variable C6pos equal 1.09530692895829

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(-60.3276795784985+${C1pos})
variable C13 equal 0.5*(-60.3276795784985+100.805698314621)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(-21.815959935732+${C2pos})
variable C23 equal 0.5*(-21.815959935732+73.3418340426111)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(-61.5970289504734+${C3pos})
variable C33 equal 0.5*(-61.5970289504734+150.931840066407)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-7.1629222829179+${C4pos})
variable C43 equal 0.5*(-7.1629222829179+5.58742222989121)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-2.48684019038208+${C5pos})
variable C53 equal 0.5*(-2.48684019038208+15.0539769747627)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-4.41092399523756+${C6pos})
variable C63 equal 0.5*(-4.41092399523756+1.09530692895829)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.5034
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.5034
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta -0.175034 remap x units box
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.2 | 122.3 | 124.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.42651     -34312.772      8400.942       0              3436.9359    
       100   301.29272     -34343.728      2421.1636     -129.05377      3436.9359    
       200   282.27828     -34326.121     -9048.9185      821.81075      3436.9359    
       300   286.1648      -34337.239     -11635.081     -2531.0106      3436.9359    
       400   305.46859     -34354.205     -4721.0709      970.2517       3436.9359    
       500   294.04526     -34347.741     -18537.991     -3369.3032      3436.9359    
       600   301.27409     -34356.421     -9193.6909      345.18324      3436.9359    
       700   314.01338     -34354.115      6140.4819      2463.138       3436.9359    
       800   292.89036     -34373.341     -3546.2261      1134.155       3436.9359    
       900   319.66829     -34351.12      -4629.5982     -2224.4424      3436.9359    
      1000   298.84625     -34353.87      -10833.979     -2225.4162      3436.9359    
      1100   309.1919      -34357.855     -5854.4695     -2021.0698      3436.9359    
      1200   324.73974     -34361.07      -10279.257     -6457.1671      3436.9359    
      1300   294.269       -34361.63       155.07002      6313.3392      3436.9359    
      1400   311.58632     -34384.097      7344.8084      3051.5862      3436.9359    
      1500   299.66462     -34400.987     -2154.5704      988.4749       3436.9359    
      1600   287.01086     -34403.631      2094.2428     -754.11867      3436.9359    
      1700   300.8374      -34383.341      10083.539      2712.5924      3436.9359    
      1800   322.3081      -34393.205      21614.157      2767.7006      3436.9359    
      1900   315.95723     -34381.748      4366.2475     -2729.0805      3436.9359    
      2000   314.1669      -34405.218      125.70258     -2355.2958      3436.9359    
Loop time of 92.9508 on 16 procs for 2000 steps with 310 atoms

Performance: 0.930 ns/day, 25.820 hours/ns, 21.517 timesteps/s, 6.670 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 66.462     | 68.557     | 71.337     |  19.3 | 73.76
Bond    | 0.00064949 | 0.00080698 | 0.00090256 |   0.0 |  0.00
Neigh   | 5.1296     | 5.2086     | 5.2885     |   2.4 |  5.60
Comm    | 5.6467     | 8.3461     | 10.503     |  54.3 |  8.98
Output  | 0.007415   | 0.0097727  | 0.012075   |   1.8 |  0.01
Modify  | 10.39      | 10.484     | 10.614     |   2.5 | 11.28
Other   |            | 0.3448     |            |       |  0.37

Nlocal:          38.75 ave          43 max          32 min
Histogram: 1 0 1 0 0 1 0 3 0 2
Nghost:        3125.75 ave        3138 max        3095 min
Histogram: 1 0 0 0 1 0 1 1 1 3
Neighs:        24511.5 ave       27037 max       20342 min
Histogram: 1 0 1 0 0 1 0 3 0 2

Total # of neighbors = 196092
Ave neighs/atom = 632.55484
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -73.4885375666182
variable C2neg equal ${d2}
variable C2neg equal -68.6780889994616
variable C3neg equal ${d3}
variable C3neg equal -51.1740112220998
variable C4neg equal ${d4}
variable C4neg equal 12.8308574539455
variable C5neg equal ${d5}
variable C5neg equal -14.1458561586983
variable C6neg equal ${d6}
variable C6neg equal -9.08001488080218

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.5034
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta 0.175034 remap x units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.2 | 122.3 | 124.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.42651     -34312.772      8400.942       0              3436.9359    
       100   301.29272     -34343.728      2421.1636     -129.05377      3436.9359    
       200   295.38976     -34334.814     -7614.628       598.71817      3436.9359    
       300   294.75671     -34362.81       9080.224       8.456859       3436.9359    
       400   295.14421     -34366.884     -3844.3645     -5321.2769      3436.9359    
       500   301.56306     -34382.285     -6533.8805     -1466.0782      3436.9359    
       600   302.42545     -34390.667     -1209.3421      3460.3822      3436.9359    
       700   299.80183     -34354.805     -17596.78       2702.0524      3436.9359    
       800   319.60784     -34359.441      1497.9221     -929.78764      3436.9359    
       900   292.21933     -34351.519     -11524.342     -4961.9774      3436.9359    
      1000   306.40024     -34361.439     -3552.5842     -9718.26        3436.9359    
      1100   262.37815     -34363.737     -7205.7831     -3800.1622      3436.9359    
      1200   286.81137     -34399.437      10269.307      1816.5819      3436.9359    
      1300   307.81009     -34404.186     -5882.6821     -2313.8485      3436.9359    
      1400   284.91502     -34380.015     -21311.7       -4472.5784      3436.9359    
      1500   271.58154     -34374.925     -10241.387     -4798.0245      3436.9359    
      1600   271.64198     -34383.06      -7853.5159     -1178.56        3436.9359    
      1700   290.13565     -34386.787     -7295.6757      1695.8434      3436.9359    
      1800   291.24911     -34370.833      8401.0437      1479.0712      3436.9359    
      1900   306.24608     -34367.955     -2654.8463     -2630.0176      3436.9359    
      2000   323.80655     -34392.426     -9171.6293     -2629.0613      3436.9359    
Loop time of 93.0443 on 16 procs for 2000 steps with 310 atoms

Performance: 0.929 ns/day, 25.846 hours/ns, 21.495 timesteps/s, 6.663 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 67.288     | 68.598     | 71.724     |  17.2 | 73.73
Bond    | 0.00065808 | 0.00080923 | 0.00088415 |   0.0 |  0.00
Neigh   | 5.1173     | 5.2624     | 5.3213     |   2.6 |  5.66
Comm    | 5.2419     | 8.3236     | 9.6362     |  49.2 |  8.95
Output  | 0.0071057  | 0.011799   | 0.017105   |   3.4 |  0.01
Modify  | 10.4       | 10.472     | 10.602     |   1.8 | 11.25
Other   |            | 0.3762     |            |       |  0.40

Nlocal:          38.75 ave          46 max          34 min
Histogram: 2 1 0 1 1 1 1 0 0 1
Nghost:        3115.62 ave        3148 max        3083 min
Histogram: 1 0 2 1 0 1 1 0 0 2
Neighs:        24531.6 ave       28934 max       21579 min
Histogram: 2 1 0 1 1 1 1 0 0 1

Total # of neighbors = 196253
Ave neighs/atom = 633.07419
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 76.2624664464592
variable C2pos equal ${d2}
variable C2pos equal 63.0598671531028
variable C3pos equal ${d3}
variable C3pos equal 46.071578392646
variable C4pos equal ${d4}
variable C4pos equal -13.6956159809827
variable C5pos equal ${d5}
variable C5pos equal -14.9684316033757
variable C6pos equal ${d6}
variable C6pos equal -12.075498827725

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-73.4885375666182+${C1pos})
variable C14 equal 0.5*(-73.4885375666182+76.2624664464592)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(-68.6780889994616+${C2pos})
variable C24 equal 0.5*(-68.6780889994616+63.0598671531028)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-51.1740112220998+${C3pos})
variable C34 equal 0.5*(-51.1740112220998+46.071578392646)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(12.8308574539455+${C4pos})
variable C44 equal 0.5*(12.8308574539455+-13.6956159809827)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-14.1458561586983+${C5pos})
variable C54 equal 0.5*(-14.1458561586983+-14.9684316033757)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-9.08001488080218+${C6pos})
variable C64 equal 0.5*(-9.08001488080218+-12.075498827725)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.5034
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.005 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.5034
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta -0.175034 remap x units box
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.2 | 122.3 | 124.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.42651     -34312.772      8400.942       0              3436.9359    
       100   301.29272     -34343.728      2421.1636     -129.05377      3436.9359    
       200   283.43497     -34326.901     -7653.0722      895.44352      3436.9359    
       300   272.35036     -34328.171     -7625.8388     -2688.9247      3436.9359    
       400   341.88312     -34338.645      1015.9725     -6789.7612      3436.9359    
       500   299.73322     -34344.625      5727.5751      5722.1335      3436.9359    
       600   306.91838     -34359.652      812.62479     -4210.0576      3436.9359    
       700   321.70222     -34383.757     -2019.1614     -3384.4036      3436.9359    
       800   323.81193     -34384.463     -828.39891     -1966.3016      3436.9359    
       900   295.98872     -34355.588     -3268.6524     -6028.9331      3436.9359    
      1000   323.78779     -34368.535      2919.4556      440.28911      3436.9359    
      1100   291.74581     -34377.358      3304.7192     -1744.8273      3436.9359    
      1200   288.066       -34408.85      -3988.7059      2787.2097      3436.9359    
      1300   272.87495     -34362.2       -5651.1679     -877.61671      3436.9359    
      1400   291.34561     -34399.463     -7936.9835      4219.9275      3436.9359    
      1500   298.53968     -34376.819     -7844.7601     -2611.8435      3436.9359    
      1600   303.01068     -34379.93       1136.4183      2027.2492      3436.9359    
      1700   320.71809     -34386.523      6485.1553     -404.12164      3436.9359    
      1800   328.69392     -34401.633      5725.408       1425.0566      3436.9359    
      1900   329.21633     -34392.469     -4820.0328     -3497.153       3436.9359    
      2000   307.65715     -34345.791     -3187.8745     -5699.5908      3436.9359    
Loop time of 92.6684 on 16 procs for 2000 steps with 310 atoms

Performance: 0.932 ns/day, 25.741 hours/ns, 21.582 timesteps/s, 6.691 katom-step/s
98.7% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 64.223     | 68.18      | 70.258     |  21.6 | 73.57
Bond    | 0.00064837 | 0.0008241  | 0.00089477 |   0.0 |  0.00
Neigh   | 5.0158     | 5.2162     | 5.315      |   3.7 |  5.63
Comm    | 6.341      | 8.4157     | 12.335     |  61.4 |  9.08
Output  | 0.0061344  | 0.0091304  | 0.011742   |   2.2 |  0.01
Modify  | 10.338     | 10.457     | 10.656     |   2.8 | 11.28
Other   |            | 0.3896     |            |       |  0.42

Nlocal:          38.75 ave          45 max          33 min
Histogram: 1 0 1 1 2 0 1 1 0 1
Nghost:           3114 ave        3155 max        3057 min
Histogram: 1 0 0 1 1 1 1 0 2 1
Neighs:        24535.1 ave       28323 max       21073 min
Histogram: 1 0 1 1 2 0 1 1 0 1

Total # of neighbors = 196281
Ave neighs/atom = 633.16452
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -107.374606735223
variable C2neg equal ${d2}
variable C2neg equal -57.0984348405156
variable C3neg equal ${d3}
variable C3neg equal -32.6443637378305
variable C4neg equal ${d4}
variable C4neg equal -9.48932517322022
variable C5neg equal ${d5}
variable C5neg equal -11.0874386412097
variable C6neg equal ${d6}
variable C6neg equal -1.99869610393029

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.005 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.5034
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta 0.175034 remap x units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.2 | 122.3 | 124.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.42651     -34312.772      8400.942       0              3436.9359    
       100   301.29272     -34343.728      2421.1636     -129.05377      3436.9359    
       200   288.51773     -34327.841     -12302.872      404.95564      3436.9359    
       300   284.28047     -34342.881     -8974.8401     -918.18957      3436.9359    
       400   320.8186      -34344.239     -2922.2646     -3624.9284      3436.9359    
       500   305.09454     -34325.729      141.72274      3695.1774      3436.9359    
       600   304.72982     -34353.339     -12167.616     -3782.9914      3436.9359    
       700   290.9338      -34365.124     -12363.839     -4053.0406      3436.9359    
       800   299.67557     -34372.118      4077.3071     -2797.6932      3436.9359    
       900   308.32911     -34356.605     -6707.1317     -7461.0018      3436.9359    
      1000   286.10013     -34383.963     -2406.7864     -4545.6899      3436.9359    
      1100   310.63358     -34398.354     -5062.1208     -4837.7676      3436.9359    
      1200   296.60581     -34374.111      9994.1172     -786.50764      3436.9359    
      1300   313.33451     -34339.108     -533.25178      1630.8622      3436.9359    
      1400   306.62324     -34373.334      8665.218      -390.80302      3436.9359    
      1500   298.54711     -34357.561     -1974.4055     -7621.6781      3436.9359    
      1600   299.24292     -34375.277      4594.0544      1409.29        3436.9359    
      1700   287.40666     -34370.208     -1104.8472      472.65939      3436.9359    
      1800   303.47905     -34379.578     -12130.157      1170.9104      3436.9359    
      1900   302.80099     -34369.674     -10410.426     -2948.5532      3436.9359    
      2000   277.86378     -34376.941     -8061.778      -4292.7174      3436.9359    
Loop time of 93.1266 on 16 procs for 2000 steps with 310 atoms

Performance: 0.928 ns/day, 25.869 hours/ns, 21.476 timesteps/s, 6.658 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 65.593     | 68.639     | 70.777     |  18.6 | 73.71
Bond    | 0.00069311 | 0.00081369 | 0.00089598 |   0.0 |  0.00
Neigh   | 5.077      | 5.2551     | 5.3674     |   4.0 |  5.64
Comm    | 6.2242     | 8.36       | 11.394     |  53.0 |  8.98
Output  | 0.0055625  | 0.0090443  | 0.012912   |   2.9 |  0.01
Modify  | 10.459     | 10.543     | 10.696     |   2.3 | 11.32
Other   |            | 0.3193     |            |       |  0.34

Nlocal:          38.75 ave          47 max          33 min
Histogram: 1 1 2 0 1 1 0 1 0 1
Nghost:        3112.88 ave        3156 max        3044 min
Histogram: 1 0 0 0 2 1 0 1 2 1
Neighs:        24498.9 ave       29446 max       20912 min
Histogram: 1 1 2 0 1 1 0 1 0 1

Total # of neighbors = 195991
Ave neighs/atom = 632.22903
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 93.1194620161639
variable C2pos equal ${d2}
variable C2pos equal -26.6209565175146
variable C3pos equal ${d3}
variable C3pos equal 83.0154846811558
variable C4pos equal ${d4}
variable C4pos equal -10.6874025161111
variable C5pos equal ${d5}
variable C5pos equal 22.2486211080126
variable C6pos equal ${d6}
variable C6pos equal 5.40291842488973

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-107.374606735223+${C1pos})
variable C15 equal 0.5*(-107.374606735223+93.1194620161639)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-57.0984348405156+${C2pos})
variable C25 equal 0.5*(-57.0984348405156+-26.6209565175146)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-32.6443637378305+${C3pos})
variable C35 equal 0.5*(-32.6443637378305+83.0154846811558)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-9.48932517322022+${C4pos})
variable C45 equal 0.5*(-9.48932517322022+-10.6874025161111)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(-11.0874386412097+${C5pos})
variable C55 equal 0.5*(-11.0874386412097+22.2486211080126)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-1.99869610393029+${C6pos})
variable C65 equal 0.5*(-1.99869610393029+5.40291842488973)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 12.7411

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.7411
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta -0.127411 remap x units box

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.2 | 122.3 | 124.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.42651     -34312.772      8400.942       0              3436.9359    
       100   301.29272     -34343.728      2421.1636     -129.05377      3436.9359    
       200   281.03648     -34324.486     -6716.654       1128.0998      3436.9359    
       300   264.62027     -34333.223     -838.48279     -1522.7902      3436.9359    
       400   291.01979     -34339.033     -4019.6102     -4511.038       3436.9359    
       500   292.36424     -34340.976     -11807.595      816.80326      3436.9359    
       600   309.64996     -34353.358      6794.7359     -3384.283       3436.9359    
       700   332.51095     -34375.079     -2219.7411      5621.704       3436.9359    
       800   333.59049     -34380.51       3824.4713      4190.0868      3436.9359    
       900   308.90059     -34364.235      2875.884      -1760.4564      3436.9359    
      1000   289.99803     -34373.97      -15238.995     -3589.2184      3436.9359    
      1100   302.68769     -34372.701     -7625.7197     -716.50008      3436.9359    
      1200   300.66247     -34354.772      178.49049     -434.26103      3436.9359    
      1300   293.79898     -34386.092     -3835.5955     -2362.245       3436.9359    
      1400   307.55197     -34370.703     -6538.5242     -4932.954       3436.9359    
      1500   292.01805     -34371.292      5194.9601      5590.2671      3436.9359    
      1600   296.34164     -34357.274     -9754.64       -1914.7289      3436.9359    
      1700   282.56308     -34383.532     -5176.9482      785.21942      3436.9359    
      1800   329.17499     -34361.482     -3450.2303      1376.706       3436.9359    
      1900   332.73203     -34368.259      382.21033     -1255.7868      3436.9359    
      2000   316.92024     -34368.662      5735.9392      2435.5847      3436.9359    
Loop time of 93.2219 on 16 procs for 2000 steps with 310 atoms

Performance: 0.927 ns/day, 25.895 hours/ns, 21.454 timesteps/s, 6.651 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 67.259     | 68.816     | 70.744     |  13.2 | 73.82
Bond    | 0.00067345 | 0.0008038  | 0.00090034 |   0.0 |  0.00
Neigh   | 5.2004     | 5.2761     | 5.3361     |   2.2 |  5.66
Comm    | 6.3627     | 8.2806     | 9.8609     |  38.0 |  8.88
Output  | 0.0052303  | 0.007678   | 0.0093778  |   1.9 |  0.01
Modify  | 10.435     | 10.491     | 10.569     |   1.6 | 11.25
Other   |            | 0.3493     |            |       |  0.37

Nlocal:          38.75 ave          49 max          34 min
Histogram: 2 0 2 2 1 0 0 0 0 1
Nghost:        3121.88 ave        3179 max        3056 min
Histogram: 1 0 1 1 1 0 1 2 0 1
Neighs:        24510.1 ave       30610 max       21653 min
Histogram: 2 0 2 2 1 0 0 0 0 1

Total # of neighbors = 196081
Ave neighs/atom = 632.51935
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -24.9449402422254
variable C2neg equal ${d2}
variable C2neg equal -60.7572528998794
variable C3neg equal ${d3}
variable C3neg equal 10.4063181534758
variable C4neg equal ${d4}
variable C4neg equal 6.18116242891875
variable C5neg equal ${d5}
variable C5neg equal -16.9554335615586
variable C6neg equal ${d6}
variable C6neg equal 11.4280166559129

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.7411
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta 0.127411 remap x units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.2 | 122.3 | 124.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.42651     -34312.772      8400.942       0              3436.9359    
       100   301.29272     -34343.728      2421.1636     -129.05377      3436.9359    
       200   297.52357     -34337.15      -8951.5512      473.08971      3436.9359    
       300   300.57116     -34374.949     -794.17085      439.71622      3436.9359    
       400   298.71931     -34356.846      4982.7071     -327.80299      3436.9359    
       500   292.30726     -34335.254     -1854.6749     -164.80755      3436.9359    
       600   315.12207     -34351.359      698.41013     -4675.5843      3436.9359    
       700   313.18476     -34356.306      350.82722     -1140.603       3436.9359    
       800   302.32371     -34379.824     -1010.4063     -785.86037      3436.9359    
       900   317.01254     -34340.128     -16790.227     -6088.5538      3436.9359    
      1000   312.61232     -34358.485      7775.5056     -1049.5894      3436.9359    
      1100   303.82245     -34366.23      -3821.7304      2532.0882      3436.9359    
      1200   315.70791     -34369.511     -5837.5543      1267.432       3436.9359    
      1300   305.67245     -34383.21       612.44485      5340.6277      3436.9359    
      1400   314.90211     -34392.779     -3599.1311     -2329.1279      3436.9359    
      1500   298.54507     -34381.858      8888.9959      4734.183       3436.9359    
      1600   314.65388     -34397.827      11789.673      9060.2838      3436.9359    
      1700   287.96473     -34403.232     -2463.1039     -273.31911      3436.9359    
      1800   316.19157     -34392.104     -6753.0314      2284.3284      3436.9359    
      1900   279.32929     -34380.22      -6311.9481     -1297.9801      3436.9359    
      2000   290.93488     -34399.406      1470.3429      359.89727      3436.9359    
Loop time of 93.001 on 16 procs for 2000 steps with 310 atoms

Performance: 0.929 ns/day, 25.834 hours/ns, 21.505 timesteps/s, 6.667 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 66.319     | 68.783     | 71.14      |  18.4 | 73.96
Bond    | 0.00073081 | 0.00082131 | 0.00087963 |   0.0 |  0.00
Neigh   | 5.1383     | 5.216      | 5.3136     |   2.4 |  5.61
Comm    | 5.8177     | 8.1933     | 10.639     |  53.1 |  8.81
Output  | 0.0059576  | 0.0087723  | 0.011101   |   2.2 |  0.01
Modify  | 10.321     | 10.439     | 10.489     |   1.5 | 11.22
Other   |            | 0.3601     |            |       |  0.39

Nlocal:          38.75 ave          44 max          36 min
Histogram: 2 1 2 1 0 0 0 1 0 1
Nghost:         3114.5 ave        3146 max        3068 min
Histogram: 1 0 0 1 2 0 1 1 0 2
Neighs:          24521 ave       27696 max       22783 min
Histogram: 2 1 2 1 0 0 0 1 0 1

Total # of neighbors = 196168
Ave neighs/atom = 632.8
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 45.9768434965735
variable C2pos equal ${d2}
variable C2pos equal 64.045390579705
variable C3pos equal ${d3}
variable C3pos equal 97.5592314790212
variable C4pos equal ${d4}
variable C4pos equal 9.39454350924536
variable C5pos equal ${d5}
variable C5pos equal 4.0760751339457
variable C6pos equal ${d6}
variable C6pos equal 9.27149474154568

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-24.9449402422254+${C1pos})
variable C16 equal 0.5*(-24.9449402422254+45.9768434965735)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-60.7572528998794+${C2pos})
variable C26 equal 0.5*(-60.7572528998794+64.045390579705)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(10.4063181534758+${C3pos})
variable C36 equal 0.5*(10.4063181534758+97.5592314790212)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(6.18116242891875+${C4pos})
variable C46 equal 0.5*(6.18116242891875+9.39454350924536)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(-16.9554335615586+${C5pos})
variable C56 equal 0.5*(-16.9554335615586+4.0760751339457)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(11.4280166559129+${C6pos})
variable C66 equal 0.5*(11.4280166559129+9.27149474154568)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal -18.9713339538266
variable C22all equal ${C22}
variable C22all equal 43.9649657363089
variable C33all equal ${C33}
variable C33all equal 44.6674055579668

variable C44all equal ${C44}
variable C44all equal -0.4323792635186
variable C55all equal ${C55}
variable C55all equal 5.58059123340145
variable C66all equal ${C66}
variable C66all equal 10.3497556987293

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(-3.888556051526+${C21})
variable C12all equal 0.5*(-3.888556051526+6.12459266924925)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(20.2390093680613+${C31})
variable C13all equal 0.5*(20.2390093680613+-6.17531412726418)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(25.7629370534396+${C32})
variable C23all equal 0.5*(25.7629370534396+-1.07351933352935)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(1.3869644399205+${C41})
variable C14all equal 0.5*(1.3869644399205+-6.81205627733809)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-7.12757235952955+${C51})
variable C15all equal 0.5*(-7.12757235952955+1.82437750913745)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(10.5159516271741+${C61})
variable C16all equal 0.5*(10.5159516271741+0.163787705987951)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-2.8091109231794+${C42})
variable C24all equal 0.5*(-2.8091109231794+-5.97487372346056)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-41.8596956790151+${C52})
variable C25all equal 0.5*(-41.8596956790151+-5.16672750192658)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(1.6440688399128+${C62})
variable C26all equal 0.5*(1.6440688399128+12.4873360968052)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(-2.5512164147269+${C43})
variable C34all equal 0.5*(-2.5512164147269+-0.787750026513345)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(25.1855604716626+${C53})
variable C35all equal 0.5*(25.1855604716626+6.28356839219031)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(53.9827748162485+${C63})
variable C36all equal 0.5*(53.9827748162485+-1.65780853313964)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-10.0883638446657+${C54})
variable C45all equal 0.5*(-10.0883638446657+-14.557143881037)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(7.78785296908205+${C64})
variable C46all equal 0.5*(7.78785296908205+-10.5777568542636)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-6.43967921380645+${C65})
variable C56all equal 0.5*(-6.43967921380645+1.70211116047972)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by deform-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:20:09
