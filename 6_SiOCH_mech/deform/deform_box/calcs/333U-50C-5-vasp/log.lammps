LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 30*${nthermo}       # steps of equilibration run 10
variable nequil equal 30*100       
variable nrun equal 30*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 30*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-5-vasp
read_data       ${structure}.data
read_data       333U-50C-5-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.007 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 5.6921e-05 on 8 procs for 1 steps with 350 atoms

53.4% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.327e-06  | 1.8505e-06 | 2.374e-06  |   0.0 |  3.25
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 3.842e-06  | 4.7844e-06 | 4.959e-06  |   0.0 |  8.41
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 5.029e-05  |            |       | 88.34

Nlocal:          43.75 ave          49 max          38 min
Histogram: 2 1 0 1 0 0 0 1 1 2
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-5-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
run ${nequil}
run 3000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -10.66 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.3 | 123 | 123.7 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -38963.433      102489.53      1.6516858      3932.1873    
       100   818.7958      -40090.051     -25805.076      1.6516858      3932.1873    
       200   609.55022     -40434.752     -10112.432      1.6516858      3932.1873    
       300   476.2777      -40665.002      13.431169      1.6516858      3932.1873    
       400   359.05501     -40792.817      14819.286      1.6516858      3932.1873    
       500   315.9059      -40907.936      3146.2061      1.6516858      3932.1873    
       600   289.23918     -40978.778     -6847.2998      1.6516858      3932.1873    
       700   265.59754     -40989.609     -8482.2105      1.6516858      3932.1873    
       800   301.58706     -41004.799     -12887.395      1.6516858      3932.1873    
       900   301.42583     -40968.266     -9420.7734      1.6516858      3932.1873    
      1000   323.62896     -40987.852     -11094.557      1.6516858      3932.1873    
      1100   297.9147      -41005.6       -4213.7463      1.6516858      3932.1873    
      1200   295.62378     -41043.871     -593.79113      1.6516858      3932.1873    
      1300   298.65395     -41074.234     -3614.3977      1.6516858      3932.1873    
      1400   290.32705     -41080.779     -6775.9377      1.6516858      3932.1873    
      1500   284.37281     -41072.601     -19712.599      1.6516858      3932.1873    
      1600   303.99065     -41071.598     -7502.4916      1.6516858      3932.1873    
      1700   297.46512     -41044.072     -4328.2975      1.6516858      3932.1873    
      1800   316.50978     -41055.993     -4105.7996      1.6516858      3932.1873    
      1900   292.24878     -41042.854     -5421.454       1.6516858      3932.1873    
      2000   325.19731     -41089.602     -4661.4125      1.6516858      3932.1873    
      2100   317.03608     -41099.426     -11922.93       1.6516858      3932.1873    
      2200   289.06435     -41079.603     -15089.626      1.6516858      3932.1873    
      2300   298.96132     -41086.185     -6739.7201      1.6516858      3932.1873    
      2400   317.02286     -41089.474     -18822.931      1.6516858      3932.1873    
      2500   299.4654      -41072.288      2526.457       1.6516858      3932.1873    
      2600   299.54421     -41079.135     -3755.0308      1.6516858      3932.1873    
      2700   295.97095     -41078.019     -7559.5803      1.6516858      3932.1873    
      2800   276.16629     -41064.501     -11525.277      1.6516858      3932.1873    
      2900   313.3314      -41104.361     -158.86441      1.6516858      3932.1873    
      3000   286.18816     -41071.636     -11391.879      1.6516858      3932.1873    
Loop time of 128.131 on 8 procs for 3000 steps with 350 atoms

Performance: 1.011 ns/day, 23.728 hours/ns, 23.414 timesteps/s, 8.195 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 71.95      | 90.059     | 105.91     | 158.0 | 70.29
Bond    | 0.0073773  | 0.0078875  | 0.0084148  |   0.3 |  0.01
Neigh   | 6.7763     | 8.3307     | 9.7318     |  45.3 |  6.50
Comm    | 1.8398     | 17.693     | 35.809     | 356.5 | 13.81
Output  | 0.0013999  | 0.001521   | 0.0023017  |   0.8 |  0.00
Modify  | 10.565     | 11.975     | 13.528     |  38.0 |  9.35
Other   |            | 0.06299    |            |       |  0.05

Nlocal:          43.75 ave          50 max          37 min
Histogram: 1 0 0 2 2 0 1 0 0 2
Nghost:        3101.25 ave        3143 max        3062 min
Histogram: 1 1 2 0 0 0 2 0 0 2
Neighs:          27201 ave       30902 max       23320 min
Histogram: 1 0 1 1 2 1 0 0 0 2

Total # of neighbors = 217608
Ave neighs/atom = 621.73714
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333U-50C-5-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.6782
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 14.2194
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.6383

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.675
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal -1.0144
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -7.0409

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 15.6782
variable dlen equal lx-${len0}
variable dlen equal lx-15.6782
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.6782
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.0408999999999997144, deltaxy = 0.070409
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.0143999999999999684, deltaxz = 0.010144
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.67500000000000004441, deltayz = -0.00675
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.156782 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.156782 xy delta 0.070409 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.156782 xy delta 0.070409 xz delta 0.010144 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.8 | 121 | 122.3 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   286.18816     -41071.636     -11391.858      1.6516858      3932.1873    
       100   300.57133     -41079.391     -8926.7163      1.6522365      3930.8766    
       200   300.97029     -41090.312     -15330.743      1.6527877      3929.5658    
       300   284.75258     -41095.138      7373.6813      1.6533391      3928.2551    
       400   300.27327     -41120.29      -17276.86       1.653891       3926.9444    
       500   309.60592     -41107.414     -13243.763      1.6544432      3925.6337    
       600   318.32747     -41086.448      2998.8075      1.6549958      3924.3229    
       700   313.72916     -41077.278     -1716.7838      1.6555487      3923.0122    
       800   296.78209     -41084.893     -5062.9876      1.6561021      3921.7015    
       900   274.44663     -41086.884     -11013.705      1.6566558      3920.3907    
      1000   273.83506     -41095.005     -3139.8905      1.6572098      3919.08      
      1100   304.87096     -41119.087     -10413.444      1.6577643      3917.7693    
      1200   294.47786     -41090.113     -7016.1064      1.6583191      3916.4586    
      1300   320.88618     -41102.284     -11329.439      1.6588743      3915.1478    
      1400   308.80727     -41094.099     -1716.2672      1.6594298      3913.8371    
      1500   304.33198     -41103.632     -12402.343      1.6599857      3912.5264    
      1600   288.01109     -41106.268     -6157.3364      1.660542       3911.2156    
      1700   295.77773     -41121.98      -21894.61       1.6610987      3909.9049    
      1800   296.56349     -41125.707      3367.7818      1.6616557      3908.5942    
      1900   305.74094     -41130.71       11962.038      1.6622131      3907.2835    
      2000   294.76945     -41119.496      2976.8805      1.6627709      3905.9727    
      2100   300.74675     -41126.401     -7587.7851      1.6633291      3904.662     
      2200   292.89148     -41126.953     -10205.579      1.6638876      3903.3513    
      2300   285.14952     -41129.991     -13882.035      1.6644466      3902.0405    
      2400   292.47561     -41139.368     -14387.032      1.6650058      3900.7298    
      2500   306.27955     -41141.677     -13264.089      1.6655655      3899.4191    
      2600   294.0325      -41119.139     -1148.2482      1.6661256      3898.1083    
      2700   291.45019     -41124.087      359.43295      1.666686       3896.7976    
      2800   295.2747      -41144.803     -469.224        1.6672468      3895.4869    
      2900   282.32793     -41132.713     -9947.5487      1.6678079      3894.1762    
      3000   307.70776     -41126.569      1886.1063      1.6683695      3892.8654    
Loop time of 129.463 on 8 procs for 3000 steps with 350 atoms

Performance: 1.001 ns/day, 23.975 hours/ns, 23.173 timesteps/s, 8.110 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 72.567     | 91.194     | 107.32     | 147.0 | 70.44
Bond    | 0.0074047  | 0.0078744  | 0.008223   |   0.4 |  0.01
Neigh   | 6.7812     | 8.3529     | 9.6972     |  42.5 |  6.45
Comm    | 1.6531     | 17.778     | 36.414     | 333.0 | 13.73
Output  | 0.0081837  | 0.0095627  | 0.010534   |   0.9 |  0.01
Modify  | 10.702     | 12.053     | 13.62      |  35.5 |  9.31
Other   |            | 0.06678    |            |       |  0.05

Nlocal:          43.75 ave          50 max          37 min
Histogram: 2 0 0 1 0 0 4 0 0 1
Nghost:        3136.38 ave        3186 max        3108 min
Histogram: 3 0 0 1 2 1 0 0 0 1
Neighs:        27484.5 ave       31306 max       23549 min
Histogram: 2 0 1 0 0 0 4 0 0 1

Total # of neighbors = 219876
Ave neighs/atom = 628.21714
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.6782
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.156782 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.156782 xy delta -0.070409 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.156782 xy delta -0.070409 xz delta -0.010144 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.8 | 121 | 122.4 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   286.18816     -41071.636     -11391.858      1.6516858      3932.1873    
       100   300.66516     -41079.471     -8900.0359      1.6511354      3933.498     
       200   300.61051     -41090.41      -17219.131      1.6505854      3934.8088    
       300   281.51231     -41090.515      7958.7254      1.6500358      3936.1195    
       400   297.02003     -41112.718     -20794.265      1.6494865      3937.4302    
       500   310.04946     -41101.55      -12055.166      1.6489376      3938.7409    
       600   316.78953     -41078.005      13155.531      1.648389       3940.0517    
       700   300.59186     -41056.284     -8453.8959      1.6478408      3941.3624    
       800   307.59305     -41085.244     -15131.297      1.647293       3942.6731    
       900   287.79867     -41098.299      8038.5763      1.6467456      3943.9839    
      1000   302.2089      -41134.506     -5941.7944      1.6461985      3945.2946    
      1100   277.63059     -41116.541     -10329.724      1.6456517      3946.6053    
      1200   289.9677      -41114.724     -8416.1494      1.6451054      3947.9161    
      1300   307.68378     -41108.092     -7550.1344      1.6445594      3949.2268    
      1400   321.29083     -41110.943     -12059.449      1.6440137      3950.5375    
      1500   283.27973     -41084.931     -11056.608      1.6434685      3951.8482    
      1600   301.01182     -41112.86      -3297.4         1.6429235      3953.159     
      1700   305.05513     -41112.501     -3926.9626      1.642379       3954.4697    
      1800   307.94743     -41104.674     -8350.7886      1.6418348      3955.7804    
      1900   309.92503     -41103.259     -9329.1575      1.641291       3957.0912    
      2000   310.68988     -41111.993     -12056.076      1.6407475      3958.4019    
      2100   291.1031      -41106.534      3833.9572      1.6402044      3959.7126    
      2200   298.01901     -41116.703     -19181.741      1.6396616      3961.0233    
      2300   292.89179     -41095.216     -4777.463       1.6391192      3962.3341    
      2400   317.98186     -41111.668     -3069.995       1.6385772      3963.6448    
      2500   303.70612     -41103.251     -12501.004      1.6380355      3964.9555    
      2600   307.31185     -41118.325     -1598.7048      1.6374942      3966.2663    
      2700   309.56224     -41140.279     -11525.173      1.6369532      3967.577     
      2800   288.87615     -41124.505     -14678.113      1.6364126      3968.8877    
      2900   301.99247     -41111.806     -12420.345      1.6358724      3970.1984    
      3000   296.56105     -41087.048     -7326.0495      1.6353325      3971.5092    
Loop time of 129.01 on 8 procs for 3000 steps with 350 atoms

Performance: 1.005 ns/day, 23.891 hours/ns, 23.254 timesteps/s, 8.139 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 71.817     | 90.044     | 107.18     | 166.7 | 69.80
Bond    | 0.0073273  | 0.0079248  | 0.0083913  |   0.4 |  0.01
Neigh   | 6.7124     | 8.3036     | 9.837      |  49.7 |  6.44
Comm    | 1.2178     | 18.355     | 36.594     | 369.0 | 14.23
Output  | 0.0080313  | 0.0094094  | 0.010553   |   0.9 |  0.01
Modify  | 10.687     | 12.222     | 13.806     |  41.3 |  9.47
Other   |            | 0.06781    |            |       |  0.05

Nlocal:          43.75 ave          47 max          37 min
Histogram: 2 0 0 0 0 0 0 1 1 4
Nghost:           3108 ave        3177 max        3063 min
Histogram: 1 2 0 2 0 1 1 0 0 1
Neighs:        26931.8 ave       28859 max       22949 min
Histogram: 2 0 0 0 0 0 1 0 2 3

Total # of neighbors = 215454
Ave neighs/atom = 615.58286
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 14.2194
variable dlen equal ly-${len0}
variable dlen equal ly-14.2194
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.2194
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.0408999999999997144, deltaxy = 0.070409
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.0143999999999999684, deltaxz = 0.010144
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.67500000000000004441, deltayz = -0.00675
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.142194 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.142194 yz delta -0.00675 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.8 | 121 | 122.3 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   286.18816     -41071.636     -11391.858      1.6516858      3932.1873    
       100   300.67532     -41079.393     -8708.0945      1.6522365      3930.8766    
       200   300.95154     -41091.237     -17765.996      1.6527877      3929.5658    
       300   282.28022     -41093.023      8260.2818      1.6533391      3928.2551    
       400   297.1468      -41116.22      -21621.362      1.653891       3926.9444    
       500   307.503       -41105.936     -5607.6442      1.6544432      3925.6337    
       600   317.29891     -41089.313      6747.2274      1.6549958      3924.3229    
       700   308.33852     -41074.999     -8954.484       1.6555487      3923.0122    
       800   297.38783     -41086.974     -14329.857      1.6561021      3921.7015    
       900   282.89717     -41093.934     -3633.8898      1.6566558      3920.3907    
      1000   296.7261      -41108.75       2806.4631      1.6572098      3919.08      
      1100   305.57366     -41105.977     -9501.422       1.6577643      3917.7693    
      1200   303.33673     -41089.019      2071.8118      1.6583191      3916.4586    
      1300   318.0376      -41103.229     -12876.868      1.6588743      3915.1478    
      1400   312.08074     -41110.179     -8489.4565      1.6594298      3913.8371    
      1500   280.94085     -41101.13      -6524.4501      1.6599857      3912.5264    
      1600   270.23736     -41093.142     -4442.0793      1.660542       3911.2156    
      1700   281.11416     -41077.264      2159.5537      1.6610987      3909.9049    
      1800   306.86364     -41083.84       3704.4545      1.6616557      3908.5942    
      1900   318.80578     -41111.463     -19705.118      1.6622131      3907.2835    
      2000   274.92369     -41090.905     -342.88862      1.6627709      3905.9727    
      2100   303.08682     -41118.416      3027.9866      1.6633291      3904.662     
      2200   307.36422     -41109.577     -3878.2563      1.6638876      3903.3513    
      2300   294.01009     -41095.606      945.66296      1.6644466      3902.0405    
      2400   310.49372     -41112.641     -5310.0922      1.6650058      3900.7298    
      2500   300.79619     -41111.392     -2560.5828      1.6655655      3899.4191    
      2600   308.62287     -41128.082     -2915.8046      1.6661256      3898.1083    
      2700   302.15256     -41132.246     -2277.4355      1.666686       3896.7976    
      2800   293.29106     -41129.952     -4643.389       1.6672468      3895.4869    
      2900   290.89763     -41130.568     -240.09574      1.6678079      3894.1762    
      3000   293.06981     -41138.323      5757.6808      1.6683695      3892.8654    
Loop time of 130.658 on 8 procs for 3000 steps with 350 atoms

Performance: 0.992 ns/day, 24.196 hours/ns, 22.961 timesteps/s, 8.036 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 73.223     | 91.275     | 108.65     | 169.0 | 69.86
Bond    | 0.0073129  | 0.0080035  | 0.0086816  |   0.5 |  0.01
Neigh   | 6.8004     | 8.386      | 9.9086     |  49.9 |  6.42
Comm    | 1.3601     | 18.744     | 36.808     | 372.7 | 14.35
Output  | 0.0081318  | 0.009701   | 0.010897   |   0.9 |  0.01
Modify  | 10.644     | 12.17      | 13.748     |  41.8 |  9.31
Other   |            | 0.06641    |            |       |  0.05

Nlocal:          43.75 ave          47 max          40 min
Histogram: 1 1 1 0 0 2 0 1 0 2
Nghost:         3154.5 ave        3190 max        3132 min
Histogram: 2 0 1 2 1 0 1 0 0 1
Neighs:        27498.5 ave       29427 max       25258 min
Histogram: 1 1 1 0 0 2 0 1 0 2

Total # of neighbors = 219988
Ave neighs/atom = 628.53714
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.2194
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.142194 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.142194 yz delta 0.00675 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.8 | 121 | 122.4 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   286.18816     -41071.636     -11391.858      1.6516858      3932.1873    
       100   300.5422      -41079.434     -8772.1815      1.6511354      3933.498     
       200   301.33994     -41090.492     -16793.297      1.6505854      3934.8088    
       300   279.19355     -41087.497      7756.5201      1.6500358      3936.1195    
       400   302.4313      -41120.068     -30002.562      1.6494865      3937.4302    
       500   302.63795     -41096.662     -15552.78       1.6489376      3938.7409    
       600   329.21628     -41092.44       8696.4477      1.648389       3940.0517    
       700   308.14746     -41066.269     -10708.413      1.6478408      3941.3624    
       800   309.25022     -41094.767     -5592.7161      1.647293       3942.6731    
       900   308.38499     -41128.082     -255.08091      1.6467456      3943.9839    
      1000   288.48582     -41127.898     -8398.7833      1.6461985      3945.2946    
      1100   261.10119     -41103.465     -3821.9591      1.6456517      3946.6053    
      1200   287.48778     -41109.26      -3001.2301      1.6451054      3947.9161    
      1300   306.97006     -41100.417     -8843.3409      1.6445594      3949.2268    
      1400   320.12605     -41114.885     -5734.7941      1.6440137      3950.5375    
      1500   307.08038     -41131.806     -18657.949      1.6434685      3951.8482    
      1600   295.6248      -41139.515     -19821.387      1.6429235      3953.159     
      1700   279.40302     -41122.194      920.76553      1.642379       3954.4697    
      1800   291.00764     -41107.399      3453.388       1.6418348      3955.7804    
      1900   301.16204     -41095.678     -8532.9533      1.641291       3957.0912    
      2000   316.8244      -41106.886     -23183.065      1.6407475      3958.4019    
      2100   285.06101     -41095.104     -11969.513      1.6402044      3959.7126    
      2200   291.14047     -41117.379     -20744.557      1.6396616      3961.0233    
      2300   308.08014     -41140.527     -14384.268      1.6391192      3962.3341    
      2400   297.96822     -41136.815     -7800.5168      1.6385772      3963.6448    
      2500   297.76843     -41125.144     -13501.685      1.6380355      3964.9555    
      2600   306.02048     -41112.18      -9602.2372      1.6374942      3966.2663    
      2700   330.6234      -41120.467     -13492.465      1.6369532      3967.577     
      2800   309.00922     -41114.777     -10695.025      1.6364126      3968.8877    
      2900   287.89002     -41122.685     -15298.378      1.6358724      3970.1984    
      3000   285.8121      -41124.744     -11520.995      1.6353325      3971.5092    
Loop time of 128.478 on 8 procs for 3000 steps with 350 atoms

Performance: 1.009 ns/day, 23.792 hours/ns, 23.350 timesteps/s, 8.173 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 71.608     | 89.543     | 106.66     | 167.3 | 69.69
Bond    | 0.0075596  | 0.0079705  | 0.0087249  |   0.4 |  0.01
Neigh   | 6.6753     | 8.2568     | 9.7722     |  49.8 |  6.43
Comm    | 1.3462     | 18.468     | 36.414     | 368.2 | 14.37
Output  | 0.008466   | 0.0099229  | 0.011149   |   0.9 |  0.01
Modify  | 10.593     | 12.126     | 13.702     |  41.4 |  9.44
Other   |            | 0.06756    |            |       |  0.05

Nlocal:          43.75 ave          52 max          37 min
Histogram: 2 0 2 0 0 0 1 2 0 1
Nghost:        3075.88 ave        3136 max        3026 min
Histogram: 1 1 0 2 0 1 2 0 0 1
Neighs:        26929.1 ave       31728 max       23217 min
Histogram: 2 1 1 0 0 1 0 2 0 1

Total # of neighbors = 215433
Ave neighs/atom = 615.52286
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.6383
variable dlen equal lz-${len0}
variable dlen equal lz-17.6383
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.6383
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.0408999999999997144, deltaxy = 0.070409
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.0143999999999999684, deltaxz = 0.010144
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.67500000000000004441, deltayz = -0.00675
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -0.176383 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.8 | 121 | 122.3 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   286.18816     -41071.636     -11391.858      1.6516858      3932.1873    
       100   300.63798     -41079.428     -8716.0449      1.6522365      3930.8766    
       200   302.42825     -41091.766     -17408.803      1.6527877      3929.5658    
       300   281.85411     -41092.352      5362.052       1.6533391      3928.2551    
       400   294.7519      -41112.243     -19256.974      1.653891       3926.9444    
       500   292.61199     -41085.413     -8070.7107      1.6544432      3925.6337    
       600   318.01549     -41084.81       4981.6941      1.6549958      3924.3229    
       700   305.17793     -41071.343     -9459.7563      1.6555487      3923.0122    
       800   288.38975     -41079.519     -8472.1132      1.6561021      3921.7015    
       900   298.64511     -41113.613     -10276.39       1.6566558      3920.3907    
      1000   297.89342     -41126.312     -1190.1222      1.6572098      3919.08      
      1100   308.76539     -41133.558     -281.75401      1.6577643      3917.7693    
      1200   295.99492     -41112.792     -12429.149      1.6583191      3916.4586    
      1300   294.82106     -41104.99      -4524.19        1.6588743      3915.1478    
      1400   307.59414     -41109.396     -10206.06       1.6594298      3913.8371    
      1500   312.76928     -41119.248     -3300.8968      1.6599857      3912.5264    
      1600   296.35604     -41110.322     -14199.446      1.660542       3911.2156    
      1700   323.45942     -41138.979     -10738.921      1.6610987      3909.9049    
      1800   297.92657     -41111.854     -8768.8765      1.6616557      3908.5942    
      1900   294.0121      -41109.372      87.687063      1.6622131      3907.2835    
      2000   306.90132     -41126.94      -20241.082      1.6627709      3905.9727    
      2100   305.03708     -41119.709     -6929.026       1.6633291      3904.662     
      2200   292.49564     -41106.354      1940.3122      1.6638876      3903.3513    
      2300   295.4225      -41120.518     -4860.4302      1.6644466      3902.0405    
      2400   305.6529      -41133.773     -8051.2919      1.6650058      3900.7298    
      2500   293.21383     -41118.217     -3575.3083      1.6655655      3899.4191    
      2600   300.34338     -41137.011      1101.8489      1.6661256      3898.1083    
      2700   291.44182     -41137.945      5484.8021      1.666686       3896.7976    
      2800   311.92461     -41141.74       13133.448      1.6672468      3895.4869    
      2900   306.42165     -41122.056      5096.8342      1.6678079      3894.1762    
      3000   301.34335     -41116.442     -8734.8692      1.6683695      3892.8654    
Loop time of 130.687 on 8 procs for 3000 steps with 350 atoms

Performance: 0.992 ns/day, 24.201 hours/ns, 22.956 timesteps/s, 8.034 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 73.442     | 91.385     | 108.27     | 148.2 | 69.93
Bond    | 0.0074393  | 0.0080082  | 0.0085122  |   0.4 |  0.01
Neigh   | 6.8046     | 8.3842     | 9.8361     |  44.8 |  6.42
Comm    | 1.7043     | 18.576     | 36.531     | 328.5 | 14.21
Output  | 0.0081248  | 0.0096192  | 0.010735   |   0.9 |  0.01
Modify  | 10.789     | 12.257     | 13.83      |  37.4 |  9.38
Other   |            | 0.06704    |            |       |  0.05

Nlocal:          43.75 ave          48 max          38 min
Histogram: 2 0 0 0 1 0 1 0 1 3
Nghost:        3155.88 ave        3178 max        3114 min
Histogram: 1 0 0 0 2 0 1 0 2 2
Neighs:        27480.5 ave       29989 max       23954 min
Histogram: 2 0 0 0 1 0 1 1 0 3

Total # of neighbors = 219844
Ave neighs/atom = 628.12571
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.6383
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 0.176383 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.8 | 121 | 122.3 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   286.18816     -41071.636     -11391.858      1.6516858      3932.1873    
       100   300.58445     -41079.387     -8819.1692      1.6511354      3933.498     
       200   300.65729     -41090.571     -16823.762      1.6505854      3934.8088    
       300   284.87755     -41093.831      8067.4993      1.6500358      3936.1195    
       400   298.70357     -41118.021     -21012.342      1.6494865      3937.4302    
       500   313.40906     -41110.312     -9575.2399      1.6489376      3938.7409    
       600   298.57704     -41069.001      6348.9619      1.648389       3940.0517    
       700   317.78807     -41078.163     -6947.7167      1.6478408      3941.3624    
       800   313.59137     -41089.08      -841.80037      1.647293       3942.6731    
       900   299.21817     -41100.6       -6988.839       1.6467456      3943.9839    
      1000   300.45803     -41117.109     -7744.5866      1.6461985      3945.2946    
      1100   292.65873     -41108.839     -5694.7036      1.6456517      3946.6053    
      1200   285.93976     -41094.329     -6520.6185      1.6451054      3947.9161    
      1300   307.88964     -41106.063     -10506.073      1.6445594      3949.2268    
      1400   318.85858     -41119.327     -13711.01       1.6440137      3950.5375    
      1500   303.42996     -41136.362     -17167.566      1.6434685      3951.8482    
      1600   294.58417     -41144.784      450.57073      1.6429235      3953.159     
      1700   299.20453     -41132.91      -9684.6499      1.642379       3954.4697    
      1800   312.37701     -41129.213     -7216.1162      1.6418348      3955.7804    
      1900   309.1274      -41129.988     -11716.596      1.641291       3957.0912    
      2000   301.50239     -41131.513     -7632.6131      1.6407475      3958.4019    
      2100   313.35448     -41142.468     -915.71667      1.6402044      3959.7126    
      2200   300.30717     -41131.803     -13385.429      1.6396616      3961.0233    
      2300   305.58641     -41131.921     -7318.4184      1.6391192      3962.3341    
      2400   306.16244     -41130.415     -11501.462      1.6385772      3963.6448    
      2500   291.25468     -41113.633     -5753.5423      1.6380355      3964.9555    
      2600   290.37542     -41121.487     -9643.5014      1.6374942      3966.2663    
      2700   274.63031     -41120.636     -20093.462      1.6369532      3967.577     
      2800   292.67867     -41133.747     -15069.067      1.6364126      3968.8877    
      2900   305.82982     -41120.35      -3869.576       1.6358724      3970.1984    
      3000   294.84115     -41101.719     -17219.964      1.6353325      3971.5092    
Loop time of 128.647 on 8 procs for 3000 steps with 350 atoms

Performance: 1.007 ns/day, 23.824 hours/ns, 23.320 timesteps/s, 8.162 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 72.05      | 89.833     | 106.48     | 165.9 | 69.83
Bond    | 0.0072787  | 0.0078344  | 0.0083752  |   0.4 |  0.01
Neigh   | 6.7048     | 8.2669     | 9.7617     |  48.6 |  6.43
Comm    | 1.652      | 18.299     | 36.09      | 367.5 | 14.22
Output  | 0.0081463  | 0.0095248  | 0.01067    |   0.9 |  0.01
Modify  | 10.667     | 12.165     | 13.723     |  40.4 |  9.46
Other   |            | 0.06664    |            |       |  0.05

Nlocal:          43.75 ave          50 max          35 min
Histogram: 2 0 0 0 0 0 2 2 1 1
Nghost:           3075 ave        3117 max        3036 min
Histogram: 1 1 1 1 0 0 1 2 0 1
Neighs:        26963.2 ave       30607 max       21808 min
Histogram: 2 0 0 0 0 1 1 2 1 1

Total # of neighbors = 215706
Ave neighs/atom = 616.30286
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 15.6782
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.675)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.6782
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.0408999999999997144, deltaxy = 0.070409
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.0143999999999999684, deltaxz = 0.010144
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.67500000000000004441, deltayz = -0.00675
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -0.156782 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.8 | 121 | 122.3 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   286.18816     -41071.636     -11391.858      1.6516858      3932.1873    
       100   300.63818     -41079.429     -8733.7172      1.6516858      3932.1873    
       200   300.13466     -41090.185     -17496.574      1.6516858      3932.1873    
       300   284.85425     -41095.047      6271.3017      1.6516858      3932.1873    
       400   304.21472     -41122.824     -22664.859      1.6516858      3932.1873    
       500   312.60729     -41108.915     -14480.315      1.6516858      3932.1873    
       600   318.27192     -41090.649     -3322.9385      1.6516858      3932.1873    
       700   291.15376     -41057.055     -1854.7561      1.6516858      3932.1873    
       800   299.16488     -41084.82      -9196.622       1.6516858      3932.1873    
       900   301.52871     -41109.603     -3080.2163      1.6516858      3932.1873    
      1000   293.13255     -41107.521     -7686.338       1.6516858      3932.1873    
      1100   293.64193     -41101.931     -14694.979      1.6516858      3932.1873    
      1200   312.75976     -41115.203     -11094.952      1.6516858      3932.1873    
      1300   291.11161     -41109.335     -676.00814      1.6516858      3932.1873    
      1400   295.30206     -41129.691     -16730.605      1.6516858      3932.1873    
      1500   287.99452     -41129.619     -3762.5692      1.6516858      3932.1873    
      1600   278.74181     -41112.959     -13849.822      1.6516858      3932.1873    
      1700   304.92834     -41116.12      -7641.3774      1.6516858      3932.1873    
      1800   313.80536     -41115.226     -9290.6671      1.6516858      3932.1873    
      1900   304.07706     -41125.078     -8659.8334      1.6516858      3932.1873    
      2000   295.48738     -41137.39      -18920.322      1.6516858      3932.1873    
      2100   267.43291     -41113.26       1119.55        1.6516858      3932.1873    
      2200   304.61292     -41130.098     -8927.6579      1.6516858      3932.1873    
      2300   313.16253     -41120.562     -24399.709      1.6516858      3932.1873    
      2400   306.35453     -41113.593     -10308.599      1.6516858      3932.1873    
      2500   288.54782     -41109.407     -11498.747      1.6516858      3932.1873    
      2600   285.3461      -41125.011     -5937.4452      1.6516858      3932.1873    
      2700   311.73839     -41158.524     -12056.637      1.6516858      3932.1873    
      2800   301.65497     -41126.391     -6354.2696      1.6516858      3932.1873    
      2900   311.03372     -41116.544     -9128.4718      1.6516858      3932.1873    
      3000   303.62514     -41115.437     -2387.9436      1.6516858      3932.1873    
Loop time of 129.504 on 8 procs for 3000 steps with 350 atoms

Performance: 1.001 ns/day, 23.982 hours/ns, 23.165 timesteps/s, 8.108 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 73.259     | 90.688     | 107.14     | 163.0 | 70.03
Bond    | 0.0072487  | 0.0078424  | 0.0083216  |   0.4 |  0.01
Neigh   | 6.7717     | 8.3433     | 9.9021     |  48.7 |  6.44
Comm    | 1.7829     | 18.233     | 35.667     | 363.4 | 14.08
Output  | 0.008018   | 0.0094469  | 0.010582   |   0.9 |  0.01
Modify  | 10.588     | 12.156     | 13.726     |  40.6 |  9.39
Other   |            | 0.06699    |            |       |  0.05

Nlocal:          43.75 ave          47 max          39 min
Histogram: 2 0 0 1 0 0 0 1 3 1
Nghost:           3133 ave        3177 max        3103 min
Histogram: 2 1 1 1 1 0 0 0 0 2
Neighs:        27209.1 ave       29093 max       24325 min
Histogram: 2 0 0 0 1 0 0 1 3 1

Total # of neighbors = 217673
Ave neighs/atom = 621.92286
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.6782
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 0.156782 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.8 | 121 | 122.4 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   286.18816     -41071.636     -11391.858      1.6516858      3932.1873    
       100   300.58577     -41079.41      -8765.4362      1.6516858      3932.1873    
       200   301.43782     -41091.334     -16811.843      1.6516858      3932.1873    
       300   280.33284     -41089.787      7076.5388      1.6516858      3932.1873    
       400   293.74041     -41110.447     -22392.242      1.6516858      3932.1873    
       500   300.80892     -41091.731     -7153.8086      1.6516858      3932.1873    
       600   304.2397      -41065.322      7986.2865      1.6516858      3932.1873    
       700   303.89693     -41060.012     -12378.368      1.6516858      3932.1873    
       800   309.15303     -41087.148     -7083.5185      1.6516858      3932.1873    
       900   292.22176     -41099.821     -9895.5714      1.6516858      3932.1873    
      1000   287.91564     -41111.94      -2956.1217      1.6516858      3932.1873    
      1100   289.8978      -41106.422      285.48117      1.6516858      3932.1873    
      1200   308.01867     -41108.14       9127.2983      1.6516858      3932.1873    
      1300   320.02212     -41101.904     -10252.938      1.6516858      3932.1873    
      1400   328.73091     -41116.602      596.31302      1.6516858      3932.1873    
      1500   277.88249     -41098.996     -2296.4259      1.6516858      3932.1873    
      1600   288.69412     -41127.885     -4500.1027      1.6516858      3932.1873    
      1700   296.33744     -41120.631     -11393.552      1.6516858      3932.1873    
      1800   309.0833      -41105.785     -8899.1856      1.6516858      3932.1873    
      1900   317.16379     -41095.827     -7860.9933      1.6516858      3932.1873    
      2000   307.69586     -41089.314      867.01127      1.6516858      3932.1873    
      2100   289.44006     -41093.806     -3620.747       1.6516858      3932.1873    
      2200   285.89015     -41108.245     -5330.3613      1.6516858      3932.1873    
      2300   291.29069     -41113.663     -3053.1801      1.6516858      3932.1873    
      2400   296.74268     -41098.206     -11319.74       1.6516858      3932.1873    
      2500   318.61405     -41105.758     -10996.991      1.6516858      3932.1873    
      2600   285.32323     -41075.117     -4539.6563      1.6516858      3932.1873    
      2700   308.48592     -41122.022     -10495.51       1.6516858      3932.1873    
      2800   292.73728     -41123.621      652.8098       1.6516858      3932.1873    
      2900   282.59481     -41106.384     -13658.453      1.6516858      3932.1873    
      3000   289.65714     -41081.933     -515.39574      1.6516858      3932.1873    
Loop time of 129.456 on 8 procs for 3000 steps with 350 atoms

Performance: 1.001 ns/day, 23.973 hours/ns, 23.174 timesteps/s, 8.111 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 72.566     | 90.405     | 107.11     | 164.8 | 69.83
Bond    | 0.0072897  | 0.0078598  | 0.0084309  |   0.4 |  0.01
Neigh   | 6.7478     | 8.348      | 9.8971     |  49.6 |  6.45
Comm    | 1.6636     | 18.372     | 36.218     | 365.5 | 14.19
Output  | 0.0081772  | 0.0096226  | 0.010843   |   0.9 |  0.01
Modify  | 10.691     | 12.246     | 13.843     |  41.2 |  9.46
Other   |            | 0.0679     |            |       |  0.05

Nlocal:          43.75 ave          50 max          35 min
Histogram: 1 0 2 0 0 0 1 1 0 3
Nghost:        3119.62 ave        3182 max        3078 min
Histogram: 3 0 0 1 1 1 0 1 0 1
Neighs:        27180.1 ave       30904 max       22154 min
Histogram: 1 2 0 0 0 0 1 1 0 3

Total # of neighbors = 217441
Ave neighs/atom = 621.26
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 14.2194
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz--1.0144)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.2194
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.0408999999999997144, deltaxy = 0.070409
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.0143999999999999684, deltaxz = 0.010144
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.67500000000000004441, deltayz = -0.00675
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -0.142194 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.8 | 121 | 122.3 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   286.18816     -41071.636     -11391.858      1.6516858      3932.1873    
       100   300.61158     -41079.428     -8742.2745      1.6516858      3932.1873    
       200   300.84777     -41090.665     -17084.454      1.6516858      3932.1873    
       300   280.40448     -41089.809      7622.2374      1.6516858      3932.1873    
       400   295.49674     -41112.314     -20472.356      1.6516858      3932.1873    
       500   299.66881     -41090.483     -9262.1941      1.6516858      3932.1873    
       600   318.923       -41080.907      352.03952      1.6516858      3932.1873    
       700   304.81804     -41063.557     -6650.9786      1.6516858      3932.1873    
       800   300.66943     -41094.968     -14431.741      1.6516858      3932.1873    
       900   296.07228     -41122.33       4976.0093      1.6516858      3932.1873    
      1000   276.60902     -41108.794      461.34363      1.6516858      3932.1873    
      1100   315.42619     -41126.362     -12478.797      1.6516858      3932.1873    
      1200   314.03995     -41102.348     -1237.1521      1.6516858      3932.1873    
      1300   301.30904     -41090.884      5239.2326      1.6516858      3932.1873    
      1400   311.53765     -41116.224     -16099.157      1.6516858      3932.1873    
      1500   277.64594     -41101.695     -6700.8723      1.6516858      3932.1873    
      1600   270.6783      -41099.28      -1372.409       1.6516858      3932.1873    
      1700   287.22908     -41100.081     -4861.4475      1.6516858      3932.1873    
      1800   318.06711     -41110.33      -7965.5796      1.6516858      3932.1873    
      1900   313.24399     -41108.811     -8678.8193      1.6516858      3932.1873    
      2000   314.79516     -41129.904      18.23867       1.6516858      3932.1873    
      2100   288.38762     -41121.175     -2573.0807      1.6516858      3932.1873    
      2200   303.38068     -41137.433     -2420.1162      1.6516858      3932.1873    
      2300   288.22304     -41110.863     -9958.3475      1.6516858      3932.1873    
      2400   316.14111     -41117.991     -12858.168      1.6516858      3932.1873    
      2500   318.21852     -41108.727     -10043.307      1.6516858      3932.1873    
      2600   330.37657     -41128.514     -6072.9793      1.6516858      3932.1873    
      2700   311.37427     -41134.1       -9650.2331      1.6516858      3932.1873    
      2800   297.07897     -41134.262     -20118.388      1.6516858      3932.1873    
      2900   289.94836     -41127.808     -1432.7419      1.6516858      3932.1873    
      3000   303.34607     -41110.378     -7679.4485      1.6516858      3932.1873    
Loop time of 129.369 on 8 procs for 3000 steps with 350 atoms

Performance: 1.002 ns/day, 23.957 hours/ns, 23.190 timesteps/s, 8.116 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 72.761     | 90.319     | 107.09     | 164.5 | 69.82
Bond    | 0.0072969  | 0.0078991  | 0.0084775  |   0.4 |  0.01
Neigh   | 6.7724     | 8.3306     | 9.7914     |  48.9 |  6.44
Comm    | 1.7464     | 18.517     | 36.084     | 363.3 | 14.31
Output  | 0.0079875  | 0.0093924  | 0.010533   |   0.9 |  0.01
Modify  | 10.65      | 12.118     | 13.671     |  40.8 |  9.37
Other   |            | 0.0665     |            |       |  0.05

Nlocal:          43.75 ave          49 max          35 min
Histogram: 2 0 0 0 0 0 1 2 1 2
Nghost:        3123.25 ave        3156 max        3097 min
Histogram: 1 0 0 1 4 1 0 0 0 1
Neighs:        27204.4 ave       30235 max       22091 min
Histogram: 2 0 0 0 0 0 1 2 1 2

Total # of neighbors = 217635
Ave neighs/atom = 621.81429
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.2194
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 0.142194 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.8 | 121 | 122.4 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   286.18816     -41071.636     -11391.858      1.6516858      3932.1873    
       100   300.6195      -41079.414     -8755.2818      1.6516858      3932.1873    
       200   300.86588     -41090.742     -17255.784      1.6516858      3932.1873    
       300   283.97241     -41094.138      7402.8622      1.6516858      3932.1873    
       400   302.55869     -41122.22      -20552.651      1.6516858      3932.1873    
       500   308.44363     -41105.629     -16542.433      1.6516858      3932.1873    
       600   298.04128     -41069.295     -6840.598       1.6516858      3932.1873    
       700   308.52416     -41072.663     -4820.1607      1.6516858      3932.1873    
       800   306.77923     -41089.215     -2723.3681      1.6516858      3932.1873    
       900   291.04417     -41097.875     -4349.3255      1.6516858      3932.1873    
      1000   295.40852     -41106.692     -7972.8155      1.6516858      3932.1873    
      1100   306.91045     -41111.368     -12560.644      1.6516858      3932.1873    
      1200   312.60924     -41111.763      1195.778       1.6516858      3932.1873    
      1300   303.69529     -41113.423     -2142.5168      1.6516858      3932.1873    
      1400   298.56201     -41125.492     -9106.954       1.6516858      3932.1873    
      1500   294.08922     -41131.802     -14887.498      1.6516858      3932.1873    
      1600   283.68051     -41113.254     -14681.369      1.6516858      3932.1873    
      1700   305.46787     -41112.889     -10981.716      1.6516858      3932.1873    
      1800   315.55725     -41128.534     -7532.9975      1.6516858      3932.1873    
      1900   307.10425     -41144.008     -9406.4859      1.6516858      3932.1873    
      2000   294.71349     -41149.935     -4325.4058      1.6516858      3932.1873    
      2100   297.85212     -41151.035     -11970.785      1.6516858      3932.1873    
      2200   300.42295     -41141.229     -7340.1886      1.6516858      3932.1873    
      2300   310.03413     -41134.756     -18653.434      1.6516858      3932.1873    
      2400   308.32753     -41124.638     -5452.9642      1.6516858      3932.1873    
      2500   300.5203      -41127.454      1971.6292      1.6516858      3932.1873    
      2600   282.85034     -41130.626     -7615.6414      1.6516858      3932.1873    
      2700   292.3238      -41145.493      2281.8353      1.6516858      3932.1873    
      2800   283.01752     -41123.785     -11474.072      1.6516858      3932.1873    
      2900   291.02929     -41107.875     -6770.9509      1.6516858      3932.1873    
      3000   323.74323     -41135.17      -13143.217      1.6516858      3932.1873    
Loop time of 129.639 on 8 procs for 3000 steps with 350 atoms

Performance: 1.000 ns/day, 24.007 hours/ns, 23.141 timesteps/s, 8.099 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 73.1       | 91.15      | 107.3      | 158.8 | 70.31
Bond    | 0.0070626  | 0.0078224  | 0.0082993  |   0.5 |  0.01
Neigh   | 6.7583     | 8.3675     | 9.8208     |  47.1 |  6.45
Comm    | 1.7864     | 17.935     | 35.991     | 357.8 | 13.83
Output  | 0.0081442  | 0.009569   | 0.010829   |   0.9 |  0.01
Modify  | 10.644     | 12.1       | 13.708     |  39.4 |  9.33
Other   |            | 0.06869    |            |       |  0.05

Nlocal:          43.75 ave          48 max          40 min
Histogram: 1 2 0 1 0 0 2 0 1 1
Nghost:           3110 ave        3169 max        3065 min
Histogram: 1 1 1 0 2 1 1 0 0 1
Neighs:        27184.8 ave       29687 max       24961 min
Histogram: 1 2 0 1 0 1 1 0 1 1

Total # of neighbors = 217478
Ave neighs/atom = 621.36571
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.6383
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--7.0409)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.6383
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.0408999999999997144, deltaxy = 0.070409
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.0143999999999999684, deltaxz = 0.010144
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.67500000000000004441, deltayz = -0.00675
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -0.176383 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.8 | 121 | 122.3 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   286.18816     -41071.636     -11391.858      1.6516858      3932.1873    
       100   300.56691     -41079.362     -9207.8896      1.6516858      3932.1873    
       200   300.0599      -41090.126     -17620.053      1.6516858      3932.1873    
       300   281.96453     -41092.08       6406.7568      1.6516858      3932.1873    
       400   294.0103      -41112.539     -20558.381      1.6516858      3932.1873    
       500   311.89933     -41107.607     -12277.675      1.6516858      3932.1873    
       600   331.72902     -41102.184      6677.928       1.6516858      3932.1873    
       700   301.80789     -41065.333     -4188.6426      1.6516858      3932.1873    
       800   305.90921     -41094.205     -3934.903       1.6516858      3932.1873    
       900   284.21524     -41100.936     -11643.296      1.6516858      3932.1873    
      1000   292.63713     -41106.434     -6876.0134      1.6516858      3932.1873    
      1100   311.53011     -41106.303     -6857.108       1.6516858      3932.1873    
      1200   298.63798     -41081.623      5849.0239      1.6516858      3932.1873    
      1300   306.56754     -41096.367     -891.97433      1.6516858      3932.1873    
      1400   302.42293     -41110.515     -3084.9031      1.6516858      3932.1873    
      1500   298.26723     -41119.474     -573.25388      1.6516858      3932.1873    
      1600   309.01001     -41131.162     -1924.0142      1.6516858      3932.1873    
      1700   291.30615     -41101.754      9216.8743      1.6516858      3932.1873    
      1800   284.91398     -41086.514     -9008.5491      1.6516858      3932.1873    
      1900   333.38165     -41132.943     -5208.3293      1.6516858      3932.1873    
      2000   290.79791     -41109.996     -10199.78       1.6516858      3932.1873    
      2100   309.08599     -41134.222      3550.8056      1.6516858      3932.1873    
      2200   298.34299     -41122.361     -534.56038      1.6516858      3932.1873    
      2300   298.88519     -41114.237     -4691.4941      1.6516858      3932.1873    
      2400   299.00471     -41102.649     -2057.2726      1.6516858      3932.1873    
      2500   317.63601     -41105.353     -9908.1602      1.6516858      3932.1873    
      2600   325.5575      -41110.206      830.9666       1.6516858      3932.1873    
      2700   283.49063     -41088.469     -9001.651       1.6516858      3932.1873    
      2800   277.07061     -41096.539     -13493.251      1.6516858      3932.1873    
      2900   300.27845     -41123.454     -4783.9021      1.6516858      3932.1873    
      3000   283.71471     -41107.986      9109.7745      1.6516858      3932.1873    
Loop time of 128.849 on 8 procs for 3000 steps with 350 atoms

Performance: 1.006 ns/day, 23.861 hours/ns, 23.283 timesteps/s, 8.149 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 71.575     | 90.766     | 106.44     | 149.3 | 70.44
Bond    | 0.0069994  | 0.0076897  | 0.0082192  |   0.5 |  0.01
Neigh   | 6.8004     | 8.4944     | 10.022     |  44.6 |  6.59
Comm    | 1.5914     | 17.267     | 36.46      | 342.2 | 13.40
Output  | 0.0082039  | 0.0095904  | 0.010768   |   0.9 |  0.01
Modify  | 10.703     | 12.237     | 13.936     |  37.4 |  9.50
Other   |            | 0.06769    |            |       |  0.05

Nlocal:          43.75 ave          50 max          35 min
Histogram: 1 0 1 0 1 0 1 1 2 1
Nghost:        3125.38 ave        3194 max        3080 min
Histogram: 2 1 0 1 1 1 0 1 0 1
Neighs:        27199.6 ave       30836 max       22180 min
Histogram: 1 1 0 0 1 0 1 2 1 1

Total # of neighbors = 217597
Ave neighs/atom = 621.70571
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.6383
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 0.176383 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.8 | 121 | 122.4 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   286.18816     -41071.636     -11391.858      1.6516858      3932.1873    
       100   300.60199     -41079.442     -8921.8293      1.6516858      3932.1873    
       200   301.4268      -41091.145     -16643.223      1.6516858      3932.1873    
       300   281.53117     -41091.31       7428.3965      1.6516858      3932.1873    
       400   305.05195     -41123.012     -25000.264      1.6516858      3932.1873    
       500   313.56033     -41108.677     -7193.152       1.6516858      3932.1873    
       600   330.10918     -41097.65      -1436.8308      1.6516858      3932.1873    
       700   314.78509     -41079.53      -2289.0516      1.6516858      3932.1873    
       800   296.57266     -41081.788     -10943.785      1.6516858      3932.1873    
       900   297.95993     -41105.726     -6667.2115      1.6516858      3932.1873    
      1000   305.96533     -41123.327     -128.03523      1.6516858      3932.1873    
      1100   291.6734      -41108.894     -737.3279       1.6516858      3932.1873    
      1200   300.86035     -41107.543     -7911.6977      1.6516858      3932.1873    
      1300   308.27716     -41108.995     -15752.888      1.6516858      3932.1873    
      1400   289.02414     -41090.737     -9066.9113      1.6516858      3932.1873    
      1500   313.16211     -41124.433     -6706.0183      1.6516858      3932.1873    
      1600   302.2231      -41121.275     -15837.619      1.6516858      3932.1873    
      1700   302.2128      -41107.78      -2521.0068      1.6516858      3932.1873    
      1800   309.00019     -41096.875     -3378.5305      1.6516858      3932.1873    
      1900   304.7691      -41087.402     -10538.49       1.6516858      3932.1873    
      2000   301.86833     -41092.004      881.49697      1.6516858      3932.1873    
      2100   291.11446     -41093.496     -3880.7494      1.6516858      3932.1873    
      2200   285.54264     -41099.02      -10939.229      1.6516858      3932.1873    
      2300   285.16146     -41098.017      374.26555      1.6516858      3932.1873    
      2400   272.60069     -41081.467     -124.94326      1.6516858      3932.1873    
      2500   316.25931     -41117.983     -10387.212      1.6516858      3932.1873    
      2600   305.97917     -41100.654     -11452.455      1.6516858      3932.1873    
      2700   303.64292     -41100.182     -3816.4596      1.6516858      3932.1873    
      2800   309.29821     -41114.748     -6413.0689      1.6516858      3932.1873    
      2900   301.59012     -41125.037     -22541.756      1.6516858      3932.1873    
      3000   275.17397     -41111.352     -6587.1388      1.6516858      3932.1873    
Loop time of 123.989 on 8 procs for 3000 steps with 350 atoms

Performance: 1.045 ns/day, 22.961 hours/ns, 24.196 timesteps/s, 8.469 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 66.995     | 81.291     | 102.11     | 175.5 | 65.56
Bond    | 0.0067743  | 0.007192   | 0.0079986  |   0.5 |  0.01
Neigh   | 6.7139     | 7.9513     | 9.9015     |  50.0 |  6.41
Comm    | 1.4286     | 22.237     | 36.528     | 335.4 | 17.93
Output  | 0.0078416  | 0.0091801  | 0.010238   |   0.8 |  0.01
Modify  | 10.465     | 12.429     | 13.676     |  40.3 | 10.02
Other   |            | 0.06416    |            |       |  0.05

Nlocal:          43.75 ave          49 max          38 min
Histogram: 1 0 2 1 0 0 0 2 1 1
Nghost:        3092.62 ave        3135 max        3060 min
Histogram: 1 2 1 1 0 0 1 0 0 2
Neighs:        27241.4 ave       30286 max       24063 min
Histogram: 1 0 2 1 0 0 0 2 1 1

Total # of neighbors = 217931
Ave neighs/atom = 622.66
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:27:57
