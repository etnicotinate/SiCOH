LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 30*${nthermo}       # steps of equilibration run 10
variable nequil equal 30*100       
variable nrun equal 30*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 30*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-26-vasp
read_data       ${structure}.data
read_data       333U-50C-26-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.008 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 7.0103e-05 on 8 procs for 1 steps with 365 atoms

50.5% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.537e-06  | 2.4888e-06 | 3.772e-06  |   0.0 |  3.55
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 3.142e-06  | 6.1455e-06 | 7.891e-06  |   0.0 |  8.77
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 6.147e-05  |            |       | 87.68

Nlocal:         45.625 ave          54 max          36 min
Histogram: 1 1 0 1 2 0 0 0 0 3
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-26-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
run ${nequil}
run 3000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -6.56 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 112.1 | 112.9 | 113.7 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -38406.192      65843.638      1.4343051      4609.3376    
       100   1239.8042     -40400.919     -16184.425      1.4343051      4609.3376    
       200   949.78382     -41198.956      533.52401      1.4343051      4609.3376    
       300   604.0002      -41573.279      6882.4478      1.4343051      4609.3376    
       400   423.79727     -41803.342      5640.8422      1.4343051      4609.3376    
       500   344.34292     -41970.58       1673.3306      1.4343051      4609.3376    
       600   280.27049     -42048.615     -18313.475      1.4343051      4609.3376    
       700   266.31702     -42090.755     -10996.757      1.4343051      4609.3376    
       800   260.23505     -42080.09      -5942.2738      1.4343051      4609.3376    
       900   320.13798     -42089.979     -2806.5149      1.4343051      4609.3376    
      1000   315.83177     -42049.896     -13377.794      1.4343051      4609.3376    
      1100   327.21092     -42093.907     -8441.221       1.4343051      4609.3376    
      1200   288.18983     -42124.473     -7454.7223      1.4343051      4609.3376    
      1300   283.51922     -42166.998     -7036.9822      1.4343051      4609.3376    
      1400   275.17581     -42173.297     -7412.931       1.4343051      4609.3376    
      1500   289.91792     -42161.055     -8698.8837      1.4343051      4609.3376    
      1600   330.48191     -42160.348     -7131.9216      1.4343051      4609.3376    
      1700   318.41557     -42135.781     -10813.812      1.4343051      4609.3376    
      1800   300.04543     -42146.337     -4575.8071      1.4343051      4609.3376    
      1900   292.56824     -42176.782     -9687.8017      1.4343051      4609.3376    
      2000   275.11145     -42189.93      -4060.3449      1.4343051      4609.3376    
      2100   281.44804     -42195.965      2729.4604      1.4343051      4609.3376    
      2200   344.22804     -42262.661     -5220.4212      1.4343051      4609.3376    
      2300   301.61721     -42252.48       956.67416      1.4343051      4609.3376    
      2400   294.91018     -42271.975     -7458.1685      1.4343051      4609.3376    
      2500   289.93625     -42269.146     -14100.777      1.4343051      4609.3376    
      2600   303.05        -42262.253     -8426.8815      1.4343051      4609.3376    
      2700   287.21314     -42224.676     -7263.8834      1.4343051      4609.3376    
      2800   326.64143     -42256.523     -10107.139      1.4343051      4609.3376    
      2900   285.37349     -42235.063     -14489.637      1.4343051      4609.3376    
      3000   289.52988     -42262.091      1081.3661      1.4343051      4609.3376    
Loop time of 109.835 on 8 procs for 3000 steps with 365 atoms

Performance: 1.180 ns/day, 20.340 hours/ns, 27.314 timesteps/s, 9.970 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 62.682     | 73.481     | 89.911     | 139.1 | 66.90
Bond    | 0.0074306  | 0.0081586  | 0.0087062  |   0.5 |  0.01
Neigh   | 5.4289     | 6.3345     | 7.8387     |  43.0 |  5.77
Comm    | 1.7676     | 18.204     | 29.003     | 279.6 | 16.57
Output  | 0.0013331  | 0.0014296  | 0.0020487  |   0.6 |  0.00
Modify  | 10.239     | 11.748     | 12.663     |  31.7 | 10.70
Other   |            | 0.05793    |            |       |  0.05

Nlocal:         45.625 ave          54 max          37 min
Histogram: 1 1 1 0 1 1 1 0 0 2
Nghost:        2869.88 ave        2903 max        2840 min
Histogram: 2 0 0 1 1 1 2 0 0 1
Neighs:        25014.1 ave       29464 max       20395 min
Histogram: 1 0 2 0 1 1 1 0 0 2

Total # of neighbors = 200113
Ave neighs/atom = 548.25479
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333U-50C-26-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 17.6144
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 14.9838
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.4642

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.8795
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 2.088
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -6.9346

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 17.6144
variable dlen equal lx-${len0}
variable dlen equal lx-17.6144
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.6144
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.9345999999999996533, deltaxy = 0.069346
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 2.0880000000000000782, deltaxz = -0.02088
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.87949999999999994849, deltayz = -0.008795
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.176144 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.176144 xy delta 0.069346 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.176144 xy delta 0.069346 xz delta -0.02088 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.5 | 112.3 | 113.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.52988     -42262.091      1081.4199      1.4343051      4609.3376    
       100   301.21042     -42279.306     -10122.856      1.4347833      4607.8012    
       200   287.84983     -42253.016     -6745.3215      1.4352619      4606.2647    
       300   329.56148     -42280.855     -9923.8362      1.4357408      4604.7283    
       400   305.53154     -42254.725     -5212.0616      1.43622        4603.1918    
       500   302.40315     -42267.95      -8606.8597      1.4366996      4601.6554    
       600   283.4081      -42263.645     -7543.4286      1.4371794      4600.1189    
       700   297.57553     -42276.545     -2584.1313      1.4376596      4598.5825    
       800   306.87733     -42269.54      -7262.3848      1.4381401      4597.046     
       900   328.73268     -42280.435     -2257.6835      1.4386209      4595.5096    
      1000   297.19825     -42263.801     -9801.7125      1.4391021      4593.9731    
      1100   283.3008      -42272.371     -12814.761      1.4395836      4592.4367    
      1200   284.70005     -42273.051     -7670.7841      1.4400653      4590.9003    
      1300   314.6924      -42283.672     -2130.3         1.4405475      4589.3638    
      1400   301.28703     -42258.828     -8667.9565      1.4410299      4587.8274    
      1500   307.61915     -42273.116     -8855.0238      1.4415126      4586.2909    
      1600   295.09315     -42281.549     -5542.795       1.4419957      4584.7545    
      1700   281.65091     -42282.126      1238.0987      1.4424791      4583.218     
      1800   291.50101     -42282.341     -2469.8278      1.4429629      4581.6816    
      1900   315.54573     -42281.296     -6228.789       1.4434469      4580.1451    
      2000   317.72286     -42274.447     -11984.126      1.4439313      4578.6087    
      2100   312.97583     -42284.13      -15626.391      1.444416       4577.0722    
      2200   293.96965     -42287.733     -3134.1556      1.444901       4575.5358    
      2300   291.14578     -42296.81      -12255.961      1.4453864      4573.9993    
      2400   302.14389     -42307.114     -11019.172      1.4458721      4572.4629    
      2500   307.62704     -42292.648     -15225.474      1.4463581      4570.9265    
      2600   312.58665     -42278.814     -10216.471      1.4468444      4569.39      
      2700   300.00372     -42264.925      189.55109      1.4473311      4567.8536    
      2800   299.97966     -42285.027     -10166.022      1.447818       4566.3171    
      2900   293.15542     -42295.63      -10713.244      1.4483054      4564.7807    
      3000   285.60137     -42280.505     -11059.95       1.448793       4563.2442    
Loop time of 113.686 on 8 procs for 3000 steps with 365 atoms

Performance: 1.140 ns/day, 21.053 hours/ns, 26.388 timesteps/s, 9.632 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.318     | 76.876     | 93.219     | 143.2 | 67.62
Bond    | 0.0076758  | 0.0083069  | 0.0089436  |   0.4 |  0.01
Neigh   | 5.4719     | 6.5274     | 7.9178     |  42.0 |  5.74
Comm    | 1.5915     | 17.938     | 31.514     | 296.6 | 15.78
Output  | 0.0079868  | 0.0091924  | 0.010077   |   0.7 |  0.01
Modify  | 10.864     | 12.264     | 13.31      |  30.7 | 10.79
Other   |            | 0.06292    |            |       |  0.06

Nlocal:         45.625 ave          56 max          35 min
Histogram: 1 1 1 0 0 1 1 2 0 1
Nghost:        2884.88 ave        2925 max        2852 min
Histogram: 2 0 0 1 1 1 2 0 0 1
Neighs:        25259.8 ave       30576 max       19584 min
Histogram: 1 1 1 0 0 1 1 2 0 1

Total # of neighbors = 202078
Ave neighs/atom = 553.63836
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.6144
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.176144 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.176144 xy delta -0.069346 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.176144 xy delta -0.069346 xz delta 0.02088 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.5 | 112.3 | 113.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.52988     -42262.091      1081.4199      1.4343051      4609.3376    
       100   301.19826     -42279.334     -10110.36       1.4338271      4610.874     
       200   289.08434     -42253.856     -6459.265       1.4333495      4612.4105    
       300   324.18654     -42272.121     -9377.2529      1.4328722      4613.9469    
       400   302.14525     -42245.415     -5140.8912      1.4323952      4615.4834    
       500   298.51959     -42258.835     -7821.0493      1.4319185      4617.0198    
       600   289.75572     -42270.301     -20237.975      1.4314422      4618.5563    
       700   293.23279     -42270.752      1995.29        1.4309662      4620.0927    
       800   305.33418     -42254.676     -2103.7372      1.4304904      4621.6292    
       900   334.65354     -42270.478     -3488.5647      1.430015       4623.1656    
      1000   308.27324     -42263.92      -18661.982      1.4295399      4624.7021    
      1100   280.3428      -42274.026     -4392.681       1.4290652      4626.2385    
      1200   288.54501     -42289.205     -8222.7381      1.4285907      4627.775     
      1300   300.88943     -42279.64       2702.1796      1.4281166      4629.3114    
      1400   303.86233     -42253.622     -12206.011      1.4276427      4630.8478    
      1500   334.14007     -42261.069     -9986.0815      1.4271692      4632.3843    
      1600   307.67868     -42248.184     -17440.295      1.426696       4633.9207    
      1700   297.02891     -42264.612     -9314.8375      1.4262231      4635.4572    
      1800   285.87119     -42262.652     -11296.002      1.4257506      4636.9936    
      1900   301.86765     -42273.023     -1242.6996      1.4252783      4638.5301    
      2000   297.30295     -42256.976     -305.89454      1.4248064      4640.0665    
      2100   316.33362     -42271.127     -9891.2672      1.4243347      4641.603     
      2200   306.03646     -42260.962      3502.2583      1.4238634      4643.1394    
      2300   293.53631     -42252.856     -5074.7559      1.4233924      4644.6759    
      2400   283.13055     -42249.01      -5028.3002      1.4229217      4646.2123    
      2500   294.43266     -42256.067     -6105.6265      1.4224513      4647.7487    
      2600   318.03245     -42263.86      -8167.4283      1.4219812      4649.2852    
      2700   298.64887     -42239.459      3048.5171      1.4215115      4650.8216    
      2800   310.11953     -42256.157     -8967.0572      1.421042       4652.3581    
      2900   293.16469     -42254.162     -6945.9674      1.4205729      4653.8945    
      3000   286.54709     -42265.339     -12729.348      1.420104       4655.431     
Loop time of 116.954 on 8 procs for 3000 steps with 365 atoms

Performance: 1.108 ns/day, 21.658 hours/ns, 25.651 timesteps/s, 9.363 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.173     | 78.313     | 95.402     | 162.1 | 66.96
Bond    | 0.0074297  | 0.0081819  | 0.0088044  |   0.6 |  0.01
Neigh   | 5.4199     | 6.6692     | 8.1366     |  46.1 |  5.70
Comm    | 2.0588     | 19.147     | 34.263     | 327.9 | 16.37
Output  | 0.0098748  | 0.011211   | 0.012188   |   0.7 |  0.01
Modify  | 11.239     | 12.738     | 13.969     |  33.5 | 10.89
Other   |            | 0.0669     |            |       |  0.06

Nlocal:         45.625 ave          58 max          33 min
Histogram: 1 0 1 1 1 2 0 0 1 1
Nghost:        2852.38 ave        2871 max        2832 min
Histogram: 1 1 0 2 0 1 0 0 2 1
Neighs:        24735.5 ave       31272 max       18167 min
Histogram: 1 0 1 1 1 2 0 0 1 1

Total # of neighbors = 197884
Ave neighs/atom = 542.14795
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 14.9838
variable dlen equal ly-${len0}
variable dlen equal ly-14.9838
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.9838
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.9345999999999996533, deltaxy = 0.069346
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 2.0880000000000000782, deltaxz = -0.02088
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.87949999999999994849, deltayz = -0.008795
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.149838 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.149838 yz delta -0.008795 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.5 | 112.3 | 113.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.52988     -42262.091      1081.4199      1.4343051      4609.3376    
       100   301.22742     -42279.315     -10115.095      1.4347833      4607.8012    
       200   288.01461     -42252.906     -7206.9017      1.4352619      4606.2647    
       300   329.67805     -42279.864     -13125.363      1.4357408      4604.7283    
       400   301.31612     -42248.295     -8302.5222      1.43622        4603.1918    
       500   312.94661     -42279.038     -15679.584      1.4366996      4601.6554    
       600   290.29312     -42271.095     -20502.239      1.4371794      4600.1189    
       700   309.91193     -42293.314      5825.8897      1.4376596      4598.5825    
       800   289.89389     -42257.288     -3731.6324      1.4381401      4597.046     
       900   309.17979     -42259.04       400.67786      1.4386209      4595.5096    
      1000   321.25549     -42270.51      -11299.463      1.4391021      4593.9731    
      1100   296.97765     -42267.286     -242.32051      1.4395836      4592.4367    
      1200   289.3104      -42276.381      6288.5514      1.4400653      4590.9003    
      1300   304.62055     -42292.617     -2205.2114      1.4405475      4589.3638    
      1400   297.84454     -42276.206     -3787.8434      1.4410299      4587.8274    
      1500   317.8283      -42278.053     -8330.0509      1.4415126      4586.2909    
      1600   306.10498     -42254.84      -19437.983      1.4419957      4584.7545    
      1700   305.90346     -42263.737     -15322.625      1.4424791      4583.218     
      1800   309.73953     -42292.916     -2600.8979      1.4429629      4581.6816    
      1900   281.98283     -42287.287     -11723.364      1.4434469      4580.1451    
      2000   283.31936     -42293.532     -8966.4864      1.4439313      4578.6087    
      2100   313.01447     -42308.818     -7026.9994      1.444416       4577.0722    
      2200   293.29116     -42272.125     -14928.335      1.444901       4575.5358    
      2300   307.55295     -42297.521     -2106.4391      1.4453864      4573.9993    
      2400   296.81634     -42301.784     -9614.482       1.4458721      4572.4629    
      2500   286.64952     -42289.556     -22354.977      1.4463581      4570.9265    
      2600   314.60756     -42305.504     -21304.033      1.4468444      4569.39      
      2700   300.23653     -42277.534     -7912.4237      1.4473311      4567.8536    
      2800   292.60845     -42277.493     -927.02337      1.447818       4566.3171    
      2900   299.94112     -42311.685     -17557.231      1.4483054      4564.7807    
      3000   286.21555     -42310.283     -5613.6134      1.448793       4563.2442    
Loop time of 118.261 on 8 procs for 3000 steps with 365 atoms

Performance: 1.096 ns/day, 21.900 hours/ns, 25.368 timesteps/s, 9.259 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.602     | 79.39      | 97.642     | 164.6 | 67.13
Bond    | 0.0075105  | 0.0081701  | 0.0088511  |   0.6 |  0.01
Neigh   | 5.4834     | 6.7833     | 8.2768     |  47.7 |  5.74
Comm    | 0.80049    | 19.047     | 34.815     | 336.0 | 16.11
Output  | 0.009598   | 0.011091   | 0.012204   |   0.7 |  0.01
Modify  | 11.429     | 12.955     | 14.239     |  34.7 | 10.95
Other   |            | 0.06632    |            |       |  0.06

Nlocal:         45.625 ave          53 max          35 min
Histogram: 1 0 1 0 1 1 1 0 0 3
Nghost:        2889.88 ave        2939 max        2844 min
Histogram: 1 1 0 1 1 0 3 0 0 1
Neighs:        25239.5 ave       28980 max       19526 min
Histogram: 1 0 1 0 1 1 1 0 0 3

Total # of neighbors = 201916
Ave neighs/atom = 553.19452
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.9838
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.149838 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.149838 yz delta 0.008795 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.5 | 112.3 | 113.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.52988     -42262.091      1081.4199      1.4343051      4609.3376    
       100   301.18444     -42279.342     -10117.508      1.4338271      4610.874     
       200   288.12651     -42252.995     -6988.0872      1.4333495      4612.4105    
       300   326.95155     -42275.785     -8149.4254      1.4328722      4613.9469    
       400   300.08        -42243.861     -3699.7415      1.4323952      4615.4834    
       500   305.85805     -42264.652     -11900.385      1.4319185      4617.0198    
       600   296.84092     -42274.878     -7515.3697      1.4314422      4618.5563    
       700   277.71296     -42255.244     -9662.7301      1.4309662      4620.0927    
       800   291.85265     -42249.284     -5260.3895      1.4304904      4621.6292    
       900   328.69392     -42265.405     -10498.847      1.430015       4623.1656    
      1000   318.08407     -42263.512     -22019.754      1.4295399      4624.7021    
      1100   287.58904     -42259.165     -3330.6682      1.4290652      4626.2385    
      1200   272.0614      -42261.747      3250.6369      1.4285907      4627.775     
      1300   298.56524     -42288.153     -15791.018      1.4281166      4629.3114    
      1400   295.07861     -42263.04      -12112.892      1.4276427      4630.8478    
      1500   315.61985     -42269.299     -4161.6101      1.4271692      4632.3843    
      1600   293.39293     -42251.098     -14696.118      1.426696       4633.9207    
      1700   310.62947     -42278.716     -2320.7995      1.4262231      4635.4572    
      1800   294.25561     -42262.214     -1163.3644      1.4257506      4636.9936    
      1900   302.3148      -42258.945     -12016.086      1.4252783      4638.5301    
      2000   300.62988     -42248.011     -13598.699      1.4248064      4640.0665    
      2100   316.28518     -42259.679     -12199.687      1.4243347      4641.603     
      2200   297.2791      -42250.847     -9845.5697      1.4238634      4643.1394    
      2300   293.01356     -42263.65      -15375.804      1.4233924      4644.6759    
      2400   294.39062     -42268.646     -11886.614      1.4229217      4646.2123    
      2500   297.19585     -42265.711     -708.8326       1.4224513      4647.7487    
      2600   316.09199     -42278.942     -4755.2026      1.4219812      4649.2852    
      2700   293.29707     -42253.682     -11408.753      1.4215115      4650.8216    
      2800   291.17379     -42247.122     -4942.8848      1.421042       4652.3581    
      2900   297.83337     -42254.944     -7388.7045      1.4205729      4653.8945    
      3000   315.64267     -42278.201     -7492.4768      1.420104       4655.431     
Loop time of 116.466 on 8 procs for 3000 steps with 365 atoms

Performance: 1.113 ns/day, 21.568 hours/ns, 25.759 timesteps/s, 9.402 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 62.771     | 76.246     | 96.282     | 152.1 | 65.47
Bond    | 0.0073412  | 0.0082903  | 0.0089534  |   0.6 |  0.01
Neigh   | 5.4051     | 6.5335     | 8.1254     |  45.2 |  5.61
Comm    | 0.79862    | 20.832     | 34.278     | 290.9 | 17.89
Output  | 0.0090192  | 0.010185   | 0.011007   |   0.6 |  0.01
Modify  | 11.134     | 12.769     | 13.878     |  32.7 | 10.96
Other   |            | 0.06589    |            |       |  0.06

Nlocal:         45.625 ave          54 max          36 min
Histogram: 1 0 1 1 0 1 1 2 0 1
Nghost:        2845.38 ave        2896 max        2802 min
Histogram: 1 1 1 0 1 2 0 1 0 1
Neighs:        24770.4 ave       28970 max       19706 min
Histogram: 1 0 1 1 0 1 1 2 0 1

Total # of neighbors = 198163
Ave neighs/atom = 542.91233
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.4642
variable dlen equal lz-${len0}
variable dlen equal lz-17.4642
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.4642
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.9345999999999996533, deltaxy = 0.069346
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 2.0880000000000000782, deltaxz = -0.02088
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.87949999999999994849, deltayz = -0.008795
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -0.174642 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.5 | 112.3 | 113.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.52988     -42262.091      1081.4199      1.4343051      4609.3376    
       100   301.26115     -42279.326     -10119.062      1.4347833      4607.8012    
       200   287.82544     -42252.765     -6629.9383      1.4352619      4606.2647    
       300   325.49799     -42275.067     -9834.6098      1.4357408      4604.7283    
       400   299.94951     -42244.391      966.25564      1.43622        4603.1918    
       500   288.65189     -42249.28      -14454.412      1.4366996      4601.6554    
       600   294.5095      -42274.556     -15872.457      1.4371794      4600.1189    
       700   313.24659     -42296.421     -45.446626      1.4376596      4598.5825    
       800   310.35203     -42275.52      -5562.1264      1.4381401      4597.046     
       900   344.38727     -42294.038     -5454.2046      1.4386209      4595.5096    
      1000   327.10587     -42286.42      -3287.4588      1.4391021      4593.9731    
      1100   278.80195     -42262.007     -89.005879      1.4395836      4592.4367    
      1200   282.05193     -42271.828     -759.90522      1.4400653      4590.9003    
      1300   301.72929     -42277.079     -5806.4949      1.4405475      4589.3638    
      1400   290.70927     -42249.661     -11016.657      1.4410299      4587.8274    
      1500   319.07789     -42278.226     -10222.753      1.4415126      4586.2909    
      1600   311.26232     -42284.667     -3754.5957      1.4419957      4584.7545    
      1700   283.10639     -42274.398     -370.13912      1.4424791      4583.218     
      1800   288.99022     -42279.183     -3954.1197      1.4429629      4581.6816    
      1900   293.13028     -42263.404     -9598.0345      1.4434469      4580.1451    
      2000   320.68402     -42275.477      1149.2215      1.4439313      4578.6087    
      2100   307.863       -42276.128     -16084.453      1.444416       4577.0722    
      2200   307.03731     -42298.722     -2838.0808      1.444901       4575.5358    
      2300   295.35537     -42298.101     -5896.1666      1.4453864      4573.9993    
      2400   300.61051     -42303.267     -1208.318       1.4458721      4572.4629    
      2500   301.81549     -42294.707     -5747.5304      1.4463581      4570.9265    
      2600   307.56908     -42288.097     -8294.8134      1.4468444      4569.39      
      2700   323.73782     -42292.533     -7403.9351      1.4473311      4567.8536    
      2800   313.60577     -42291.541     -8961.0641      1.447818       4566.3171    
      2900   296.0635      -42300.317     -8826.6684      1.4483054      4564.7807    
      3000   293.63319     -42313.446     -10737.736      1.448793       4563.2442    
Loop time of 118.622 on 8 procs for 3000 steps with 365 atoms

Performance: 1.093 ns/day, 21.967 hours/ns, 25.290 timesteps/s, 9.231 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.814     | 76.43      | 97.969     | 157.4 | 64.43
Bond    | 0.0073241  | 0.0082779  | 0.0089424  |   0.7 |  0.01
Neigh   | 5.4312     | 6.4844     | 8.2586     |  50.1 |  5.47
Comm    | 0.79804    | 22.335     | 34.923     | 291.0 | 18.83
Output  | 0.0090676  | 0.010158   | 0.010932   |   0.6 |  0.01
Modify  | 11.474     | 13.29      | 14.383     |  35.4 | 11.20
Other   |            | 0.06391    |            |       |  0.05

Nlocal:         45.625 ave          55 max          32 min
Histogram: 1 0 1 0 1 0 1 2 1 1
Nghost:        2873.88 ave        2908 max        2847 min
Histogram: 2 0 1 0 2 1 1 0 0 1
Neighs:        25237.9 ave       29973 max       17870 min
Histogram: 1 0 1 0 1 0 1 1 2 1

Total # of neighbors = 201903
Ave neighs/atom = 553.1589
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.4642
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 0.174642 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.5 | 112.3 | 113.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.52988     -42262.091      1081.4199      1.4343051      4609.3376    
       100   301.14747     -42279.314     -10114.056      1.4338271      4610.874     
       200   289.18945     -42254.231     -6576.9984      1.4333495      4612.4105    
       300   326.06377     -42274.786     -9439.6267      1.4328722      4613.9469    
       400   299.79945     -42243.008     -5701.2101      1.4323952      4615.4834    
       500   307.84909     -42268.254     -8458.3439      1.4319185      4617.0198    
       600   287.37492     -42265.817     -2489.0329      1.4314422      4618.5563    
       700   297.34544     -42275.634     -5020.2011      1.4309662      4620.0927    
       800   299.06194     -42259.496      427.51511      1.4304904      4621.6292    
       900   342.51395     -42284.866     -4885.5837      1.430015       4623.1656    
      1000   305.53007     -42252.935     -6341.8172      1.4295399      4624.7021    
      1100   286.09479     -42262.194     -1287.0971      1.4290652      4626.2385    
      1200   297.13017     -42283.43      -4701.8875      1.4285907      4627.775     
      1300   291.39229     -42266.52      -12314.132      1.4281166      4629.3114    
      1400   289.54292     -42247.888     -3300.9758      1.4276427      4630.8478    
      1500   309.21808     -42253.764     -7214.8133      1.4271692      4632.3843    
      1600   299.70283     -42246.503     -1887.3029      1.426696       4633.9207    
      1700   275.85252     -42230.563     -8640.1799      1.4262231      4635.4572    
      1800   291.37386     -42262.313     -4953.1477      1.4257506      4636.9936    
      1900   271.30425     -42253.601     -14197.92       1.4252783      4638.5301    
      2000   286.37359     -42269.047     -13688.507      1.4248064      4640.0665    
      2100   294.3767      -42265.057     -10836.263      1.4243347      4641.603     
      2200   316.37691     -42274.175     -5699.6654      1.4238634      4643.1394    
      2300   292.54324     -42247.271     -2898.0963      1.4233924      4644.6759    
      2400   303.36182     -42274.36      -14560.096      1.4229217      4646.2123    
      2500   296.38367     -42283.634     -12428.178      1.4224513      4647.7487    
      2600   297.16842     -42282.419     -16061.627      1.4219812      4649.2852    
      2700   301.85823     -42269.548     -13694.903      1.4215115      4650.8216    
      2800   310.22119     -42261.557     -4224.1626      1.421042       4652.3581    
      2900   313.60171     -42269.546     -6232.126       1.4205729      4653.8945    
      3000   292.13009     -42263.708     -8837.5614      1.420104       4655.431     
Loop time of 117.036 on 8 procs for 3000 steps with 365 atoms

Performance: 1.107 ns/day, 21.673 hours/ns, 25.633 timesteps/s, 9.356 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 62.872     | 75.452     | 96.538     | 156.2 | 64.47
Bond    | 0.0071538  | 0.00811    | 0.008869   |   0.7 |  0.01
Neigh   | 5.4086     | 6.4265     | 8.1866     |  48.8 |  5.49
Comm    | 0.80383    | 21.888     | 34.437     | 289.8 | 18.70
Output  | 0.0089596  | 0.010039   | 0.010826   |   0.6 |  0.01
Modify  | 11.386     | 13.187     | 14.247     |  34.6 | 11.27
Other   |            | 0.06461    |            |       |  0.06

Nlocal:         45.625 ave          57 max          38 min
Histogram: 2 1 1 0 0 2 1 0 0 1
Nghost:        2856.88 ave        2890 max        2825 min
Histogram: 2 0 0 0 1 3 0 1 0 1
Neighs:        24783.5 ave       30341 max       20677 min
Histogram: 2 1 1 0 0 2 0 1 0 1

Total # of neighbors = 198268
Ave neighs/atom = 543.2
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 17.6144
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.8795)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.6144
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.9345999999999996533, deltaxy = 0.069346
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 2.0880000000000000782, deltaxz = -0.02088
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.87949999999999994849, deltayz = -0.008795
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -0.176144 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.5 | 112.3 | 113.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.52988     -42262.091      1081.4199      1.4343051      4609.3376    
       100   301.21889     -42279.332     -10113.712      1.4343051      4609.3376    
       200   288.39057     -42253.006     -6985.2749      1.4343051      4609.3376    
       300   326.33627     -42276.473     -6430.1119      1.4343051      4609.3376    
       400   299.13891     -42242.791     -9234.1488      1.4343051      4609.3376    
       500   299.27182     -42258.663     -7395.227       1.4343051      4609.3376    
       600   281.65082     -42259.028     -8319.9931      1.4343051      4609.3376    
       700   304.53358     -42284.69      -1385.7075      1.4343051      4609.3376    
       800   306.58933     -42272.441     -11904.988      1.4343051      4609.3376    
       900   329.25552     -42270.468     -1304.6975      1.4343051      4609.3376    
      1000   321.0734      -42257.106     -7347.356       1.4343051      4609.3376    
      1100   298.49617     -42260.159     -13081.674      1.4343051      4609.3376    
      1200   289.15835     -42276.268     -16215.061      1.4343051      4609.3376    
      1300   300.55336     -42292.258     -13992.836      1.4343051      4609.3376    
      1400   305.47325     -42290.58      -5486.7501      1.4343051      4609.3376    
      1500   313.41412     -42280.638     -9262.7851      1.4343051      4609.3376    
      1600   298.13124     -42259.68      -9620.6109      1.4343051      4609.3376    
      1700   293.44056     -42264.829     -7498.4824      1.4343051      4609.3376    
      1800   305.33372     -42284.526     -15475.25       1.4343051      4609.3376    
      1900   295.36482     -42276.707     -14047.017      1.4343051      4609.3376    
      2000   302.70456     -42278.455     -17539.159      1.4343051      4609.3376    
      2100   295.17526     -42263.65      -10777.351      1.4343051      4609.3376    
      2200   311.98152     -42280.539     -5771.8029      1.4343051      4609.3376    
      2300   292.25675     -42274.972     -12537.002      1.4343051      4609.3376    
      2400   282.03794     -42284.824     -5247.7984      1.4343051      4609.3376    
      2500   291.07438     -42293.094     -4949.0063      1.4343051      4609.3376    
      2600   285.22301     -42270.236     -2561.2856      1.4343051      4609.3376    
      2700   304.52087     -42270.405     -11215.959      1.4343051      4609.3376    
      2800   311.10337     -42298.679     -2051.1823      1.4343051      4609.3376    
      2900   296.77578     -42321.536     -5542.7495      1.4343051      4609.3376    
      3000   292.52321     -42336.665     -2878.8447      1.4343051      4609.3376    
Loop time of 117.234 on 8 procs for 3000 steps with 365 atoms

Performance: 1.105 ns/day, 21.710 hours/ns, 25.590 timesteps/s, 9.340 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.243     | 75.537     | 96.558     | 155.0 | 64.43
Bond    | 0.0071159  | 0.0080374  | 0.0086748  |   0.6 |  0.01
Neigh   | 5.3787     | 6.4275     | 8.2117     |  50.1 |  5.48
Comm    | 0.79845    | 21.815     | 34.078     | 288.2 | 18.61
Output  | 0.0089051  | 0.010007   | 0.010772   |   0.6 |  0.01
Modify  | 11.545     | 13.371     | 14.463     |  35.2 | 11.41
Other   |            | 0.06487    |            |       |  0.06

Nlocal:         45.625 ave          53 max          37 min
Histogram: 2 1 0 0 1 0 1 0 0 3
Nghost:        2853.88 ave        2894 max        2816 min
Histogram: 1 1 1 0 2 0 1 1 0 1
Neighs:        24996.4 ave       28706 max       20702 min
Histogram: 2 1 0 0 1 0 1 0 0 3

Total # of neighbors = 199971
Ave neighs/atom = 547.86575
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.6144
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 0.176144 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.5 | 112.3 | 113.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.52988     -42262.091      1081.4199      1.4343051      4609.3376    
       100   301.18943     -42279.308     -10119.29       1.4343051      4609.3376    
       200   289.05155     -42254.501     -6917.8508      1.4343051      4609.3376    
       300   327.9269      -42276.493     -11967.797      1.4343051      4609.3376    
       400   307.37523     -42252.636     -5967.7061      1.4343051      4609.3376    
       500   298.41271     -42262.478     -11379.742      1.4343051      4609.3376    
       600   285.60401     -42265.124     -13681.502      1.4343051      4609.3376    
       700   304.48265     -42282.412     -9158.9218      1.4343051      4609.3376    
       800   303.60746     -42258.716     -3430.6122      1.4343051      4609.3376    
       900   332.46596     -42264.563     -3767.2935      1.4343051      4609.3376    
      1000   313.06026     -42249.894     -15333.12       1.4343051      4609.3376    
      1100   290.74417     -42263.764     -8777.1534      1.4343051      4609.3376    
      1200   286.78201     -42279.593     -6892.4806      1.4343051      4609.3376    
      1300   279.62851     -42269.01      -5867.4335      1.4343051      4609.3376    
      1400   297.24915     -42259.039     -9300.1903      1.4343051      4609.3376    
      1500   298.53883     -42221.621     -14203.974      1.4343051      4609.3376    
      1600   316.62323     -42240.549     -5784.6402      1.4343051      4609.3376    
      1700   288.28656     -42241.695     -5174.8588      1.4343051      4609.3376    
      1800   306.71367     -42282.312     -1073.0788      1.4343051      4609.3376    
      1900   301.78942     -42288.696     -12164.885      1.4343051      4609.3376    
      2000   297.77174     -42286.664     -8072.8552      1.4343051      4609.3376    
      2100   290.73417     -42267.32       3040.6503      1.4343051      4609.3376    
      2200   332.6679      -42286.134     -5917.1122      1.4343051      4609.3376    
      2300   312.40359     -42256.508     -11704.081      1.4343051      4609.3376    
      2400   317.37187     -42280.172     -9672.7857      1.4343051      4609.3376    
      2500   303.49705     -42296.343     -2273.0348      1.4343051      4609.3376    
      2600   292.24557     -42288.347     -10326.265      1.4343051      4609.3376    
      2700   303.82698     -42281.546     -15547.841      1.4343051      4609.3376    
      2800   308.73984     -42263.442     -10622.736      1.4343051      4609.3376    
      2900   316.36089     -42262.405     -1634.8984      1.4343051      4609.3376    
      3000   327.3158      -42289.649     -6560.8723      1.4343051      4609.3376    
Loop time of 117.57 on 8 procs for 3000 steps with 365 atoms

Performance: 1.102 ns/day, 21.772 hours/ns, 25.517 timesteps/s, 9.314 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.394     | 76         | 96.973     | 154.9 | 64.64
Bond    | 0.0072696  | 0.0081454  | 0.0089368  |   0.7 |  0.01
Neigh   | 5.4336     | 6.4835     | 8.2754     |  50.0 |  5.51
Comm    | 0.79588    | 21.761     | 34.337     | 289.4 | 18.51
Output  | 0.0090841  | 0.010202   | 0.010973   |   0.6 |  0.01
Modify  | 11.409     | 13.242     | 14.335     |  35.5 | 11.26
Other   |            | 0.06641    |            |       |  0.06

Nlocal:         45.625 ave          57 max          35 min
Histogram: 1 1 1 0 1 0 2 1 0 1
Nghost:        2872.75 ave        2893 max        2859 min
Histogram: 3 0 2 0 0 0 0 0 2 1
Neighs:        24981.4 ave       30663 max       19380 min
Histogram: 1 0 2 0 1 0 2 1 0 1

Total # of neighbors = 199851
Ave neighs/atom = 547.53699
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 14.9838
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-2.088)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.9838
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.9345999999999996533, deltaxy = 0.069346
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 2.0880000000000000782, deltaxz = -0.02088
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.87949999999999994849, deltayz = -0.008795
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -0.149838 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.5 | 112.3 | 113.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.52988     -42262.091      1081.4199      1.4343051      4609.3376    
       100   301.22343     -42279.309     -10137.302      1.4343051      4609.3376    
       200   288.3697      -42253.049     -6668.7809      1.4343051      4609.3376    
       300   325.16233     -42274.409     -10201.765      1.4343051      4609.3376    
       400   301.47159     -42245.937     -9302.9881      1.4343051      4609.3376    
       500   293.04146     -42253.341     -12268.314      1.4343051      4609.3376    
       600   285.00325     -42264.133     -10832.215      1.4343051      4609.3376    
       700   297.0381      -42277.598      1845.7765      1.4343051      4609.3376    
       800   292.64142     -42253.774     -6038.8663      1.4343051      4609.3376    
       900   316.96211     -42261.552     -1420.3867      1.4343051      4609.3376    
      1000   312.66563     -42259.521     -994.39489      1.4343051      4609.3376    
      1100   286.63366     -42261.926     -733.0848       1.4343051      4609.3376    
      1200   283.77798     -42275.294     -13848.31       1.4343051      4609.3376    
      1300   283.43689     -42265.123     -12376.558      1.4343051      4609.3376    
      1400   284.67872     -42239.18      -16048.657      1.4343051      4609.3376    
      1500   329.16873     -42256.13      -5672.6357      1.4343051      4609.3376    
      1600   316.94601     -42248.528     -5754.6236      1.4343051      4609.3376    
      1700   282.99689     -42245.124     -6342.939       1.4343051      4609.3376    
      1800   298.6832      -42277.651     -11918.082      1.4343051      4609.3376    
      1900   305.2684      -42275.317      1523.732       1.4343051      4609.3376    
      2000   298.0992      -42249.002     -1545.4238      1.4343051      4609.3376    
      2100   304.08515     -42226.347     -6289.167       1.4343051      4609.3376    
      2200   328.41843     -42243.512     -4598.968       1.4343051      4609.3376    
      2300   296.37955     -42242.581     -1686.9252      1.4343051      4609.3376    
      2400   303.35776     -42290.99      -4320.2513      1.4343051      4609.3376    
      2500   307.83275     -42323.564     -9826.6343      1.4343051      4609.3376    
      2600   269.73242     -42285.449     -16226.595      1.4343051      4609.3376    
      2700   304.49758     -42295.11      -17259.584      1.4343051      4609.3376    
      2800   305.5845      -42269.116     -3307.9857      1.4343051      4609.3376    
      2900   315.62601     -42270.266     -4574.2153      1.4343051      4609.3376    
      3000   326.30654     -42301.957     -16323.907      1.4343051      4609.3376    
Loop time of 117.301 on 8 procs for 3000 steps with 365 atoms

Performance: 1.105 ns/day, 21.722 hours/ns, 25.575 timesteps/s, 9.335 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.44      | 75.759     | 96.673     | 154.5 | 64.58
Bond    | 0.0071657  | 0.0080555  | 0.0086605  |   0.6 |  0.01
Neigh   | 5.4024     | 6.4789     | 8.3122     |  50.9 |  5.52
Comm    | 0.78824    | 21.704     | 33.992     | 288.6 | 18.50
Output  | 0.0090031  | 0.010188   | 0.010952   |   0.6 |  0.01
Modify  | 11.399     | 13.278     | 14.398     |  36.0 | 11.32
Other   |            | 0.06371    |            |       |  0.05

Nlocal:         45.625 ave          56 max          34 min
Histogram: 1 0 2 0 0 1 1 1 1 1
Nghost:        2854.88 ave        2892 max        2826 min
Histogram: 2 1 0 1 0 1 1 0 1 1
Neighs:        24991.4 ave       30273 max       18776 min
Histogram: 1 0 1 1 0 1 1 1 1 1

Total # of neighbors = 199931
Ave neighs/atom = 547.75616
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.9838
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 0.149838 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.5 | 112.3 | 113.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.52988     -42262.091      1081.4199      1.4343051      4609.3376    
       100   301.18474     -42279.331     -10095.748      1.4343051      4609.3376    
       200   288.49089     -42253.664     -6482.7385      1.4343051      4609.3376    
       300   327.4961      -42276.834     -7963.7122      1.4343051      4609.3376    
       400   295.43001     -42238.706     -6021.8156      1.4343051      4609.3376    
       500   295.83706     -42254.384     -14386.137      1.4343051      4609.3376    
       600   278.51835     -42252.323     -17818.418      1.4343051      4609.3376    
       700   298.25152     -42273.888     -3264.537       1.4343051      4609.3376    
       800   312.03708     -42278.176     -6398.3549      1.4343051      4609.3376    
       900   313.95867     -42267.322     -5142.9449      1.4343051      4609.3376    
      1000   317.94262     -42270.612      3102.4793      1.4343051      4609.3376    
      1100   292.03451     -42262.954     -1308.6445      1.4343051      4609.3376    
      1200   294.6172      -42278.035     -4042.1268      1.4343051      4609.3376    
      1300   303.47203     -42289.08      -4037.8168      1.4343051      4609.3376    
      1400   297.49042     -42273.356      5909.3923      1.4343051      4609.3376    
      1500   302.84564     -42259.529     -3305.008       1.4343051      4609.3376    
      1600   312.71663     -42262.27      -20295.554      1.4343051      4609.3376    
      1700   301.3191      -42260.044     -3947.6491      1.4343051      4609.3376    
      1800   298.60411     -42271.936      1137.1974      1.4343051      4609.3376    
      1900   287.68144     -42273.029     -11322.55       1.4343051      4609.3376    
      2000   294.68928     -42288.288     -3565.0517      1.4343051      4609.3376    
      2100   311.59696     -42303.342     -6206.4495      1.4343051      4609.3376    
      2200   294.70148     -42272.38       3926.1726      1.4343051      4609.3376    
      2300   302.03862     -42274.644     -10874.585      1.4343051      4609.3376    
      2400   314.07407     -42288.81      -12062.342      1.4343051      4609.3376    
      2500   308.89592     -42302.829      2347.2089      1.4343051      4609.3376    
      2600   291.41304     -42308.87      -2913.9435      1.4343051      4609.3376    
      2700   287.8186      -42316.491     -7910.6455      1.4343051      4609.3376    
      2800   290.78585     -42305.359     -15575.459      1.4343051      4609.3376    
      2900   309.11118     -42299.425     -12179.656      1.4343051      4609.3376    
      3000   302.82262     -42271.175     -2509.3488      1.4343051      4609.3376    
Loop time of 117.445 on 8 procs for 3000 steps with 365 atoms

Performance: 1.103 ns/day, 21.749 hours/ns, 25.544 timesteps/s, 9.324 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 62.954     | 75.678     | 96.87      | 157.0 | 64.44
Bond    | 0.0072604  | 0.0080825  | 0.008646   |   0.5 |  0.01
Neigh   | 5.4034     | 6.4752     | 8.2478     |  50.5 |  5.51
Comm    | 0.80011    | 21.984     | 34.677     | 291.2 | 18.72
Output  | 0.008978   | 0.010088   | 0.010919   |   0.6 |  0.01
Modify  | 11.424     | 13.224     | 14.338     |  35.8 | 11.26
Other   |            | 0.06616    |            |       |  0.06

Nlocal:         45.625 ave          57 max          38 min
Histogram: 2 0 2 1 0 1 0 1 0 1
Nghost:        2853.38 ave        2916 max        2789 min
Histogram: 1 1 0 0 1 2 1 1 0 1
Neighs:        25001.2 ave       30687 max       20902 min
Histogram: 2 0 1 2 0 1 0 0 1 1

Total # of neighbors = 200010
Ave neighs/atom = 547.9726
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.4642
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--6.9346)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.4642
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.9345999999999996533, deltaxy = 0.069346
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 2.0880000000000000782, deltaxz = -0.02088
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.87949999999999994849, deltayz = -0.008795
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -0.174642 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.5 | 112.3 | 113.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.52988     -42262.091      1081.4199      1.4343051      4609.3376    
       100   301.2038      -42279.329     -10115.754      1.4343051      4609.3376    
       200   288.36154     -42253.446     -7092.8112      1.4343051      4609.3376    
       300   327.52419     -42276.97      -8794.6481      1.4343051      4609.3376    
       400   305.85812     -42250.143     -5300.9588      1.4343051      4609.3376    
       500   298.35689     -42257.673     -12706.005      1.4343051      4609.3376    
       600   288.60074     -42267.514     -20235.431      1.4343051      4609.3376    
       700   293.80474     -42272.598     -10132.556      1.4343051      4609.3376    
       800   284.25517     -42244.182     -4293.7943      1.4343051      4609.3376    
       900   325.12294     -42270.271     -1185.8533      1.4343051      4609.3376    
      1000   323.03741     -42276.482     -8462.4444      1.4343051      4609.3376    
      1100   283.55099     -42264.455     -161.87753      1.4343051      4609.3376    
      1200   285.39384     -42275.77      -1099.3365      1.4343051      4609.3376    
      1300   290.15443     -42266.826     -3500.2921      1.4343051      4609.3376    
      1400   296.36646     -42250.332     -8210.0867      1.4343051      4609.3376    
      1500   308.50424     -42257.732     -7853.2991      1.4343051      4609.3376    
      1600   303.23962     -42280.02      -14281.059      1.4343051      4609.3376    
      1700   287.13339     -42285.554     -1722.3856      1.4343051      4609.3376    
      1800   286.42858     -42280.847     -8932.9973      1.4343051      4609.3376    
      1900   295.07764     -42266.579     -13032.315      1.4343051      4609.3376    
      2000   324.97093     -42276.563     -9414.5972      1.4343051      4609.3376    
      2100   310.08342     -42261.632     -9299.0147      1.4343051      4609.3376    
      2200   303.34844     -42275.323     -5082.6795      1.4343051      4609.3376    
      2300   301.02642     -42294.675     -5048.6817      1.4343051      4609.3376    
      2400   304.589       -42303.332     -6750.3478      1.4343051      4609.3376    
      2500   289.95602     -42286.858     -13104.972      1.4343051      4609.3376    
      2600   299.89827     -42277.186     -9521.908       1.4343051      4609.3376    
      2700   316.91199     -42267.645     -1607.1068      1.4343051      4609.3376    
      2800   309.90194     -42260.457     -1045.1391      1.4343051      4609.3376    
      2900   308.86252     -42282.866     -9156.3532      1.4343051      4609.3376    
      3000   300.48434     -42298.192     -9537.9931      1.4343051      4609.3376    
Loop time of 117.845 on 8 procs for 3000 steps with 365 atoms

Performance: 1.100 ns/day, 21.823 hours/ns, 25.457 timesteps/s, 9.292 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.332     | 75.96      | 97.331     | 157.0 | 64.46
Bond    | 0.0073452  | 0.0081291  | 0.0086839  |   0.6 |  0.01
Neigh   | 5.4306     | 6.5006     | 8.2397     |  50.6 |  5.52
Comm    | 0.79751    | 22.163     | 34.763     | 290.6 | 18.81
Output  | 0.0089324  | 0.010015   | 0.010832   |   0.6 |  0.01
Modify  | 11.365     | 13.138     | 14.245     |  36.0 | 11.15
Other   |            | 0.06482    |            |       |  0.06

Nlocal:         45.625 ave          59 max          33 min
Histogram: 1 0 3 0 0 1 1 0 1 1
Nghost:        2865.88 ave        2907 max        2831 min
Histogram: 2 0 0 1 1 1 1 1 0 1
Neighs:        25005.5 ave       31870 max       18243 min
Histogram: 1 0 3 0 0 1 0 1 1 1

Total # of neighbors = 200044
Ave neighs/atom = 548.06575
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.4642
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 0.174642 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.5 | 112.3 | 113.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.52988     -42262.091      1081.4199      1.4343051      4609.3376    
       100   301.20743     -42279.313     -10118.532      1.4343051      4609.3376    
       200   288.67333     -42253.452     -6362.0253      1.4343051      4609.3376    
       300   328.03954     -42277.924     -10846.452      1.4343051      4609.3376    
       400   309.1037      -42258.55      -10361.046      1.4343051      4609.3376    
       500   299.94054     -42265.369     -18240.183      1.4343051      4609.3376    
       600   285.13922     -42265.945     -9034.12        1.4343051      4609.3376    
       700   289.98095     -42270.579      1055.4602      1.4343051      4609.3376    
       800   309.21036     -42271.843     -11287.114      1.4343051      4609.3376    
       900   312.75016     -42256.691      2733.8097      1.4343051      4609.3376    
      1000   302.54628     -42247.741     -8084.43        1.4343051      4609.3376    
      1100   307.32309     -42271.805     -15170.099      1.4343051      4609.3376    
      1200   286.491       -42265.173     -9503.0691      1.4343051      4609.3376    
      1300   301.51354     -42286.202     -19080.751      1.4343051      4609.3376    
      1400   301.65863     -42276.987     -6641.3917      1.4343051      4609.3376    
      1500   320.53941     -42273.641     -17858.493      1.4343051      4609.3376    
      1600   309.99248     -42253.33      -11630.468      1.4343051      4609.3376    
      1700   318.53517     -42275.565     -9479.2252      1.4343051      4609.3376    
      1800   298.6907      -42272.205     -3729.0941      1.4343051      4609.3376    
      1900   313.60097     -42298.009      3349.1931      1.4343051      4609.3376    
      2000   293.20474     -42280.498      1574.2541      1.4343051      4609.3376    
      2100   312.14716     -42296.487     -9899.5577      1.4343051      4609.3376    
      2200   285.78178     -42258.269     -10062.167      1.4343051      4609.3376    
      2300   295.06466     -42257.32      -4514.3116      1.4343051      4609.3376    
      2400   309.653       -42276.022     -19089.082      1.4343051      4609.3376    
      2500   288.53209     -42279.821     -15722.358      1.4343051      4609.3376    
      2600   284.6381      -42299.628      5189.218       1.4343051      4609.3376    
      2700   302.83774     -42318.434     -3184.908       1.4343051      4609.3376    
      2800   320.6402      -42330.969     -9058.143       1.4343051      4609.3376    
      2900   296.96266     -42307.42      -9523.4711      1.4343051      4609.3376    
      3000   285.9085      -42302.031     -8489.4384      1.4343051      4609.3376    
Loop time of 117.64 on 8 procs for 3000 steps with 365 atoms

Performance: 1.102 ns/day, 21.785 hours/ns, 25.502 timesteps/s, 9.308 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.431     | 75.946     | 97.185     | 157.4 | 64.56
Bond    | 0.0074506  | 0.0081533  | 0.0086264  |   0.5 |  0.01
Neigh   | 5.3981     | 6.4332     | 8.1921     |  49.8 |  5.47
Comm    | 0.79477    | 22.027     | 34.513     | 292.1 | 18.72
Output  | 0.0090215  | 0.010114   | 0.010872   |   0.5 |  0.01
Modify  | 11.358     | 13.148     | 14.221     |  35.3 | 11.18
Other   |            | 0.06666    |            |       |  0.06

Nlocal:         45.625 ave          53 max          32 min
Histogram: 1 0 0 1 0 1 0 1 2 2
Nghost:        2844.75 ave        2864 max        2827 min
Histogram: 1 1 0 2 0 2 0 0 1 1
Neighs:        25012.1 ave       28976 max       17778 min
Histogram: 1 0 0 1 0 1 1 1 1 2

Total # of neighbors = 200097
Ave neighs/atom = 548.21096
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:25:17
