LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 30*${nthermo}       # steps of equilibration run 10
variable nequil equal 30*100       
variable nrun equal 30*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 30*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-33-vasp
read_data       ${structure}.data
read_data       333U-50C-33-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.008 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 6.48914e-05 on 8 procs for 1 steps with 365 atoms

60.7% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.118e-06  | 1.8945e-06 | 2.584e-06  |   0.0 |  2.92
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 3.283e-06  | 5.0543e-06 | 6.145e-06  |   0.0 |  7.79
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 5.794e-05  |            |       | 89.29

Nlocal:         45.625 ave          49 max          40 min
Histogram: 1 0 0 1 0 1 1 2 1 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-33-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
run ${nequil}
run 3000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -6.56 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.1 | 128 | 129 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -40992.445      106056.12      1.701333       3885.8921    
       100   779.61004     -41878.529     -1835.6132      1.701333       3885.8921    
       200   512.05995     -42007.695     -17402.501      1.701333       3885.8921    
       300   440.39483     -42245.318      3715.5852      1.701333       3885.8921    
       400   351.16929     -42355.194      21620.337      1.701333       3885.8921    
       500   337.69321     -42485.755      3387.2511      1.701333       3885.8921    
       600   281.20968     -42519.714      5961.8077      1.701333       3885.8921    
       700   272.40544     -42550.335     -4575.9352      1.701333       3885.8921    
       800   288.99862     -42566.371      2380.586       1.701333       3885.8921    
       900   291.57461     -42545.945      6086.7826      1.701333       3885.8921    
      1000   306.68098     -42545.106     -1309.8994      1.701333       3885.8921    
      1100   302.82486     -42549.262     -6263.2873      1.701333       3885.8921    
      1200   309.62516     -42583.372     -5093.0823      1.701333       3885.8921    
      1300   278.84629     -42582.196      8126.8241      1.701333       3885.8921    
      1400   283.53317     -42605.101     -13737.51       1.701333       3885.8921    
      1500   291.60729     -42605.429     -3225.2717      1.701333       3885.8921    
      1600   296.11727     -42585.401     -8863.2354      1.701333       3885.8921    
      1700   308.91481     -42579.709      10.626555      1.701333       3885.8921    
      1800   303.46985     -42590.422     -19729.491      1.701333       3885.8921    
      1900   286.26555     -42595.927     -7114.2426      1.701333       3885.8921    
      2000   304.57175     -42625.539     -3974.4341      1.701333       3885.8921    
      2100   309.91497     -42640.898      2134.5477      1.701333       3885.8921    
      2200   305.04885     -42630.606      5671.6323      1.701333       3885.8921    
      2300   298.39659     -42607.685     -1882.8866      1.701333       3885.8921    
      2400   308.71089     -42611.093     -10937.345      1.701333       3885.8921    
      2500   300.86392     -42620.199      2877.0733      1.701333       3885.8921    
      2600   283.92792     -42626.766      1121.3067      1.701333       3885.8921    
      2700   279.30097     -42637.356      7133.5185      1.701333       3885.8921    
      2800   283.55194     -42634.981     -1567.5677      1.701333       3885.8921    
      2900   298.53067     -42624.093      1438.7845      1.701333       3885.8921    
      3000   293.90336     -42600.461      6191.8389      1.701333       3885.8921    
Loop time of 141.377 on 8 procs for 3000 steps with 365 atoms

Performance: 0.917 ns/day, 26.181 hours/ns, 21.220 timesteps/s, 7.745 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 81.311     | 99.337     | 118.29     | 173.6 | 70.26
Bond    | 0.0077399  | 0.0080104  | 0.0082174  |   0.2 |  0.01
Neigh   | 6.4421     | 7.9144     | 9.5317     |  49.1 |  5.60
Comm    | 1.9322     | 20.876     | 38.878     | 378.4 | 14.77
Output  | 0.0014284  | 0.0015303  | 0.0021976  |   0.6 |  0.00
Modify  | 11.511     | 13.17      | 14.658     |  38.6 |  9.32
Other   |            | 0.06928    |            |       |  0.05

Nlocal:         45.625 ave          49 max          40 min
Histogram: 1 0 1 0 0 1 1 1 2 1
Nghost:        3283.62 ave        3329 max        3236 min
Histogram: 1 0 2 0 1 1 1 0 0 2
Neighs:        29928.9 ave       31962 max       26546 min
Histogram: 1 1 0 0 0 1 1 1 2 1

Total # of neighbors = 239431
Ave neighs/atom = 655.97534
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333U-50C-33-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.3172
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.8463
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 18.3222

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal -0.1382
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 0.2463
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -7.7318

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 15.3172
variable dlen equal lx-${len0}
variable dlen equal lx-15.3172
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.3172
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.731799999999999784, deltaxy = 0.077318
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.24629999999999999116, deltaxz = -0.002463
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.13819999999999998952, deltayz = 0.001382
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.153172 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.153172 xy delta 0.077318 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.153172 xy delta 0.077318 xz delta -0.002463 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.6 | 128.2 | 129.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   293.90336     -42600.461      6191.8303      1.701333       3885.8921    
       100   311.6379      -42620.269      3927.3159      1.7019003      3884.5968    
       200   307.12411     -42638.61      -10349.312      1.7024679      3883.3015    
       300   302.72573     -42656.603     -10270.659      1.703036       3882.0062    
       400   285.06924     -42646.154     -5061.7783      1.7036044      3880.7109    
       500   306.46384     -42648.142      1332.3426      1.7041732      3879.4156    
       600   298.19503     -42622.106     -7709.1812      1.7047424      3878.1203    
       700   299.20672     -42614.155      3085.6989      1.705312       3876.825     
       800   300.03169     -42615.617      12684.185      1.705882       3875.5297    
       900   295.59331     -42612.905     -18807.897      1.7064523      3874.2344    
      1000   311.87536     -42648.982      7465.4358      1.707023       3872.9391    
      1100   301.60968     -42660.158     -2592.8254      1.7075941      3871.6438    
      1200   287.07897     -42657.966     -2793.891       1.7081656      3870.3486    
      1300   304.53835     -42668.847     -2035.6081      1.7087375      3869.0533    
      1400   287.67462     -42628.579      376.55864      1.7093097      3867.758     
      1500   306.4174      -42630.285     -166.51348      1.7098824      3866.4627    
      1600   300.34282     -42630.256     -7327.1485      1.7104554      3865.1674    
      1700   289.11462     -42639.616      1718.8653      1.7110288      3863.8721    
      1800   284.46973     -42654.312      11276.222      1.7116026      3862.5768    
      1900   294.46463     -42662.524     -2077.3584      1.7121767      3861.2815    
      2000   295.20372     -42629.054     -4993.0463      1.7127513      3859.9862    
      2100   302.95692     -42617.178     -2842.0259      1.7133262      3858.6909    
      2200   318.75016     -42638.781     -4234.1794      1.7139016      3857.3956    
      2300   298.69991     -42640.886     -6664.0794      1.7144773      3856.1003    
      2400   279.24853     -42636.96      -1075.6695      1.7150534      3854.805     
      2500   285.984       -42644.349      15775.078      1.7156299      3853.5097    
      2600   308.80126     -42629.193      4396.5513      1.7162067      3852.2144    
      2700   318.7867      -42639.628     -12635.571      1.716784       3850.9191    
      2800   298.52778     -42633.904      22289.975      1.7173617      3849.6238    
      2900   297.99343     -42654.513      1597.004       1.7179397      3848.3285    
      3000   297.41545     -42662.467      4498.2893      1.7185181      3847.0332    
Loop time of 143.034 on 8 procs for 3000 steps with 365 atoms

Performance: 0.906 ns/day, 26.488 hours/ns, 20.974 timesteps/s, 7.656 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 81.965     | 100.48     | 119.82     | 156.8 | 70.25
Bond    | 0.0077075  | 0.0081512  | 0.008641   |   0.3 |  0.01
Neigh   | 6.4691     | 7.8894     | 9.4796     |  44.0 |  5.52
Comm    | 1.7613     | 21.109     | 39.614     | 341.9 | 14.76
Output  | 0.0080667  | 0.0092271  | 0.010394   |   0.8 |  0.01
Modify  | 11.844     | 13.465     | 14.889     |  34.1 |  9.41
Other   |            | 0.07086    |            |       |  0.05

Nlocal:         45.625 ave          49 max          43 min
Histogram: 1 1 0 2 0 2 1 0 0 1
Nghost:        3303.62 ave        3369 max        3244 min
Histogram: 1 0 2 0 2 1 0 0 1 1
Neighs:        30233.6 ave       32513 max       28771 min
Histogram: 2 0 2 0 2 0 1 0 0 1

Total # of neighbors = 241869
Ave neighs/atom = 662.65479
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.3172
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.153172 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.153172 xy delta -0.077318 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.153172 xy delta -0.077318 xz delta 0.002463 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.6 | 128.2 | 129.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   293.90336     -42600.461      6191.8303      1.701333       3885.8921    
       100   311.63004     -42620.249      3928.7834      1.700766       3887.1874    
       200   306.04753     -42637.219     -10039.852      1.7001995      3888.4827    
       300   303.09208     -42655.074     -9957.0211      1.6996333      3889.778     
       400   286.52712     -42643.995      30.958302      1.6990675      3891.0733    
       500   329.10363     -42668.625      5530.189       1.6985021      3892.3686    
       600   292.16239     -42611.778     -2565.7661      1.6979371      3893.6639    
       700   310.90514     -42631.656     -2757.0762      1.6973724      3894.9592    
       800   295.25223     -42624.638      10743.497      1.6968081      3896.2545    
       900   306.62297     -42648.842      4475.3175      1.6962442      3897.5498    
      1000   303.28225     -42657.342      1251.9719      1.6956807      3898.8451    
      1100   276.74382     -42634.227     -7768.1746      1.6951175      3900.1404    
      1200   272.46787     -42618.184      2225.9589      1.6945547      3901.4357    
      1300   311.86996     -42639.594      2317.7647      1.6939923      3902.731     
      1400   313.57895     -42635.906      1377.493       1.6934303      3904.0263    
      1500   303.14153     -42637.692      137.30393      1.6928686      3905.3216    
      1600   282.44141     -42633.23      -3056.231       1.6923073      3906.6169    
      1700   269.90347     -42622.137     -1165.4085      1.6917464      3907.9122    
      1800   301.99164     -42643.52       1373.0311      1.6911858      3909.2075    
      1900   289.09429     -42595.803     -8360.1102      1.6906257      3910.5028    
      2000   301.06027     -42600.094      838.75925      1.6900659      3911.7981    
      2100   301.28476     -42622.311      286.00543      1.6895064      3913.0934    
      2200   289.35132     -42623.953     -365.68167      1.6889473      3914.3887    
      2300   301.53773     -42636.907     -3675.6754      1.6883886      3915.684     
      2400   316.51124     -42653.098     -2069.8374      1.6878303      3916.9793    
      2500   302.77434     -42652.919     -602.37754      1.6872724      3918.2746    
      2600   298.32337     -42660.359     -19602.638      1.6867148      3919.5699    
      2700   308.01149     -42663.173      3231.722       1.6861575      3920.8651    
      2800   298.42549     -42630.713     -2477.818       1.6856007      3922.1604    
      2900   304.93399     -42613.947     -2236.8611      1.6850442      3923.4557    
      3000   316.12737     -42619.573     -16994.971      1.6844881      3924.751     
Loop time of 139.815 on 8 procs for 3000 steps with 365 atoms

Performance: 0.927 ns/day, 25.892 hours/ns, 21.457 timesteps/s, 7.832 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 79.588     | 98.637     | 117.46     | 178.9 | 70.55
Bond    | 0.0076615  | 0.0081077  | 0.0087663  |   0.3 |  0.01
Neigh   | 6.3174     | 7.7489     | 9.2437     |  49.0 |  5.54
Comm    | 1.4894     | 20.312     | 39.357     | 394.1 | 14.53
Output  | 0.0086059  | 0.0099031  | 0.01116    |   0.9 |  0.01
Modify  | 11.525     | 13.031     | 14.474     |  38.1 |  9.32
Other   |            | 0.06829    |            |       |  0.05

Nlocal:         45.625 ave          48 max          40 min
Histogram: 1 0 1 0 0 0 0 1 3 2
Nghost:        3254.88 ave        3282 max        3224 min
Histogram: 2 1 1 0 0 0 0 0 1 3
Neighs:        29652.5 ave       31027 max       26085 min
Histogram: 1 0 0 1 0 0 0 1 3 2

Total # of neighbors = 237220
Ave neighs/atom = 649.91781
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.8463
variable dlen equal ly-${len0}
variable dlen equal ly-13.8463
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.8463
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.731799999999999784, deltaxy = 0.077318
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.24629999999999999116, deltaxz = -0.002463
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.13819999999999998952, deltayz = 0.001382
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.138463 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.138463 yz delta 0.001382 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.6 | 128.2 | 129.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   293.90336     -42600.461      6191.8303      1.701333       3885.8921    
       100   311.65156     -42620.249      3935.9201      1.7019003      3884.5968    
       200   306.65343     -42638.073     -8977.6162      1.7024679      3883.3015    
       300   301.75501     -42654.34      -10234.702      1.703036       3882.0062    
       400   296.54918     -42658.088     -1249.1915      1.7036044      3880.7109    
       500   305.71252     -42648.861      2407.8206      1.7041732      3879.4156    
       600   290.33615     -42614.485     -10067.286      1.7047424      3878.1203    
       700   312.21753     -42633.087     -1881.7279      1.705312       3876.825     
       800   302.59149     -42630.7        8555.3783      1.705882       3875.5297    
       900   302.66947     -42634.959     -3746.8913      1.7064523      3874.2344    
      1000   303.57131     -42636.399      4221.1235      1.707023       3872.9391    
      1100   311.25616     -42652.288      3418.383       1.7075941      3871.6438    
      1200   281.26833     -42636.946     -4802.002       1.7081656      3870.3486    
      1300   310.32968     -42664.701      2086.7748      1.7087375      3869.0533    
      1400   299.86464     -42640.192     -3822.9461      1.7093097      3867.758     
      1500   323.15934     -42648.688     -1789.6761      1.7098824      3866.4627    
      1600   315.4423      -42637.606      11009.532      1.7104554      3865.1674    
      1700   318.85304     -42654.017     -2698.6667      1.7110288      3863.8721    
      1800   284.41527     -42644.176     -4698.0998      1.7116026      3862.5768    
      1900   288.93966     -42656.216      8311.1851      1.7121767      3861.2815    
      2000   288.91084     -42633.741      5504.2303      1.7127513      3859.9862    
      2100   313.82319     -42630.053     -4082.5272      1.7133262      3858.6909    
      2200   319.4857      -42643.921      1396.9663      1.7139016      3857.3956    
      2300   297.05067     -42642.869      12493.582      1.7144773      3856.1003    
      2400   283.74825     -42636.072      3174.6313      1.7150534      3854.805     
      2500   294.77185     -42631.781     -1615.6728      1.7156299      3853.5097    
      2600   308.71439     -42611.317     -4485.3938      1.7162067      3852.2144    
      2700   316.10879     -42625.015      14881.784      1.716784       3850.9191    
      2800   307.09896     -42632.766     -1381.1609      1.7173617      3849.6238    
      2900   281.41368     -42618.732     -7480.0992      1.7179397      3848.3285    
      3000   305.12619     -42647.661     -11511.034      1.7185181      3847.0332    
Loop time of 142.591 on 8 procs for 3000 steps with 365 atoms

Performance: 0.909 ns/day, 26.406 hours/ns, 21.039 timesteps/s, 7.679 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 81.628     | 100.29     | 119.98     | 180.0 | 70.34
Bond    | 0.0078073  | 0.0081821  | 0.0084723  |   0.2 |  0.01
Neigh   | 6.4139     | 7.8739     | 9.3257     |  49.1 |  5.52
Comm    | 1.2789     | 20.959     | 39.626     | 393.5 | 14.70
Output  | 0.0082582  | 0.0096163  | 0.010917   |   0.9 |  0.01
Modify  | 11.906     | 13.377     | 14.858     |  38.0 |  9.38
Other   |            | 0.06798    |            |       |  0.05

Nlocal:         45.625 ave          49 max          40 min
Histogram: 2 0 0 0 1 0 0 0 4 1
Nghost:        3307.12 ave        3383 max        3232 min
Histogram: 1 0 0 3 0 0 2 1 0 1
Neighs:        30242.6 ave       32184 max       26527 min
Histogram: 2 0 0 0 1 0 0 0 0 5

Total # of neighbors = 241941
Ave neighs/atom = 662.85205
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.8463
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.138463 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.138463 yz delta -0.001382 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.6 | 128.2 | 129.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   293.90336     -42600.461      6191.8303      1.701333       3885.8921    
       100   311.60837     -42620.254      3918.2667      1.700766       3887.1874    
       200   305.6875      -42637.31      -11205.436      1.7001995      3888.4827    
       300   298.88168     -42650.523     -7851.6377      1.6996333      3889.778     
       400   286.14912     -42644.711      910.33162      1.6990675      3891.0733    
       500   312.50002     -42654.086      7.3261588      1.6985021      3892.3686    
       600   297.23594     -42619.257     -12702.92       1.6979371      3893.6639    
       700   299.14754     -42610.919      3428.8566      1.6973724      3894.9592    
       800   306.64555     -42620.865     -5029.625       1.6968081      3896.2545    
       900   305.17966     -42631.298     -4108.1318      1.6962442      3897.5498    
      1000   284.00098     -42628.232      5979.218       1.6956807      3898.8451    
      1100   290.7208      -42644.774      883.60946      1.6951175      3900.1404    
      1200   287.29303     -42637.153     -4159.9944      1.6945547      3901.4357    
      1300   306.50988     -42645.127      4571.3533      1.6939923      3902.731     
      1400   297.18601     -42624.164      2688.8226      1.6934303      3904.0263    
      1500   304.0954      -42619.608     -9435.4705      1.6928686      3905.3216    
      1600   324.72909     -42640.836     -3551.768       1.6923073      3906.6169    
      1700   294.99317     -42636.428     -6777.5356      1.6917464      3907.9122    
      1800   286.29795     -42645.148     -2038.6775      1.6911858      3909.2075    
      1900   286.27866     -42642.14       311.85826      1.6906257      3910.5028    
      2000   305.85916     -42639.309     -6843.4552      1.6900659      3911.7981    
      2100   319.15849     -42626.423     -16516.417      1.6895064      3913.0934    
      2200   295.39876     -42607.938     -7504.0528      1.6889473      3914.3887    
      2300   306.29657     -42637.592     -4399.8939      1.6883886      3915.684     
      2400   293.79333     -42640.468      3579.482       1.6878303      3916.9793    
      2500   290.53411     -42645.178     -11894.147      1.6872724      3918.2746    
      2600   309.00549     -42639.737     -13139.829      1.6867148      3919.5699    
      2700   320.19265     -42622.075     -7916.6885      1.6861575      3920.8651    
      2800   307.29924     -42607.105      4921.4343      1.6856007      3922.1604    
      2900   284.51623     -42615.018     -12525.336      1.6850442      3923.4557    
      3000   321.19209     -42670.28      -19298.268      1.6844881      3924.751     
Loop time of 138.409 on 8 procs for 3000 steps with 365 atoms

Performance: 0.936 ns/day, 25.631 hours/ns, 21.675 timesteps/s, 7.911 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 79.208     | 95.017     | 116.37     | 166.5 | 68.65
Bond    | 0.00765    | 0.0081493  | 0.0089168  |   0.4 |  0.01
Neigh   | 6.3331     | 7.4619     | 9.1905     |  46.2 |  5.39
Comm    | 1.3877     | 22.74      | 38.541     | 340.3 | 16.43
Output  | 0.008097   | 0.0094094  | 0.010647   |   0.9 |  0.01
Modify  | 11.368     | 13.105     | 14.238     |  35.1 |  9.47
Other   |            | 0.06777    |            |       |  0.05

Nlocal:         45.625 ave          52 max          39 min
Histogram: 1 0 0 2 1 1 1 1 0 1
Nghost:        3229.25 ave        3249 max        3210 min
Histogram: 2 0 1 0 1 0 1 1 1 1
Neighs:        29651.2 ave       33614 max       25714 min
Histogram: 1 0 0 2 1 2 0 1 0 1

Total # of neighbors = 237210
Ave neighs/atom = 649.89041
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 18.3222
variable dlen equal lz-${len0}
variable dlen equal lz-18.3222
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*18.3222
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.731799999999999784, deltaxy = 0.077318
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.24629999999999999116, deltaxz = -0.002463
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.13819999999999998952, deltayz = 0.001382
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -0.183222 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.6 | 128.2 | 129.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   293.90336     -42600.461      6191.8303      1.701333       3885.8921    
       100   311.64073     -42620.189      3928.1453      1.7019003      3884.5968    
       200   306.96811     -42638.232     -12814.03       1.7024679      3883.3015    
       300   301.43076     -42654.154     -9115.1656      1.703036       3882.0062    
       400   285.68121     -42644.511      862.20691      1.7036044      3880.7109    
       500   318.48081     -42658.709     -10099.168      1.7041732      3879.4156    
       600   310.09539     -42634.723     -13802.459      1.7047424      3878.1203    
       700   290.28487     -42618.269     -571.69393      1.705312       3876.825     
       800   301.73293     -42640.413      4280.0943      1.705882       3875.5297    
       900   296.30743     -42640.06       237.41168      1.7064523      3874.2344    
      1000   294.47264     -42641.42       13589.231      1.707023       3872.9391    
      1100   295.16584     -42638.916     -9999.8335      1.7075941      3871.6438    
      1200   295.81059     -42634.678      3438.2814      1.7081656      3870.3486    
      1300   301.82757     -42636.025     -1714.7732      1.7087375      3869.0533    
      1400   308.27467     -42645.125     -5685.0475      1.7093097      3867.758     
      1500   300.16988     -42654.074     -7441.3338      1.7098824      3866.4627    
      1600   295.85507     -42656.145     -6401.6262      1.7104554      3865.1674    
      1700   301.78883     -42651.587      2463.5154      1.7110288      3863.8721    
      1800   317.84158     -42644.509      5451.2729      1.7116026      3862.5768    
      1900   315.58834     -42625.68      -8942.562       1.7121767      3861.2815    
      2000   301.40319     -42632.016      1830.2372      1.7127513      3859.9862    
      2100   291.34374     -42656.269      4198.0241      1.7133262      3858.6909    
      2200   286.8517      -42649.452      4843.3594      1.7139016      3857.3956    
      2300   286.56603     -42629.235     -3022.5723      1.7144773      3856.1003    
      2400   302.34883     -42640.383      1320.7207      1.7150534      3854.805     
      2500   303.65728     -42661.393      4409.9979      1.7156299      3853.5097    
      2600   286.87974     -42670.452     -5849.039       1.7162067      3852.2144    
      2700   293.05142     -42671.799      2973.7039      1.716784       3850.9191    
      2800   311.60762     -42666.475      7786.545       1.7173617      3849.6238    
      2900   297.63288     -42649.572      1877.4821      1.7179397      3848.3285    
      3000   292.25846     -42642.936     -10963.566      1.7185181      3847.0332    
Loop time of 142.871 on 8 procs for 3000 steps with 365 atoms

Performance: 0.907 ns/day, 26.458 hours/ns, 20.998 timesteps/s, 7.664 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 81.024     | 98.153     | 120.04     | 169.6 | 68.70
Bond    | 0.0076606  | 0.008014   | 0.008221   |   0.2 |  0.01
Neigh   | 6.4733     | 7.6849     | 9.3288     |  45.2 |  5.38
Comm    | 1.4634     | 23.353     | 40.484     | 347.6 | 16.35
Output  | 0.0083754  | 0.0098863  | 0.011225   |   1.0 |  0.01
Modify  | 11.944     | 13.594     | 14.822     |  34.2 |  9.51
Other   |            | 0.06803    |            |       |  0.05

Nlocal:         45.625 ave          51 max          41 min
Histogram: 1 0 1 1 0 2 2 0 0 1
Nghost:        3299.88 ave        3345 max        3260 min
Histogram: 1 1 2 0 1 0 0 1 1 1
Neighs:        30258.1 ave       33511 max       27452 min
Histogram: 1 1 1 0 1 1 2 0 0 1

Total # of neighbors = 242065
Ave neighs/atom = 663.19178
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*18.3222
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 0.183222 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.6 | 128.2 | 129.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   293.90336     -42600.461      6191.8303      1.701333       3885.8921    
       100   311.64005     -42620.315      3944.6858      1.700766       3887.1874    
       200   306.49246     -42638.515     -9604.714       1.7001995      3888.4827    
       300   299.96091     -42651.835     -10960.028      1.6996333      3889.778     
       400   290.02386     -42649.34       2505.2542      1.6990675      3891.0733    
       500   314.28732     -42655.799      4006.285       1.6985021      3892.3686    
       600   298.87628     -42621.789     -12585.429      1.6979371      3893.6639    
       700   294.01746     -42610.161      14682.6        1.6973724      3894.9592    
       800   286.99721     -42607.41      -2960.7405      1.6968081      3896.2545    
       900   300.11562     -42628.297     -4765.0568      1.6962442      3897.5498    
      1000   296.93606     -42633.412     -3150.5779      1.6956807      3898.8451    
      1100   301.92421     -42645.926     -16002.447      1.6951175      3900.1404    
      1200   285.26668     -42632.13      -5941.677       1.6945547      3901.4357    
      1300   285.42241     -42620.991     -2597.2392      1.6939923      3902.731     
      1400   307.15486     -42624.968      3243.255       1.6934303      3904.0263    
      1500   303.98085     -42618.243      13300.754      1.6928686      3905.3216    
      1600   294.54891     -42626.218     -4205.1317      1.6923073      3906.6169    
      1700   293.48937     -42647.146     -12480.606      1.6917464      3907.9122    
      1800   268.52668     -42623.49      -7725.7851      1.6911858      3909.2075    
      1900   306.37151     -42639.757      8270.521       1.6906257      3910.5028    
      2000   322.48578     -42630.377     -8369.3834      1.6900659      3911.7981    
      2100   331.72561     -42643.98      -4528.2798      1.6895064      3913.0934    
      2200   325.68755     -42659.482     -9536.4442      1.6889473      3914.3887    
      2300   284.92518     -42630.845     -3893.8302      1.6883886      3915.684     
      2400   299.78153     -42637.836      2748.2715      1.6878303      3916.9793    
      2500   304.79206     -42627.716     -9739.7335      1.6872724      3918.2746    
      2600   316.11524     -42642.149     -11690.643      1.6867148      3919.5699    
      2700   299.66726     -42670.171     -14123.952      1.6861575      3920.8651    
      2800   263.48947     -42628.09       143.19827      1.6856007      3922.1604    
      2900   281.33633     -42617.572      1045.9571      1.6850442      3923.4557    
      3000   302.66487     -42621.711     -162.64169      1.6844881      3924.751     
Loop time of 140.691 on 8 procs for 3000 steps with 365 atoms

Performance: 0.921 ns/day, 26.054 hours/ns, 21.323 timesteps/s, 7.783 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 79.076     | 99.199     | 117.97     | 175.9 | 70.51
Bond    | 0.0076497  | 0.007947   | 0.008221   |   0.2 |  0.01
Neigh   | 6.4198     | 7.7927     | 9.2154     |  46.6 |  5.54
Comm    | 1.6131     | 20.374     | 40.492     | 387.9 | 14.48
Output  | 0.0083015  | 0.0096299  | 0.010883   |   0.9 |  0.01
Modify  | 11.814     | 13.24      | 14.617     |  36.1 |  9.41
Other   |            | 0.06769    |            |       |  0.05

Nlocal:         45.625 ave          50 max          42 min
Histogram: 1 0 2 1 0 2 0 1 0 1
Nghost:         3290.5 ave        3331 max        3258 min
Histogram: 2 0 1 1 1 0 0 1 1 1
Neighs:          29638 ave       32155 max       27591 min
Histogram: 1 0 2 1 1 1 0 1 0 1

Total # of neighbors = 237104
Ave neighs/atom = 649.6
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 15.3172
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz--0.1382)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.3172
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.731799999999999784, deltaxy = 0.077318
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.24629999999999999116, deltaxz = -0.002463
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.13819999999999998952, deltayz = 0.001382
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -0.153172 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.6 | 128.2 | 129.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   293.90336     -42600.461      6191.8303      1.701333       3885.8921    
       100   311.5887      -42620.16       3902.4426      1.701333       3885.8921    
       200   306.58635     -42638.654     -10418.637      1.701333       3885.8921    
       300   302.33863     -42655.283     -8141.5612      1.701333       3885.8921    
       400   284.24728     -42644.672     -7019.2761      1.701333       3885.8921    
       500   306.74631     -42650.466     -5195.4813      1.701333       3885.8921    
       600   298.89055     -42621.039     -10078.16       1.701333       3885.8921    
       700   310.29711     -42621.845      11943.594      1.701333       3885.8921    
       800   310.00822     -42621.193      885.95879      1.701333       3885.8921    
       900   290.48559     -42618.039     -9230.2832      1.701333       3885.8921    
      1000   280.03746     -42631.716      13197.986      1.701333       3885.8921    
      1100   303.12577     -42669.17      -8193.2464      1.701333       3885.8921    
      1200   295.61906     -42649.889      5328.5711      1.701333       3885.8921    
      1300   299.63989     -42634.243     -7658.1124      1.701333       3885.8921    
      1400   299.96199     -42616.444     -4874.366       1.701333       3885.8921    
      1500   319.49015     -42641.795      8943.6574      1.701333       3885.8921    
      1600   313.47588     -42663.467      7681.2947      1.701333       3885.8921    
      1700   284.13198     -42649.727     -3820.5627      1.701333       3885.8921    
      1800   293.82745     -42651.677      6629.0813      1.701333       3885.8921    
      1900   294.57852     -42630.332     -1410.6816      1.701333       3885.8921    
      2000   326.33857     -42635.876      14251.869      1.701333       3885.8921    
      2100   301.91931     -42617.376      14363.941      1.701333       3885.8921    
      2200   301.78585     -42627.348     -1156.8187      1.701333       3885.8921    
      2300   297.40917     -42629.363      4397.4688      1.701333       3885.8921    
      2400   297.19068     -42641.238      5141.23        1.701333       3885.8921    
      2500   288.40112     -42653.069      4736.7096      1.701333       3885.8921    
      2600   273.60659     -42670.442      1658.2368      1.701333       3885.8921    
      2700   282.89492     -42676.066     -4560.9541      1.701333       3885.8921    
      2800   320.29236     -42691.486      13800.57       1.701333       3885.8921    
      2900   290.63927     -42643.623     -7781.1336      1.701333       3885.8921    
      3000   316.56972     -42654.054      8039.9612      1.701333       3885.8921    
Loop time of 141.758 on 8 procs for 3000 steps with 365 atoms

Performance: 0.914 ns/day, 26.251 hours/ns, 21.163 timesteps/s, 7.724 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 79.757     | 100.08     | 119.08     | 177.9 | 70.60
Bond    | 0.0075949  | 0.0080602  | 0.0084565  |   0.3 |  0.01
Neigh   | 6.4671     | 7.8434     | 9.2635     |  46.6 |  5.53
Comm    | 1.4901     | 20.484     | 40.811     | 393.2 | 14.45
Output  | 0.0085151  | 0.0098356  | 0.011091   |   0.9 |  0.01
Modify  | 11.837     | 13.26      | 14.645     |  36.1 |  9.35
Other   |            | 0.0683     |            |       |  0.05

Nlocal:         45.625 ave          50 max          41 min
Histogram: 1 0 1 0 0 4 1 0 0 1
Nghost:        3266.62 ave        3300 max        3232 min
Histogram: 1 0 1 1 2 0 1 0 0 2
Neighs:        29910.9 ave       32375 max       27189 min
Histogram: 1 1 0 0 0 3 2 0 0 1

Total # of neighbors = 239287
Ave neighs/atom = 655.58082
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.3172
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 0.153172 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.6 | 128.2 | 129.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   293.90336     -42600.461      6191.8303      1.701333       3885.8921    
       100   311.65483     -42620.21       3931.8964      1.701333       3885.8921    
       200   305.87499     -42637.29      -10177.853      1.701333       3885.8921    
       300   300.31679     -42652.987     -8494.8009      1.701333       3885.8921    
       400   288.10649     -42648.221     -1191.7098      1.701333       3885.8921    
       500   304.30753     -42645.796      7238.8925      1.701333       3885.8921    
       600   292.09572     -42613.951     -2701.6115      1.701333       3885.8921    
       700   307.09512     -42619.305     -1731.6393      1.701333       3885.8921    
       800   308.94061     -42620.647      8132.97        1.701333       3885.8921    
       900   315.51047     -42639.553     -12706.104      1.701333       3885.8921    
      1000   295.4671      -42639.886     -9751.4112      1.701333       3885.8921    
      1100   284.10503     -42630.763     -10891.467      1.701333       3885.8921    
      1200   297.34901     -42639.11      -1691.893       1.701333       3885.8921    
      1300   299.75641     -42630.328      5930.9751      1.701333       3885.8921    
      1400   319.83219     -42651.937      10572.505      1.701333       3885.8921    
      1500   290.94619     -42629.781      13528.19       1.701333       3885.8921    
      1600   289.83318     -42644.69      -6322.9709      1.701333       3885.8921    
      1700   289.92609     -42644.252     -2066.361       1.701333       3885.8921    
      1800   299.07565     -42629.935      5370.6346      1.701333       3885.8921    
      1900   306.29876     -42614.541      3666.2714      1.701333       3885.8921    
      2000   297.58505     -42612.422     -7199.2648      1.701333       3885.8921    
      2100   310.8546      -42653.812      5862.4677      1.701333       3885.8921    
      2200   298.4156      -42645.678      1342.2757      1.701333       3885.8921    
      2300   282.29742     -42627.386      16416.582      1.701333       3885.8921    
      2400   303.36413     -42637.695      5778.3788      1.701333       3885.8921    
      2500   295.45253     -42611.42      -4569.386       1.701333       3885.8921    
      2600   284.64345     -42599.23      -2974.5571      1.701333       3885.8921    
      2700   278.99165     -42624.646     -9066.9567      1.701333       3885.8921    
      2800   291.17026     -42651.485      1908.4323      1.701333       3885.8921    
      2900   287.81417     -42644.149     -8468.424       1.701333       3885.8921    
      3000   326.54627     -42646.255      334.65859      1.701333       3885.8921    
Loop time of 139.574 on 8 procs for 3000 steps with 365 atoms

Performance: 0.929 ns/day, 25.847 hours/ns, 21.494 timesteps/s, 7.845 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 80.006     | 99.299     | 117.74     | 171.8 | 71.14
Bond    | 0.0078636  | 0.0081594  | 0.0085821  |   0.2 |  0.01
Neigh   | 6.3674     | 7.7434     | 9.2014     |  47.5 |  5.55
Comm    | 1.2778     | 19.698     | 38.988     | 385.6 | 14.11
Output  | 0.0084635  | 0.0098535  | 0.011105   |   0.9 |  0.01
Modify  | 11.279     | 12.745     | 14.13      |  37.4 |  9.13
Other   |            | 0.07005    |            |       |  0.05

Nlocal:         45.625 ave          50 max          40 min
Histogram: 1 0 0 1 1 1 1 0 1 2
Nghost:        3277.25 ave        3300 max        3243 min
Histogram: 1 0 0 1 0 1 2 1 1 1
Neighs:        29952.2 ave       32625 max       26517 min
Histogram: 1 0 1 1 0 1 1 0 1 2

Total # of neighbors = 239618
Ave neighs/atom = 656.48767
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.8463
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-0.2463)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.8463
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.731799999999999784, deltaxy = 0.077318
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.24629999999999999116, deltaxz = -0.002463
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.13819999999999998952, deltayz = 0.001382
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -0.138463 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.6 | 128.2 | 129.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   293.90336     -42600.461      6191.8303      1.701333       3885.8921    
       100   311.6451      -42620.199      3906.3725      1.701333       3885.8921    
       200   307.26527     -42639.192     -11313.162      1.701333       3885.8921    
       300   300.66927     -42653.081     -12265.611      1.701333       3885.8921    
       400   284.3791      -42642.519      519.16256      1.701333       3885.8921    
       500   316.09761     -42656.119     -6907.1202      1.701333       3885.8921    
       600   300.98078     -42625.312     -6592.2681      1.701333       3885.8921    
       700   298.61554     -42624.339      4579.8922      1.701333       3885.8921    
       800   309.78308     -42642.615      2578.9284      1.701333       3885.8921    
       900   280.54145     -42623.192     -12688.87       1.701333       3885.8921    
      1000   308.95137     -42656.628      4979.2195      1.701333       3885.8921    
      1100   297.46148     -42641.433      1055.3313      1.701333       3885.8921    
      1200   297.00922     -42635.415     -12854.099      1.701333       3885.8921    
      1300   299.84816     -42635.866     -4110.51        1.701333       3885.8921    
      1400   314.56856     -42652.853     -1174.3016      1.701333       3885.8921    
      1500   297.60481     -42636.818      4237.6652      1.701333       3885.8921    
      1600   294.50465     -42642.273     -3908.9636      1.701333       3885.8921    
      1700   290.2176      -42649.366     -2119.6316      1.701333       3885.8921    
      1800   285.77319     -42640.403      5944.1987      1.701333       3885.8921    
      1900   304.68311     -42632.147     -3826.7484      1.701333       3885.8921    
      2000   322.72989     -42632.753      5134.172       1.701333       3885.8921    
      2100   321.53146     -42644.631     -1364.3082      1.701333       3885.8921    
      2200   318.11489     -42656.151     -9206.4477      1.701333       3885.8921    
      2300   304.89683     -42649.881     -6320.4345      1.701333       3885.8921    
      2400   291.88382     -42634.471     -526.69899      1.701333       3885.8921    
      2500   295.62491     -42635.218     -247.82438      1.701333       3885.8921    
      2600   310.96983     -42639.364      13373.178      1.701333       3885.8921    
      2700   313.74715     -42622.178     -5783.6223      1.701333       3885.8921    
      2800   303.23178     -42631.324      14421.351      1.701333       3885.8921    
      2900   309.38069     -42664.06       137.21007      1.701333       3885.8921    
      3000   284.97839     -42644.058      5108.4423      1.701333       3885.8921    
Loop time of 141.882 on 8 procs for 3000 steps with 365 atoms

Performance: 0.913 ns/day, 26.274 hours/ns, 21.144 timesteps/s, 7.718 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 79.586     | 100.09     | 119.23     | 177.6 | 70.55
Bond    | 0.0075304  | 0.0079944  | 0.0084151  |   0.4 |  0.01
Neigh   | 6.453      | 7.8348     | 9.2493     |  46.7 |  5.52
Comm    | 1.4639     | 20.603     | 41.107     | 391.4 | 14.52
Output  | 0.0082085  | 0.0095612  | 0.010833   |   0.9 |  0.01
Modify  | 11.848     | 13.266     | 14.654     |  36.2 |  9.35
Other   |            | 0.06866    |            |       |  0.05

Nlocal:         45.625 ave          51 max          41 min
Histogram: 1 0 0 2 1 1 2 0 0 1
Nghost:        3283.12 ave        3328 max        3238 min
Histogram: 1 0 1 2 0 1 0 2 0 1
Neighs:          29923 ave       33158 max       27183 min
Histogram: 1 0 1 2 0 2 1 0 0 1

Total # of neighbors = 239384
Ave neighs/atom = 655.84658
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.8463
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 0.138463 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.6 | 128.2 | 129.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   293.90336     -42600.461      6191.8303      1.701333       3885.8921    
       100   311.72759     -42620.359      3969.317       1.701333       3885.8921    
       200   306.1435      -42637.76      -11549.549      1.701333       3885.8921    
       300   300.51639     -42653.081     -13396.822      1.701333       3885.8921    
       400   285.77113     -42644.469      9487.7595      1.701333       3885.8921    
       500   314.72633     -42653.535      4403.7822      1.701333       3885.8921    
       600   299.06927     -42619.573     -12551.147      1.701333       3885.8921    
       700   305.10893     -42626.176     -846.82566      1.701333       3885.8921    
       800   289.17797     -42624.31       7716.9905      1.701333       3885.8921    
       900   305.37151     -42647.153     -344.08265      1.701333       3885.8921    
      1000   313.65336     -42658.512     -5079.794       1.701333       3885.8921    
      1100   298.44924     -42647.08      -9022.8879      1.701333       3885.8921    
      1200   298.62639     -42650.374      3681.362       1.701333       3885.8921    
      1300   289.47632     -42634.639     -5558.223       1.701333       3885.8921    
      1400   300.28139     -42644.094      7386.1631      1.701333       3885.8921    
      1500   277.53075     -42626.204      13938.405      1.701333       3885.8921    
      1600   279.81603     -42633.005     -1212.0023      1.701333       3885.8921    
      1700   305.61636     -42650.549      3032.3344      1.701333       3885.8921    
      1800   317.73596     -42640.45      -1987.623       1.701333       3885.8921    
      1900   320.54018     -42637.83      -5295.7364      1.701333       3885.8921    
      2000   303.06637     -42637.702     -16382.226      1.701333       3885.8921    
      2100   273.02272     -42634.572     -403.63565      1.701333       3885.8921    
      2200   281.13441     -42647.973     -1500.4252      1.701333       3885.8921    
      2300   299.21514     -42643.302     -2253.3671      1.701333       3885.8921    
      2400   296.03588     -42618.238      1221.3726      1.701333       3885.8921    
      2500   301.93721     -42628.774      10899.861      1.701333       3885.8921    
      2600   310.19977     -42646.111      732.40675      1.701333       3885.8921    
      2700   292.38645     -42643.198     -3467.1212      1.701333       3885.8921    
      2800   282.47488     -42648.36      -10025.397      1.701333       3885.8921    
      2900   290.98542     -42673.671     -41.78389       1.701333       3885.8921    
      3000   299.74195     -42672.107      1508.8725      1.701333       3885.8921    
Loop time of 137.421 on 8 procs for 3000 steps with 365 atoms

Performance: 0.943 ns/day, 25.448 hours/ns, 21.831 timesteps/s, 7.968 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 79.245     | 94.864     | 115.77     | 143.4 | 69.03
Bond    | 0.0075479  | 0.0079483  | 0.0082321  |   0.2 |  0.01
Neigh   | 6.3696     | 7.4937     | 8.9772     |  38.7 |  5.45
Comm    | 1.368      | 22.261     | 37.876     | 295.9 | 16.20
Output  | 0.0084602  | 0.010279   | 0.011712   |   1.1 |  0.01
Modify  | 11.216     | 12.716     | 13.848     |  30.0 |  9.25
Other   |            | 0.06817    |            |       |  0.05

Nlocal:         45.625 ave          50 max          42 min
Histogram: 1 1 1 0 0 2 2 0 0 1
Nghost:        3276.12 ave        3301 max        3256 min
Histogram: 2 1 0 1 0 0 2 1 0 1
Neighs:        29968.4 ave       32715 max       27861 min
Histogram: 1 2 0 0 2 1 1 0 0 1

Total # of neighbors = 239747
Ave neighs/atom = 656.8411
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 18.3222
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--7.7318)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*18.3222
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.731799999999999784, deltaxy = 0.077318
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.24629999999999999116, deltaxz = -0.002463
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.13819999999999998952, deltayz = 0.001382
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -0.183222 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.6 | 128.2 | 129.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   293.90336     -42600.461      6191.8303      1.701333       3885.8921    
       100   311.62216     -42620.242      3936.2849      1.701333       3885.8921    
       200   305.74632     -42637.683     -9138.6335      1.701333       3885.8921    
       300   302.92342     -42655.706     -14517.89       1.701333       3885.8921    
       400   284.26148     -42644.228      5065.8661      1.701333       3885.8921    
       500   306.41092     -42646.565      5276.375       1.701333       3885.8921    
       600   299.94556     -42620.271     -2749.8216      1.701333       3885.8921    
       700   307.63435     -42622.871      2194.9498      1.701333       3885.8921    
       800   306.42039     -42630.562      4784.4794      1.701333       3885.8921    
       900   295.53776     -42629.746     -8732.0856      1.701333       3885.8921    
      1000   305.899       -42646.376      13652.662      1.701333       3885.8921    
      1100   300.48601     -42642.635     -8538.5059      1.701333       3885.8921    
      1200   293.83665     -42636.752     -10941.3        1.701333       3885.8921    
      1300   296.5772      -42629.171      1075.7247      1.701333       3885.8921    
      1400   308.91986     -42625.343     -8828.7244      1.701333       3885.8921    
      1500   308.29504     -42619.419     -1675.1793      1.701333       3885.8921    
      1600   293.29911     -42608.946      10851.446      1.701333       3885.8921    
      1700   305.818       -42643.897      5503.529       1.701333       3885.8921    
      1800   279.43545     -42637.738     -7645.9467      1.701333       3885.8921    
      1900   300.73405     -42658.66      -1755.0258      1.701333       3885.8921    
      2000   292.67561     -42632.354     -1494.5145      1.701333       3885.8921    
      2100   315.43161     -42622.435      7323.0172      1.701333       3885.8921    
      2200   321.7292      -42636.212     -3295.9971      1.701333       3885.8921    
      2300   314.39569     -42654.89      -6946.4332      1.701333       3885.8921    
      2400   295.22811     -42656.067     -1327.7572      1.701333       3885.8921    
      2500   304.04093     -42669.25      -454.71633      1.701333       3885.8921    
      2600   303.78073     -42645.939     -430.69474      1.701333       3885.8921    
      2700   304.31283     -42621.993     -10363.857      1.701333       3885.8921    
      2800   292.75162     -42618.386      1806.1714      1.701333       3885.8921    
      2900   271.4922      -42611.369      2696.9874      1.701333       3885.8921    
      3000   281.86742     -42627.519      4266.3808      1.701333       3885.8921    
Loop time of 131.023 on 8 procs for 3000 steps with 365 atoms

Performance: 0.989 ns/day, 24.264 hours/ns, 22.897 timesteps/s, 8.357 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 77.529     | 82.612     | 110.12     | 114.8 | 63.05
Bond    | 0.0071508  | 0.0075618  | 0.0082542  |   0.4 |  0.01
Neigh   | 6.4292     | 6.8252     | 8.94       |  30.7 |  5.21
Comm    | 0.90262    | 28.414     | 33.5       | 195.9 | 21.69
Output  | 0.0076024  | 0.0088207  | 0.0099654  |   0.9 |  0.01
Modify  | 10.976     | 13.09      | 13.491     |  22.2 |  9.99
Other   |            | 0.06424    |            |       |  0.05

Nlocal:         45.625 ave          51 max          39 min
Histogram: 1 0 0 1 1 2 1 0 0 2
Nghost:        3293.75 ave        3341 max        3255 min
Histogram: 1 0 1 2 1 1 0 1 0 1
Neighs:          29946 ave       33166 max       25883 min
Histogram: 1 0 0 1 1 1 2 0 0 2

Total # of neighbors = 239568
Ave neighs/atom = 656.35068
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*18.3222
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 0.183222 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.6 | 128.2 | 129.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   293.90336     -42600.461      6191.8303      1.701333       3885.8921    
       100   311.63765     -42620.262      3917.69        1.701333       3885.8921    
       200   306.614       -42637.526     -11079.991      1.701333       3885.8921    
       300   300.34013     -42652.634     -6984.7424      1.701333       3885.8921    
       400   284.58808     -42643.918     -1123.4946      1.701333       3885.8921    
       500   319.08282     -42659.055     -9020.6841      1.701333       3885.8921    
       600   302.95558     -42626.086     -13136.824      1.701333       3885.8921    
       700   298.39955     -42613.127      4401.7731      1.701333       3885.8921    
       800   295.66731     -42618.927      2684.5105      1.701333       3885.8921    
       900   297.18366     -42629.362     -9544.9356      1.701333       3885.8921    
      1000   303.09308     -42648.298      1277.5695      1.701333       3885.8921    
      1100   297.01191     -42648.517     -1203.2976      1.701333       3885.8921    
      1200   291.63625     -42638.708      216.03158      1.701333       3885.8921    
      1300   311.73638     -42639.263     -2206.246       1.701333       3885.8921    
      1400   307.067       -42625.244     -2074.2201      1.701333       3885.8921    
      1500   304.97404     -42628.913      1071.2014      1.701333       3885.8921    
      1600   307.05871     -42649.38       328.0388       1.701333       3885.8921    
      1700   293.90012     -42650.627      3608.0028      1.701333       3885.8921    
      1800   284.2714      -42641.717     -1440.1309      1.701333       3885.8921    
      1900   308.65202     -42655.385     -8271.1057      1.701333       3885.8921    
      2000   314.49861     -42634.93       13956.06       1.701333       3885.8921    
      2100   316.67837     -42638.021     -9305.8218      1.701333       3885.8921    
      2200   287.44809     -42637.367     -7124.6015      1.701333       3885.8921    
      2300   316.08218     -42678.684     -3497.265       1.701333       3885.8921    
      2400   294.81475     -42651.079     -5869.4554      1.701333       3885.8921    
      2500   302.83816     -42649.223      4306.8372      1.701333       3885.8921    
      2600   314.50813     -42655.68       1145.2756      1.701333       3885.8921    
      2700   293.13562     -42632.649     -1959.2434      1.701333       3885.8921    
      2800   282.04524     -42640.181     -13368.125      1.701333       3885.8921    
      2900   261.49063     -42635.975     -6662.4526      1.701333       3885.8921    
      3000   288.41733     -42643.188      3431.9948      1.701333       3885.8921    
Loop time of 94.4035 on 8 procs for 3000 steps with 365 atoms

Performance: 1.373 ns/day, 17.482 hours/ns, 31.778 timesteps/s, 11.599 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 76.144     | 77.284     | 77.912     |   6.7 | 81.87
Bond    | 0.0071656  | 0.0074556  | 0.0078514  |   0.2 |  0.01
Neigh   | 6.3118     | 6.4001     | 6.49       |   2.3 |  6.78
Comm    | 1.246      | 1.8735     | 3.0128     |  43.1 |  1.98
Output  | 0.0070201  | 0.00794    | 0.008829   |   0.7 |  0.01
Modify  | 8.6657     | 8.758      | 8.8474     |   2.0 |  9.28
Other   |            | 0.0728     |            |       |  0.08

Nlocal:         45.625 ave          48 max          39 min
Histogram: 1 0 0 0 0 1 0 2 2 2
Nghost:        3264.75 ave        3297 max        3231 min
Histogram: 1 3 0 0 0 0 0 0 2 2
Neighs:          29958 ave       31571 max       25944 min
Histogram: 1 0 0 0 0 1 0 2 2 2

Total # of neighbors = 239664
Ave neighs/atom = 656.6137
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:29:36
