LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.1                  # the deformation magnitude 0.01

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-33-vasp
read_data       ${structure}.data
read_data       333U-50C-33-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.008 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 5.69091e-05 on 8 procs for 1 steps with 365 atoms

53.8% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.6e-07    | 2.4763e-07 | 3.34e-07   |   0.0 |  0.44
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 9.21e-07   | 1.3854e-06 | 1.858e-06  |   0.0 |  2.43
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 5.528e-05  |            |       | 97.13

Nlocal:         45.625 ave          49 max          40 min
Histogram: 1 0 0 1 0 1 1 2 1 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-33-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 5000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -6.56 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.1 | 128 | 129 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -40992.445      106056.12      1.701333       3885.8921    
       100   779.61004     -41878.529     -1835.6132      1.701333       3885.8921    
       200   512.05995     -42007.695     -17402.501      1.701333       3885.8921    
       300   440.39483     -42245.318      3715.5852      1.701333       3885.8921    
       400   351.16929     -42355.194      21620.337      1.701333       3885.8921    
       500   337.69321     -42485.755      3387.2511      1.701333       3885.8921    
       600   281.20968     -42519.714      5961.8077      1.701333       3885.8921    
       700   272.40544     -42550.335     -4575.9352      1.701333       3885.8921    
       800   288.99862     -42566.371      2380.586       1.701333       3885.8921    
       900   291.57461     -42545.945      6086.7826      1.701333       3885.8921    
      1000   306.68098     -42545.106     -1309.8994      1.701333       3885.8921    
      1100   302.82486     -42549.262     -6263.2873      1.701333       3885.8921    
      1200   309.62516     -42583.372     -5093.0823      1.701333       3885.8921    
      1300   278.84629     -42582.196      8126.8241      1.701333       3885.8921    
      1400   283.53317     -42605.101     -13737.51       1.701333       3885.8921    
      1500   291.60729     -42605.429     -3225.2717      1.701333       3885.8921    
      1600   296.11727     -42585.401     -8863.2354      1.701333       3885.8921    
      1700   308.91481     -42579.709      10.626555      1.701333       3885.8921    
      1800   303.46985     -42590.422     -19729.491      1.701333       3885.8921    
      1900   286.26555     -42595.927     -7114.2426      1.701333       3885.8921    
      2000   304.57175     -42625.539     -3974.4341      1.701333       3885.8921    
      2100   309.91497     -42640.898      2134.5477      1.701333       3885.8921    
      2200   305.04885     -42630.606      5671.6323      1.701333       3885.8921    
      2300   298.39659     -42607.685     -1882.8866      1.701333       3885.8921    
      2400   308.71089     -42611.093     -10937.345      1.701333       3885.8921    
      2500   300.86392     -42620.199      2877.0733      1.701333       3885.8921    
      2600   283.92792     -42626.766      1121.3067      1.701333       3885.8921    
      2700   279.30097     -42637.356      7133.5185      1.701333       3885.8921    
      2800   283.55194     -42634.981     -1567.5677      1.701333       3885.8921    
      2900   298.53067     -42624.093      1438.7845      1.701333       3885.8921    
      3000   293.90336     -42600.461      6191.8389      1.701333       3885.8921    
      3100   311.63354     -42620.243      3932.0965      1.701333       3885.8921    
      3200   306.27442     -42638.107     -10256.616      1.701333       3885.8921    
      3300   301.03813     -42653.746     -9777.3067      1.701333       3885.8921    
      3400   288.74213     -42648.739      317.04411      1.701333       3885.8921    
      3500   308.74431     -42650.196      8510.64        1.701333       3885.8921    
      3600   295.77873     -42619.238     -8678.3875      1.701333       3885.8921    
      3700   300.60849     -42617.273      7750.1101      1.701333       3885.8921    
      3800   299.29898     -42617.725      4550.4178      1.701333       3885.8921    
      3900   292.4567      -42625.578     -4495.0627      1.701333       3885.8921    
      4000   294.46034     -42648.029      5053.6113      1.701333       3885.8921    
      4100   278.60895     -42641.459     -12339.349      1.701333       3885.8921    
      4200   296.32748     -42645.326     -5291.3566      1.701333       3885.8921    
      4300   309.66175     -42638.051      5942.2271      1.701333       3885.8921    
      4400   309.76992     -42625.632     -1408.7368      1.701333       3885.8921    
      4500   299.11159     -42616.945      29725.209      1.701333       3885.8921    
      4600   293.15965     -42634.034      4656.6347      1.701333       3885.8921    
      4700   297.13173     -42652.209      4017.5912      1.701333       3885.8921    
      4800   305.58592     -42660.381      503.0154       1.701333       3885.8921    
      4900   292.75007     -42622.201     -1229.9296      1.701333       3885.8921    
      5000   311.40067     -42617.116     -2863.6197      1.701333       3885.8921    
Loop time of 231.848 on 8 procs for 5000 steps with 365 atoms

Performance: 0.932 ns/day, 25.761 hours/ns, 21.566 timesteps/s, 7.872 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 134.3      | 158.57     | 195.13     | 213.2 | 68.39
Bond    | 0.0013055  | 0.0015472  | 0.0018663  |   0.5 |  0.00
Neigh   | 10.299     | 12.587     | 15.94      |  67.3 |  5.43
Comm    | 2.0433     | 38.598     | 62.849     | 432.2 | 16.65
Output  | 0.0024701  | 0.0026198  | 0.0035789  |   0.7 |  0.00
Modify  | 18.652     | 22.006     | 24.281     |  51.0 |  9.49
Other   |            | 0.08535    |            |       |  0.04

Nlocal:         45.625 ave          52 max          41 min
Histogram: 2 0 0 2 1 2 0 0 0 1
Nghost:        3294.62 ave        3329 max        3272 min
Histogram: 2 1 1 0 1 0 2 0 0 1
Neighs:        29940.6 ave       33755 max       27172 min
Histogram: 2 0 0 2 1 2 0 0 0 1

Total # of neighbors = 239525
Ave neighs/atom = 656.23288
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333U-50C-33-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.3172
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.8463
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 18.3222

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal -0.1382
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 0.2463
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -7.7318

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 15.3172
variable dlen equal lx-${len0}
variable dlen equal lx-15.3172
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*15.3172
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.731799999999999784, deltaxy = 0.77318
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.24629999999999999116, deltaxz = -0.02463
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.13819999999999998952, deltayz = 0.01382
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.53172 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.53172 xy delta 0.77318 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.53172 xy delta 0.77318 xz delta -0.02463 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.5 | 128.5 | 129.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.40067     -42617.116     -2863.6192      3885.8921      15.3172        13.8463        18.3222      
       100   314.45941     -42632.18      -1329.255       3878.1203      15.286566      13.8463        18.3222      
       200   290.73166     -42624.47       2768.8581      3870.3486      15.255931      13.8463        18.3222      
       300   303.61438     -42640.631      6464.4458      3862.5768      15.225297      13.8463        18.3222      
       400   307.92746     -42647.388     -4448.7674      3854.805       15.194662      13.8463        18.3222      
       500   292.47035     -42634.347      11336.74       3847.0332      15.164028      13.8463        18.3222      
       600   296.32371     -42658.557     -1404.5326      3839.2614      15.133394      13.8463        18.3222      
       700   270.6001      -42659.737     -1175.8171      3831.4896      15.102759      13.8463        18.3222      
       800   315.51814     -42693.208      2061.2688      3823.7178      15.072125      13.8463        18.3222      
       900   291.41461     -42654.814     -7561.3147      3815.9461      15.04149       13.8463        18.3222      
      1000   313.94478     -42660.32       3003.1169      3808.1743      15.010856      13.8463        18.3222      
      1100   295.53365     -42634.21       9770.5384      3800.4025      14.980222      13.8463        18.3222      
      1200   303.49287     -42636.902      6790.2173      3792.6307      14.949587      13.8463        18.3222      
      1300   320.96679     -42658.127     -288.55189      3784.8589      14.918953      13.8463        18.3222      
      1400   293.4325      -42638.246      10641.5        3777.0871      14.888318      13.8463        18.3222      
      1500   303.55363     -42660.184      15809.701      3769.3154      14.857684      13.8463        18.3222      
      1600   294.39643     -42641.991     -6488.1639      3761.5436      14.82705       13.8463        18.3222      
      1700   283.78962     -42659.526     -5320.4127      3753.7718      14.796415      13.8463        18.3222      
      1800   286.03148     -42670.237      1192.2967      3746           14.765781      13.8463        18.3222      
      1900   287.27145     -42647.064      2562.4992      3738.2282      14.735146      13.8463        18.3222      
      2000   305.37388     -42639.691      7438.4386      3730.4564      14.704512      13.8463        18.3222      
      2100   313.63079     -42635.688      8957.3991      3722.6847      14.673878      13.8463        18.3222      
      2200   322.32837     -42653.3        23720.567      3714.9129      14.643243      13.8463        18.3222      
      2300   320.39017     -42652.48       5712.5417      3707.1411      14.612609      13.8463        18.3222      
      2400   302.49788     -42651.653      8244.4522      3699.3693      14.581974      13.8463        18.3222      
      2500   312.05237     -42668.873      7199.5606      3691.5975      14.55134       13.8463        18.3222      
      2600   293.45953     -42658.8        13077.267      3683.8257      14.520706      13.8463        18.3222      
      2700   276.94285     -42640.689     -6902.134       3676.0539      14.490071      13.8463        18.3222      
      2800   281.02333     -42649.344     -5930.6572      3668.2822      14.459437      13.8463        18.3222      
      2900   291.8741      -42673.122      11608.202      3660.5104      14.428802      13.8463        18.3222      
      3000   305.97088     -42676.514      26588.76       3652.7386      14.398168      13.8463        18.3222      
      3100   310.22922     -42640.08       9647.9362      3644.9668      14.367534      13.8463        18.3222      
      3200   311.38882     -42624.456      30812.816      3637.195       14.336899      13.8463        18.3222      
      3300   310.52637     -42627.248      11419.71       3629.4232      14.306265      13.8463        18.3222      
      3400   299.30433     -42626.986      7702.0895      3621.6515      14.27563       13.8463        18.3222      
      3500   301.95153     -42640.45       36446.292      3613.8797      14.244996      13.8463        18.3222      
      3600   304.51554     -42651.799      11350.033      3606.1079      14.214362      13.8463        18.3222      
      3700   292.27007     -42640.104      17527.507      3598.3361      14.183727      13.8463        18.3222      
      3800   303.71502     -42639.748      19321.725      3590.5643      14.153093      13.8463        18.3222      
      3900   322.73154     -42616.474      26867.053      3582.7925      14.122458      13.8463        18.3222      
      4000   320.74863     -42617.155      10869.076      3575.0208      14.091824      13.8463        18.3222      
      4100   310.12417     -42626.37       33343.752      3567.249       14.06119       13.8463        18.3222      
      4200   302.67601     -42611.597      11790.009      3559.4772      14.030555      13.8463        18.3222      
      4300   301.11465     -42626.715      5411.7498      3551.7054      13.999921      13.8463        18.3222      
      4400   286.62483     -42609.599      29745.72       3543.9336      13.969286      13.8463        18.3222      
      4500   280.78682     -42604.246      23333.998      3536.1618      13.938652      13.8463        18.3222      
      4600   284.99907     -42633.483      21105.48       3528.39        13.908018      13.8463        18.3222      
      4700   294.15905     -42636.345      29161.594      3520.6183      13.877383      13.8463        18.3222      
      4800   291.45156     -42612.102      27658.456      3512.8465      13.846749      13.8463        18.3222      
      4900   299.39618     -42582.137      37426.031      3505.0747      13.816114      13.8463        18.3222      
      5000   312.70129     -42544.223      37896.193      3497.3029      13.78548       13.8463        18.3222      
Loop time of 261.525 on 8 procs for 5000 steps with 365 atoms

Performance: 0.826 ns/day, 29.058 hours/ns, 19.119 timesteps/s, 6.978 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 157.55     | 185.36     | 219.89     | 179.9 | 70.88
Bond    | 0.0014234  | 0.001661   | 0.0019193  |   0.4 |  0.00
Neigh   | 11.258     | 13.962     | 17.058     |  54.5 |  5.34
Comm    | 3.4437     | 37.961     | 65.775     | 397.6 | 14.52
Output  | 0.014848   | 0.016786   | 0.018372   |   1.0 |  0.01
Modify  | 21.036     | 24.129     | 26.833     |  41.5 |  9.23
Other   |            | 0.09865    |            |       |  0.04

Nlocal:         45.625 ave          54 max          40 min
Histogram: 2 0 2 0 0 3 0 0 0 1
Nghost:        3516.88 ave        3560 max        3486 min
Histogram: 2 2 0 0 0 1 0 2 0 1
Neighs:        33301.1 ave       39048 max       29370 min
Histogram: 2 0 2 0 0 3 0 0 0 1

Total # of neighbors = 266409
Ave neighs/atom = 729.88767
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*15.3172
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.53172 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.53172 xy delta -0.77318 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.53172 xy delta -0.77318 xz delta 0.02463 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.5 | 128.5 | 129.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.40067     -42617.116     -2863.6192      3885.8921      15.3172        13.8463        18.3222      
       100   314.19131     -42631.907     -1299.4485      3893.6639      15.347834      13.8463        18.3222      
       200   289.45379     -42624.647      2087.0327      3901.4357      15.378469      13.8463        18.3222      
       300   310.70068     -42649.97       14364.354      3909.2075      15.409103      13.8463        18.3222      
       400   313.80247     -42648.322     -9167.6097      3916.9793      15.439738      13.8463        18.3222      
       500   299.90289     -42628.176     -3390.661       3924.751       15.470372      13.8463        18.3222      
       600   292.83365     -42622.876     -4237.5415      3932.5228      15.501006      13.8463        18.3222      
       700   281.59126     -42637.081     -1872.7282      3940.2946      15.531641      13.8463        18.3222      
       800   300.35172     -42662.135     -7788.9662      3948.0664      15.562275      13.8463        18.3222      
       900   295.58369     -42632.865     -2160.0861      3955.8382      15.59291       13.8463        18.3222      
      1000   310.91851     -42614.998     -4126.0846      3963.61        15.623544      13.8463        18.3222      
      1100   295.49666     -42591.305     -2750.2529      3971.3817      15.654178      13.8463        18.3222      
      1200   308.02748     -42611.041      3038.4002      3979.1535      15.684813      13.8463        18.3222      
      1300   306.70804     -42629.705      4428.1737      3986.9253      15.715447      13.8463        18.3222      
      1400   288.56667     -42622.416     -9394.2263      3994.6971      15.746082      13.8463        18.3222      
      1500   298.82763     -42621.905      1181.9213      4002.4689      15.776716      13.8463        18.3222      
      1600   327.89704     -42623.117      1155.6186      4010.2407      15.80735       13.8463        18.3222      
      1700   318.50221     -42600.615     -14272.838      4018.0125      15.837985      13.8463        18.3222      
      1800   308.85345     -42619.012     -2599.54        4025.7842      15.868619      13.8463        18.3222      
      1900   292.31295     -42616.61      -12698.563      4033.556       15.899254      13.8463        18.3222      
      2000   290.75058     -42606.322     -23123.407      4041.3278      15.929888      13.8463        18.3222      
      2100   303.07341     -42609.153     -18827.616      4049.0996      15.960522      13.8463        18.3222      
      2200   304.29009     -42616.02      -11202.403      4056.8714      15.991157      13.8463        18.3222      
      2300   282.56805     -42607.764     -13072.863      4064.6432      16.021791      13.8463        18.3222      
      2400   289.16683     -42614.201     -17358.346      4072.4149      16.052426      13.8463        18.3222      
      2500   308.70938     -42599.359     -12787.359      4080.1867      16.08306       13.8463        18.3222      
      2600   323.56527     -42575.734     -14284.957      4087.9585      16.113694      13.8463        18.3222      
      2700   303.85195     -42559.959     -25508.332      4095.7303      16.144329      13.8463        18.3222      
      2800   322.15252     -42592.065     -12716.231      4103.5021      16.174963      13.8463        18.3222      
      2900   310.43066     -42591.553     -5125.4906      4111.2739      16.205598      13.8463        18.3222      
      3000   296.24243     -42578.043     -21065.875      4119.0456      16.236232      13.8463        18.3222      
      3100   297.90866     -42571.73      -11025.018      4126.8174      16.266866      13.8463        18.3222      
      3200   306.90717     -42545.378     -18542.07       4134.5892      16.297501      13.8463        18.3222      
      3300   317.3422      -42535.683     -17777.244      4142.361       16.328135      13.8463        18.3222      
      3400   306.63602     -42551.106     -10340.735      4150.1328      16.35877       13.8463        18.3222      
      3500   284.65753     -42537.337     -16931.699      4157.9046      16.389404      13.8463        18.3222      
      3600   307.39223     -42559.922     -16898.244      4165.6764      16.420038      13.8463        18.3222      
      3700   290.16283     -42548.35      -16132.305      4173.4481      16.450673      13.8463        18.3222      
      3800   288.38232     -42556.718     -27728.146      4181.2199      16.481307      13.8463        18.3222      
      3900   284.80232     -42536.301     -15090.413      4188.9917      16.511942      13.8463        18.3222      
      4000   308.26232     -42513.877     -18896.075      4196.7635      16.542576      13.8463        18.3222      
      4100   317.2609      -42491.047     -14060.542      4204.5353      16.57321       13.8463        18.3222      
      4200   310.2444      -42507.737     -5581.14        4212.3071      16.603845      13.8463        18.3222      
      4300   324.52598     -42543.236     -1483.034       4220.0788      16.634479      13.8463        18.3222      
      4400   315.18107     -42557.563     -12731.712      4227.8506      16.665114      13.8463        18.3222      
      4500   310.64309     -42558.687     -19849.39       4235.6224      16.695748      13.8463        18.3222      
      4600   290.96554     -42540.176     -15066.063      4243.3942      16.726382      13.8463        18.3222      
      4700   306.81053     -42553.548     -10513.445      4251.166       16.757017      13.8463        18.3222      
      4800   310.2706      -42541.964     -14674.764      4258.9378      16.787651      13.8463        18.3222      
      4900   327.3827      -42534.078     -13844.314      4266.7095      16.818286      13.8463        18.3222      
      5000   303.117       -42512.904     -27278.001      4274.4813      16.84892       13.8463        18.3222      
Loop time of 238.912 on 8 procs for 5000 steps with 365 atoms

Performance: 0.904 ns/day, 26.546 hours/ns, 20.928 timesteps/s, 7.639 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 138.79     | 176.93     | 202.42     | 189.2 | 74.06
Bond    | 0.0015607  | 0.0018735  | 0.0021922  |   0.5 |  0.00
Neigh   | 9.3876     | 12.313     | 14.237     |  53.5 |  5.15
Comm    | 2.5979     | 28.085     | 66.22      | 474.9 | 11.76
Output  | 0.017664   | 0.020135   | 0.022197   |   1.1 |  0.01
Modify  | 19.526     | 21.457     | 24.393     |  40.8 |  8.98
Other   |            | 0.1001     |            |       |  0.04

Nlocal:         45.625 ave          52 max          35 min
Histogram: 1 0 0 0 1 0 3 1 1 1
Nghost:        3108.38 ave        3146 max        3061 min
Histogram: 1 1 0 1 1 0 0 1 1 2
Neighs:        27166.9 ave       30783 max       21172 min
Histogram: 1 0 0 0 1 0 4 0 1 1

Total # of neighbors = 217335
Ave neighs/atom = 595.43836
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.8463
variable dlen equal ly-${len0}
variable dlen equal ly-13.8463
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.8463
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.731799999999999784, deltaxy = 0.77318
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.24629999999999999116, deltaxz = -0.02463
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.13819999999999998952, deltayz = 0.01382
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.38463 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.38463 yz delta 0.01382 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.5 | 128.5 | 129.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.40067     -42617.116     -2863.6192      3885.8921      15.3172        13.8463        18.3222      
       100   314.02471     -42631.54      -1326.7915      3878.1203      15.3172        13.818607      18.3222      
       200   295.01903     -42632.36       4610.5272      3870.3486      15.3172        13.790915      18.3222      
       300   308.20754     -42644.439      5326.5807      3862.5768      15.3172        13.763222      18.3222      
       400   298.80559     -42633.285     -4870.9336      3854.805       15.3172        13.73553       18.3222      
       500   291.37673     -42627.659      5355.378       3847.0332      15.3172        13.707837      18.3222      
       600   296.76111     -42637.311      10038.32       3839.2614      15.3172        13.680144      18.3222      
       700   297.18038     -42640.201      5443.4547      3831.4896      15.3172        13.652452      18.3222      
       800   295.89537     -42660.047     -6109.2153      3823.7178      15.3172        13.624759      18.3222      
       900   279.55523     -42648.251     -15231.252      3815.9461      15.3172        13.597067      18.3222      
      1000   297.83011     -42641.042     -1725.3149      3808.1743      15.3172        13.569374      18.3222      
      1100   305.16029     -42626.261     -5108.2267      3800.4025      15.3172        13.541681      18.3222      
      1200   306.42678     -42637.301      3566.0066      3792.6307      15.3172        13.513989      18.3222      
      1300   315.89929     -42658.393      8492.4876      3784.8589      15.3172        13.486296      18.3222      
      1400   306.61556     -42657.22      -8309.8786      3777.0871      15.3172        13.458604      18.3222      
      1500   315.79703     -42677.63       15318.97       3769.3154      15.3172        13.430911      18.3222      
      1600   295.35736     -42663.675      9417.6716      3761.5436      15.3172        13.403218      18.3222      
      1700   293.12013     -42679.44       12653.867      3753.7718      15.3172        13.375526      18.3222      
      1800   296.5521      -42688.415      273.91712      3746           15.3172        13.347833      18.3222      
      1900   289.44983     -42674.66      -1844.565       3738.2282      15.3172        13.320141      18.3222      
      2000   309.24479     -42655.408      13688.142      3730.4564      15.3172        13.292448      18.3222      
      2100   293.38997     -42611.038      4406.0421      3722.6847      15.3172        13.264755      18.3222      
      2200   295.07123     -42629.994      12554.272      3714.9129      15.3172        13.237063      18.3222      
      2300   295.65201     -42648.914     -219.68373      3707.1411      15.3172        13.20937       18.3222      
      2400   295.11267     -42650.649      11060.3        3699.3693      15.3172        13.181678      18.3222      
      2500   298.31177     -42658.276      21212.958      3691.5975      15.3172        13.153985      18.3222      
      2600   278.40502     -42646.023      8112.9377      3683.8257      15.3172        13.126292      18.3222      
      2700   283.75935     -42668.312      7935.0725      3676.0539      15.3172        13.0986        18.3222      
      2800   294.63592     -42660.276      12932.333      3668.2822      15.3172        13.070907      18.3222      
      2900   299.87029     -42624.435      14366.985      3660.5104      15.3172        13.043215      18.3222      
      3000   324.80114     -42642.725      29128.519      3652.7386      15.3172        13.015522      18.3222      
      3100   311.37067     -42631.945      18993.359      3644.9668      15.3172        12.987829      18.3222      
      3200   305.17357     -42626.253      14384.507      3637.195       15.3172        12.960137      18.3222      
      3300   280.80612     -42610.279      22567.701      3629.4232      15.3172        12.932444      18.3222      
      3400   307.84147     -42653.985      23007.671      3621.6515      15.3172        12.904752      18.3222      
      3500   275.4006      -42625.897      22975.289      3613.8797      15.3172        12.877059      18.3222      
      3600   296.95078     -42641.353      12222.264      3606.1079      15.3172        12.849366      18.3222      
      3700   306.46509     -42652.668      15875.67       3598.3361      15.3172        12.821674      18.3222      
      3800   297.27535     -42659.367      18282.868      3590.5643      15.3172        12.793981      18.3222      
      3900   264.91073     -42617.199      13318.491      3582.7925      15.3172        12.766289      18.3222      
      4000   307.42009     -42623.039      17245.995      3575.0208      15.3172        12.738596      18.3222      
      4100   307.84319     -42607.512      25475.068      3567.249       15.3172        12.710903      18.3222      
      4200   326.53111     -42631.879      17338.041      3559.4772      15.3172        12.683211      18.3222      
      4300   299.70985     -42601.781      15452.281      3551.7054      15.3172        12.655518      18.3222      
      4400   300.23993     -42601.743      21841.166      3543.9336      15.3172        12.627826      18.3222      
      4500   313.14346     -42609.313      26912.881      3536.1618      15.3172        12.600133      18.3222      
      4600   310.81275     -42601.991      27738.574      3528.39        15.3172        12.57244       18.3222      
      4700   308.66002     -42634.706      34105.189      3520.6183      15.3172        12.544748      18.3222      
      4800   305.44863     -42619.274      18110.584      3512.8465      15.3172        12.517055      18.3222      
      4900   301.65791     -42594.559      32112.619      3505.0747      15.3172        12.489363      18.3222      
      5000   320.39817     -42578.581      38800.894      3497.3029      15.3172        12.46167       18.3222      
Loop time of 278.387 on 8 procs for 5000 steps with 365 atoms

Performance: 0.776 ns/day, 30.932 hours/ns, 17.961 timesteps/s, 6.556 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.04     | 214.3      | 235.25     | 200.8 | 76.98
Bond    | 0.0018128  | 0.0019528  | 0.00216    |   0.2 |  0.00
Neigh   | 11.58      | 15.753     | 17.819     |  58.4 |  5.66
Comm    | 3.6231     | 24.572     | 76.834     | 592.9 |  8.83
Output  | 0.016427   | 0.018813   | 0.020851   |   1.1 |  0.01
Modify  | 21.555     | 23.632     | 27.815     |  47.9 |  8.49
Other   |            | 0.1072     |            |       |  0.04

Nlocal:         45.625 ave          51 max          39 min
Histogram: 1 0 0 1 0 3 2 0 0 1
Nghost:        3657.88 ave        3714 max        3628 min
Histogram: 3 0 1 2 0 0 0 1 0 1
Neighs:        33314.2 ave       37169 max       28750 min
Histogram: 1 0 0 1 0 3 2 0 0 1

Total # of neighbors = 266514
Ave neighs/atom = 730.17534
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.8463
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.38463 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.38463 yz delta -0.01382 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.5 | 128.5 | 129.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.40067     -42617.116     -2863.6192      3885.8921      15.3172        13.8463        18.3222      
       100   314.82767     -42632.784     -1327.3932      3893.6639      15.3172        13.873993      18.3222      
       200   295.2687      -42626.814      2701.0978      3901.4357      15.3172        13.901685      18.3222      
       300   303.85124     -42639.474     -446.74555      3909.2075      15.3172        13.929378      18.3222      
       400   297.61756     -42635.545     -19860.793      3916.9793      15.3172        13.95707       18.3222      
       500   314.71294     -42652.382      1596.8915      3924.751       15.3172        13.984763      18.3222      
       600   282.28189     -42625.272     -7183.1335      3932.5228      15.3172        14.012456      18.3222      
       700   274.14388     -42633.825     -11890.085      3940.2946      15.3172        14.040148      18.3222      
       800   276.529       -42636.768     -2010.6637      3948.0664      15.3172        14.067841      18.3222      
       900   294.19908     -42616.836     -1268.7127      3955.8382      15.3172        14.095533      18.3222      
      1000   325.90278     -42621.809     -9591.4595      3963.61        15.3172        14.123226      18.3222      
      1100   311.719       -42618.664     -6640.8257      3971.3817      15.3172        14.150919      18.3222      
      1200   297.6535      -42615.777      279.35412      3979.1535      15.3172        14.178611      18.3222      
      1300   302.23438     -42618.977     -10378.455      3986.9253      15.3172        14.206304      18.3222      
      1400   296.20596     -42613.761     -6118.4703      3994.6971      15.3172        14.233996      18.3222      
      1500   295.27398     -42625.591      149.74016      4002.4689      15.3172        14.261689      18.3222      
      1600   277.80505     -42635.579     -14914.434      4010.2407      15.3172        14.289382      18.3222      
      1700   271.90285     -42608.613     -11540.154      4018.0125      15.3172        14.317074      18.3222      
      1800   295.94476     -42603.536     -13717.438      4025.7842      15.3172        14.344767      18.3222      
      1900   295.59891     -42594.411     -11273.915      4033.556       15.3172        14.372459      18.3222      
      2000   306.18055     -42596.231     -12303.207      4041.3278      15.3172        14.400152      18.3222      
      2100   314.64379     -42594.926     -9192.1003      4049.0996      15.3172        14.427845      18.3222      
      2200   282.70921     -42585.957     -16522.514      4056.8714      15.3172        14.455537      18.3222      
      2300   282.35357     -42596.418     -9459.6445      4064.6432      15.3172        14.48323       18.3222      
      2400   282.58005     -42587.714     -17914.457      4072.4149      15.3172        14.510922      18.3222      
      2500   299.14634     -42571.187     -24123.338      4080.1867      15.3172        14.538615      18.3222      
      2600   310.04544     -42548.465     -17243.984      4087.9585      15.3172        14.566308      18.3222      
      2700   316.21616     -42566.626     -11433.197      4095.7303      15.3172        14.594         18.3222      
      2800   311.22028     -42577.833     -19802.069      4103.5021      15.3172        14.621693      18.3222      
      2900   311.16664     -42585.09      -13924.821      4111.2739      15.3172        14.649385      18.3222      
      3000   295.27019     -42584.436     -25567.089      4119.0456      15.3172        14.677078      18.3222      
      3100   280.33894     -42571.122     -16639.147      4126.8174      15.3172        14.704771      18.3222      
      3200   305.89124     -42601.494     -10202.241      4134.5892      15.3172        14.732463      18.3222      
      3300   269.89785     -42567.168     -17386.003      4142.361       15.3172        14.760156      18.3222      
      3400   284.87031     -42579.575     -14343.012      4150.1328      15.3172        14.787848      18.3222      
      3500   299.96749     -42562.364     -18704.944      4157.9046      15.3172        14.815541      18.3222      
      3600   317.29342     -42562.179     -18483.326      4165.6764      15.3172        14.843234      18.3222      
      3700   296.07007     -42543.372     -15817.73       4173.4481      15.3172        14.870926      18.3222      
      3800   286.61562     -42560.442     -7784.0964      4181.2199      15.3172        14.898619      18.3222      
      3900   293.52313     -42567.093     -6634.826       4188.9917      15.3172        14.926311      18.3222      
      4000   313.55333     -42567.713     -15581.677      4196.7635      15.3172        14.954004      18.3222      
      4100   310.27371     -42543.058     -17097.75       4204.5353      15.3172        14.981697      18.3222      
      4200   318.93799     -42541.104     -19264.907      4212.3071      15.3172        15.009389      18.3222      
      4300   279.85348     -42526.63      -21223.388      4220.0788      15.3172        15.037082      18.3222      
      4400   289.10124     -42553.129     -16713.746      4227.8506      15.3172        15.064774      18.3222      
      4500   289.97116     -42541.951     -19363.909      4235.6224      15.3172        15.092467      18.3222      
      4600   300.08811     -42540.915     -9287.635       4243.3942      15.3172        15.12016       18.3222      
      4700   293.82547     -42505.555     -24081.588      4251.166       15.3172        15.147852      18.3222      
      4800   317.54599     -42502.061     -20085.488      4258.9378      15.3172        15.175545      18.3222      
      4900   301.52006     -42501.616     -33334.706      4266.7095      15.3172        15.203237      18.3222      
      5000   307.88769     -42521.636     -21714.074      4274.4813      15.3172        15.23093       18.3222      
Loop time of 239.707 on 8 procs for 5000 steps with 365 atoms

Performance: 0.901 ns/day, 26.634 hours/ns, 20.859 timesteps/s, 7.613 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 141.51     | 188.61     | 200        | 134.3 | 78.68
Bond    | 0.0016367  | 0.0019444  | 0.0022739  |   0.5 |  0.00
Neigh   | 10.631     | 14.102     | 15.123     |  35.9 |  5.88
Comm    | 3.9984     | 15.405     | 62.508     | 470.1 |  6.43
Output  | 0.0175     | 0.019834   | 0.02183    |   1.0 |  0.01
Modify  | 20.388     | 21.458     | 24.939     |  29.2 |  8.95
Other   |            | 0.1085     |            |       |  0.05

Nlocal:         45.625 ave          53 max          40 min
Histogram: 1 0 3 1 0 0 1 1 0 1
Nghost:           3021 ave        3064 max        2985 min
Histogram: 1 1 0 2 2 0 0 0 1 1
Neighs:        27158.6 ave       31308 max       24164 min
Histogram: 1 2 1 1 0 0 1 1 0 1

Total # of neighbors = 217269
Ave neighs/atom = 595.25753
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 18.3222
variable dlen equal lz-${len0}
variable dlen equal lz-18.3222
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*18.3222
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.731799999999999784, deltaxy = 0.77318
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.24629999999999999116, deltaxz = -0.02463
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.13819999999999998952, deltayz = 0.01382
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -1.83222 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.5 | 128.5 | 129.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.40067     -42617.116     -2863.6192      3885.8921      15.3172        13.8463        18.3222      
       100   314.72031     -42632.062     -1375.9574      3878.1203      15.3172        13.8463        18.285556    
       200   293.77256     -42624.041      4640.3772      3870.3486      15.3172        13.8463        18.248911    
       300   308.82541     -42640.335      8487.113       3862.5768      15.3172        13.8463        18.212267    
       400   310.14272     -42641.625     -6404.9376      3854.805       15.3172        13.8463        18.175622    
       500   294.48429     -42634.782     -3687.8273      3847.0332      15.3172        13.8463        18.138978    
       600   286.19476     -42633.678     -8194.1414      3839.2614      15.3172        13.8463        18.102334    
       700   278.93842     -42650.655      1466.9639      3831.4896      15.3172        13.8463        18.065689    
       800   286.34269     -42665.772      7393.9861      3823.7178      15.3172        13.8463        18.029045    
       900   286.39175     -42643.671     -2636.4458      3815.9461      15.3172        13.8463        17.9924      
      1000   301.55124     -42630.118     -6301.2179      3808.1743      15.3172        13.8463        17.955756    
      1100   313.43345     -42626.009      20258.011      3800.4025      15.3172        13.8463        17.919112    
      1200   305.49836     -42632.251      2559.6068      3792.6307      15.3172        13.8463        17.882467    
      1300   291.10699     -42643.969      514.3064       3784.8589      15.3172        13.8463        17.845823    
      1400   302.35288     -42648.311      2504.805       3777.0871      15.3172        13.8463        17.809178    
      1500   306.50381     -42638.279      627.29418      3769.3154      15.3172        13.8463        17.772534    
      1600   283.97132     -42599.159      16240.49       3761.5436      15.3172        13.8463        17.73589     
      1700   314.2639      -42599.428     -3661.1704      3753.7718      15.3172        13.8463        17.699245    
      1800   294.30489     -42573.723      3789.5453      3746           15.3172        13.8463        17.662601    
      1900   302.04687     -42609.701      6555.9163      3738.2282      15.3172        13.8463        17.625956    
      2000   313.6515      -42627.366      18709.13       3730.4564      15.3172        13.8463        17.589312    
      2100   296.92577     -42616.841      7218.6584      3722.6847      15.3172        13.8463        17.552668    
      2200   298.2049      -42612.802      22111.61       3714.9129      15.3172        13.8463        17.516023    
      2300   321.29593     -42622.258      1955.0231      3707.1411      15.3172        13.8463        17.479379    
      2400   290.38958     -42589.76      -5601.822       3699.3693      15.3172        13.8463        17.442734    
      2500   300.75242     -42623.403      16095.563      3691.5975      15.3172        13.8463        17.40609     
      2600   284.04878     -42621.055     -71.013726      3683.8257      15.3172        13.8463        17.369446    
      2700   283.37374     -42613.819      13178.959      3676.0539      15.3172        13.8463        17.332801    
      2800   306.78246     -42599.738      18201.122      3668.2822      15.3172        13.8463        17.296157    
      2900   322.63501     -42592.966      2055.4371      3660.5104      15.3172        13.8463        17.259512    
      3000   324.59137     -42608.347      20726.2        3652.7386      15.3172        13.8463        17.222868    
      3100   307.86135     -42599.289     -1085.5733      3644.9668      15.3172        13.8463        17.186224    
      3200   300.90333     -42602.104      18473.049      3637.195       15.3172        13.8463        17.149579    
      3300   294.84195     -42602.068      11865.189      3629.4232      15.3172        13.8463        17.112935    
      3400   290.24613     -42606.499      19689.366      3621.6515      15.3172        13.8463        17.07629     
      3500   299.21615     -42616.376      18040.866      3613.8797      15.3172        13.8463        17.039646    
      3600   285.72523     -42603.953      14304.431      3606.1079      15.3172        13.8463        17.003002    
      3700   299.41082     -42607.782      8171.1956      3598.3361      15.3172        13.8463        16.966357    
      3800   292.72101     -42572.466      31450.602      3590.5643      15.3172        13.8463        16.929713    
      3900   322.62453     -42580.745      35474.914      3582.7925      15.3172        13.8463        16.893068    
      4000   309.11336     -42581.426      20300.117      3575.0208      15.3172        13.8463        16.856424    
      4100   304.73214     -42583.964      25986.971      3567.249       15.3172        13.8463        16.81978     
      4200   306.56654     -42583.821      17721.489      3559.4772      15.3172        13.8463        16.783135    
      4300   282.93395     -42563.52       15038.774      3551.7054      15.3172        13.8463        16.746491    
      4400   293.527       -42576.298      16235.198      3543.9336      15.3172        13.8463        16.709846    
      4500   292.47621     -42583.179      27566.492      3536.1618      15.3172        13.8463        16.673202    
      4600   302.31173     -42612.947      30544.309      3528.39        15.3172        13.8463        16.636558    
      4700   277.09196     -42607.756      21873.622      3520.6183      15.3172        13.8463        16.599913    
      4800   281.18305     -42590.036      21192.38       3512.8465      15.3172        13.8463        16.563269    
      4900   283.42476     -42563.388      16681.566      3505.0747      15.3172        13.8463        16.526624    
      5000   286.14115     -42536.859      24940.23       3497.3029      15.3172        13.8463        16.48998     
Loop time of 281.997 on 8 procs for 5000 steps with 365 atoms

Performance: 0.766 ns/day, 31.333 hours/ns, 17.731 timesteps/s, 6.472 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.41     | 219.86     | 238.17     | 161.9 | 77.97
Bond    | 0.0016234  | 0.0019281  | 0.0023489  |   0.5 |  0.00
Neigh   | 13.247     | 17.903     | 19.56      |  47.3 |  6.35
Comm    | 1.7248     | 20.043     | 77.468     | 536.4 |  7.11
Output  | 0.017652   | 0.020017   | 0.022111   |   1.0 |  0.01
Modify  | 22.312     | 24.059     | 28.747     |  41.1 |  8.53
Other   |            | 0.1076     |            |       |  0.04

Nlocal:         45.625 ave          50 max          38 min
Histogram: 1 0 0 0 1 1 1 1 1 2
Nghost:        3562.25 ave        3584 max        3537 min
Histogram: 1 0 1 1 1 1 0 1 1 1
Neighs:        33313.5 ave       36321 max       27880 min
Histogram: 1 0 0 0 1 1 1 1 1 2

Total # of neighbors = 266508
Ave neighs/atom = 730.1589
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*18.3222
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 1.83222 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.5 | 128.5 | 129.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.40067     -42617.116     -2863.6192      3885.8921      15.3172        13.8463        18.3222      
       100   314.35516     -42632.295     -1281.5963      3893.6639      15.3172        13.8463        18.358844    
       200   294.45279     -42632.513      35.179202      3901.4357      15.3172        13.8463        18.395489    
       300   296.46981     -42632.749      7385.5244      3909.2075      15.3172        13.8463        18.432133    
       400   310.06456     -42643.567     -11686.108      3916.9793      15.3172        13.8463        18.468778    
       500   298.0148      -42635.294     -2007.1754      3924.751       15.3172        13.8463        18.505422    
       600   293.20259     -42634.559     -6887.3093      3932.5228      15.3172        13.8463        18.542066    
       700   285.70383     -42651.262     -12374.092      3940.2946      15.3172        13.8463        18.578711    
       800   271.64926     -42652.322      3579.8197      3948.0664      15.3172        13.8463        18.615355    
       900   277.85429     -42637.341     -15534.412      3955.8382      15.3172        13.8463        18.652       
      1000   293.8856      -42625.893     -12360.382      3963.61        15.3172        13.8463        18.688644    
      1100   303.51407     -42624.976     -2558.5118      3971.3817      15.3172        13.8463        18.725288    
      1200   301.1889      -42633.287     -17385.769      3979.1535      15.3172        13.8463        18.761933    
      1300   271.581       -42617.973     -17830.004      3986.9253      15.3172        13.8463        18.798577    
      1400   296.27851     -42630.324      456.79726      3994.6971      15.3172        13.8463        18.835222    
      1500   313.11087     -42606.607     -17247.399      4002.4689      15.3172        13.8463        18.871866    
      1600   311.05514     -42585.061     -3436.0838      4010.2407      15.3172        13.8463        18.90851     
      1700   293.75277     -42593.218     -6048.3252      4018.0125      15.3172        13.8463        18.945155    
      1800   302.11998     -42616.634     -14957.473      4025.7842      15.3172        13.8463        18.981799    
      1900   305.55323     -42620.694     -9639.4209      4033.556       15.3172        13.8463        19.018444    
      2000   287.36306     -42607.044      3313.5785      4041.3278      15.3172        13.8463        19.055088    
      2100   288.40205     -42615.926     -15906.902      4049.0996      15.3172        13.8463        19.091732    
      2200   293.29839     -42617.747     -11565.045      4056.8714      15.3172        13.8463        19.128377    
      2300   285.03374     -42597.963     -10237.413      4064.6432      15.3172        13.8463        19.165021    
      2400   316.95119     -42604.042     -10050.573      4072.4149      15.3172        13.8463        19.201666    
      2500   330.82136     -42614.858     -5133.3042      4080.1867      15.3172        13.8463        19.23831     
      2600   297.13156     -42603.996     -16306.544      4087.9585      15.3172        13.8463        19.274954    
      2700   291.83564     -42596.862     -8420.8278      4095.7303      15.3172        13.8463        19.311599    
      2800   312.00229     -42605.796     -18760.224      4103.5021      15.3172        13.8463        19.348243    
      2900   311.44934     -42584.935     -17974.752      4111.2739      15.3172        13.8463        19.384888    
      3000   326.99579     -42588.658     -9614.775       4119.0456      15.3172        13.8463        19.421532    
      3100   309.52771     -42591.517     -15710.373      4126.8174      15.3172        13.8463        19.458176    
      3200   290.59797     -42587.413     -22664.478      4134.5892      15.3172        13.8463        19.494821    
      3300   276.02678     -42569.931     -11315.875      4142.361       15.3172        13.8463        19.531465    
      3400   296.27789     -42580.399     -6636.269       4150.1328      15.3172        13.8463        19.56811     
      3500   305.6452      -42560.628     -11397.457      4157.9046      15.3172        13.8463        19.604754    
      3600   334.30664     -42577.759     -14573.828      4165.6764      15.3172        13.8463        19.641398    
      3700   310.46628     -42584.865     -11067.821      4173.4481      15.3172        13.8463        19.678043    
      3800   287.46427     -42576.748     -19645.577      4181.2199      15.3172        13.8463        19.714687    
      3900   320.9648      -42594.415     -22647.272      4188.9917      15.3172        13.8463        19.751332    
      4000   311.11676     -42567.115     -13442.222      4196.7635      15.3172        13.8463        19.787976    
      4100   299.75368     -42571.318     -3883.5314      4204.5353      15.3172        13.8463        19.82462     
      4200   294.62933     -42581.656     -16059.124      4212.3071      15.3172        13.8463        19.861265    
      4300   298.85519     -42570.527     -5713.8909      4220.0788      15.3172        13.8463        19.897909    
      4400   303.86551     -42545.447     -9180.8597      4227.8506      15.3172        13.8463        19.934554    
      4500   305.86384     -42536.231     -17564.314      4235.6224      15.3172        13.8463        19.971198    
      4600   306.10822     -42535.879     -29979.946      4243.3942      15.3172        13.8463        20.007842    
      4700   299.97668     -42534.461     -18229.928      4251.166       15.3172        13.8463        20.044487    
      4800   306.03887     -42552.135     -13667.995      4258.9378      15.3172        13.8463        20.081131    
      4900   293.35295     -42550.662     -7764.969       4266.7095      15.3172        13.8463        20.117776    
      5000   276.59657     -42554.11      -26082.524      4274.4813      15.3172        13.8463        20.15442     
Loop time of 244.083 on 8 procs for 5000 steps with 365 atoms

Performance: 0.885 ns/day, 27.120 hours/ns, 20.485 timesteps/s, 7.477 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 139.32     | 186.63     | 206.25     | 175.5 | 76.46
Bond    | 0.0015568  | 0.0019157  | 0.0024923  |   0.7 |  0.00
Neigh   | 10.366     | 14.082     | 15.746     |  54.0 |  5.77
Comm    | 1.5391     | 21.162     | 68.43      | 520.4 |  8.67
Output  | 0.016236   | 0.018292   | 0.020035   |   0.9 |  0.01
Modify  | 20.312     | 22.087     | 25.854     |  44.0 |  9.05
Other   |            | 0.09879    |            |       |  0.04

Nlocal:         45.625 ave          51 max          40 min
Histogram: 1 0 1 1 1 1 1 0 1 1
Nghost:        3094.12 ave        3175 max        3032 min
Histogram: 2 0 2 0 1 0 1 1 0 1
Neighs:        27167.6 ave       29964 max       23911 min
Histogram: 1 0 1 0 2 0 2 0 1 1

Total # of neighbors = 217341
Ave neighs/atom = 595.45479
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 15.3172
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz--0.1382)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*15.3172
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.731799999999999784, deltaxy = 0.77318
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.24629999999999999116, deltaxz = -0.02463
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.13819999999999998952, deltayz = 0.01382
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -1.53172 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.5 | 128.5 | 129.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.40067     -42617.116     -2863.6192      3885.8921      15.3172        13.8463        18.3222      
       100   314.46924     -42632.092     -1251.1025      3885.8921      15.3172        13.8463        18.3222      
       200   293.01288     -42628.933      3644.917       3885.8921      15.3172        13.8463        18.3222      
       300   299.87008     -42638.908      5514.5587      3885.8921      15.3172        13.8463        18.3222      
       400   297.33029     -42637.237     -11235.875      3885.8921      15.3172        13.8463        18.3222      
       500   294.09215     -42637.391      462.57563      3885.8921      15.3172        13.8463        18.3222      
       600   285.25319     -42629.44      -4470.6016      3885.8921      15.3172        13.8463        18.3222      
       700   300.54532     -42638.011     -5831.1668      3885.8921      15.3172        13.8463        18.3222      
       800   322.00224     -42647.38      -10133.403      3885.8921      15.3172        13.8463        18.3222      
       900   304.46851     -42628.508     -2127.8317      3885.8921      15.3172        13.8463        18.3222      
      1000   294.12523     -42630.767      1156.0799      3885.8921      15.3172        13.8463        18.3222      
      1100   293.67754     -42652.647      3308.6573      3885.8921      15.3172        13.8463        18.3222      
      1200   293.50912     -42656.96      -3976.1244      3885.8921      15.3172        13.8463        18.3222      
      1300   310.05209     -42639.411     -1516.6379      3885.8921      15.3172        13.8463        18.3222      
      1400   298.31765     -42607.335      14185.706      3885.8921      15.3172        13.8463        18.3222      
      1500   308.97728     -42622.817     -3563.3863      3885.8921      15.3172        13.8463        18.3222      
      1600   294.95016     -42631.545      5537.3495      3885.8921      15.3172        13.8463        18.3222      
      1700   304.89759     -42658.836     -1130.5205      3885.8921      15.3172        13.8463        18.3222      
      1800   294.15614     -42648.618     -5726.6942      3885.8921      15.3172        13.8463        18.3222      
      1900   309.79707     -42645.045      1379.5103      3885.8921      15.3172        13.8463        18.3222      
      2000   309.75527     -42605.523     -9314.3146      3885.8921      15.3172        13.8463        18.3222      
      2100   315.59616     -42610.073     -4682.4519      3885.8921      15.3172        13.8463        18.3222      
      2200   325.88895     -42649.121     -1344.3792      3885.8921      15.3172        13.8463        18.3222      
      2300   310.72345     -42645.018     -2143.5605      3885.8921      15.3172        13.8463        18.3222      
      2400   295.84574     -42643.139      8997.7814      3885.8921      15.3172        13.8463        18.3222      
      2500   286.71913     -42640.92      -10266.97       3885.8921      15.3172        13.8463        18.3222      
      2600   292.64507     -42638.964     -9720.7725      3885.8921      15.3172        13.8463        18.3222      
      2700   310.89194     -42636.982     -8575.605       3885.8921      15.3172        13.8463        18.3222      
      2800   328.16768     -42626.563      2947.6679      3885.8921      15.3172        13.8463        18.3222      
      2900   321.43014     -42636.055      7312.6534      3885.8921      15.3172        13.8463        18.3222      
      3000   294.46121     -42625.991     -6066.4488      3885.8921      15.3172        13.8463        18.3222      
      3100   315.51467     -42647.166     -5240.104       3885.8921      15.3172        13.8463        18.3222      
      3200   264.85076     -42607.459     -4663.5162      3885.8921      15.3172        13.8463        18.3222      
      3300   310.17537     -42650.778     -11530.571      3885.8921      15.3172        13.8463        18.3222      
      3400   299.661       -42625.69       6686.9493      3885.8921      15.3172        13.8463        18.3222      
      3500   316.21367     -42608.825      4670.0764      3885.8921      15.3172        13.8463        18.3222      
      3600   344.2533      -42644.109      2038.9944      3885.8921      15.3172        13.8463        18.3222      
      3700   285.58496     -42614.529      3211.6948      3885.8921      15.3172        13.8463        18.3222      
      3800   294.83659     -42628.608     -2308.7737      3885.8921      15.3172        13.8463        18.3222      
      3900   305.21561     -42644.151     -14225.508      3885.8921      15.3172        13.8463        18.3222      
      4000   298.60988     -42644.043     -5256.9669      3885.8921      15.3172        13.8463        18.3222      
      4100   294.08558     -42636.929     -2851.1575      3885.8921      15.3172        13.8463        18.3222      
      4200   306.66227     -42629.104     -2051.0209      3885.8921      15.3172        13.8463        18.3222      
      4300   326.25112     -42621.18      -5877.5391      3885.8921      15.3172        13.8463        18.3222      
      4400   320.93507     -42610.793      1248.1521      3885.8921      15.3172        13.8463        18.3222      
      4500   293.47766     -42619.219     -6299.5119      3885.8921      15.3172        13.8463        18.3222      
      4600   294.43577     -42628.946      689.29831      3885.8921      15.3172        13.8463        18.3222      
      4700   304.37836     -42625.728     -6071.9147      3885.8921      15.3172        13.8463        18.3222      
      4800   305.07699     -42607.616     -15272.302      3885.8921      15.3172        13.8463        18.3222      
      4900   306.36902     -42594.143     -7732.1824      3885.8921      15.3172        13.8463        18.3222      
      5000   308.96016     -42609.677     -422.19716      3885.8921      15.3172        13.8463        18.3222      
Loop time of 259.993 on 8 procs for 5000 steps with 365 atoms

Performance: 0.831 ns/day, 28.888 hours/ns, 19.231 timesteps/s, 7.019 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 184.84     | 206.09     | 219.75     |  82.4 | 79.27
Bond    | 0.0016079  | 0.0019289  | 0.0023531  |   0.5 |  0.00
Neigh   | 13.448     | 15.764     | 17.132     |  31.2 |  6.06
Comm    | 1.7186     | 15.379     | 36.587     | 301.6 |  5.92
Output  | 0.016839   | 0.018984   | 0.020901   |   1.0 |  0.01
Modify  | 21.197     | 22.628     | 24.992     |  26.4 |  8.70
Other   |            | 0.1079     |            |       |  0.04

Nlocal:         45.625 ave          53 max          40 min
Histogram: 1 2 0 0 3 0 0 1 0 1
Nghost:        3309.75 ave        3340 max        3289 min
Histogram: 1 2 2 0 0 0 0 2 0 1
Neighs:        29926.2 ave       34509 max       26527 min
Histogram: 1 2 0 0 3 0 0 1 0 1

Total # of neighbors = 239410
Ave neighs/atom = 655.91781
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*15.3172
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 1.53172 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.5 | 128.5 | 129.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.40067     -42617.116     -2863.6192      3885.8921      15.3172        13.8463        18.3222      
       100   314.34631     -42632.098     -1421.7495      3885.8921      15.3172        13.8463        18.3222      
       200   292.4394      -42632.378      1915.3732      3885.8921      15.3172        13.8463        18.3222      
       300   290.35553     -42631.285      5293.2254      3885.8921      15.3172        13.8463        18.3222      
       400   308.68484     -42647.75      -12250.029      3885.8921      15.3172        13.8463        18.3222      
       500   292.71278     -42631.966      1719.56        3885.8921      15.3172        13.8463        18.3222      
       600   299.23074     -42636.272     -7604.6812      3885.8921      15.3172        13.8463        18.3222      
       700   303.64715     -42626.498     -16556.124      3885.8921      15.3172        13.8463        18.3222      
       800   333.82539     -42646.182     -3877.9626      3885.8921      15.3172        13.8463        18.3222      
       900   305.30253     -42633.876     -12564.223      3885.8921      15.3172        13.8463        18.3222      
      1000   305.4101      -42657.101     -128.68547      3885.8921      15.3172        13.8463        18.3222      
      1100   295.41011     -42649.857     -15567.465      3885.8921      15.3172        13.8463        18.3222      
      1200   302.88558     -42650.397      3282.9783      3885.8921      15.3172        13.8463        18.3222      
      1300   293.85111     -42618.244     -6749.3159      3885.8921      15.3172        13.8463        18.3222      
      1400   323.08101     -42610.397     -2663.6322      3885.8921      15.3172        13.8463        18.3222      
      1500   320.61409     -42624.839      20916.321      3885.8921      15.3172        13.8463        18.3222      
      1600   290.50351     -42618.198     -9383.3748      3885.8921      15.3172        13.8463        18.3222      
      1700   298.912       -42645.889     -312.33991      3885.8921      15.3172        13.8463        18.3222      
      1800   277.25795     -42637.761     -4221.2781      3885.8921      15.3172        13.8463        18.3222      
      1900   303.12425     -42656.091     -14759.658      3885.8921      15.3172        13.8463        18.3222      
      2000   306.95795     -42623.404     -3133.1309      3885.8921      15.3172        13.8463        18.3222      
      2100   333.20741     -42638.542      3926.949       3885.8921      15.3172        13.8463        18.3222      
      2200   308.02466     -42623.17      -401.99358      3885.8921      15.3172        13.8463        18.3222      
      2300   302.70237     -42631.383      9852.7703      3885.8921      15.3172        13.8463        18.3222      
      2400   308.42269     -42650.377     -7811.7535      3885.8921      15.3172        13.8463        18.3222      
      2500   291.54887     -42642.045     -6527.6488      3885.8921      15.3172        13.8463        18.3222      
      2600   295.83109     -42643.018      4468.305       3885.8921      15.3172        13.8463        18.3222      
      2700   304.4907      -42643.882      1896.4908      3885.8921      15.3172        13.8463        18.3222      
      2800   301.62229     -42628.486     -2358.7084      3885.8921      15.3172        13.8463        18.3222      
      2900   306.58188     -42631.811     -1970.1657      3885.8921      15.3172        13.8463        18.3222      
      3000   291.65624     -42629.681     -5030.0713      3885.8921      15.3172        13.8463        18.3222      
      3100   285.12259     -42635.909     -5852.8608      3885.8921      15.3172        13.8463        18.3222      
      3200   274.89016     -42631.728      930.74723      3885.8921      15.3172        13.8463        18.3222      
      3300   311.75548     -42659.244      5780.8779      3885.8921      15.3172        13.8463        18.3222      
      3400   301.31034     -42623.777      5427.7151      3885.8921      15.3172        13.8463        18.3222      
      3500   320.55106     -42625.182      18189.913      3885.8921      15.3172        13.8463        18.3222      
      3600   304.40182     -42622.658      8210.8462      3885.8921      15.3172        13.8463        18.3222      
      3700   282.4818      -42630.972     -197.46807      3885.8921      15.3172        13.8463        18.3222      
      3800   300.28661     -42650.128     -9847.0732      3885.8921      15.3172        13.8463        18.3222      
      3900   290.20582     -42626.103     -1004.9542      3885.8921      15.3172        13.8463        18.3222      
      4000   302.44108     -42626.526     -12675.508      3885.8921      15.3172        13.8463        18.3222      
      4100   329.85241     -42634.82      -8479.6483      3885.8921      15.3172        13.8463        18.3222      
      4200   311.62999     -42594.221     -1529.5709      3885.8921      15.3172        13.8463        18.3222      
      4300   307.24637     -42605.156     -5454.8007      3885.8921      15.3172        13.8463        18.3222      
      4400   305.91152     -42635.207     -5221.385       3885.8921      15.3172        13.8463        18.3222      
      4500   278.55814     -42609.124     -4915.5426      3885.8921      15.3172        13.8463        18.3222      
      4600   308.95937     -42628.133      10114.699      3885.8921      15.3172        13.8463        18.3222      
      4700   297.55657     -42620.043      3746.3754      3885.8921      15.3172        13.8463        18.3222      
      4800   282.95972     -42626.359     -8050.8846      3885.8921      15.3172        13.8463        18.3222      
      4900   275.20486     -42636.321     -1505.5054      3885.8921      15.3172        13.8463        18.3222      
      5000   289.25954     -42636.753     -5914.7583      3885.8921      15.3172        13.8463        18.3222      
Loop time of 259.366 on 8 procs for 5000 steps with 365 atoms

Performance: 0.833 ns/day, 28.818 hours/ns, 19.278 timesteps/s, 7.036 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 200.56     | 211.9      | 218.02     |  37.0 | 81.70
Bond    | 0.0015939  | 0.0019626  | 0.0023406  |   0.6 |  0.00
Neigh   | 15.22      | 16.038     | 17.036     |  15.2 |  6.18
Comm    | 3.1671     | 9.2608     | 20.621     | 177.5 |  3.57
Output  | 0.018478   | 0.020888   | 0.023084   |   1.1 |  0.01
Modify  | 20.98      | 22.033     | 22.89      |  13.5 |  8.49
Other   |            | 0.1136     |            |       |  0.04

Nlocal:         45.625 ave          57 max          39 min
Histogram: 1 0 4 0 1 1 0 0 0 1
Nghost:        3258.25 ave        3294 max        3222 min
Histogram: 1 0 1 1 0 3 0 0 1 1
Neighs:        29927.5 ave       36839 max       26009 min
Histogram: 1 0 4 0 2 0 0 0 0 1

Total # of neighbors = 239420
Ave neighs/atom = 655.94521
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.8463
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-0.2463)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.8463
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.731799999999999784, deltaxy = 0.77318
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.24629999999999999116, deltaxz = -0.02463
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.13819999999999998952, deltayz = 0.01382
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -1.38463 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.5 | 128.5 | 129.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.40067     -42617.116     -2863.6192      3885.8921      15.3172        13.8463        18.3222      
       100   314.50655     -42632.289     -1355.5065      3885.8921      15.3172        13.8463        18.3222      
       200   291.4541      -42629.871      2868.629       3885.8921      15.3172        13.8463        18.3222      
       300   302.89357     -42646.627      11276.843      3885.8921      15.3172        13.8463        18.3222      
       400   310.74015     -42656.134     -4660.2722      3885.8921      15.3172        13.8463        18.3222      
       500   295.5032      -42633.043      3209.7042      3885.8921      15.3172        13.8463        18.3222      
       600   309.04005     -42643.176     -9272.9249      3885.8921      15.3172        13.8463        18.3222      
       700   304.32252     -42616.372     -12203.139      3885.8921      15.3172        13.8463        18.3222      
       800   332.76452     -42635.493     -7429.52        3885.8921      15.3172        13.8463        18.3222      
       900   314.3473      -42645.723     -1738.9146      3885.8921      15.3172        13.8463        18.3222      
      1000   301.86589     -42647.314     -140.44048      3885.8921      15.3172        13.8463        18.3222      
      1100   302.94958     -42653.353      1304.9956      3885.8921      15.3172        13.8463        18.3222      
      1200   303.62122     -42654.094     -10050.467      3885.8921      15.3172        13.8463        18.3222      
      1300   294.01089     -42644.065     -10331.287      3885.8921      15.3172        13.8463        18.3222      
      1400   295.98102     -42638.421      1632.0338      3885.8921      15.3172        13.8463        18.3222      
      1500   315.91073     -42632.66       9044.6393      3885.8921      15.3172        13.8463        18.3222      
      1600   307.63963     -42611.165     -12400.379      3885.8921      15.3172        13.8463        18.3222      
      1700   302.10977     -42632.027      4176.6434      3885.8921      15.3172        13.8463        18.3222      
      1800   306.14923     -42653.397     -6690.8819      3885.8921      15.3172        13.8463        18.3222      
      1900   276.53755     -42617.377     -6853.2482      3885.8921      15.3172        13.8463        18.3222      
      2000   294.7432      -42617.423     -4390.1744      3885.8921      15.3172        13.8463        18.3222      
      2100   332.65879     -42640.42       1491.628       3885.8921      15.3172        13.8463        18.3222      
      2200   306.20915     -42621.708      6006.8139      3885.8921      15.3172        13.8463        18.3222      
      2300   297.78016     -42650.97       2346.8991      3885.8921      15.3172        13.8463        18.3222      
      2400   279.78796     -42634.001     -9658.9062      3885.8921      15.3172        13.8463        18.3222      
      2500   290.78106     -42621.864     -1812.8588      3885.8921      15.3172        13.8463        18.3222      
      2600   310.79594     -42624.926     -4795.0956      3885.8921      15.3172        13.8463        18.3222      
      2700   308.01931     -42628.251      2327.6583      3885.8921      15.3172        13.8463        18.3222      
      2800   287.64572     -42650.006     -10469.671      3885.8921      15.3172        13.8463        18.3222      
      2900   285.88715     -42648.355     -14456.046      3885.8921      15.3172        13.8463        18.3222      
      3000   305.36079     -42645.559     -1273.5742      3885.8921      15.3172        13.8463        18.3222      
      3100   302.9637      -42627.581     -3761.1311      3885.8921      15.3172        13.8463        18.3222      
      3200   302.32663     -42613.84      -99.465206      3885.8921      15.3172        13.8463        18.3222      
      3300   308.70039     -42620.324     -4876.6074      3885.8921      15.3172        13.8463        18.3222      
      3400   297.43996     -42626.717     -8208.2505      3885.8921      15.3172        13.8463        18.3222      
      3500   295.48402     -42643.917     -3152.5496      3885.8921      15.3172        13.8463        18.3222      
      3600   306.53172     -42658.807      4469.6714      3885.8921      15.3172        13.8463        18.3222      
      3700   302.96298     -42633.017      4540.2433      3885.8921      15.3172        13.8463        18.3222      
      3800   329.47921     -42628.966      9988.2146      3885.8921      15.3172        13.8463        18.3222      
      3900   316.97426     -42616.815      8907.4959      3885.8921      15.3172        13.8463        18.3222      
      4000   306.07769     -42625.233      4361.5613      3885.8921      15.3172        13.8463        18.3222      
      4100   305.81158     -42629.563      12545.094      3885.8921      15.3172        13.8463        18.3222      
      4200   298.91378     -42630.422      14869.032      3885.8921      15.3172        13.8463        18.3222      
      4300   284.47359     -42632.268      13319.246      3885.8921      15.3172        13.8463        18.3222      
      4400   277.45939     -42626.571     -6.5641877      3885.8921      15.3172        13.8463        18.3222      
      4500   297.06226     -42614.448     -617.21196      3885.8921      15.3172        13.8463        18.3222      
      4600   317.3209      -42610.392     -5629.3098      3885.8921      15.3172        13.8463        18.3222      
      4700   318.17582     -42631.583     -9413.2748      3885.8921      15.3172        13.8463        18.3222      
      4800   293.92082     -42627.303      7589.6811      3885.8921      15.3172        13.8463        18.3222      
      4900   282.34831     -42619.056     -3295.8089      3885.8921      15.3172        13.8463        18.3222      
      5000   300.3906      -42619.212      2352.6336      3885.8921      15.3172        13.8463        18.3222      
Loop time of 258.762 on 8 procs for 5000 steps with 365 atoms

Performance: 0.835 ns/day, 28.751 hours/ns, 19.323 timesteps/s, 7.053 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 177.67     | 209.61     | 219.39     |  85.4 | 81.00
Bond    | 0.0016316  | 0.0019461  | 0.0023418  |   0.5 |  0.00
Neigh   | 13.112     | 15.309     | 16.248     |  24.0 |  5.92
Comm    | 1.8035     | 11.573     | 43.514     | 363.6 |  4.47
Output  | 0.016964   | 0.019236   | 0.021258   |   1.0 |  0.01
Modify  | 21.14      | 22.138     | 24.329     |  20.2 |  8.56
Other   |            | 0.1142     |            |       |  0.04

Nlocal:         45.625 ave          50 max          36 min
Histogram: 1 0 0 1 0 1 0 0 1 4
Nghost:        3269.38 ave        3306 max        3227 min
Histogram: 1 0 0 1 2 1 1 0 1 1
Neighs:        29939.6 ave       32804 max       23881 min
Histogram: 1 0 0 1 1 0 0 0 1 4

Total # of neighbors = 239517
Ave neighs/atom = 656.21096
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.8463
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 1.38463 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.5 | 128.5 | 129.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.40067     -42617.116     -2863.6192      3885.8921      15.3172        13.8463        18.3222      
       100   314.34937     -42631.982     -1365.5186      3885.8921      15.3172        13.8463        18.3222      
       200   291.55999     -42629.468      5147.6717      3885.8921      15.3172        13.8463        18.3222      
       300   302.94346     -42641.363      8719.6414      3885.8921      15.3172        13.8463        18.3222      
       400   302.57745     -42640.097     -9061.9397      3885.8921      15.3172        13.8463        18.3222      
       500   291.39443     -42634.991     -2312.6561      3885.8921      15.3172        13.8463        18.3222      
       600   308.9683      -42653.855     -5862.6564      3885.8921      15.3172        13.8463        18.3222      
       700   312.17632     -42630.468     -6168.3979      3885.8921      15.3172        13.8463        18.3222      
       800   331.2586      -42637.007     -8859.6676      3885.8921      15.3172        13.8463        18.3222      
       900   306.80492     -42641.954      3579.9059      3885.8921      15.3172        13.8463        18.3222      
      1000   293.08342     -42638.475     -2727.5777      3885.8921      15.3172        13.8463        18.3222      
      1100   308.20084     -42651.097      2804.2543      3885.8921      15.3172        13.8463        18.3222      
      1200   310.77472     -42642.353      3610.6397      3885.8921      15.3172        13.8463        18.3222      
      1300   299.72796     -42621.644     -11750.767      3885.8921      15.3172        13.8463        18.3222      
      1400   329.13155     -42638.193     -1080.6201      3885.8921      15.3172        13.8463        18.3222      
      1500   294.65708     -42610.931      2801.9916      3885.8921      15.3172        13.8463        18.3222      
      1600   314.38963     -42650.617     -2746.2757      3885.8921      15.3172        13.8463        18.3222      
      1700   288.7581      -42638.095     -7378.0704      3885.8921      15.3172        13.8463        18.3222      
      1800   273.83565     -42630.492     -13666.75       3885.8921      15.3172        13.8463        18.3222      
      1900   288.50911     -42655.698     -13774.358      3885.8921      15.3172        13.8463        18.3222      
      2000   285.44099     -42638.756     -16614.529      3885.8921      15.3172        13.8463        18.3222      
      2100   323.49553     -42648.035     -2070.2881      3885.8921      15.3172        13.8463        18.3222      
      2200   302.64965     -42619.339     -16209.769      3885.8921      15.3172        13.8463        18.3222      
      2300   315.10937     -42626.291     -7563.6521      3885.8921      15.3172        13.8463        18.3222      
      2400   284.62618     -42594.363     -4587.2606      3885.8921      15.3172        13.8463        18.3222      
      2500   293.82519     -42626.325     -2352.0244      3885.8921      15.3172        13.8463        18.3222      
      2600   290.85057     -42638.491     -12070.939      3885.8921      15.3172        13.8463        18.3222      
      2700   309.10229     -42651.769     -1349.7744      3885.8921      15.3172        13.8463        18.3222      
      2800   291.08762     -42612.812     -4903.2017      3885.8921      15.3172        13.8463        18.3222      
      2900   305.23299     -42593.492     -16750.845      3885.8921      15.3172        13.8463        18.3222      
      3000   315.4465      -42595.251     -17834.033      3885.8921      15.3172        13.8463        18.3222      
      3100   291.69788     -42596.742     -4288.8671      3885.8921      15.3172        13.8463        18.3222      
      3200   301.60274     -42624.052     -4592.9105      3885.8921      15.3172        13.8463        18.3222      
      3300   299.05766     -42622.012     -2974.2085      3885.8921      15.3172        13.8463        18.3222      
      3400   292.86621     -42615.779     -9193.6366      3885.8921      15.3172        13.8463        18.3222      
      3500   297.41794     -42630.912     -5943.5524      3885.8921      15.3172        13.8463        18.3222      
      3600   288.70482     -42647.139     -4570.7498      3885.8921      15.3172        13.8463        18.3222      
      3700   271.71941     -42637.538      1765.7793      3885.8921      15.3172        13.8463        18.3222      
      3800   282.35952     -42622.573     -7455.356       3885.8921      15.3172        13.8463        18.3222      
      3900   306.92895     -42623.232     -1858.6755      3885.8921      15.3172        13.8463        18.3222      
      4000   296.50394     -42610.888     -3958.0312      3885.8921      15.3172        13.8463        18.3222      
      4100   302.51191     -42627.922     -13823.876      3885.8921      15.3172        13.8463        18.3222      
      4200   299.9097      -42647.482      7400.1729      3885.8921      15.3172        13.8463        18.3222      
      4300   291.32831     -42650.807     -10593.991      3885.8921      15.3172        13.8463        18.3222      
      4400   308.23364     -42670.285     -265.73245      3885.8921      15.3172        13.8463        18.3222      
      4500   284.01241     -42635.657      7379.4554      3885.8921      15.3172        13.8463        18.3222      
      4600   292.08954     -42620.754     -1382.2245      3885.8921      15.3172        13.8463        18.3222      
      4700   303.02897     -42614.223     -3406.6095      3885.8921      15.3172        13.8463        18.3222      
      4800   306.46806     -42620.35      -1943.4694      3885.8921      15.3172        13.8463        18.3222      
      4900   301.75936     -42642.844      7253.6793      3885.8921      15.3172        13.8463        18.3222      
      5000   285.808       -42632.757      5000.0503      3885.8921      15.3172        13.8463        18.3222      
Loop time of 247.6 on 8 procs for 5000 steps with 365 atoms

Performance: 0.872 ns/day, 27.511 hours/ns, 20.194 timesteps/s, 7.371 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 169.96     | 192.96     | 207.89     | 112.7 | 77.93
Bond    | 0.0014659  | 0.0017856  | 0.0021394  |   0.6 |  0.00
Neigh   | 12.008     | 14.45      | 16.115     |  38.8 |  5.84
Comm    | 3.3548     | 18.254     | 41.231     | 366.4 |  7.37
Output  | 0.016826   | 0.01901    | 0.020892   |   1.0 |  0.01
Modify  | 20.085     | 21.804     | 24.284     |  31.9 |  8.81
Other   |            | 0.1091     |            |       |  0.04

Nlocal:         45.625 ave          50 max          41 min
Histogram: 1 1 0 2 0 0 1 1 1 1
Nghost:         3275.5 ave        3321 max        3221 min
Histogram: 1 1 0 1 1 0 1 0 2 1
Neighs:        29952.8 ave       32613 max       27237 min
Histogram: 2 0 0 2 0 0 1 1 1 1

Total # of neighbors = 239622
Ave neighs/atom = 656.49863
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 18.3222
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--7.7318)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*18.3222
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.731799999999999784, deltaxy = 0.77318
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.24629999999999999116, deltaxz = -0.02463
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.13819999999999998952, deltayz = 0.01382
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -1.83222 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.5 | 128.5 | 129.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.40067     -42617.116     -2863.6192      3885.8921      15.3172        13.8463        18.3222      
       100   314.22626     -42631.702     -1324.9493      3885.8921      15.3172        13.8463        18.3222      
       200   292.59888     -42628.606      5408.1433      3885.8921      15.3172        13.8463        18.3222      
       300   300.25101     -42640.451      8479.1511      3885.8921      15.3172        13.8463        18.3222      
       400   307.9233      -42643.809     -5583.2162      3885.8921      15.3172        13.8463        18.3222      
       500   301.34027     -42634.789     -7780.1779      3885.8921      15.3172        13.8463        18.3222      
       600   305.13805     -42647.33      -4356.5068      3885.8921      15.3172        13.8463        18.3222      
       700   283.9229      -42653.432     -3049.4158      3885.8921      15.3172        13.8463        18.3222      
       800   298.23872     -42665.259      4756.6728      3885.8921      15.3172        13.8463        18.3222      
       900   306.94663     -42654.783      8534.4602      3885.8921      15.3172        13.8463        18.3222      
      1000   317.10165     -42625.089      6532.76        3885.8921      15.3172        13.8463        18.3222      
      1100   303.78831     -42610.689      1749.6324      3885.8921      15.3172        13.8463        18.3222      
      1200   305.77428     -42628.925     -7241.8158      3885.8921      15.3172        13.8463        18.3222      
      1300   314.72539     -42649.331     -6901.9739      3885.8921      15.3172        13.8463        18.3222      
      1400   300.17347     -42639.67      -1568.8803      3885.8921      15.3172        13.8463        18.3222      
      1500   288.68806     -42617.272     -6169.0468      3885.8921      15.3172        13.8463        18.3222      
      1600   316.51786     -42626.644      464.62553      3885.8921      15.3172        13.8463        18.3222      
      1700   322.25386     -42617.819     -8110.7127      3885.8921      15.3172        13.8463        18.3222      
      1800   304.96348     -42613.129      2344.2415      3885.8921      15.3172        13.8463        18.3222      
      1900   282.08022     -42612.655     -7803.6136      3885.8921      15.3172        13.8463        18.3222      
      2000   270.14629     -42608.675     -10349.311      3885.8921      15.3172        13.8463        18.3222      
      2100   280.5884      -42618.513     -13860.071      3885.8921      15.3172        13.8463        18.3222      
      2200   286.72139     -42605.567     -5764.7321      3885.8921      15.3172        13.8463        18.3222      
      2300   326.72517     -42610.731     -9216.1483      3885.8921      15.3172        13.8463        18.3222      
      2400   314.07193     -42597.848      2673.0338      3885.8921      15.3172        13.8463        18.3222      
      2500   306.60948     -42615.228     -491.09418      3885.8921      15.3172        13.8463        18.3222      
      2600   285.76681     -42601.164      1009.0449      3885.8921      15.3172        13.8463        18.3222      
      2700   308.49726     -42619.013     -2843.4971      3885.8921      15.3172        13.8463        18.3222      
      2800   307.85931     -42615.769     -4125.4964      3885.8921      15.3172        13.8463        18.3222      
      2900   296.21349     -42627.812     -6649.4758      3885.8921      15.3172        13.8463        18.3222      
      3000   284.67743     -42628.07       4240.522       3885.8921      15.3172        13.8463        18.3222      
      3100   292.72955     -42618.766      7569.6022      3885.8921      15.3172        13.8463        18.3222      
      3200   306.81188     -42619.641     -4036.3094      3885.8921      15.3172        13.8463        18.3222      
      3300   308.66125     -42620.651     -1828.3211      3885.8921      15.3172        13.8463        18.3222      
      3400   300.0715      -42616.972      6051.2438      3885.8921      15.3172        13.8463        18.3222      
      3500   301.43219     -42612.486     -907.48294      3885.8921      15.3172        13.8463        18.3222      
      3600   306.01381     -42609.963      6694.4697      3885.8921      15.3172        13.8463        18.3222      
      3700   298.84209     -42607.136     -11831.096      3885.8921      15.3172        13.8463        18.3222      
      3800   283.99151     -42609.756      648.51471      3885.8921      15.3172        13.8463        18.3222      
      3900   278.61986     -42620.993     -1115.0675      3885.8921      15.3172        13.8463        18.3222      
      4000   301.25731     -42638.559     -4699.135       3885.8921      15.3172        13.8463        18.3222      
      4100   306.60759     -42597.473      999.68268      3885.8921      15.3172        13.8463        18.3222      
      4200   306.69788     -42587.828      424.47749      3885.8921      15.3172        13.8463        18.3222      
      4300   289.31897     -42592.829     -4471.4123      3885.8921      15.3172        13.8463        18.3222      
      4400   301.54423     -42615.112     -692.02583      3885.8921      15.3172        13.8463        18.3222      
      4500   292.01873     -42603.259     -10003.805      3885.8921      15.3172        13.8463        18.3222      
      4600   278.66321     -42584.534     -8244.0696      3885.8921      15.3172        13.8463        18.3222      
      4700   308.79678     -42597.77      -7270.5037      3885.8921      15.3172        13.8463        18.3222      
      4800   286.62675     -42553.405      8101.2176      3885.8921      15.3172        13.8463        18.3222      
      4900   327.2995      -42599.542      10616.042      3885.8921      15.3172        13.8463        18.3222      
      5000   302.17247     -42598.453      4883.1644      3885.8921      15.3172        13.8463        18.3222      
Loop time of 217.308 on 8 procs for 5000 steps with 365 atoms

Performance: 0.994 ns/day, 24.145 hours/ns, 23.009 timesteps/s, 8.398 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 133.49     | 147.09     | 182.1      | 121.9 | 67.69
Bond    | 0.0012041  | 0.0013319  | 0.0015909  |   0.3 |  0.00
Neigh   | 9.9735     | 11.562     | 14.786     |  41.0 |  5.32
Comm    | 2.1565     | 37.178     | 50.763     | 242.5 | 17.11
Output  | 0.013417   | 0.015157   | 0.016582   |   0.9 |  0.01
Modify  | 18.146     | 21.375     | 22.966     |  30.2 |  9.84
Other   |            | 0.08983    |            |       |  0.04

Nlocal:         45.625 ave          53 max          38 min
Histogram: 1 0 0 2 1 0 2 1 0 1
Nghost:        3419.25 ave        3477 max        3363 min
Histogram: 1 1 0 2 0 1 1 0 0 2
Neighs:        29948.9 ave       34398 max       25317 min
Histogram: 1 0 0 3 0 0 2 1 0 1

Total # of neighbors = 239591
Ave neighs/atom = 656.4137
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*18.3222
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 1.83222 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.5 | 128.5 | 129.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.40067     -42617.116     -2863.6192      3885.8921      15.3172        13.8463        18.3222      
       100   314.61661     -42632.516     -1243.0444      3885.8921      15.3172        13.8463        18.3222      
       200   292.56017     -42628.572      2739.8505      3885.8921      15.3172        13.8463        18.3222      
       300   302.53626     -42641.604      7218.8309      3885.8921      15.3172        13.8463        18.3222      
       400   304.15602     -42644.221     -8700.2256      3885.8921      15.3172        13.8463        18.3222      
       500   294.29894     -42631.746     -4393.3054      3885.8921      15.3172        13.8463        18.3222      
       600   283.04081     -42624.159      4886.0408      3885.8921      15.3172        13.8463        18.3222      
       700   280.10409     -42632.553     -7965.6584      3885.8921      15.3172        13.8463        18.3222      
       800   308.07452     -42673.539     -6786.9396      3885.8921      15.3172        13.8463        18.3222      
       900   283.87915     -42634.488     -9800.4966      3885.8921      15.3172        13.8463        18.3222      
      1000   314.72372     -42632.683     -6990.1148      3885.8921      15.3172        13.8463        18.3222      
      1100   319.86479     -42629.981      7974.4731      3885.8921      15.3172        13.8463        18.3222      
      1200   293.33407     -42627.561     -11791.871      3885.8921      15.3172        13.8463        18.3222      
      1300   298.51462     -42631.719     -6677.9351      3885.8921      15.3172        13.8463        18.3222      
      1400   304.73153     -42632.716      2431.4354      3885.8921      15.3172        13.8463        18.3222      
      1500   311.61353     -42648.825      433.0182       3885.8921      15.3172        13.8463        18.3222      
      1600   305.14489     -42648.232     -8591.889       3885.8921      15.3172        13.8463        18.3222      
      1700   276.88078     -42640.788      10934.362      3885.8921      15.3172        13.8463        18.3222      
      1800   290.33002     -42651.077     -584.10217      3885.8921      15.3172        13.8463        18.3222      
      1900   288.9029      -42621.984     -3088.2746      3885.8921      15.3172        13.8463        18.3222      
      2000   312.69373     -42618.205     -13399.488      3885.8921      15.3172        13.8463        18.3222      
      2100   314.79569     -42620.281     -5384.1093      3885.8921      15.3172        13.8463        18.3222      
      2200   302.52976     -42628.905      2227.7054      3885.8921      15.3172        13.8463        18.3222      
      2300   278.49925     -42615.907      13942.055      3885.8921      15.3172        13.8463        18.3222      
      2400   296.56537     -42628.497     -12044.759      3885.8921      15.3172        13.8463        18.3222      
      2500   281.45038     -42600.44      -5177.7464      3885.8921      15.3172        13.8463        18.3222      
      2600   304.65673     -42622.023      12273.987      3885.8921      15.3172        13.8463        18.3222      
      2700   295.1798      -42635.88       813.86704      3885.8921      15.3172        13.8463        18.3222      
      2800   307.76028     -42661.298      1262.783       3885.8921      15.3172        13.8463        18.3222      
      2900   277.13486     -42620.513     -5441.1475      3885.8921      15.3172        13.8463        18.3222      
      3000   297.56336     -42617.83      -5820.7096      3885.8921      15.3172        13.8463        18.3222      
      3100   295.63172     -42595.542     -7691.9133      3885.8921      15.3172        13.8463        18.3222      
      3200   302.58857     -42610.022      5775.9964      3885.8921      15.3172        13.8463        18.3222      
      3300   283.85337     -42613.415      409.07536      3885.8921      15.3172        13.8463        18.3222      
      3400   276.62443     -42609.38      -5144.495       3885.8921      15.3172        13.8463        18.3222      
      3500   292.35319     -42619.355     -1410.7217      3885.8921      15.3172        13.8463        18.3222      
      3600   306.20193     -42602.224     -900.31777      3885.8921      15.3172        13.8463        18.3222      
      3700   307.17397     -42581.332     -141.87288      3885.8921      15.3172        13.8463        18.3222      
      3800   307.82213     -42598.237     -8729.9145      3885.8921      15.3172        13.8463        18.3222      
      3900   292.77944     -42613.796     -15316.475      3885.8921      15.3172        13.8463        18.3222      
      4000   302.07703     -42617.442     -28458.751      3885.8921      15.3172        13.8463        18.3222      
      4100   326.18443     -42622.305      739.66924      3885.8921      15.3172        13.8463        18.3222      
      4200   296.50096     -42590.482      6232.5063      3885.8921      15.3172        13.8463        18.3222      
      4300   290.98565     -42605.123     -2154.4045      3885.8921      15.3172        13.8463        18.3222      
      4400   268.87254     -42592.043     -2351.6381      3885.8921      15.3172        13.8463        18.3222      
      4500   298.46495     -42588.831     -11364.377      3885.8921      15.3172        13.8463        18.3222      
      4600   308.62527     -42573.893     -1627.66        3885.8921      15.3172        13.8463        18.3222      
      4700   319.04274     -42591.658      598.06523      3885.8921      15.3172        13.8463        18.3222      
      4800   306.40731     -42598.744     -6684.1103      3885.8921      15.3172        13.8463        18.3222      
      4900   309.48316     -42613.844     -12.388623      3885.8921      15.3172        13.8463        18.3222      
      5000   302.43017     -42612.805     -9153.032       3885.8921      15.3172        13.8463        18.3222      
Loop time of 156.051 on 8 procs for 5000 steps with 365 atoms

Performance: 1.384 ns/day, 17.339 hours/ns, 32.041 timesteps/s, 11.695 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 124.49     | 127.04     | 128.75     |  11.4 | 81.41
Bond    | 0.0011134  | 0.0012472  | 0.0013581  |   0.3 |  0.00
Neigh   | 10.03      | 10.553     | 10.873     |   9.1 |  6.76
Comm    | 1.4267     | 3.1363     | 5.6976     |  72.9 |  2.01
Output  | 0.010171   | 0.011785   | 0.01322    |   0.9 |  0.01
Modify  | 14.879     | 15.21      | 15.743     |   7.7 |  9.75
Other   |            | 0.09631    |            |       |  0.06

Nlocal:         45.625 ave          50 max          42 min
Histogram: 1 0 1 2 0 2 1 0 0 1
Nghost:        3188.12 ave        3227 max        3161 min
Histogram: 1 1 1 2 0 1 1 0 0 1
Neighs:        29945.4 ave       32646 max       27898 min
Histogram: 1 0 1 2 2 1 0 0 0 1

Total # of neighbors = 239563
Ave neighs/atom = 656.33699
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:52:57
