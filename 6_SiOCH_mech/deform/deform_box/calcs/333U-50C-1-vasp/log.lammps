LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.1                  # the deformation magnitude 0.01

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-1-vasp
read_data       ${structure}.data
read_data       333U-50C-1-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.007 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 4.67715e-05 on 8 procs for 1 steps with 362 atoms

48.4% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.5e-07    | 2.1038e-07 | 3e-07      |   0.0 |  0.45
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 1.264e-06  | 1.4379e-06 | 1.595e-06  |   0.0 |  3.07
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 4.512e-05  |            |       | 96.48

Nlocal:          45.25 ave          51 max          37 min
Histogram: 1 0 0 1 1 1 0 2 1 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-1-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 5000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -7.38 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.5 | 130.8 | 131.9 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -40664.228      99992.787      1.6616584      3964.6564    
       100   740.8413      -41529.586     -10865.282      1.6616584      3964.6564    
       200   483.66151     -41655.737     -15689.13       1.6616584      3964.6564    
       300   445.20455     -41908.367     -20086.048      1.6616584      3964.6564    
       400   388.33782     -42054.271      11136.418      1.6616584      3964.6564    
       500   329.4184      -42142.088      1460.1216      1.6616584      3964.6564    
       600   278.92129     -42178.288     -10564.38       1.6616584      3964.6564    
       700   274.89052     -42217.21       1651.2021      1.6616584      3964.6564    
       800   295.35122     -42234.634     -1371.6273      1.6616584      3964.6564    
       900   308.63426     -42232.201     -4233.001       1.6616584      3964.6564    
      1000   306.87897     -42240.663     -9968.0073      1.6616584      3964.6564    
      1100   301.70722     -42259.421     -3096.0581      1.6616584      3964.6564    
      1200   301.75541     -42275.705     -31783.501      1.6616584      3964.6564    
      1300   299.28222     -42282.522     -3771.6584      1.6616584      3964.6564    
      1400   280.0515      -42257.507      2888.2296      1.6616584      3964.6564    
      1500   307.35524     -42271.036      248.29954      1.6616584      3964.6564    
      1600   313.16546     -42263.909      258.13097      1.6616584      3964.6564    
      1700   314.2632      -42265.192      10465          1.6616584      3964.6564    
      1800   295.97837     -42270.323     -2079.0797      1.6616584      3964.6564    
      1900   286.24232     -42287.526     -3593.7428      1.6616584      3964.6564    
      2000   282.68742     -42286.447     -9664.1942      1.6616584      3964.6564    
      2100   294.16539     -42277.253      3492.2615      1.6616584      3964.6564    
      2200   330.79624     -42297.306      1561.8081      1.6616584      3964.6564    
      2300   316.43258     -42281.803     -3572.4911      1.6616584      3964.6564    
      2400   312.45939     -42297.506      3447.6242      1.6616584      3964.6564    
      2500   281.33349     -42289.628     -8198.8405      1.6616584      3964.6564    
      2600   275.7291      -42297.408     -8755.4062      1.6616584      3964.6564    
      2700   293.43592     -42311.035     -7631.5465      1.6616584      3964.6564    
      2800   309.48118     -42314.11      -17299.58       1.6616584      3964.6564    
      2900   317.13087     -42309.86      -5088.916       1.6616584      3964.6564    
      3000   291.54158     -42294.28      -1663.4264      1.6616584      3964.6564    
      3100   294.33162     -42313.203     -5606.8464      1.6616584      3964.6564    
      3200   301.35088     -42320.004     -12870.979      1.6616584      3964.6564    
      3300   287.36911     -42300.593      483.3653       1.6616584      3964.6564    
      3400   313.08685     -42313.3        1598.0432      1.6616584      3964.6564    
      3500   309.91459     -42306.145     -2928.8527      1.6616584      3964.6564    
      3600   286.23757     -42296.313     -12376.507      1.6616584      3964.6564    
      3700   301.84671     -42324.247      3837.5766      1.6616584      3964.6564    
      3800   291.40611     -42321.143     -189.73749      1.6616584      3964.6564    
      3900   313.1501      -42339.956     -7871.5052      1.6616584      3964.6564    
      4000   295.71932     -42317.99       5219.7316      1.6616584      3964.6564    
      4100   310.14811     -42335.494     -954.25798      1.6616584      3964.6564    
      4200   293.04501     -42326.463     -4279.9986      1.6616584      3964.6564    
      4300   299.84405     -42338.687     -3911.1009      1.6616584      3964.6564    
      4400   300.7553      -42339.921      1204.5305      1.6616584      3964.6564    
      4500   321.16134     -42349.961      12073.522      1.6616584      3964.6564    
      4600   277.32161     -42294.447     -11205.064      1.6616584      3964.6564    
      4700   314.56801     -42324.146      369.67744      1.6616584      3964.6564    
      4800   287.49334     -42309.86       2129.5009      1.6616584      3964.6564    
      4900   306.58406     -42355.225     -16500.956      1.6616584      3964.6564    
      5000   288.189       -42338.464     -6308.4104      1.6616584      3964.6564    
Loop time of 251.897 on 8 procs for 5000 steps with 362 atoms

Performance: 0.857 ns/day, 27.989 hours/ns, 19.849 timesteps/s, 7.185 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 148.74     | 201.74     | 211.3      | 141.3 | 80.09
Bond    | 0.0018063  | 0.0022018  | 0.0025213  |   0.5 |  0.00
Neigh   | 10.8       | 15.121     | 16.515     |  42.8 |  6.00
Comm    | 4.2347     | 13.794     | 66.775     | 540.1 |  5.48
Output  | 0.0028611  | 0.0031151  | 0.0047691  |   1.1 |  0.00
Modify  | 19.74      | 21.133     | 25.485     |  36.5 |  8.39
Other   |            | 0.1028     |            |       |  0.04

Nlocal:          45.25 ave          52 max          39 min
Histogram: 1 1 0 2 1 0 1 0 1 1
Nghost:        3370.75 ave        3406 max        3344 min
Histogram: 1 2 1 0 1 0 1 1 0 1
Neighs:        28834.8 ave       32933 max       25046 min
Histogram: 1 1 0 2 1 0 1 0 1 1

Total # of neighbors = 230678
Ave neighs/atom = 637.23204
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333U-50C-1-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 17.1722
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.1279
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.5867

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.3027
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 0.0305
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -8.382

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 17.1722
variable dlen equal lx-${len0}
variable dlen equal lx-17.1722
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.1722
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3819999999999996732, deltaxy = 0.8382
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.030499999999999999334, deltaxz = -0.00305
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.3027000000000000246, deltayz = -0.03027
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.71722 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.71722 xy delta 0.8382 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.71722 xy delta 0.8382 xz delta -0.00305 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 131.1 | 131.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.189       -42338.464     -6308.3891      3964.6564      17.1722        13.1279        17.5867      
       100   315.90756     -42338.788     -1574.4555      3956.7271      17.137856      13.1279        17.5867      
       200   325.04337     -42317.88      -7937.1639      3948.7978      17.103511      13.1279        17.5867      
       300   295.25535     -42303.073     -4681.9444      3940.8684      17.069167      13.1279        17.5867      
       400   296.0989      -42321.76      -2369.5741      3932.9391      17.034822      13.1279        17.5867      
       500   286.45715     -42323.541      2324.0087      3925.0098      17.000478      13.1279        17.5867      
       600   289.36836     -42325.203     -3019.3966      3917.0805      16.966134      13.1279        17.5867      
       700   291.2715      -42342.204      10042.671      3909.1512      16.931789      13.1279        17.5867      
       800   281.49684     -42351.213     -6949.3736      3901.2219      16.897445      13.1279        17.5867      
       900   285.30029     -42347.552     -7681.3389      3893.2926      16.8631        13.1279        17.5867      
      1000   324.87712     -42367.934      4543.1418      3885.3633      16.828756      13.1279        17.5867      
      1100   316.39173     -42357.657     -3685.3094      3877.4339      16.794412      13.1279        17.5867      
      1200   309.4276      -42370.656      4906.7022      3869.5046      16.760067      13.1279        17.5867      
      1300   291.58895     -42350.9       -5885.205       3861.5753      16.725723      13.1279        17.5867      
      1400   324.94047     -42389.6        9623.6864      3853.646       16.691378      13.1279        17.5867      
      1500   289.3123      -42362.556     -1100.1711      3845.7167      16.657034      13.1279        17.5867      
      1600   277.67173     -42347.798      19003.714      3837.7874      16.62269       13.1279        17.5867      
      1700   309.92416     -42367.52       9505.333       3829.8581      16.588345      13.1279        17.5867      
      1800   294.0343      -42364.682      14226.05       3821.9288      16.554001      13.1279        17.5867      
      1900   286.25064     -42360.022      90.694008      3813.9994      16.519656      13.1279        17.5867      
      2000   284.90553     -42352.308      13321.364      3806.0701      16.485312      13.1279        17.5867      
      2100   297.957       -42361.227      4589.4531      3798.1408      16.450968      13.1279        17.5867      
      2200   312.32806     -42391.961     -2854.1489      3790.2115      16.416623      13.1279        17.5867      
      2300   295.0264      -42381.998      28108.221      3782.2822      16.382279      13.1279        17.5867      
      2400   281.66326     -42362.587      29077.118      3774.3529      16.347934      13.1279        17.5867      
      2500   291.64564     -42351.542      12604.927      3766.4236      16.31359       13.1279        17.5867      
      2600   301.79327     -42324.529      14375.357      3758.4943      16.279246      13.1279        17.5867      
      2700   297.31681     -42329.262      16318.982      3750.5649      16.244901      13.1279        17.5867      
      2800   304.73158     -42356.593      13462.721      3742.6356      16.210557      13.1279        17.5867      
      2900   295.924       -42363.906      24949.573      3734.7063      16.176212      13.1279        17.5867      
      3000   303.88493     -42375.052      7130.6444      3726.777       16.141868      13.1279        17.5867      
      3100   298.24443     -42373.205      11787.336      3718.8477      16.107524      13.1279        17.5867      
      3200   298.45345     -42378.312      17656.359      3710.9184      16.073179      13.1279        17.5867      
      3300   286.6748      -42375.249      16167.056      3702.9891      16.038835      13.1279        17.5867      
      3400   282.64195     -42356.333      16950.196      3695.0598      16.00449       13.1279        17.5867      
      3500   312.82602     -42350.66       21542.487      3687.1304      15.970146      13.1279        17.5867      
      3600   303.60932     -42330.729      24896.408      3679.2011      15.935802      13.1279        17.5867      
      3700   315.21093     -42345.262      16138.911      3671.2718      15.901457      13.1279        17.5867      
      3800   301.11453     -42352.912      21407.911      3663.3425      15.867113      13.1279        17.5867      
      3900   299.86521     -42343.619      9865.6317      3655.4132      15.832768      13.1279        17.5867      
      4000   303.2057      -42339.867      25248.02       3647.4839      15.798424      13.1279        17.5867      
      4100   296.02384     -42337.704      25398.287      3639.5546      15.76408       13.1279        17.5867      
      4200   298.40738     -42346.726      8849.3233      3631.6252      15.729735      13.1279        17.5867      
      4300   282.94028     -42333.026      18758.401      3623.6959      15.695391      13.1279        17.5867      
      4400   311.90657     -42353.767      5599.931       3615.7666      15.661046      13.1279        17.5867      
      4500   301.36153     -42337.164      9436.1377      3607.8373      15.626702      13.1279        17.5867      
      4600   306.66056     -42343.048      31252.007      3599.908       15.592358      13.1279        17.5867      
      4700   308.53482     -42335.108      17252.593      3591.9787      15.558013      13.1279        17.5867      
      4800   298.80163     -42324.437      16744.074      3584.0494      15.523669      13.1279        17.5867      
      4900   290.66765     -42306.138      33222.044      3576.1201      15.489324      13.1279        17.5867      
      5000   318.06046     -42329.149      19807.33       3568.1907      15.45498       13.1279        17.5867      
Loop time of 273.081 on 8 procs for 5000 steps with 362 atoms

Performance: 0.791 ns/day, 30.342 hours/ns, 18.310 timesteps/s, 6.628 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 181.85     | 213.3      | 226.84     |  95.6 | 78.11
Bond    | 0.0018237  | 0.0022187  | 0.0025776  |   0.5 |  0.00
Neigh   | 13.609     | 16.351     | 17.964     |  32.3 |  5.99
Comm    | 6.407      | 19.892     | 51.382     | 313.4 |  7.28
Output  | 0.016589   | 0.01957    | 0.022568   |   1.4 |  0.01
Modify  | 21.727     | 23.409     | 26.12      |  26.9 |  8.57
Other   |            | 0.1124     |            |       |  0.04

Nlocal:          45.25 ave          49 max          40 min
Histogram: 1 0 1 0 1 2 0 0 1 2
Nghost:        3560.75 ave        3590 max        3532 min
Histogram: 1 0 2 2 0 0 0 0 1 2
Neighs:        32037.9 ave       34767 max       28235 min
Histogram: 1 0 1 0 1 2 0 0 1 2

Total # of neighbors = 256303
Ave neighs/atom = 708.01934
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.1722
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.71722 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.71722 xy delta -0.8382 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.71722 xy delta -0.8382 xz delta 0.00305 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 131.1 | 132 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.189       -42338.464     -6308.3891      3964.6564      17.1722        13.1279        17.5867      
       100   315.94021     -42339.765     -1573.7933      3972.5857      17.206544      13.1279        17.5867      
       200   335.94575     -42331.529     -7669.6823      3980.515       17.240889      13.1279        17.5867      
       300   286.6443      -42288.217     -5823.1804      3988.4443      17.275233      13.1279        17.5867      
       400   299.95477     -42325.974      1291.1971      3996.3736      17.309578      13.1279        17.5867      
       500   282.69002     -42315.073     -7493.8369      4004.3029      17.343922      13.1279        17.5867      
       600   296.25963     -42318.357      1648.2252      4012.2323      17.378266      13.1279        17.5867      
       700   288.11493     -42310.673      8974.8892      4020.1616      17.412611      13.1279        17.5867      
       800   316.85968     -42360.809     -14359.606      4028.0909      17.446955      13.1279        17.5867      
       900   289.39072     -42343.197      428.51203      4036.0202      17.4813        13.1279        17.5867      
      1000   299.32404     -42342.877     -1227.4904      4043.9495      17.515644      13.1279        17.5867      
      1100   323.146       -42343.376     -10774.673      4051.8788      17.549988      13.1279        17.5867      
      1200   339.71193     -42329.593     -11516.437      4059.8081      17.584333      13.1279        17.5867      
      1300   315.79468     -42318.907     -5159.7118      4067.7375      17.618677      13.1279        17.5867      
      1400   301.75666     -42332.994     -11873.435      4075.6668      17.653022      13.1279        17.5867      
      1500   315.9442      -42363.634     -15364.695      4083.5961      17.687366      13.1279        17.5867      
      1600   290.31382     -42344.03      -4729.601       4091.5254      17.72171       13.1279        17.5867      
      1700   297.64387     -42341.679     -3997.9274      4099.4547      17.756055      13.1279        17.5867      
      1800   319.47555     -42333.943     -9168.8718      4107.384       17.790399      13.1279        17.5867      
      1900   327.84213     -42312.142     -8808.7918      4115.3133      17.824744      13.1279        17.5867      
      2000   325.64605     -42332.605     -25600.821      4123.2426      17.859088      13.1279        17.5867      
      2100   296.71856     -42309.907     -11208.329      4131.172       17.893432      13.1279        17.5867      
      2200   297.77742     -42326.089     -5129.8332      4139.1013      17.927777      13.1279        17.5867      
      2300   271.22024     -42306.911     -8976.7446      4147.0306      17.962121      13.1279        17.5867      
      2400   293.88861     -42325.355     -17493.564      4154.9599      17.996466      13.1279        17.5867      
      2500   289.86747     -42320.186     -11900.262      4162.8892      18.03081       13.1279        17.5867      
      2600   278.33152     -42326.887     -9641.8842      4170.8185      18.065154      13.1279        17.5867      
      2700   285.54003     -42333.273     -17847.552      4178.7478      18.099499      13.1279        17.5867      
      2800   302.10219     -42311.475     -14712.031      4186.6771      18.133843      13.1279        17.5867      
      2900   288.1407      -42275.603     -11488.358      4194.6065      18.168188      13.1279        17.5867      
      3000   291.73455     -42276.612     -22031.242      4202.5358      18.202532      13.1279        17.5867      
      3100   307.52185     -42301.948     -8010.3743      4210.4651      18.236876      13.1279        17.5867      
      3200   277.15534     -42287.673     -6280.562       4218.3944      18.271221      13.1279        17.5867      
      3300   310.70952     -42306.671     -6962.7432      4226.3237      18.305565      13.1279        17.5867      
      3400   287.34377     -42286.567     -8955.3042      4234.253       18.33991       13.1279        17.5867      
      3500   279.87865     -42282.774     -22240.384      4242.1823      18.374254      13.1279        17.5867      
      3600   302.27554     -42290.626     -1926.1916      4250.1116      18.408598      13.1279        17.5867      
      3700   306.72749     -42310.385     -14525.407      4258.041       18.442943      13.1279        17.5867      
      3800   296.76655     -42308.087     -13535.111      4265.9703      18.477287      13.1279        17.5867      
      3900   303.48375     -42304.958     -15197.189      4273.8996      18.511632      13.1279        17.5867      
      4000   304.19847     -42284.84      -15138.269      4281.8289      18.545976      13.1279        17.5867      
      4100   329.71937     -42274.122      3176.8583      4289.7582      18.58032       13.1279        17.5867      
      4200   313.18646     -42265.341     -11389.733      4297.6875      18.614665      13.1279        17.5867      
      4300   313.68316     -42289.496     -19484.006      4305.6168      18.649009      13.1279        17.5867      
      4400   300.15961     -42270.25      -12128.492      4313.5461      18.683354      13.1279        17.5867      
      4500   291.32304     -42260.366     -9643.9075      4321.4755      18.717698      13.1279        17.5867      
      4600   288.31761     -42256.428     -14023.641      4329.4048      18.752042      13.1279        17.5867      
      4700   281.64434     -42266.455     -19122.769      4337.3341      18.786387      13.1279        17.5867      
      4800   284.58856     -42269.435     -2477.2274      4345.2634      18.820731      13.1279        17.5867      
      4900   305.89931     -42266.312     -4445.1255      4353.1927      18.855076      13.1279        17.5867      
      5000   305.65452     -42228.162     -12542.989      4361.122       18.88942       13.1279        17.5867      
Loop time of 239.516 on 8 procs for 5000 steps with 362 atoms

Performance: 0.902 ns/day, 26.613 hours/ns, 20.875 timesteps/s, 7.557 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 138.64     | 183.85     | 200.52     | 192.4 | 76.76
Bond    | 0.0016614  | 0.0021623  | 0.0025261  |   0.7 |  0.00
Neigh   | 10.51      | 13.982     | 15.601     |  53.3 |  5.84
Comm    | 3.6578     | 20.323     | 65.534     | 578.8 |  8.49
Output  | 0.017906   | 0.020396   | 0.022806   |   1.1 |  0.01
Modify  | 19.599     | 21.227     | 24.709     |  43.3 |  8.86
Other   |            | 0.1095     |            |       |  0.05

Nlocal:          45.25 ave          51 max          37 min
Histogram: 1 0 0 1 1 1 0 2 0 2
Nghost:        3201.12 ave        3226 max        3182 min
Histogram: 1 1 0 2 2 0 1 0 0 1
Neighs:          26163 ave       29240 max       21501 min
Histogram: 1 0 0 1 1 0 1 2 0 2

Total # of neighbors = 209304
Ave neighs/atom = 578.18785
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.1279
variable dlen equal ly-${len0}
variable dlen equal ly-13.1279
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.1279
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3819999999999996732, deltaxy = 0.8382
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.030499999999999999334, deltaxz = -0.00305
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.3027000000000000246, deltayz = -0.03027
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.31279 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.31279 yz delta -0.03027 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 131.1 | 131.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.189       -42338.464     -6308.3891      3964.6564      17.1722        13.1279        17.5867      
       100   316.12291     -42338.704     -1637.6789      3956.7271      17.1722        13.101644      17.5867      
       200   329.72829     -42323.061     -7486.8279      3948.7978      17.1722        13.075388      17.5867      
       300   296.69835     -42301.622     -6785.9269      3940.8684      17.1722        13.049133      17.5867      
       400   300.22033     -42330.916      932.68998      3932.9391      17.1722        13.022877      17.5867      
       500   292.22291     -42330.641      8441.4577      3925.0098      17.1722        12.996621      17.5867      
       600   310.58373     -42356.244     -19094.766      3917.0805      17.1722        12.970365      17.5867      
       700   298.51661     -42356.806     -3064.2408      3909.1512      17.1722        12.944109      17.5867      
       800   282.50196     -42366.705     -1110.1607      3901.2219      17.1722        12.917854      17.5867      
       900   291.39475     -42364.848     -3395.3764      3893.2926      17.1722        12.891598      17.5867      
      1000   301.94708     -42358.427      1065.4995      3885.3633      17.1722        12.865342      17.5867      
      1100   294.64416     -42332.358      9551.323       3877.4339      17.1722        12.839086      17.5867      
      1200   320.01829     -42342.008      3996.7377      3869.5046      17.1722        12.81283       17.5867      
      1300   314.09186     -42343.518     -4968.5725      3861.5753      17.1722        12.786575      17.5867      
      1400   309.35044     -42345.762      9255.6541      3853.646       17.1722        12.760319      17.5867      
      1500   301.44859     -42352.875      21252.535      3845.7167      17.1722        12.734063      17.5867      
      1600   277.4571      -42336.987      15482.477      3837.7874      17.1722        12.707807      17.5867      
      1700   297.00235     -42360.471      15713.78       3829.8581      17.1722        12.681551      17.5867      
      1800   302.94375     -42360.54       9375.8275      3821.9288      17.1722        12.655296      17.5867      
      1900   294.28444     -42339.356      13653.926      3813.9994      17.1722        12.62904       17.5867      
      2000   290.41018     -42350.979      13373.954      3806.0701      17.1722        12.602784      17.5867      
      2100   278.82542     -42350.175      17265.183      3798.1408      17.1722        12.576528      17.5867      
      2200   300.83457     -42365.512     -3661.8012      3790.2115      17.1722        12.550272      17.5867      
      2300   322.00086     -42354.714      4973.0691      3782.2822      17.1722        12.524017      17.5867      
      2400   318.58919     -42337.42       25626.491      3774.3529      17.1722        12.497761      17.5867      
      2500   306.97871     -42363.436      8054.3667      3766.4236      17.1722        12.471505      17.5867      
      2600   282.87796     -42344.46       21459.266      3758.4943      17.1722        12.445249      17.5867      
      2700   316.0821      -42366.566      16423.647      3750.5649      17.1722        12.418993      17.5867      
      2800   319.72217     -42368.517     -650.49738      3742.6356      17.1722        12.392738      17.5867      
      2900   295.32739     -42352.001      14973.956      3734.7063      17.1722        12.366482      17.5867      
      3000   290.48975     -42358.974      8697.807       3726.777       17.1722        12.340226      17.5867      
      3100   287.45366     -42360.349      16447.899      3718.8477      17.1722        12.31397       17.5867      
      3200   293.4001      -42345.761      25749.224      3710.9184      17.1722        12.287714      17.5867      
      3300   292.29342     -42308.096      12835.517      3702.9891      17.1722        12.261459      17.5867      
      3400   298.75883     -42297.414      14102.237      3695.0598      17.1722        12.235203      17.5867      
      3500   312.29322     -42336.539      15641.094      3687.1304      17.1722        12.208947      17.5867      
      3600   289.2621      -42321.955      28767.296      3679.2011      17.1722        12.182691      17.5867      
      3700   285.91107     -42302.428      31785.584      3671.2718      17.1722        12.156435      17.5867      
      3800   306.54557     -42305.756      20808.516      3663.3425      17.1722        12.13018       17.5867      
      3900   324.61543     -42304.934      33179.208      3655.4132      17.1722        12.103924      17.5867      
      4000   306.25792     -42300.258      15665.431      3647.4839      17.1722        12.077668      17.5867      
      4100   301.88928     -42311.31       21078.305      3639.5546      17.1722        12.051412      17.5867      
      4200   295.29519     -42298.944      31634.294      3631.6252      17.1722        12.025156      17.5867      
      4300   316.5391      -42306.402      16575.645      3623.6959      17.1722        11.998901      17.5867      
      4400   314.10478     -42282.625      33566.586      3615.7666      17.1722        11.972645      17.5867      
      4500   316.29703     -42268.711      16412.723      3607.8373      17.1722        11.946389      17.5867      
      4600   309.46264     -42261.485      29912.525      3599.908       17.1722        11.920133      17.5867      
      4700   301.83566     -42273.219      36222.157      3591.9787      17.1722        11.893877      17.5867      
      4800   320.40184     -42292.548      27072.796      3584.0494      17.1722        11.867622      17.5867      
      4900   275.02218     -42240.015      23006.805      3576.1201      17.1722        11.841366      17.5867      
      5000   301.12818     -42252.792      35311.187      3568.1907      17.1722        11.81511       17.5867      
Loop time of 276.873 on 8 procs for 5000 steps with 362 atoms

Performance: 0.780 ns/day, 30.764 hours/ns, 18.059 timesteps/s, 6.537 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 163.98     | 217.73     | 233.72     | 172.1 | 78.64
Bond    | 0.0017011  | 0.002225   | 0.0026418  |   0.7 |  0.00
Neigh   | 11.979     | 15.957     | 17.524     |  47.1 |  5.76
Comm    | 4.0999     | 20.082     | 73.847     | 566.9 |  7.25
Output  | 0.01791    | 0.02071    | 0.023326   |   1.2 |  0.01
Modify  | 21.399     | 22.962     | 26.943     |  39.3 |  8.29
Other   |            | 0.115      |            |       |  0.04

Nlocal:          45.25 ave          48 max          42 min
Histogram: 1 0 0 2 0 2 1 0 0 2
Nghost:        3742.88 ave        3792 max        3682 min
Histogram: 1 0 1 1 0 0 3 0 1 1
Neighs:        32114.1 ave       34229 max       29918 min
Histogram: 1 0 1 1 2 0 1 0 0 2

Total # of neighbors = 256913
Ave neighs/atom = 709.70442
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.1279
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.31279 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.31279 yz delta 0.03027 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 131.1 | 132 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.189       -42338.464     -6308.3891      3964.6564      17.1722        13.1279        17.5867      
       100   315.72263     -42339.732     -1529.8622      3972.5857      17.1722        13.154156      17.5867      
       200   333.00544     -42327.606     -11571.859      3980.515       17.1722        13.180412      17.5867      
       300   295.77609     -42301.949     -8059.8681      3988.4443      17.1722        13.206667      17.5867      
       400   285.61039     -42305.464     -5867.6436      3996.3736      17.1722        13.232923      17.5867      
       500   294.27201     -42321.627     -14173.873      4004.3029      17.1722        13.259179      17.5867      
       600   299.3809      -42326.422     -5432.2766      4012.2323      17.1722        13.285435      17.5867      
       700   287.76687     -42329.9        3709.2083      4020.1616      17.1722        13.311691      17.5867      
       800   283.72384     -42359.458     -11340.528      4028.0909      17.1722        13.337946      17.5867      
       900   273.83615     -42342.141     -10842.148      4036.0202      17.1722        13.364202      17.5867      
      1000   291.31622     -42334.796     -9907.4986      4043.9495      17.1722        13.390458      17.5867      
      1100   303.32196     -42322.155     -17364.188      4051.8788      17.1722        13.416714      17.5867      
      1200   300.78852     -42303.284     -4908.4948      4059.8081      17.1722        13.44297       17.5867      
      1300   280.87536     -42296.871     -13509.919      4067.7375      17.1722        13.469225      17.5867      
      1400   300.08508     -42342.038     -7348.4194      4075.6668      17.1722        13.495481      17.5867      
      1500   305.09524     -42340.02      -10321.672      4083.5961      17.1722        13.521737      17.5867      
      1600   301.57866     -42317.393     -7490.0951      4091.5254      17.1722        13.547993      17.5867      
      1700   301.62949     -42301.89      -13947.806      4099.4547      17.1722        13.574249      17.5867      
      1800   285.71665     -42282.341     -15182.313      4107.384       17.1722        13.600504      17.5867      
      1900   306.16373     -42308.089     -14592.385      4115.3133      17.1722        13.62676       17.5867      
      2000   305.13827     -42309.703     -5479.513       4123.2426      17.1722        13.653016      17.5867      
      2100   313.44377     -42321.931     -24510.128      4131.172       17.1722        13.679272      17.5867      
      2200   314.3922      -42322.127     -16670.866      4139.1013      17.1722        13.705528      17.5867      
      2300   293.73396     -42306.396     -12506.03       4147.0306      17.1722        13.731783      17.5867      
      2400   269.13668     -42306.732     -12435.219      4154.9599      17.1722        13.758039      17.5867      
      2500   274.49544     -42308.288     -2129.8348      4162.8892      17.1722        13.784295      17.5867      
      2600   294.25809     -42297.485     -2134.9455      4170.8185      17.1722        13.810551      17.5867      
      2700   312.27968     -42298.032     -23037.572      4178.7478      17.1722        13.836807      17.5867      
      2800   304.44905     -42291.067     -5171.5779      4186.6771      17.1722        13.863062      17.5867      
      2900   316.50667     -42319.912     -19534.318      4194.6065      17.1722        13.889318      17.5867      
      3000   301.50552     -42305.48      -23873.719      4202.5358      17.1722        13.915574      17.5867      
      3100   297.11704     -42293.218     -13457.981      4210.4651      17.1722        13.94183       17.5867      
      3200   312.03712     -42297.546     -12816.126      4218.3944      17.1722        13.968086      17.5867      
      3300   295.05689     -42271.199     -2549.1389      4226.3237      17.1722        13.994341      17.5867      
      3400   290.92789     -42271.923     -7533.0527      4234.253       17.1722        14.020597      17.5867      
      3500   288.21801     -42291.589     -25072.053      4242.1823      17.1722        14.046853      17.5867      
      3600   287.33989     -42290.121     -14921.05       4250.1116      17.1722        14.073109      17.5867      
      3700   283.37881     -42260.57      -16906.436      4258.041       17.1722        14.099365      17.5867      
      3800   325.06626     -42262.631     -11462.685      4265.9703      17.1722        14.12562       17.5867      
      3900   315.39938     -42257.435     -6063.8412      4273.8996      17.1722        14.151876      17.5867      
      4000   303.57299     -42258.376     -18911.104      4281.8289      17.1722        14.178132      17.5867      
      4100   313.33245     -42274.335     -16196.091      4289.7582      17.1722        14.204388      17.5867      
      4200   305.39295     -42268.98      -15171.74       4297.6875      17.1722        14.230644      17.5867      
      4300   266.56028     -42241.947     -15303.177      4305.6168      17.1722        14.256899      17.5867      
      4400   277.58307     -42282.942     -14471.455      4313.5461      17.1722        14.283155      17.5867      
      4500   279.18985     -42282.67      -23756.579      4321.4755      17.1722        14.309411      17.5867      
      4600   307.84035     -42283.428     -18647.524      4329.4048      17.1722        14.335667      17.5867      
      4700   297.25682     -42256.342     -16121.067      4337.3341      17.1722        14.361923      17.5867      
      4800   298.37521     -42232.151     -26770.565      4345.2634      17.1722        14.388178      17.5867      
      4900   321.51323     -42231.462     -20479.862      4353.1927      17.1722        14.414434      17.5867      
      5000   323.01097     -42235.775     -16874.546      4361.122       17.1722        14.44069       17.5867      
Loop time of 233.979 on 8 procs for 5000 steps with 362 atoms

Performance: 0.923 ns/day, 25.998 hours/ns, 21.369 timesteps/s, 7.736 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 138.07     | 178.62     | 195.71     | 175.7 | 76.34
Bond    | 0.0017148  | 0.0021804  | 0.0025439  |   0.6 |  0.00
Neigh   | 10.41      | 13.428     | 15.133     |  50.5 |  5.74
Comm    | 3.9588     | 21.045     | 61.595     | 511.8 |  8.99
Output  | 0.017885   | 0.020057   | 0.022219   |   1.0 |  0.01
Modify  | 19.058     | 20.76      | 23.789     |  40.7 |  8.87
Other   |            | 0.1081     |            |       |  0.05

Nlocal:          45.25 ave          51 max          38 min
Histogram: 1 0 1 0 1 2 0 0 2 1
Nghost:        3047.38 ave        3084 max        3018 min
Histogram: 3 0 0 0 0 1 3 0 0 1
Neighs:        26160.6 ave       29258 max       22257 min
Histogram: 1 0 1 0 1 2 0 0 2 1

Total # of neighbors = 209285
Ave neighs/atom = 578.13536
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.5867
variable dlen equal lz-${len0}
variable dlen equal lz-17.5867
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.5867
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3819999999999996732, deltaxy = 0.8382
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.030499999999999999334, deltaxz = -0.00305
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.3027000000000000246, deltayz = -0.03027
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -1.75867 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 131.1 | 131.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.189       -42338.464     -6308.3891      3964.6564      17.1722        13.1279        17.5867      
       100   316.01503     -42339.148     -1604.1686      3956.7271      17.1722        13.1279        17.551527    
       200   332.8658      -42325.325     -6563.1895      3948.7978      17.1722        13.1279        17.516353    
       300   289.64427     -42293.836     -2544.7155      3940.8684      17.1722        13.1279        17.48118     
       400   286.56231     -42312.868      2532.6323      3932.9391      17.1722        13.1279        17.446006    
       500   290.0551      -42329.192     -8986.7953      3925.0098      17.1722        13.1279        17.410833    
       600   296.09404     -42337.3        8504.4342      3917.0805      17.1722        13.1279        17.37566     
       700   300.41144     -42347.357     -457.70636      3909.1512      17.1722        13.1279        17.340486    
       800   295.30961     -42371.923     -11295.285      3901.2219      17.1722        13.1279        17.305313    
       900   273.45584     -42344.181      6091.9288      3893.2926      17.1722        13.1279        17.270139    
      1000   295.09509     -42342.038      3240.9736      3885.3633      17.1722        13.1279        17.234966    
      1100   292.88647     -42314.25      -3329.927       3877.4339      17.1722        13.1279        17.199793    
      1200   288.76793     -42317.378      7062.8287      3869.5046      17.1722        13.1279        17.164619    
      1300   304.54342     -42355.644     -2753.2676      3861.5753      17.1722        13.1279        17.129446    
      1400   303.00631     -42368.804     -3316.5671      3853.646       17.1722        13.1279        17.094272    
      1500   306.33078     -42363.942      865.64663      3845.7167      17.1722        13.1279        17.059099    
      1600   298.1627      -42353.053      340.78097      3837.7874      17.1722        13.1279        17.023926    
      1700   300.89924     -42355.845      11535.974      3829.8581      17.1722        13.1279        16.988752    
      1800   312.62566     -42344.723      13303.637      3821.9288      17.1722        13.1279        16.953579    
      1900   298.25344     -42317.81       1569.2362      3813.9994      17.1722        13.1279        16.918405    
      2000   288.12079     -42325.046     -2068.1089      3806.0701      17.1722        13.1279        16.883232    
      2100   291.59124     -42342.224      3943.0735      3798.1408      17.1722        13.1279        16.848059    
      2200   285.31356     -42332.146     -257.17502      3790.2115      17.1722        13.1279        16.812885    
      2300   299.73366     -42336.37       11579.195      3782.2822      17.1722        13.1279        16.777712    
      2400   296.47257     -42325.606     -1309.291       3774.3529      17.1722        13.1279        16.742538    
      2500   273.58149     -42289.052      7833.1458      3766.4236      17.1722        13.1279        16.707365    
      2600   313.27684     -42325.857      17997.547      3758.4943      17.1722        13.1279        16.672192    
      2700   287.426       -42305.214      18676.367      3750.5649      17.1722        13.1279        16.637018    
      2800   287.71271     -42311.928      5110.085       3742.6356      17.1722        13.1279        16.601845    
      2900   288.30791     -42345.373      20117.638      3734.7063      17.1722        13.1279        16.566671    
      3000   277.27533     -42334.337      14622.989      3726.777       17.1722        13.1279        16.531498    
      3100   303.75282     -42337.855      11713.1        3718.8477      17.1722        13.1279        16.496325    
      3200   303.39898     -42324.471      4494.6939      3710.9184      17.1722        13.1279        16.461151    
      3300   296.67425     -42309.074     -472.08979      3702.9891      17.1722        13.1279        16.425978    
      3400   302.84916     -42317.573      13841.594      3695.0598      17.1722        13.1279        16.390804    
      3500   315.9196      -42336.483      14176.216      3687.1304      17.1722        13.1279        16.355631    
      3600   280.66043     -42327.518      11778.81       3679.2011      17.1722        13.1279        16.320458    
      3700   291.73798     -42333.93      -3821.9811      3671.2718      17.1722        13.1279        16.285284    
      3800   304.11832     -42332.019      13518.309      3663.3425      17.1722        13.1279        16.250111    
      3900   316.84584     -42321.471      11579.245      3655.4132      17.1722        13.1279        16.214937    
      4000   309.45086     -42304.622      12465.688      3647.4839      17.1722        13.1279        16.179764    
      4100   300.12889     -42305.382      20797.506      3639.5546      17.1722        13.1279        16.144591    
      4200   290.15441     -42288.545      33056.622      3631.6252      17.1722        13.1279        16.109417    
      4300   294.06052     -42293.704      7496.1979      3623.6959      17.1722        13.1279        16.074244    
      4400   288.94645     -42298.824      24297.651      3615.7666      17.1722        13.1279        16.03907     
      4500   310.92825     -42309.3        31726.761      3607.8373      17.1722        13.1279        16.003897    
      4600   306.71394     -42293.688      18671.435      3599.908       17.1722        13.1279        15.968724    
      4700   298.97386     -42293.656      12126.307      3591.9787      17.1722        13.1279        15.93355     
      4800   299.12098     -42306.382      18703.62       3584.0494      17.1722        13.1279        15.898377    
      4900   291.70233     -42300.837      34308.196      3576.1201      17.1722        13.1279        15.863203    
      5000   298.45724     -42302.706      19380.054      3568.1907      17.1722        13.1279        15.82803     
Loop time of 276.24 on 8 procs for 5000 steps with 362 atoms

Performance: 0.782 ns/day, 30.693 hours/ns, 18.100 timesteps/s, 6.552 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 163.75     | 220.49     | 233.81     | 152.4 | 79.82
Bond    | 0.0015383  | 0.002148   | 0.0025111  |   0.7 |  0.00
Neigh   | 11.626     | 15.864     | 17.323     |  42.3 |  5.74
Comm    | 3.7369     | 17.064     | 73.809     | 548.0 |  6.18
Output  | 0.015954   | 0.018283   | 0.020151   |   1.0 |  0.01
Modify  | 21.23      | 22.692     | 26.939     |  35.4 |  8.21
Other   |            | 0.1108     |            |       |  0.04

Nlocal:          45.25 ave          48 max          42 min
Histogram: 1 0 0 2 0 1 2 0 1 1
Nghost:        3608.38 ave        3635 max        3573 min
Histogram: 1 0 2 0 0 0 1 2 1 1
Neighs:          32088 ave       34093 max       29919 min
Histogram: 1 0 1 1 1 0 2 0 1 1

Total # of neighbors = 256704
Ave neighs/atom = 709.12707
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.5867
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 1.75867 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 131.1 | 131.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.189       -42338.464     -6308.3891      3964.6564      17.1722        13.1279        17.5867      
       100   315.85082     -42339.432     -1548.6381      3972.5857      17.1722        13.1279        17.621873    
       200   327.3637      -42323.768     -12186.53       3980.515       17.1722        13.1279        17.657047    
       300   288.32881     -42296.374     -95.934058      3988.4443      17.1722        13.1279        17.69222     
       400   288.78849     -42317.612     -8255.6765      3996.3736      17.1722        13.1279        17.727394    
       500   285.05648     -42324.44       1281.4467      4004.3029      17.1722        13.1279        17.762567    
       600   287.81873     -42326.123     -6044.3693      4012.2323      17.1722        13.1279        17.79774     
       700   303.0344      -42344.008      7281.5505      4020.1616      17.1722        13.1279        17.832914    
       800   298.1599      -42366.618     -15107.737      4028.0909      17.1722        13.1279        17.868087    
       900   291.9346      -42361.722     -15719.453      4036.0202      17.1722        13.1279        17.903261    
      1000   304.3662      -42348.547     -7500.3138      4043.9495      17.1722        13.1279        17.938434    
      1100   309.30149     -42336.484     -15476.507      4051.8788      17.1722        13.1279        17.973607    
      1200   313.01786     -42348.189     -9660.7143      4059.8081      17.1722        13.1279        18.008781    
      1300   291.61244     -42349.692     -5753.5845      4067.7375      17.1722        13.1279        18.043954    
      1400   268.63104     -42351.68      -15589.343      4075.6668      17.1722        13.1279        18.079128    
      1500   289.78038     -42363.134      367.40413      4083.5961      17.1722        13.1279        18.114301    
      1600   307.71182     -42336.875     -9809.6174      4091.5254      17.1722        13.1279        18.149474    
      1700   309.79126     -42319.324     -12257.317      4099.4547      17.1722        13.1279        18.184648    
      1800   302.64758     -42311.103     -15657.82       4107.384       17.1722        13.1279        18.219821    
      1900   292.77915     -42322.866     -23080.599      4115.3133      17.1722        13.1279        18.254995    
      2000   304.77118     -42347.794     -11153.351      4123.2426      17.1722        13.1279        18.290168    
      2100   293.84739     -42339.317     -2992.9888      4131.172       17.1722        13.1279        18.325341    
      2200   301.18059     -42336.112     -15969.996      4139.1013      17.1722        13.1279        18.360515    
      2300   301.37802     -42302.077     -16008.452      4147.0306      17.1722        13.1279        18.395688    
      2400   318.41225     -42306.719     -13554.845      4154.9599      17.1722        13.1279        18.430862    
      2500   310.21665     -42313.438     -20117.115      4162.8892      17.1722        13.1279        18.466035    
      2600   285.37895     -42295.917     -9669.5302      4170.8185      17.1722        13.1279        18.501208    
      2700   296.78883     -42313.834     -14929.052      4178.7478      17.1722        13.1279        18.536382    
      2800   295.89005     -42305.135     -12867.228      4186.6771      17.1722        13.1279        18.571555    
      2900   288.803       -42286.605     -6854.0975      4194.6065      17.1722        13.1279        18.606729    
      3000   286.80765     -42257.193     -15902.818      4202.5358      17.1722        13.1279        18.641902    
      3100   332.24911     -42306.594     -30410.72       4210.4651      17.1722        13.1279        18.677075    
      3200   292.77367     -42292.89      -7901.1066      4218.3944      17.1722        13.1279        18.712249    
      3300   293.42186     -42302.968     -12229.474      4226.3237      17.1722        13.1279        18.747422    
      3400   303.31214     -42335.083     -17808.856      4234.253       17.1722        13.1279        18.782596    
      3500   286.90401     -42307.383     -13349.018      4242.1823      17.1722        13.1279        18.817769    
      3600   318.83132     -42310.399     -27030.129      4250.1116      17.1722        13.1279        18.852942    
      3700   308.47682     -42264.196     -20912.537      4258.041       17.1722        13.1279        18.888116    
      3800   296.36523     -42259.82      -19770.392      4265.9703      17.1722        13.1279        18.923289    
      3900   305.67299     -42281.989     -15351.97       4273.8996      17.1722        13.1279        18.958463    
      4000   297.49231     -42294.83      -17017.272      4281.8289      17.1722        13.1279        18.993636    
      4100   281.58335     -42282.036     -9624.1856      4289.7582      17.1722        13.1279        19.028809    
      4200   294.67269     -42292.114     -26233.721      4297.6875      17.1722        13.1279        19.063983    
      4300   305.40346     -42263.837     -18237.619      4305.6168      17.1722        13.1279        19.099156    
      4400   326.74246     -42266.068     -18535.585      4313.5461      17.1722        13.1279        19.13433     
      4500   315.30451     -42265.983     -13247.56       4321.4755      17.1722        13.1279        19.169503    
      4600   323.45906     -42282.217     -19782.376      4329.4048      17.1722        13.1279        19.204676    
      4700   299.25015     -42273.451     -14371.566      4337.3341      17.1722        13.1279        19.23985     
      4800   295.98932     -42274.145     -16036.047      4345.2634      17.1722        13.1279        19.275023    
      4900   306.29662     -42290.37      -26533.46       4353.1927      17.1722        13.1279        19.310197    
      5000   304.59963     -42272.56      -18568.278      4361.122       17.1722        13.1279        19.34537     
Loop time of 239.964 on 8 procs for 5000 steps with 362 atoms

Performance: 0.900 ns/day, 26.663 hours/ns, 20.836 timesteps/s, 7.543 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 140.77     | 185.99     | 202.68     | 184.4 | 77.51
Bond    | 0.0016794  | 0.0021924  | 0.0026172  |   0.7 |  0.00
Neigh   | 9.4085     | 12.747     | 14.295     |  49.3 |  5.31
Comm    | 3.0536     | 19.718     | 64.93      | 566.1 |  8.22
Output  | 0.016586   | 0.018984   | 0.02087    |   1.0 |  0.01
Modify  | 19.803     | 21.376     | 24.743     |  38.4 |  8.91
Other   |            | 0.1067     |            |       |  0.04

Nlocal:          45.25 ave          50 max          41 min
Histogram: 2 0 0 1 1 1 1 1 0 1
Nghost:           3139 ave        3200 max        3085 min
Histogram: 2 2 0 0 0 0 1 1 0 2
Neighs:        26151.8 ave       28625 max       23627 min
Histogram: 2 0 0 1 0 2 0 1 1 1

Total # of neighbors = 209214
Ave neighs/atom = 577.93923
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 17.1722
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.3027)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.1722
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3819999999999996732, deltaxy = 0.8382
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.030499999999999999334, deltaxz = -0.00305
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.3027000000000000246, deltayz = -0.03027
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -1.71722 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 131.1 | 131.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.189       -42338.464     -6308.3891      3964.6564      17.1722        13.1279        17.5867      
       100   315.90365     -42339.276     -1615.3765      3964.6564      17.1722        13.1279        17.5867      
       200   330.6005      -42326.272     -11307.302      3964.6564      17.1722        13.1279        17.5867      
       300   288.55563     -42296.051      2850.7993      3964.6564      17.1722        13.1279        17.5867      
       400   285.12328     -42315.184     -6643.5383      3964.6564      17.1722        13.1279        17.5867      
       500   296.34685     -42335.338      1875.4865      3964.6564      17.1722        13.1279        17.5867      
       600   294.78613     -42329.286     -1267.5906      3964.6564      17.1722        13.1279        17.5867      
       700   307.90034     -42337.802      275.18437      3964.6564      17.1722        13.1279        17.5867      
       800   295.13371     -42358.741     -5991.1902      3964.6564      17.1722        13.1279        17.5867      
       900   287.21274     -42358.444      2459.916       3964.6564      17.1722        13.1279        17.5867      
      1000   313.70707     -42370.622     -1630.2952      3964.6564      17.1722        13.1279        17.5867      
      1100   298.59381     -42335.794     -8280.7331      3964.6564      17.1722        13.1279        17.5867      
      1200   306.43717     -42332.546     -510.3561       3964.6564      17.1722        13.1279        17.5867      
      1300   310.75587     -42319.087     -4494.3777      3964.6564      17.1722        13.1279        17.5867      
      1400   306.29939     -42325.975     -9873.105       3964.6564      17.1722        13.1279        17.5867      
      1500   310.35343     -42355.917     -2959.5903      3964.6564      17.1722        13.1279        17.5867      
      1600   282.14798     -42334.37      -3215.6873      3964.6564      17.1722        13.1279        17.5867      
      1700   299.77994     -42343.277      14808.111      3964.6564      17.1722        13.1279        17.5867      
      1800   310.93884     -42336.831      3746.4606      3964.6564      17.1722        13.1279        17.5867      
      1900   295.8218      -42298.222     -3486.0417      3964.6564      17.1722        13.1279        17.5867      
      2000   325.3824      -42319.687     -2436.1973      3964.6564      17.1722        13.1279        17.5867      
      2100   298.96684     -42317.254      2300.938       3964.6564      17.1722        13.1279        17.5867      
      2200   311.87538     -42348.011      9056.2334      3964.6564      17.1722        13.1279        17.5867      
      2300   310.95031     -42360.216      8558.3273      3964.6564      17.1722        13.1279        17.5867      
      2400   292.81465     -42341.955      4267.9696      3964.6564      17.1722        13.1279        17.5867      
      2500   306.56428     -42356.303     -3557.712       3964.6564      17.1722        13.1279        17.5867      
      2600   278.1219      -42349.53       1391.9449      3964.6564      17.1722        13.1279        17.5867      
      2700   273.18422     -42365.468      2550.0778      3964.6564      17.1722        13.1279        17.5867      
      2800   286.26444     -42364.62      -791.29034      3964.6564      17.1722        13.1279        17.5867      
      2900   297.45836     -42346.368     -2843.9763      3964.6564      17.1722        13.1279        17.5867      
      3000   303.77223     -42335.381      6024.8132      3964.6564      17.1722        13.1279        17.5867      
      3100   298.29405     -42334.33      -3180.6343      3964.6564      17.1722        13.1279        17.5867      
      3200   287.59686     -42347.883     -2333.5656      3964.6564      17.1722        13.1279        17.5867      
      3300   301.2562      -42361.968     -12640.59       3964.6564      17.1722        13.1279        17.5867      
      3400   298.22539     -42353.204     -9592.7071      3964.6564      17.1722        13.1279        17.5867      
      3500   286.44151     -42340.423      652.62935      3964.6564      17.1722        13.1279        17.5867      
      3600   299.56186     -42347.804     -6850.5722      3964.6564      17.1722        13.1279        17.5867      
      3700   307.2037      -42334.008      9184.8249      3964.6564      17.1722        13.1279        17.5867      
      3800   313.60025     -42334.159     -5112.7518      3964.6564      17.1722        13.1279        17.5867      
      3900   312.36723     -42351.364      1773.6199      3964.6564      17.1722        13.1279        17.5867      
      4000   296.31444     -42352.28      -6495.3651      3964.6564      17.1722        13.1279        17.5867      
      4100   296.7204      -42352.41       666.93805      3964.6564      17.1722        13.1279        17.5867      
      4200   316.37831     -42357.799     -2247.8804      3964.6564      17.1722        13.1279        17.5867      
      4300   312.21393     -42333.766     -584.1611       3964.6564      17.1722        13.1279        17.5867      
      4400   298.24167     -42315.959     -4414.2782      3964.6564      17.1722        13.1279        17.5867      
      4500   300.36774     -42323.722     -19609.366      3964.6564      17.1722        13.1279        17.5867      
      4600   301.40838     -42339.282      2404.6259      3964.6564      17.1722        13.1279        17.5867      
      4700   292.592       -42336.345      4018.4352      3964.6564      17.1722        13.1279        17.5867      
      4800   285.97379     -42324.518      13728.687      3964.6564      17.1722        13.1279        17.5867      
      4900   310.90275     -42329.682     -2274.1409      3964.6564      17.1722        13.1279        17.5867      
      5000   329.3571      -42328.941     -1678.0231      3964.6564      17.1722        13.1279        17.5867      
Loop time of 252.756 on 8 procs for 5000 steps with 362 atoms

Performance: 0.855 ns/day, 28.084 hours/ns, 19.782 timesteps/s, 7.161 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 146.91     | 202.98     | 213.58     | 149.1 | 80.31
Bond    | 0.0016867  | 0.0022484  | 0.0027315  |   0.7 |  0.00
Neigh   | 10.964     | 15.135     | 16.323     |  41.1 |  5.99
Comm    | 2.8448     | 13.451     | 69.514     | 579.3 |  5.32
Output  | 0.016169   | 0.018577   | 0.020568   |   1.0 |  0.01
Modify  | 19.863     | 21.056     | 25.246     |  35.0 |  8.33
Other   |            | 0.1166     |            |       |  0.05

Nlocal:          45.25 ave          51 max          39 min
Histogram: 2 0 1 0 0 1 1 1 0 2
Nghost:        3340.88 ave        3371 max        3317 min
Histogram: 2 1 0 1 1 0 1 0 0 2
Neighs:        28865.6 ave       32277 max       24998 min
Histogram: 1 1 1 0 0 1 1 1 0 2

Total # of neighbors = 230925
Ave neighs/atom = 637.91436
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.1722
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 1.71722 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 131.1 | 132 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.189       -42338.464     -6308.3891      3964.6564      17.1722        13.1279        17.5867      
       100   315.97972     -42339.263     -2466.1885      3964.6564      17.1722        13.1279        17.5867      
       200   328.06989     -42323.952     -10115.273      3964.6564      17.1722        13.1279        17.5867      
       300   294.47017     -42302.555     -3559.5399      3964.6564      17.1722        13.1279        17.5867      
       400   297.10721     -42325.81       820.68414      3964.6564      17.1722        13.1279        17.5867      
       500   292.02005     -42334.852      3890.4719      3964.6564      17.1722        13.1279        17.5867      
       600   300.84699     -42340.818     -897.88611      3964.6564      17.1722        13.1279        17.5867      
       700   287.14209     -42336.608     -2232.6241      3964.6564      17.1722        13.1279        17.5867      
       800   283.56596     -42370.413     -8241.7953      3964.6564      17.1722        13.1279        17.5867      
       900   277.50063     -42357.633     -12348.976      3964.6564      17.1722        13.1279        17.5867      
      1000   292.89992     -42351.055      1016.1564      3964.6564      17.1722        13.1279        17.5867      
      1100   306.37055     -42352.458     -5236.7708      3964.6564      17.1722        13.1279        17.5867      
      1200   307.50677     -42350.596      23.97704       3964.6564      17.1722        13.1279        17.5867      
      1300   302.39638     -42338.862     -9517.6587      3964.6564      17.1722        13.1279        17.5867      
      1400   321.07518     -42356.81      -6187.1849      3964.6564      17.1722        13.1279        17.5867      
      1500   310.90922     -42369.799      8310.9217      3964.6564      17.1722        13.1279        17.5867      
      1600   289.77563     -42368.995     -13815.317      3964.6564      17.1722        13.1279        17.5867      
      1700   309.90671     -42381.748     -4498.9576      3964.6564      17.1722        13.1279        17.5867      
      1800   303.70263     -42347.446     -13694.094      3964.6564      17.1722        13.1279        17.5867      
      1900   316.2521      -42346.03       7075.3         3964.6564      17.1722        13.1279        17.5867      
      2000   307.34478     -42344.67       1183.856       3964.6564      17.1722        13.1279        17.5867      
      2100   278.39602     -42356.89      -18879.185      3964.6564      17.1722        13.1279        17.5867      
      2200   274.45005     -42349.831     -11314.583      3964.6564      17.1722        13.1279        17.5867      
      2300   282.04773     -42329.666     -5242.1655      3964.6564      17.1722        13.1279        17.5867      
      2400   339.41689     -42373.638     -15973.544      3964.6564      17.1722        13.1279        17.5867      
      2500   316.86111     -42362.394      404.4598       3964.6564      17.1722        13.1279        17.5867      
      2600   298.60515     -42364.605      2013.0737      3964.6564      17.1722        13.1279        17.5867      
      2700   275.05102     -42340.748     -1705.91        3964.6564      17.1722        13.1279        17.5867      
      2800   303.26531     -42361.791      33.595058      3964.6564      17.1722        13.1279        17.5867      
      2900   301.99209     -42351.812     -7045.4053      3964.6564      17.1722        13.1279        17.5867      
      3000   298.74965     -42340.535     -14248.248      3964.6564      17.1722        13.1279        17.5867      
      3100   325.40611     -42353.414     -6292.6761      3964.6564      17.1722        13.1279        17.5867      
      3200   312.41202     -42359.062      1050.7679      3964.6564      17.1722        13.1279        17.5867      
      3300   284.16884     -42354.925     -2888.3141      3964.6564      17.1722        13.1279        17.5867      
      3400   304.11428     -42381.387      3989.7261      3964.6564      17.1722        13.1279        17.5867      
      3500   298.01506     -42375.371     -5497.2816      3964.6564      17.1722        13.1279        17.5867      
      3600   310.62469     -42354.183     -7509.7634      3964.6564      17.1722        13.1279        17.5867      
      3700   324.43147     -42354.419     -16139.36       3964.6564      17.1722        13.1279        17.5867      
      3800   318.70992     -42356.405     -110.44029      3964.6564      17.1722        13.1279        17.5867      
      3900   301.86626     -42360.454     -7139.7474      3964.6564      17.1722        13.1279        17.5867      
      4000   298.68857     -42369.062     -5644.951       3964.6564      17.1722        13.1279        17.5867      
      4100   299.27235     -42361.341      7950.274       3964.6564      17.1722        13.1279        17.5867      
      4200   292.09851     -42341.15      -2426.8354      3964.6564      17.1722        13.1279        17.5867      
      4300   332.18892     -42367.106     -3445.7915      3964.6564      17.1722        13.1279        17.5867      
      4400   309.05763     -42333.026     -12227.508      3964.6564      17.1722        13.1279        17.5867      
      4500   306.25086     -42341.734     -2895.6223      3964.6564      17.1722        13.1279        17.5867      
      4600   316.56694     -42376.684     -12243.588      3964.6564      17.1722        13.1279        17.5867      
      4700   301.77794     -42373.033      5806.8969      3964.6564      17.1722        13.1279        17.5867      
      4800   273.88142     -42337.033      2909.0915      3964.6564      17.1722        13.1279        17.5867      
      4900   316.38657     -42346.75      -6431.6028      3964.6564      17.1722        13.1279        17.5867      
      5000   297.26167     -42311.734     -19394.731      3964.6564      17.1722        13.1279        17.5867      
Loop time of 254.708 on 8 procs for 5000 steps with 362 atoms

Performance: 0.848 ns/day, 28.301 hours/ns, 19.630 timesteps/s, 7.106 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 147.48     | 203.79     | 214.3      | 149.5 | 80.01
Bond    | 0.0016539  | 0.0022033  | 0.0026698  |   0.7 |  0.00
Neigh   | 11.236     | 15.522     | 16.735     |  41.8 |  6.09
Comm    | 3.1808     | 13.688     | 69.999     | 576.6 |  5.37
Output  | 0.016534   | 0.018948   | 0.020986   |   1.1 |  0.01
Modify  | 20.35      | 21.568     | 25.873     |  35.6 |  8.47
Other   |            | 0.1154     |            |       |  0.05

Nlocal:          45.25 ave          49 max          38 min
Histogram: 1 1 0 0 0 0 1 0 2 3
Nghost:        3376.62 ave        3401 max        3345 min
Histogram: 1 1 1 0 0 0 0 3 1 1
Neighs:        28869.5 ave       31281 max       24419 min
Histogram: 1 1 0 0 0 0 1 1 1 3

Total # of neighbors = 230956
Ave neighs/atom = 638
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.1279
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-0.0305)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.1279
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3819999999999996732, deltaxy = 0.8382
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.030499999999999999334, deltaxz = -0.00305
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.3027000000000000246, deltayz = -0.03027
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -1.31279 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 131.1 | 131.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.189       -42338.464     -6308.3891      3964.6564      17.1722        13.1279        17.5867      
       100   316.23922     -42339.876     -1648.0434      3964.6564      17.1722        13.1279        17.5867      
       200   329.56419     -42325.586     -11028.87       3964.6564      17.1722        13.1279        17.5867      
       300   292.21957     -42302.02      -891.92896      3964.6564      17.1722        13.1279        17.5867      
       400   287.4299      -42316.896     -6476.0788      3964.6564      17.1722        13.1279        17.5867      
       500   283.26459     -42323.764     -882.71781      3964.6564      17.1722        13.1279        17.5867      
       600   293.97558     -42331.233     -6707.7011      3964.6564      17.1722        13.1279        17.5867      
       700   305.61612     -42349.818     -6828.0804      3964.6564      17.1722        13.1279        17.5867      
       800   281.29035     -42364.259     -14920.385      3964.6564      17.1722        13.1279        17.5867      
       900   279.34286     -42356.383     -8803.0925      3964.6564      17.1722        13.1279        17.5867      
      1000   302.57363     -42354.789     -10233.364      3964.6564      17.1722        13.1279        17.5867      
      1100   294.59788     -42333.5        1412.1688      3964.6564      17.1722        13.1279        17.5867      
      1200   299.39101     -42331.929      1815.4441      3964.6564      17.1722        13.1279        17.5867      
      1300   325.27249     -42338.181     -15165.848      3964.6564      17.1722        13.1279        17.5867      
      1400   338.5512      -42324.561      974.13216      3964.6564      17.1722        13.1279        17.5867      
      1500   306.23334     -42292.575      1322.4082      3964.6564      17.1722        13.1279        17.5867      
      1600   313.71479     -42340.305     -8208.3125      3964.6564      17.1722        13.1279        17.5867      
      1700   301.17039     -42340.326     -4017.8021      3964.6564      17.1722        13.1279        17.5867      
      1800   299.46175     -42340.72      -464.73712      3964.6564      17.1722        13.1279        17.5867      
      1900   307.1936      -42360.868     -13404.638      3964.6564      17.1722        13.1279        17.5867      
      2000   292.30219     -42376.142      1377.7948      3964.6564      17.1722        13.1279        17.5867      
      2100   269.47647     -42348.324     -6452.3331      3964.6564      17.1722        13.1279        17.5867      
      2200   293.35671     -42355.185      10132.869      3964.6564      17.1722        13.1279        17.5867      
      2300   294.75191     -42338.347      972.59959      3964.6564      17.1722        13.1279        17.5867      
      2400   303.89654     -42348.279     -9211.3513      3964.6564      17.1722        13.1279        17.5867      
      2500   303.99658     -42353.559     -6126.0085      3964.6564      17.1722        13.1279        17.5867      
      2600   302.19012     -42356.341      2796.4453      3964.6564      17.1722        13.1279        17.5867      
      2700   289.92033     -42352.525      4748.3598      3964.6564      17.1722        13.1279        17.5867      
      2800   270.63781     -42350.809     -3714.0058      3964.6564      17.1722        13.1279        17.5867      
      2900   270.74329     -42339.832      3156.2116      3964.6564      17.1722        13.1279        17.5867      
      3000   296.10375     -42331.482      5180.4496      3964.6564      17.1722        13.1279        17.5867      
      3100   299.00298     -42328.74       3763.0482      3964.6564      17.1722        13.1279        17.5867      
      3200   292.64155     -42320.603     -2190.7388      3964.6564      17.1722        13.1279        17.5867      
      3300   285.3538      -42324.762      9397.4415      3964.6564      17.1722        13.1279        17.5867      
      3400   267.55476     -42329.891      97.927789      3964.6564      17.1722        13.1279        17.5867      
      3500   283.07542     -42346.067     -1351.1715      3964.6564      17.1722        13.1279        17.5867      
      3600   303.52414     -42331.877      11613.353      3964.6564      17.1722        13.1279        17.5867      
      3700   287.02359     -42293.615      6002.7098      3964.6564      17.1722        13.1279        17.5867      
      3800   314.47359     -42324.902     -5636.062       3964.6564      17.1722        13.1279        17.5867      
      3900   308.55165     -42331.254      5455.2328      3964.6564      17.1722        13.1279        17.5867      
      4000   309.17268     -42360.166     -556.22843      3964.6564      17.1722        13.1279        17.5867      
      4100   286.84962     -42344.02      -4886.4074      3964.6564      17.1722        13.1279        17.5867      
      4200   297.94089     -42346.577      5127.1397      3964.6564      17.1722        13.1279        17.5867      
      4300   312.40252     -42343.214      2104.3668      3964.6564      17.1722        13.1279        17.5867      
      4400   288.58923     -42311.207      1655.071       3964.6564      17.1722        13.1279        17.5867      
      4500   286.1198      -42341.956     -2477.6481      3964.6564      17.1722        13.1279        17.5867      
      4600   280.9893      -42353.685     -12654.743      3964.6564      17.1722        13.1279        17.5867      
      4700   292.78654     -42356.165      3621.1749      3964.6564      17.1722        13.1279        17.5867      
      4800   309.79047     -42355.653     -1165.4192      3964.6564      17.1722        13.1279        17.5867      
      4900   302.96682     -42327.473      2700.2605      3964.6564      17.1722        13.1279        17.5867      
      5000   305.04558     -42326.691     -8242.0364      3964.6564      17.1722        13.1279        17.5867      
Loop time of 254.686 on 8 procs for 5000 steps with 362 atoms

Performance: 0.848 ns/day, 28.298 hours/ns, 19.632 timesteps/s, 7.107 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 149.27     | 203.7      | 215.27     | 145.6 | 79.98
Bond    | 0.001651   | 0.0021993  | 0.0026864  |   0.7 |  0.00
Neigh   | 11.158     | 15.246     | 16.474     |  40.8 |  5.99
Comm    | 3.0301     | 14.604     | 69.027     | 543.9 |  5.73
Output  | 0.01596    | 0.018433   | 0.020428   |   1.1 |  0.01
Modify  | 19.773     | 21.007     | 25.11      |  34.9 |  8.25
Other   |            | 0.1109     |            |       |  0.04

Nlocal:          45.25 ave          50 max          38 min
Histogram: 1 0 1 1 0 1 0 0 2 2
Nghost:        3369.12 ave        3412 max        3339 min
Histogram: 2 0 1 1 0 3 0 0 0 1
Neighs:        28836.9 ave       31910 max       24562 min
Histogram: 1 0 2 0 0 1 0 1 1 2

Total # of neighbors = 230695
Ave neighs/atom = 637.27901
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.1279
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 1.31279 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 131.1 | 132 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.189       -42338.464     -6308.3891      3964.6564      17.1722        13.1279        17.5867      
       100   315.75085     -42338.879     -1475.704       3964.6564      17.1722        13.1279        17.5867      
       200   329.05331     -42328.107     -10315.459      3964.6564      17.1722        13.1279        17.5867      
       300   290.32662     -42301.154     -524.7286       3964.6564      17.1722        13.1279        17.5867      
       400   287.5895      -42321.128     -12614.484      3964.6564      17.1722        13.1279        17.5867      
       500   281.88445     -42326.152     -279.40659      3964.6564      17.1722        13.1279        17.5867      
       600   290.59332     -42328.411     -9631.4472      3964.6564      17.1722        13.1279        17.5867      
       700   307.09144     -42346.024     -4021.1372      3964.6564      17.1722        13.1279        17.5867      
       800   282.169       -42359.225     -5602.435       3964.6564      17.1722        13.1279        17.5867      
       900   278.08966     -42355.642      912.40228      3964.6564      17.1722        13.1279        17.5867      
      1000   303.69064     -42356.685     -2926.5325      3964.6564      17.1722        13.1279        17.5867      
      1100   310.86843     -42346.889     -4464.0005      3964.6564      17.1722        13.1279        17.5867      
      1200   316.67364     -42350.492     -6030.9112      3964.6564      17.1722        13.1279        17.5867      
      1300   296.90606     -42354.422     -4840.9939      3964.6564      17.1722        13.1279        17.5867      
      1400   282.93143     -42361.62      -4843.2086      3964.6564      17.1722        13.1279        17.5867      
      1500   307.35533     -42379.469     -7246.5278      3964.6564      17.1722        13.1279        17.5867      
      1600   280.97306     -42335.506     -2097.9258      3964.6564      17.1722        13.1279        17.5867      
      1700   317.55009     -42360.127     -12923.681      3964.6564      17.1722        13.1279        17.5867      
      1800   306.99521     -42352.3        129.81101      3964.6564      17.1722        13.1279        17.5867      
      1900   296.13596     -42349.857      2657.9279      3964.6564      17.1722        13.1279        17.5867      
      2000   279.69928     -42342.842      3744.1012      3964.6564      17.1722        13.1279        17.5867      
      2100   304.8452      -42375.119     -817.78772      3964.6564      17.1722        13.1279        17.5867      
      2200   299.47796     -42351.732      3878.5471      3964.6564      17.1722        13.1279        17.5867      
      2300   316.81427     -42346.433     -4222.3364      3964.6564      17.1722        13.1279        17.5867      
      2400   310.72274     -42339.453      4684.1118      3964.6564      17.1722        13.1279        17.5867      
      2500   289.71366     -42343.523      907.51622      3964.6564      17.1722        13.1279        17.5867      
      2600   302.5041      -42372.846      7446.7202      3964.6564      17.1722        13.1279        17.5867      
      2700   294.45981     -42366.558      1154.0376      3964.6564      17.1722        13.1279        17.5867      
      2800   305.42419     -42358.645      6569.8464      3964.6564      17.1722        13.1279        17.5867      
      2900   314.41462     -42329.262     -2627.9607      3964.6564      17.1722        13.1279        17.5867      
      3000   306.04555     -42324.646     -12980.079      3964.6564      17.1722        13.1279        17.5867      
      3100   285.93065     -42317.628     -5516.9547      3964.6564      17.1722        13.1279        17.5867      
      3200   303.02711     -42361.479     -5226.1048      3964.6564      17.1722        13.1279        17.5867      
      3300   290.83499     -42355.302     -115.83696      3964.6564      17.1722        13.1279        17.5867      
      3400   314.51397     -42373.297     -10290.014      3964.6564      17.1722        13.1279        17.5867      
      3500   288.24057     -42340.607     -8760.8552      3964.6564      17.1722        13.1279        17.5867      
      3600   298.24205     -42344.784     -11772.038      3964.6564      17.1722        13.1279        17.5867      
      3700   313.75504     -42351.474     -14047.257      3964.6564      17.1722        13.1279        17.5867      
      3800   305.03709     -42338.012     -4883.5904      3964.6564      17.1722        13.1279        17.5867      
      3900   288.92695     -42338.337      5047.2719      3964.6564      17.1722        13.1279        17.5867      
      4000   280.63021     -42353.892      3758.9282      3964.6564      17.1722        13.1279        17.5867      
      4100   290.83986     -42360.475      270.53403      3964.6564      17.1722        13.1279        17.5867      
      4200   304.94741     -42340.269     -3231.8947      3964.6564      17.1722        13.1279        17.5867      
      4300   321.77991     -42348.02      -4739.8013      3964.6564      17.1722        13.1279        17.5867      
      4400   325.3141      -42364.755     -1294.0427      3964.6564      17.1722        13.1279        17.5867      
      4500   283.64631     -42339.032     -8800.5491      3964.6564      17.1722        13.1279        17.5867      
      4600   299.98495     -42363.304     -4281.9696      3964.6564      17.1722        13.1279        17.5867      
      4700   294.73655     -42349.579     -17502.144      3964.6564      17.1722        13.1279        17.5867      
      4800   291.10922     -42309.961     -5235.3405      3964.6564      17.1722        13.1279        17.5867      
      4900   319.26153     -42327.125      2418.9526      3964.6564      17.1722        13.1279        17.5867      
      5000   298.14302     -42325.792     -5122.4641      3964.6564      17.1722        13.1279        17.5867      
Loop time of 253.078 on 8 procs for 5000 steps with 362 atoms

Performance: 0.853 ns/day, 28.120 hours/ns, 19.757 timesteps/s, 7.152 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 146.17     | 202.67     | 212.91     | 150.5 | 80.08
Bond    | 0.0017562  | 0.0022661  | 0.0026613  |   0.7 |  0.00
Neigh   | 11.092     | 15.251     | 16.486     |  41.5 |  6.03
Comm    | 3.4259     | 13.674     | 70.172     | 579.2 |  5.40
Output  | 0.017316   | 0.020544   | 0.023136   |   1.3 |  0.01
Modify  | 20.093     | 21.343     | 25.519     |  35.3 |  8.43
Other   |            | 0.1173     |            |       |  0.05

Nlocal:          45.25 ave          51 max          39 min
Histogram: 1 0 0 2 0 2 1 1 0 1
Nghost:        3337.75 ave        3380 max        3304 min
Histogram: 1 2 0 1 0 2 0 0 1 1
Neighs:        28849.9 ave       32337 max       25061 min
Histogram: 1 0 0 2 1 1 1 1 0 1

Total # of neighbors = 230799
Ave neighs/atom = 637.5663
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.5867
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--8.382)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.5867
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3819999999999996732, deltaxy = 0.8382
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.030499999999999999334, deltaxz = -0.00305
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.3027000000000000246, deltayz = -0.03027
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -1.75867 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 131.1 | 131.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.189       -42338.464     -6308.3891      3964.6564      17.1722        13.1279        17.5867      
       100   315.74959     -42339.256     -1536.4243      3964.6564      17.1722        13.1279        17.5867      
       200   333.66631     -42326.423     -10729.554      3964.6564      17.1722        13.1279        17.5867      
       300   301.98945     -42307.436     -7839.7432      3964.6564      17.1722        13.1279        17.5867      
       400   294.43271     -42321.307     -8514.8703      3964.6564      17.1722        13.1279        17.5867      
       500   291.94938     -42329.505     -15760.867      3964.6564      17.1722        13.1279        17.5867      
       600   298.33407     -42338.216      9490.0754      3964.6564      17.1722        13.1279        17.5867      
       700   291.77488     -42349.162      1043.7939      3964.6564      17.1722        13.1279        17.5867      
       800   301.59963     -42386.799     -5525.8715      3964.6564      17.1722        13.1279        17.5867      
       900   278.40822     -42355.355     -6490.0219      3964.6564      17.1722        13.1279        17.5867      
      1000   304.91773     -42367.636     -4308.9522      3964.6564      17.1722        13.1279        17.5867      
      1100   299.29307     -42344.466     -12507.004      3964.6564      17.1722        13.1279        17.5867      
      1200   319.24808     -42345.154     -10143.668      3964.6564      17.1722        13.1279        17.5867      
      1300   309.40445     -42337.045     -14011.857      3964.6564      17.1722        13.1279        17.5867      
      1400   313.51699     -42373.967      4436.7276      3964.6564      17.1722        13.1279        17.5867      
      1500   282.73105     -42363.701     -10819.375      3964.6564      17.1722        13.1279        17.5867      
      1600   298.84193     -42361.863      2106.8296      3964.6564      17.1722        13.1279        17.5867      
      1700   301.73112     -42342.761     -5559.1006      3964.6564      17.1722        13.1279        17.5867      
      1800   304.72413     -42327.738     -5589.0004      3964.6564      17.1722        13.1279        17.5867      
      1900   289.71295     -42320.805     -8259.6039      3964.6564      17.1722        13.1279        17.5867      
      2000   307.15312     -42365.323      8262.9729      3964.6564      17.1722        13.1279        17.5867      
      2100   296.55018     -42360.713     -15094.951      3964.6564      17.1722        13.1279        17.5867      
      2200   293.48692     -42354.837     -3641.5042      3964.6564      17.1722        13.1279        17.5867      
      2300   296.618       -42344.07      -1905.4438      3964.6564      17.1722        13.1279        17.5867      
      2400   304.83263     -42321.906      2368.0556      3964.6564      17.1722        13.1279        17.5867      
      2500   332.01233     -42326.259     -4588.1034      3964.6564      17.1722        13.1279        17.5867      
      2600   310.54839     -42328.67      -1744.7375      3964.6564      17.1722        13.1279        17.5867      
      2700   298.65933     -42327.685     -107.85654      3964.6564      17.1722        13.1279        17.5867      
      2800   309.85298     -42354.137      2896.2003      3964.6564      17.1722        13.1279        17.5867      
      2900   296.88893     -42354.777      4975.9092      3964.6564      17.1722        13.1279        17.5867      
      3000   284.00804     -42347.99       255.91419      3964.6564      17.1722        13.1279        17.5867      
      3100   306.69883     -42354.393     -5594.2525      3964.6564      17.1722        13.1279        17.5867      
      3200   328.17324     -42331.486     -10084.107      3964.6564      17.1722        13.1279        17.5867      
      3300   329.09041     -42328.502     -10975.627      3964.6564      17.1722        13.1279        17.5867      
      3400   296.56953     -42320.329     -4843.6676      3964.6564      17.1722        13.1279        17.5867      
      3500   299.87192     -42332.497      2941.61        3964.6564      17.1722        13.1279        17.5867      
      3600   284.36934     -42314.655     -3708.1716      3964.6564      17.1722        13.1279        17.5867      
      3700   288.26715     -42314.211     -18199.143      3964.6564      17.1722        13.1279        17.5867      
      3800   321.1366      -42344.351     -11244.595      3964.6564      17.1722        13.1279        17.5867      
      3900   291.73332     -42311.885     -3976.6492      3964.6564      17.1722        13.1279        17.5867      
      4000   302.84273     -42326.658      6641.995       3964.6564      17.1722        13.1279        17.5867      
      4100   283.17157     -42315.624     -10088.652      3964.6564      17.1722        13.1279        17.5867      
      4200   286.57683     -42327.763     -2476.5468      3964.6564      17.1722        13.1279        17.5867      
      4300   291.31821     -42319.542     -3337.4811      3964.6564      17.1722        13.1279        17.5867      
      4400   300.7907      -42294.858     -12859.018      3964.6564      17.1722        13.1279        17.5867      
      4500   312.47801     -42292.402      1176.0717      3964.6564      17.1722        13.1279        17.5867      
      4600   317.23688     -42320.38       7540.9784      3964.6564      17.1722        13.1279        17.5867      
      4700   312.03548     -42323.913     -8473.0629      3964.6564      17.1722        13.1279        17.5867      
      4800   297.88206     -42310.527     -6671.8318      3964.6564      17.1722        13.1279        17.5867      
      4900   304.06656     -42319.36      -2377.7734      3964.6564      17.1722        13.1279        17.5867      
      5000   308.76913     -42339.796      8255.6367      3964.6564      17.1722        13.1279        17.5867      
Loop time of 253.195 on 8 procs for 5000 steps with 362 atoms

Performance: 0.853 ns/day, 28.133 hours/ns, 19.748 timesteps/s, 7.149 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 148.49     | 200.21     | 213.38     | 148.6 | 79.07
Bond    | 0.0015113  | 0.0021394  | 0.0025737  |   0.7 |  0.00
Neigh   | 11.548     | 15.565     | 17.024     |  42.4 |  6.15
Comm    | 2.8002     | 15.961     | 67.658     | 526.2 |  6.30
Output  | 0.016462   | 0.019283   | 0.02149    |   1.2 |  0.01
Modify  | 19.859     | 21.331     | 25.383     |  36.6 |  8.42
Other   |            | 0.1103     |            |       |  0.04

Nlocal:          45.25 ave          50 max          39 min
Histogram: 2 0 0 0 0 1 1 2 1 1
Nghost:        3512.62 ave        3560 max        3472 min
Histogram: 2 0 1 1 0 1 1 1 0 1
Neighs:        28832.2 ave       31868 max       24977 min
Histogram: 2 0 0 0 0 1 2 1 1 1

Total # of neighbors = 230658
Ave neighs/atom = 637.1768
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.5867
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 1.75867 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.3 | 131.1 | 132 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.189       -42338.464     -6308.3891      3964.6564      17.1722        13.1279        17.5867      
       100   316.02579     -42339.1       -1607.0462      3964.6564      17.1722        13.1279        17.5867      
       200   329.87568     -42325.306     -7902.8172      3964.6564      17.1722        13.1279        17.5867      
       300   283.35076     -42285.479     -8270.4748      3964.6564      17.1722        13.1279        17.5867      
       400   300.67583     -42326.632     -3053.6329      3964.6564      17.1722        13.1279        17.5867      
       500   277.0199      -42310.666      11620.795      3964.6564      17.1722        13.1279        17.5867      
       600   300.36561     -42338.03      -3901.5967      3964.6564      17.1722        13.1279        17.5867      
       700   282.13382     -42330.791      175.85309      3964.6564      17.1722        13.1279        17.5867      
       800   284.80228     -42364.468     -14947.144      3964.6564      17.1722        13.1279        17.5867      
       900   274.92472     -42353.643     -13294.787      3964.6564      17.1722        13.1279        17.5867      
      1000   297.00056     -42360.599      2279.6411      3964.6564      17.1722        13.1279        17.5867      
      1100   294.72323     -42338.158     -9511.0887      3964.6564      17.1722        13.1279        17.5867      
      1200   301.01392     -42331.716     -32.689933      3964.6564      17.1722        13.1279        17.5867      
      1300   300.68365     -42321.797      450.18663      3964.6564      17.1722        13.1279        17.5867      
      1400   309.71491     -42302.579     -8658.955       3964.6564      17.1722        13.1279        17.5867      
      1500   332.72855     -42330.254     -13743.289      3964.6564      17.1722        13.1279        17.5867      
      1600   317.38104     -42347.475     -8322.9046      3964.6564      17.1722        13.1279        17.5867      
      1700   289.79088     -42328.727      1604.9034      3964.6564      17.1722        13.1279        17.5867      
      1800   308.47507     -42348.331      5144.2769      3964.6564      17.1722        13.1279        17.5867      
      1900   292.31021     -42331.781     -11493.067      3964.6564      17.1722        13.1279        17.5867      
      2000   299.94352     -42355.096     -1218.2547      3964.6564      17.1722        13.1279        17.5867      
      2100   286.76683     -42355.167     -6312.3354      3964.6564      17.1722        13.1279        17.5867      
      2200   293.67886     -42349.961     -12972.015      3964.6564      17.1722        13.1279        17.5867      
      2300   317.08752     -42340.812     -4909.1095      3964.6564      17.1722        13.1279        17.5867      
      2400   310.96222     -42323.569     -14412.464      3964.6564      17.1722        13.1279        17.5867      
      2500   317.18528     -42343.316      3278.702       3964.6564      17.1722        13.1279        17.5867      
      2600   306.54855     -42338.031      3276.517       3964.6564      17.1722        13.1279        17.5867      
      2700   299.78868     -42347.97       5493.8439      3964.6564      17.1722        13.1279        17.5867      
      2800   287.65466     -42341.342      11619.518      3964.6564      17.1722        13.1279        17.5867      
      2900   291.31823     -42333.125     -4000.9463      3964.6564      17.1722        13.1279        17.5867      
      3000   306.58735     -42327.471      455.29819      3964.6564      17.1722        13.1279        17.5867      
      3100   335.76847     -42344.722     -9170.1843      3964.6564      17.1722        13.1279        17.5867      
      3200   311.72363     -42345.833      2347.4057      3964.6564      17.1722        13.1279        17.5867      
      3300   321.74191     -42375.14       3248.1564      3964.6564      17.1722        13.1279        17.5867      
      3400   300.39045     -42354.34       2945.5695      3964.6564      17.1722        13.1279        17.5867      
      3500   276.82153     -42339.808     -1294.6347      3964.6564      17.1722        13.1279        17.5867      
      3600   289.4195      -42366.543     -8249.7932      3964.6564      17.1722        13.1279        17.5867      
      3700   275.47638     -42365.428     -2126.7222      3964.6564      17.1722        13.1279        17.5867      
      3800   296.80497     -42360.663      328.58086      3964.6564      17.1722        13.1279        17.5867      
      3900   296.81981     -42329.026      3262.6903      3964.6564      17.1722        13.1279        17.5867      
      4000   318.49186     -42344.553      2244.7397      3964.6564      17.1722        13.1279        17.5867      
      4100   310.62678     -42335.094     -1330.084       3964.6564      17.1722        13.1279        17.5867      
      4200   291.2952      -42345.241      8738.6028      3964.6564      17.1722        13.1279        17.5867      
      4300   305.7887      -42367.247      985.92467      3964.6564      17.1722        13.1279        17.5867      
      4400   304.86351     -42356.103     -3148.4896      3964.6564      17.1722        13.1279        17.5867      
      4500   287.17737     -42312.903      5590.0024      3964.6564      17.1722        13.1279        17.5867      
      4600   315.01323     -42303.802     -724.88499      3964.6564      17.1722        13.1279        17.5867      
      4700   324.28717     -42317.188      9071.6834      3964.6564      17.1722        13.1279        17.5867      
      4800   312.16706     -42329.33       13292.878      3964.6564      17.1722        13.1279        17.5867      
      4900   284.99363     -42322.521     -5409.7765      3964.6564      17.1722        13.1279        17.5867      
      5000   286.09591     -42323.857     -5220.8585      3964.6564      17.1722        13.1279        17.5867      
Loop time of 193.002 on 8 procs for 5000 steps with 362 atoms

Performance: 1.119 ns/day, 21.445 hours/ns, 25.907 timesteps/s, 9.378 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 129.21     | 151.31     | 157.73     |  69.3 | 78.40
Bond    | 0.0011761  | 0.0016681  | 0.0020162  |   0.7 |  0.00
Neigh   | 10.617     | 12.413     | 13.083     |  21.0 |  6.43
Comm    | 4.3275     | 10.733     | 32.838     | 260.2 |  5.56
Output  | 0.014469   | 0.016216   | 0.017751   |   0.9 |  0.01
Modify  | 17.77      | 18.428     | 20.22      |  17.1 |  9.55
Other   |            | 0.0993     |            |       |  0.05

Nlocal:          45.25 ave          50 max          40 min
Histogram: 1 0 1 0 1 1 1 1 1 1
Nghost:           3190 ave        3220 max        3148 min
Histogram: 1 0 1 0 2 0 0 1 1 2
Neighs:        28866.6 ave       31832 max       25578 min
Histogram: 1 0 1 0 1 2 0 2 0 1

Total # of neighbors = 230933
Ave neighs/atom = 637.93646
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:54:14
