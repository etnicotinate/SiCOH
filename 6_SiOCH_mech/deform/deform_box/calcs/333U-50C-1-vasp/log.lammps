LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 30*${nthermo}       # steps of equilibration run 10
variable nequil equal 30*100       
variable nrun equal 30*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 30*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-1-vasp
read_data       ${structure}.data
read_data       333U-50C-1-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.006 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 7.2338e-05 on 8 procs for 1 steps with 362 atoms

100.7% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.048e-06  | 2.008e-06  | 2.165e-06  |   0.0 |  2.78
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 3.562e-06  | 4.4091e-06 | 4.61e-06   |   0.0 |  6.10
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 6.592e-05  |            |       | 91.13

Nlocal:          45.25 ave          51 max          37 min
Histogram: 1 0 0 1 1 1 0 2 1 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-1-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
run ${nequil}
run 3000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -7.38 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.5 | 130.8 | 131.9 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -40664.228      99992.787      1.6616584      3964.6564    
       100   740.8413      -41529.586     -10865.282      1.6616584      3964.6564    
       200   483.66151     -41655.737     -15689.13       1.6616584      3964.6564    
       300   445.20455     -41908.367     -20086.048      1.6616584      3964.6564    
       400   388.33782     -42054.271      11136.418      1.6616584      3964.6564    
       500   329.4184      -42142.088      1460.1216      1.6616584      3964.6564    
       600   278.92129     -42178.288     -10564.38       1.6616584      3964.6564    
       700   274.89052     -42217.21       1651.2021      1.6616584      3964.6564    
       800   295.35122     -42234.634     -1371.6273      1.6616584      3964.6564    
       900   308.63426     -42232.201     -4233.001       1.6616584      3964.6564    
      1000   306.87897     -42240.663     -9968.0073      1.6616584      3964.6564    
      1100   301.70722     -42259.421     -3096.0581      1.6616584      3964.6564    
      1200   301.75541     -42275.705     -31783.501      1.6616584      3964.6564    
      1300   299.28222     -42282.522     -3771.6584      1.6616584      3964.6564    
      1400   280.0515      -42257.507      2888.2296      1.6616584      3964.6564    
      1500   307.35524     -42271.036      248.29954      1.6616584      3964.6564    
      1600   313.16546     -42263.909      258.13097      1.6616584      3964.6564    
      1700   314.2632      -42265.192      10465          1.6616584      3964.6564    
      1800   295.97837     -42270.323     -2079.0797      1.6616584      3964.6564    
      1900   286.24232     -42287.526     -3593.7428      1.6616584      3964.6564    
      2000   282.68742     -42286.447     -9664.1942      1.6616584      3964.6564    
      2100   294.16539     -42277.253      3492.2615      1.6616584      3964.6564    
      2200   330.79624     -42297.306      1561.8081      1.6616584      3964.6564    
      2300   316.43258     -42281.803     -3572.4911      1.6616584      3964.6564    
      2400   312.45939     -42297.506      3447.6242      1.6616584      3964.6564    
      2500   281.33349     -42289.628     -8198.8405      1.6616584      3964.6564    
      2600   275.7291      -42297.408     -8755.4062      1.6616584      3964.6564    
      2700   293.43592     -42311.035     -7631.5465      1.6616584      3964.6564    
      2800   309.48118     -42314.11      -17299.58       1.6616584      3964.6564    
      2900   317.13087     -42309.86      -5088.916       1.6616584      3964.6564    
      3000   291.54158     -42294.28      -1663.4264      1.6616584      3964.6564    
Loop time of 151.846 on 8 procs for 3000 steps with 362 atoms

Performance: 0.853 ns/day, 28.120 hours/ns, 19.757 timesteps/s, 7.152 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 100.81     | 121.22     | 128.35     |  80.2 | 79.83
Bond    | 0.0082246  | 0.0089813  | 0.0095663  |   0.4 |  0.01
Neigh   | 7.6129     | 9.1671     | 9.7649     |  23.4 |  6.04
Comm    | 1.5733     | 8.703      | 29.115     | 299.2 |  5.73
Output  | 0.0015466  | 0.001691   | 0.0025597  |   0.8 |  0.00
Modify  | 12.06      | 12.662     | 14.231     |  20.4 |  8.34
Other   |            | 0.07999    |            |       |  0.05

Nlocal:          45.25 ave          49 max          43 min
Histogram: 3 1 0 0 0 1 2 0 0 1
Nghost:        3358.12 ave        3402 max        3317 min
Histogram: 1 1 0 1 1 2 0 0 1 1
Neighs:        28866.6 ave       31167 max       27316 min
Histogram: 3 0 1 0 0 1 2 0 0 1

Total # of neighbors = 230933
Ave neighs/atom = 637.93646
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333U-50C-1-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 17.1722
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.1279
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.5867

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.3027
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 0.0305
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -8.382

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 17.1722
variable dlen equal lx-${len0}
variable dlen equal lx-17.1722
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.1722
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3819999999999996732, deltaxy = 0.08382
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.030499999999999999334, deltaxz = -0.000305
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.3027000000000000246, deltayz = -0.003027
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.171722 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.171722 xy delta 0.08382 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.171722 xy delta 0.08382 xz delta -0.000305 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.1 | 130.6 | 132 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   291.54158     -42294.28      -1663.4393      1.6616584      3964.6564    
       100   294.32578     -42313.155     -5596.7603      1.6622125      3963.3348    
       200   301.81734     -42319.939     -11887.378      1.6627669      3962.0133    
       300   287.25961     -42300.073     -1625.4261      1.6633217      3960.6917    
       400   312.78451     -42312.832      2410.1526      1.6638769      3959.3702    
       500   309.13276     -42304.246      15307.319      1.6644325      3958.0486    
       600   302.48597     -42311.221     -7588.9427      1.6649884      3956.7271    
       700   300.91119     -42323.235      469.31473      1.6655447      3955.4055    
       800   296.70526     -42330.725     -8971.625       1.6661014      3954.084     
       900   296.78921     -42333.976     -10899.589      1.6666584      3952.7624    
      1000   287.82465     -42317.227     -2387.964       1.6672158      3951.4409    
      1100   291.6488      -42307.552      8057.8397      1.6677736      3950.1193    
      1200   311.09515     -42307.59       1762.886       1.6683317      3948.7978    
      1300   306.96172     -42300.238     -364.08467      1.6688903      3947.4762    
      1400   290.95756     -42303.564     -7077.2046      1.6694492      3946.1547    
      1500   301.97336     -42340.587     -280.25553      1.6700085      3944.8331    
      1600   302.38667     -42351.373     -10040.931      1.6705681      3943.5116    
      1700   305.41247     -42342.942     -4612.9726      1.6711281      3942.19      
      1800   310.74044     -42318.097     -6033.9065      1.6716885      3940.8684    
      1900   309.48395     -42310.277     -96.707992      1.6722493      3939.5469    
      2000   298.01676     -42322.333     -9743.2371      1.6728105      3938.2253    
      2100   303.33794     -42351.902     -5333.6654      1.673372       3936.9038    
      2200   291.19827     -42336.589     -9909.8997      1.6739339      3935.5822    
      2300   291.55982     -42326.004      11691.864      1.6744962      3934.2607    
      2400   311.74842     -42335.36      -8020.9858      1.6750589      3932.9391    
      2500   303.94964     -42328.334      2558.8843      1.6756219      3931.6176    
      2600   288.71791     -42342.094     -755.96829      1.6761854      3930.296     
      2700   297.78385     -42364.027     -7173.8941      1.6767492      3928.9745    
      2800   293.63055     -42348.649      4652.8239      1.6773133      3927.6529    
      2900   306.14597     -42330.556      3233.0588      1.6778779      3926.3314    
      3000   323.26039     -42346.163     -4288.9328      1.6784428      3925.0098    
Loop time of 155.47 on 8 procs for 3000 steps with 362 atoms

Performance: 0.834 ns/day, 28.791 hours/ns, 19.296 timesteps/s, 6.985 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 117.23     | 127.44     | 132.13     |  36.2 | 81.97
Bond    | 0.0078035  | 0.0089851  | 0.0097614  |   0.6 |  0.01
Neigh   | 8.924      | 9.525      | 9.9716     |   9.8 |  6.13
Comm    | 1.0445     | 5.7382     | 15.97      | 171.1 |  3.69
Output  | 0.0094763  | 0.010909   | 0.012173   |   0.9 |  0.01
Modify  | 12.206     | 12.667     | 13.237     |   8.5 |  8.15
Other   |            | 0.08392    |            |       |  0.05

Nlocal:          45.25 ave          51 max          41 min
Histogram: 1 2 0 0 2 1 0 0 0 2
Nghost:        3372.12 ave        3429 max        3331 min
Histogram: 1 1 1 1 1 1 0 1 0 1
Neighs:        29133.6 ave       32699 max       26560 min
Histogram: 2 1 0 2 0 1 0 0 0 2

Total # of neighbors = 233069
Ave neighs/atom = 643.83702
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.1722
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.171722 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.171722 xy delta -0.08382 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.171722 xy delta -0.08382 xz delta 0.000305 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.1 | 130.6 | 132.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   291.54158     -42294.28      -1663.4393      1.6616584      3964.6564    
       100   294.34145     -42313.253     -5611.3275      1.6611047      3965.9779    
       200   301.271       -42319.862     -14297.033      1.6605514      3967.2995    
       300   283.52023     -42296.1       -671.55732      1.6599984      3968.621     
       400   313.40881     -42311.278     -4009.0019      1.6594458      3969.9426    
       500   311.64519     -42303.629     -3066.228       1.6588936      3971.2641    
       600   300.74159     -42308.537      2333.3244      1.6583417      3972.5857    
       700   295.63589     -42315.203      5156.6016      1.6577902      3973.9072    
       800   300.60398     -42328.621     -15890.666      1.6572391      3975.2288    
       900   307.65267     -42339.828      1263.4722      1.6566884      3976.5504    
      1000   308.44432     -42344.127      4558.0796      1.656138       3977.8719    
      1100   297.87059     -42332.791     -9768.9921      1.6555879      3979.1935    
      1200   293.49701     -42322.46      -6165.4441      1.6550383      3980.515     
      1300   304.26203     -42319.858     -9091.777       1.654489       3981.8366    
      1400   301.42795     -42320.296     -2931.9275      1.65394        3983.1581    
      1500   305.57149     -42338.655     -4098.4139      1.6533915      3984.4797    
      1600   298.89555     -42346.937     -18834.128      1.6528433      3985.8012    
      1700   302.29901     -42355.699      2131.2097      1.6522954      3987.1228    
      1800   286.38396     -42322.999     -14229.798      1.6517479      3988.4443    
      1900   308.51505     -42316.991     -5437.1729      1.6512008      3989.7659    
      2000   329.63256     -42338.094     -4391.3919      1.6506541      3991.0874    
      2100   296.91529     -42321.586     -5352.4618      1.6501077      3992.409     
      2200   278.94325     -42336.686     -19032.549      1.6495616      3993.7305    
      2300   286.0124      -42361.235     -3960.6133      1.649016       3995.0521    
      2400   283.482       -42347.089     -8102.042       1.6484707      3996.3736    
      2500   295.18305     -42334.079     -13084.568      1.6479257      3997.6952    
      2600   309.10122     -42328.683     -9157.3954      1.6473811      3999.0167    
      2700   309.07115     -42328.328     -7704.6456      1.6468369      4000.3383    
      2800   307.53626     -42329.704     -640.31466      1.646293       4001.6598    
      2900   290.97286     -42336.808      5110.9598      1.6457495      4002.9814    
      3000   262.10226     -42323.505     -12207.53       1.6452064      4004.3029    
Loop time of 155.219 on 8 procs for 3000 steps with 362 atoms

Performance: 0.835 ns/day, 28.744 hours/ns, 19.327 timesteps/s, 6.997 katom-step/s
98.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 102.39     | 117.02     | 128.48     |  79.6 | 75.39
Bond    | 0.0079485  | 0.0087929  | 0.0095633  |   0.5 |  0.01
Neigh   | 7.7075     | 8.8175     | 9.9094     |  23.8 |  5.68
Comm    | 3.3858     | 14.838     | 29.372     | 222.5 |  9.56
Output  | 0.011      | 0.013306   | 0.015365   |   1.2 |  0.01
Modify  | 13.216     | 14.443     | 15.657     |  20.0 |  9.30
Other   |            | 0.08108    |            |       |  0.05

Nlocal:          45.25 ave          52 max          39 min
Histogram: 1 0 0 2 2 1 0 1 0 1
Nghost:        3335.38 ave        3387 max        3299 min
Histogram: 2 1 0 1 1 1 1 0 0 1
Neighs:        28547.4 ave       32574 max       24896 min
Histogram: 1 0 1 1 2 1 0 1 0 1

Total # of neighbors = 228379
Ave neighs/atom = 630.88122
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.1279
variable dlen equal ly-${len0}
variable dlen equal ly-13.1279
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.005 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.1279
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3819999999999996732, deltaxy = 0.08382
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.030499999999999999334, deltaxz = -0.000305
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.3027000000000000246, deltayz = -0.003027
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.131279 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.131279 yz delta -0.003027 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.1 | 130.6 | 132 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   291.54158     -42294.28      -1663.4393      1.6616584      3964.6564    
       100   294.32541     -42313.155     -5621.7067      1.6622125      3963.3348    
       200   301.75806     -42320.56      -12351.562      1.6627669      3962.0133    
       300   288.42725     -42302.679     -1362.0816      1.6633217      3960.6917    
       400   318.32852     -42319.901      2363.3247      1.6638769      3959.3702    
       500   304.96616     -42300.211     -5787.4156      1.6644325      3958.0486    
       600   291.32421     -42298.142     -4612.3976      1.6649884      3956.7271    
       700   303.82887     -42320.633      4271.2501      1.6655447      3955.4055    
       800   285.19737     -42310.366      4578.1729      1.6661014      3954.084     
       900   308.92405     -42333.271     -7462.4077      1.6666584      3952.7624    
      1000   302.60804     -42323.661      6583.2598      1.6672158      3951.4409    
      1100   283.44744     -42295.138     -2731.3535      1.6677736      3950.1193    
      1200   296.08844     -42297.281      3923.951       1.6683317      3948.7978    
      1300   300.00254     -42294.343     -9242.7759      1.6688903      3947.4762    
      1400   296.75914     -42305.747     -9853.1887      1.6694492      3946.1547    
      1500   305.20737     -42340.128      2545.7861      1.6700085      3944.8331    
      1600   290.48821     -42338.094     -5011.6835      1.6705681      3943.5116    
      1700   290.05122     -42319.945      278.36648      1.6711281      3942.19      
      1800   300.90981     -42310.766      3846.2664      1.6716885      3940.8684    
      1900   315.03093     -42337.547     -3498.3631      1.6722493      3939.5469    
      2000   287.56866     -42322.23       4426.7712      1.6728105      3938.2253    
      2100   282.05707     -42325.495     -7802.0741      1.673372       3936.9038    
      2200   291.79323     -42332.181     -4612.0257      1.6739339      3935.5822    
      2300   322.05288     -42317.065     -7308.3372      1.6744962      3934.2607    
      2400   328.7828      -42318.574     -226.22597      1.6750589      3932.9391    
      2500   330.91113     -42352.395      1377.2583      1.6756219      3931.6176    
      2600   297.09786     -42345.441     -5324.6949      1.6761854      3930.296     
      2700   290.06995     -42355.585      1120.0408      1.6767492      3928.9745    
      2800   306.44529     -42381.757      4609.662       1.6773133      3927.6529    
      2900   293.36167     -42373.949     -11788.643      1.6778779      3926.3314    
      3000   290.00901     -42376.697     -7978.0428      1.6784428      3925.0098    
Loop time of 154.071 on 8 procs for 3000 steps with 362 atoms

Performance: 0.841 ns/day, 28.532 hours/ns, 19.472 timesteps/s, 7.049 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 90.795     | 120.42     | 130.76     | 119.2 | 78.16
Bond    | 0.0086035  | 0.0091157  | 0.0099871  |   0.5 |  0.01
Neigh   | 6.7925     | 9.0013     | 10.137     |  34.9 |  5.84
Comm    | 1.4064     | 11.738     | 41.375     | 382.0 |  7.62
Output  | 0.012094   | 0.013989   | 0.015757   |   1.1 |  0.01
Modify  | 11.631     | 12.803     | 15.011     |  29.4 |  8.31
Other   |            | 0.08503    |            |       |  0.06

Nlocal:          45.25 ave          51 max          40 min
Histogram: 1 1 1 1 0 1 0 2 0 1
Nghost:        3374.75 ave        3417 max        3340 min
Histogram: 2 0 1 1 1 1 0 0 0 2
Neighs:        29136.9 ave       32737 max       25920 min
Histogram: 1 1 1 1 0 1 0 2 0 1

Total # of neighbors = 233095
Ave neighs/atom = 643.90884
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.1279
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.131279 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.131279 yz delta 0.003027 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.1 | 130.6 | 132.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   291.54158     -42294.28      -1663.4393      1.6616584      3964.6564    
       100   294.31213     -42313.163     -5613.0176      1.6611047      3965.9779    
       200   301.11073     -42319.393     -12501.279      1.6605514      3967.2995    
       300   288.93332     -42301.306     -384.84687      1.6599984      3968.621     
       400   313.9854      -42312.554      1752.4198      1.6594458      3969.9426    
       500   308.80021     -42303.673     -7621.8386      1.6588936      3971.2641    
       600   303.17028     -42314.155     -17525.854      1.6583417      3972.5857    
       700   299.81684     -42321.14      -4504.9628      1.6577902      3973.9072    
       800   294.33476     -42319.987     -11854.176      1.6572391      3975.2288    
       900   302.61429     -42324.125     -6454.2109      1.6566884      3976.5504    
      1000   284.21034     -42298.88       4513.9608      1.656138       3977.8719    
      1100   307.68451     -42317.475     -5457.2743      1.6555879      3979.1935    
      1200   303.81567     -42312.04      -11372.574      1.6550383      3980.515     
      1300   293.62607     -42287.146     -6244.0551      1.654489       3981.8366    
      1400   313.86237     -42304.229     -2002.7258      1.65394        3983.1581    
      1500   298.8192      -42303.761     -574.35737      1.6533915      3984.4797    
      1600   306.72872     -42328.203     -8138.1315      1.6528433      3985.8012    
      1700   297.66        -42324.403     -8128.9397      1.6522954      3987.1228    
      1800   294.81777     -42325.384      2308.1739      1.6517479      3988.4443    
      1900   293.34118     -42314.882     -1626.9803      1.6512008      3989.7659    
      2000   292.01694     -42291.769      6557.9708      1.6506541      3991.0874    
      2100   309.44481     -42299.703     -4013.8369      1.6501077      3992.409     
      2200   315.9625      -42298.191     -4313.9314      1.6495616      3993.7305    
      2300   308.00875     -42317.808     -1392.065       1.649016       3995.0521    
      2400   299.63658     -42334.093      5817.88        1.6484707      3996.3736    
      2500   306.35366     -42341.56       215.61864      1.6479257      3997.6952    
      2600   314.92587     -42329.803     -9581.6124      1.6473811      3999.0167    
      2700   318.01562     -42316.742      4493.2381      1.6468369      4000.3383    
      2800   307.37349     -42321.572      2720.903       1.646293       4001.6598    
      2900   296.19551     -42350.283     -14595.843      1.6457495      4002.9814    
      3000   273.05891     -42325.162      4344.1966      1.6452064      4004.3029    
Loop time of 151.644 on 8 procs for 3000 steps with 362 atoms

Performance: 0.855 ns/day, 28.082 hours/ns, 19.783 timesteps/s, 7.161 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 96.636     | 122.07     | 128.46     |  90.5 | 80.50
Bond    | 0.0084244  | 0.0089206  | 0.0094197  |   0.3 |  0.01
Neigh   | 7.2591     | 9.168      | 9.9882     |  25.5 |  6.05
Comm    | 1.6099     | 7.995      | 33.413     | 353.4 |  5.27
Output  | 0.010421   | 0.012261   | 0.013933   |   1.0 |  0.01
Modify  | 11.458     | 12.308     | 14.242     |  22.3 |  8.12
Other   |            | 0.08536    |            |       |  0.06

Nlocal:          45.25 ave          52 max          39 min
Histogram: 1 0 0 3 1 1 0 0 1 1
Nghost:        3316.12 ave        3371 max        3275 min
Histogram: 2 0 0 1 2 1 1 0 0 1
Neighs:        28560.6 ave       32742 max       24813 min
Histogram: 1 0 1 2 1 1 0 0 1 1

Total # of neighbors = 228485
Ave neighs/atom = 631.17403
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.5867
variable dlen equal lz-${len0}
variable dlen equal lz-17.5867
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.5867
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3819999999999996732, deltaxy = 0.08382
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.030499999999999999334, deltaxz = -0.000305
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.3027000000000000246, deltayz = -0.003027
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -0.175867 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.1 | 130.6 | 132 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   291.54158     -42294.28      -1663.4393      1.6616584      3964.6564    
       100   294.35006     -42313.181     -5617.106       1.6622125      3963.3348    
       200   301.74216     -42320         -12255.615      1.6627669      3962.0133    
       300   287.50753     -42301.115      1700.876       1.6633217      3960.6917    
       400   315.15324     -42316.204      420.54621      1.6638769      3959.3702    
       500   307.66643     -42302.312     -7025.8734      1.6644325      3958.0486    
       600   293.49469     -42299.924     -2874.8554      1.6649884      3956.7271    
       700   301.37466     -42320         -1265.821       1.6655447      3955.4055    
       800   291.18154     -42323.2       -12450.422      1.6661014      3954.084     
       900   306.47524     -42343.106     -7391.3742      1.6666584      3952.7624    
      1000   311.16952     -42350.992      6881.5209      1.6672158      3951.4409    
      1100   306.46949     -42340.376     -2822.5544      1.6677736      3950.1193    
      1200   289.97982     -42321.705     -1376.537       1.6683317      3948.7978    
      1300   306.87361     -42333.519     -2865.6436      1.6688903      3947.4762    
      1400   308.18536     -42332.555      6422.3156      1.6694492      3946.1547    
      1500   295.94875     -42327.439     -9419.6044      1.6700085      3944.8331    
      1600   277.98302     -42312.596     -4181.2381      1.6705681      3943.5116    
      1700   312.32509     -42339.919     -6540.9548      1.6711281      3942.19      
      1800   300.39199     -42314.686     -2024.969       1.6716885      3940.8684    
      1900   332.41876     -42320.02       491.5464       1.6722493      3939.5469    
      2000   333.45743     -42331.731     -8465.9357      1.6728105      3938.2253    
      2100   306.20766     -42329.905      1491.5775      1.673372       3936.9038    
      2200   309.21928     -42344.167      7688.0739      1.6739339      3935.5822    
      2300   294.84475     -42343.506      18762.702      1.6744962      3934.2607    
      2400   284.05202     -42334.722      6881.1481      1.6750589      3932.9391    
      2500   298.96149     -42330.953      12021.383      1.6756219      3931.6176    
      2600   302.64373     -42309.63      -13743.344      1.6761854      3930.296     
      2700   320.96823     -42330.338      2846.6653      1.6767492      3928.9745    
      2800   312.75405     -42359.499     -4551.8141      1.6773133      3927.6529    
      2900   288.15201     -42343.249     -3082.0888      1.6778779      3926.3314    
      3000   296.68531     -42339.202     -6329.1545      1.6784428      3925.0098    
Loop time of 153.759 on 8 procs for 3000 steps with 362 atoms

Performance: 0.843 ns/day, 28.474 hours/ns, 19.511 timesteps/s, 7.063 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 105.96     | 121.68     | 130.32     |  84.2 | 79.14
Bond    | 0.0084423  | 0.0089711  | 0.0094658  |   0.3 |  0.01
Neigh   | 7.8538     | 9.1014     | 10.166     |  26.5 |  5.92
Comm    | 1.584      | 10.214     | 25.935     | 290.4 |  6.64
Output  | 0.01031    | 0.011789   | 0.013153   |   0.9 |  0.01
Modify  | 11.561     | 12.659     | 13.918     |  23.0 |  8.23
Other   |            | 0.08512    |            |       |  0.06

Nlocal:          45.25 ave          49 max          39 min
Histogram: 1 0 0 0 1 1 1 0 2 2
Nghost:        3387.62 ave        3410 max        3367 min
Histogram: 1 1 1 1 1 0 1 0 0 2
Neighs:        29137.8 ave       31430 max       25350 min
Histogram: 1 0 0 1 0 1 1 1 1 2

Total # of neighbors = 233102
Ave neighs/atom = 643.92818
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.5867
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 0.175867 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.1 | 130.6 | 132 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   291.54158     -42294.28      -1663.4393      1.6616584      3964.6564    
       100   294.33211     -42313.242     -5592.6824      1.6611047      3965.9779    
       200   301.59183     -42319.98      -12833.684      1.6605514      3967.2995    
       300   289.04981     -42302.323     -847.4814       1.6599984      3968.621     
       400   315.87849     -42317.257      243.47332      1.6594458      3969.9426    
       500   311.09748     -42308.407     -4788.8633      1.6588936      3971.2641    
       600   291.14726     -42303.714     -7991.0407      1.6583417      3972.5857    
       700   295.85272     -42319.619     -1317.2233      1.6577902      3973.9072    
       800   297.11368     -42331.573     -2049.5503      1.6572391      3975.2288    
       900   295.25278     -42328.433     -1947.0038      1.6566884      3976.5504    
      1000   291.20778     -42314.699      10816.429      1.656138       3977.8719    
      1100   316.61716     -42323.473     -3903.8253      1.6555879      3979.1935    
      1200   301.18467     -42300.655     -5565.4198      1.6550383      3980.515     
      1300   308.542       -42318.502     -11227.93       1.654489       3981.8366    
      1400   308.63323     -42338.907     -7085.8757      1.65394        3983.1581    
      1500   289.71192     -42329.125     -8129.1054      1.6533915      3984.4797    
      1600   296.54454     -42334.644     -13269.77       1.6528433      3985.8012    
      1700   299.46743     -42312.952     -10853.024      1.6522954      3987.1228    
      1800   302.82921     -42295.461     -6862.8074      1.6517479      3988.4443    
      1900   310.03175     -42305.657     -4603.3956      1.6512008      3989.7659    
      2000   293.83488     -42308.516     -7126.3308      1.6506541      3991.0874    
      2100   313.0664      -42343.762      1771.4106      1.6501077      3992.409     
      2200   295.45303     -42327.213     -12910.195      1.6495616      3993.7305    
      2300   292.81888     -42317.864     -8189.0969      1.649016       3995.0521    
      2400   321.47122     -42333.722     -3844.9351      1.6484707      3996.3736    
      2500   288.40709     -42297.098      2115.6226      1.6479257      3997.6952    
      2600   285.75743     -42321.788      4129.2249      1.6473811      3999.0167    
      2700   285.02111     -42338.509     -1666.7657      1.6468369      4000.3383    
      2800   302.139       -42371.92       3104.9235      1.646293       4001.6598    
      2900   301.01868     -42376.599     -3780.6256      1.6457495      4002.9814    
      3000   292.76542     -42358.917     -3313.2941      1.6452064      4004.3029    
Loop time of 152.624 on 8 procs for 3000 steps with 362 atoms

Performance: 0.849 ns/day, 28.264 hours/ns, 19.656 timesteps/s, 7.116 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.297     | 120.29     | 128.23     | 114.1 | 78.81
Bond    | 0.0080298  | 0.0088305  | 0.0093029  |   0.4 |  0.01
Neigh   | 6.687      | 9.1097     | 10.007     |  31.9 |  5.97
Comm    | 2.4385     | 10.386     | 42.366     | 388.1 |  6.80
Output  | 0.010509   | 0.011732   | 0.012989   |   0.8 |  0.01
Modify  | 11.817     | 12.734     | 15.184     |  27.3 |  8.34
Other   |            | 0.08835    |            |       |  0.06

Nlocal:          45.25 ave          50 max          41 min
Histogram: 1 1 0 1 1 2 0 1 0 1
Nghost:        3317.75 ave        3368 max        3264 min
Histogram: 1 0 1 2 1 0 0 0 1 2
Neighs:        28539.8 ave       31381 max       26098 min
Histogram: 2 0 1 0 1 2 0 1 0 1

Total # of neighbors = 228318
Ave neighs/atom = 630.71271
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 17.1722
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.3027)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.1722
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3819999999999996732, deltaxy = 0.08382
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.030499999999999999334, deltaxz = -0.000305
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.3027000000000000246, deltayz = -0.003027
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -0.171722 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.1 | 130.6 | 132 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   291.54158     -42294.28      -1663.4393      1.6616584      3964.6564    
       100   294.35682     -42313.183     -5613.8414      1.6616584      3964.6564    
       200   301.29398     -42320.043     -12528.553      1.6616584      3964.6564    
       300   286.8025      -42300.445      1208.844       1.6616584      3964.6564    
       400   313.9871      -42314.434      3309.9954      1.6616584      3964.6564    
       500   310.20722     -42305.519     -1478.5681      1.6616584      3964.6564    
       600   289.22466     -42299.335     -13019.783      1.6616584      3964.6564    
       700   301.62373     -42323.998      13727.558      1.6616584      3964.6564    
       800   293.09776     -42322.052      2851.1831      1.6616584      3964.6564    
       900   313.60621     -42340.702      1220.9071      1.6616584      3964.6564    
      1000   285.81519     -42308.103      1161.0677      1.6616584      3964.6564    
      1100   323.24444     -42348.95      -1301.9143      1.6616584      3964.6564    
      1200   282.69518     -42322.126      2672.3922      1.6616584      3964.6564    
      1300   299.15626     -42350.914     -3503.7681      1.6616584      3964.6564    
      1400   305.11047     -42355.251      2755.1638      1.6616584      3964.6564    
      1500   307.54256     -42347.625     -4785.9908      1.6616584      3964.6564    
      1600   301.16985     -42336.715     -6593.4843      1.6616584      3964.6564    
      1700   298.1286      -42344.821     -7131.9723      1.6616584      3964.6564    
      1800   284.21959     -42351.449     -899.02671      1.6616584      3964.6564    
      1900   276.4713      -42351.719      6910.4996      1.6616584      3964.6564    
      2000   303.97422     -42348.808      233.46282      1.6616584      3964.6564    
      2100   308.63318     -42331.477     -2746.737       1.6616584      3964.6564    
      2200   305.38903     -42327.158      567.72048      1.6616584      3964.6564    
      2300   301.57692     -42345.434     -2753.6863      1.6616584      3964.6564    
      2400   290.26763     -42350.281     -11322.127      1.6616584      3964.6564    
      2500   293.87995     -42351.297      5861.3545      1.6616584      3964.6564    
      2600   287.49027     -42345.82      -5487.778       1.6616584      3964.6564    
      2700   287.08415     -42354.552     -1295.56        1.6616584      3964.6564    
      2800   275.75128     -42361.106     -4808.7987      1.6616584      3964.6564    
      2900   283.90688     -42375.744     -5749.155       1.6616584      3964.6564    
      3000   294.59057     -42353.432     -12775.538      1.6616584      3964.6564    
Loop time of 154.158 on 8 procs for 3000 steps with 362 atoms

Performance: 0.841 ns/day, 28.548 hours/ns, 19.461 timesteps/s, 7.045 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 89.301     | 122.92     | 130.68     | 115.8 | 79.74
Bond    | 0.0082415  | 0.0089801  | 0.0096251  |   0.4 |  0.01
Neigh   | 6.7134     | 9.2879     | 10.079     |  32.9 |  6.02
Comm    | 1.2732     | 9.0361     | 42.648     | 427.0 |  5.86
Output  | 0.01058    | 0.011798   | 0.013117   |   0.8 |  0.01
Modify  | 11.992     | 12.801     | 15.402     |  28.4 |  8.30
Other   |            | 0.09188    |            |       |  0.06

Nlocal:          45.25 ave          50 max          42 min
Histogram: 3 0 1 0 0 1 1 0 1 1
Nghost:        3359.12 ave        3399 max        3319 min
Histogram: 2 1 0 0 1 0 1 1 0 2
Neighs:        28835.4 ave       31747 max       26736 min
Histogram: 3 0 1 0 1 0 1 0 1 1

Total # of neighbors = 230683
Ave neighs/atom = 637.24586
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.1722
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 0.171722 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.1 | 130.6 | 132.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   291.54158     -42294.28      -1663.4393      1.6616584      3964.6564    
       100   294.33605     -42313.208     -5598.5707      1.6616584      3964.6564    
       200   301.64019     -42320.012     -12431.028      1.6616584      3964.6564    
       300   288.36153     -42301.474      617.66517      1.6616584      3964.6564    
       400   313.69669     -42314.074      592.46295      1.6616584      3964.6564    
       500   311.93316     -42308.658     -5865.5073      1.6616584      3964.6564    
       600   288.80124     -42300.008     -11972.044      1.6616584      3964.6564    
       700   297.14015     -42319.058      6040.6401      1.6616584      3964.6564    
       800   293.67297     -42321.173     -2268.2682      1.6616584      3964.6564    
       900   301.64297     -42324.756     -8670.0427      1.6616584      3964.6564    
      1000   291.76194     -42317.63       198.69492      1.6616584      3964.6564    
      1100   302.55512     -42331.766     -8003.3723      1.6616584      3964.6564    
      1200   303.07906     -42339.545     -259.19654      1.6616584      3964.6564    
      1300   286.98903     -42324.852     -15022.191      1.6616584      3964.6564    
      1400   296.38223     -42324.774     -12178.056      1.6616584      3964.6564    
      1500   309.62953     -42322.328     -5866.0292      1.6616584      3964.6564    
      1600   306.35837     -42317.879     -820.87902      1.6616584      3964.6564    
      1700   305.44012     -42339.052     -3609.2958      1.6616584      3964.6564    
      1800   288.9805      -42342.096     -8698.5778      1.6616584      3964.6564    
      1900   289.52808     -42334.955     -8942.0035      1.6616584      3964.6564    
      2000   307.3081      -42313.302     -8591.6183      1.6616584      3964.6564    
      2100   305.72688     -42313.352      1084.1947      1.6616584      3964.6564    
      2200   298.50369     -42328.161      6464.3746      1.6616584      3964.6564    
      2300   286.84787     -42337.133     -7007.8304      1.6616584      3964.6564    
      2400   278.73306     -42331.403     -4681.4914      1.6616584      3964.6564    
      2500   289.88356     -42318.667      2771.8063      1.6616584      3964.6564    
      2600   325.38361     -42327.167     -6469.8688      1.6616584      3964.6564    
      2700   321.15578     -42331.724     -10920.862      1.6616584      3964.6564    
      2800   291.13983     -42321.414     -2855.0358      1.6616584      3964.6564    
      2900   283.43186     -42327.492     -9048.7877      1.6616584      3964.6564    
      3000   301.55742     -42344.247     -8682.0386      1.6616584      3964.6564    
Loop time of 154.078 on 8 procs for 3000 steps with 362 atoms

Performance: 0.841 ns/day, 28.533 hours/ns, 19.471 timesteps/s, 7.048 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 90.87      | 123.13     | 130.45     | 111.3 | 79.91
Bond    | 0.0084492  | 0.0090994  | 0.0098575  |   0.4 |  0.01
Neigh   | 6.8919     | 9.3761     | 10.121     |  31.6 |  6.09
Comm    | 1.4209     | 8.7405     | 40.994     | 417.6 |  5.67
Output  | 0.010944   | 0.012616   | 0.01429    |   1.0 |  0.01
Modify  | 11.965     | 12.717     | 15.226     |  27.4 |  8.25
Other   |            | 0.09322    |            |       |  0.06

Nlocal:          45.25 ave          52 max          40 min
Histogram: 1 1 1 1 1 1 0 0 1 1
Nghost:        3371.12 ave        3412 max        3335 min
Histogram: 1 2 1 0 0 1 0 1 1 1
Neighs:          28838 ave       32968 max       25728 min
Histogram: 1 1 1 2 1 0 0 0 1 1

Total # of neighbors = 230704
Ave neighs/atom = 637.30387
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.1279
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-0.0305)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.1279
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3819999999999996732, deltaxy = 0.08382
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.030499999999999999334, deltaxz = -0.000305
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.3027000000000000246, deltayz = -0.003027
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -0.131279 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.1 | 130.6 | 132 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   291.54158     -42294.28      -1663.4393      1.6616584      3964.6564    
       100   294.36487     -42313.226     -5607.2936      1.6616584      3964.6564    
       200   301.55515     -42320.102     -12404.4        1.6616584      3964.6564    
       300   287.58136     -42300.917      959.8975       1.6616584      3964.6564    
       400   313.40903     -42313.493      632.9583       1.6616584      3964.6564    
       500   308.95725     -42304.603     -2392.9063      1.6616584      3964.6564    
       600   287.43794     -42296.719     -9132.0694      1.6616584      3964.6564    
       700   295.76612     -42314.442     -2170.4558      1.6616584      3964.6564    
       800   306.2535      -42331.935     -11121.519      1.6616584      3964.6564    
       900   320.23707     -42341.809     -1503.6753      1.6616584      3964.6564    
      1000   290.81444     -42312.665      4837.6257      1.6616584      3964.6564    
      1100   306.7304      -42347.859      1761.6027      1.6616584      3964.6564    
      1200   309.76378     -42372.763     -2442.9216      1.6616584      3964.6564    
      1300   309.08409     -42371.438      1867.2508      1.6616584      3964.6564    
      1400   302.6636      -42341.662     -7015.0025      1.6616584      3964.6564    
      1500   308.35183     -42323.581      5287.0604      1.6616584      3964.6564    
      1600   310.72115     -42325.867      4748.1196      1.6616584      3964.6564    
      1700   292.97564     -42331.29      -903.89205      1.6616584      3964.6564    
      1800   298.10057     -42359.807     -13411.662      1.6616584      3964.6564    
      1900   277.17236     -42336.375     -10790.903      1.6616584      3964.6564    
      2000   304.56845     -42352.225      11831.358      1.6616584      3964.6564    
      2100   299.98817     -42343.681     -11955.869      1.6616584      3964.6564    
      2200   287.90302     -42328.482     -2842.1997      1.6616584      3964.6564    
      2300   296.82154     -42336.445     -11917.861      1.6616584      3964.6564    
      2400   314.89636     -42321.409     -9782.7458      1.6616584      3964.6564    
      2500   332.79453     -42333.413     -5699.6219      1.6616584      3964.6564    
      2600   298.77399     -42327.187     -1491.2138      1.6616584      3964.6564    
      2700   311.52152     -42355.164      759.16141      1.6616584      3964.6564    
      2800   297.63303     -42352.677     -8360.7402      1.6616584      3964.6564    
      2900   309.84143     -42362.927      1832.4067      1.6616584      3964.6564    
      3000   308.07599     -42344.043     -10865.236      1.6616584      3964.6564    
Loop time of 152.549 on 8 procs for 3000 steps with 362 atoms

Performance: 0.850 ns/day, 28.250 hours/ns, 19.666 timesteps/s, 7.119 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 89.398     | 117.89     | 129.3      | 121.5 | 77.28
Bond    | 0.0081657  | 0.0089968  | 0.0094853  |   0.4 |  0.01
Neigh   | 6.7279     | 8.9277     | 10.112     |  35.7 |  5.85
Comm    | 1.508      | 12.914     | 41.378     | 366.8 |  8.47
Output  | 0.0095016  | 0.010567   | 0.011668   |   0.7 |  0.01
Modify  | 11.507     | 12.717     | 14.96      |  30.5 |  8.34
Other   |            | 0.08257    |            |       |  0.05

Nlocal:          45.25 ave          51 max          41 min
Histogram: 2 0 2 0 1 0 0 1 0 2
Nghost:         3359.5 ave        3390 max        3336 min
Histogram: 2 0 0 2 2 0 0 0 1 1
Neighs:        28849.6 ave       32346 max       26326 min
Histogram: 2 1 1 1 0 0 0 1 0 2

Total # of neighbors = 230797
Ave neighs/atom = 637.56077
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.005 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.1279
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 0.131279 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.1 | 130.6 | 132.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   291.54158     -42294.28      -1663.4393      1.6616584      3964.6564    
       100   294.33237     -42313.199     -5596.7373      1.6616584      3964.6564    
       200   301.34782     -42319.878     -12569.805      1.6616584      3964.6564    
       300   287.6331      -42300.882      443.90717      1.6616584      3964.6564    
       400   312.89345     -42313.346      2405.1204      1.6616584      3964.6564    
       500   308.15532     -42304.02      -1896.2151      1.6616584      3964.6564    
       600   288.90292     -42299.206     -892.88606      1.6616584      3964.6564    
       700   293.24368     -42317.374     -735.87588      1.6616584      3964.6564    
       800   291.74957     -42328.959     -4658.5649      1.6616584      3964.6564    
       900   306.89215     -42343.493     -7475.1103      1.6616584      3964.6564    
      1000   285.98557     -42312.118      6137.8892      1.6616584      3964.6564    
      1100   303.45031     -42324.06       789.39877      1.6616584      3964.6564    
      1200   286.27073     -42305.951     -9915.4658      1.6616584      3964.6564    
      1300   312.26241     -42327.688     -10967.195      1.6616584      3964.6564    
      1400   307.50223     -42324.453     -6154.3114      1.6616584      3964.6564    
      1500   290.33668     -42313.573     -7021.5204      1.6616584      3964.6564    
      1600   292.74539     -42325.879     -7123.8343      1.6616584      3964.6564    
      1700   301.99042     -42340.462     -12918.926      1.6616584      3964.6564    
      1800   296.87386     -42337.826      3427.0325      1.6616584      3964.6564    
      1900   299.38318     -42340.366     -11010.52       1.6616584      3964.6564    
      2000   297.56025     -42329.515     -1738.5497      1.6616584      3964.6564    
      2100   316.70711     -42337.251     -11810.033      1.6616584      3964.6564    
      2200   312.82265     -42345.049     -7489.2234      1.6616584      3964.6564    
      2300   293.71812     -42352.924     -9050.078       1.6616584      3964.6564    
      2400   290.74669     -42353.709     -4024.566       1.6616584      3964.6564    
      2500   293.21982     -42336.337      5065.3905      1.6616584      3964.6564    
      2600   313.89153     -42317.137     -7575.5069      1.6616584      3964.6564    
      2700   331.93537     -42326.174     -9572.4014      1.6616584      3964.6564    
      2800   313.1832      -42322.932     -20953.467      1.6616584      3964.6564    
      2900   303.1267      -42332.841     -3535.064       1.6616584      3964.6564    
      3000   300.71153     -42339.134      9273.5066      1.6616584      3964.6564    
Loop time of 152.807 on 8 procs for 3000 steps with 362 atoms

Performance: 0.848 ns/day, 28.298 hours/ns, 19.633 timesteps/s, 7.107 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 89.773     | 118.44     | 129.83     | 143.0 | 77.51
Bond    | 0.0080644  | 0.0089395  | 0.0095621  |   0.4 |  0.01
Neigh   | 6.7697     | 8.9794     | 10.194     |  41.4 |  5.88
Comm    | 1.2824     | 12.666     | 41.309     | 436.8 |  8.29
Output  | 0.010137   | 0.011177   | 0.012269   |   0.7 |  0.01
Modify  | 11.366     | 12.611     | 14.868     |  35.6 |  8.25
Other   |            | 0.08565    |            |       |  0.06

Nlocal:          45.25 ave          49 max          40 min
Histogram: 1 0 0 1 1 1 1 1 1 1
Nghost:        3366.12 ave        3401 max        3336 min
Histogram: 1 0 2 2 0 0 0 1 1 1
Neighs:          28866 ave       31217 max       25519 min
Histogram: 1 0 0 1 1 1 1 1 1 1

Total # of neighbors = 230928
Ave neighs/atom = 637.92265
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.5867
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--8.382)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.5867
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3819999999999996732, deltaxy = 0.08382
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.030499999999999999334, deltaxz = -0.000305
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.3027000000000000246, deltayz = -0.003027
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -0.175867 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.1 | 130.6 | 132 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   291.54158     -42294.28      -1663.4393      1.6616584      3964.6564    
       100   294.41402     -42313.233     -5640.6279      1.6616584      3964.6564    
       200   301.37462     -42320.306     -12745.826      1.6616584      3964.6564    
       300   289.24513     -42303.159      487.40347      1.6616584      3964.6564    
       400   311.74513     -42310.892      2537.4322      1.6616584      3964.6564    
       500   309.82842     -42303.447     -6574.4751      1.6616584      3964.6564    
       600   292.70208     -42301.586     -5746.402       1.6616584      3964.6564    
       700   302.01985     -42326.077     -4079.4963      1.6616584      3964.6564    
       800   291.25682     -42326.621     -7751.6351      1.6616584      3964.6564    
       900   302.47869     -42331.697     -1704.1534      1.6616584      3964.6564    
      1000   291.13798     -42305.513     -3868.1432      1.6616584      3964.6564    
      1100   312.16976     -42316.991      3382.3342      1.6616584      3964.6564    
      1200   304.49172     -42319.278     -1638.8833      1.6616584      3964.6564    
      1300   295.03114     -42322.076     -19501.701      1.6616584      3964.6564    
      1400   281.89647     -42320.668      3836.1187      1.6616584      3964.6564    
      1500   284.93058     -42329.255      3116.8037      1.6616584      3964.6564    
      1600   292.99511     -42323.298     -17511.426      1.6616584      3964.6564    
      1700   309.19086     -42314.895     -6726.6698      1.6616584      3964.6564    
      1800   303.06289     -42301.9       -1480.8545      1.6616584      3964.6564    
      1900   287.43735     -42311.149     -442.97959      1.6616584      3964.6564    
      2000   293.61023     -42334.57      -9841.1851      1.6616584      3964.6564    
      2100   295.47219     -42332.17       763.76512      1.6616584      3964.6564    
      2200   301.56405     -42325.723     -9572.3441      1.6616584      3964.6564    
      2300   321.07545     -42330.163      3508.5398      1.6616584      3964.6564    
      2400   315.40073     -42332.267      4558.3972      1.6616584      3964.6564    
      2500   290.82867     -42344.218      992.1836       1.6616584      3964.6564    
      2600   281.68604     -42336.793      4464.7229      1.6616584      3964.6564    
      2700   301.16195     -42340.049      8739.4602      1.6616584      3964.6564    
      2800   290.70346     -42307.423     -1887.5449      1.6616584      3964.6564    
      2900   313.26086     -42321.441     -1446.162       1.6616584      3964.6564    
      3000   305.46772     -42322.576     -8665.8104      1.6616584      3964.6564    
Loop time of 147.163 on 8 procs for 3000 steps with 362 atoms

Performance: 0.881 ns/day, 27.252 hours/ns, 20.386 timesteps/s, 7.380 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 87.984     | 107.16     | 122.63     | 113.2 | 72.82
Bond    | 0.007595   | 0.0083443  | 0.009074   |   0.5 |  0.01
Neigh   | 6.8759     | 8.4471     | 10.027     |  34.8 |  5.74
Comm    | 3.0349     | 18.493     | 37.671     | 272.5 | 12.57
Output  | 0.0082983  | 0.009478   | 0.010552   |   0.8 |  0.01
Modify  | 11.355     | 12.957     | 14.543     |  28.4 |  8.80
Other   |            | 0.08327    |            |       |  0.06

Nlocal:          45.25 ave          55 max          39 min
Histogram: 1 1 1 2 1 0 1 0 0 1
Nghost:        3362.12 ave        3412 max        3327 min
Histogram: 1 1 2 0 2 0 0 0 0 2
Neighs:        28870.2 ave       34887 max       25051 min
Histogram: 1 1 2 1 1 0 1 0 0 1

Total # of neighbors = 230962
Ave neighs/atom = 638.01657
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.5867
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 0.175867 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.1 | 130.6 | 132.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   291.54158     -42294.28      -1663.4393      1.6616584      3964.6564    
       100   294.28064     -42313.038     -5457.1983      1.6616584      3964.6564    
       200   302.1928      -42320.481     -12002.414      1.6616584      3964.6564    
       300   290.08386     -42303.323     -1536.0653      1.6616584      3964.6564    
       400   308.36939     -42308.52       3988.879       1.6616584      3964.6564    
       500   305.1154      -42301.489     -2131.7068      1.6616584      3964.6564    
       600   293.26614     -42305.33      -12823.101      1.6616584      3964.6564    
       700   295.7491      -42316.666     -918.36628      1.6616584      3964.6564    
       800   291.58417     -42318.4       -5535.0229      1.6616584      3964.6564    
       900   308.63738     -42331.08      -5168.8722      1.6616584      3964.6564    
      1000   310.0556      -42328.869     -5960.655       1.6616584      3964.6564    
      1100   324.30509     -42335.859     -3567.7364      1.6616584      3964.6564    
      1200   302.36742     -42311.767     -3706.1223      1.6616584      3964.6564    
      1300   294.94015     -42303.679     -13309.488      1.6616584      3964.6564    
      1400   294.16735     -42312.903     -14058.281      1.6616584      3964.6564    
      1500   290.03548     -42318.485     -13145.02       1.6616584      3964.6564    
      1600   292.8835      -42323.42      -15462.759      1.6616584      3964.6564    
      1700   304.25035     -42323.881     -4292.1115      1.6616584      3964.6564    
      1800   280.44886     -42280.286     -11584.9        1.6616584      3964.6564    
      1900   314.81578     -42299.758     -1304.2677      1.6616584      3964.6564    
      2000   306.63774     -42321.69      -8023.607       1.6616584      3964.6564    
      2100   285.90026     -42322.906     -5370.1321      1.6616584      3964.6564    
      2200   302.61603     -42333.314      14772.748      1.6616584      3964.6564    
      2300   321.46971     -42345.936      8155.4789      1.6616584      3964.6564    
      2400   302.66433     -42326.113     -2871.0095      1.6616584      3964.6564    
      2500   307.06363     -42341.161      1858.4989      1.6616584      3964.6564    
      2600   300.96436     -42358.905     -622.67331      1.6616584      3964.6564    
      2700   277.19153     -42333.311      1796.2713      1.6616584      3964.6564    
      2800   314.54535     -42344.329     -4880.5739      1.6616584      3964.6564    
      2900   310.63957     -42325.882     -3431.8609      1.6616584      3964.6564    
      3000   317.49574     -42339.757     -7797.5277      1.6616584      3964.6564    
Loop time of 114.322 on 8 procs for 3000 steps with 362 atoms

Performance: 1.134 ns/day, 21.171 hours/ns, 26.242 timesteps/s, 9.500 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 75.902     | 84.864     | 94.916     |  82.8 | 74.23
Bond    | 0.0070289  | 0.007607   | 0.0083566  |   0.4 |  0.01
Neigh   | 6.5977     | 7.3442     | 8.2658     |  24.1 |  6.42
Comm    | 1.0708     | 11.12      | 20.074     | 228.5 |  9.73
Output  | 0.0069408  | 0.0080126  | 0.0090092  |   0.8 |  0.01
Modify  | 9.9667     | 10.905     | 11.665     |  20.1 |  9.54
Other   |            | 0.07412    |            |       |  0.06

Nlocal:          45.25 ave          54 max          38 min
Histogram: 1 1 0 1 2 1 1 0 0 1
Nghost:        3355.38 ave        3386 max        3319 min
Histogram: 1 0 1 0 1 2 0 2 0 1
Neighs:        28843.2 ave       34209 max       24505 min
Histogram: 1 1 1 0 2 1 1 0 0 1

Total # of neighbors = 230746
Ave neighs/atom = 637.41989
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:32:31
