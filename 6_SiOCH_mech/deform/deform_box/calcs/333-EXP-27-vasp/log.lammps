LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-EXP-27-vasp
read_data       ${structure}.data
read_data       333-EXP-27-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.007 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.864 | 6.864 | 6.865 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              262.90745      3534.467     
         1   300            0              0              262.90745      3534.467     
Loop time of 7.01666e-05 on 16 procs for 1 steps with 295 atoms

44.9% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.04e-07   | 2.29e-07   | 3.52e-07   |   0.0 |  0.33
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 7.86e-07   | 1.3354e-06 | 1.928e-06  |   0.0 |  1.90
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 6.86e-05   |            |       | 97.77

Nlocal:         36.875 ave          42 max          32 min
Histogram: 1 0 1 1 1 0 1 2 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-EXP-27-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -2.46 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.1 | 117.7 | 119.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -32892.733      87025.291      0              1.5382232      3400.2575    
       100   608.54863     -33796.701     -2392.3085      8736.5668      1.5382232      3400.2575    
       200   412.88058     -33956.307     -12845.31       4422.8262      1.5382232      3400.2575    
       300   365.52099     -34040.676     -10686.645     -1112.2235      1.5382232      3400.2575    
       400   349.74121     -34097.728      5491.4097     -4440.145       1.5382232      3400.2575    
       500   334.68517     -34155.472      1849.8156     -1441.7312      1.5382232      3400.2575    
       600   312.86715     -34157.603     -6824.1144     -2237.7487      1.5382232      3400.2575    
       700   324.24595     -34173.763      1512.7379     -2470.8364      1.5382232      3400.2575    
       800   295.51703     -34176.973      1892.5321      2276.4948      1.5382232      3400.2575    
       900   313.34419     -34187.187      3133.8858      975.92437      1.5382232      3400.2575    
      1000   306.95018     -34166.967     -13883.079     -1977.8294      1.5382232      3400.2575    
      1100   305.06867     -34163.497     -6113.1045      1699.8812      1.5382232      3400.2575    
      1200   321.35479     -34197.975     -8149.2843      6480.7734      1.5382232      3400.2575    
      1300   310.46383     -34198.643      7079.0201      3410.7466      1.5382232      3400.2575    
      1400   316.29411     -34200.69       7922.9912      3073.8298      1.5382232      3400.2575    
      1500   317.5869      -34207.175     -9116.3868     -1640.3367      1.5382232      3400.2575    
      1600   312.13038     -34229.32       1625.3603      186.09579      1.5382232      3400.2575    
      1700   304.38738     -34215.837     -3690.7368     -1188.9706      1.5382232      3400.2575    
      1800   315.83722     -34224.146     -9532.2506      993.75023      1.5382232      3400.2575    
      1900   314.30071     -34218.925     -6233.7304      5194.8699      1.5382232      3400.2575    
      2000   341.07846     -34221.776     -6656.1882     -1193.684       1.5382232      3400.2575    
Loop time of 88.5578 on 16 procs for 2000 steps with 295 atoms

Performance: 0.976 ns/day, 24.599 hours/ns, 22.584 timesteps/s, 6.662 katom-step/s
98.7% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.69      | 64.772     | 66.857     |  21.5 | 73.14
Bond    | 0.00071824 | 0.00084841 | 0.0010612  |   0.0 |  0.00
Neigh   | 5.4328     | 5.5239     | 5.6261     |   2.8 |  6.24
Comm    | 6.1517     | 8.1834     | 11.248     |  60.7 |  9.24
Output  | 0.0011865  | 0.0014744  | 0.0032956  |   1.8 |  0.00
Modify  | 9.6151     | 9.7232     | 9.8128     |   2.3 | 10.98
Other   |            | 0.3531     |            |       |  0.40

Nlocal:         36.875 ave          39 max          30 min
Histogram: 1 0 0 0 0 1 0 2 0 4
Nghost:        3008.25 ave        3046 max        2963 min
Histogram: 1 0 1 0 1 2 1 0 0 2
Neighs:        22492.1 ave       23846 max       18486 min
Histogram: 1 0 0 0 0 1 0 2 0 4

Total # of neighbors = 179937
Ave neighs/atom = 609.95593
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]
# use tmp to save constants
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.1447
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.6088
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 16.498

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--1193.68402345267)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--1193.68402345267)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--6648.27417376758)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--6648.27417376758)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-2348.67319095736)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-2348.67319095736)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-70.6239939329801)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-70.6239939329801)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-1135.17701079551)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-1135.17701079551)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--1257.45234326343)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--1257.45234326343)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 15.1447
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.1447
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.151447 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.151447 xy delta 0.076974 xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.151447 xy delta 0.076974 xz delta 0.006366 remap x units box
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.2 | 118.6 | 120 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   341.07846     -34221.776     -6656.1132      0              3400.2575    
       100   291.35987     -34222.576      3663.5995      2314.8759      3398.5574    
       200   296.40244     -34238.3       -5388.25        2598.1108      3396.8572    
       300   290.07863     -34246.715     -1781.767       2191.0523      3395.1571    
       400   313.68087     -34296.073     -2944.031       4669.9007      3393.457     
       500   320.03788     -34290.848      7327.1709      5232.8462      3391.7568    
       600   272.56271     -34282.503     -15298.419      4212.6811      3390.0567    
       700   276.21689     -34279.488      3009.5902      1969.8687      3388.3566    
       800   318.17969     -34295.414      1158.6904      2688.6358      3386.6565    
       900   285.29449     -34284.74       3118.1705      3116.3465      3384.9563    
      1000   310.67036     -34288.89       4618.4315     -2651.7426      3383.2562    
      1100   311.77014     -34288.881      14917.968     -1275.2049      3381.5561    
      1200   288.26162     -34278.241      4796.4166      399.83368      3379.8559    
      1300   296.20124     -34297.636     -7613.6251     -1828.913       3378.1558    
      1400   315.3692      -34271.418      5959.3742     -5512.0808      3376.4557    
      1500   300.7456      -34299.903      9684.1476      1626.2028      3374.7556    
      1600   281.12525     -34279.417     -2473.9673     -2119.8274      3373.0554    
      1700   296.61015     -34273.36       8115.0521      4790.2779      3371.3553    
      1800   313.13158     -34299.043     -10048.778      1135.2805      3369.6552    
      1900   303.50428     -34280.299      7446.8418      4132.9833      3367.955     
      2000   312.50574     -34288.107      339.52731      3673.6262      3366.2549    
Loop time of 90.4279 on 16 procs for 2000 steps with 295 atoms

Performance: 0.955 ns/day, 25.119 hours/ns, 22.117 timesteps/s, 6.525 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.291     | 66.283     | 69.414     |  26.2 | 73.30
Bond    | 0.00069714 | 0.00082683 | 0.0010106  |   0.0 |  0.00
Neigh   | 5.3791     | 5.5119     | 5.6301     |   3.8 |  6.10
Comm    | 5.334      | 8.4899     | 11.429     |  73.3 |  9.39
Output  | 0.0068682  | 0.016509   | 0.026646   |   6.0 |  0.02
Modify  | 9.6764     | 9.7728     | 9.8673     |   2.1 | 10.81
Other   |            | 0.3527     |            |       |  0.39

Nlocal:         36.875 ave          42 max          28 min
Histogram: 1 0 0 0 0 3 1 1 0 2
Nghost:        3001.38 ave        3051 max        2958 min
Histogram: 2 0 0 1 2 1 0 0 1 1
Neighs:        22707.1 ave       25672 max       17485 min
Histogram: 1 0 0 0 0 3 1 1 0 2

Total # of neighbors = 181657
Ave neighs/atom = 615.78644
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 49.3180203989602
variable C2neg equal ${d2}
variable C2neg equal 35.126851217747
variable C3neg equal ${d3}
variable C3neg equal -9.27696135405564
variable C4neg equal ${d4}
variable C4neg equal -7.76480439610322
variable C5neg equal ${d5}
variable C5neg equal 9.80889659736976
variable C6neg equal ${d6}
variable C6neg equal 1.48258199380953

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.1447
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.151447 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.151447 xy delta -0.076974 xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.151447 xy delta -0.076974 xz delta -0.006366 remap x units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.2 | 118.6 | 120 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   341.07846     -34221.776     -6656.1132      0              3400.2575    
       100   291.35987     -34222.576      3659.9377      2314.177       3401.9576    
       200   316.66968     -34252.62       3138.0111      3447.5056      3403.6577    
       300   325.63729     -34284.347     -2998.4858     -4516.3696      3405.3579    
       400   316.82526     -34266.129      496.15898     -1295.876       3407.058     
       500   307.86509     -34273.549      3994.3532      4718.8857      3408.7581    
       600   295.88792     -34271.815     -11770.572      2355.972       3410.4583    
       700   301.10054     -34273.103      18300.712      1582.5016      3412.1584    
       800   299.44117     -34291.77       3348.7198      1547.0429      3413.8585    
       900   279.56813     -34258.539      19519.144      4224.3679      3415.5586    
      1000   309.93278     -34287.591     -853.13729     -660.85177      3417.2588    
      1100   310.81984     -34251.648     -6427.0065     -5276.2064      3418.9589    
      1200   298.90845     -34248.378     -7173.982      -7588.1513      3420.659     
      1300   296.84227     -34273.149     -5275.9667     -1550.8588      3422.3592    
      1400   300.59641     -34284.175     -2929.7702     -7518.7944      3424.0593    
      1500   294.80673     -34286.993     -6735.0887     -2682.5916      3425.7594    
      1600   306.92812     -34294.414      618.08752     -4279.3887      3427.4595    
      1700   299.47674     -34277.995     -10017.211     -1233.7703      3429.1597    
      1800   296.22256     -34285.637     -16730.544     -3660.0971      3430.8598    
      1900   321.86374     -34275.031     -4816.123      -5945.1502      3432.5599    
      2000   302.75699     -34266.675     -14646.535     -7102.5579      3434.2601    
Loop time of 89.0417 on 16 procs for 2000 steps with 295 atoms

Performance: 0.970 ns/day, 24.734 hours/ns, 22.461 timesteps/s, 6.626 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.455     | 65.414     | 67.16      |  16.3 | 73.46
Bond    | 0.00065155 | 0.0007915  | 0.0009209  |   0.0 |  0.00
Neigh   | 5.3339     | 5.4508     | 5.6038     |   3.4 |  6.12
Comm    | 6.3388     | 8.1296     | 10.113     |  46.4 |  9.13
Output  | 0.0049417  | 0.014353   | 0.02369    |   6.3 |  0.02
Modify  | 9.5294     | 9.6975     | 9.797      |   2.9 | 10.89
Other   |            | 0.3342     |            |       |  0.38

Nlocal:         36.875 ave          40 max          31 min
Histogram: 1 0 0 1 1 0 1 1 0 3
Nghost:        2958.25 ave        3018 max        2902 min
Histogram: 1 1 1 0 2 0 0 2 0 1
Neighs:        22280.5 ave       24178 max       18885 min
Histogram: 1 0 0 1 1 0 1 1 0 3

Total # of neighbors = 178244
Ave neighs/atom = 604.21695
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 59.8716646561408
variable C2pos equal ${d2}
variable C2pos equal 24.1819132101296
variable C3pos equal ${d3}
variable C3pos equal 39.9770207696852
variable C4pos equal ${d4}
variable C4pos equal -2.55186571781244
variable C5pos equal ${d5}
variable C5pos equal 4.97080016263056
variable C6pos equal ${d6}
variable C6pos equal 1.91133785969112

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(49.3180203989602+${C1pos})
variable C11 equal 0.5*(49.3180203989602+59.8716646561408)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(35.126851217747+${C2pos})
variable C21 equal 0.5*(35.126851217747+24.1819132101296)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(-9.27696135405564+${C3pos})
variable C31 equal 0.5*(-9.27696135405564+39.9770207696852)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-7.76480439610322+${C4pos})
variable C41 equal 0.5*(-7.76480439610322+-2.55186571781244)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(9.80889659736976+${C5pos})
variable C51 equal 0.5*(9.80889659736976+4.97080016263056)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(1.48258199380953+${C6pos})
variable C61 equal 0.5*(1.48258199380953+1.91133785969112)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.6088
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.6088
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.136088 yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.136088 yz delta -0.005805 remap x units box
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.2 | 118.6 | 120 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   341.07846     -34221.776     -6656.1132      0              3400.2575    
       100   291.35987     -34222.576      3663.5995      2314.8759      3398.5574    
       200   316.15411     -34245.591      4899.5243      4279.5799      3396.8572    
       300   300.71236     -34259.131      6616.5092      1514.0792      3395.1571    
       400   303.43238     -34267.614     -7045.634      -3353.9023      3393.457     
       500   322.049       -34273.57      -5747.1179     -2087.6544      3391.7568    
       600   296.47701     -34267.054     -14570          3680.3715      3390.0567    
       700   329.82118     -34279.828     -8127.8082     -3214.8286      3388.3566    
       800   327.47498     -34259.617     -8614.3042      2780.4995      3386.6565    
       900   312.14397     -34243.311      5064.9088      1279.2791      3384.9563    
      1000   331.34317     -34290.51      -5314.8667     -3147.9241      3383.2562    
      1100   308.63058     -34276.084     -5223.8699      369.45391      3381.5561    
      1200   305.25426     -34283.477      9424.672       479.22162      3379.8559    
      1300   306.4005      -34303.374      8863.6154      5287.495       3378.1558    
      1400   299.77354     -34260.04       8552.4269      3968.8949      3376.4557    
      1500   323.78775     -34294.237     -22410.717      2347.6796      3374.7556    
      1600   309.53609     -34280.773      6894.8164      1145.887       3373.0554    
      1700   343.5194      -34299.746      5767.4645      8357.1567      3371.3553    
      1800   304.01679     -34275.948     -9901.6312     -253.37048      3369.6552    
      1900   304.68498     -34278.994     -8984.6151      4606.0021      3367.955     
      2000   312.36298     -34291.431     -6002.308      -2721.7349      3366.2549    
Loop time of 90.2902 on 16 procs for 2000 steps with 295 atoms

Performance: 0.957 ns/day, 25.081 hours/ns, 22.151 timesteps/s, 6.534 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.054     | 66.104     | 69.346     |  23.6 | 73.21
Bond    | 0.00066827 | 0.00079428 | 0.00095525 |   0.0 |  0.00
Neigh   | 5.3356     | 5.4948     | 5.69       |   5.5 |  6.09
Comm    | 5.3335     | 8.5558     | 11.528     |  65.1 |  9.48
Output  | 0.0054387  | 0.013567   | 0.022938   |   5.8 |  0.02
Modify  | 9.6043     | 9.7783     | 9.9304     |   4.0 | 10.83
Other   |            | 0.3428     |            |       |  0.38

Nlocal:         36.875 ave          43 max          32 min
Histogram: 2 1 1 0 0 0 2 1 0 1
Nghost:         3011.5 ave        3069 max        2952 min
Histogram: 1 1 0 0 2 1 1 0 1 1
Neighs:        22672.6 ave       26186 max       19873 min
Histogram: 2 1 1 0 0 0 2 1 0 1

Total # of neighbors = 181381
Ave neighs/atom = 614.85085
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -15.4829754974953
variable C2neg equal ${d2}
variable C2neg equal 41.3065761604192
variable C3neg equal ${d3}
variable C3neg equal -36.7706514470536
variable C4neg equal ${d4}
variable C4neg equal -11.062367231919
variable C5neg equal ${d5}
variable C5neg equal 4.80039479682604
variable C6neg equal ${d6}
variable C6neg equal 3.26580217761564

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.011 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.6088
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.136088 yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.136088 yz delta 0.005805 remap x units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.2 | 118.6 | 120 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   341.07846     -34221.776     -6656.1132      0              3400.2575    
       100   291.35987     -34222.576      3659.9377      2314.177       3401.9576    
       200   317.00551     -34252.227      2407.8058      3709.3146      3403.6577    
       300   309.9259      -34273.816      2335.2409     -3926.1594      3405.3579    
       400   297.49271     -34260.434      9883.5374      668.74125      3407.058     
       500   299.52425     -34265.809      2279.6501      5748.1775      3408.7581    
       600   318.06273     -34265.208     -5606.1567      2440.3051      3410.4583    
       700   305.01306     -34281.076     -11779.258      3001.0979      3412.1584    
       800   258.11115     -34263.778      17323.057      3359.0649      3413.8585    
       900   290.95051     -34290.931     -15416.829      8005.6901      3415.5586    
      1000   278.79575     -34276.052      14701.831      1642.4437      3417.2588    
      1100   304.9793      -34294.644      15044.22       10782.2        3418.9589    
      1200   299.86516     -34259.018     -10988.055      2729.0285      3420.659     
      1300   303.62719     -34292.212     -18671.227     -1534.5006      3422.3592    
      1400   301.47673     -34276.574     -1556.6884      2564.2604      3424.0593    
      1500   303.81971     -34282.19       1882.6383     -4140.9928      3425.7594    
      1600   285.31487     -34294.217      4955.1275     -296.13693      3427.4595    
      1700   306.13263     -34289.797      3002.3         7482.72        3429.1597    
      1800   296.87342     -34294.539      1687.8692      6183.7187      3430.8598    
      1900   337.2041      -34297.494      867.37951      3275.9763      3432.5599    
      2000   300.93868     -34298.729      7375.4297      6057.3044      3434.2601    
Loop time of 88.8942 on 16 procs for 2000 steps with 295 atoms

Performance: 0.972 ns/day, 24.693 hours/ns, 22.499 timesteps/s, 6.637 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 62.619     | 64.69      | 66.709     |  18.9 | 72.77
Bond    | 0.00065249 | 0.0007875  | 0.00092581 |   0.0 |  0.00
Neigh   | 5.2219     | 5.3926     | 5.6004     |   5.6 |  6.07
Comm    | 6.5989     | 8.65       | 10.718     |  51.4 |  9.73
Output  | 0.0051226  | 0.0094284  | 0.015224   |   3.8 |  0.01
Modify  | 9.5819     | 9.8234     | 10.006     |   4.6 | 11.05
Other   |            | 0.3278     |            |       |  0.37

Nlocal:         36.875 ave          44 max          29 min
Histogram: 1 0 0 2 1 0 2 0 1 1
Nghost:        2949.75 ave        3012 max        2872 min
Histogram: 1 1 0 0 0 3 1 0 0 2
Neighs:        22257.4 ave       26216 max       17758 min
Histogram: 1 0 0 2 1 0 2 0 1 1

Total # of neighbors = 178059
Ave neighs/atom = 603.58983
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -73.4706404153376
variable C2pos equal ${d2}
variable C2pos equal -64.2111659882083
variable C3pos equal ${d3}
variable C3pos equal 40.2096173954189
variable C4pos equal ${d4}
variable C4pos equal 22.4818963053517
variable C5pos equal ${d5}
variable C5pos equal -10.312180926084
variable C6pos equal ${d6}
variable C6pos equal 6.26627146862603

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(-15.4829754974953+${C1pos})
variable C12 equal 0.5*(-15.4829754974953+-73.4706404153376)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(41.3065761604192+${C2pos})
variable C22 equal 0.5*(41.3065761604192+-64.2111659882083)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(-36.7706514470536+${C3pos})
variable C32 equal 0.5*(-36.7706514470536+40.2096173954189)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-11.062367231919+${C4pos})
variable C42 equal 0.5*(-11.062367231919+22.4818963053517)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(4.80039479682604+${C5pos})
variable C52 equal 0.5*(4.80039479682604+-10.312180926084)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(3.26580217761564+${C6pos})
variable C62 equal 0.5*(3.26580217761564+6.26627146862603)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.498
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.498
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 -0.16498 remap x units box
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.2 | 118.5 | 120 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   341.07846     -34221.776     -6656.1132      0              3400.2575    
       100   291.35987     -34222.576      3663.5995      2314.8759      3398.5574    
       200   309.0482      -34259.842      3364.7573      5192.0374      3396.8572    
       300   296.78444     -34259.246      8310.7131     -4050.4988      3395.1571    
       400   305.81597     -34277.009      19493.698      8101.1833      3393.457     
       500   301.63774     -34277.733      3412.8275      5079.7754      3391.7568    
       600   278.77876     -34274.494     -30.450182     -723.31703      3390.0567    
       700   306.78432     -34283.397      2093.8001      3610.1314      3388.3566    
       800   328.2992      -34281.922      67.070891     -4999.2946      3386.6565    
       900   293.05896     -34270.906      1837.8034     -1335.787       3384.9563    
      1000   310.80853     -34252.749     -14182.918     -3535.2212      3383.2562    
      1100   319.79797     -34265.5        2281.2384      2805.8788      3381.5561    
      1200   312.02493     -34259.499      3565.314       1722.4558      3379.8559    
      1300   301.24379     -34260.04       3319.4449      1377.4286      3378.1558    
      1400   281.08887     -34253.64       6798.3596     -7027.1952      3376.4557    
      1500   280.11147     -34274.097     -4353.5597      782.9944       3374.7556    
      1600   295.34326     -34278.758     -2295.8786      3841.7052      3373.0554    
      1700   277.93908     -34271.57      -1665.4198     -1762.3657      3371.3553    
      1800   310.04352     -34291.989      5121.3481      2333.8226      3369.6552    
      1900   305.95585     -34266.94       6242.5739      3750.3096      3367.955     
      2000   307.78819     -34265.526      7922.916       4894.0281      3366.2549    
Loop time of 90.2617 on 16 procs for 2000 steps with 295 atoms

Performance: 0.957 ns/day, 25.073 hours/ns, 22.158 timesteps/s, 6.537 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.209     | 66.571     | 68.502     |  21.7 | 73.75
Bond    | 0.00070631 | 0.00081293 | 0.00098563 |   0.0 |  0.00
Neigh   | 5.4944     | 5.5885     | 5.6921     |   2.6 |  6.19
Comm    | 6.1212     | 8.0244     | 11.394     |  62.4 |  8.89
Output  | 0.0075794  | 0.013052   | 0.018469   |   3.8 |  0.01
Modify  | 9.5606     | 9.7072     | 9.8086     |   2.5 | 10.75
Other   |            | 0.3567     |            |       |  0.40

Nlocal:         36.875 ave          40 max          31 min
Histogram: 1 0 0 0 0 2 2 0 2 1
Nghost:           3001 ave        3021 max        2978 min
Histogram: 2 0 2 0 0 0 0 0 0 4
Neighs:        22696.5 ave       24403 max       19312 min
Histogram: 1 0 0 0 0 2 1 1 1 2

Total # of neighbors = 181572
Ave neighs/atom = 615.49831
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 61.6837428435455
variable C2neg equal ${d2}
variable C2neg equal 70.4253663435883
variable C3neg equal ${d3}
variable C3neg equal -52.9655661271069
variable C4neg equal ${d4}
variable C4neg equal 10.6073476919933
variable C5neg equal ${d5}
variable C5neg equal 4.53294540076868
variable C6neg equal ${d6}
variable C6neg equal -15.9712123175842

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.498
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 0.16498 remap x units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.2 | 118.5 | 120 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   341.07846     -34221.776     -6656.1132      0              3400.2575    
       100   291.35987     -34222.576      3659.9377      2314.177       3401.9576    
       200   310.51587     -34261.633      3153.3788      5713.8714      3403.6577    
       300   305.30994     -34276.89       6924.8981     -5435.8252      3405.3579    
       400   291.53554     -34269.888      1249.1807      3829.2179      3407.058     
       500   300.48241     -34273.459      669.06053      6272.6462      3408.7581    
       600   313.84255     -34270.019     -1537.5345      4576.2475      3410.4583    
       700   297.88325     -34242.386      9339.5135      3413.0316      3412.1584    
       800   322.47219     -34270.883      10190.674      1191.9531      3413.8585    
       900   297.37658     -34268.107     -12068.829     -4245.6258      3415.5586    
      1000   270.52653     -34248.78      -6272.8798     -790.85244      3417.2588    
      1100   306.47449     -34256.852      7266.0694     -213.02916      3418.9589    
      1200   298.76715     -34279.527      10839.967      4510.9361      3420.659     
      1300   314.39206     -34262.671      13.19046       890.40299      3422.3592    
      1400   315.81118     -34265.313      8406.7278     -363.70806      3424.0593    
      1500   302.43231     -34264.866      179.91324      2056.5179      3425.7594    
      1600   298.62045     -34267.202      8967.2329      746.18094      3427.4595    
      1700   305.15093     -34263.216     -8583.3016     -2699.0788      3429.1597    
      1800   314.74421     -34265.036     -16.480143     -584.96867      3430.8598    
      1900   301.68799     -34265.207      2481.3725     -1632.0391      3432.5599    
      2000   294.23424     -34284.492      11142.062      4655.5935      3434.2601    
Loop time of 89.471 on 16 procs for 2000 steps with 295 atoms

Performance: 0.966 ns/day, 24.853 hours/ns, 22.354 timesteps/s, 6.594 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 62.519     | 65.386     | 68.401     |  23.5 | 73.08
Bond    | 0.00070775 | 0.00081382 | 0.0010121  |   0.0 |  0.00
Neigh   | 5.3408     | 5.4812     | 5.6213     |   4.0 |  6.13
Comm    | 5.4876     | 8.5014     | 11.277     |  64.7 |  9.50
Output  | 0.0051186  | 0.0096843  | 0.014382   |   3.7 |  0.01
Modify  | 9.5662     | 9.732      | 9.8455     |   3.6 | 10.88
Other   |            | 0.3597     |            |       |  0.40

Nlocal:         36.875 ave          43 max          26 min
Histogram: 1 0 0 0 1 1 0 2 2 1
Nghost:        3002.12 ave        3069 max        2945 min
Histogram: 1 2 0 0 2 0 0 2 0 1
Neighs:        22256.1 ave       25980 max       15942 min
Histogram: 1 0 0 0 1 1 2 0 2 1

Total # of neighbors = 178049
Ave neighs/atom = 603.55593
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -59.2678042476332
variable C2pos equal ${d2}
variable C2pos equal -45.5462409393143
variable C3pos equal ${d3}
variable C3pos equal 34.0269603290107
variable C4pos equal ${d4}
variable C4pos equal 13.6430090491526
variable C5pos equal ${d5}
variable C5pos equal -22.8739806907989
variable C6pos equal ${d6}
variable C6pos equal 0.195811326109467

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(61.6837428435455+${C1pos})
variable C13 equal 0.5*(61.6837428435455+-59.2678042476332)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(70.4253663435883+${C2pos})
variable C23 equal 0.5*(70.4253663435883+-45.5462409393143)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(-52.9655661271069+${C3pos})
variable C33 equal 0.5*(-52.9655661271069+34.0269603290107)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(10.6073476919933+${C4pos})
variable C43 equal 0.5*(10.6073476919933+13.6430090491526)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(4.53294540076868+${C5pos})
variable C53 equal 0.5*(4.53294540076868+-22.8739806907989)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-15.9712123175842+${C6pos})
variable C63 equal 0.5*(-15.9712123175842+0.195811326109467)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.498
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.498
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta -0.16498 remap x units box
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.2 | 118.6 | 120 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   341.07846     -34221.776     -6656.1132      0              3400.2575    
       100   291.35987     -34222.576      3661.7677      2314.5263      3400.2575    
       200   316.61679     -34251.375      3141.2396      3686.2262      3400.2575    
       300   322.29153     -34267.682      207.04786     -1428.7966      3400.2575    
       400   313.85687     -34259.369      1325.7736     -214.44212      3400.2575    
       500   318.66156     -34258.87       12695.2        2517.4703      3400.2575    
       600   327.74077     -34258.372     -6762.6834      112.101        3400.2575    
       700   311.55721     -34271.121      8456.2528     -1431.5928      3400.2575    
       800   313.30058     -34262.925      510.31346     -330.6705       3400.2575    
       900   307.53794     -34274.945      2135.1126     -1332.2582      3400.2575    
      1000   301.1507      -34267.258     -12089.451     -3924.778       3400.2575    
      1100   315.20666     -34275.9        2830.8846      3085.2787      3400.2575    
      1200   308.52407     -34278.037     -1568.223       4687.1253      3400.2575    
      1300   312.94319     -34278.022     -7193.9329     -620.41391      3400.2575    
      1400   308.41802     -34267.958     -885.86785     -2725.7992      3400.2575    
      1500   313.20498     -34272.28      -1274.8361     -2894.2741      3400.2575    
      1600   308.96136     -34258.146      2964.4978     -4604.4115      3400.2575    
      1700   298.93516     -34278.785     -4949.2081     -5544.4478      3400.2575    
      1800   309.01492     -34276.143      7498.2711     -3016.3934      3400.2575    
      1900   292.05787     -34287.468     -12972.105     -3217.461       3400.2575    
      2000   326.78851     -34290.864     -5915.109       872.54532      3400.2575    
Loop time of 89.6392 on 16 procs for 2000 steps with 295 atoms

Performance: 0.964 ns/day, 24.900 hours/ns, 22.312 timesteps/s, 6.582 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.637     | 65.926     | 68.083     |  18.5 | 73.55
Bond    | 0.00062507 | 0.00080313 | 0.00095298 |   0.0 |  0.00
Neigh   | 5.2927     | 5.4712     | 5.5775     |   4.2 |  6.10
Comm    | 6.005      | 8.156      | 10.444     |  52.6 |  9.10
Output  | 0.0053376  | 0.014402   | 0.027243   |   6.5 |  0.02
Modify  | 9.5613     | 9.7012     | 9.9054     |   3.2 | 10.82
Other   |            | 0.3693     |            |       |  0.41

Nlocal:         36.875 ave          45 max          29 min
Histogram: 1 0 2 0 0 3 0 0 1 1
Nghost:        2982.62 ave        3048 max        2931 min
Histogram: 2 1 0 1 0 1 1 1 0 1
Neighs:        22465.9 ave       27091 max       17876 min
Histogram: 1 0 2 0 1 2 0 0 1 1

Total # of neighbors = 179727
Ave neighs/atom = 609.24407
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 20.9360688620043
variable C2neg equal ${d2}
variable C2neg equal 2.9162736042338
variable C3neg equal ${d3}
variable C3neg equal -15.7953015739674
variable C4neg equal ${d4}
variable C4neg equal 1.66849169304449
variable C5neg equal ${d5}
variable C5neg equal -11.8819542546692
variable C6neg equal ${d6}
variable C6neg equal -17.5412203011815

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.498
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta 0.16498 remap x units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.2 | 118.6 | 120 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   341.07846     -34221.776     -6656.1132      0              3400.2575    
       100   291.35987     -34222.576      3661.7677      2314.5263      3400.2575    
       200   316.68931     -34252.582      2513.1764      3631.2029      3400.2575    
       300   326.17693     -34278.22       746.3609      -1788.0281      3400.2575    
       400   308.32146     -34273.216      1338.804       4911.9105      3400.2575    
       500   300.8273      -34267.044     -915.19764      2481.3656      3400.2575    
       600   297.50517     -34270.858     -7416.7635      3439.2439      3400.2575    
       700   306.99878     -34271.887     -11581.18      -2166.0886      3400.2575    
       800   326.45292     -34277.037     -8634.3509      5261.6332      3400.2575    
       900   305.57845     -34280.094     -1398.3845      3757.3839      3400.2575    
      1000   312.72862     -34276.654     -12771.516      2201.8163      3400.2575    
      1100   298.19692     -34292.144     -20051.486      5667.9589      3400.2575    
      1200   288.34541     -34281.719     -2860.1642      2466.0138      3400.2575    
      1300   293.37697     -34279.716     -1599.8245     -3306.3811      3400.2575    
      1400   284.94821     -34274.69       3141.2518     -2022.5278      3400.2575    
      1500   310.74814     -34267.882     -6822.9493     -7405.9971      3400.2575    
      1600   299.71964     -34305.311      7057.5835     -3162.4565      3400.2575    
      1700   282.14609     -34299.869     -19860.517     -2681.1998      3400.2575    
      1800   332.25551     -34308.069     -6371.4914     -4246.0749      3400.2575    
      1900   290.3173      -34272.204      3446.9919     -3423.1096      3400.2575    
      2000   296.84134     -34311.139      8581.1578     -56.345797      3400.2575    
Loop time of 89.7236 on 16 procs for 2000 steps with 295 atoms

Performance: 0.963 ns/day, 24.923 hours/ns, 22.291 timesteps/s, 6.576 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.313     | 65.341     | 67.595     |  18.6 | 72.83
Bond    | 0.00069256 | 0.00081173 | 0.0010067  |   0.0 |  0.00
Neigh   | 5.281      | 5.4062     | 5.5765     |   3.5 |  6.03
Comm    | 6.5064     | 8.7761     | 10.809     |  50.4 |  9.78
Output  | 0.0071353  | 0.01836    | 0.032302   |   6.8 |  0.02
Modify  | 9.632      | 9.8123     | 9.8999     |   2.4 | 10.94
Other   |            | 0.3685     |            |       |  0.41

Nlocal:         36.875 ave          43 max          28 min
Histogram: 1 0 0 0 2 0 2 1 0 2
Nghost:        2959.25 ave        3033 max        2899 min
Histogram: 2 0 0 1 2 1 0 1 0 1
Neighs:        22464.9 ave       26146 max       17258 min
Histogram: 1 0 0 1 1 1 1 1 0 2

Total # of neighbors = 179719
Ave neighs/atom = 609.21695
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -11.5240795759715
variable C2pos equal ${d2}
variable C2pos equal 29.1658218331907
variable C3pos equal ${d3}
variable C3pos equal 42.8715969273402
variable C4pos equal ${d4}
variable C4pos equal 28.1553084567449
variable C5pos equal ${d5}
variable C5pos equal -26.230827638689
variable C6pos equal ${d6}
variable C6pos equal 7.79755202986866

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(20.9360688620043+${C1pos})
variable C14 equal 0.5*(20.9360688620043+-11.5240795759715)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(2.9162736042338+${C2pos})
variable C24 equal 0.5*(2.9162736042338+29.1658218331907)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-15.7953015739674+${C3pos})
variable C34 equal 0.5*(-15.7953015739674+42.8715969273402)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(1.66849169304449+${C4pos})
variable C44 equal 0.5*(1.66849169304449+28.1553084567449)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-11.8819542546692+${C5pos})
variable C54 equal 0.5*(-11.8819542546692+-26.230827638689)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-17.5412203011815+${C6pos})
variable C64 equal 0.5*(-17.5412203011815+7.79755202986866)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.498
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.498
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta -0.16498 remap x units box
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.2 | 118.6 | 120 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   341.07846     -34221.776     -6656.1132      0              3400.2575    
       100   291.35987     -34222.576      3661.7677      2314.5263      3400.2575    
       200   301.83938     -34237.445     -1569.2987      3607.8915      3400.2575    
       300   315.08079     -34261.223     -16.288185     -2709.8437      3400.2575    
       400   283.72149     -34238.967      11469.176      2590.0384      3400.2575    
       500   309.42438     -34252.314      4103.902       6295.9103      3400.2575    
       600   310.70402     -34260.406      4632.2576      7346.3066      3400.2575    
       700   280.94832     -34252.589     -7243.3036     -570.04629      3400.2575    
       800   278.38873     -34287.176      12788.874      14037.135      3400.2575    
       900   314.21341     -34267.66       331.76366      3125.0868      3400.2575    
      1000   306.94866     -34257.12      -2873.1652      3075.0278      3400.2575    
      1100   289.39377     -34267.471      2309.3512      3339.4454      3400.2575    
      1200   301.6475      -34271.747     -2115.4902      3526.8898      3400.2575    
      1300   299.31516     -34267.265      4948.4088      2673.4156      3400.2575    
      1400   306.37141     -34277.848     -2757.2634     -2099.671       3400.2575    
      1500   316.90005     -34299.08       365.61397      3741.3364      3400.2575    
      1600   297.17492     -34267.541      3771.1179      2438.5802      3400.2575    
      1700   301.78707     -34275.396     -3337.3092      863.60903      3400.2575    
      1800   303.38535     -34294.698      18560.875      4424.2764      3400.2575    
      1900   292.03798     -34276.979     -10776.951     -3295.7549      3400.2575    
      2000   308.69554     -34283.972      1856.1909     -676.00765      3400.2575    
Loop time of 89.7388 on 16 procs for 2000 steps with 295 atoms

Performance: 0.963 ns/day, 24.927 hours/ns, 22.287 timesteps/s, 6.575 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.483     | 65.338     | 67.939     |  16.8 | 72.81
Bond    | 0.00066687 | 0.00080657 | 0.00096475 |   0.0 |  0.00
Neigh   | 5.209      | 5.4373     | 5.5898     |   5.8 |  6.06
Comm    | 6.119      | 8.734      | 10.622     |  46.8 |  9.73
Output  | 0.0058312  | 0.012197   | 0.022995   |   5.2 |  0.01
Modify  | 9.6768     | 9.8305     | 10.088     |   4.3 | 10.95
Other   |            | 0.3857     |            |       |  0.43

Nlocal:         36.875 ave          43 max          28 min
Histogram: 1 0 0 0 2 1 2 0 0 2
Nghost:        2974.12 ave        3020 max        2932 min
Histogram: 1 0 1 1 1 2 0 1 0 1
Neighs:        22454.1 ave       26024 max       17220 min
Histogram: 1 0 0 0 2 1 2 0 0 2

Total # of neighbors = 179633
Ave neighs/atom = 608.92542
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 5.24535589065566
variable C2neg equal ${d2}
variable C2neg equal 43.4944353591887
variable C3neg equal ${d3}
variable C3neg equal -37.1284483856502
variable C4neg equal ${d4}
variable C4neg equal -22.5606205060814
variable C5neg equal ${d5}
variable C5neg equal 24.9281358711088
variable C6neg equal ${d6}
variable C6neg equal 8.70094638214756

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.498
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta 0.16498 remap x units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.2 | 118.6 | 120 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   341.07846     -34221.776     -6656.1132      0              3400.2575    
       100   291.35987     -34222.576      3661.7677      2314.5263      3400.2575    
       200   317.1278      -34252.759      2766.362       3651.325       3400.2575    
       300   326.19082     -34284.525      2106.7477     -3906.3282      3400.2575    
       400   326.55358     -34258.041      3432.4807     -3671.1042      3400.2575    
       500   331.88187     -34276.149     -5616.18        749.3586       3400.2575    
       600   318.03415     -34287.137     -2822.9445      4024.5358      3400.2575    
       700   332.47494     -34270.704     -7413.1831      3658.5404      3400.2575    
       800   321.13658     -34269.265     -92.696145     -631.71937      3400.2575    
       900   314.74941     -34270.151      5843.4284     -311.43602      3400.2575    
      1000   309.99589     -34289.949      12328.795      2094.7859      3400.2575    
      1100   280.43116     -34298.228      38.400041      4334.7014      3400.2575    
      1200   298.93741     -34282.901     -3209.3771      1789.1135      3400.2575    
      1300   287.02215     -34267.237     -9275.1137     -936.9743       3400.2575    
      1400   309.37122     -34286.147     -7494.8887      352.02349      3400.2575    
      1500   291.54571     -34305.411     -220.69938      507.80234      3400.2575    
      1600   272.99887     -34287.177     -2384.0096      9155.2312      3400.2575    
      1700   290.44313     -34288.475      13216.519      3976.0922      3400.2575    
      1800   320.83915     -34305.545      8524.3633      4106.6454      3400.2575    
      1900   317.60639     -34295.14      -1403.3215     -1908.8648      3400.2575    
      2000   306.74076     -34301.546     -852.40199     -2311.0582      3400.2575    
Loop time of 87.9907 on 16 procs for 2000 steps with 295 atoms

Performance: 0.982 ns/day, 24.442 hours/ns, 22.730 timesteps/s, 6.705 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.788     | 63.116     | 66.61      |  32.6 | 71.73
Bond    | 0.0006704  | 0.00080949 | 0.00098168 |   0.0 |  0.00
Neigh   | 5.0374     | 5.3138     | 5.576      |   7.1 |  6.04
Comm    | 5.9353     | 9.5055     | 13.829     |  84.7 | 10.80
Output  | 0.0056471  | 0.012068   | 0.018483   |   4.7 |  0.01
Modify  | 9.4997     | 9.766      | 10.007     |   5.2 | 11.10
Other   |            | 0.2762     |            |       |  0.31

Nlocal:         36.875 ave          44 max          32 min
Histogram: 2 0 1 1 1 2 0 0 0 1
Nghost:        2980.62 ave        3035 max        2939 min
Histogram: 1 2 0 1 0 1 2 0 0 1
Neighs:        22465.2 ave       26574 max       19643 min
Histogram: 2 0 1 1 1 2 0 0 0 1

Total # of neighbors = 179722
Ave neighs/atom = 609.22712
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 11.3217942009101
variable C2pos equal ${d2}
variable C2pos equal -35.7701577743571
variable C3pos equal ${d3}
variable C3pos equal 46.9324650268795
variable C4pos equal ${d4}
variable C4pos equal -6.88228908952142
variable C5pos equal ${d5}
variable C5pos equal -11.8360822860951
variable C6pos equal ${d6}
variable C6pos equal -1.91331616352835

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(5.24535589065566+${C1pos})
variable C15 equal 0.5*(5.24535589065566+11.3217942009101)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(43.4944353591887+${C2pos})
variable C25 equal 0.5*(43.4944353591887+-35.7701577743571)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-37.1284483856502+${C3pos})
variable C35 equal 0.5*(-37.1284483856502+46.9324650268795)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-22.5606205060814+${C4pos})
variable C45 equal 0.5*(-22.5606205060814+-6.88228908952142)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(24.9281358711088+${C5pos})
variable C55 equal 0.5*(24.9281358711088+-11.8360822860951)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(8.70094638214756+${C6pos})
variable C65 equal 0.5*(8.70094638214756+-1.91331616352835)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.6088

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.6088
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta -0.136088 remap x units box

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.2 | 118.6 | 120 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   341.07846     -34221.776     -6656.1132      0              3400.2575    
       100   291.35987     -34222.576      3661.7677      2314.5263      3400.2575    
       200   316.43988     -34251.991      3620.5635      3713.6057      3400.2575    
       300   334.33709     -34277.378      2189.6604     -3908.7994      3400.2575    
       400   313.13728     -34231.83      -8511.3948     -65.641386      3400.2575    
       500   311.78967     -34267.319     -585.90978      1095.2071      3400.2575    
       600   286.57643     -34260.379      7094.6823      7252.7458      3400.2575    
       700   282.0911      -34270.904      4299.1381      769.29856      3400.2575    
       800   333.14828     -34262.414     -2883.3572     -2339.0259      3400.2575    
       900   294.7916      -34252.168     -4261.7809     -2267.5575      3400.2575    
      1000   296.31936     -34277.017     -7734.8054      2127.5765      3400.2575    
      1100   288.12035     -34271.141      3821.0671     -9300.7649      3400.2575    
      1200   301.66027     -34295.583      2517.453      -1701.2234      3400.2575    
      1300   284.05773     -34269.131      3021.5675     -4200.794       3400.2575    
      1400   304.83778     -34297.046     -1714.2867     -3426.8905      3400.2575    
      1500   275.05023     -34287.731      3807.9503     -5773.5289      3400.2575    
      1600   300.28686     -34260.109     -3806.7811     -3526.3176      3400.2575    
      1700   301.35639     -34255.53       7262.425      -3314.2669      3400.2575    
      1800   295.22114     -34267.996     -4587.4795      300.91594      3400.2575    
      1900   297.60073     -34265.533     -14340.888     -3822.4493      3400.2575    
      2000   317.84829     -34269.305      4930.4079      3473.1176      3400.2575    
Loop time of 75.6364 on 16 procs for 2000 steps with 295 atoms

Performance: 1.142 ns/day, 21.010 hours/ns, 26.442 timesteps/s, 7.800 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 42.394     | 51.29      | 61.032     |  95.4 | 67.81
Bond    | 0.00049852 | 0.00069619 | 0.00090765 |   0.0 |  0.00
Neigh   | 4.0778     | 4.7297     | 5.5092     |  23.8 |  6.25
Comm    | 0.96263    | 10.73      | 19.63      | 208.7 | 14.19
Output  | 0.0036477  | 0.0052856  | 0.0066379  |   1.7 |  0.01
Modify  | 8.0579     | 8.8359     | 9.486      |  17.4 | 11.68
Other   |            | 0.04524    |            |       |  0.06

Nlocal:         36.875 ave          42 max          30 min
Histogram: 1 0 0 0 1 2 2 1 0 1
Nghost:         2980.5 ave        3010 max        2940 min
Histogram: 1 1 0 0 0 2 1 1 0 2
Neighs:        22481.5 ave       25393 max       18480 min
Histogram: 1 0 0 0 1 2 2 1 0 1

Total # of neighbors = 179852
Ave neighs/atom = 609.6678
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 47.2863670919269
variable C2neg equal ${d2}
variable C2neg equal -9.16008997570593
variable C3neg equal ${d3}
variable C3neg equal -32.7200533488322
variable C4neg equal ${d4}
variable C4neg equal -7.65813878343539
variable C5neg equal ${d5}
variable C5neg equal 3.75688409871074
variable C6neg equal ${d6}
variable C6neg equal -1.87667825179118

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.6088
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta 0.136088 remap x units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.2 | 118.6 | 120 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   341.07846     -34221.776     -6656.1132      0              3400.2575    
       100   291.35987     -34222.576      3661.7677      2314.5263      3400.2575    
       200   317.41274     -34252.558      2125.6453      3591.7545      3400.2575    
       300   327.47108     -34277.44       1542.4925     -1813.1847      3400.2575    
       400   316.77309     -34270.774     -69.396309      5447.6557      3400.2575    
       500   318.22468     -34257.92       2706.1813      6002.6785      3400.2575    
       600   307.68023     -34261.259      11273.844      3502.9909      3400.2575    
       700   343.08942     -34268.899     -5378.5184      51.637503      3400.2575    
       800   317.54616     -34273.284     -763.56531     -2471.4854      3400.2575    
       900   350.30839     -34276.471     -2190.0717     -674.38265      3400.2575    
      1000   306.53094     -34276.821      4815.8         3055.7334      3400.2575    
      1100   288.71115     -34252.944     -7802.2526      678.99894      3400.2575    
      1200   299.82762     -34262.816     -8508.3087      3950.3859      3400.2575    
      1300   304.48986     -34275.677     -3425.3449     -376.86793      3400.2575    
      1400   317.14583     -34290.368     -1244.1341     -1638.4634      3400.2575    
      1500   305.75333     -34308.65      -4130.5569     -7886.5267      3400.2575    
      1600   277.0516      -34289.866     -14923.968     -1571.0941      3400.2575    
      1700   283.8625      -34287.291     -17485.386     -2898.8067      3400.2575    
      1800   283.27474     -34278.915      22863.371      2290.4945      3400.2575    
      1900   293.35895     -34276.081     -14997.313     -2293.7625      3400.2575    
      2000   292.97826     -34294.788      2148.6248     -2706.9469      3400.2575    
Loop time of 54.6584 on 16 procs for 2000 steps with 295 atoms

Performance: 1.581 ns/day, 15.183 hours/ns, 36.591 timesteps/s, 10.794 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 40.903     | 42.042     | 43.436     |  13.8 | 76.92
Bond    | 0.00049294 | 0.000678   | 0.00089253 |   0.0 |  0.00
Neigh   | 3.9872     | 4.0724     | 4.1731     |   3.2 |  7.45
Comm    | 0.6137     | 2.0087     | 3.1529     |  63.1 |  3.67
Output  | 0.0028572  | 0.0043972  | 0.0057142  |   1.8 |  0.01
Modify  | 6.3874     | 6.4867     | 6.5712     |   2.5 | 11.87
Other   |            | 0.04314    |            |       |  0.08

Nlocal:         36.875 ave          45 max          29 min
Histogram: 1 0 1 1 0 3 1 0 0 1
Nghost:        3012.12 ave        3049 max        2976 min
Histogram: 1 1 0 0 3 1 0 0 0 2
Neighs:        22459.5 ave       27264 max       17886 min
Histogram: 1 0 1 1 0 3 1 0 0 1

Total # of neighbors = 179676
Ave neighs/atom = 609.07119
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 15.3331356901091
variable C2pos equal ${d2}
variable C2pos equal -34.9924142240422
variable C3pos equal ${d3}
variable C3pos equal 26.0704736653718
variable C4pos equal ${d4}
variable C4pos equal 7.18320028743343
variable C5pos equal ${d5}
variable C5pos equal -14.5974562297381
variable C6pos equal ${d6}
variable C6pos equal 2.69640083015992

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(47.2863670919269+${C1pos})
variable C16 equal 0.5*(47.2863670919269+15.3331356901091)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-9.16008997570593+${C2pos})
variable C26 equal 0.5*(-9.16008997570593+-34.9924142240422)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-32.7200533488322+${C3pos})
variable C36 equal 0.5*(-32.7200533488322+26.0704736653718)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-7.65813878343539+${C4pos})
variable C46 equal 0.5*(-7.65813878343539+7.18320028743343)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(3.75688409871074+${C5pos})
variable C56 equal 0.5*(3.75688409871074+-14.5974562297381)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(-1.87667825179118+${C6pos})
variable C66 equal 0.5*(-1.87667825179118+2.69640083015992)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 54.5948425275505
variable C22all equal ${C22}
variable C22all equal -11.4522949138945
variable C33all equal ${C33}
variable C33all equal -9.4693028990481

variable C44all equal ${C44}
variable C44all equal 14.9119000748947
variable C55all equal ${C55}
variable C55all equal 6.54602679250685
variable C66all equal ${C66}
variable C66all equal 0.40986128918437

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(-44.4768079564165+${C21})
variable C12all equal 0.5*(-44.4768079564165+29.6543822139383)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(1.20796929795615+${C31})
variable C13all equal 0.5*(1.20796929795615+15.3500297078148)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(12.439562702137+${C32})
variable C23all equal 0.5*(12.439562702137+1.71948297418265)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(4.7059946430164+${C41})
variable C14all equal 0.5*(4.7059946430164+-5.15833505695783)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(8.28357504578288+${C51})
variable C15all equal 0.5*(8.28357504578288+7.38984838000016)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(31.309751391018+${C61})
variable C16all equal 0.5*(31.309751391018+1.69695992675033)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(16.0410477187122+${C42})
variable C24all equal 0.5*(16.0410477187122+5.70976453671635)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(3.8621387924158+${C52})
variable C25all equal 0.5*(3.8621387924158+-2.75589306462898)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-22.0762520998741+${C62})
variable C26all equal 0.5*(-22.0762520998741+4.76603682312084)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(13.5381476766864+${C43})
variable C34all equal 0.5*(13.5381476766864+12.125178370573)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(4.90200832061465+${C53})
variable C35all equal 0.5*(4.90200832061465+-9.17051764501511)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-3.3247898417302+${C63})
variable C36all equal 0.5*(-3.3247898417302+-7.88770049573737)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-14.7214547978014+${C54})
variable C45all equal 0.5*(-14.7214547978014+-19.0563909466791)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-0.23746924800098+${C64})
variable C46all equal 0.5*(-0.23746924800098+-4.87183413565642)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-5.42028606551368+${C65})
variable C56all equal 0.5*(-5.42028606551368+3.3938151093096)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by deform-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:18:36
