LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.1                  # the deformation magnitude 0.01

variable FF string "CHONSi.ff C H O Si"   # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si
variable structure string 333U-50C-14-vasp

# Read the initial sctructure
# box tilt large
read_data       ${structure}.data
read_data       333U-50C-14-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.007 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -4.92 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 134.1 | 135.3 | 136.7 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0             -41361.517      0             -41361.517      73123.45     
        77   0             -43060.124      0             -43060.124     -2313.8714    
Loop time of 11.7126 on 16 procs for 77 steps with 371 atoms

97.4% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
     -41361.5172743623  -43060.0843527352  -43060.1238999441
  Force two-norm initial, final = 2062.1069 97.291011
  Force max component initial, final = 454.74681 23.228012
  Final line search alpha, max atom move = 0.0021332475 0.049551098
  Iterations, force evaluations = 77 246

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 8.5713     | 8.98       | 9.4452     |   8.7 | 76.67
Bond    | 0.00012812 | 0.00014763 | 0.00016622 |   0.0 |  0.00
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.36388    | 0.83014    | 1.2386     |  28.5 |  7.09
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 1.888      | 1.8887     | 1.8892     |   0.0 | 16.13
Other   |            | 0.01359    |            |       |  0.12

Nlocal:         46.375 ave          56 max          42 min
Histogram: 5 0 0 0 0 1 0 1 0 1
Nghost:        3405.88 ave        3455 max        3357 min
Histogram: 1 0 2 1 0 1 0 1 1 1
Neighs:        28984.4 ave       34744 max       26288 min
Histogram: 5 0 0 0 0 1 0 1 0 1

Total # of neighbors = 231875
Ave neighs/atom = 625
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-14-vasp_opt.data
System init for write_data ...
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 131.7 | 133.4 | 135.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -43060.124      1342.3077      1.6093426      4136.956     
       100   221.19276     -42934.036      3297.7975      1.6093426      4136.956     
       200   293.76858     -42953.709     -6224.5219      1.6093426      4136.956     
       300   321.70371     -42938.741     -7166.7239      1.6093426      4136.956     
       400   324.68138     -42939.865     -9343.4108      1.6093426      4136.956     
       500   308.08028     -42959.352      4801.2446      1.6093426      4136.956     
       600   305.31553     -43006.3        4622.9752      1.6093426      4136.956     
       700   295.85993     -43027.677     -3321.1361      1.6093426      4136.956     
       800   282.08025     -43021.959      2934.2248      1.6093426      4136.956     
       900   293.95422     -43029.333     -8250.0508      1.6093426      4136.956     
      1000   310.6355      -43050.956     -1442.6501      1.6093426      4136.956     
      1100   296.6371      -43053.779     -8255.2059      1.6093426      4136.956     
      1200   289.01937     -43061.991     -4004.1685      1.6093426      4136.956     
      1300   303.19512     -43076.686      324.43437      1.6093426      4136.956     
      1400   325.99886     -43080.326     -4799.3215      1.6093426      4136.956     
      1500   318.45533     -43056.458     -1448.1861      1.6093426      4136.956     
      1600   309.92394     -43084.824     -134.36545      1.6093426      4136.956     
      1700   305.74628     -43099.356      9506.2188      1.6093426      4136.956     
      1800   292.60873     -43087.379     -5023.0759      1.6093426      4136.956     
      1900   304.83561     -43106.653     -3218.7273      1.6093426      4136.956     
      2000   290.19539     -43117.248     -5294.1439      1.6093426      4136.956     
      2100   298.32216     -43144.685      764.8994       1.6093426      4136.956     
      2200   283.52505     -43132.5        1464.7806      1.6093426      4136.956     
      2300   304.149       -43136.408      2432.1166      1.6093426      4136.956     
      2400   328.51968     -43137.082     -3745.6242      1.6093426      4136.956     
      2500   304.43789     -43120.686     -1843.2213      1.6093426      4136.956     
      2600   294.87919     -43138.457     -7657.0225      1.6093426      4136.956     
      2700   284.16217     -43135.718     -4874.4273      1.6093426      4136.956     
      2800   305.13919     -43152.076     -3972.1642      1.6093426      4136.956     
      2900   287.45171     -43128.135     -1235.4651      1.6093426      4136.956     
      3000   306.93089     -43146.179      3296.9985      1.6093426      4136.956     
      3100   305.69487     -43144.827     -2359.6332      1.6093426      4136.956     
      3200   301.57226     -43142.619     -5113.9603      1.6093426      4136.956     
      3300   294.09356     -43142.474      1168.2801      1.6093426      4136.956     
      3400   275.39929     -43130.516     -5314.023       1.6093426      4136.956     
      3500   298.97479     -43155.828      1788.358       1.6093426      4136.956     
      3600   302.95435     -43150.144      429.97039      1.6093426      4136.956     
      3700   313.97233     -43144.916      3734.3731      1.6093426      4136.956     
      3800   302.13497     -43139.027      1736.7113      1.6093426      4136.956     
      3900   306.57639     -43178.727      434.29031      1.6093426      4136.956     
      4000   296.01686     -43178.48       7299.8187      1.6093426      4136.956     
      4100   302.28884     -43172.07      -17151.162      1.6093426      4136.956     
      4200   327.51495     -43182.209     -5859.9069      1.6093426      4136.956     
      4300   320.96998     -43175.891     -13000.643      1.6093426      4136.956     
      4400   300.69038     -43157.779     -5306.2322      1.6093426      4136.956     
      4500   301.85474     -43163.956     -2962.7323      1.6093426      4136.956     
      4600   293.4494      -43162.126     -5181.0808      1.6093426      4136.956     
      4700   301.89659     -43175.853      6995.5704      1.6093426      4136.956     
      4800   286.34859     -43174.943      3765.776       1.6093426      4136.956     
      4900   293.63439     -43202.189     -5965.6392      1.6093426      4136.956     
      5000   295.90007     -43197.274     -7613.9577      1.6093426      4136.956     
Loop time of 257.501 on 16 procs for 5000 steps with 371 atoms

Performance: 0.839 ns/day, 28.611 hours/ns, 19.417 timesteps/s, 7.204 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 191.96     | 199.45     | 203.56     |  23.8 | 77.45
Bond    | 0.0017678  | 0.0019484  | 0.0022612  |   0.4 |  0.00
Neigh   | 13.242     | 13.539     | 13.978     |   5.9 |  5.26
Comm    | 16.748     | 21.088     | 28.48      |  73.1 |  8.19
Output  | 0.0030884  | 0.0037711  | 0.0081119  |   2.7 |  0.00
Modify  | 21.883     | 22.489     | 22.941     |   6.8 |  8.73
Other   |            | 0.9331     |            |       |  0.36

Nlocal:         46.375 ave          51 max          31 min
Histogram: 1 0 0 0 0 0 1 0 2 4
Nghost:        3412.88 ave        3465 max        3365 min
Histogram: 2 0 0 1 1 1 1 1 0 1
Neighs:        28997.8 ave       31944 max       19686 min
Histogram: 1 0 0 0 0 0 1 1 2 3

Total # of neighbors = 231982
Ave neighs/atom = 625.28841
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333U-50C-14-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 17.3186
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 12.8149
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 18.6403

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.2054
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 0.4589
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -8.851

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 17.3186
variable dlen equal lx-${len0}
variable dlen equal lx-17.3186
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.005 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.3186
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.8510000000000008669, deltaxy = 0.8851
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.4588999999999999746, deltaxz = -0.04589
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.20539999999999999925, deltayz = -0.02054
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.73186 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.73186 xy delta 0.8851 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.73186 xy delta 0.8851 xz delta -0.04589 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.5 | 134 | 135.8 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   295.90007     -43197.274     -7613.9562      4136.956       17.3186        12.8149        18.6403      
       100   322.26513     -43189.37      -9842.5347      4128.6821      17.283963      12.8149        18.6403      
       200   306.72682     -43164.127     -14451.119      4120.4082      17.249326      12.8149        18.6403      
       300   315.99357     -43178.922     -2711.2958      4112.1343      17.214688      12.8149        18.6403      
       400   295.58302     -43178.136     -10284.835      4103.8603      17.180051      12.8149        18.6403      
       500   300.33522     -43185.431     -3148.9633      4095.5864      17.145414      12.8149        18.6403      
       600   302.68516     -43182.835     -15655.911      4087.3125      17.110777      12.8149        18.6403      
       700   296.83705     -43176.862     -7935.6726      4079.0386      17.07614       12.8149        18.6403      
       800   291.55683     -43182.403      2379.6089      4070.7647      17.041502      12.8149        18.6403      
       900   298.19363     -43208.674      5379.0506      4062.4908      17.006865      12.8149        18.6403      
      1000   299.84542     -43213.546     -255.00826      4054.2169      16.972228      12.8149        18.6403      
      1100   282.83103     -43181.143     -868.27895      4045.943       16.937591      12.8149        18.6403      
      1200   310.82465     -43179.387     -4488.1327      4037.669       16.902954      12.8149        18.6403      
      1300   314.33672     -43170.145      8463.4819      4029.3951      16.868316      12.8149        18.6403      
      1400   308.56882     -43200.915     -8699.5712      4021.1212      16.833679      12.8149        18.6403      
      1500   301.89973     -43200.481      3956.6846      4012.8473      16.799042      12.8149        18.6403      
      1600   307.36076     -43215.137     -7694.397       4004.5734      16.764405      12.8149        18.6403      
      1700   310.30987     -43227.208     -8580.2991      3996.2995      16.729768      12.8149        18.6403      
      1800   303.22279     -43238.871     -2278.2566      3988.0256      16.69513       12.8149        18.6403      
      1900   286.95708     -43229.377      7163.4128      3979.7517      16.660493      12.8149        18.6403      
      2000   276.2098      -43236.991      139.04811      3971.4778      16.625856      12.8149        18.6403      
      2100   308.94634     -43249.416      267.75142      3963.2038      16.591219      12.8149        18.6403      
      2200   291.27607     -43196.662      17561.947      3954.9299      16.556582      12.8149        18.6403      
      2300   300.08466     -43189.569      3992.1771      3946.656       16.521944      12.8149        18.6403      
      2400   329.59952     -43234.568      2865.6912      3938.3821      16.487307      12.8149        18.6403      
      2500   302.7336      -43220.306     -2536.1817      3930.1082      16.45267       12.8149        18.6403      
      2600   314.17406     -43239.829      10236.228      3921.8343      16.418033      12.8149        18.6403      
      2700   298.03596     -43235.238      5069.3458      3913.5604      16.383396      12.8149        18.6403      
      2800   294.28408     -43235.455      8077.0762      3905.2865      16.348758      12.8149        18.6403      
      2900   276.89044     -43227.814      5528.7371      3897.0125      16.314121      12.8149        18.6403      
      3000   288.07371     -43258.39       9531.3122      3888.7386      16.279484      12.8149        18.6403      
      3100   297.81797     -43245.243     -13408.623      3880.4647      16.244847      12.8149        18.6403      
      3200   296.75527     -43194.224      40.767354      3872.1908      16.21021       12.8149        18.6403      
      3300   324.27593     -43214.425      3354.4967      3863.9169      16.175572      12.8149        18.6403      
      3400   299.0858      -43197.819     -3216.3655      3855.643       16.140935      12.8149        18.6403      
      3500   296.22609     -43210.96       11649.338      3847.3691      16.106298      12.8149        18.6403      
      3600   303.5725      -43215.815      6871.7109      3839.0952      16.071661      12.8149        18.6403      
      3700   291.39877     -43208.987     -2687.1887      3830.8212      16.037024      12.8149        18.6403      
      3800   285.55923     -43215.385      17911.621      3822.5473      16.002386      12.8149        18.6403      
      3900   285.42061     -43232.728      6631.7328      3814.2734      15.967749      12.8149        18.6403      
      4000   283.39752     -43239.255      10450.696      3805.9995      15.933112      12.8149        18.6403      
      4100   287.07841     -43213.91      -1904.4943      3797.7256      15.898475      12.8149        18.6403      
      4200   295.81796     -43194.376      15702.007      3789.4517      15.863838      12.8149        18.6403      
      4300   301.74521     -43191.938      17216.061      3781.1778      15.8292        12.8149        18.6403      
      4400   323.29795     -43213.231      15104.772      3772.9039      15.794563      12.8149        18.6403      
      4500   298.77194     -43206.636      20310.394      3764.63        15.759926      12.8149        18.6403      
      4600   290.49432     -43193.609      18820.995      3756.356       15.725289      12.8149        18.6403      
      4700   284.22156     -43181.266      3240.4996      3748.0821      15.690652      12.8149        18.6403      
      4800   295.91765     -43195.694      16238.784      3739.8082      15.656014      12.8149        18.6403      
      4900   299.37659     -43210.387      10282.727      3731.5343      15.621377      12.8149        18.6403      
      5000   284.91065     -43209.177      19974.703      3723.2604      15.58674       12.8149        18.6403      
Loop time of 279.084 on 16 procs for 5000 steps with 371 atoms

Performance: 0.774 ns/day, 31.009 hours/ns, 17.916 timesteps/s, 6.647 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 210.34     | 216.94     | 222.17     |  28.4 | 77.73
Bond    | 0.0017282  | 0.0019859  | 0.0022791  |   0.4 |  0.00
Neigh   | 13.639     | 14.163     | 14.595     |   6.9 |  5.07
Comm    | 17.447     | 22.723     | 29.229     |  87.5 |  8.14
Output  | 0.034008   | 0.041938   | 0.05107    |   2.7 |  0.02
Modify  | 23.862     | 24.356     | 24.924     |   6.4 |  8.73
Other   |            | 0.8575     |            |       |  0.31

Nlocal:         46.375 ave          54 max          41 min
Histogram: 2 1 1 0 0 1 2 0 0 1
Nghost:        3617.62 ave        3642 max        3560 min
Histogram: 1 0 0 0 1 1 0 0 1 4
Neighs:        32284.1 ave       37440 max       28567 min
Histogram: 2 1 1 0 0 2 0 1 0 1

Total # of neighbors = 258273
Ave neighs/atom = 696.15364
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.3186
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.73186 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.73186 xy delta -0.8851 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.73186 xy delta -0.8851 xz delta 0.04589 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.5 | 134 | 135.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   295.90007     -43197.274     -7613.9562      4136.956       17.3186        12.8149        18.6403      
       100   322.53791     -43189.945     -9875.0392      4145.2299      17.353237      12.8149        18.6403      
       200   302.53102     -43154.278     -20450.162      4153.5038      17.387874      12.8149        18.6403      
       300   317.21583     -43177.155      2374.2487      4161.7777      17.422512      12.8149        18.6403      
       400   286.13291     -43162.231     -8091.5457      4170.0516      17.457149      12.8149        18.6403      
       500   289.55644     -43165.044     -14044.635      4178.3256      17.491786      12.8149        18.6403      
       600   292.49836     -43158.952     -11469.901      4186.5995      17.526423      12.8149        18.6403      
       700   297.61042     -43157.628     -19344.712      4194.8734      17.56106       12.8149        18.6403      
       800   311.45274     -43168.331     -2601.1351      4203.1473      17.595698      12.8149        18.6403      
       900   297.22018     -43158.451     -10379.273      4211.4212      17.630335      12.8149        18.6403      
      1000   295.9468      -43157.137     -13276.826      4219.6951      17.664972      12.8149        18.6403      
      1100   284.08362     -43130.559     -16057.862      4227.969       17.699609      12.8149        18.6403      
      1200   302.22318     -43142.225     -9782.5247      4236.2429      17.734246      12.8149        18.6403      
      1300   280.50261     -43134.861     -11779.579      4244.5168      17.768884      12.8149        18.6403      
      1400   286.46868     -43164.331     -8739.6494      4252.7908      17.803521      12.8149        18.6403      
      1500   298.01936     -43163.977     -19641.711      4261.0647      17.838158      12.8149        18.6403      
      1600   311.20969     -43143.501     -21740.442      4269.3386      17.872795      12.8149        18.6403      
      1700   312.40123     -43131.58      -13651.875      4277.6125      17.907432      12.8149        18.6403      
      1800   316.24749     -43143.725     -19840.783      4285.8864      17.94207       12.8149        18.6403      
      1900   300.3861      -43121.174     -8415.4933      4294.1603      17.976707      12.8149        18.6403      
      2000   297.71771     -43119.168     -11126.242      4302.4342      18.011344      12.8149        18.6403      
      2100   282.7717      -43110.981     -21768.511      4310.7081      18.045981      12.8149        18.6403      
      2200   292.2268      -43129.972     -12175.288      4318.9821      18.080618      12.8149        18.6403      
      2300   285.71631     -43118.517     -7743.881       4327.256       18.115256      12.8149        18.6403      
      2400   296.95248     -43101.808     -21764.652      4335.5299      18.149893      12.8149        18.6403      
      2500   318.08644     -43094.715     -5965.6063      4343.8038      18.18453       12.8149        18.6403      
      2600   310.6203      -43102.564     -6992.2262      4352.0777      18.219167      12.8149        18.6403      
      2700   298.03968     -43109.018     -13161.91       4360.3516      18.253804      12.8149        18.6403      
      2800   311.13308     -43124.745     -12654.403      4368.6255      18.288442      12.8149        18.6403      
      2900   286.34333     -43105.507     -24714.481      4376.8994      18.323079      12.8149        18.6403      
      3000   287.39129     -43096.346     -26952.962      4385.1734      18.357716      12.8149        18.6403      
      3100   303.06045     -43089.277     -22573.153      4393.4473      18.392353      12.8149        18.6403      
      3200   309.77381     -43070.807     -14869.6        4401.7212      18.42699       12.8149        18.6403      
      3300   323.53597     -43096.959     -13269.782      4409.9951      18.461628      12.8149        18.6403      
      3400   299.32385     -43089.58      -8728.8746      4418.269       18.496265      12.8149        18.6403      
      3500   306.00762     -43102.673     -19010.918      4426.5429      18.530902      12.8149        18.6403      
      3600   287.72962     -43092.698     -18352.531      4434.8168      18.565539      12.8149        18.6403      
      3700   293.82584     -43113.053     -19032.21       4443.0907      18.600176      12.8149        18.6403      
      3800   272.02045     -43093.796     -12473.974      4451.3646      18.634814      12.8149        18.6403      
      3900   268.29348     -43104.526     -22165.341      4459.6386      18.669451      12.8149        18.6403      
      4000   285.21483     -43109.288     -7919.9566      4467.9125      18.704088      12.8149        18.6403      
      4100   296.81627     -43082.169     -19345.221      4476.1864      18.738725      12.8149        18.6403      
      4200   313.42677     -43077.108     -17425.448      4484.4603      18.773362      12.8149        18.6403      
      4300   307.59055     -43067.091     -16753.932      4492.7342      18.808         12.8149        18.6403      
      4400   291.33838     -43069.844     -15877.162      4501.0081      18.842637      12.8149        18.6403      
      4500   288.91986     -43075.475     -15487.736      4509.282       18.877274      12.8149        18.6403      
      4600   316.8045      -43093.138     -26916.179      4517.5559      18.911911      12.8149        18.6403      
      4700   304.45463     -43066.147     -20332.442      4525.8299      18.946548      12.8149        18.6403      
      4800   285.5812      -43050.137     -16259.986      4534.1038      18.981186      12.8149        18.6403      
      4900   308.98263     -43081.955     -11477.315      4542.3777      19.015823      12.8149        18.6403      
      5000   268.35785     -43074.728     -15686.342      4550.6516      19.05046       12.8149        18.6403      
Loop time of 245.217 on 16 procs for 5000 steps with 371 atoms

Performance: 0.881 ns/day, 27.246 hours/ns, 20.390 timesteps/s, 7.565 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 186.84     | 189.11     | 195.17     |  19.5 | 77.12
Bond    | 0.0017061  | 0.0019245  | 0.0021886  |   0.4 |  0.00
Neigh   | 12.658     | 12.974     | 13.411     |   6.2 |  5.29
Comm    | 13.922     | 20.101     | 22.241     |  59.9 |  8.20
Output  | 0.032381   | 0.048057   | 0.066504   |   5.1 |  0.02
Modify  | 21.673     | 22.099     | 22.558     |   6.2 |  9.01
Other   |            | 0.8844     |            |       |  0.36

Nlocal:         46.375 ave          51 max          40 min
Histogram: 1 0 0 1 0 2 2 0 0 2
Nghost:        3228.75 ave        3249 max        3186 min
Histogram: 1 0 0 1 0 1 0 0 3 2
Neighs:        26290.1 ave       28719 max       22718 min
Histogram: 1 0 0 1 0 2 2 0 0 2

Total # of neighbors = 210321
Ave neighs/atom = 566.90296
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 12.8149
variable dlen equal ly-${len0}
variable dlen equal ly-12.8149
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*12.8149
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.8510000000000008669, deltaxy = 0.8851
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.4588999999999999746, deltaxz = -0.04589
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.20539999999999999925, deltayz = -0.02054
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.28149 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.28149 yz delta -0.02054 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.5 | 134 | 135.8 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   295.90007     -43197.274     -7613.9562      4136.956       17.3186        12.8149        18.6403      
       100   322.59088     -43189.551     -9868.4895      4128.6821      17.3186        12.78927       18.6403      
       200   303.83326     -43159.84      -18665.769      4120.4082      17.3186        12.76364       18.6403      
       300   323.62558     -43190.035     -1799.2153      4112.1343      17.3186        12.738011      18.6403      
       400   290.47883     -43175.477     -8716.4678      4103.8603      17.3186        12.712381      18.6403      
       500   288.93454     -43179.676     -8669.1276      4095.5864      17.3186        12.686751      18.6403      
       600   296.23234     -43182.585     -10096.033      4087.3125      17.3186        12.661121      18.6403      
       700   292.61678     -43166.398     -7602.1711      4079.0386      17.3186        12.635491      18.6403      
       800   305.07067     -43170.916      1305.7887      4070.7647      17.3186        12.609862      18.6403      
       900   307.35107     -43193.578     -108.55542      4062.4908      17.3186        12.584232      18.6403      
      1000   287.40795     -43200.846      3375.1709      4054.2169      17.3186        12.558602      18.6403      
      1100   285.71293     -43186.161      5212.7565      4045.943       17.3186        12.532972      18.6403      
      1200   304.93861     -43180.042      8404.3712      4037.669       17.3186        12.507342      18.6403      
      1300   317.25972     -43188.274      3793.2578      4029.3951      17.3186        12.481713      18.6403      
      1400   284.6084      -43171.614      1135.8954      4021.1212      17.3186        12.456083      18.6403      
      1500   313.57063     -43226.17       7518.6055      4012.8473      17.3186        12.430453      18.6403      
      1600   298.78448     -43198.305      6080.5499      4004.5734      17.3186        12.404823      18.6403      
      1700   304.31114     -43195.747     -4188.9273      3996.2995      17.3186        12.379193      18.6403      
      1800   303.54193     -43181.11      -8688.5761      3988.0256      17.3186        12.353564      18.6403      
      1900   312.51078     -43151.066     -18854.167      3979.7517      17.3186        12.327934      18.6403      
      2000   314.98893     -43149.707      1206.1485      3971.4778      17.3186        12.302304      18.6403      
      2100   296.9259      -43159.715     -6778.8797      3963.2038      17.3186        12.276674      18.6403      
      2200   308.62753     -43184.498     -15777.641      3954.9299      17.3186        12.251044      18.6403      
      2300   303.44065     -43189.833     -2951.009       3946.656       17.3186        12.225415      18.6403      
      2400   264.31711     -43159.164      6740.5198      3938.3821      17.3186        12.199785      18.6403      
      2500   297.89671     -43183.872      7101.3698      3930.1082      17.3186        12.174155      18.6403      
      2600   304.19991     -43158.844     -5383.8463      3921.8343      17.3186        12.148525      18.6403      
      2700   323.38676     -43166.533     -5795.0446      3913.5604      17.3186        12.122895      18.6403      
      2800   280.36148     -43145.247     -6070.6122      3905.2865      17.3186        12.097266      18.6403      
      2900   283.04613     -43159.136     -2897.9756      3897.0125      17.3186        12.071636      18.6403      
      3000   292.88703     -43169.661     -14068.306      3888.7386      17.3186        12.046006      18.6403      
      3100   301.31186     -43180.648      6558.2435      3880.4647      17.3186        12.020376      18.6403      
      3200   295.33908     -43199.315      7221.5159      3872.1908      17.3186        11.994746      18.6403      
      3300   293.80529     -43212.612      10219.806      3863.9169      17.3186        11.969117      18.6403      
      3400   282.32144     -43176.481      11544.819      3855.643       17.3186        11.943487      18.6403      
      3500   290.59612     -43162.168      12291.071      3847.3691      17.3186        11.917857      18.6403      
      3600   308.21822     -43177.034      11553.337      3839.0952      17.3186        11.892227      18.6403      
      3700   292.1851      -43149.241      9712.4251      3830.8212      17.3186        11.866597      18.6403      
      3800   297.65276     -43169.639      10296.143      3822.5473      17.3186        11.840968      18.6403      
      3900   283.1056      -43183.627      3498.5667      3814.2734      17.3186        11.815338      18.6403      
      4000   286.54441     -43177.166      6893.7856      3805.9995      17.3186        11.789708      18.6403      
      4100   294.12285     -43153.693      13097.551      3797.7256      17.3186        11.764078      18.6403      
      4200   326.96176     -43167.64       10776.116      3789.4517      17.3186        11.738448      18.6403      
      4300   315.05721     -43158.088      12239.935      3781.1778      17.3186        11.712819      18.6403      
      4400   292.90098     -43141.628      7056.4763      3772.9039      17.3186        11.687189      18.6403      
      4500   288.05406     -43142.852      12465.179      3764.63        17.3186        11.661559      18.6403      
      4600   314.85009     -43169.32       7377.9216      3756.356       17.3186        11.635929      18.6403      
      4700   311.04381     -43152.34       6579.4107      3748.0821      17.3186        11.610299      18.6403      
      4800   331.79798     -43135.242      12936.036      3739.8082      17.3186        11.58467       18.6403      
      4900   326.72714     -43153.472     -4475.2976      3731.5343      17.3186        11.55904       18.6403      
      5000   316.72973     -43166.511      301.81852      3723.2604      17.3186        11.53341       18.6403      
Loop time of 285.357 on 16 procs for 5000 steps with 371 atoms

Performance: 0.757 ns/day, 31.706 hours/ns, 17.522 timesteps/s, 6.501 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 217.18     | 220.75     | 226.37     |  21.0 | 77.36
Bond    | 0.0018102  | 0.0019692  | 0.0022411  |   0.3 |  0.00
Neigh   | 14.5       | 14.904     | 15.462     |   8.7 |  5.22
Comm    | 18.134     | 23.87      | 27.474     |  65.3 |  8.36
Output  | 0.027152   | 0.031858   | 0.037136   |   1.8 |  0.01
Modify  | 24.122     | 24.82      | 25.338     |   8.8 |  8.70
Other   |            | 0.9821     |            |       |  0.34

Nlocal:         46.375 ave          53 max          42 min
Histogram: 3 0 1 0 2 0 0 0 0 2
Nghost:         3780.5 ave        3840 max        3720 min
Histogram: 1 1 1 0 0 3 0 0 0 2
Neighs:        32257.6 ave       36816 max       29266 min
Histogram: 3 0 1 0 2 0 0 0 0 2

Total # of neighbors = 258061
Ave neighs/atom = 695.58221
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*12.8149
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.28149 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.28149 yz delta 0.02054 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.5 | 134 | 135.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   295.90007     -43197.274     -7613.9562      4136.956       17.3186        12.8149        18.6403      
       100   322.33244     -43190.055     -9761.0972      4145.2299      17.3186        12.84053       18.6403      
       200   304.13281     -43156.904     -20865.308      4153.5038      17.3186        12.86616       18.6403      
       300   318.44578     -43177.203     -1586.0351      4161.7777      17.3186        12.891789      18.6403      
       400   296.26002     -43174.375     -2284.8096      4170.0516      17.3186        12.917419      18.6403      
       500   292.51189     -43168.093     -17247.52       4178.3256      17.3186        12.943049      18.6403      
       600   310.80058     -43176.993     -3389.2956      4186.5995      17.3186        12.968679      18.6403      
       700   297.89864     -43172.901     -10408.959      4194.8734      17.3186        12.994309      18.6403      
       800   279.93638     -43185.459      4289.8767      4203.1473      17.3186        13.019938      18.6403      
       900   288.77268     -43189.617     -21200.695      4211.4212      17.3186        13.045568      18.6403      
      1000   304.65113     -43179.001     -4340.5529      4219.6951      17.3186        13.071198      18.6403      
      1100   313.81247     -43170.043     -1188.3064      4227.969       17.3186        13.096828      18.6403      
      1200   295.4546      -43145.743     -15781.506      4236.2429      17.3186        13.122458      18.6403      
      1300   288.68179     -43143.139     -3049.2851      4244.5168      17.3186        13.148087      18.6403      
      1400   304.70051     -43171.808     -12989.983      4252.7908      17.3186        13.173717      18.6403      
      1500   278.22671     -43166.446     -17428.986      4261.0647      17.3186        13.199347      18.6403      
      1600   285.45695     -43164.683     -11380.318      4269.3386      17.3186        13.224977      18.6403      
      1700   293.65006     -43152.907     -14781.756      4277.6125      17.3186        13.250607      18.6403      
      1800   295.64359     -43144.38      -14050.36       4285.8864      17.3186        13.276236      18.6403      
      1900   292.60963     -43137.68      -11307.691      4294.1603      17.3186        13.301866      18.6403      
      2000   290.55039     -43142.051     -16094.053      4302.4342      17.3186        13.327496      18.6403      
      2100   291.63245     -43161.915     -7950.7437      4310.7081      17.3186        13.353126      18.6403      
      2200   291.8062      -43171.381     -13640.889      4318.9821      17.3186        13.378756      18.6403      
      2300   307.73628     -43166.366     -10336.099      4327.256       17.3186        13.404385      18.6403      
      2400   303.65324     -43138.351     -20184.178      4335.5299      17.3186        13.430015      18.6403      
      2500   309.02471     -43116.405     -13559.789      4343.8038      17.3186        13.455645      18.6403      
      2600   344.33102     -43140.317     -12067.774      4352.0777      17.3186        13.481275      18.6403      
      2700   302.68932     -43122.325     -18541.538      4360.3516      17.3186        13.506905      18.6403      
      2800   292.47921     -43127.26      -11824.238      4368.6255      17.3186        13.532534      18.6403      
      2900   279.35186     -43116.714     -20302.808      4376.8994      17.3186        13.558164      18.6403      
      3000   284.19258     -43108.728     -22658.28       4385.1734      17.3186        13.583794      18.6403      
      3100   314.34063     -43112.965     -20147.32       4393.4473      17.3186        13.609424      18.6403      
      3200   326.10184     -43114.799     -18023.033      4401.7212      17.3186        13.635054      18.6403      
      3300   293.55362     -43107.834     -23205.602      4409.9951      17.3186        13.660683      18.6403      
      3400   279.22176     -43102.91      -17371.312      4418.269       17.3186        13.686313      18.6403      
      3500   293.29674     -43105.359     -19604.195      4426.5429      17.3186        13.711943      18.6403      
      3600   310.29054     -43099.776     -12727.012      4434.8168      17.3186        13.737573      18.6403      
      3700   304.83426     -43083.477     -20566.944      4443.0907      17.3186        13.763203      18.6403      
      3800   306.9798      -43082.406     -12057.331      4451.3646      17.3186        13.788832      18.6403      
      3900   301.57717     -43086.08      -22982.188      4459.6386      17.3186        13.814462      18.6403      
      4000   308.81034     -43110.22      -8203.267       4467.9125      17.3186        13.840092      18.6403      
      4100   296.56912     -43104.033     -20709.321      4476.1864      17.3186        13.865722      18.6403      
      4200   300.64147     -43092.294     -28858.658      4484.4603      17.3186        13.891352      18.6403      
      4300   331.54314     -43083.799     -29427.857      4492.7342      17.3186        13.916981      18.6403      
      4400   318.62148     -43063.26      -10472.795      4501.0081      17.3186        13.942611      18.6403      
      4500   300.75912     -43060.476     -10704.256      4509.282       17.3186        13.968241      18.6403      
      4600   316.25733     -43085.355     -19974.116      4517.5559      17.3186        13.993871      18.6403      
      4700   311.86033     -43086.836     -8241.6452      4525.8299      17.3186        14.019501      18.6403      
      4800   301.90366     -43069.092     -20771.609      4534.1038      17.3186        14.04513       18.6403      
      4900   299.12175     -43053.55      -13196.903      4542.3777      17.3186        14.07076       18.6403      
      5000   314.53213     -43078.199     -15368.886      4550.6516      17.3186        14.09639       18.6403      
Loop time of 239.277 on 16 procs for 5000 steps with 371 atoms

Performance: 0.903 ns/day, 26.586 hours/ns, 20.896 timesteps/s, 7.753 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.83     | 183.25     | 188.08     |  16.0 | 76.59
Bond    | 0.0016526  | 0.001926   | 0.0021396  |   0.4 |  0.00
Neigh   | 12.095     | 12.4       | 12.592     |   4.1 |  5.18
Comm    | 15.523     | 20.523     | 23.881     |  49.1 |  8.58
Output  | 0.02742    | 0.045076   | 0.063397   |   6.3 |  0.02
Modify  | 21.852     | 22.119     | 22.511     |   4.9 |  9.24
Other   |            | 0.9348     |            |       |  0.39

Nlocal:         46.375 ave          53 max          42 min
Histogram: 2 1 1 0 1 1 1 0 0 1
Nghost:        3041.38 ave        3076 max        3005 min
Histogram: 2 0 1 0 0 2 1 0 0 2
Neighs:        26284.6 ave       29938 max       23889 min
Histogram: 2 0 2 0 1 1 1 0 0 1

Total # of neighbors = 210277
Ave neighs/atom = 566.78437
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 18.6403
variable dlen equal lz-${len0}
variable dlen equal lz-18.6403
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*18.6403
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.8510000000000008669, deltaxy = 0.8851
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.4588999999999999746, deltaxz = -0.04589
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.20539999999999999925, deltayz = -0.02054
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -1.86403 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.5 | 134 | 135.8 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   295.90007     -43197.274     -7613.9562      4136.956       17.3186        12.8149        18.6403      
       100   322.59961     -43189.856     -9796.3636      4128.6821      17.3186        12.8149        18.603019    
       200   300.3093      -43157.144     -17250.406      4120.4082      17.3186        12.8149        18.565739    
       300   331.22238     -43194.536      5753.7469      4112.1343      17.3186        12.8149        18.528458    
       400   289.67766     -43168.521     -8544.0235      4103.8603      17.3186        12.8149        18.491178    
       500   292.5746      -43177.836     -7879.2642      4095.5864      17.3186        12.8149        18.453897    
       600   300.87471     -43178.754     -4262.0254      4087.3125      17.3186        12.8149        18.416616    
       700   290.45123     -43165.467     -6738.8566      4079.0386      17.3186        12.8149        18.379336    
       800   301.87709     -43177.086     -14455.684      4070.7647      17.3186        12.8149        18.342055    
       900   297.13194     -43186.714     -9198.0574      4062.4908      17.3186        12.8149        18.304775    
      1000   285.08519     -43176.933      3408.7504      4054.2169      17.3186        12.8149        18.267494    
      1100   302.87339     -43181.444      342.4012       4045.943       17.3186        12.8149        18.230213    
      1200   305.9851      -43180.505     -712.16128      4037.669       17.3186        12.8149        18.192933    
      1300   312.11706     -43204.045      1355.887       4029.3951      17.3186        12.8149        18.155652    
      1400   276.01577     -43175.273      1404.2296      4021.1212      17.3186        12.8149        18.118372    
      1500   296.40713     -43187.811     -14289.495      4012.8473      17.3186        12.8149        18.081091    
      1600   310.33782     -43165.908     -10971.153      4004.5734      17.3186        12.8149        18.04381     
      1700   332.13915     -43163.859      1107.4984      3996.2995      17.3186        12.8149        18.00653     
      1800   317.16094     -43175.334     -4700.3824      3988.0256      17.3186        12.8149        17.969249    
      1900   299.62784     -43177.597      6378.6954      3979.7517      17.3186        12.8149        17.931969    
      2000   307.702       -43199.502      4208.5407      3971.4778      17.3186        12.8149        17.894688    
      2100   293.21194     -43197.672     -11016.973      3963.2038      17.3186        12.8149        17.857407    
      2200   306.61061     -43225.32       2320.2907      3954.9299      17.3186        12.8149        17.820127    
      2300   295.83955     -43213.794     -146.69067      3946.656       17.3186        12.8149        17.782846    
      2400   289.32136     -43206.863      1067.9296      3938.3821      17.3186        12.8149        17.745566    
      2500   309.22355     -43221.827     -2065.7895      3930.1082      17.3186        12.8149        17.708285    
      2600   266.7763      -43194.045     -1533.3807      3921.8343      17.3186        12.8149        17.671004    
      2700   280.52066     -43216.485      4472.6033      3913.5604      17.3186        12.8149        17.633724    
      2800   286.68103     -43212.246      9733.3793      3905.2865      17.3186        12.8149        17.596443    
      2900   327.01983     -43220.802      4230.9592      3897.0125      17.3186        12.8149        17.559163    
      3000   296.731       -43166.312      7560.3125      3888.7386      17.3186        12.8149        17.521882    
      3100   308.72232     -43188.824      8792.9043      3880.4647      17.3186        12.8149        17.484601    
      3200   286.12968     -43186.108      4255.5762      3872.1908      17.3186        12.8149        17.447321    
      3300   312.08588     -43221.294      6931.0626      3863.9169      17.3186        12.8149        17.41004     
      3400   290.17713     -43198.308      14662.217      3855.643       17.3186        12.8149        17.37276     
      3500   290.23677     -43194.155      7594.0227      3847.3691      17.3186        12.8149        17.335479    
      3600   296.81492     -43184.362      23790.183      3839.0952      17.3186        12.8149        17.298198    
      3700   310.12493     -43162.465      5184.9867      3830.8212      17.3186        12.8149        17.260918    
      3800   319.92325     -43183.875      7126.6294      3822.5473      17.3186        12.8149        17.223637    
      3900   301.66952     -43186.207      18380.562      3814.2734      17.3186        12.8149        17.186357    
      4000   318.7796      -43201.936      19391.338      3805.9995      17.3186        12.8149        17.149076    
      4100   288.81495     -43170.764      3494.531       3797.7256      17.3186        12.8149        17.111795    
      4200   293.64708     -43187.426      9322.2764      3789.4517      17.3186        12.8149        17.074515    
      4300   298.32518     -43188.791      9995.7886      3781.1778      17.3186        12.8149        17.037234    
      4400   280.28666     -43172.005      31573.564      3772.9039      17.3186        12.8149        16.999954    
      4500   299.02154     -43202.893      14307.936      3764.63        17.3186        12.8149        16.962673    
      4600   303.32521     -43202.548      21055.062      3756.356       17.3186        12.8149        16.925392    
      4700   293.7151      -43178.153      13445.141      3748.0821      17.3186        12.8149        16.888112    
      4800   299.87856     -43175.237      19482.626      3739.8082      17.3186        12.8149        16.850831    
      4900   285.79947     -43183.166      19897.284      3731.5343      17.3186        12.8149        16.813551    
      5000   290.95683     -43191.464      22424.321      3723.2604      17.3186        12.8149        16.77627     
Loop time of 280.951 on 16 procs for 5000 steps with 371 atoms

Performance: 0.769 ns/day, 31.217 hours/ns, 17.797 timesteps/s, 6.603 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 209.4      | 216.33     | 220.37     |  21.9 | 77.00
Bond    | 0.0017931  | 0.0019585  | 0.0022548  |   0.3 |  0.00
Neigh   | 15.219     | 15.394     | 15.541     |   2.5 |  5.48
Comm    | 19.536     | 23.529     | 30.285     |  65.9 |  8.37
Output  | 0.029786   | 0.034758   | 0.040373   |   1.9 |  0.01
Modify  | 24.475     | 24.691     | 24.911     |   3.0 |  8.79
Other   |            | 0.9758     |            |       |  0.35

Nlocal:         46.375 ave          52 max          37 min
Histogram: 2 0 0 0 0 1 0 0 3 2
Nghost:        3652.62 ave        3690 max        3617 min
Histogram: 1 0 2 1 0 1 1 0 0 2
Neighs:        32232.1 ave       36039 max       25976 min
Histogram: 2 0 0 0 0 1 0 2 1 2

Total # of neighbors = 257857
Ave neighs/atom = 695.03235
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*18.6403
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 1.86403 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.5 | 134 | 135.8 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   295.90007     -43197.274     -7613.9562      4136.956       17.3186        12.8149        18.6403      
       100   322.28432     -43189.762     -9767.4375      4145.2299      17.3186        12.8149        18.677581    
       200   301.63359     -43151.554     -17852.965      4153.5038      17.3186        12.8149        18.714861    
       300   316.16253     -43176.35       1080.7314      4161.7777      17.3186        12.8149        18.752142    
       400   299.93857     -43177.996     -9144.4719      4170.0516      17.3186        12.8149        18.789422    
       500   296.92358     -43176.769     -17155.964      4178.3256      17.3186        12.8149        18.826703    
       600   290.52568     -43162.393     -2927.4806      4186.5995      17.3186        12.8149        18.863984    
       700   305.18983     -43165.572     -15388.717      4194.8734      17.3186        12.8149        18.901264    
       800   337.3366      -43163.066     -3270.042       4203.1473      17.3186        12.8149        18.938545    
       900   308.56556     -43129.761     -8771.807       4211.4212      17.3186        12.8149        18.975825    
      1000   299.86232     -43147.514     -6158.0828      4219.6951      17.3186        12.8149        19.013106    
      1100   290.91457     -43145.176     -17066.644      4227.969       17.3186        12.8149        19.050387    
      1200   305.04916     -43170.209     -10553.244      4236.2429      17.3186        12.8149        19.087667    
      1300   292.32056     -43162.384     -9090.5461      4244.5168      17.3186        12.8149        19.124948    
      1400   308.10802     -43177.16      -9440.9576      4252.7908      17.3186        12.8149        19.162228    
      1500   285.3881      -43169.564     -21994.029      4261.0647      17.3186        12.8149        19.199509    
      1600   291.38753     -43177.04      -17833.472      4269.3386      17.3186        12.8149        19.23679     
      1700   299.58478     -43143.074     -17061.881      4277.6125      17.3186        12.8149        19.27407     
      1800   298.56518     -43118.511     -4991.7236      4285.8864      17.3186        12.8149        19.311351    
      1900   310.4017      -43125.354     -6537.9125      4294.1603      17.3186        12.8149        19.348631    
      2000   312.59566     -43145.975     -17310.989      4302.4342      17.3186        12.8149        19.385912    
      2100   290.55261     -43136.896     -15849.993      4310.7081      17.3186        12.8149        19.423193    
      2200   272.60778     -43104.613     -18626.317      4318.9821      17.3186        12.8149        19.460473    
      2300   325.95921     -43135.304     -9478.6186      4327.256       17.3186        12.8149        19.497754    
      2400   301.98433     -43101.48      -16876.625      4335.5299      17.3186        12.8149        19.535034    
      2500   291.47732     -43104.246     -10150.354      4343.8038      17.3186        12.8149        19.572315    
      2600   300.16184     -43124.668     -7993.0943      4352.0777      17.3186        12.8149        19.609596    
      2700   297.62537     -43114.85      -5564.2103      4360.3516      17.3186        12.8149        19.646876    
      2800   289.80358     -43104.939     -20406.101      4368.6255      17.3186        12.8149        19.684157    
      2900   283.46542     -43086.756     -7752.812       4376.8994      17.3186        12.8149        19.721437    
      3000   323.82242     -43099.47      -19669.299      4385.1734      17.3186        12.8149        19.758718    
      3100   303.01948     -43067.103     -18854.995      4393.4473      17.3186        12.8149        19.795999    
      3200   311.53991     -43095.687     -25186.43       4401.7212      17.3186        12.8149        19.833279    
      3300   308.40637     -43103.427     -11896.297      4409.9951      17.3186        12.8149        19.87056     
      3400   290.97901     -43085.405     -18190.036      4418.269       17.3186        12.8149        19.90784     
      3500   300.15446     -43094.145     -22916.549      4426.5429      17.3186        12.8149        19.945121    
      3600   297.92487     -43088.581     -9654.3719      4434.8168      17.3186        12.8149        19.982402    
      3700   304.63944     -43077.583      529.17554      4443.0907      17.3186        12.8149        20.019682    
      3800   296.64106     -43040.649     -13742.774      4451.3646      17.3186        12.8149        20.056963    
      3900   312.71501     -43061.05      -16128.726      4459.6386      17.3186        12.8149        20.094243    
      4000   301.523       -43073.652     -12572.608      4467.9125      17.3186        12.8149        20.131524    
      4100   298.42916     -43078.101     -26003.962      4476.1864      17.3186        12.8149        20.168805    
      4200   288.97974     -43066.512     -11096.913      4484.4603      17.3186        12.8149        20.206085    
      4300   300.82403     -43090.614     -14618.403      4492.7342      17.3186        12.8149        20.243366    
      4400   291.95101     -43086.723     -15613.009      4501.0081      17.3186        12.8149        20.280646    
      4500   298.91177     -43082.356     -18065.899      4509.282       17.3186        12.8149        20.317927    
      4600   288.70616     -43051.986     -27517.42       4517.5559      17.3186        12.8149        20.355208    
      4700   328.50709     -43074.851     -19080.756      4525.8299      17.3186        12.8149        20.392488    
      4800   303.27391     -43056.475     -19640.323      4534.1038      17.3186        12.8149        20.429769    
      4900   288.44553     -43038.598     -15324.555      4542.3777      17.3186        12.8149        20.467049    
      5000   311.18277     -43061.565     -17308.279      4550.6516      17.3186        12.8149        20.50433     
Loop time of 248.157 on 16 procs for 5000 steps with 371 atoms

Performance: 0.870 ns/day, 27.573 hours/ns, 20.149 timesteps/s, 7.475 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 187.13     | 189.22     | 192.91     |  13.4 | 76.25
Bond    | 0.0016988  | 0.0019653  | 0.0022427  |   0.3 |  0.00
Neigh   | 12.555     | 12.986     | 13.306     |   6.7 |  5.23
Comm    | 18.042     | 21.871     | 23.984     |  40.5 |  8.81
Output  | 0.030752   | 0.035786   | 0.042045   |   2.0 |  0.01
Modify  | 22.559     | 23.039     | 23.555     |   6.5 |  9.28
Other   |            | 1          |            |       |  0.40

Nlocal:         46.375 ave          55 max          36 min
Histogram: 1 0 1 2 0 0 0 2 1 1
Nghost:        3218.38 ave        3294 max        3141 min
Histogram: 2 0 1 1 0 0 0 2 0 2
Neighs:        26257.5 ave       31087 max       20560 min
Histogram: 1 0 2 1 0 0 0 2 0 2

Total # of neighbors = 210060
Ave neighs/atom = 566.19946
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 17.3186
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.2054)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.3186
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.8510000000000008669, deltaxy = 0.8851
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.4588999999999999746, deltaxz = -0.04589
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.20539999999999999925, deltayz = -0.02054
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -1.73186 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.5 | 134 | 135.8 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   295.90007     -43197.274     -7613.9562      4136.956       17.3186        12.8149        18.6403      
       100   322.53662     -43189.867     -9833.3657      4136.956       17.3186        12.8149        18.6403      
       200   301.36937     -43155.624     -16300.411      4136.956       17.3186        12.8149        18.6403      
       300   315.76142     -43179.944     -2578.9679      4136.956       17.3186        12.8149        18.6403      
       400   283.34884     -43169.421     -5967.0366      4136.956       17.3186        12.8149        18.6403      
       500   270.792       -43158.931     -11315.04       4136.956       17.3186        12.8149        18.6403      
       600   299.42769     -43180.169     -22273.466      4136.956       17.3186        12.8149        18.6403      
       700   295.15228     -43164.848     -14848.524      4136.956       17.3186        12.8149        18.6403      
       800   302.49693     -43168.458     -5684.0185      4136.956       17.3186        12.8149        18.6403      
       900   304.34834     -43180.627     -13326.09       4136.956       17.3186        12.8149        18.6403      
      1000   302.2678      -43207.269     -5125.3063      4136.956       17.3186        12.8149        18.6403      
      1100   304.07445     -43212.644     -15126.171      4136.956       17.3186        12.8149        18.6403      
      1200   282.51419     -43188.821     -13934.559      4136.956       17.3186        12.8149        18.6403      
      1300   296.58425     -43206.432      1950.5621      4136.956       17.3186        12.8149        18.6403      
      1400   282.93993     -43231.443     -7537.7585      4136.956       17.3186        12.8149        18.6403      
      1500   271.21556     -43213.05      -16359.602      4136.956       17.3186        12.8149        18.6403      
      1600   286.5276      -43199.049     -3121.2238      4136.956       17.3186        12.8149        18.6403      
      1700   297.61812     -43186.616     -8612.0566      4136.956       17.3186        12.8149        18.6403      
      1800   321.72313     -43203.24      -10772.546      4136.956       17.3186        12.8149        18.6403      
      1900   305.46808     -43197.228     -15527.983      4136.956       17.3186        12.8149        18.6403      
      2000   288.66408     -43204.568     -8174.6078      4136.956       17.3186        12.8149        18.6403      
      2100   297.41939     -43213.838     -7868.9632      4136.956       17.3186        12.8149        18.6403      
      2200   297.6981      -43201.23      -1577.4327      4136.956       17.3186        12.8149        18.6403      
      2300   299.07702     -43182.709     -14503.443      4136.956       17.3186        12.8149        18.6403      
      2400   301.46506     -43181.798     -7881.7813      4136.956       17.3186        12.8149        18.6403      
      2500   299.69437     -43184.13      -17447.746      4136.956       17.3186        12.8149        18.6403      
      2600   301.4988      -43189.5       -13388.214      4136.956       17.3186        12.8149        18.6403      
      2700   298.85006     -43195.545     -5837.1572      4136.956       17.3186        12.8149        18.6403      
      2800   288.45909     -43188.331     -4040.9413      4136.956       17.3186        12.8149        18.6403      
      2900   290.94655     -43191.788     -6711.3834      4136.956       17.3186        12.8149        18.6403      
      3000   312.87684     -43204.803     -5692.4516      4136.956       17.3186        12.8149        18.6403      
      3100   296.50278     -43163.88      -15545.353      4136.956       17.3186        12.8149        18.6403      
      3200   314.0549      -43184.084     -12433.538      4136.956       17.3186        12.8149        18.6403      
      3300   302.98597     -43195.633     -19058.286      4136.956       17.3186        12.8149        18.6403      
      3400   294.87965     -43201.698     -6822.8083      4136.956       17.3186        12.8149        18.6403      
      3500   292.03045     -43187.5       -11574.931      4136.956       17.3186        12.8149        18.6403      
      3600   308.99194     -43197.052     -14956.172      4136.956       17.3186        12.8149        18.6403      
      3700   302.23479     -43188.379     -3704.006       4136.956       17.3186        12.8149        18.6403      
      3800   300.66766     -43177.411     -8764.3678      4136.956       17.3186        12.8149        18.6403      
      3900   311.13281     -43179.243      2069.3965      4136.956       17.3186        12.8149        18.6403      
      4000   296.04116     -43169.01       5909.2793      4136.956       17.3186        12.8149        18.6403      
      4100   288.31221     -43192.863     -7776.5079      4136.956       17.3186        12.8149        18.6403      
      4200   282.37865     -43187.097      3747.2991      4136.956       17.3186        12.8149        18.6403      
      4300   288.28125     -43167.858     -5087.7499      4136.956       17.3186        12.8149        18.6403      
      4400   294.34346     -43152.916     -9737.323       4136.956       17.3186        12.8149        18.6403      
      4500   315.90815     -43171.06      -13880.745      4136.956       17.3186        12.8149        18.6403      
      4600   294.70263     -43168.401      93.993129      4136.956       17.3186        12.8149        18.6403      
      4700   276.72454     -43178.595     -11885.564      4136.956       17.3186        12.8149        18.6403      
      4800   285.33754     -43180.081     -13527.763      4136.956       17.3186        12.8149        18.6403      
      4900   300.9219      -43169.052     -1356.5558      4136.956       17.3186        12.8149        18.6403      
      5000   333.16312     -43191.271     -24762.554      4136.956       17.3186        12.8149        18.6403      
Loop time of 260.756 on 16 procs for 5000 steps with 371 atoms

Performance: 0.828 ns/day, 28.973 hours/ns, 19.175 timesteps/s, 7.114 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 196.82     | 201.23     | 206.51     |  23.6 | 77.17
Bond    | 0.0016689  | 0.0019314  | 0.0022207  |   0.4 |  0.00
Neigh   | 13.492     | 13.813     | 14.251     |   7.5 |  5.30
Comm    | 16.074     | 21.48      | 25.849     |  73.3 |  8.24
Output  | 0.035308   | 0.042457   | 0.050977   |   2.4 |  0.02
Modify  | 22.698     | 23.202     | 23.607     |   7.2 |  8.90
Other   |            | 0.99       |            |       |  0.38

Nlocal:         46.375 ave          53 max          43 min
Histogram: 1 3 0 1 1 0 0 1 0 1
Nghost:           3414 ave        3453 max        3368 min
Histogram: 1 0 1 0 3 0 0 0 2 1
Neighs:        28982.5 ave       33013 max       26939 min
Histogram: 1 3 0 2 0 0 0 1 0 1

Total # of neighbors = 231860
Ave neighs/atom = 624.95957
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.3186
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 1.73186 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.5 | 134 | 135.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   295.90007     -43197.274     -7613.9562      4136.956       17.3186        12.8149        18.6403      
       100   322.33411     -43189.792     -9793.671       4136.956       17.3186        12.8149        18.6403      
       200   299.25114     -43155.266     -15247.211      4136.956       17.3186        12.8149        18.6403      
       300   320.14525     -43182.717     -1072.7465      4136.956       17.3186        12.8149        18.6403      
       400   292.78359     -43174.645     -9089.6286      4136.956       17.3186        12.8149        18.6403      
       500   293.42696     -43177.675     -8957.0598      4136.956       17.3186        12.8149        18.6403      
       600   292.73309     -43167.158     -8686.931       4136.956       17.3186        12.8149        18.6403      
       700   286.88353     -43150.814     -6949.1739      4136.956       17.3186        12.8149        18.6403      
       800   319.68532     -43161.675     -178.08535      4136.956       17.3186        12.8149        18.6403      
       900   324.32149     -43131.933     -11919.83       4136.956       17.3186        12.8149        18.6403      
      1000   329.3522      -43163.808     -2758.8373      4136.956       17.3186        12.8149        18.6403      
      1100   303.71689     -43151.784     -5964.7937      4136.956       17.3186        12.8149        18.6403      
      1200   296.52024     -43170.335     -3293.0552      4136.956       17.3186        12.8149        18.6403      
      1300   290.28962     -43178.586     -7954.9464      4136.956       17.3186        12.8149        18.6403      
      1400   296.41636     -43183.818     -9671.6255      4136.956       17.3186        12.8149        18.6403      
      1500   315.531       -43179.44      -12873.445      4136.956       17.3186        12.8149        18.6403      
      1600   295.3454      -43125.937     -7342.3652      4136.956       17.3186        12.8149        18.6403      
      1700   306.43793     -43143.744     -8235.9115      4136.956       17.3186        12.8149        18.6403      
      1800   300.20956     -43161.707     -8422.8345      4136.956       17.3186        12.8149        18.6403      
      1900   298.14622     -43166.18      -12659.029      4136.956       17.3186        12.8149        18.6403      
      2000   278.76398     -43151.333     -13292.7        4136.956       17.3186        12.8149        18.6403      
      2100   294.65941     -43171.829     -12838.874      4136.956       17.3186        12.8149        18.6403      
      2200   290.51619     -43154.073     -13876.468      4136.956       17.3186        12.8149        18.6403      
      2300   297.41193     -43145.254     -605.97514      4136.956       17.3186        12.8149        18.6403      
      2400   295.37885     -43143.407     -10220.056      4136.956       17.3186        12.8149        18.6403      
      2500   302.22353     -43176.082     -5637.7057      4136.956       17.3186        12.8149        18.6403      
      2600   292.61372     -43177.306     -2518.7531      4136.956       17.3186        12.8149        18.6403      
      2700   285.04854     -43161.426     -4456.273       4136.956       17.3186        12.8149        18.6403      
      2800   288.90418     -43148.422     -188.14058      4136.956       17.3186        12.8149        18.6403      
      2900   307.15916     -43124.344     -17082.828      4136.956       17.3186        12.8149        18.6403      
      3000   308.20062     -43127.951     -18691.605      4136.956       17.3186        12.8149        18.6403      
      3100   322.27547     -43163.295     -1468.6531      4136.956       17.3186        12.8149        18.6403      
      3200   292.1022      -43144.178     -6373.5037      4136.956       17.3186        12.8149        18.6403      
      3300   312.30683     -43167.394     -10904.443      4136.956       17.3186        12.8149        18.6403      
      3400   312.52928     -43183.921     -10106.413      4136.956       17.3186        12.8149        18.6403      
      3500   294.45923     -43179.511     -16551.317      4136.956       17.3186        12.8149        18.6403      
      3600   290.94783     -43170.635     -3107.2179      4136.956       17.3186        12.8149        18.6403      
      3700   294.67292     -43158.374     -8023.9801      4136.956       17.3186        12.8149        18.6403      
      3800   314.42891     -43168.941     -5541.8588      4136.956       17.3186        12.8149        18.6403      
      3900   321.75387     -43173.319     -25140.533      4136.956       17.3186        12.8149        18.6403      
      4000   306.38765     -43183.381     -9688.52        4136.956       17.3186        12.8149        18.6403      
      4100   280.4384      -43167.478     -19198.543      4136.956       17.3186        12.8149        18.6403      
      4200   295.55099     -43170.993     -13009.052      4136.956       17.3186        12.8149        18.6403      
      4300   322.96859     -43165.443     -158.96259      4136.956       17.3186        12.8149        18.6403      
      4400   312.88502     -43142.554     -6693.4866      4136.956       17.3186        12.8149        18.6403      
      4500   307.12933     -43148.199     -4496.9248      4136.956       17.3186        12.8149        18.6403      
      4600   299.01753     -43154.892     -3169.9211      4136.956       17.3186        12.8149        18.6403      
      4700   299.58159     -43172.283     -10633.452      4136.956       17.3186        12.8149        18.6403      
      4800   282.79126     -43169.266     -28177.6        4136.956       17.3186        12.8149        18.6403      
      4900   282.5051      -43160.144     -3793.109       4136.956       17.3186        12.8149        18.6403      
      5000   312.18406     -43154.599     -12678.881      4136.956       17.3186        12.8149        18.6403      
Loop time of 257.983 on 16 procs for 5000 steps with 371 atoms

Performance: 0.837 ns/day, 28.665 hours/ns, 19.381 timesteps/s, 7.190 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 195.25     | 199.63     | 205.06     |  19.6 | 77.38
Bond    | 0.001743   | 0.001964   | 0.002176   |   0.4 |  0.00
Neigh   | 13.46      | 13.761     | 14.177     |   5.7 |  5.33
Comm    | 15.268     | 20.681     | 24.953     |  61.0 |  8.02
Output  | 0.02549    | 0.039724   | 0.055804   |   5.3 |  0.02
Modify  | 22.488     | 23         | 23.384     |   5.9 |  8.92
Other   |            | 0.8659     |            |       |  0.34

Nlocal:         46.375 ave          50 max          43 min
Histogram: 1 1 0 0 2 2 0 1 0 1
Nghost:        3371.75 ave        3405 max        3325 min
Histogram: 1 0 0 1 1 2 0 0 1 2
Neighs:        29012.2 ave       31073 max       27007 min
Histogram: 1 1 0 0 2 1 1 1 0 1

Total # of neighbors = 232098
Ave neighs/atom = 625.60108
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 12.8149
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-0.4589)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*12.8149
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.8510000000000008669, deltaxy = 0.8851
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.4588999999999999746, deltaxz = -0.04589
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.20539999999999999925, deltayz = -0.02054
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -1.28149 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.5 | 134 | 135.8 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   295.90007     -43197.274     -7613.9562      4136.956       17.3186        12.8149        18.6403      
       100   322.52439     -43189.81      -9768.1492      4136.956       17.3186        12.8149        18.6403      
       200   298.00116     -43153.446     -17884.129      4136.956       17.3186        12.8149        18.6403      
       300   320.63784     -43185.854      4252.4869      4136.956       17.3186        12.8149        18.6403      
       400   284.51949     -43171.587     -11489.606      4136.956       17.3186        12.8149        18.6403      
       500   287.9436      -43174.386     -11694.464      4136.956       17.3186        12.8149        18.6403      
       600   300.18269     -43164.149     -8516.1716      4136.956       17.3186        12.8149        18.6403      
       700   315.17871     -43147.458     -2889.0932      4136.956       17.3186        12.8149        18.6403      
       800   305.97645     -43149.97      -1387.5795      4136.956       17.3186        12.8149        18.6403      
       900   289.25296     -43162.69      -714.9718       4136.956       17.3186        12.8149        18.6403      
      1000   298.6753      -43189.815     -14587.08       4136.956       17.3186        12.8149        18.6403      
      1100   297.2427      -43187.363     -2896.5915      4136.956       17.3186        12.8149        18.6403      
      1200   287.82874     -43166.906     -12674.943      4136.956       17.3186        12.8149        18.6403      
      1300   330.10671     -43183.173     -3673.2357      4136.956       17.3186        12.8149        18.6403      
      1400   318.94971     -43149.643     -3006.2759      4136.956       17.3186        12.8149        18.6403      
      1500   309.01396     -43173.239     -5426.4324      4136.956       17.3186        12.8149        18.6403      
      1600   286.26976     -43165.531     -11309.87       4136.956       17.3186        12.8149        18.6403      
      1700   289.49636     -43172.12      -13195.996      4136.956       17.3186        12.8149        18.6403      
      1800   300.63656     -43190.463     -8294.9234      4136.956       17.3186        12.8149        18.6403      
      1900   282.97784     -43169.609     -10127.398      4136.956       17.3186        12.8149        18.6403      
      2000   314.79566     -43192.642     -10143.912      4136.956       17.3186        12.8149        18.6403      
      2100   329.92667     -43193.558     -13246.705      4136.956       17.3186        12.8149        18.6403      
      2200   315.3098      -43192.519     -8840.3929      4136.956       17.3186        12.8149        18.6403      
      2300   290.33926     -43189.832      4767.0494      4136.956       17.3186        12.8149        18.6403      
      2400   304.57243     -43209.815     -7838.0646      4136.956       17.3186        12.8149        18.6403      
      2500   283.08495     -43184.037     -5545.2995      4136.956       17.3186        12.8149        18.6403      
      2600   305.76824     -43175.698      2458.627       4136.956       17.3186        12.8149        18.6403      
      2700   319.1892      -43162.145     -861.80647      4136.956       17.3186        12.8149        18.6403      
      2800   309.33161     -43169.799     -11697.837      4136.956       17.3186        12.8149        18.6403      
      2900   309.62243     -43185.804     -9369.1313      4136.956       17.3186        12.8149        18.6403      
      3000   293.30359     -43186.251     -8880.2621      4136.956       17.3186        12.8149        18.6403      
      3100   283.25597     -43186.869     -18487.683      4136.956       17.3186        12.8149        18.6403      
      3200   290.94076     -43199.597     -9476.7044      4136.956       17.3186        12.8149        18.6403      
      3300   300.85915     -43203.696      6604.57        4136.956       17.3186        12.8149        18.6403      
      3400   305.19732     -43179.408     -51.391558      4136.956       17.3186        12.8149        18.6403      
      3500   322.74859     -43181.814     -11221.085      4136.956       17.3186        12.8149        18.6403      
      3600   307.69899     -43184.725     -6990.2309      4136.956       17.3186        12.8149        18.6403      
      3700   289.55473     -43189.58      -8067.8802      4136.956       17.3186        12.8149        18.6403      
      3800   299.56659     -43198.849     -2673.6476      4136.956       17.3186        12.8149        18.6403      
      3900   300.57696     -43198.952     -6909.8292      4136.956       17.3186        12.8149        18.6403      
      4000   275.12757     -43173.127     -5676.643       4136.956       17.3186        12.8149        18.6403      
      4100   321.06522     -43196.692     -11256.878      4136.956       17.3186        12.8149        18.6403      
      4200   319.89499     -43182.878     -5200.2407      4136.956       17.3186        12.8149        18.6403      
      4300   308.06088     -43183.759     -9765.3313      4136.956       17.3186        12.8149        18.6403      
      4400   288.01419     -43187.656      2589.7892      4136.956       17.3186        12.8149        18.6403      
      4500   288.65421     -43187.468     -4683.9056      4136.956       17.3186        12.8149        18.6403      
      4600   310.17743     -43204.857     -20260.321      4136.956       17.3186        12.8149        18.6403      
      4700   294.80251     -43186.795     -4781.946       4136.956       17.3186        12.8149        18.6403      
      4800   295.44773     -43189.018     -12657.894      4136.956       17.3186        12.8149        18.6403      
      4900   300.03488     -43193.867     -13013.531      4136.956       17.3186        12.8149        18.6403      
      5000   278.2427      -43163.944     -13956.597      4136.956       17.3186        12.8149        18.6403      
Loop time of 260.756 on 16 procs for 5000 steps with 371 atoms

Performance: 0.828 ns/day, 28.973 hours/ns, 19.175 timesteps/s, 7.114 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 198.78     | 200.84     | 203.21     |  10.9 | 77.02
Bond    | 0.0016645  | 0.001944   | 0.002157   |   0.3 |  0.00
Neigh   | 13.369     | 13.568     | 13.877     |   4.1 |  5.20
Comm    | 19.534     | 22.019     | 24.224     |  33.7 |  8.44
Output  | 0.029552   | 0.03544    | 0.042142   |   2.2 |  0.01
Modify  | 22.854     | 23.277     | 23.6       |   4.6 |  8.93
Other   |            | 1.012      |            |       |  0.39

Nlocal:         46.375 ave          55 max          40 min
Histogram: 1 1 1 0 3 0 0 1 0 1
Nghost:        3428.12 ave        3467 max        3364 min
Histogram: 1 0 1 0 0 1 1 2 1 1
Neighs:          29004 ave       34293 max       25324 min
Histogram: 1 1 1 2 1 0 0 1 0 1

Total # of neighbors = 232032
Ave neighs/atom = 625.42318
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*12.8149
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 1.28149 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.5 | 134 | 135.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   295.90007     -43197.274     -7613.9562      4136.956       17.3186        12.8149        18.6403      
       100   322.32827     -43189.811     -9796.9668      4136.956       17.3186        12.8149        18.6403      
       200   301.05339     -43158.043     -17489.403      4136.956       17.3186        12.8149        18.6403      
       300   325.55103     -43189.09       6934.0845      4136.956       17.3186        12.8149        18.6403      
       400   297.90095     -43182.932     -10068.834      4136.956       17.3186        12.8149        18.6403      
       500   293.55325     -43182.13      -8907.9971      4136.956       17.3186        12.8149        18.6403      
       600   306.2579      -43191.526     -9712.7845      4136.956       17.3186        12.8149        18.6403      
       700   296.48764     -43173.659     -9064.5534      4136.956       17.3186        12.8149        18.6403      
       800   300.84836     -43173.661      2886.706       4136.956       17.3186        12.8149        18.6403      
       900   298.08051     -43162.378     -2423.6581      4136.956       17.3186        12.8149        18.6403      
      1000   294.37704     -43157.258     -11268.845      4136.956       17.3186        12.8149        18.6403      
      1100   285.62412     -43153.632      3994.9741      4136.956       17.3186        12.8149        18.6403      
      1200   297.24033     -43182.075     -7226.5958      4136.956       17.3186        12.8149        18.6403      
      1300   285.77651     -43181.191     -7164.2527      4136.956       17.3186        12.8149        18.6403      
      1400   299.04669     -43186.713      1418.8527      4136.956       17.3186        12.8149        18.6403      
      1500   301.43014     -43155.454     -8731.1875      4136.956       17.3186        12.8149        18.6403      
      1600   329.08109     -43165.581     -5466.8433      4136.956       17.3186        12.8149        18.6403      
      1700   296.67633     -43149.308     -13549.141      4136.956       17.3186        12.8149        18.6403      
      1800   294.16051     -43161.751     -15586.49       4136.956       17.3186        12.8149        18.6403      
      1900   299.62964     -43171.807     -13867.419      4136.956       17.3186        12.8149        18.6403      
      2000   301.47339     -43176.332     -6349.0274      4136.956       17.3186        12.8149        18.6403      
      2100   298.44925     -43172.141      1322.0979      4136.956       17.3186        12.8149        18.6403      
      2200   301.37427     -43175.034     -5337.7978      4136.956       17.3186        12.8149        18.6403      
      2300   294.18069     -43168.438      1665.8651      4136.956       17.3186        12.8149        18.6403      
      2400   283.59407     -43166.377     -12665.332      4136.956       17.3186        12.8149        18.6403      
      2500   288.4505      -43157.345     -4387.8698      4136.956       17.3186        12.8149        18.6403      
      2600   328.5037      -43170.78      -11953.105      4136.956       17.3186        12.8149        18.6403      
      2700   333.19881     -43174.252     -6928.0035      4136.956       17.3186        12.8149        18.6403      
      2800   286.72754     -43156.525     -4771.9119      4136.956       17.3186        12.8149        18.6403      
      2900   291.38704     -43162.952     -10338.084      4136.956       17.3186        12.8149        18.6403      
      3000   294.66224     -43161.478     -6321.9755      4136.956       17.3186        12.8149        18.6403      
      3100   302.19668     -43172.396     -6863.7671      4136.956       17.3186        12.8149        18.6403      
      3200   283.76464     -43165.839      6127.7937      4136.956       17.3186        12.8149        18.6403      
      3300   287.45858     -43183.618     -6520.8237      4136.956       17.3186        12.8149        18.6403      
      3400   297.8397      -43220.77      -1321.4789      4136.956       17.3186        12.8149        18.6403      
      3500   302.50537     -43235.556     -4938.4003      4136.956       17.3186        12.8149        18.6403      
      3600   299.52572     -43209.43       1487.1668      4136.956       17.3186        12.8149        18.6403      
      3700   306.76119     -43185.774     -10192.981      4136.956       17.3186        12.8149        18.6403      
      3800   302.70776     -43177.952     -4014.6838      4136.956       17.3186        12.8149        18.6403      
      3900   317.92298     -43200.014     -8965.9054      4136.956       17.3186        12.8149        18.6403      
      4000   308.70936     -43200.103     -10509.929      4136.956       17.3186        12.8149        18.6403      
      4100   293.26125     -43191.973     -9249.5192      4136.956       17.3186        12.8149        18.6403      
      4200   295.76367     -43222.448     -1968.0124      4136.956       17.3186        12.8149        18.6403      
      4300   285.90331     -43210.72      -230.53845      4136.956       17.3186        12.8149        18.6403      
      4400   288.98595     -43186.213     -13129.05       4136.956       17.3186        12.8149        18.6403      
      4500   298.01049     -43174.805     -8597.8281      4136.956       17.3186        12.8149        18.6403      
      4600   306.2896      -43179.154     -8624.1313      4136.956       17.3186        12.8149        18.6403      
      4700   307.58535     -43183.846     -3621.2319      4136.956       17.3186        12.8149        18.6403      
      4800   291.10396     -43189.663     -10881.262      4136.956       17.3186        12.8149        18.6403      
      4900   258.43358     -43164.836     -10281.643      4136.956       17.3186        12.8149        18.6403      
      5000   299.41813     -43192.74      -9967.8388      4136.956       17.3186        12.8149        18.6403      
Loop time of 258.99 on 16 procs for 5000 steps with 371 atoms

Performance: 0.834 ns/day, 28.777 hours/ns, 19.306 timesteps/s, 7.162 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 197.46     | 199.52     | 203.5      |  13.0 | 77.04
Bond    | 0.0017791  | 0.0019848  | 0.0022162  |   0.3 |  0.00
Neigh   | 13.175     | 13.541     | 13.855     |   6.3 |  5.23
Comm    | 17.767     | 21.854     | 24.025     |  40.2 |  8.44
Output  | 0.032889   | 0.055895   | 0.078835   |   6.8 |  0.02
Modify  | 22.625     | 23.093     | 23.568     |   6.4 |  8.92
Other   |            | 0.924      |            |       |  0.36

Nlocal:         46.375 ave          52 max          43 min
Histogram: 1 2 1 0 2 0 1 0 0 1
Nghost:        3397.25 ave        3433 max        3339 min
Histogram: 1 0 0 1 0 1 2 0 1 2
Neighs:          29027 ave       32337 max       26878 min
Histogram: 2 1 1 0 2 0 1 0 0 1

Total # of neighbors = 232216
Ave neighs/atom = 625.91914
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 18.6403
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--8.851)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.002 seconds
  read_restart CPU = 0.007 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*18.6403
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.8510000000000008669, deltaxy = 0.8851
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.4588999999999999746, deltaxz = -0.04589
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.20539999999999999925, deltayz = -0.02054
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -1.86403 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.5 | 134 | 135.8 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   295.90007     -43197.274     -7613.9562      4136.956       17.3186        12.8149        18.6403      
       100   322.63792     -43189.966     -9827.9514      4136.956       17.3186        12.8149        18.6403      
       200   300.72901     -43155.038     -20261.865      4136.956       17.3186        12.8149        18.6403      
       300   315.4355      -43181.053      2767.6705      4136.956       17.3186        12.8149        18.6403      
       400   288.10976     -43173.033     -9443.4158      4136.956       17.3186        12.8149        18.6403      
       500   286.93158     -43174.241     -10011.341      4136.956       17.3186        12.8149        18.6403      
       600   311.89007     -43192.104     -4100.8624      4136.956       17.3186        12.8149        18.6403      
       700   283.74691     -43161.619     -9940.3626      4136.956       17.3186        12.8149        18.6403      
       800   317.27202     -43192.798     -9893.2802      4136.956       17.3186        12.8149        18.6403      
       900   299.23167     -43171.539     -2523.0998      4136.956       17.3186        12.8149        18.6403      
      1000   295.31726     -43164.283     -15146.499      4136.956       17.3186        12.8149        18.6403      
      1100   302.7058      -43175.702     -16808.707      4136.956       17.3186        12.8149        18.6403      
      1200   301.38366     -43189.042     -7676.1933      4136.956       17.3186        12.8149        18.6403      
      1300   290.04062     -43184.346     -5914.8587      4136.956       17.3186        12.8149        18.6403      
      1400   292.88692     -43174.429     -7507.3009      4136.956       17.3186        12.8149        18.6403      
      1500   320.07873     -43161.117     -239.69472      4136.956       17.3186        12.8149        18.6403      
      1600   310.11712     -43149.381     -9774.811       4136.956       17.3186        12.8149        18.6403      
      1700   301.85896     -43171.394      3241.0393      4136.956       17.3186        12.8149        18.6403      
      1800   282.96504     -43155.495     -14016.69       4136.956       17.3186        12.8149        18.6403      
      1900   287.12126     -43165.287     -12268.455      4136.956       17.3186        12.8149        18.6403      
      2000   305.28144     -43192.554     -2968.7261      4136.956       17.3186        12.8149        18.6403      
      2100   311.04761     -43211.72      -2777.1925      4136.956       17.3186        12.8149        18.6403      
      2200   276.62383     -43189.141     -5139.9466      4136.956       17.3186        12.8149        18.6403      
      2300   302.95459     -43203.429     -3604.085       4136.956       17.3186        12.8149        18.6403      
      2400   304.92866     -43160.901     -6771.5958      4136.956       17.3186        12.8149        18.6403      
      2500   300.93457     -43155.364     -17620.192      4136.956       17.3186        12.8149        18.6403      
      2600   298.89629     -43176.02      -3496.0668      4136.956       17.3186        12.8149        18.6403      
      2700   282.16733     -43170.129     -11970.601      4136.956       17.3186        12.8149        18.6403      
      2800   289.62217     -43184.39       9593.9261      4136.956       17.3186        12.8149        18.6403      
      2900   279.37801     -43154.435      1494.2196      4136.956       17.3186        12.8149        18.6403      
      3000   319.72062     -43156.382      2067.6782      4136.956       17.3186        12.8149        18.6403      
      3100   304.43826     -43142.386     -10052.491      4136.956       17.3186        12.8149        18.6403      
      3200   292.24441     -43152.567     -9290.8891      4136.956       17.3186        12.8149        18.6403      
      3300   284.49437     -43154.852     -15569.469      4136.956       17.3186        12.8149        18.6403      
      3400   326.96871     -43201.668     -10787.035      4136.956       17.3186        12.8149        18.6403      
      3500   298.45422     -43164.355      7825.9356      4136.956       17.3186        12.8149        18.6403      
      3600   312.01413     -43171.549     -4538.9704      4136.956       17.3186        12.8149        18.6403      
      3700   309.27225     -43153.442      5403.559       4136.956       17.3186        12.8149        18.6403      
      3800   311.60346     -43144.466     -4781.0522      4136.956       17.3186        12.8149        18.6403      
      3900   321.64244     -43174.416      3096.4266      4136.956       17.3186        12.8149        18.6403      
      4000   301.67606     -43176.488     -5904.8752      4136.956       17.3186        12.8149        18.6403      
      4100   303.9847      -43176.244     -9550.2171      4136.956       17.3186        12.8149        18.6403      
      4200   287.57528     -43136.586     -6739.9315      4136.956       17.3186        12.8149        18.6403      
      4300   328.16191     -43166.172     -7099.7202      4136.956       17.3186        12.8149        18.6403      
      4400   313.19547     -43162.452     -9226.518       4136.956       17.3186        12.8149        18.6403      
      4500   299.85992     -43184.399     -2085.6087      4136.956       17.3186        12.8149        18.6403      
      4600   274.65478     -43148.169      4425.5465      4136.956       17.3186        12.8149        18.6403      
      4700   295.8545      -43142.923     -4024.2201      4136.956       17.3186        12.8149        18.6403      
      4800   306.39579     -43135.703     -5454.1305      4136.956       17.3186        12.8149        18.6403      
      4900   292.63031     -43134.772     -4133.3606      4136.956       17.3186        12.8149        18.6403      
      5000   301.11109     -43167.413     -5690.5703      4136.956       17.3186        12.8149        18.6403      
Loop time of 255.239 on 16 procs for 5000 steps with 371 atoms

Performance: 0.846 ns/day, 28.360 hours/ns, 19.589 timesteps/s, 7.268 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 172.63     | 192.32     | 208.4      | 102.4 | 75.35
Bond    | 0.0016064  | 0.0018366  | 0.0021234  |   0.4 |  0.00
Neigh   | 12.089     | 13.601     | 14.804     |  29.5 |  5.33
Comm    | 9.7744     | 25.905     | 45.646     | 279.4 | 10.15
Output  | 0.022223   | 0.025889   | 0.029869   |   1.6 |  0.01
Modify  | 21.555     | 22.817     | 24.241     |  22.9 |  8.94
Other   |            | 0.5676     |            |       |  0.22

Nlocal:         46.375 ave          54 max          40 min
Histogram: 2 0 0 2 0 2 0 1 0 1
Nghost:           3603 ave        3664 max        3497 min
Histogram: 1 0 0 0 1 2 0 1 1 2
Neighs:        29014.1 ave       33750 max       25301 min
Histogram: 2 0 0 2 0 2 0 1 0 1

Total # of neighbors = 232113
Ave neighs/atom = 625.64151
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*18.6403
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 1.86403 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.5 | 134 | 135.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   295.90007     -43197.274     -7613.9562      4136.956       17.3186        12.8149        18.6403      
       100   322.37531     -43189.658     -9758.6269      4136.956       17.3186        12.8149        18.6403      
       200   301.55339     -43157.224     -12926.344      4136.956       17.3186        12.8149        18.6403      
       300   320.48523     -43182.969      1060.757       4136.956       17.3186        12.8149        18.6403      
       400   292.60629     -43174.106     -7007.9337      4136.956       17.3186        12.8149        18.6403      
       500   290.51165     -43172         -14991.144      4136.956       17.3186        12.8149        18.6403      
       600   314.24659     -43190.71      -14720.271      4136.956       17.3186        12.8149        18.6403      
       700   291.23395     -43163.186      2791.1679      4136.956       17.3186        12.8149        18.6403      
       800   299.36742     -43171.236      2439.7978      4136.956       17.3186        12.8149        18.6403      
       900   291.45345     -43163.312     -13695.125      4136.956       17.3186        12.8149        18.6403      
      1000   282.58296     -43174.399     -4531.3327      4136.956       17.3186        12.8149        18.6403      
      1100   279.37463     -43191.017      7116.4975      4136.956       17.3186        12.8149        18.6403      
      1200   301.85874     -43199.974      950.45257      4136.956       17.3186        12.8149        18.6403      
      1300   306.38477     -43172.164      1129.3252      4136.956       17.3186        12.8149        18.6403      
      1400   306.70857     -43160.677     -2182.3345      4136.956       17.3186        12.8149        18.6403      
      1500   293.16817     -43144.574     -5669.8737      4136.956       17.3186        12.8149        18.6403      
      1600   297.84301     -43150.767     -9374.5209      4136.956       17.3186        12.8149        18.6403      
      1700   309.14887     -43167.13      -4545.3927      4136.956       17.3186        12.8149        18.6403      
      1800   296.35311     -43155.114      48.482672      4136.956       17.3186        12.8149        18.6403      
      1900   314.13662     -43177.776     -6617.4258      4136.956       17.3186        12.8149        18.6403      
      2000   309.87991     -43175.325     -21660.428      4136.956       17.3186        12.8149        18.6403      
      2100   305.19846     -43173.363     -9627.3927      4136.956       17.3186        12.8149        18.6403      
      2200   302.11403     -43167.835     -8385.5774      4136.956       17.3186        12.8149        18.6403      
      2300   296.94367     -43162.218     -17505.885      4136.956       17.3186        12.8149        18.6403      
      2400   293.94855     -43164.063     -10828.957      4136.956       17.3186        12.8149        18.6403      
      2500   302.17687     -43159.726     -16317.592      4136.956       17.3186        12.8149        18.6403      
      2600   304.7207      -43132.488     -6916.9501      4136.956       17.3186        12.8149        18.6403      
      2700   292.03063     -43122.597     -12448.185      4136.956       17.3186        12.8149        18.6403      
      2800   303.16272     -43159.224     -14810.381      4136.956       17.3186        12.8149        18.6403      
      2900   297.40129     -43167.631     -11031.812      4136.956       17.3186        12.8149        18.6403      
      3000   299.18057     -43163.02      -13638.013      4136.956       17.3186        12.8149        18.6403      
      3100   293.03032     -43138.126     -3849.5345      4136.956       17.3186        12.8149        18.6403      
      3200   308.93843     -43141.195     -7554.826       4136.956       17.3186        12.8149        18.6403      
      3300   292.09692     -43116.921     -15734.338      4136.956       17.3186        12.8149        18.6403      
      3400   296.24843     -43124.935     -5706.8967      4136.956       17.3186        12.8149        18.6403      
      3500   304.23594     -43138.734     -17469.027      4136.956       17.3186        12.8149        18.6403      
      3600   294.94929     -43143.876     -7777.9587      4136.956       17.3186        12.8149        18.6403      
      3700   282.47754     -43134.223     -12966.436      4136.956       17.3186        12.8149        18.6403      
      3800   291.14493     -43145.195     -7371.8747      4136.956       17.3186        12.8149        18.6403      
      3900   297.48418     -43141.2       -11452.089      4136.956       17.3186        12.8149        18.6403      
      4000   312.56038     -43130.891     -16360.329      4136.956       17.3186        12.8149        18.6403      
      4100   321.33761     -43127.678     -4482.2789      4136.956       17.3186        12.8149        18.6403      
      4200   306.82532     -43127.888      2217.349       4136.956       17.3186        12.8149        18.6403      
      4300   288.70369     -43132.629      1710.4835      4136.956       17.3186        12.8149        18.6403      
      4400   302.17381     -43139.252     -13768.094      4136.956       17.3186        12.8149        18.6403      
      4500   311.82589     -43138.409     -16045.168      4136.956       17.3186        12.8149        18.6403      
      4600   298.96578     -43123.856     -10248.351      4136.956       17.3186        12.8149        18.6403      
      4700   273.83868     -43109.862     -4127.0661      4136.956       17.3186        12.8149        18.6403      
      4800   304.43446     -43129.705     -12111.974      4136.956       17.3186        12.8149        18.6403      
      4900   294.30045     -43097.537     -11343.439      4136.956       17.3186        12.8149        18.6403      
      5000   310.77151     -43103.867     -11095.495      4136.956       17.3186        12.8149        18.6403      
Loop time of 189.879 on 16 procs for 5000 steps with 371 atoms

Performance: 1.138 ns/day, 21.098 hours/ns, 26.332 timesteps/s, 9.769 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 125.69     | 139.74     | 158.85     |  99.7 | 73.60
Bond    | 0.0011311  | 0.0013811  | 0.0018978  |   0.6 |  0.00
Neigh   | 9.4348     | 10.425     | 11.615     |  24.2 |  5.49
Comm    | 1.6442     | 20.765     | 34.834     | 258.8 | 10.94
Output  | 0.013554   | 0.015263   | 0.016846   |   0.9 |  0.01
Modify  | 17.629     | 18.816     | 19.796     |  18.0 |  9.91
Other   |            | 0.1126     |            |       |  0.06

Nlocal:         46.375 ave          53 max          39 min
Histogram: 1 0 1 1 1 2 0 0 0 2
Nghost:        3250.38 ave        3279 max        3195 min
Histogram: 1 0 1 0 0 2 0 0 0 4
Neighs:        28968.5 ave       33064 max       24720 min
Histogram: 1 0 1 2 0 2 0 0 0 2

Total # of neighbors = 231748
Ave neighs/atom = 624.65768
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:55:32
