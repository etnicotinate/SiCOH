LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-EXP-1-vasp
read_data       ${structure}.data
read_data       333-EXP-1-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.012 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.864 | 6.864 | 6.864 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              241.44561      3354.3242    
         1   300            0              0              241.44561      3354.3242    
Loop time of 8.6229e-05 on 16 procs for 1 steps with 271 atoms

60.4% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.79e-07   | 2.9687e-07 | 3.93e-07   |   0.0 |  0.34
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 1.242e-06  | 1.802e-06  | 2.133e-06  |   0.0 |  2.09
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 8.413e-05  |            |       | 97.57

Nlocal:         33.875 ave          38 max          27 min
Histogram: 1 1 0 0 0 0 2 0 2 2
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-EXP-1-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -9.02 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.5 | 109.1 | 110.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -30660.091      116480.91      0              1.5329564      3290.3881    
       100   556.99504     -31376.055     -13646.559     -872.79841      1.5329564      3290.3881    
       200   411.45339     -31531.555     -22836.819     -4423.8976      1.5329564      3290.3881    
       300   376.5346      -31654.498     -10634.96      -5191.6982      1.5329564      3290.3881    
       400   353.8869      -31730.888     -1525.2889      4094.5514      1.5329564      3290.3881    
       500   312.18838     -31757.575     -5349.6476     -646.9095       1.5329564      3290.3881    
       600   284.43808     -31754.464     -12472.039      6823.3298      1.5329564      3290.3881    
       700   295.49124     -31787.884      12910.216      7029.9224      1.5329564      3290.3881    
       800   325.73688     -31796.033     -8488.004       4223.3147      1.5329564      3290.3881    
       900   338.37475     -31810.005      5121.9965      3658.8926      1.5329564      3290.3881    
      1000   274.19491     -31828.283     -1929.9154      7764.3586      1.5329564      3290.3881    
      1100   307.13859     -31847.903     -8315.9292      3292.4361      1.5329564      3290.3881    
      1200   326.40837     -31846.512     -17762.032      3052.8265      1.5329564      3290.3881    
      1300   295.92969     -31855.817     -5630.6427      6467.358       1.5329564      3290.3881    
      1400   299.72274     -31862.665     -2327.7239      1847.3006      1.5329564      3290.3881    
      1500   301.82544     -31883.947     -1991.3972      5140.092       1.5329564      3290.3881    
      1600   308.65665     -31879.49       11831.862      4778.1673      1.5329564      3290.3881    
      1700   314.80596     -31861.533     -635.22919      4171.41        1.5329564      3290.3881    
      1800   303.09329     -31897.31       3747.4229      10379.663      1.5329564      3290.3881    
      1900   294.08707     -31892.515     -2535.1669     -25.009129      1.5329564      3290.3881    
      2000   282.55737     -31871.267      10323.314      4169.1498      1.5329564      3290.3881    
Loop time of 79.9433 on 16 procs for 2000 steps with 271 atoms

Performance: 1.081 ns/day, 22.206 hours/ns, 25.018 timesteps/s, 6.780 katom-step/s
98.6% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 56.215     | 57.992     | 59.113     |  14.3 | 72.54
Bond    | 0.00065591 | 0.00073437 | 0.00084496 |   0.0 |  0.00
Neigh   | 4.7533     | 4.8037     | 4.831      |   1.1 |  6.01
Comm    | 6.5391     | 7.664      | 9.3845     |  38.5 |  9.59
Output  | 0.0011013  | 0.0016448  | 0.0052038  |   3.3 |  0.00
Modify  | 9.0993     | 9.1741     | 9.2499     |   1.6 | 11.48
Other   |            | 0.3068     |            |       |  0.38

Nlocal:         33.875 ave          41 max          22 min
Histogram: 1 0 0 0 0 2 2 1 1 1
Nghost:        2777.88 ave        2822 max        2724 min
Histogram: 1 0 1 2 0 1 0 0 1 2
Neighs:        19567.2 ave       23496 max       12994 min
Histogram: 1 0 0 0 0 2 2 1 1 1

Total # of neighbors = 156538
Ave neighs/atom = 577.631
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]
# use tmp to save constants
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 14.7487
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.4318
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 16.6096

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-4169.14982011294)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-4169.14982011294)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--2801.07229266411)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--2801.07229266411)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--3191.94040525519)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--3191.94040525519)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--1054.47374923388)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--1054.47374923388)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-4817.59669988214)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-4817.59669988214)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--1152.77787349491)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--1152.77787349491)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 14.7487
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.006 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.7487
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.147487 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.147487 xy delta 0.061972 xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.147487 xy delta 0.061972 xz delta 0.010047 remap x units box
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108 | 109.8 | 111.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   282.55737     -31871.267      10323.427      0              3290.3881    
       100   298.35928     -31886.782      6975.6149      11097.751      3288.743     
       200   296.9344      -31885.804      7546.8568      5128.2862      3287.0978    
       300   282.56708     -31904.288      848.21672      7038.0001      3285.4526    
       400   281.72978     -31900.388     -1472.4952      3711.8854      3283.8074    
       500   304.48704     -31904.627      146.87123      7216.6405      3282.1622    
       600   309.91321     -31904.76       1135.4669      9377.1283      3280.517     
       700   294.33335     -31873.244      9127.0828      10267.295      3278.8718    
       800   316.21188     -31913.23       5002.6081      6016.616       3277.2266    
       900   323.63242     -31885.778      6766.1721      4673.5943      3275.5814    
      1000   307.18159     -31904.338     -2548.6638      5713.9931      3273.9362    
      1100   324.82611     -31898.168      9405.9947      4013.4605      3272.291     
      1200   348.89066     -31890.632      8929.4172      2968.9736      3270.6458    
      1300   319.19408     -31887.712     -1889.2705      725.6199       3269.0006    
      1400   311.31381     -31905.184     -5071.7801      9972.2885      3267.3554    
      1500   311.59666     -31915.03      -15045.328      2963.8265      3265.7102    
      1600   296.2252      -31916.252      2697.7711      6015.4138      3264.065     
      1700   305.85408     -31931.52      -3524.9027      3182.5436      3262.4198    
      1800   307.90268     -31897.42      -7474.0007      5844.5127      3260.7747    
      1900   292.96082     -31911.362      2095.9079      6254.9493      3259.1295    
      2000   287.15034     -31921.904     -1430.6882      10372.231      3257.4843    
Loop time of 82.4447 on 16 procs for 2000 steps with 271 atoms

Performance: 1.048 ns/day, 22.901 hours/ns, 24.259 timesteps/s, 6.574 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.064     | 60.347     | 61.571     |  14.7 | 73.20
Bond    | 0.00064605 | 0.00074823 | 0.00086662 |   0.0 |  0.00
Neigh   | 4.7508     | 4.913      | 4.9972     |   3.9 |  5.96
Comm    | 6.222      | 7.5123     | 9.7884     |  41.9 |  9.11
Output  | 0.0086349  | 0.01309    | 0.018796   |   3.2 |  0.02
Modify  | 9.1809     | 9.2768     | 9.4428     |   2.9 | 11.25
Other   |            | 0.3817     |            |       |  0.46

Nlocal:         33.875 ave          41 max          28 min
Histogram: 1 1 0 1 2 0 2 0 0 1
Nghost:        2787.12 ave        2837 max        2731 min
Histogram: 1 0 0 2 1 1 0 1 1 1
Neighs:        19780.6 ave       23902 max       16531 min
Histogram: 1 1 0 1 2 1 1 0 0 1

Total # of neighbors = 158245
Ave neighs/atom = 583.92989
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 62.8527188545601
variable C2neg equal ${d2}
variable C2neg equal 9.61102002522513
variable C3neg equal ${d3}
variable C3neg equal 40.3282321332058
variable C4neg equal ${d4}
variable C4neg equal 1.89181357858678
variable C5neg equal ${d5}
variable C5neg equal -15.6694801356065
variable C6neg equal ${d6}
variable C6neg equal -4.6815066756094

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.005 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.7487
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.147487 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.147487 xy delta -0.061972 xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.147487 xy delta -0.061972 xz delta -0.010047 remap x units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108 | 109.8 | 111.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   282.55737     -31871.267      10323.427      0              3290.3881    
       100   298.35928     -31886.782      6968.6427      11096.529      3292.0333    
       200   298.42837     -31879.311     -2077.0646      3158.7671      3293.6785    
       300   277.45145     -31871.665     -4259.5387      5198.355       3295.3237    
       400   316.21761     -31897.333     -84.214412      4169.9118      3296.9689    
       500   309.10379     -31896.328      7980.672       10752.201      3298.6141    
       600   293.37461     -31905.856      11276.674      6211.3645      3300.2593    
       700   308.45083     -31885.427      7687.0289      11364.519      3301.9045    
       800   310.21723     -31912.566      1882.1936      12173.59       3303.5497    
       900   316.49852     -31913.059     -10111.997      1870.8279      3305.1949    
      1000   310.77287     -31939.017     -6065.0713      7111.4531      3306.8401    
      1100   318.70542     -31915.228     -23299.856     -879.87209      3308.4853    
      1200   332.64553     -31908.445     -3917.5257      1521.409       3310.1305    
      1300   282.12992     -31898.37      -11583.384     -2043.9378      3311.7757    
      1400   292.01273     -31906.439      10290.362      337.85737      3313.4209    
      1500   293.91996     -31913.324     -21649.714     -3876.331       3315.0661    
      1600   308.75131     -31903.149      2155.2421      2535.1805      3316.7113    
      1700   304.74477     -31891.349      4503.6468      6666.3415      3318.3564    
      1800   308.90804     -31892.775     -14328.685      6891.9628      3320.0016    
      1900   297.43566     -31897.253     -1152.6068     -1881.958       3321.6468    
      2000   321.70746     -31916.909     -5196.3456      82.191899      3323.292     
Loop time of 81.6906 on 16 procs for 2000 steps with 271 atoms

Performance: 1.058 ns/day, 22.692 hours/ns, 24.483 timesteps/s, 6.635 katom-step/s
98.7% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.168     | 59.774     | 60.967     |  14.6 | 73.17
Bond    | 0.000655   | 0.0007496  | 0.00088482 |   0.0 |  0.00
Neigh   | 4.7349     | 4.848      | 4.9199     |   2.4 |  5.93
Comm    | 6.2316     | 7.3952     | 9.0105     |  41.5 |  9.05
Output  | 0.0047921  | 0.0092776  | 0.013993   |   3.7 |  0.01
Modify  | 9.2338     | 9.3126     | 9.4589     |   2.1 | 11.40
Other   |            | 0.351      |            |       |  0.43

Nlocal:         33.875 ave          38 max          25 min
Histogram: 1 0 0 0 1 0 1 2 1 2
Nghost:        2760.75 ave        2781 max        2734 min
Histogram: 1 1 0 0 0 2 0 2 1 1
Neighs:        19386.5 ave       21721 max       14519 min
Histogram: 1 0 0 0 1 0 1 2 2 1

Total # of neighbors = 155092
Ave neighs/atom = 572.2952
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 41.4111011358064
variable C2pos equal ${d2}
variable C2pos equal 1.35627861075543
variable C3pos equal ${d3}
variable C3pos equal 40.0138394247938
variable C4pos equal ${d4}
variable C4pos equal -1.6216967744773
variable C5pos equal ${d5}
variable C5pos equal 16.711103853449
variable C6pos equal ${d6}
variable C6pos equal 5.3188181209611

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(62.8527188545601+${C1pos})
variable C11 equal 0.5*(62.8527188545601+41.4111011358064)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(9.61102002522513+${C2pos})
variable C21 equal 0.5*(9.61102002522513+1.35627861075543)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(40.3282321332058+${C3pos})
variable C31 equal 0.5*(40.3282321332058+40.0138394247938)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(1.89181357858678+${C4pos})
variable C41 equal 0.5*(1.89181357858678+-1.6216967744773)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(-15.6694801356065+${C5pos})
variable C51 equal 0.5*(-15.6694801356065+16.711103853449)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-4.6815066756094+${C6pos})
variable C61 equal 0.5*(-4.6815066756094+5.3188181209611)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.4318
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4318
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.134318 yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.134318 yz delta 0.018606 remap x units box
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108 | 109.8 | 111.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   282.55737     -31871.267      10323.427      0              3290.3881    
       100   298.35928     -31886.782      6975.6149      11097.751      3288.743     
       200   298.95586     -31879.095     -2114.5402      3542.3159      3287.0978    
       300   293.24789     -31873.903     -15197.569      2164.474       3285.4526    
       400   337.04292     -31910.685     -2457.6645      8674.2317      3283.8074    
       500   313.92921     -31877.216      205.56964      14746.232      3282.1622    
       600   289.77308     -31902.297     -239.75241      13656.179      3280.517     
       700   302.83576     -31887.515      2499.3611      8363.3532      3278.8718    
       800   294.93262     -31878.41       7156.451       9986.954       3277.2266    
       900   294.75951     -31897.105      674.85449      3979.6224      3275.5814    
      1000   275.34297     -31899.504     -3055.0492      3973.5539      3273.9362    
      1100   276.11828     -31927.008      7946.4542      8045.9559      3272.291     
      1200   289.97874     -31920.333     -9675.6381      619.53868      3270.6458    
      1300   304.38226     -31916.168     -3324.1473      6790.3667      3269.0006    
      1400   282.35424     -31900.732     -11912.762      2506.2872      3267.3554    
      1500   296.20226     -31919.284      25.408911      6393.5704      3265.7102    
      1600   323.41546     -31921.692     -2229.7586      3296.6794      3264.065     
      1700   304.77805     -31923.988     -14351.669     -335.40643      3262.4198    
      1800   304.13875     -31925.94      -4641.6446      5249.558       3260.7747    
      1900   287.17754     -31920.15      -3952.0061      6353.7173      3259.1295    
      2000   276.91686     -31922.5        12629.85       7543.6462      3257.4843    
Loop time of 82.4108 on 16 procs for 2000 steps with 271 atoms

Performance: 1.048 ns/day, 22.892 hours/ns, 24.269 timesteps/s, 6.577 katom-step/s
98.7% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.316     | 60.626     | 62.021     |  16.0 | 73.57
Bond    | 0.00065167 | 0.00073625 | 0.00083122 |   0.0 |  0.00
Neigh   | 4.8752     | 4.9422     | 5.0642     |   2.7 |  6.00
Comm    | 5.6966     | 7.156      | 9.4532     |  46.2 |  8.68
Output  | 0.0060693  | 0.011668   | 0.017146   |   4.0 |  0.01
Modify  | 9.118      | 9.2591     | 9.3603     |   2.7 | 11.24
Other   |            | 0.4151     |            |       |  0.50

Nlocal:         33.875 ave          38 max          22 min
Histogram: 1 0 0 0 0 1 1 0 1 4
Nghost:           2767 ave        2806 max        2726 min
Histogram: 1 1 0 0 1 1 3 0 0 1
Neighs:        19770.2 ave       22162 max       13087 min
Histogram: 1 0 0 0 0 1 1 0 1 4

Total # of neighbors = 158162
Ave neighs/atom = 583.62362
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 34.1920846706625
variable C2neg equal ${d2}
variable C2neg equal 17.0873951654443
variable C3neg equal ${d3}
variable C3neg equal 20.4706902245376
variable C4neg equal ${d4}
variable C4neg equal 10.1636718245293
variable C5neg equal ${d5}
variable C5neg equal -5.64318299528847
variable C6neg equal ${d6}
variable C6neg equal -19.7147547677719

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4318
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.134318 yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.134318 yz delta -0.018606 remap x units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108 | 109.8 | 111.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   282.55737     -31871.267      10323.427      0              3290.3881    
       100   298.35928     -31886.782      6968.6427      11096.529      3292.0333    
       200   298.31288     -31879.069     -2344.9663      3353.7001      3293.6785    
       300   279.86712     -31885.218     -1047.0668      3700.3308      3295.3237    
       400   305.19628     -31890.842      6058.6411      6205.1489      3296.9689    
       500   298.35641     -31903.834      5494.1737      2544.3068      3298.6141    
       600   307.67749     -31936.18       419.04834      3803.1747      3300.2593    
       700   277.64459     -31919.303     -21623.342     -917.51678      3301.9045    
       800   286.75652     -31894.434      1714.9787      5276.6098      3303.5497    
       900   281.63769     -31904.913      3121.7797      10215.184      3305.1949    
      1000   286.93462     -31904.077      1905.1787      4507.684       3306.8401    
      1100   301.27707     -31911.833     -3733.1082      4411.2101      3308.4853    
      1200   281.49632     -31908.254     -16.968941      1305.3554      3310.1305    
      1300   292.39986     -31909.745     -3969.1503     -1370.2344      3311.7757    
      1400   302.27227     -31914.63      -17520.344     -3723.3589      3313.4209    
      1500   305.66157     -31939.174     -6608.9161     -2420.335       3315.0661    
      1600   305.54222     -31915.449     -12711.487      699.47894      3316.7113    
      1700   317.20094     -31907.868     -16289.476      3264.6703      3318.3564    
      1800   304.61275     -31918.427     -8123.3196      3597.427       3320.0016    
      1900   271.2338      -31927.484      13374.446      7786.7735      3321.6468    
      2000   280.45549     -31922.003     -5846.1839      1122.2158      3323.292     
Loop time of 81.7973 on 16 procs for 2000 steps with 271 atoms

Performance: 1.056 ns/day, 22.721 hours/ns, 24.451 timesteps/s, 6.626 katom-step/s
98.7% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.761     | 59.81      | 61.389     |  12.3 | 73.12
Bond    | 0.00062657 | 0.00074891 | 0.0009342  |   0.0 |  0.00
Neigh   | 4.7905     | 4.8935     | 4.994      |   3.3 |  5.98
Comm    | 5.7327     | 7.3047     | 8.283      |  34.7 |  8.93
Output  | 0.0050562  | 0.0084063  | 0.011709   |   2.8 |  0.01
Modify  | 9.2551     | 9.4128     | 9.5868     |   3.5 | 11.51
Other   |            | 0.3671     |            |       |  0.45

Nlocal:         33.875 ave          38 max          28 min
Histogram: 1 0 0 1 1 1 1 0 0 3
Nghost:        2756.88 ave        2786 max        2721 min
Histogram: 1 1 0 0 0 1 3 0 1 1
Neighs:        19392.8 ave       21740 max       16291 min
Histogram: 1 0 1 1 1 1 0 0 1 2

Total # of neighbors = 155142
Ave neighs/atom = 572.4797
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 30.8730593167238
variable C2pos equal ${d2}
variable C2pos equal 73.5227523720468
variable C3pos equal ${d3}
variable C3pos equal 49.0906162373152
variable C4pos equal ${d4}
variable C4pos equal 13.4744131393472
variable C5pos equal ${d5}
variable C5pos equal 23.5708534640507
variable C6pos equal ${d6}
variable C6pos equal -5.8507385993962

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(34.1920846706625+${C1pos})
variable C12 equal 0.5*(34.1920846706625+30.8730593167238)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(17.0873951654443+${C2pos})
variable C22 equal 0.5*(17.0873951654443+73.5227523720468)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(20.4706902245376+${C3pos})
variable C32 equal 0.5*(20.4706902245376+49.0906162373152)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(10.1636718245293+${C4pos})
variable C42 equal 0.5*(10.1636718245293+13.4744131393472)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(-5.64318299528847+${C5pos})
variable C52 equal 0.5*(-5.64318299528847+23.5708534640507)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(-19.7147547677719+${C6pos})
variable C62 equal 0.5*(-19.7147547677719+-5.8507385993962)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.6096
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.6096
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 -0.166096 remap x units box
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108 | 109.8 | 111.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   282.55737     -31871.267      10323.427      0              3290.3881    
       100   298.35928     -31886.782      6975.6149      11097.751      3288.743     
       200   299.4521      -31879.192     -2035.8109      3603.3237      3287.0978    
       300   294.98024     -31866.931     -3361.5409      5496.9743      3285.4526    
       400   315.72095     -31869.538      9626.3404      10233.161      3283.8074    
       500   294.72109     -31875.805      11121.931      8724.3217      3282.1622    
       600   315.58181     -31884.604      15777.474      15525.769      3280.517     
       700   308.78453     -31879.689      8942.2862      5558.1804      3278.8718    
       800   308.45921     -31887.931     -2631.2747      6154.8622      3277.2266    
       900   303.80548     -31886.14      -3804.6136      5359.039       3275.5814    
      1000   305.35576     -31876.927     -1004.4666      4291.0211      3273.9362    
      1100   318.24626     -31895.52       63.165114      9168.9109      3272.291     
      1200   298.32835     -31887.371      1252.8082      3200.6582      3270.6458    
      1300   310.02523     -31931.111     -11391.36       816.9058       3269.0006    
      1400   307.43743     -31921.179     -3996.3279     -522.32803      3267.3554    
      1500   296.90426     -31914.101      9528.3028      4368.4431      3265.7102    
      1600   311.27262     -31899.135      6966.8738      6932.6042      3264.065     
      1700   312.48408     -31916.274     -13075.707      1703.4291      3262.4198    
      1800   306.88695     -31911.671      4121.7673      6723.0716      3260.7747    
      1900   315.50162     -31915.002     -362.5209       4846.0544      3259.1295    
      2000   314.21345     -31918.106      8285.3707      3386.2486      3257.4843    
Loop time of 82.3644 on 16 procs for 2000 steps with 271 atoms

Performance: 1.049 ns/day, 22.879 hours/ns, 24.282 timesteps/s, 6.581 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.328     | 60.86      | 62.033     |  17.1 | 73.89
Bond    | 0.0006389  | 0.00073519 | 0.00084892 |   0.0 |  0.00
Neigh   | 4.7893     | 4.9197     | 5.042      |   3.5 |  5.97
Comm    | 5.8356     | 6.9938     | 9.5372     |  50.1 |  8.49
Output  | 0.0067759  | 0.0115     | 0.017862   |   3.6 |  0.01
Modify  | 9.0988     | 9.2714     | 9.4224     |   3.1 | 11.26
Other   |            | 0.3078     |            |       |  0.37

Nlocal:         33.875 ave          39 max          25 min
Histogram: 1 0 0 0 1 0 2 2 1 1
Nghost:        2798.88 ave        2838 max        2761 min
Histogram: 1 0 1 1 2 0 0 1 1 1
Neighs:        19779.4 ave       22672 max       14833 min
Histogram: 1 0 0 0 1 0 2 2 1 1

Total # of neighbors = 158235
Ave neighs/atom = 583.89299
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -7.93274671251823
variable C2neg equal ${d2}
variable C2neg equal 14.8147711925978
variable C3neg equal ${d3}
variable C3neg equal -24.4261533620894
variable C4neg equal ${d4}
variable C4neg equal 14.2698503862882
variable C5neg equal ${d5}
variable C5neg equal -14.209912849262
variable C6neg equal ${d6}
variable C6neg equal -25.6104290327119

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.6096
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 0.166096 remap x units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108 | 109.8 | 111.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   282.55737     -31871.267      10323.427      0              3290.3881    
       100   298.35928     -31886.782      6968.6427      11096.529      3292.0333    
       200   291.33049     -31872.894     -1981.9654      3948.0416      3293.6785    
       300   308.15934     -31888.226      1750.6609      5386.2272      3295.3237    
       400   286.04658     -31866.584      229.47419      6266.4195      3296.9689    
       500   280.60887     -31863.961      33.236548      8509.6845      3298.6141    
       600   322.82772     -31901.656     -2188.8709      13137.901      3300.2593    
       700   299.88973     -31872.518     -624.34737      6951.343       3301.9045    
       800   294.02713     -31888.396     -1657.6209      7847.4436      3303.5497    
       900   299.06352     -31908.644      8145.2795      7724.352       3305.1949    
      1000   324.40574     -31899.572      2713.1493      7256.1373      3306.8401    
      1100   300.11515     -31899.079      2208.4288      5448.864       3308.4853    
      1200   276.15064     -31883.025      2599.0555      7124.9943      3310.1305    
      1300   301.04764     -31894.087      2381.2953      3190.9617      3311.7757    
      1400   326.50361     -31898.829     -13923.239      6258.9941      3313.4209    
      1500   308.7325      -31882.089     -1787.0312      5823.819       3315.0661    
      1600   311.0465      -31875.413     -3764.8804      7327.1701      3316.7113    
      1700   318.93229     -31889.711     -1602.6302      7645.727       3318.3564    
      1800   298.25449     -31904.032     -7424.6226      3324.8513      3320.0016    
      1900   317.59022     -31915.329     -4953.5659      2555.8901      3321.6468    
      2000   303.83556     -31913.103     -5219.4527      2097.0117      3323.292     
Loop time of 81.7659 on 16 procs for 2000 steps with 271 atoms

Performance: 1.057 ns/day, 22.713 hours/ns, 24.460 timesteps/s, 6.629 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 56.796     | 59.369     | 60.54      |  16.0 | 72.61
Bond    | 0.00064683 | 0.00074698 | 0.00087551 |   0.0 |  0.00
Neigh   | 4.6907     | 4.822      | 4.9262     |   3.0 |  5.90
Comm    | 6.6945     | 7.8572     | 10.396     |  43.7 |  9.61
Output  | 0.004594   | 0.0078831  | 0.01089    |   2.9 |  0.01
Modify  | 9.2311     | 9.3529     | 9.5354     |   2.9 | 11.44
Other   |            | 0.3564     |            |       |  0.44

Nlocal:         33.875 ave          40 max          23 min
Histogram: 1 0 0 0 0 1 2 2 1 1
Nghost:           2729 ave        2757 max        2700 min
Histogram: 1 0 2 0 2 0 0 1 0 2
Neighs:          19393 ave       22736 max       13501 min
Histogram: 1 0 0 0 0 1 2 2 1 1

Total # of neighbors = 155144
Ave neighs/atom = 572.48708
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 20.9959392313853
variable C2pos equal ${d2}
variable C2pos equal 7.88419525051192
variable C3pos equal ${d3}
variable C3pos equal 55.687951951673
variable C4pos equal ${d4}
variable C4pos equal 14.7752374787211
variable C5pos equal ${d5}
variable C5pos equal 21.0995933628413
variable C6pos equal ${d6}
variable C6pos equal -2.71419055005305

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(-7.93274671251823+${C1pos})
variable C13 equal 0.5*(-7.93274671251823+20.9959392313853)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(14.8147711925978+${C2pos})
variable C23 equal 0.5*(14.8147711925978+7.88419525051192)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(-24.4261533620894+${C3pos})
variable C33 equal 0.5*(-24.4261533620894+55.687951951673)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(14.2698503862882+${C4pos})
variable C43 equal 0.5*(14.2698503862882+14.7752374787211)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-14.209912849262+${C5pos})
variable C53 equal 0.5*(-14.209912849262+21.0995933628413)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-25.6104290327119+${C6pos})
variable C63 equal 0.5*(-25.6104290327119+-2.71419055005305)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.6096
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.6096
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta -0.166096 remap x units box
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108 | 109.8 | 111.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   282.55737     -31871.267      10323.427      0              3290.3881    
       100   298.35928     -31886.782      6972.1271      11097.14       3290.3881    
       200   311.51077     -31874.133     -6905.4599      2846.0878      3290.3881    
       300   279.87657     -31871.596     -5462.8864      4655.7309      3290.3881    
       400   312.96849     -31881.846      13824.678      8417.1398      3290.3881    
       500   331.30714     -31890.338     -338.33707      12134.007      3290.3881    
       600   306.86149     -31907.6        2848.1201      14045.045      3290.3881    
       700   290.06887     -31900.191      14387.055      11954.337      3290.3881    
       800   288.14295     -31898.05       9939.0733      9786.738       3290.3881    
       900   297.84517     -31899.516      4229.4874      6110.9887      3290.3881    
      1000   296.30839     -31906.89      -5528.9325      7605.5194      3290.3881    
      1100   282.7591      -31895.606      11664.17       2906.7257      3290.3881    
      1200   302.69657     -31878.013     -7940.5079      6050.7141      3290.3881    
      1300   325.31187     -31899.67      -1417.5815      2468.9         3290.3881    
      1400   305.92848     -31882.657     -8740.8732      1842.6998      3290.3881    
      1500   294.00395     -31885.702     -594.56972      2814.3666      3290.3881    
      1600   313.00738     -31889.919      1556.9819      5039.1813      3290.3881    
      1700   293.97119     -31886.052     -12243.498      1977.408       3290.3881    
      1800   304.93497     -31897.005      1963.4558      3281.191       3290.3881    
      1900   302.12705     -31893.713     -1952.722      -1318.0523      3290.3881    
      2000   311.62453     -31921.831      636.19748      1994.3935      3290.3881    
Loop time of 81.5833 on 16 procs for 2000 steps with 271 atoms

Performance: 1.059 ns/day, 22.662 hours/ns, 24.515 timesteps/s, 6.644 katom-step/s
98.7% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.42      | 60.059     | 61.675     |  17.1 | 73.62
Bond    | 0.0006371  | 0.00074981 | 0.00086356 |   0.0 |  0.00
Neigh   | 4.7401     | 4.8909     | 4.9886     |   3.7 |  5.99
Comm    | 5.4745     | 7.0879     | 9.7278     |  49.6 |  8.69
Output  | 0.0058408  | 0.0094695  | 0.01398    |   3.0 |  0.01
Modify  | 9.0607     | 9.2018     | 9.396      |   3.7 | 11.28
Other   |            | 0.3339     |            |       |  0.41

Nlocal:         33.875 ave          39 max          24 min
Histogram: 1 0 0 0 0 2 2 0 1 2
Nghost:         2778.5 ave        2834 max        2716 min
Histogram: 1 0 0 2 2 0 0 1 1 1
Neighs:        19575.5 ave       22489 max       14154 min
Histogram: 1 0 0 0 0 2 2 0 1 2

Total # of neighbors = 156604
Ave neighs/atom = 577.87454
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -22.035718295652
variable C2neg equal ${d2}
variable C2neg equal 19.2808485392239
variable C3neg equal ${d3}
variable C3neg equal -22.6961413722944
variable C4neg equal ${d4}
variable C4neg equal 21.0796370546863
variable C5neg equal ${d5}
variable C5neg equal -17.5616276864975
variable C6neg equal ${d6}
variable C6neg equal -3.24195743452335

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.6096
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta 0.166096 remap x units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108 | 109.8 | 111.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   282.55737     -31871.267      10323.427      0              3290.3881    
       100   298.35928     -31886.782      6972.1271      11097.14       3290.3881    
       200   291.13593     -31872.802     -1614.1567      4168.5062      3290.3881    
       300   310.87629     -31879.31       7299.4409      4992.7812      3290.3881    
       400   307.48492     -31868.077     -347.86525      8107.0037      3290.3881    
       500   315.4297      -31863.944      4095.4151      7806.6156      3290.3881    
       600   299.2471      -31894.292     -9656.6539      6734.7699      3290.3881    
       700   282.75844     -31891.858      907.10319      10538.255      3290.3881    
       800   296.93278     -31893.339     -13056.745      3771.407       3290.3881    
       900   317.86036     -31877.662      5791.8257      6399.756       3290.3881    
      1000   315.46685     -31882.666      4006.1143      8423.5824      3290.3881    
      1100   307.60227     -31868.337      22860.223      12081.819      3290.3881    
      1200   282.30633     -31868.862      5177.4513      7735.0876      3290.3881    
      1300   302.38373     -31873.334      877.45073      4523.8868      3290.3881    
      1400   301.68915     -31864.243      8982.858       5502.1554      3290.3881    
      1500   318.78741     -31859.531      8362.4361      10566.745      3290.3881    
      1600   329.54409     -31876.189      5411.0153      3738.4409      3290.3881    
      1700   294.22082     -31887.736     -6789.3224      4384.1236      3290.3881    
      1800   302.90185     -31874.18      -2830.7886      5000.973       3290.3881    
      1900   307.6287      -31884.9       -10222.822      94.402217      3290.3881    
      2000   290.57889     -31873.262     -6045.59        194.32531      3290.3881    
Loop time of 81.847 on 16 procs for 2000 steps with 271 atoms

Performance: 1.056 ns/day, 22.735 hours/ns, 24.436 timesteps/s, 6.622 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 56.876     | 59.814     | 61.563     |  20.0 | 73.08
Bond    | 0.00067131 | 0.00074955 | 0.00089063 |   0.0 |  0.00
Neigh   | 4.7772     | 4.8844     | 5.0615     |   4.0 |  5.97
Comm    | 5.7229     | 7.4999     | 10.315     |  55.0 |  9.16
Output  | 0.005971   | 0.01066    | 0.014336   |   3.5 |  0.01
Modify  | 9.0618     | 9.2515     | 9.3569     |   3.6 | 11.30
Other   |            | 0.3862     |            |       |  0.47

Nlocal:         33.875 ave          41 max          26 min
Histogram: 1 1 0 0 1 1 2 0 1 1
Nghost:        2755.75 ave        2803 max        2702 min
Histogram: 1 0 1 1 0 2 1 0 0 2
Neighs:        19584.4 ave       23526 max       15203 min
Histogram: 1 1 0 0 1 2 1 0 1 1

Total # of neighbors = 156675
Ave neighs/atom = 578.13653
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 40.2749093227839
variable C2pos equal ${d2}
variable C2pos equal 20.4540415026277
variable C3pos equal ${d3}
variable C3pos equal 40.2882180012405
variable C4pos equal ${d4}
variable C4pos equal -8.42428134976246
variable C5pos equal ${d5}
variable C5pos equal 20.6132834406978
variable C6pos equal ${d6}
variable C6pos equal 7.85278366335241

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-22.035718295652+${C1pos})
variable C14 equal 0.5*(-22.035718295652+40.2749093227839)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(19.2808485392239+${C2pos})
variable C24 equal 0.5*(19.2808485392239+20.4540415026277)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-22.6961413722944+${C3pos})
variable C34 equal 0.5*(-22.6961413722944+40.2882180012405)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(21.0796370546863+${C4pos})
variable C44 equal 0.5*(21.0796370546863+-8.42428134976246)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-17.5616276864975+${C5pos})
variable C54 equal 0.5*(-17.5616276864975+20.6132834406978)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-3.24195743452335+${C6pos})
variable C64 equal 0.5*(-3.24195743452335+7.85278366335241)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.6096
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.6096
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta -0.166096 remap x units box
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108 | 109.8 | 111.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   282.55737     -31871.267      10323.427      0              3290.3881    
       100   298.35928     -31886.782      6972.1271      11097.14       3290.3881    
       200   291.41469     -31872.512     -1893.9178      4052.8723      3290.3881    
       300   311.01228     -31879.356      7204.7941      5078.8251      3290.3881    
       400   325.579       -31890.79       9957.5641      8096.1536      3290.3881    
       500   309.22776     -31883.056     -1778.1744      5294.6233      3290.3881    
       600   319.75022     -31885.202      8148.2557      10136.089      3290.3881    
       700   305.66753     -31885.701      7387.2779      9192.2726      3290.3881    
       800   323.8125      -31889.064      8399.3251      6466.0734      3290.3881    
       900   294.3184      -31874.254     -4722.5835      4829.5456      3290.3881    
      1000   314.59309     -31877.118     -1000.3815      499.14573      3290.3881    
      1100   293.78328     -31891.02      -2331.8335     -3224.4141      3290.3881    
      1200   317.35569     -31911.366      3549.2397     -1253.7721      3290.3881    
      1300   312.83463     -31909.807      10253.266     -2836.8983      3290.3881    
      1400   298.91503     -31915.285      1092.0907      5181.3529      3290.3881    
      1500   314.34169     -31917.619      68.988039     -4844.4303      3290.3881    
      1600   308.25601     -31912.032      429.64329      2589.084       3290.3881    
      1700   303.47874     -31910.734      1967.1788      7760.3317      3290.3881    
      1800   285.09248     -31914.016     -14505.931     -215.11041      3290.3881    
      1900   308.58969     -31929.074     -11996.008      3318.448       3290.3881    
      2000   302.91939     -31914.366      1480.8218      922.88495      3290.3881    
Loop time of 82.1044 on 16 procs for 2000 steps with 271 atoms

Performance: 1.052 ns/day, 22.807 hours/ns, 24.359 timesteps/s, 6.601 katom-step/s
98.7% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.134     | 60.239     | 61.78      |  16.2 | 73.37
Bond    | 0.00064102 | 0.00074919 | 0.00089203 |   0.0 |  0.00
Neigh   | 4.8232     | 4.9276     | 5.0956     |   4.0 |  6.00
Comm    | 5.79       | 7.3466     | 9.3386     |  45.2 |  8.95
Output  | 0.0066356  | 0.01066    | 0.016165   |   3.2 |  0.01
Modify  | 9.0306     | 9.2106     | 9.3714     |   3.1 | 11.22
Other   |            | 0.3691     |            |       |  0.45

Nlocal:         33.875 ave          37 max          29 min
Histogram: 2 0 0 0 0 1 0 2 1 2
Nghost:           2783 ave        2808 max        2754 min
Histogram: 2 0 0 0 0 1 3 0 1 1
Neighs:        19585.6 ave       21255 max       16988 min
Histogram: 2 0 0 0 1 0 0 2 1 2

Total # of neighbors = 156685
Ave neighs/atom = 578.17343
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -32.8927788233703
variable C2neg equal ${d2}
variable C2neg equal -6.37436913521276
variable C3neg equal ${d3}
variable C3neg equal -6.12455233705256
variable C4neg equal ${d4}
variable C4neg equal -3.76031095915148
variable C5neg equal ${d5}
variable C5neg equal -7.28231750869375
variable C6neg equal ${d6}
variable C6neg equal -11.4905621753145

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.6096
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta 0.166096 remap x units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108 | 109.8 | 111.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   282.55737     -31871.267      10323.427      0              3290.3881    
       100   298.35928     -31886.782      6972.1271      11097.14       3290.3881    
       200   298.76174     -31879.309     -1695.9333      3548.392       3290.3881    
       300   296.03017     -31869.236     -3446.0259      5438.3368      3290.3881    
       400   318.46923     -31887.666      9073.018       11080.385      3290.3881    
       500   306.03783     -31887.877      6849.6998      6933.1336      3290.3881    
       600   289.87935     -31904.004      4635.9982      7585.7744      3290.3881    
       700   313.73034     -31894.017      2132.3626      5200.1956      3290.3881    
       800   309.47984     -31886.853     -4261.9384      8813.0183      3290.3881    
       900   269.98776     -31894.002     -1747.7637      5869.2895      3290.3881    
      1000   296.94985     -31905.388     -677.46617      4627.9077      3290.3881    
      1100   293.41313     -31884.61      -3614.5752      4800.8623      3290.3881    
      1200   296.2114      -31873.042     -1198.9501      9965.6047      3290.3881    
      1300   313.91364     -31886.661      10023.983      6386.9976      3290.3881    
      1400   317.034       -31900.997     -7691.8412      8555.0895      3290.3881    
      1500   327.35042     -31895.769     -7954.1368      4629.7275      3290.3881    
      1600   306.61362     -31884.384     -3524.1511      5293.7145      3290.3881    
      1700   301.71171     -31894.963      4337.8161      10177.334      3290.3881    
      1800   296.31405     -31883.338     -9056.4366     -144.44315      3290.3881    
      1900   311.47917     -31880.807      3230.5808      6241.983       3290.3881    
      2000   317.88066     -31887.511     -1522.5386      6385.9995      3290.3881    
Loop time of 81.9134 on 16 procs for 2000 steps with 271 atoms

Performance: 1.055 ns/day, 22.754 hours/ns, 24.416 timesteps/s, 6.617 katom-step/s
98.6% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.485     | 59.715     | 61.104     |   9.1 | 72.90
Bond    | 0.00065115 | 0.00074452 | 0.0008564  |   0.0 |  0.00
Neigh   | 4.7428     | 4.8798     | 5.0006     |   4.4 |  5.96
Comm    | 6.2251     | 7.6448     | 8.8951     |  26.0 |  9.33
Output  | 0.0062542  | 0.008683   | 0.011296   |   2.0 |  0.01
Modify  | 9.0989     | 9.2865     | 9.488      |   4.8 | 11.34
Other   |            | 0.3779     |            |       |  0.46

Nlocal:         33.875 ave          40 max          23 min
Histogram: 1 0 0 0 1 0 2 2 1 1
Nghost:           2772 ave        2815 max        2728 min
Histogram: 1 0 0 3 1 0 1 0 0 2
Neighs:        19607.9 ave       22776 max       13577 min
Histogram: 1 0 0 0 1 0 2 2 1 1

Total # of neighbors = 156863
Ave neighs/atom = 578.83026
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -22.4622293187951
variable C2pos equal ${d2}
variable C2pos equal -7.2180686592025
variable C3pos equal ${d3}
variable C3pos equal -6.86236867231384
variable C4pos equal ${d4}
variable C4pos equal -2.51563900662818
variable C5pos equal ${d5}
variable C5pos equal 18.3507189994859
variable C6pos equal ${d6}
variable C6pos equal 18.3596411104724

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-32.8927788233703+${C1pos})
variable C15 equal 0.5*(-32.8927788233703+-22.4622293187951)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-6.37436913521276+${C2pos})
variable C25 equal 0.5*(-6.37436913521276+-7.2180686592025)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-6.12455233705256+${C3pos})
variable C35 equal 0.5*(-6.12455233705256+-6.86236867231384)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-3.76031095915148+${C4pos})
variable C45 equal 0.5*(-3.76031095915148+-2.51563900662818)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(-7.28231750869375+${C5pos})
variable C55 equal 0.5*(-7.28231750869375+18.3507189994859)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-11.4905621753145+${C6pos})
variable C65 equal 0.5*(-11.4905621753145+18.3596411104724)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.4318

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4318
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta -0.134318 remap x units box

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108 | 109.8 | 111.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   282.55737     -31871.267      10323.427      0              3290.3881    
       100   298.35928     -31886.782      6972.1271      11097.14       3290.3881    
       200   291.56948     -31873.09      -2088.8653      4040.229       3290.3881    
       300   311.25258     -31879.471      7092.2002      5295.8411      3290.3881    
       400   306.75126     -31873.391     -3379.795       8529.9669      3290.3881    
       500   293.06062     -31908.468     -5868.9555      7785.5098      3290.3881    
       600   290.72548     -31906.666      2382.729       9025.7788      3290.3881    
       700   292.80361     -31900.573     -3938.164       6759.3862      3290.3881    
       800   298.08811     -31899.274      5477.0619      5001.4163      3290.3881    
       900   299.96045     -31883.84       11755.173      7035.163       3290.3881    
      1000   296.15583     -31889.061      7146.2477      5748.6562      3290.3881    
      1100   278.44394     -31887.234     -1015.8586      2695.5219      3290.3881    
      1200   297.56833     -31897.632     -8784.4035      2434.7986      3290.3881    
      1300   305.95922     -31891.011      2723.04        3334.6058      3290.3881    
      1400   288.08244     -31877.609     -4270.919       3936.4343      3290.3881    
      1500   307.30671     -31908.975      949.10093      1657.6408      3290.3881    
      1600   314.93327     -31896.417     -4888.1011      11308.069      3290.3881    
      1700   343.85617     -31885.729     -434.80121      9777.3587      3290.3881    
      1800   329.20012     -31896.306      4644.9897     -2255.8684      3290.3881    
      1900   298.10149     -31908.621      11164.683      10024.732      3290.3881    
      2000   320.83825     -31901.478      2451.9602      7795.5413      3290.3881    
Loop time of 80.3475 on 16 procs for 2000 steps with 271 atoms

Performance: 1.075 ns/day, 22.319 hours/ns, 24.892 timesteps/s, 6.746 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.334     | 58.528     | 60.998     |  27.5 | 72.84
Bond    | 0.00063116 | 0.00073253 | 0.00085254 |   0.0 |  0.00
Neigh   | 4.5799     | 4.8148     | 4.9862     |   5.5 |  5.99
Comm    | 5.1577     | 7.6797     | 10.871     |  75.7 |  9.56
Output  | 0.0056393  | 0.010629   | 0.01499    |   3.7 |  0.01
Modify  | 8.834      | 9.0033     | 9.2846     |   4.5 | 11.21
Other   |            | 0.3099     |            |       |  0.39

Nlocal:         33.875 ave          38 max          25 min
Histogram: 1 0 0 0 1 0 2 1 0 3
Nghost:        2768.38 ave        2786 max        2744 min
Histogram: 1 1 0 0 1 1 1 0 1 2
Neighs:        19566.5 ave       21905 max       14650 min
Histogram: 1 0 0 0 1 1 1 1 0 3

Total # of neighbors = 156532
Ave neighs/atom = 577.60886
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 36.7444117617575
variable C2neg equal ${d2}
variable C2neg equal 32.3794230837152
variable C3neg equal ${d3}
variable C3neg equal 38.2948429720946
variable C4neg equal ${d4}
variable C4neg equal 13.1537929373528
variable C5neg equal ${d5}
variable C5neg equal -19.3457197333767
variable C6neg equal ${d6}
variable C6neg equal 0.797667386249601

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4318
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta 0.134318 remap x units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108 | 109.8 | 111.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   282.55737     -31871.267      10323.427      0              3290.3881    
       100   298.35928     -31886.782      6972.1271      11097.14       3290.3881    
       200   291.47823     -31872.753     -1542.8375      4191.794       3290.3881    
       300   311.55884     -31880.511      7870.3351      5053.4901      3290.3881    
       400   325.51637     -31879.738      1148.4154      8907.2526      3290.3881    
       500   314.83939     -31865.107     -7174.4366      6751.5586      3290.3881    
       600   307.1345      -31883.146      1636.4099      6667.395       3290.3881    
       700   279.33545     -31883.122      4503.9581      5177.0798      3290.3881    
       800   286.89418     -31882.699     -4425.5234      2617.2677      3290.3881    
       900   313.94947     -31857.716     -2390.138      -1321.7261      3290.3881    
      1000   311.74526     -31881.823     -4383.9623      8820.1536      3290.3881    
      1100   297.58215     -31882.562      6888.8541      10041.057      3290.3881    
      1200   297.87493     -31885.333      9261.0673      5639.7427      3290.3881    
      1300   295.22175     -31905.891      3370.8662      3099.7941      3290.3881    
      1400   305.33185     -31900.752      2648.9467      3329.3273      3290.3881    
      1500   292.51071     -31897.645      9765.5293      6751.0379      3290.3881    
      1600   296.70257     -31893.925     -8748.2194      2198.7791      3290.3881    
      1700   308.40059     -31881.981      4321.5578      8523.6233      3290.3881    
      1800   289.55756     -31885.095      6550.6298      9731.758       3290.3881    
      1900   316.83767     -31859.966     -6867.9068      1008.0228      3290.3881    
      2000   329.97075     -31861.27      -6450.2841      4200.745       3290.3881    
Loop time of 72.6513 on 16 procs for 2000 steps with 271 atoms

Performance: 1.189 ns/day, 20.181 hours/ns, 27.529 timesteps/s, 7.460 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 38.296     | 50.472     | 58.48      |  90.6 | 69.47
Bond    | 0.00054917 | 0.00063637 | 0.00083361 |   0.0 |  0.00
Neigh   | 3.7092     | 4.5274     | 5.1111     |  24.6 |  6.23
Comm    | 0.97182    | 8.9744     | 21.143     | 215.0 | 12.35
Output  | 0.003384   | 0.0052093  | 0.0066175  |   1.8 |  0.01
Modify  | 8.0455     | 8.6266     | 9.4449     |  17.9 | 11.87
Other   |            | 0.04474    |            |       |  0.06

Nlocal:         33.875 ave          38 max          26 min
Histogram: 1 0 0 0 0 2 2 0 0 3
Nghost:        2759.88 ave        2796 max        2722 min
Histogram: 1 1 0 1 2 0 1 0 0 2
Neighs:        19584.1 ave       21870 max       15258 min
Histogram: 1 0 0 0 1 1 2 0 0 3

Total # of neighbors = 156673
Ave neighs/atom = 578.12915
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -0.320138637508502
variable C2pos equal ${d2}
variable C2pos equal -55.2927149920358
variable C3pos equal ${d3}
variable C3pos equal -13.3642814874148
variable C4pos equal ${d4}
variable C4pos equal -9.83524046542753
variable C5pos equal ${d5}
variable C5pos equal 34.3685436573609
variable C6pos equal ${d6}
variable C6pos equal 30.694109160029

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(36.7444117617575+${C1pos})
variable C16 equal 0.5*(36.7444117617575+-0.320138637508502)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(32.3794230837152+${C2pos})
variable C26 equal 0.5*(32.3794230837152+-55.2927149920358)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(38.2948429720946+${C3pos})
variable C36 equal 0.5*(38.2948429720946+-13.3642814874148)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(13.1537929373528+${C4pos})
variable C46 equal 0.5*(13.1537929373528+-9.83524046542753)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(-19.3457197333767+${C5pos})
variable C56 equal 0.5*(-19.3457197333767+34.3685436573609)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(0.797667386249601+${C6pos})
variable C66 equal 0.5*(0.797667386249601+30.694109160029)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 52.1319099951832
variable C22all equal ${C22}
variable C22all equal 45.3050737687455
variable C33all equal ${C33}
variable C33all equal 15.6308992947918

variable C44all equal ${C44}
variable C44all equal 6.32767785246192
variable C55all equal ${C55}
variable C55all equal 5.53420074539607
variable C66all equal ${C66}
variable C66all equal 15.7458882731393

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(32.5325719936932+${C21})
variable C12all equal 0.5*(32.5325719936932+5.48364931799028)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(6.53159625943353+${C31})
variable C13all equal 0.5*(6.53159625943353+40.1710357789998)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(11.3494832215549+${C32})
variable C23all equal 0.5*(11.3494832215549+34.7806532309264)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(9.11959551356595+${C41})
variable C14all equal 0.5*(9.11959551356595+0.13505840205474)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-27.6775040710827+${C51})
variable C15all equal 0.5*(-27.6775040710827+0.52081185892125)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(18.2121365621245+${C61})
variable C16all equal 0.5*(18.2121365621245+0.31865572267585)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(19.8674450209258+${C42})
variable C24all equal 0.5*(19.8674450209258+11.8190424819383)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-6.79621889720763+${C52})
variable C25all equal 0.5*(-6.79621889720763+8.96383523438111)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-11.4566459541603+${C62})
variable C26all equal 0.5*(-11.4566459541603+-12.7827466835841)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(8.79603831447305+${C43})
variable C34all equal 0.5*(8.79603831447305+14.5225439325047)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-6.4934605046832+${C53})
variable C35all equal 0.5*(-6.4934605046832+3.44484025678965)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(12.4652807423399+${C63})
variable C36all equal 0.5*(12.4652807423399+-14.1623097913825)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-3.13797498288983+${C54})
variable C45all equal 0.5*(-3.13797498288983+1.52582787710015)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(1.65927623596264+${C64})
variable C46all equal 0.5*(1.65927623596264+2.30541311441453)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(7.5114119619921+${C65})
variable C56all equal 0.5*(7.5114119619921+3.43453946757895)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by deform-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:17:34
