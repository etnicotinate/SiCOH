LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 30*${nthermo}       # steps of equilibration run 10
variable nequil equal 30*100       
variable nrun equal 30*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 30*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-EXP-1-vasp
read_data       ${structure}.data
read_data       333-EXP-1-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.008 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.364 | 6.364 | 6.364 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 8.19673e-05 on 8 procs for 1 steps with 271 atoms

48.8% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.466e-06  | 2.3745e-06 | 2.584e-06  |   0.0 |  2.90
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 3.353e-06  | 5.8054e-06 | 6.355e-06  |   0.0 |  7.08
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 7.379e-05  |            |       | 90.02

Nlocal:         33.875 ave          38 max          27 min
Histogram: 1 1 0 0 0 0 2 0 2 2
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-EXP-1-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
run ${nequil}
run 3000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -9.02 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 106.3 | 107.8 | 109.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -30660.091      116480.91      1.5329564      3290.3881    
       100   724.5857      -31287.098     -32422.918      1.5329564      3290.3881    
       200   505.02151     -31415.652     -27117.604      1.5329564      3290.3881    
       300   438.19458     -31593.506     -17165.805      1.5329564      3290.3881    
       400   367.19583     -31692.14       11019.392      1.5329564      3290.3881    
       500   324.65484     -31757.096      2089.725       1.5329564      3290.3881    
       600   279.61417     -31781.755     -8837.9569      1.5329564      3290.3881    
       700   263.72986     -31786.777      1259.9231      1.5329564      3290.3881    
       800   301.27598     -31793.229      1341.7572      1.5329564      3290.3881    
       900   305.73662     -31761.718      11777.686      1.5329564      3290.3881    
      1000   331.88322     -31772.325      5543.6434      1.5329564      3290.3881    
      1100   306.00637     -31771.608      6079.6152      1.5329564      3290.3881    
      1200   294.49846     -31796.841     -20754.429      1.5329564      3290.3881    
      1300   261.97737     -31794.502      5962.6097      1.5329564      3290.3881    
      1400   289.73363     -31819.876      16891.689      1.5329564      3290.3881    
      1500   317.33321     -31838.486     -1571.888       1.5329564      3290.3881    
      1600   292.07077     -31816.394     -4462.9669      1.5329564      3290.3881    
      1700   302.93459     -31822.429     -4905.2811      1.5329564      3290.3881    
      1800   307.24242     -31819.602     -16654.352      1.5329564      3290.3881    
      1900   310.22443     -31824.435      2678.5114      1.5329564      3290.3881    
      2000   320.87721     -31843.283      1702.6243      1.5329564      3290.3881    
      2100   295.6543      -31852.756      1937.7986      1.5329564      3290.3881    
      2200   287.80094     -31873.247     -421.4888       1.5329564      3290.3881    
      2300   287.32273     -31888.327     -2418.4866      1.5329564      3290.3881    
      2400   284.34434     -31873.506      1301.4691      1.5329564      3290.3881    
      2500   298.98336     -31852.564      3135.3548      1.5329564      3290.3881    
      2600   318.16289     -31848.812      33.234838      1.5329564      3290.3881    
      2700   317.66376     -31863.451     -13007.99       1.5329564      3290.3881    
      2800   298.66451     -31882.786     -2428.0328      1.5329564      3290.3881    
      2900   271.38359     -31883.705     -704.01135      1.5329564      3290.3881    
      3000   295.96326     -31890.126     -2950.5707      1.5329564      3290.3881    
Loop time of 116.629 on 8 procs for 3000 steps with 271 atoms

Performance: 1.111 ns/day, 21.598 hours/ns, 25.722 timesteps/s, 6.971 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 84.388     | 91.912     | 96.33      |  40.9 | 78.81
Bond    | 0.0079764  | 0.0087842  | 0.0097001  |   0.6 |  0.01
Neigh   | 6.8291     | 7.4614     | 7.8507     |  10.6 |  6.40
Comm    | 2.5246     | 6.9527     | 14.475     | 148.9 |  5.96
Output  | 0.0017301  | 0.0019237  | 0.0031785  |   1.1 |  0.00
Modify  | 9.843      | 10.227     | 10.861     |   9.1 |  8.77
Other   |            | 0.0649     |            |       |  0.06

Nlocal:         33.875 ave          40 max          20 min
Histogram: 1 0 0 0 0 0 2 2 1 2
Nghost:        2779.62 ave        2815 max        2746 min
Histogram: 1 0 2 1 1 1 0 0 0 2
Neighs:        19567.2 ave       23005 max       11835 min
Histogram: 1 0 0 0 0 0 2 2 1 2

Total # of neighbors = 156538
Ave neighs/atom = 577.631
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333-EXP-1-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 14.7487
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.4318
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 16.6096

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal -1.8606
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal -1.0047
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -6.1972

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 14.7487
variable dlen equal lx-${len0}
variable dlen equal lx-14.7487
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.7487
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.1971999999999995978, deltaxy = 0.061972
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.0046999999999999265, deltaxz = 0.010047
print "yz = $(yz), deltayz = ${deltayz}"
yz = -1.8606000000000000316, deltayz = 0.018606
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.147487 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.147487 xy delta 0.061972 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.147487 xy delta 0.061972 xz delta 0.010047 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.4 | 108.6 | 109.9 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   295.96326     -31890.126     -2950.5855      1.5329564      3290.3881    
       100   301.00561     -31865.943      867.13123      1.5334675      3289.2914    
       200   299.36499     -31841.272      15131.011      1.533979       3288.1946    
       300   346.58383     -31888.075     -5426.4046      1.5344909      3287.0978    
       400   274.71833     -31863.206      7405.7151      1.535003       3286.001     
       500   291.91601     -31900.765      3704.5073      1.5355156      3284.9042    
       600   301.38039     -31916.76       151.48068      1.5360284      3283.8074    
       700   308.04866     -31913.537     -163.65932      1.5365416      3282.7106    
       800   297.36881     -31896.591     -18707.216      1.5370552      3281.6138    
       900   319.60842     -31901.868     -7138.82        1.5375691      3280.517     
      1000   327.6102      -31907.164     -21129.98       1.5380833      3279.4202    
      1100   296.77893     -31895.85       9135.5559      1.5385979      3278.3234    
      1200   292.81631     -31915.773     -3196.4032      1.5391128      3277.2266    
      1300   271.83639     -31913.651      2883.611       1.5396281      3276.1298    
      1400   300.58482     -31931.42      -4282.4912      1.5401437      3275.033     
      1500   313.68995     -31905.607      3896.8183      1.5406597      3273.9362    
      1600   317.67438     -31893.306      13538.985      1.541176       3272.8394    
      1700   305.77187     -31902.322      5976.472       1.5416926      3271.7426    
      1800   316.38652     -31927.845      517.36105      1.5422096      3270.6458    
      1900   277.42169     -31906.424     -7201.463       1.542727       3269.549     
      2000   292.83627     -31915.329      1939.1698      1.5432447      3268.4522    
      2100   293.92326     -31883.961      8035.4057      1.5437627      3267.3554    
      2200   330.21079     -31900.292     -2396.6207      1.5442811      3266.2586    
      2300   330.43132     -31917.51      -4604.4543      1.5447998      3265.1618    
      2400   298.61901     -31908.223     -3664.0251      1.5453189      3264.065     
      2500   303.18951     -31922.784     -7100.4335      1.5458384      3262.9682    
      2600   297.30677     -31920.471     -964.87705      1.5463581      3261.8714    
      2700   267.90121     -31906.45      -6710.407       1.5468783      3260.7747    
      2800   276.38797     -31923.624     -7082.3566      1.5473988      3259.6779    
      2900   302.52515     -31929.226      3061.2091      1.5479196      3258.5811    
      3000   315.16038     -31919.63       3988.2008      1.5484408      3257.4843    
Loop time of 120.342 on 8 procs for 3000 steps with 271 atoms

Performance: 1.077 ns/day, 22.286 hours/ns, 24.929 timesteps/s, 6.756 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 89.18      | 96.401     | 100.65     |  35.4 | 80.11
Bond    | 0.0082349  | 0.0088655  | 0.0098326  |   0.6 |  0.01
Neigh   | 6.8754     | 7.6789     | 8.0814     |  12.5 |  6.38
Comm    | 1.6393     | 5.9115     | 13.143     | 143.3 |  4.91
Output  | 0.008507   | 0.010234   | 0.011607   |   1.1 |  0.01
Modify  | 9.8754     | 10.26      | 11.055     |  10.6 |  8.53
Other   |            | 0.07153    |            |       |  0.06

Nlocal:         33.875 ave          43 max          23 min
Histogram: 1 0 0 1 1 1 2 0 1 1
Nghost:        2798.88 ave        2869 max        2730 min
Histogram: 1 1 0 1 1 1 1 0 1 1
Neighs:        19765.9 ave       24992 max       13672 min
Histogram: 1 0 0 1 1 2 1 1 0 1

Total # of neighbors = 158127
Ave neighs/atom = 583.49446
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.7487
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.147487 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.147487 xy delta -0.061972 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.147487 xy delta -0.061972 xz delta -0.010047 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.4 | 108.7 | 109.9 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   295.96326     -31890.126     -2950.5855      1.5329564      3290.3881    
       100   300.97752     -31866.015      871.69946      1.5324456      3291.4849    
       200   299.18986     -31841.062      15667.588      1.5319351      3292.5817    
       300   343.02037     -31885.194     -7226.6794      1.5314249      3293.6785    
       400   284.68909     -31871.276      3306.7507      1.5309152      3294.7753    
       500   297.96206     -31906.411     -5356.6514      1.5304057      3295.8721    
       600   294.98817     -31911.585     -1408.7669      1.5298966      3296.9689    
       700   312.41555     -31916.001      1842.5413      1.5293878      3298.0657    
       800   303.6455      -31892.738     -4428.1079      1.5288794      3299.1625    
       900   305.66648     -31875.445      361.77787      1.5283713      3300.2593    
      1000   316.1829      -31887.523     -11629.165      1.5278635      3301.3561    
      1100   291.25515     -31892.338     -6470.068       1.5273561      3302.4529    
      1200   287.52963     -31895.195     -5895.4137      1.526849       3303.5497    
      1300   327.03104     -31925.89      -1140.2472      1.5263422      3304.6465    
      1400   297.30285     -31902.237     -6076.0343      1.5258358      3305.7433    
      1500   297.18004     -31901.76      -18997.206      1.5253297      3306.8401    
      1600   290.97505     -31903.065     -8488.9895      1.524824       3307.9369    
      1700   290.97752     -31902.886      2086.6563      1.5243186      3309.0337    
      1800   289.61926     -31899.193     -15169.994      1.5238135      3310.1305    
      1900   301.06482     -31903.949     -5460.1775      1.5233087      3311.2273    
      2000   315.00427     -31902.925      5574.7307      1.5228043      3312.3241    
      2100   297.55076     -31878.912      1203.7146      1.5223003      3313.4209    
      2200   308.18453     -31902.434      4624.1688      1.5217965      3314.5177    
      2300   287.93147     -31911.586     -1243.1729      1.5212931      3315.6145    
      2400   290.2         -31910.386     -13741.048      1.5207901      3316.7113    
      2500   298.91472     -31898.624      9776.1602      1.5202873      3317.808     
      2600   324.40763     -31908.523     -2990.6314      1.5197849      3318.9048    
      2700   308.80396     -31902.527      4786.8507      1.5192828      3320.0016    
      2800   291.54389     -31893.256      855.53142      1.5187811      3321.0984    
      2900   296.29114     -31906.914     -3298.7948      1.5182797      3322.1952    
      3000   288.26695     -31918.482     -12198.366      1.5177786      3323.292     
Loop time of 119 on 8 procs for 3000 steps with 271 atoms

Performance: 1.089 ns/day, 22.037 hours/ns, 25.210 timesteps/s, 6.832 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 68.609     | 93.147     | 99.109     |  98.8 | 78.27
Bond    | 0.0085582  | 0.0090817  | 0.010213   |   0.6 |  0.01
Neigh   | 5.6427     | 7.4018     | 7.8791     |  24.9 |  6.22
Comm    | 1.9859     | 7.9491     | 32.475     | 338.3 |  6.68
Output  | 0.0081115  | 0.0092233  | 0.010385   |   0.8 |  0.01
Modify  | 9.9428     | 10.413     | 12.191     |  21.2 |  8.75
Other   |            | 0.07065    |            |       |  0.06

Nlocal:         33.875 ave          38 max          24 min
Histogram: 1 0 0 0 0 0 1 2 3 1
Nghost:        2754.62 ave        2804 max        2705 min
Histogram: 1 1 0 1 1 2 0 0 0 2
Neighs:        19395.5 ave       21440 max       14026 min
Histogram: 1 0 0 0 0 0 2 1 2 2

Total # of neighbors = 155164
Ave neighs/atom = 572.56089
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.4318
variable dlen equal ly-${len0}
variable dlen equal ly-13.4318
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4318
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.1971999999999995978, deltaxy = 0.061972
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.0046999999999999265, deltaxz = 0.010047
print "yz = $(yz), deltayz = ${deltayz}"
yz = -1.8606000000000000316, deltayz = 0.018606
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.134318 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.134318 yz delta 0.018606 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.4 | 108.6 | 109.9 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   295.96326     -31890.126     -2950.5855      1.5329564      3290.3881    
       100   300.9907      -31865.982      862.12138      1.5334675      3289.2914    
       200   298.67276     -31841.178      16375.969      1.533979       3288.1946    
       300   347.33137     -31888.928     -1582.0555      1.5344909      3287.0978    
       400   282.28925     -31870.062      5010.6814      1.535003       3286.001     
       500   293.15456     -31903.611      2004.707       1.5355156      3284.9042    
       600   283.77274     -31902.59       1722.6869      1.5360284      3283.8074    
       700   304.00303     -31905.246     -8380.7264      1.5365416      3282.7106    
       800   306.44687     -31892.325     -10550.893      1.5370552      3281.6138    
       900   287.02629     -31859.084     -14296.849      1.5375691      3280.517     
      1000   325.48182     -31889.625     -14339.384      1.5380833      3279.4202    
      1100   302.72544     -31895.421     -2799.1221      1.5385979      3278.3234    
      1200   268.27434     -31884.965     -2089.4594      1.5391128      3277.2266    
      1300   309.2888      -31915.29      -4477.1898      1.5396281      3276.1298    
      1400   287.09167     -31895.219     -20649.894      1.5401437      3275.033     
      1500   309.15526     -31918.561      2254.9587      1.5406597      3273.9362    
      1600   279.60041     -31926.215     -7373.6004      1.541176       3272.8394    
      1700   286.7365      -31933.967      877.08459      1.5416926      3271.7426    
      1800   311.09172     -31931.099     -6160.7265      1.5422096      3270.6458    
      1900   306.14697     -31915.602      5062.6502      1.542727       3269.549     
      2000   289.29364     -31893.501      8255.4096      1.5432447      3268.4522    
      2100   288.87557     -31873.843     -4364.8141      1.5437627      3267.3554    
      2200   322.59782     -31898.923     -10565.618      1.5442811      3266.2586    
      2300   284.06226     -31898.83       9087.5973      1.5447998      3265.1618    
      2400   311.67036     -31917.318     -1087.7318      1.5453189      3264.065     
      2500   293.05592     -31894.911     -11269.115      1.5458384      3262.9682    
      2600   306.28737     -31902.725     -6127.3723      1.5463581      3261.8714    
      2700   292.80112     -31898.948     -11946.334      1.5468783      3260.7747    
      2800   279.30061     -31912.38       18057.524      1.5473988      3259.6779    
      2900   310.27137     -31934.878      1075.9572      1.5479196      3258.5811    
      3000   284.50715     -31890.935     -3749.8236      1.5484408      3257.4843    
Loop time of 119.979 on 8 procs for 3000 steps with 271 atoms

Performance: 1.080 ns/day, 22.218 hours/ns, 25.004 timesteps/s, 6.776 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 66.714     | 90.508     | 100.28     | 141.4 | 75.44
Bond    | 0.0081792  | 0.0089768  | 0.010264   |   0.6 |  0.01
Neigh   | 5.399      | 7.1709     | 7.9531     |  36.9 |  5.98
Comm    | 1.6834     | 11.451     | 35.24      | 397.4 |  9.54
Output  | 0.0082745  | 0.009442   | 0.010584   |   0.8 |  0.01
Modify  | 9.9871     | 10.763     | 12.547     |  30.3 |  8.97
Other   |            | 0.06788    |            |       |  0.06

Nlocal:         33.875 ave          40 max          23 min
Histogram: 1 0 0 0 1 1 0 2 2 1
Nghost:        2801.38 ave        2853 max        2743 min
Histogram: 1 0 1 1 0 1 2 0 0 2
Neighs:        19760.2 ave       23311 max       13733 min
Histogram: 1 0 0 0 1 1 1 2 1 1

Total # of neighbors = 158082
Ave neighs/atom = 583.32841
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4318
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.134318 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.134318 yz delta -0.018606 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.4 | 108.7 | 109.9 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   295.96326     -31890.126     -2950.5855      1.5329564      3290.3881    
       100   300.99114     -31865.976      876.42795      1.5324456      3291.4849    
       200   300.48416     -31842.012      15157.518      1.5319351      3292.5817    
       300   346.52521     -31888.077     -7049.3696      1.5314249      3293.6785    
       400   284.18764     -31871.303      7499.5216      1.5309152      3294.7753    
       500   301.88202     -31910.324     -11145.139      1.5304057      3295.8721    
       600   293.86589     -31911.103      997.11623      1.5298966      3296.9689    
       700   314.51476     -31914.105      3116.1924      1.5293878      3298.0657    
       800   300.16607     -31888.257     -7972.5518      1.5288794      3299.1625    
       900   314.71911     -31889.133      3918.5449      1.5283713      3300.2593    
      1000   311.88107     -31889.632     -17566.585      1.5278635      3301.3561    
      1100   288.20571     -31889.447     -1033.1887      1.5273561      3302.4529    
      1200   276.32889     -31895.902      1212.8744      1.526849       3303.5497    
      1300   308.17516     -31918.221      10833.703      1.5263422      3304.6465    
      1400   307.49459     -31885.688     -4886.255       1.5258358      3305.7433    
      1500   309.62771     -31888.431     -6638.488       1.5253297      3306.8401    
      1600   299.09107     -31896.888     -18750.968      1.524824       3307.9369    
      1700   284.53116     -31899.131     -3096.2615      1.5243186      3309.0337    
      1800   311.28124     -31926.238     -971.98258      1.5238135      3310.1305    
      1900   303.6306      -31916.428      2367.9757      1.5233087      3311.2273    
      2000   286.45097     -31893.768     -18708.416      1.5228043      3312.3241    
      2100   307.02567     -31889.699     -6138.1306      1.5223003      3313.4209    
      2200   312.3006      -31891.563     -2084.824       1.5217965      3314.5177    
      2300   307.99628     -31906.164      3440.6716      1.5212931      3315.6145    
      2400   279.78        -31902.866     -3372.1488      1.5207901      3316.7113    
      2500   273.0706      -31898.644     -4159.1548      1.5202873      3317.808     
      2600   308.51545     -31896.944      1438.1536      1.5197849      3318.9048    
      2700   325.30428     -31892.901     -1127.2494      1.5192828      3320.0016    
      2800   294.87149     -31890.481     -4484.6962      1.5187811      3321.0984    
      2900   293.33383     -31902.96      -3291.8055      1.5182797      3322.1952    
      3000   298.98981     -31914.723     -7021.0691      1.5177786      3323.292     
Loop time of 118.006 on 8 procs for 3000 steps with 271 atoms

Performance: 1.098 ns/day, 21.853 hours/ns, 25.422 timesteps/s, 6.889 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 65.632     | 87.735     | 98.496     | 138.1 | 74.35
Bond    | 0.0082402  | 0.0088492  | 0.0098008  |   0.5 |  0.01
Neigh   | 5.326      | 7.0159     | 7.9898     |  37.0 |  5.95
Comm    | 1.5922     | 12.366     | 34.463     | 367.8 | 10.48
Output  | 0.0089676  | 0.010019   | 0.011226   |   0.8 |  0.01
Modify  | 9.8338     | 10.801     | 12.502     |  30.0 |  9.15
Other   |            | 0.06906    |            |       |  0.06

Nlocal:         33.875 ave          41 max          21 min
Histogram: 1 0 0 0 0 1 2 2 1 1
Nghost:        2755.75 ave        2810 max        2693 min
Histogram: 1 0 1 1 1 0 2 0 0 2
Neighs:        19370.4 ave       23472 max       12320 min
Histogram: 1 0 0 0 0 2 1 2 1 1

Total # of neighbors = 154963
Ave neighs/atom = 571.81919
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 16.6096
variable dlen equal lz-${len0}
variable dlen equal lz-16.6096
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.6096
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.1971999999999995978, deltaxy = 0.061972
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.0046999999999999265, deltaxz = 0.010047
print "yz = $(yz), deltayz = ${deltayz}"
yz = -1.8606000000000000316, deltayz = 0.018606
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -0.166096 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.4 | 108.6 | 109.9 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   295.96326     -31890.126     -2950.5855      1.5329564      3290.3881    
       100   301.03746     -31865.963      862.2194       1.5334675      3289.2914    
       200   296.98385     -31839.336      12453.15       1.533979       3288.1946    
       300   353.14178     -31893.128     -2883.1956      1.5344909      3287.0978    
       400   283.64347     -31870.705      13736.348      1.535003       3286.001     
       500   300.16102     -31908          3348.2881      1.5355156      3284.9042    
       600   300.7509      -31915.75       464.36388      1.5360284      3283.8074    
       700   297.5715      -31904.987     -3611.9467      1.5365416      3282.7106    
       800   299.41603     -31893.858     -12179.592      1.5370552      3281.6138    
       900   308.96574     -31882.772     -7065.8495      1.5375691      3280.517     
      1000   303.02892     -31880.808     -7728.7891      1.5380833      3279.4202    
      1100   309.84279     -31908.241      1322.5954      1.5385979      3278.3234    
      1200   296.39104     -31908.488     -3134.5215      1.5391128      3277.2266    
      1300   305.54108     -31916.013     -1284.2546      1.5396281      3276.1298    
      1400   296.10808     -31924.846     -4282.5073      1.5401437      3275.033     
      1500   294.10442     -31945.124      6082.0062      1.5406597      3273.9362    
      1600   281.769       -31917.862      3537.1543      1.541176       3272.8394    
      1700   295.59199     -31902.558      6615.9776      1.5416926      3271.7426    
      1800   308.33964     -31898.569      8271.0532      1.5422096      3270.6458    
      1900   307.87229     -31905.945     -543.30335      1.542727       3269.549     
      2000   296.43051     -31913.219     -4521.2716      1.5432447      3268.4522    
      2100   282.26087     -31913.351      678.34366      1.5437627      3267.3554    
      2200   283.21164     -31937.109     -6216.2055      1.5442811      3266.2586    
      2300   258.10392     -31912.878     -3277.1771      1.5447998      3265.1618    
      2400   289.85125     -31908.502     -15400.402      1.5453189      3264.065     
      2500   307.157       -31909.018     -3959.9456      1.5458384      3262.9682    
      2600   311.55692     -31902.499     -707.32038      1.5463581      3261.8714    
      2700   295.88783     -31906.842     -3703.9193      1.5468783      3260.7747    
      2800   287.50527     -31921.2       -10191.037      1.5473988      3259.6779    
      2900   300.57107     -31930.548     -4682.5068      1.5479196      3258.5811    
      3000   317.27816     -31907.235      11199.174      1.5484408      3257.4843    
Loop time of 119.331 on 8 procs for 3000 steps with 271 atoms

Performance: 1.086 ns/day, 22.098 hours/ns, 25.140 timesteps/s, 6.813 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 66.372     | 86.084     | 99.673     | 158.2 | 72.14
Bond    | 0.0082748  | 0.0087759  | 0.0096879  |   0.5 |  0.01
Neigh   | 5.3802     | 6.8732     | 7.9711     |  41.5 |  5.76
Comm    | 1.685      | 15.302     | 35.008     | 375.1 | 12.82
Output  | 0.0092539  | 0.010861   | 0.012482   |   1.0 |  0.01
Modify  | 9.9085     | 10.987     | 12.49      |  33.0 |  9.21
Other   |            | 0.06566    |            |       |  0.06

Nlocal:         33.875 ave          42 max          20 min
Histogram: 1 0 0 0 1 1 2 0 2 1
Nghost:        2780.12 ave        2858 max        2710 min
Histogram: 2 0 0 0 3 1 0 0 1 1
Neighs:        19752.1 ave       24489 max       11982 min
Histogram: 1 0 0 0 1 1 2 1 1 1

Total # of neighbors = 158017
Ave neighs/atom = 583.08856
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.6096
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 0.166096 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.4 | 108.6 | 109.9 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   295.96326     -31890.126     -2950.5855      1.5329564      3290.3881    
       100   300.94663     -31865.995      877.25988      1.5324456      3291.4849    
       200   300.14848     -31842.003      15278.859      1.5319351      3292.5817    
       300   347.02529     -31889.345     -6429.1881      1.5314249      3293.6785    
       400   286.71961     -31873.699      8003.7755      1.5309152      3294.7753    
       500   298.29973     -31906.1       -7716.9972      1.5304057      3295.8721    
       600   298.2966      -31912.001     -7160.5369      1.5298966      3296.9689    
       700   310.71359     -31911.44      -2799.015       1.5293878      3298.0657    
       800   297.29133     -31890.436     -12097.674      1.5288794      3299.1625    
       900   305.58554     -31879.878     -7437.8605      1.5283713      3300.2593    
      1000   301.89526     -31875.055     -5455.7031      1.5278635      3301.3561    
      1100   293.3647      -31889.978     -167.86782      1.5273561      3302.4529    
      1200   273.78542     -31891.052     -6058.0288      1.526849       3303.5497    
      1300   295.64057     -31909.53       20063.071      1.5263422      3304.6465    
      1400   299.14901     -31906.352     -1811.8191      1.5258358      3305.7433    
      1500   288.80752     -31895.786     -9603.7839      1.5253297      3306.8401    
      1600   287.01396     -31893.185      6882.0468      1.524824       3307.9369    
      1700   326.72492     -31924.621      51.126336      1.5243186      3309.0337    
      1800   305.65415     -31904.977      2241.2333      1.5238135      3310.1305    
      1900   312.30117     -31898.75      -6708.7512      1.5233087      3311.2273    
      2000   324.37106     -31881.584     -3070.4437      1.5228043      3312.3241    
      2100   339.11325     -31892.862      2475.1815      1.5223003      3313.4209    
      2200   309.75949     -31897.649     -1991.9882      1.5217965      3314.5177    
      2300   302.03831     -31900.13       5728.7772      1.5212931      3315.6145    
      2400   291.20979     -31903.206     -7599.5777      1.5207901      3316.7113    
      2500   305.84325     -31923.404     -7857.8681      1.5202873      3317.808     
      2600   279.66009     -31896.062     -17227.651      1.5197849      3318.9048    
      2700   311.97486     -31897.477      10856.47       1.5192828      3320.0016    
      2800   309.04434     -31883.787     -19555.309      1.5187811      3321.0984    
      2900   301.79704     -31894.867     -10518.914      1.5182797      3322.1952    
      3000   316.02945     -31927.862      513.42385      1.5177786      3323.292     
Loop time of 118.468 on 8 procs for 3000 steps with 271 atoms

Performance: 1.094 ns/day, 21.938 hours/ns, 25.323 timesteps/s, 6.863 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 65.685     | 83.859     | 98.991     | 153.6 | 70.79
Bond    | 0.0083018  | 0.008653   | 0.0091336  |   0.3 |  0.01
Neigh   | 5.3203     | 6.7102     | 7.9507     |  41.3 |  5.66
Comm    | 1.655      | 16.812     | 34.977     | 343.1 | 14.19
Output  | 0.009504   | 0.010888   | 0.012234   |   0.9 |  0.01
Modify  | 9.7785     | 11.002     | 12.408     |  32.5 |  9.29
Other   |            | 0.06457    |            |       |  0.05

Nlocal:         33.875 ave          40 max          24 min
Histogram: 1 0 0 0 0 2 3 0 1 1
Nghost:        2742.75 ave        2804 max        2679 min
Histogram: 1 1 0 0 2 2 0 0 0 2
Neighs:        19385.2 ave       22915 max       14019 min
Histogram: 1 0 0 0 1 1 3 0 1 1

Total # of neighbors = 155082
Ave neighs/atom = 572.2583
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 14.7487
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz--1.8606)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.7487
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.1971999999999995978, deltaxy = 0.061972
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.0046999999999999265, deltaxz = 0.010047
print "yz = $(yz), deltayz = ${deltayz}"
yz = -1.8606000000000000316, deltayz = 0.018606
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -0.147487 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.4 | 108.6 | 109.9 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   295.96326     -31890.126     -2950.5855      1.5329564      3290.3881    
       100   300.99458     -31865.977      879.75292      1.5329564      3290.3881    
       200   298.78969     -31840.806      16054.076      1.5329564      3290.3881    
       300   347.72372     -31889.21      -6413.4065      1.5329564      3290.3881    
       400   279.6817      -31867.565      10983.672      1.5329564      3290.3881    
       500   293.70855     -31902.009      2821.043       1.5329564      3290.3881    
       600   293.0627      -31909.032     -3247.7255      1.5329564      3290.3881    
       700   310.80957     -31916.264      631.79811      1.5329564      3290.3881    
       800   292.45838     -31890.35      -5189.1745      1.5329564      3290.3881    
       900   310.75727     -31888.207      1370.3277      1.5329564      3290.3881    
      1000   319.04425     -31887.491     -1510.5969      1.5329564      3290.3881    
      1100   300.25433     -31889.106     -2006.2038      1.5329564      3290.3881    
      1200   273.04634     -31894.176      767.60933      1.5329564      3290.3881    
      1300   278.1533      -31897.659     -6668.0744      1.5329564      3290.3881    
      1400   308.10503     -31908.452     -6372.6662      1.5329564      3290.3881    
      1500   300.9095      -31899.522     -776.41373      1.5329564      3290.3881    
      1600   294.32009     -31887.845     -2890.1949      1.5329564      3290.3881    
      1700   316.12832     -31903.739      5373.0562      1.5329564      3290.3881    
      1800   298.92237     -31896.754     -9844.0484      1.5329564      3290.3881    
      1900   303.16141     -31906.94      -2504.8931      1.5329564      3290.3881    
      2000   300.75155     -31914.217     -5722.6323      1.5329564      3290.3881    
      2100   258.18132     -31904.444     -12786.479      1.5329564      3290.3881    
      2200   265.09135     -31925.113     -3199.675       1.5329564      3290.3881    
      2300   292.85675     -31922.676     -3507.0228      1.5329564      3290.3881    
      2400   296.77211     -31911.401     -14701.686      1.5329564      3290.3881    
      2500   288.39443     -31896.197     -9375.3569      1.5329564      3290.3881    
      2600   314.00094     -31900.84      -788.0056       1.5329564      3290.3881    
      2700   333.66909     -31912.307     -11593.97       1.5329564      3290.3881    
      2800   284.41553     -31910.924     -14876.931      1.5329564      3290.3881    
      2900   272.79188     -31911.201      57.600418      1.5329564      3290.3881    
      3000   292.35475     -31919.81      -129.24227      1.5329564      3290.3881    
Loop time of 119.938 on 8 procs for 3000 steps with 271 atoms

Performance: 1.081 ns/day, 22.211 hours/ns, 25.013 timesteps/s, 6.779 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 65.867     | 91.063     | 99.935     | 111.2 | 75.93
Bond    | 0.008313   | 0.0088965  | 0.0097964  |   0.4 |  0.01
Neigh   | 5.4463     | 7.2778     | 8.0398     |  28.3 |  6.07
Comm    | 1.9789     | 10.87      | 36.063     | 321.9 |  9.06
Output  | 0.0085273  | 0.0096473  | 0.010841   |   0.9 |  0.01
Modify  | 9.8902     | 10.641     | 12.483     |  23.5 |  8.87
Other   |            | 0.06811    |            |       |  0.06

Nlocal:         33.875 ave          38 max          21 min
Histogram: 1 0 0 0 0 0 1 2 0 4
Nghost:        2801.25 ave        2863 max        2740 min
Histogram: 1 1 1 1 0 0 2 0 0 2
Neighs:        19566.5 ave       22008 max       12473 min
Histogram: 1 0 0 0 0 0 1 2 0 4

Total # of neighbors = 156532
Ave neighs/atom = 577.60886
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.7487
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 0.147487 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.4 | 108.7 | 109.9 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   295.96326     -31890.126     -2950.5855      1.5329564      3290.3881    
       100   300.98951     -31865.981      861.36776      1.5329564      3290.3881    
       200   296.9983      -31839.328      12278.291      1.5329564      3290.3881    
       300   345.86491     -31887.619     -6190.6532      1.5329564      3290.3881    
       400   283.13937     -31871.027      4711.2819      1.5329564      3290.3881    
       500   297.89061     -31905.232     -2487.8777      1.5329564      3290.3881    
       600   300.36785     -31913.699     -469.30574      1.5329564      3290.3881    
       700   309.1656      -31910.269     -10056.56       1.5329564      3290.3881    
       800   301.13249     -31892.835     -13213.586      1.5329564      3290.3881    
       900   292.34469     -31868.941     -11210.068      1.5329564      3290.3881    
      1000   304.03254     -31873.222     -3164.9556      1.5329564      3290.3881    
      1100   309.5206      -31893.076      3940.3347      1.5329564      3290.3881    
      1200   274.18204     -31891.848     -13563.795      1.5329564      3290.3881    
      1300   305.23739     -31919.039     -6795.563       1.5329564      3290.3881    
      1400   310.85164     -31919.046     -2357.1751      1.5329564      3290.3881    
      1500   307.11775     -31911.793      15622.197      1.5329564      3290.3881    
      1600   307.90588     -31885.151      4269.0798      1.5329564      3290.3881    
      1700   327.58243     -31897.066      7920.2369      1.5329564      3290.3881    
      1800   296.53295     -31899.921     -7042.438       1.5329564      3290.3881    
      1900   312.30129     -31922.57      -15958.768      1.5329564      3290.3881    
      2000   299.43641     -31919.082     -12028.615      1.5329564      3290.3881    
      2100   285.68898     -31908.922     -2533.6861      1.5329564      3290.3881    
      2200   287.27661     -31886.41      -2497.4376      1.5329564      3290.3881    
      2300   312.01401     -31883.006      10399.701      1.5329564      3290.3881    
      2400   317.31276     -31894.436     -14433.442      1.5329564      3290.3881    
      2500   327.83356     -31926.092     -8772.4228      1.5329564      3290.3881    
      2600   291.03442     -31908.328     -15048.448      1.5329564      3290.3881    
      2700   295.29525     -31909.673     -3369.6892      1.5329564      3290.3881    
      2800   306.22076     -31902.356     -10411.613      1.5329564      3290.3881    
      2900   325.08922     -31904.247     -5184.6674      1.5329564      3290.3881    
      3000   303.82076     -31914.443     -9594.2932      1.5329564      3290.3881    
Loop time of 120.096 on 8 procs for 3000 steps with 271 atoms

Performance: 1.079 ns/day, 22.240 hours/ns, 24.980 timesteps/s, 6.770 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 66.232     | 93.53      | 99.742     | 109.3 | 77.88
Bond    | 0.0083067  | 0.008867   | 0.0096117  |   0.4 |  0.01
Neigh   | 5.4474     | 7.4068     | 7.9502     |  27.9 |  6.17
Comm    | 2.2905     | 8.4889     | 35.773     | 362.5 |  7.07
Output  | 0.0081052  | 0.0092152  | 0.010394   |   0.8 |  0.01
Modify  | 10.057     | 10.581     | 12.562     |  23.6 |  8.81
Other   |            | 0.07162    |            |       |  0.06

Nlocal:         33.875 ave          42 max          20 min
Histogram: 1 0 0 0 0 1 2 3 0 1
Nghost:        2767.62 ave        2821 max        2726 min
Histogram: 1 1 2 1 0 0 1 0 1 1
Neighs:        19540.6 ave       24131 max       11848 min
Histogram: 1 0 0 0 0 1 2 3 0 1

Total # of neighbors = 156325
Ave neighs/atom = 576.84502
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.4318
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz--1.0047)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4318
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.1971999999999995978, deltaxy = 0.061972
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.0046999999999999265, deltaxz = 0.010047
print "yz = $(yz), deltayz = ${deltayz}"
yz = -1.8606000000000000316, deltayz = 0.018606
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -0.134318 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.4 | 108.6 | 109.9 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   295.96326     -31890.126     -2950.5855      1.5329564      3290.3881    
       100   300.99125     -31865.984      868.04189      1.5329564      3290.3881    
       200   298.83803     -31840.75       15854.006      1.5329564      3290.3881    
       300   343.6589      -31885.92      -5823.6014      1.5329564      3290.3881    
       400   283.33025     -31870.065      4684.7479      1.5329564      3290.3881    
       500   297.19729     -31905.097     -4022.3318      1.5329564      3290.3881    
       600   290.78282     -31908.933     -9006.0163      1.5329564      3290.3881    
       700   304.72988     -31909.579     -731.0074       1.5329564      3290.3881    
       800   316.31644     -31904.794     -16709.961      1.5329564      3290.3881    
       900   302.23622     -31878.767     -8994.3         1.5329564      3290.3881    
      1000   311.97428     -31890.394     -19136.478      1.5329564      3290.3881    
      1100   306.29309     -31907.868     -9432.4561      1.5329564      3290.3881    
      1200   284.62949     -31902.556     -4376.3398      1.5329564      3290.3881    
      1300   293.22211     -31904.219      1256.2164      1.5329564      3290.3881    
      1400   321.99447     -31889.31       1634.1385      1.5329564      3290.3881    
      1500   310.74666     -31887.161      3771.3183      1.5329564      3290.3881    
      1600   318.54597     -31913.846      11556.476      1.5329564      3290.3881    
      1700   289.5331      -31907.597     -12300.448      1.5329564      3290.3881    
      1800   304.59514     -31921.125      4029.996       1.5329564      3290.3881    
      1900   288.99123     -31907.388      7808.8276      1.5329564      3290.3881    
      2000   319.36445     -31904.254      4053.2048      1.5329564      3290.3881    
      2100   306.84297     -31876.869      3723.4472      1.5329564      3290.3881    
      2200   298.49411     -31878.714      2236.4495      1.5329564      3290.3881    
      2300   284.64738     -31890.18       8418.0724      1.5329564      3290.3881    
      2400   291.14913     -31911.537     -8735.4212      1.5329564      3290.3881    
      2500   276.62901     -31906.955      6963.3444      1.5329564      3290.3881    
      2600   305.35964     -31924.284      9063.6551      1.5329564      3290.3881    
      2700   293.89993     -31904.311     -130.3896       1.5329564      3290.3881    
      2800   313.17785     -31912.546      2933.5189      1.5329564      3290.3881    
      2900   296.49006     -31912.362      2803.0595      1.5329564      3290.3881    
      3000   284.27487     -31929.745      3660.6903      1.5329564      3290.3881    
Loop time of 119.423 on 8 procs for 3000 steps with 271 atoms

Performance: 1.085 ns/day, 22.115 hours/ns, 25.121 timesteps/s, 6.808 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 65.52      | 91.838     | 99.845     | 109.7 | 76.90
Bond    | 0.0080535  | 0.0088973  | 0.0098222  |   0.5 |  0.01
Neigh   | 5.443      | 7.3163     | 7.9292     |  27.5 |  6.13
Comm    | 1.6666     | 9.6727     | 35.984     | 337.9 |  8.10
Output  | 0.0082693  | 0.0098597  | 0.011347   |   1.0 |  0.01
Modify  | 9.9084     | 10.508     | 12.396     |  23.0 |  8.80
Other   |            | 0.06846    |            |       |  0.06

Nlocal:         33.875 ave          41 max          21 min
Histogram: 1 0 0 0 0 2 1 1 1 2
Nghost:        2798.75 ave        2872 max        2729 min
Histogram: 1 1 0 2 0 2 0 0 0 2
Neighs:        19594.9 ave       23320 max       12458 min
Histogram: 1 0 0 0 0 2 1 1 1 2

Total # of neighbors = 156759
Ave neighs/atom = 578.44649
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4318
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 0.134318 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.4 | 108.7 | 109.9 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   295.96326     -31890.126     -2950.5855      1.5329564      3290.3881    
       100   300.99149     -31865.973      871.71891      1.5329564      3290.3881    
       200   299.85356     -31841.401      15702.309      1.5329564      3290.3881    
       300   342.2897      -31884.793     -6459.0163      1.5329564      3290.3881    
       400   281.73335     -31870.027      8787.3415      1.5329564      3290.3881    
       500   295.28895     -31904.511     -23.454747      1.5329564      3290.3881    
       600   283.58072     -31902.086     -1482.8854      1.5329564      3290.3881    
       700   311.96123     -31909.838     -973.62824      1.5329564      3290.3881    
       800   315.92092     -31897.884     -6794.0945      1.5329564      3290.3881    
       900   312.04684     -31884.07      -17357.76       1.5329564      3290.3881    
      1000   310.74882     -31883.474     -10082.495      1.5329564      3290.3881    
      1100   292.90812     -31887.363     -7280.9764      1.5329564      3290.3881    
      1200   271.69708     -31889.801     -9353.6189      1.5329564      3290.3881    
      1300   292.60943     -31905.44      -756.78922      1.5329564      3290.3881    
      1400   313.36652     -31894.175      3761.6564      1.5329564      3290.3881    
      1500   323.35791     -31881.716     -10638.944      1.5329564      3290.3881    
      1600   315.12559     -31885.669      19014.486      1.5329564      3290.3881    
      1700   296.04984     -31894.872      3562.7523      1.5329564      3290.3881    
      1800   312.85445     -31916.069      1035.3586      1.5329564      3290.3881    
      1900   303.94842     -31915.703      3766.2636      1.5329564      3290.3881    
      2000   289.01516     -31909.488     -2541.8153      1.5329564      3290.3881    
      2100   303.80964     -31904.23      -2851.5418      1.5329564      3290.3881    
      2200   317.11154     -31888.016      411.76412      1.5329564      3290.3881    
      2300   310.27774     -31882.762      13609.994      1.5329564      3290.3881    
      2400   301.71792     -31898.058     -10935.728      1.5329564      3290.3881    
      2500   292.66029     -31906.417     -2702.6571      1.5329564      3290.3881    
      2600   289.7127      -31899.517      7462.7246      1.5329564      3290.3881    
      2700   306.06646     -31898.095      2991.7635      1.5329564      3290.3881    
      2800   323.35793     -31904.957      8083.6633      1.5329564      3290.3881    
      2900   300.85154     -31892.849     -6039.8882      1.5329564      3290.3881    
      3000   297.43351     -31922.723     -559.35888      1.5329564      3290.3881    
Loop time of 119.377 on 8 procs for 3000 steps with 271 atoms

Performance: 1.086 ns/day, 22.107 hours/ns, 25.130 timesteps/s, 6.810 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 65.617     | 93.176     | 99.406     | 110.4 | 78.05
Bond    | 0.0081901  | 0.0090017  | 0.01008    |   0.6 |  0.01
Neigh   | 5.4498     | 7.3814     | 7.9339     |  27.5 |  6.18
Comm    | 2.0727     | 8.3268     | 35.87      | 369.1 |  6.98
Output  | 0.0081943  | 0.0093386  | 0.010575   |   0.9 |  0.01
Modify  | 9.869      | 10.403     | 12.358     |  23.4 |  8.71
Other   |            | 0.072      |            |       |  0.06

Nlocal:         33.875 ave          39 max          22 min
Histogram: 1 0 0 0 0 1 1 0 4 1
Nghost:           2789 ave        2825 max        2747 min
Histogram: 1 0 1 0 2 1 1 0 0 2
Neighs:        19551.9 ave       22499 max       13031 min
Histogram: 1 0 0 0 0 1 1 1 3 1

Total # of neighbors = 156415
Ave neighs/atom = 577.17712
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 16.6096
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--6.1972)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.6096
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.1971999999999995978, deltaxy = 0.061972
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.0046999999999999265, deltaxz = 0.010047
print "yz = $(yz), deltayz = ${deltayz}"
yz = -1.8606000000000000316, deltayz = 0.018606
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -0.166096 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.4 | 108.6 | 109.9 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   295.96326     -31890.126     -2950.5855      1.5329564      3290.3881    
       100   300.97968     -31865.983      868.01878      1.5329564      3290.3881    
       200   299.54814     -31841.763      15594.829      1.5329564      3290.3881    
       300   347.04987     -31888.361     -5364.7399      1.5329564      3290.3881    
       400   281.88815     -31869.564      1436.8114      1.5329564      3290.3881    
       500   293.77723     -31904.203     -388.86057      1.5329564      3290.3881    
       600   293.32916     -31910.559      316.44875      1.5329564      3290.3881    
       700   313.48201     -31914.369     -5344.1298      1.5329564      3290.3881    
       800   299.76622     -31889.316     -10138.031      1.5329564      3290.3881    
       900   311.84674     -31884.997     -14814.759      1.5329564      3290.3881    
      1000   315.95973     -31897.156     -3441.1531      1.5329564      3290.3881    
      1100   298.39146     -31907.874      641.76667      1.5329564      3290.3881    
      1200   309.26639     -31924.602     -5.9298101      1.5329564      3290.3881    
      1300   309.059       -31921.741      6125.5876      1.5329564      3290.3881    
      1400   301.88538     -31908.526     -7989.0255      1.5329564      3290.3881    
      1500   309.60922     -31915.06      -10895.135      1.5329564      3290.3881    
      1600   324.72093     -31924.318      364.58752      1.5329564      3290.3881    
      1700   294.58661     -31898.224      3821.3899      1.5329564      3290.3881    
      1800   301.89583     -31910.068      12929.844      1.5329564      3290.3881    
      1900   286.86181     -31923.347     -5789.8497      1.5329564      3290.3881    
      2000   298.20987     -31934.246     -1598.8995      1.5329564      3290.3881    
      2100   311.56288     -31915.659      2301.251       1.5329564      3290.3881    
      2200   301.73742     -31895.796      1600.9127      1.5329564      3290.3881    
      2300   317.44358     -31907.692     -13312.652      1.5329564      3290.3881    
      2400   307.04073     -31909.125     -10588.413      1.5329564      3290.3881    
      2500   295.3183      -31923.907     -7772.9991      1.5329564      3290.3881    
      2600   295.20765     -31928         -1109.6286      1.5329564      3290.3881    
      2700   299.96178     -31917.081      1954.1826      1.5329564      3290.3881    
      2800   300.59358     -31882.424      3098.5873      1.5329564      3290.3881    
      2900   337.9283      -31915.395     -7528.2383      1.5329564      3290.3881    
      3000   324.26429     -31926.472      8368.0313      1.5329564      3290.3881    
Loop time of 116.391 on 8 procs for 3000 steps with 271 atoms

Performance: 1.113 ns/day, 21.554 hours/ns, 25.775 timesteps/s, 6.985 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.832     | 86.554     | 96.694     | 112.0 | 74.36
Bond    | 0.0078881  | 0.0086213  | 0.0094364  |   0.5 |  0.01
Neigh   | 5.4686     | 7.1135     | 7.985      |  30.1 |  6.11
Comm    | 2.0028     | 12.161     | 34.875     | 298.7 | 10.45
Output  | 0.0076821  | 0.0087746  | 0.009855   |   0.8 |  0.01
Modify  | 9.6205     | 10.479     | 12.14      |  24.9 |  9.00
Other   |            | 0.06646    |            |       |  0.06

Nlocal:         33.875 ave          42 max          21 min
Histogram: 1 0 0 0 0 3 1 1 1 1
Nghost:        2796.12 ave        2885 max        2723 min
Histogram: 2 0 0 2 1 1 0 0 1 1
Neighs:        19555.8 ave       24211 max       12464 min
Histogram: 1 0 0 0 0 3 2 0 1 1

Total # of neighbors = 156446
Ave neighs/atom = 577.29151
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.6096
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 0.166096 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.4 | 108.7 | 109.9 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   295.96326     -31890.126     -2950.5855      1.5329564      3290.3881    
       100   301.00224     -31865.975      870.55718      1.5329564      3290.3881    
       200   299.71153     -31841.526      15556.485      1.5329564      3290.3881    
       300   343.27969     -31885.724     -6351.5575      1.5329564      3290.3881    
       400   279.35705     -31867.367      7479.4946      1.5329564      3290.3881    
       500   294.3282      -31904.162     -839.80809      1.5329564      3290.3881    
       600   291.47433     -31908.832      357.69408      1.5329564      3290.3881    
       700   301.54288     -31905.881      2948.3494      1.5329564      3290.3881    
       800   323.89122     -31911.558     -7245.0143      1.5329564      3290.3881    
       900   308.82915     -31883.608     -1519.3857      1.5329564      3290.3881    
      1000   314.78935     -31888.389     -12943.665      1.5329564      3290.3881    
      1100   287.71865     -31892.097      1123.0183      1.5329564      3290.3881    
      1200   280.19442     -31901.257     -954.01646      1.5329564      3290.3881    
      1300   295.70927     -31911.455     -10793.253      1.5329564      3290.3881    
      1400   297.47474     -31909.089      6591.5158      1.5329564      3290.3881    
      1500   300.68803     -31910.565      5335.4863      1.5329564      3290.3881    
      1600   311.57064     -31888.436      9505.201       1.5329564      3290.3881    
      1700   327.76123     -31891.306     -5747.3891      1.5329564      3290.3881    
      1800   314.68979     -31898.459      237.13269      1.5329564      3290.3881    
      1900   291.26164     -31905.749     -8598.9122      1.5329564      3290.3881    
      2000   282.59021     -31899.333     -16679.987      1.5329564      3290.3881    
      2100   281.90153     -31883.421      5146.5836      1.5329564      3290.3881    
      2200   313.23438     -31893.099      773.05322      1.5329564      3290.3881    
      2300   299.7064      -31887.815     -3794.7192      1.5329564      3290.3881    
      2400   277.45898     -31909.011      5666.1923      1.5329564      3290.3881    
      2500   299.75205     -31926.823     -13849.6        1.5329564      3290.3881    
      2600   302.66596     -31915.555      5966.6051      1.5329564      3290.3881    
      2700   294.40891     -31897.302     -4235.0705      1.5329564      3290.3881    
      2800   306.81527     -31896.672     -1227.6738      1.5329564      3290.3881    
      2900   328.89902     -31920.022     -4951.8886      1.5329564      3290.3881    
      3000   292.26283     -31924.772      10767.795      1.5329564      3290.3881    
Loop time of 107.375 on 8 procs for 3000 steps with 271 atoms

Performance: 1.207 ns/day, 19.884 hours/ns, 27.940 timesteps/s, 7.572 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.072     | 72.981     | 88.779     | 134.2 | 67.97
Bond    | 0.0074087  | 0.0078892  | 0.0082994  |   0.3 |  0.01
Neigh   | 5.2885     | 6.4948     | 7.9385     |  37.8 |  6.05
Comm    | 1.6178     | 17.433     | 32.33      | 274.5 | 16.24
Output  | 0.0066523  | 0.007489   | 0.0082955  |   0.7 |  0.01
Modify  | 8.9546     | 10.387     | 11.588     |  30.0 |  9.67
Other   |            | 0.06244    |            |       |  0.06

Nlocal:         33.875 ave          40 max          24 min
Histogram: 1 0 0 0 0 1 4 0 1 1
Nghost:           2766 ave        2820 max        2710 min
Histogram: 1 1 0 1 1 1 1 0 0 2
Neighs:          19560 ave       23076 max       14140 min
Histogram: 1 0 0 0 1 0 4 1 0 1

Total # of neighbors = 156480
Ave neighs/atom = 577.41697
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:25:35
