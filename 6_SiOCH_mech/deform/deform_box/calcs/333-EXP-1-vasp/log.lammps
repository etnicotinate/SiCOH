LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.1                  # the deformation magnitude 0.01

# Read the initial sctructure
# box tilt large
variable structure string 333-EXP-1-vasp
read_data       ${structure}.data
read_data       333-EXP-1-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.008 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.364 | 6.364 | 6.364 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 6.0385e-05 on 8 procs for 1 steps with 271 atoms

50.3% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.51e-07   | 2.7563e-07 | 3.11e-07   |   0.0 |  0.46
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 1.294e-06  | 1.7541e-06 | 2.181e-06  |   0.0 |  2.90
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 5.836e-05  |            |       | 96.64

Nlocal:         33.875 ave          38 max          27 min
Histogram: 1 1 0 0 0 0 2 0 2 2
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-EXP-1-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 5000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -9.02 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 106.3 | 107.8 | 109.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -30660.091      116480.91      1.5329564      3290.3881    
       100   724.5857      -31287.098     -32422.918      1.5329564      3290.3881    
       200   505.02151     -31415.652     -27117.604      1.5329564      3290.3881    
       300   438.19458     -31593.506     -17165.805      1.5329564      3290.3881    
       400   367.19583     -31692.14       11019.392      1.5329564      3290.3881    
       500   324.65484     -31757.096      2089.725       1.5329564      3290.3881    
       600   279.61417     -31781.755     -8837.9569      1.5329564      3290.3881    
       700   263.72986     -31786.777      1259.9231      1.5329564      3290.3881    
       800   301.27598     -31793.229      1341.7572      1.5329564      3290.3881    
       900   305.73662     -31761.718      11777.686      1.5329564      3290.3881    
      1000   331.88322     -31772.325      5543.6434      1.5329564      3290.3881    
      1100   306.00637     -31771.608      6079.6152      1.5329564      3290.3881    
      1200   294.49846     -31796.841     -20754.429      1.5329564      3290.3881    
      1300   261.97737     -31794.502      5962.6097      1.5329564      3290.3881    
      1400   289.73363     -31819.876      16891.689      1.5329564      3290.3881    
      1500   317.33321     -31838.486     -1571.888       1.5329564      3290.3881    
      1600   292.07077     -31816.394     -4462.9669      1.5329564      3290.3881    
      1700   302.93459     -31822.429     -4905.2811      1.5329564      3290.3881    
      1800   307.24242     -31819.602     -16654.352      1.5329564      3290.3881    
      1900   310.22443     -31824.435      2678.5114      1.5329564      3290.3881    
      2000   320.87721     -31843.283      1702.6243      1.5329564      3290.3881    
      2100   295.6543      -31852.756      1937.7986      1.5329564      3290.3881    
      2200   287.80094     -31873.247     -421.4888       1.5329564      3290.3881    
      2300   287.32273     -31888.327     -2418.4866      1.5329564      3290.3881    
      2400   284.34434     -31873.506      1301.4691      1.5329564      3290.3881    
      2500   298.98336     -31852.564      3135.3548      1.5329564      3290.3881    
      2600   318.16289     -31848.812      33.234838      1.5329564      3290.3881    
      2700   317.66376     -31863.451     -13007.99       1.5329564      3290.3881    
      2800   298.66451     -31882.786     -2428.0328      1.5329564      3290.3881    
      2900   271.38359     -31883.705     -704.01135      1.5329564      3290.3881    
      3000   295.96326     -31890.126     -2950.5707      1.5329564      3290.3881    
      3100   300.99181     -31865.98       869.21833      1.5329564      3290.3881    
      3200   299.05456     -31841.188      15764.158      1.5329564      3290.3881    
      3300   347.45289     -31889.091     -5945.8694      1.5329564      3290.3881    
      3400   280.6902      -31868.378      6754.4556      1.5329564      3290.3881    
      3500   298.33254     -31907.676     -663.40757      1.5329564      3290.3881    
      3600   285.90494     -31905.482     -5845.4679      1.5329564      3290.3881    
      3700   314.28962     -31918.431     -7252.0933      1.5329564      3290.3881    
      3800   305.41399     -31898.167     -6138.6177      1.5329564      3290.3881    
      3900   302.67542     -31875.139     -14452.546      1.5329564      3290.3881    
      4000   307.37646     -31875.586     -18001.994      1.5329564      3290.3881    
      4100   307.65474     -31889.449      5592.703       1.5329564      3290.3881    
      4200   280.82009     -31899.112      3048.0841      1.5329564      3290.3881    
      4300   292.89463     -31915.371     -1849.0636      1.5329564      3290.3881    
      4400   302.93517     -31914.549      5.4930369      1.5329564      3290.3881    
      4500   281.93432     -31881.825     -16572.775      1.5329564      3290.3881    
      4600   313.30251     -31894.633      7729.2801      1.5329564      3290.3881    
      4700   322.07467     -31905.465     -3383.0016      1.5329564      3290.3881    
      4800   297.75707     -31916.124     -11036.156      1.5329564      3290.3881    
      4900   274.0084      -31911.546     -737.03201      1.5329564      3290.3881    
      5000   296.48103     -31925.953     -12643.194      1.5329564      3290.3881    
Loop time of 193.228 on 8 procs for 5000 steps with 271 atoms

Performance: 1.118 ns/day, 21.470 hours/ns, 25.876 timesteps/s, 7.012 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 120.23     | 141.72     | 161        | 139.1 | 73.34
Bond    | 0.0015271  | 0.001962   | 0.0021857  |   0.5 |  0.00
Neigh   | 9.5533     | 11.367     | 12.964     |  40.7 |  5.88
Comm    | 3.5057     | 22.784     | 44.27      | 347.0 | 11.79
Output  | 0.0027814  | 0.0029804  | 0.0042736  |   0.9 |  0.00
Modify  | 15.663     | 17.27      | 19.087     |  33.1 |  8.94
Other   |            | 0.08446    |            |       |  0.04

Nlocal:         33.875 ave          43 max          19 min
Histogram: 1 0 0 0 0 2 1 3 0 1
Nghost:        2782.12 ave        2831 max        2725 min
Histogram: 1 0 1 0 2 1 1 0 0 2
Neighs:          19543 ave       24760 max       11276 min
Histogram: 1 0 0 0 0 2 2 2 0 1

Total # of neighbors = 156344
Ave neighs/atom = 576.91513
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333-EXP-1-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 14.7487
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.4318
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 16.6096

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal -1.8606
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal -1.0047
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -6.1972

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 14.7487
variable dlen equal lx-${len0}
variable dlen equal lx-14.7487
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*14.7487
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.1971999999999995978, deltaxy = 0.61972
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.0046999999999999265, deltaxz = 0.10047
print "yz = $(yz), deltayz = ${deltayz}"
yz = -1.8606000000000000316, deltayz = 0.18606
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.47487 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.47487 xy delta 0.61972 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.47487 xy delta 0.61972 xz delta 0.10047 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 106.8 | 108.7 | 110.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   296.48103     -31925.953     -12643.234      3290.3881      14.7487        13.4318        16.6096      
       100   310.70744     -31912.836     -7570.6029      3283.8074      14.719203      13.4318        16.6096      
       200   326.84071     -31915.47       4829.6583      3277.2266      14.689705      13.4318        16.6096      
       300   311.67423     -31916.804     -4808.486       3270.6458      14.660208      13.4318        16.6096      
       400   294.76771     -31908.372     -6732.6224      3264.065       14.63071       13.4318        16.6096      
       500   324.85531     -31932.984      9675.529       3257.4843      14.601213      13.4318        16.6096      
       600   297.42421     -31918.114      1180.7872      3250.9035      14.571716      13.4318        16.6096      
       700   276.08605     -31926.026      14401.886      3244.3227      14.542218      13.4318        16.6096      
       800   280.99977     -31932.869      8209.2688      3237.7419      14.512721      13.4318        16.6096      
       900   284.64981     -31919.015      4786.3924      3231.1612      14.483223      13.4318        16.6096      
      1000   301.90506     -31921.729     -1206.8412      3224.5804      14.453726      13.4318        16.6096      
      1100   307.1905      -31922.803     -2723.1058      3217.9996      14.424229      13.4318        16.6096      
      1200   282.13726     -31926.46      -3147.1267      3211.4188      14.394731      13.4318        16.6096      
      1300   272.9491      -31926.592      3509.6702      3204.8381      14.365234      13.4318        16.6096      
      1400   302.16947     -31932.35      -1429.0871      3198.2573      14.335736      13.4318        16.6096      
      1500   309.93127     -31916.018     -1882.1477      3191.6765      14.306239      13.4318        16.6096      
      1600   308.46474     -31913.116     -3276.128       3185.0957      14.276742      13.4318        16.6096      
      1700   311.27851     -31923.706     -2390.9151      3178.515       14.247244      13.4318        16.6096      
      1800   293.68906     -31912.01       10931.293      3171.9342      14.217747      13.4318        16.6096      
      1900   295.45924     -31914.97       12212.921      3165.3534      14.188249      13.4318        16.6096      
      2000   305.25806     -31919.37       1360.8265      3158.7726      14.158752      13.4318        16.6096      
      2100   284.63521     -31903.077      5580.0666      3152.1918      14.129255      13.4318        16.6096      
      2200   295.57733     -31919.401      13070.216      3145.6111      14.099757      13.4318        16.6096      
      2300   288.36643     -31914.549     -3542.6525      3139.0303      14.07026       13.4318        16.6096      
      2400   281.22296     -31921.392      9749.3841      3132.4495      14.040762      13.4318        16.6096      
      2500   270.48008     -31923.223      9902.0151      3125.8687      14.011265      13.4318        16.6096      
      2600   300.02737     -31931.393      8810.8975      3119.288       13.981768      13.4318        16.6096      
      2700   313.93487     -31908.939     -9060.7614      3112.7072      13.95227       13.4318        16.6096      
      2800   317.82882     -31903.016      7679.301       3106.1264      13.922773      13.4318        16.6096      
      2900   294.0782      -31889.081      716.36436      3099.5456      13.893275      13.4318        16.6096      
      3000   318.77592     -31913.476      2225.5157      3092.9649      13.863778      13.4318        16.6096      
      3100   301.80488     -31905.881      13269.639      3086.3841      13.834281      13.4318        16.6096      
      3200   327.46713     -31938.137      9311.2983      3079.8033      13.804783      13.4318        16.6096      
      3300   280.94389     -31921.222      11867.187      3073.2225      13.775286      13.4318        16.6096      
      3400   297.88057     -31925.399      14857.539      3066.6418      13.745788      13.4318        16.6096      
      3500   298.38173     -31913.695      14502.77       3060.061       13.716291      13.4318        16.6096      
      3600   303.74191     -31902.922      12596.029      3053.4802      13.686794      13.4318        16.6096      
      3700   286.85171     -31877.253      10354.425      3046.8994      13.657296      13.4318        16.6096      
      3800   310.86339     -31877.317      15874.142      3040.3186      13.627799      13.4318        16.6096      
      3900   308.72699     -31879.111      15658.882      3033.7379      13.598301      13.4318        16.6096      
      4000   308.36542     -31905.437      11919.857      3027.1571      13.568804      13.4318        16.6096      
      4100   305.65656     -31909.994      18473.233      3020.5763      13.539307      13.4318        16.6096      
      4200   305.9529      -31906.16       17985.435      3013.9955      13.509809      13.4318        16.6096      
      4300   288.85964     -31893.852      19857.39       3007.4148      13.480312      13.4318        16.6096      
      4400   285.64183     -31913.674      8648.0564      3000.834       13.450814      13.4318        16.6096      
      4500   303.75604     -31927.519      24468.49       2994.2532      13.421317      13.4318        16.6096      
      4600   319.32754     -31920.281      10911.628      2987.6724      13.39182       13.4318        16.6096      
      4700   289.39414     -31887.163      11910.18       2981.0917      13.362322      13.4318        16.6096      
      4800   306.54887     -31898.257      20074.818      2974.5109      13.332825      13.4318        16.6096      
      4900   295.37145     -31880.596      19152.704      2967.9301      13.303327      13.4318        16.6096      
      5000   301.03754     -31882.954      17376.349      2961.3493      13.27383       13.4318        16.6096      
Loop time of 213.48 on 8 procs for 5000 steps with 271 atoms

Performance: 1.012 ns/day, 23.720 hours/ns, 23.421 timesteps/s, 6.347 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 119.47     | 156.77     | 179.46     | 199.1 | 73.44
Bond    | 0.001513   | 0.0020935  | 0.0023877  |   0.5 |  0.00
Neigh   | 9.3207     | 12.1       | 13.965     |  54.9 |  5.67
Comm    | 3.0957     | 25.78      | 63.091     | 490.9 | 12.08
Output  | 0.016119   | 0.01843    | 0.020487   |   1.1 |  0.01
Modify  | 16.884     | 18.718     | 21.503     |  44.3 |  8.77
Other   |            | 0.08932    |            |       |  0.04

Nlocal:         33.875 ave          39 max          23 min
Histogram: 1 0 0 0 1 0 1 2 1 2
Nghost:        2956.25 ave        3024 max        2899 min
Histogram: 2 1 0 0 1 0 1 2 0 1
Neighs:        21768.9 ave       24770 max       15094 min
Histogram: 1 0 0 0 1 0 1 2 0 3

Total # of neighbors = 174151
Ave neighs/atom = 642.62362
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*14.7487
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.47487 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.47487 xy delta -0.61972 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.47487 xy delta -0.61972 xz delta -0.10047 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 106.8 | 108.7 | 110.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   296.48103     -31925.953     -12643.234      3290.3881      14.7487        13.4318        16.6096      
       100   310.89703     -31912.919     -7500.6835      3296.9689      14.778197      13.4318        16.6096      
       200   325.96381     -31912.077      1625.6267      3303.5497      14.807695      13.4318        16.6096      
       300   311.26519     -31911.434     -6241.675       3310.1305      14.837192      13.4318        16.6096      
       400   296.00636     -31907.687     -3703.8663      3316.7113      14.86669       13.4318        16.6096      
       500   317.59681     -31928.748     -6359.1857      3323.292       14.896187      13.4318        16.6096      
       600   297.90381     -31922.789     -11220.161      3329.8728      14.925684      13.4318        16.6096      
       700   295.98981     -31944.593      2098.3022      3336.4536      14.955182      13.4318        16.6096      
       800   288.88018     -31940.987     -7858.643       3343.0344      14.984679      13.4318        16.6096      
       900   281.49119     -31918.238     -2616.6033      3349.6151      15.014177      13.4318        16.6096      
      1000   300.65896     -31918.886     -596.50385      3356.1959      15.043674      13.4318        16.6096      
      1100   308.57988     -31917.205     -12003.207      3362.7767      15.073171      13.4318        16.6096      
      1200   291.26655     -31906.107     -11957.452      3369.3575      15.102669      13.4318        16.6096      
      1300   281.93182     -31916.894     -12780.05       3375.9382      15.132166      13.4318        16.6096      
      1400   270.26105     -31921.04       880.49735      3382.519       15.161664      13.4318        16.6096      
      1500   287.12987     -31911.651     -2450.124       3389.0998      15.191161      13.4318        16.6096      
      1600   305.57885     -31901.13       160.6356       3395.6806      15.220658      13.4318        16.6096      
      1700   308.7176      -31899.77      -5695.0063      3402.2613      15.250156      13.4318        16.6096      
      1800   293.29849     -31896.861     -693.17567      3408.8421      15.279653      13.4318        16.6096      
      1900   313.43455     -31913.161     -13600.567      3415.4229      15.309151      13.4318        16.6096      
      2000   301.52349     -31909.966     -8351.0564      3422.0037      15.338648      13.4318        16.6096      
      2100   303.41968     -31914.971     -2131.7031      3428.5844      15.368145      13.4318        16.6096      
      2200   311.35528     -31916.974     -7817.2737      3435.1652      15.397643      13.4318        16.6096      
      2300   279.00961     -31881.246     -6394.514       3441.746       15.42714       13.4318        16.6096      
      2400   294.82304     -31879.703     -26828.947      3448.3268      15.456638      13.4318        16.6096      
      2500   322.82514     -31876.885     -15593.589      3454.9076      15.486135      13.4318        16.6096      
      2600   336.79651     -31892.391     -8702.3427      3461.4883      15.515632      13.4318        16.6096      
      2700   299.94892     -31893.005     -15811.163      3468.0691      15.54513       13.4318        16.6096      
      2800   289.37571     -31886.478     -10497.372      3474.6499      15.574627      13.4318        16.6096      
      2900   288.19463     -31881.017      1565.7943      3481.2307      15.604125      13.4318        16.6096      
      3000   306.45843     -31878.639     -20327.174      3487.8114      15.633622      13.4318        16.6096      
      3100   315.19817     -31866.797     -8265.6193      3494.3922      15.663119      13.4318        16.6096      
      3200   300.51942     -31874.531     -13218.849      3500.973       15.692617      13.4318        16.6096      
      3300   303.03962     -31898.232     -9650.9542      3507.5538      15.722114      13.4318        16.6096      
      3400   297.18957     -31890.891     -12702.769      3514.1345      15.751612      13.4318        16.6096      
      3500   271.54296     -31853.678     -4077.2467      3520.7153      15.781109      13.4318        16.6096      
      3600   329.52833     -31873.255     -7579.7123      3527.2961      15.810606      13.4318        16.6096      
      3700   301.38625     -31848.481     -10421.185      3533.8769      15.840104      13.4318        16.6096      
      3800   296.52964     -31877.381     -12389.018      3540.4576      15.869601      13.4318        16.6096      
      3900   311.84277     -31901.396     -17969.379      3547.0384      15.899099      13.4318        16.6096      
      4000   298.28649     -31885.951     -4980.0546      3553.6192      15.928596      13.4318        16.6096      
      4100   299.67377     -31862.257     -3432.822       3560.2         15.958093      13.4318        16.6096      
      4200   322.29035     -31855.554     -19313.783      3566.7808      15.987591      13.4318        16.6096      
      4300   305.37429     -31854.65      -12446.153      3573.3615      16.017088      13.4318        16.6096      
      4400   298.6289      -31863.987     -8539.6986      3579.9423      16.046586      13.4318        16.6096      
      4500   285.784       -31852.562     -12961.267      3586.5231      16.076083      13.4318        16.6096      
      4600   303.20422     -31861.192     -10415.438      3593.1039      16.10558       13.4318        16.6096      
      4700   325.42636     -31870.326     -4449.306       3599.6846      16.135078      13.4318        16.6096      
      4800   309.0168      -31874.192     -17872.968      3606.2654      16.164575      13.4318        16.6096      
      4900   280.13103     -31863.154     -21426.307      3612.8462      16.194073      13.4318        16.6096      
      5000   277.04489     -31843.289     -22560.105      3619.427       16.22357       13.4318        16.6096      
Loop time of 189.692 on 8 procs for 5000 steps with 271 atoms

Performance: 1.139 ns/day, 21.077 hours/ns, 26.359 timesteps/s, 7.143 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 105.53     | 140.99     | 158.33     | 163.2 | 74.33
Bond    | 0.0015744  | 0.002085   | 0.0023529  |   0.5 |  0.00
Neigh   | 8.5339     | 11.144     | 12.535     |  45.5 |  5.87
Comm    | 2.7503     | 20.141     | 55.583     | 431.8 | 10.62
Output  | 0.015102   | 0.017127   | 0.019048   |   1.1 |  0.01
Modify  | 15.929     | 17.308     | 19.948     |  36.5 |  9.12
Other   |            | 0.08891    |            |       |  0.05

Nlocal:         33.875 ave          39 max          20 min
Histogram: 1 0 0 0 0 1 0 2 2 2
Nghost:        2648.38 ave        2698 max        2585 min
Histogram: 1 0 1 0 2 0 2 0 0 2
Neighs:        17748.4 ave       20382 max       10767 min
Histogram: 1 0 0 0 0 1 0 2 2 2

Total # of neighbors = 141987
Ave neighs/atom = 523.93727
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.4318
variable dlen equal ly-${len0}
variable dlen equal ly-13.4318
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.4318
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.1971999999999995978, deltaxy = 0.61972
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.0046999999999999265, deltaxz = 0.10047
print "yz = $(yz), deltayz = ${deltayz}"
yz = -1.8606000000000000316, deltayz = 0.18606
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.34318 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.34318 yz delta 0.18606 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 106.8 | 108.7 | 110.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   296.48103     -31925.953     -12643.234      3290.3881      14.7487        13.4318        16.6096      
       100   311.08699     -31912.772     -7675.5371      3283.8074      14.7487        13.404936      16.6096      
       200   328.84474     -31916.808      6508.4492      3277.2266      14.7487        13.378073      16.6096      
       300   312.985       -31914.523     -2362.8974      3270.6458      14.7487        13.351209      16.6096      
       400   294.27895     -31907.97      -11599.449      3264.065       14.7487        13.324346      16.6096      
       500   315.60332     -31927.125      4624.203       3257.4843      14.7487        13.297482      16.6096      
       600   308.0519      -31925.274     -2665.2268      3250.9035      14.7487        13.270618      16.6096      
       700   286.81126     -31936.371      8922.0253      3244.3227      14.7487        13.243755      16.6096      
       800   288.20864     -31936.726      6900.7285      3237.7419      14.7487        13.216891      16.6096      
       900   273.47341     -31905.62       2421.7837      3231.1612      14.7487        13.190028      16.6096      
      1000   316.05007     -31915.649     -3139.8393      3224.5804      14.7487        13.163164      16.6096      
      1100   306.06002     -31913.215      11110.084      3217.9996      14.7487        13.1363        16.6096      
      1200   288.48919     -31922.793      4343.5977      3211.4188      14.7487        13.109437      16.6096      
      1300   283.43663     -31920.788      3918.6762      3204.8381      14.7487        13.082573      16.6096      
      1400   323.6191      -31942.318     -5267.0639      3198.2573      14.7487        13.05571       16.6096      
      1500   287.07857     -31908.505     -1193.2491      3191.6765      14.7487        13.028846      16.6096      
      1600   286.84376     -31913.6        8038.7801      3185.0957      14.7487        13.001982      16.6096      
      1700   289.51482     -31916.457      2765.2225      3178.515       14.7487        12.975119      16.6096      
      1800   294.1022      -31927.503      15682.086      3171.9342      14.7487        12.948255      16.6096      
      1900   297.78409     -31942.731      5536.6844      3165.3534      14.7487        12.921392      16.6096      
      2000   288.05206     -31935.143      16002.892      3158.7726      14.7487        12.894528      16.6096      
      2100   305.90616     -31927.046      2548.9305      3152.1918      14.7487        12.867664      16.6096      
      2200   309.12315     -31908.158     -6023.4298      3145.6111      14.7487        12.840801      16.6096      
      2300   304.83284     -31918.862      9645.8415      3139.0303      14.7487        12.813937      16.6096      
      2400   281.88938     -31910.261      9128.5599      3132.4495      14.7487        12.787074      16.6096      
      2500   302.25189     -31930.44       11378.173      3125.8687      14.7487        12.76021       16.6096      
      2600   300.3118      -31938.901      8570.3918      3119.288       14.7487        12.733346      16.6096      
      2700   285.44554     -31934.341      14916.979      3112.7072      14.7487        12.706483      16.6096      
      2800   301.33736     -31941.373      474.57393      3106.1264      14.7487        12.679619      16.6096      
      2900   294.94254     -31928.66       8750.8567      3099.5456      14.7487        12.652756      16.6096      
      3000   294.26477     -31913.834      11190.914      3092.9649      14.7487        12.625892      16.6096      
      3100   309.81326     -31919.168      10206.634      3086.3841      14.7487        12.599028      16.6096      
      3200   290.44346     -31908.968     -827.92502      3079.8033      14.7487        12.572165      16.6096      
      3300   287.06478     -31925.191     -3100.7488      3073.2225      14.7487        12.545301      16.6096      
      3400   291.51723     -31925.195      3168.9869      3066.6418      14.7487        12.518438      16.6096      
      3500   304.22101     -31920.051      6059.3011      3060.061       14.7487        12.491574      16.6096      
      3600   320.75575     -31917.049      9295.2261      3053.4802      14.7487        12.46471       16.6096      
      3700   325.21775     -31893.79      -8701.8618      3046.8994      14.7487        12.437847      16.6096      
      3800   304.96186     -31886.222      19500.58       3040.3186      14.7487        12.410983      16.6096      
      3900   306.6746      -31905.567      9485.6157      3033.7379      14.7487        12.38412       16.6096      
      4000   308.11113     -31917.875      1513.3301      3027.1571      14.7487        12.357256      16.6096      
      4100   284.05918     -31905.254      13215.496      3020.5763      14.7487        12.330392      16.6096      
      4200   276.29259     -31901.274      18739.209      3013.9955      14.7487        12.303529      16.6096      
      4300   279.58316     -31910.318      11983.328      3007.4148      14.7487        12.276665      16.6096      
      4400   274.23287     -31923.271      10843.874      3000.834       14.7487        12.249802      16.6096      
      4500   286.04894     -31929.872      3578.8451      2994.2532      14.7487        12.222938      16.6096      
      4600   293.14407     -31900.191      3882.8212      2987.6724      14.7487        12.196074      16.6096      
      4700   309.86722     -31902.19       13721.756      2981.0917      14.7487        12.169211      16.6096      
      4800   287.42472     -31889.669      17246.867      2974.5109      14.7487        12.142347      16.6096      
      4900   285.36829     -31902.691      8142.1205      2967.9301      14.7487        12.115484      16.6096      
      5000   279.99342     -31903.631      23536.019      2961.3493      14.7487        12.08862       16.6096      
Loop time of 216.171 on 8 procs for 5000 steps with 271 atoms

Performance: 0.999 ns/day, 24.019 hours/ns, 23.130 timesteps/s, 6.268 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 123.25     | 163.6      | 180.99     | 165.4 | 75.68
Bond    | 0.0016396  | 0.0021771  | 0.002724   |   0.7 |  0.00
Neigh   | 9.5976     | 12.669     | 14.07      |  41.3 |  5.86
Comm    | 3.7243     | 21.162     | 61.482     | 459.7 |  9.79
Output  | 0.016168   | 0.018071   | 0.020117   |   1.0 |  0.01
Modify  | 17.267     | 18.632     | 21.736     |  34.4 |  8.62
Other   |            | 0.09175    |            |       |  0.04

Nlocal:         33.875 ave          39 max          21 min
Histogram: 1 0 0 0 0 0 1 3 1 2
Nghost:        3059.75 ave        3120 max        2998 min
Histogram: 1 1 0 1 0 3 0 0 1 1
Neighs:        21773.9 ave       25191 max       13743 min
Histogram: 1 0 0 0 0 0 1 4 0 2

Total # of neighbors = 174191
Ave neighs/atom = 642.77122
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.4318
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.34318 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.34318 yz delta -0.18606 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 106.8 | 108.7 | 110.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   296.48103     -31925.953     -12643.234      3290.3881      14.7487        13.4318        16.6096      
       100   310.53949     -31913.055     -7346.0133      3296.9689      14.7487        13.458664      16.6096      
       200   325.41492     -31911.288      3626.4197      3303.5497      14.7487        13.485527      16.6096      
       300   315.01949     -31917.065     -8031.7916      3310.1305      14.7487        13.512391      16.6096      
       400   292.22371     -31903.228     -1944.4059      3316.7113      14.7487        13.539254      16.6096      
       500   300.68868     -31911.373     -5458.5912      3323.292       14.7487        13.566118      16.6096      
       600   297.00987     -31910.726      1680.3482      3329.8728      14.7487        13.592982      16.6096      
       700   289.68138     -31929.681     -7155.0886      3336.4536      14.7487        13.619845      16.6096      
       800   287.90989     -31935.24      -4089.924       3343.0344      14.7487        13.646709      16.6096      
       900   283.69634     -31906.553      1663.7455      3349.6151      14.7487        13.673572      16.6096      
      1000   293.6092      -31896.595      8001.6438      3356.1959      14.7487        13.700436      16.6096      
      1100   300.74892     -31898.463      7767.3908      3362.7767      14.7487        13.7273        16.6096      
      1200   308.90323     -31915.924     -6211.8835      3369.3575      14.7487        13.754163      16.6096      
      1300   272.31315     -31896.297     -7855.3703      3375.9382      14.7487        13.781027      16.6096      
      1400   319.54693     -31906.975     -3915.2707      3382.519       14.7487        13.80789       16.6096      
      1500   328.15803     -31886.959     -10420.273      3389.0998      14.7487        13.834754      16.6096      
      1600   300.39179     -31871.187     -741.05882      3395.6806      14.7487        13.861618      16.6096      
      1700   312.40828     -31901.407     -6138.6893      3402.2613      14.7487        13.888481      16.6096      
      1800   283.87439     -31884.92      -4846.7846      3408.8421      14.7487        13.915345      16.6096      
      1900   305.83953     -31903.458     -6989.4086      3415.4229      14.7487        13.942208      16.6096      
      2000   286.33492     -31879.157     -2695.7692      3422.0037      14.7487        13.969072      16.6096      
      2100   306.83263     -31872.147      1755.4581      3428.5844      14.7487        13.995936      16.6096      
      2200   328.10853     -31859.201     -10990.447      3435.1652      14.7487        14.022799      16.6096      
      2300   313.83797     -31858.709     -6569.2332      3441.746       14.7487        14.049663      16.6096      
      2400   312.13871     -31877.268     -531.02877      3448.3268      14.7487        14.076526      16.6096      
      2500   277.19354     -31857.1        2868.3392      3454.9076      14.7487        14.10339       16.6096      
      2600   293.11669     -31873.06      -5075.0074      3461.4883      14.7487        14.130254      16.6096      
      2700   287.67562     -31879.536     -14343.922      3468.0691      14.7487        14.157117      16.6096      
      2800   295.68562     -31898.85      -12950.311      3474.6499      14.7487        14.183981      16.6096      
      2900   282.91522     -31879.181     -4772.9173      3481.2307      14.7487        14.210844      16.6096      
      3000   334.09233     -31887.332     -5629.7867      3487.8114      14.7487        14.237708      16.6096      
      3100   296.98021     -31864.102     -15038.299      3494.3922      14.7487        14.264572      16.6096      
      3200   289.64994     -31869.316     -8502.2839      3500.973       14.7487        14.291435      16.6096      
      3300   300.41737     -31885.618     -10098.258      3507.5538      14.7487        14.318299      16.6096      
      3400   280.82274     -31881.854     -11984.12       3514.1345      14.7487        14.345162      16.6096      
      3500   279.68495     -31891.565     -11926.91       3520.7153      14.7487        14.372026      16.6096      
      3600   267.75049     -31862.8       -13086.059      3527.2961      14.7487        14.39889       16.6096      
      3700   312.486       -31870.084     -8415.5946      3533.8769      14.7487        14.425753      16.6096      
      3800   304.0215      -31856.313     -12500.245      3540.4576      14.7487        14.452617      16.6096      
      3900   292.98963     -31847.394     -13964.737      3547.0384      14.7487        14.47948       16.6096      
      4000   286.41308     -31861.254      2363.3373      3553.6192      14.7487        14.506344      16.6096      
      4100   279.23258     -31866.925     -12378.635      3560.2         14.7487        14.533208      16.6096      
      4200   286.44775     -31857.929     -18981.93       3566.7808      14.7487        14.560071      16.6096      
      4300   303.81277     -31859.46      -6041.7292      3573.3615      14.7487        14.586935      16.6096      
      4400   300.41863     -31845.959     -14194.914      3579.9423      14.7487        14.613798      16.6096      
      4500   281.94156     -31825.075     -6786.4744      3586.5231      14.7487        14.640662      16.6096      
      4600   304.53653     -31854.275     -8136.1183      3593.1039      14.7487        14.667526      16.6096      
      4700   277.77439     -31851.343     -9069.0124      3599.6846      14.7487        14.694389      16.6096      
      4800   288.13967     -31852.924     -20810.565      3606.2654      14.7487        14.721253      16.6096      
      4900   311.04189     -31844.518     -13793.752      3612.8462      14.7487        14.748116      16.6096      
      5000   324.99323     -31833.72      -11591.166      3619.427       14.7487        14.77498       16.6096      
Loop time of 186.811 on 8 procs for 5000 steps with 271 atoms

Performance: 1.156 ns/day, 20.757 hours/ns, 26.765 timesteps/s, 7.253 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 103.74     | 134.62     | 155.74     | 154.8 | 72.06
Bond    | 0.0015477  | 0.0020631  | 0.0023483  |   0.5 |  0.00
Neigh   | 8.3771     | 10.709     | 12.498     |  44.0 |  5.73
Comm    | 2.8939     | 24.037     | 54.905     | 366.4 | 12.87
Output  | 0.015026   | 0.017094   | 0.019059   |   1.0 |  0.01
Modify  | 15.558     | 17.337     | 19.688     |  34.7 |  9.28
Other   |            | 0.08907    |            |       |  0.05

Nlocal:         33.875 ave          41 max          22 min
Histogram: 1 0 0 0 1 1 1 3 0 1
Nghost:        2544.62 ave        2581 max        2519 min
Histogram: 2 0 2 0 1 0 2 0 0 1
Neighs:        17735.2 ave       21076 max       11839 min
Histogram: 1 0 0 0 1 1 0 2 2 1

Total # of neighbors = 141882
Ave neighs/atom = 523.54982
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 16.6096
variable dlen equal lz-${len0}
variable dlen equal lz-16.6096
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*16.6096
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.1971999999999995978, deltaxy = 0.61972
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.0046999999999999265, deltaxz = 0.10047
print "yz = $(yz), deltayz = ${deltayz}"
yz = -1.8606000000000000316, deltayz = 0.18606
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -1.66096 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 106.8 | 108.7 | 110.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   296.48103     -31925.953     -12643.234      3290.3881      14.7487        13.4318        16.6096      
       100   311.25059     -31912.797     -7813.0368      3283.8074      14.7487        13.4318        16.576381    
       200   332.21079     -31915.934      7281.1362      3277.2266      14.7487        13.4318        16.543162    
       300   309.45838     -31905.662     -8384.5958      3270.6458      14.7487        13.4318        16.509942    
       400   306.57071     -31910.146      1013.6821      3264.065       14.7487        13.4318        16.476723    
       500   308.0793      -31916.398      5612.0344      3257.4843      14.7487        13.4318        16.443504    
       600   304.33663     -31920.111     -3814.7639      3250.9035      14.7487        13.4318        16.410285    
       700   287.88942     -31921.399      3870.7418      3244.3227      14.7487        13.4318        16.377066    
       800   283.59868     -31925.009      1205.3335      3237.7419      14.7487        13.4318        16.343846    
       900   284.8273      -31915.558     -3982.2516      3231.1612      14.7487        13.4318        16.310627    
      1000   304.67247     -31914.628     -6737.6993      3224.5804      14.7487        13.4318        16.277408    
      1100   302.61529     -31914.257      10232.758      3217.9996      14.7487        13.4318        16.244189    
      1200   284.94392     -31922.329     -5990.4292      3211.4188      14.7487        13.4318        16.21097     
      1300   297.48584     -31939.563     -7147.3468      3204.8381      14.7487        13.4318        16.17775     
      1400   299.15153     -31925.081     -14224.907      3198.2573      14.7487        13.4318        16.144531    
      1500   313.53011     -31926.085     -10.942545      3191.6765      14.7487        13.4318        16.111312    
      1600   298.14762     -31908.114      3365.1205      3185.0957      14.7487        13.4318        16.078093    
      1700   302.94041     -31910.658      14322.681      3178.515       14.7487        13.4318        16.044874    
      1800   284.10896     -31921.506      6273.6016      3171.9342      14.7487        13.4318        16.011654    
      1900   290.1531      -31924.259     -1031.5295      3165.3534      14.7487        13.4318        15.978435    
      2000   299.88154     -31918.99       680.31766      3158.7726      14.7487        13.4318        15.945216    
      2100   297.16915     -31891.837     -19162.707      3152.1918      14.7487        13.4318        15.911997    
      2200   309.62119     -31891.445     -3538.8499      3145.6111      14.7487        13.4318        15.878778    
      2300   314.84012     -31910.524     -1181.4824      3139.0303      14.7487        13.4318        15.845558    
      2400   312.08626     -31934.295      11109.035      3132.4495      14.7487        13.4318        15.812339    
      2500   294.08525     -31917.102     -3306.6326      3125.8687      14.7487        13.4318        15.77912     
      2600   304.601       -31919.682      7849.9527      3119.288       14.7487        13.4318        15.745901    
      2700   319.81397     -31908.13       10536.912      3112.7072      14.7487        13.4318        15.712682    
      2800   312.02139     -31896.79      -1666.5804      3106.1264      14.7487        13.4318        15.679462    
      2900   285.42273     -31904.408     -11211.858      3099.5456      14.7487        13.4318        15.646243    
      3000   323.12858     -31930.616      10500.525      3092.9649      14.7487        13.4318        15.613024    
      3100   308.60951     -31908.876      5623.0403      3086.3841      14.7487        13.4318        15.579805    
      3200   314.51961     -31894.984      5984.1349      3079.8033      14.7487        13.4318        15.546586    
      3300   327.14449     -31901.998      14942.323      3073.2225      14.7487        13.4318        15.513366    
      3400   286.67604     -31896.197      14025.221      3066.6418      14.7487        13.4318        15.480147    
      3500   296.43375     -31911.297      1516.6435      3060.061       14.7487        13.4318        15.446928    
      3600   290.36055     -31910.01       3589.7347      3053.4802      14.7487        13.4318        15.413709    
      3700   299.77424     -31921.488     -10696.384      3046.8994      14.7487        13.4318        15.38049     
      3800   273.32784     -31915.016      3737.3779      3040.3186      14.7487        13.4318        15.34727     
      3900   298.54418     -31937.561     -10654.078      3033.7379      14.7487        13.4318        15.314051    
      4000   314.26889     -31937.623     -8533.1121      3027.1571      14.7487        13.4318        15.280832    
      4100   293.40646     -31915.23       9389.031       3020.5763      14.7487        13.4318        15.247613    
      4200   308.38869     -31900.942      12699.853      3013.9955      14.7487        13.4318        15.214394    
      4300   338.8713      -31904.281      21656.416      3007.4148      14.7487        13.4318        15.181174    
      4400   310.05771     -31898.15       18401.267      3000.834       14.7487        13.4318        15.147955    
      4500   297.32809     -31896.481      9272.1484      2994.2532      14.7487        13.4318        15.114736    
      4600   313.54854     -31904.213      28571.668      2987.6724      14.7487        13.4318        15.081517    
      4700   311.39509     -31911.545      6817.7187      2981.0917      14.7487        13.4318        15.048298    
      4800   286.63418     -31897.763      24014.576      2974.5109      14.7487        13.4318        15.015078    
      4900   316.63919     -31911.606      11383.787      2967.9301      14.7487        13.4318        14.981859    
      5000   289.89339     -31871.284      24755.323      2961.3493      14.7487        13.4318        14.94864     
Loop time of 211.963 on 8 procs for 5000 steps with 271 atoms

Performance: 1.019 ns/day, 23.551 hours/ns, 23.589 timesteps/s, 6.393 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 121.62     | 155.98     | 177.78     | 173.7 | 73.59
Bond    | 0.0016165  | 0.0020551  | 0.0022916  |   0.6 |  0.00
Neigh   | 9.4488     | 12.061     | 14.011     |  49.3 |  5.69
Comm    | 3.473      | 25.297     | 59.641     | 431.2 | 11.93
Output  | 0.01413    | 0.016006   | 0.017814   |   1.0 |  0.01
Modify  | 16.577     | 18.517     | 21.157     |  40.1 |  8.74
Other   |            | 0.09023    |            |       |  0.04

Nlocal:         33.875 ave          39 max          25 min
Histogram: 1 0 0 1 0 1 0 3 0 2
Nghost:           2973 ave        3053 max        2898 min
Histogram: 1 1 0 1 1 1 1 1 0 1
Neighs:        21757.6 ave       25044 max       16230 min
Histogram: 1 0 0 1 0 1 1 2 1 1

Total # of neighbors = 174061
Ave neighs/atom = 642.29151
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*16.6096
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 1.66096 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 106.8 | 108.7 | 110.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   296.48103     -31925.953     -12643.234      3290.3881      14.7487        13.4318        16.6096      
       100   310.39221     -31913.025     -7296.6599      3296.9689      14.7487        13.4318        16.642819    
       200   326.65561     -31910.348     -6451.0444      3303.5497      14.7487        13.4318        16.676038    
       300   325.21629     -31918.53      -9762.2855      3310.1305      14.7487        13.4318        16.709258    
       400   303.41801     -31905.064     -4385.3612      3316.7113      14.7487        13.4318        16.742477    
       500   293.36226     -31904.732      1252.7763      3323.292       14.7487        13.4318        16.775696    
       600   313.23953     -31934.134      163.73352      3329.8728      14.7487        13.4318        16.808915    
       700   284.04888     -31921.591     -5850.3477      3336.4536      14.7487        13.4318        16.842134    
       800   296.51102     -31922.524      2060.8106      3343.0344      14.7487        13.4318        16.875354    
       900   308.91735     -31918.75       61.533647      3349.6151      14.7487        13.4318        16.908573    
      1000   294.95167     -31904.335     -2290.2162      3356.1959      14.7487        13.4318        16.941792    
      1100   311.96279     -31899.151     -11301.751      3362.7767      14.7487        13.4318        16.975011    
      1200   323.38037     -31894.765     -4880.8188      3369.3575      14.7487        13.4318        17.00823     
      1300   302.4778      -31904.369     -16182.123      3375.9382      14.7487        13.4318        17.04145     
      1400   286.5504      -31898.033     -3686.1157      3382.519       14.7487        13.4318        17.074669    
      1500   281.82829     -31899.342     -9024.3239      3389.0998      14.7487        13.4318        17.107888    
      1600   294.89622     -31912.519      4420.6172      3395.6806      14.7487        13.4318        17.141107    
      1700   303.42388     -31930.016     -2392.1908      3402.2613      14.7487        13.4318        17.174326    
      1800   275.35434     -31900.417     -6150.4884      3408.8421      14.7487        13.4318        17.207546    
      1900   332.38588     -31902.438      1248.8078      3415.4229      14.7487        13.4318        17.240765    
      2000   323.64662     -31892.478      1910.1765      3422.0037      14.7487        13.4318        17.273984    
      2100   299.77056     -31889.28      -8741.8182      3428.5844      14.7487        13.4318        17.307203    
      2200   295.32424     -31895.134      603.77742      3435.1652      14.7487        13.4318        17.340422    
      2300   306.05791     -31909.106     -8135.9134      3441.746       14.7487        13.4318        17.373642    
      2400   294.1364      -31908.878     -3302.9397      3448.3268      14.7487        13.4318        17.406861    
      2500   280.24659     -31919.402      2544.8077      3454.9076      14.7487        13.4318        17.44008     
      2600   279.85703     -31922.277      3213.5451      3461.4883      14.7487        13.4318        17.473299    
      2700   294.02778     -31911.283     -7799.2082      3468.0691      14.7487        13.4318        17.506518    
      2800   301.29923     -31898.524     -11993.664      3474.6499      14.7487        13.4318        17.539738    
      2900   299.90958     -31895.231     -11575.717      3481.2307      14.7487        13.4318        17.572957    
      3000   292.75324     -31890.44      -24545.307      3487.8114      14.7487        13.4318        17.606176    
      3100   299.00445     -31910.946      5217.4274      3494.3922      14.7487        13.4318        17.639395    
      3200   285.72914     -31912.422     -4809.2173      3500.973       14.7487        13.4318        17.672614    
      3300   284.89751     -31907.9       -17844.917      3507.5538      14.7487        13.4318        17.705834    
      3400   293.59533     -31900.525     -402.54763      3514.1345      14.7487        13.4318        17.739053    
      3500   289.68855     -31887.429      1127.8656      3520.7153      14.7487        13.4318        17.772272    
      3600   283.31776     -31893.147     -21698.219      3527.2961      14.7487        13.4318        17.805491    
      3700   288.86459     -31912.657     -2559.6379      3533.8769      14.7487        13.4318        17.83871     
      3800   279.10572     -31906.12      -3351.5193      3540.4576      14.7487        13.4318        17.87193     
      3900   308.4928      -31918.277     -8687.2728      3547.0384      14.7487        13.4318        17.905149    
      4000   314.11001     -31894.32      -2475.4938      3553.6192      14.7487        13.4318        17.938368    
      4100   311.87532     -31872.673     -5829.3121      3560.2         14.7487        13.4318        17.971587    
      4200   323.1086      -31902.305     -15524.756      3566.7808      14.7487        13.4318        18.004806    
      4300   288.96569     -31895.159     -28898.363      3573.3615      14.7487        13.4318        18.038026    
      4400   301.51398     -31901.325     -6749.5824      3579.9423      14.7487        13.4318        18.071245    
      4500   271.46551     -31879.686     -23897.237      3586.5231      14.7487        13.4318        18.104464    
      4600   296.69258     -31881.451     -19467.411      3593.1039      14.7487        13.4318        18.137683    
      4700   297.85386     -31852.726     -25981.501      3599.6846      14.7487        13.4318        18.170902    
      4800   337.77839     -31875.507      1275.4364      3606.2654      14.7487        13.4318        18.204122    
      4900   305.70703     -31885.029     -20142.031      3612.8462      14.7487        13.4318        18.237341    
      5000   303.86074     -31884.784     -20649.636      3619.427       14.7487        13.4318        18.27056     
Loop time of 190.398 on 8 procs for 5000 steps with 271 atoms

Performance: 1.134 ns/day, 21.155 hours/ns, 26.261 timesteps/s, 7.117 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 102.49     | 134.83     | 158.67     | 191.2 | 70.81
Bond    | 0.0016303  | 0.002011   | 0.0021847  |   0.4 |  0.00
Neigh   | 8.0787     | 10.406     | 12.448     |  53.8 |  5.47
Comm    | 2.6285     | 26.523     | 58.894     | 430.9 | 13.93
Output  | 0.013708   | 0.015636   | 0.017195   |   1.0 |  0.01
Modify  | 16.533     | 18.539     | 20.844     |  40.6 |  9.74
Other   |            | 0.08392    |            |       |  0.04

Nlocal:         33.875 ave          42 max          14 min
Histogram: 1 0 0 0 0 1 0 3 1 2
Nghost:        2621.25 ave        2705 max        2508 min
Histogram: 1 1 0 0 0 1 2 1 1 1
Neighs:          17745 ave       22070 max        7560 min
Histogram: 1 0 0 0 0 1 0 3 1 2

Total # of neighbors = 141960
Ave neighs/atom = 523.83764
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 14.7487
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz--1.8606)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*14.7487
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.1971999999999995978, deltaxy = 0.61972
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.0046999999999999265, deltaxz = 0.10047
print "yz = $(yz), deltayz = ${deltayz}"
yz = -1.8606000000000000316, deltayz = 0.18606
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -1.47487 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 106.8 | 108.7 | 110.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   296.48103     -31925.953     -12643.234      3290.3881      14.7487        13.4318        16.6096      
       100   310.77092     -31912.722     -7645.2849      3290.3881      14.7487        13.4318        16.6096      
       200   325.16925     -31911.881      5159.8581      3290.3881      14.7487        13.4318        16.6096      
       300   310.94433     -31911.719     -10057.723      3290.3881      14.7487        13.4318        16.6096      
       400   299.76432     -31910.979     -2027.1563      3290.3881      14.7487        13.4318        16.6096      
       500   308.81374     -31923.028     -1632.2782      3290.3881      14.7487        13.4318        16.6096      
       600   300.24823     -31923.719     -3646.3151      3290.3881      14.7487        13.4318        16.6096      
       700   274.52609     -31929.304     -2697.0198      3290.3881      14.7487        13.4318        16.6096      
       800   276.40613     -31933.583      2660.8154      3290.3881      14.7487        13.4318        16.6096      
       900   262.39224     -31903.768     -4675.3072      3290.3881      14.7487        13.4318        16.6096      
      1000   307.04675     -31923.73      -5739.9731      3290.3881      14.7487        13.4318        16.6096      
      1100   310.0852      -31914.721      1206.3798      3290.3881      14.7487        13.4318        16.6096      
      1200   301.07298     -31915.84       4768.8325      3290.3881      14.7487        13.4318        16.6096      
      1300   287.92244     -31930.86      -8703.4364      3290.3881      14.7487        13.4318        16.6096      
      1400   286.21896     -31923.514     -8692.6936      3290.3881      14.7487        13.4318        16.6096      
      1500   291.2803      -31912.419     -1450.6766      3290.3881      14.7487        13.4318        16.6096      
      1600   297.28887     -31908.135     -1025.1887      3290.3881      14.7487        13.4318        16.6096      
      1700   317.48574     -31921.882     -18865.936      3290.3881      14.7487        13.4318        16.6096      
      1800   280.68684     -31900.472     -3074.8934      3290.3881      14.7487        13.4318        16.6096      
      1900   296.98754     -31936.176     -5170.2809      3290.3881      14.7487        13.4318        16.6096      
      2000   286.66497     -31930.755      14712.6        3290.3881      14.7487        13.4318        16.6096      
      2100   309.33833     -31929.37      -6506.3746      3290.3881      14.7487        13.4318        16.6096      
      2200   318.39324     -31915.932     -5520.8658      3290.3881      14.7487        13.4318        16.6096      
      2300   310.32708     -31908.773     -12758.575      3290.3881      14.7487        13.4318        16.6096      
      2400   299.24054     -31909.588     -5541.6401      3290.3881      14.7487        13.4318        16.6096      
      2500   293.48788     -31913.606      1832.9962      3290.3881      14.7487        13.4318        16.6096      
      2600   283.75538     -31905.355     -1221.401       3290.3881      14.7487        13.4318        16.6096      
      2700   319.47852     -31930.68      -394.75997      3290.3881      14.7487        13.4318        16.6096      
      2800   328.24513     -31911.278      4332.7018      3290.3881      14.7487        13.4318        16.6096      
      2900   335.36374     -31901.513     -3049.4595      3290.3881      14.7487        13.4318        16.6096      
      3000   305.25785     -31904.134      4602.6173      3290.3881      14.7487        13.4318        16.6096      
      3100   286.73304     -31905.539      13358.814      3290.3881      14.7487        13.4318        16.6096      
      3200   293.52462     -31914.772     -2359.4805      3290.3881      14.7487        13.4318        16.6096      
      3300   293.54729     -31917.026      444.67451      3290.3881      14.7487        13.4318        16.6096      
      3400   296.50487     -31914.354     -7084.8304      3290.3881      14.7487        13.4318        16.6096      
      3500   303.84607     -31893.857     -11573.882      3290.3881      14.7487        13.4318        16.6096      
      3600   307.12953     -31880.367     -5388.2497      3290.3881      14.7487        13.4318        16.6096      
      3700   303.17873     -31895.801     -11298.99       3290.3881      14.7487        13.4318        16.6096      
      3800   291.40374     -31905.468     -8163.635       3290.3881      14.7487        13.4318        16.6096      
      3900   291.73428     -31905.242     -554.69564      3290.3881      14.7487        13.4318        16.6096      
      4000   290.1368      -31903.176     -14093.88       3290.3881      14.7487        13.4318        16.6096      
      4100   281.62887     -31899.78      -932.81095      3290.3881      14.7487        13.4318        16.6096      
      4200   280.83123     -31901.88      -200.79905      3290.3881      14.7487        13.4318        16.6096      
      4300   273.40462     -31883.326      951.04547      3290.3881      14.7487        13.4318        16.6096      
      4400   311.31512     -31888.574      1107.7552      3290.3881      14.7487        13.4318        16.6096      
      4500   303.8776      -31879.721     -9865.8444      3290.3881      14.7487        13.4318        16.6096      
      4600   300.28562     -31904.063     -4349.4561      3290.3881      14.7487        13.4318        16.6096      
      4700   299.36145     -31914.109     -4246.471       3290.3881      14.7487        13.4318        16.6096      
      4800   297.23084     -31914.759     -12496.504      3290.3881      14.7487        13.4318        16.6096      
      4900   291.83276     -31904.477     -137.50473      3290.3881      14.7487        13.4318        16.6096      
      5000   314.07037     -31901.271      18092.009      3290.3881      14.7487        13.4318        16.6096      
Loop time of 201.521 on 8 procs for 5000 steps with 271 atoms

Performance: 1.072 ns/day, 22.391 hours/ns, 24.811 timesteps/s, 6.724 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 111.93     | 141.17     | 168.76     | 202.0 | 70.05
Bond    | 0.0016716  | 0.0019685  | 0.0022192  |   0.4 |  0.00
Neigh   | 9.0671     | 11.281     | 13.623     |  57.8 |  5.60
Comm    | 2.577      | 30.201     | 59.437     | 436.6 | 14.99
Output  | 0.013605   | 0.015261   | 0.016772   |   0.9 |  0.01
Modify  | 16.443     | 18.765     | 20.996     |  45.1 |  9.31
Other   |            | 0.08472    |            |       |  0.04

Nlocal:         33.875 ave          42 max          23 min
Histogram: 1 0 0 0 1 3 0 1 1 1
Nghost:        2794.88 ave        2842 max        2767 min
Histogram: 3 0 0 1 2 0 1 0 0 1
Neighs:        19554.5 ave       23874 max       13572 min
Histogram: 1 0 0 0 1 3 0 1 1 1

Total # of neighbors = 156436
Ave neighs/atom = 577.25461
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*14.7487
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 1.47487 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 106.8 | 108.7 | 110.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   296.48103     -31925.953     -12643.234      3290.3881      14.7487        13.4318        16.6096      
       100   310.82636     -31913.019     -7464.0076      3290.3881      14.7487        13.4318        16.6096      
       200   326.01655     -31914.895      7048.4686      3290.3881      14.7487        13.4318        16.6096      
       300   312.09958     -31917.469     -4678.3931      3290.3881      14.7487        13.4318        16.6096      
       400   297.43233     -31912.144     -14697.694      3290.3881      14.7487        13.4318        16.6096      
       500   304.88979     -31917.828     -4706.3966      3290.3881      14.7487        13.4318        16.6096      
       600   296.5044      -31911.156      1738.4022      3290.3881      14.7487        13.4318        16.6096      
       700   281.73668     -31930.591      6314.0705      3290.3881      14.7487        13.4318        16.6096      
       800   279.4887      -31934.131      6145.2028      3290.3881      14.7487        13.4318        16.6096      
       900   287.18564     -31919.67      -5071.353       3290.3881      14.7487        13.4318        16.6096      
      1000   314.5828      -31920.978     -2577.3878      3290.3881      14.7487        13.4318        16.6096      
      1100   321.45115     -31919.596     -1441.5341      3290.3881      14.7487        13.4318        16.6096      
      1200   307.57927     -31928.827      6554.7428      3290.3881      14.7487        13.4318        16.6096      
      1300   269.85476     -31915.939     -8150.2993      3290.3881      14.7487        13.4318        16.6096      
      1400   297.31295     -31928.267      5036.6471      3290.3881      14.7487        13.4318        16.6096      
      1500   289.09561     -31910.262     -6304.3787      3290.3881      14.7487        13.4318        16.6096      
      1600   295.38221     -31903.179     -10361.459      3290.3881      14.7487        13.4318        16.6096      
      1700   298.49362     -31898.636     -4416.1723      3290.3881      14.7487        13.4318        16.6096      
      1800   308.44407     -31930.246     -11809.778      3290.3881      14.7487        13.4318        16.6096      
      1900   287.07542     -31926.887      4207.0888      3290.3881      14.7487        13.4318        16.6096      
      2000   287.23046     -31918.373      4673.3092      3290.3881      14.7487        13.4318        16.6096      
      2100   318.25841     -31921.561      823.71567      3290.3881      14.7487        13.4318        16.6096      
      2200   326.95077     -31913.685     -6471.8419      3290.3881      14.7487        13.4318        16.6096      
      2300   312.76448     -31905.455     -15299.286      3290.3881      14.7487        13.4318        16.6096      
      2400   298.92615     -31920.625      858.65352      3290.3881      14.7487        13.4318        16.6096      
      2500   295.72141     -31923.179      3647.0915      3290.3881      14.7487        13.4318        16.6096      
      2600   317.52797     -31923.807     -26697.126      3290.3881      14.7487        13.4318        16.6096      
      2700   317.69956     -31898.126      6249.5234      3290.3881      14.7487        13.4318        16.6096      
      2800   324.72268     -31901.121     -20665.447      3290.3881      14.7487        13.4318        16.6096      
      2900   288.19243     -31910.447      9957.344       3290.3881      14.7487        13.4318        16.6096      
      3000   292.64006     -31918.194     -10104.429      3290.3881      14.7487        13.4318        16.6096      
      3100   306.56201     -31916.968     -5848.5363      3290.3881      14.7487        13.4318        16.6096      
      3200   306.67139     -31894.491     -12683.119      3290.3881      14.7487        13.4318        16.6096      
      3300   314.00226     -31893.771     -12506.741      3290.3881      14.7487        13.4318        16.6096      
      3400   289.96376     -31893.262     -4705.4686      3290.3881      14.7487        13.4318        16.6096      
      3500   283.99247     -31900.311      9579.3334      3290.3881      14.7487        13.4318        16.6096      
      3600   311.96866     -31918.713      2174.9198      3290.3881      14.7487        13.4318        16.6096      
      3700   270.71623     -31882.529     -18289.486      3290.3881      14.7487        13.4318        16.6096      
      3800   275.79524     -31880.053     -9496.7191      3290.3881      14.7487        13.4318        16.6096      
      3900   315.87388     -31900.317     -13580.193      3290.3881      14.7487        13.4318        16.6096      
      4000   322.31804     -31906.724     -4401.404       3290.3881      14.7487        13.4318        16.6096      
      4100   276.01429     -31890.354     -9761.6782      3290.3881      14.7487        13.4318        16.6096      
      4200   311.14678     -31930.619     -10833.208      3290.3881      14.7487        13.4318        16.6096      
      4300   292.98996     -31910.266      2734.4344      3290.3881      14.7487        13.4318        16.6096      
      4400   327.60332     -31917.368     -6267.4214      3290.3881      14.7487        13.4318        16.6096      
      4500   336.38856     -31901.677     -2396.7027      3290.3881      14.7487        13.4318        16.6096      
      4600   297.90993     -31877.51      -6741.2435      3290.3881      14.7487        13.4318        16.6096      
      4700   291.56568     -31902.132     -8178.0188      3290.3881      14.7487        13.4318        16.6096      
      4800   317.56655     -31919.211     -4300.7217      3290.3881      14.7487        13.4318        16.6096      
      4900   295.70926     -31902.612     -5375.7352      3290.3881      14.7487        13.4318        16.6096      
      5000   284.27489     -31897.387     -10378.902      3290.3881      14.7487        13.4318        16.6096      
Loop time of 200.056 on 8 procs for 5000 steps with 271 atoms

Performance: 1.080 ns/day, 22.228 hours/ns, 24.993 timesteps/s, 6.773 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 115.51     | 150.07     | 166.66     | 163.9 | 75.02
Bond    | 0.0015881  | 0.0019852  | 0.0023285  |   0.6 |  0.00
Neigh   | 8.8893     | 11.511     | 12.936     |  46.8 |  5.75
Comm    | 3.9443     | 20.558     | 55.143     | 443.0 | 10.28
Output  | 0.016066   | 0.018357   | 0.020424   |   1.1 |  0.01
Modify  | 16.395     | 17.8       | 20.411     |  37.4 |  8.90
Other   |            | 0.0926     |            |       |  0.05

Nlocal:         33.875 ave          40 max          23 min
Histogram: 1 0 0 0 1 1 2 1 0 2
Nghost:           2774 ave        2830 max        2714 min
Histogram: 1 1 0 0 2 1 1 0 0 2
Neighs:        19595.9 ave       23081 max       13609 min
Histogram: 1 0 0 0 1 1 2 1 0 2

Total # of neighbors = 156767
Ave neighs/atom = 578.47601
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.4318
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz--1.0047)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.4318
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.1971999999999995978, deltaxy = 0.61972
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.0046999999999999265, deltaxz = 0.10047
print "yz = $(yz), deltayz = ${deltayz}"
yz = -1.8606000000000000316, deltayz = 0.18606
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -1.34318 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 106.8 | 108.7 | 110.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   296.48103     -31925.953     -12643.234      3290.3881      14.7487        13.4318        16.6096      
       100   311.07881     -31913.093     -7934.3179      3290.3881      14.7487        13.4318        16.6096      
       200   325.03177     -31913.004      5408.1059      3290.3881      14.7487        13.4318        16.6096      
       300   316.60157     -31918.774     -9400.9659      3290.3881      14.7487        13.4318        16.6096      
       400   297.34554     -31911.714      442.39689      3290.3881      14.7487        13.4318        16.6096      
       500   300.85932     -31913.694      2517.0184      3290.3881      14.7487        13.4318        16.6096      
       600   291.04464     -31907.836     -10928.749      3290.3881      14.7487        13.4318        16.6096      
       700   276.74267     -31912.493      21873.022      3290.3881      14.7487        13.4318        16.6096      
       800   267.15449     -31915.968      10394.057      3290.3881      14.7487        13.4318        16.6096      
       900   271.08963     -31898.291      3543.6288      3290.3881      14.7487        13.4318        16.6096      
      1000   296.88202     -31895.584     -8385.7037      3290.3881      14.7487        13.4318        16.6096      
      1100   297.03648     -31895.289     -1882.3402      3290.3881      14.7487        13.4318        16.6096      
      1200   299.47461     -31913.673     -9329.092       3290.3881      14.7487        13.4318        16.6096      
      1300   300.00585     -31921.802     -13112.319      3290.3881      14.7487        13.4318        16.6096      
      1400   301.62751     -31917.277      1663.7468      3290.3881      14.7487        13.4318        16.6096      
      1500   293.31535     -31901.909     -5497.5186      3290.3881      14.7487        13.4318        16.6096      
      1600   278.97635     -31887.997      2485.5689      3290.3881      14.7487        13.4318        16.6096      
      1700   284.43829     -31902.625     -4534.7315      3290.3881      14.7487        13.4318        16.6096      
      1800   282.92764     -31920.214     -2768.5629      3290.3881      14.7487        13.4318        16.6096      
      1900   282.92085     -31923.648      10083.364      3290.3881      14.7487        13.4318        16.6096      
      2000   308.68121     -31922.772      307.88301      3290.3881      14.7487        13.4318        16.6096      
      2100   286.72491     -31881.357     -16653.113      3290.3881      14.7487        13.4318        16.6096      
      2200   316.68413     -31907.101      4899.2869      3290.3881      14.7487        13.4318        16.6096      
      2300   292.65967     -31906.15      -8664.2123      3290.3881      14.7487        13.4318        16.6096      
      2400   305.21019     -31922.389      2536.8713      3290.3881      14.7487        13.4318        16.6096      
      2500   308.04659     -31918.784     -2874.3747      3290.3881      14.7487        13.4318        16.6096      
      2600   300.72373     -31908.577     -9866.6312      3290.3881      14.7487        13.4318        16.6096      
      2700   275.8305      -31903.414     -8868.3592      3290.3881      14.7487        13.4318        16.6096      
      2800   292.2677      -31916.546     -7829.3428      3290.3881      14.7487        13.4318        16.6096      
      2900   312.70033     -31916.399     -5187.4054      3290.3881      14.7487        13.4318        16.6096      
      3000   308.60111     -31901.287      7056.5223      3290.3881      14.7487        13.4318        16.6096      
      3100   302.84997     -31910.589     -1555.0822      3290.3881      14.7487        13.4318        16.6096      
      3200   282.06519     -31913.339     -15979.18       3290.3881      14.7487        13.4318        16.6096      
      3300   285.01711     -31917.068     -1397.9004      3290.3881      14.7487        13.4318        16.6096      
      3400   294.44937     -31905.283     -2298.5174      3290.3881      14.7487        13.4318        16.6096      
      3500   310.47709     -31907.587     -5666.636       3290.3881      14.7487        13.4318        16.6096      
      3600   297.72507     -31897.713     -409.88143      3290.3881      14.7487        13.4318        16.6096      
      3700   324.53387     -31919.826     -7377.8722      3290.3881      14.7487        13.4318        16.6096      
      3800   283.74258     -31903.744     -3051.5788      3290.3881      14.7487        13.4318        16.6096      
      3900   274.10652     -31913.938      8638.6411      3290.3881      14.7487        13.4318        16.6096      
      4000   292.30303     -31917.41      -10855.153      3290.3881      14.7487        13.4318        16.6096      
      4100   302.69284     -31913.408      2122.7369      3290.3881      14.7487        13.4318        16.6096      
      4200   288.81175     -31895.536      15566.815      3290.3881      14.7487        13.4318        16.6096      
      4300   318.86665     -31919.697     -979.51738      3290.3881      14.7487        13.4318        16.6096      
      4400   302.34187     -31905.369     -4057.0374      3290.3881      14.7487        13.4318        16.6096      
      4500   302.45504     -31899.235      5157.718       3290.3881      14.7487        13.4318        16.6096      
      4600   289.91822     -31877.785     -5563.7518      3290.3881      14.7487        13.4318        16.6096      
      4700   318.71759     -31893.075     -5555.3834      3290.3881      14.7487        13.4318        16.6096      
      4800   295.98545     -31898.437     -3821.0094      3290.3881      14.7487        13.4318        16.6096      
      4900   275.05506     -31892.684      13591.709      3290.3881      14.7487        13.4318        16.6096      
      5000   289.37222     -31898.182      1284.2008      3290.3881      14.7487        13.4318        16.6096      
Loop time of 199.301 on 8 procs for 5000 steps with 271 atoms

Performance: 1.084 ns/day, 22.145 hours/ns, 25.088 timesteps/s, 6.799 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 113.13     | 143.91     | 166.69     | 180.6 | 72.21
Bond    | 0.0015817  | 0.0020013  | 0.0023534  |   0.6 |  0.00
Neigh   | 8.8532     | 11.397     | 13.131     |  53.6 |  5.72
Comm    | 3.0283     | 25.797     | 56.609     | 426.7 | 12.94
Output  | 0.01417    | 0.016455   | 0.018698   |   1.2 |  0.01
Modify  | 16.345     | 18.09      | 20.606     |  42.5 |  9.08
Other   |            | 0.08799    |            |       |  0.04

Nlocal:         33.875 ave          41 max          21 min
Histogram: 1 0 0 0 0 2 2 0 1 2
Nghost:        2787.88 ave        2839 max        2727 min
Histogram: 1 0 1 1 0 1 2 0 0 2
Neighs:        19550.5 ave       23640 max       12472 min
Histogram: 1 0 0 0 1 2 1 0 1 2

Total # of neighbors = 156404
Ave neighs/atom = 577.13653
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.4318
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 1.34318 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 106.8 | 108.7 | 110.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   296.48103     -31925.953     -12643.234      3290.3881      14.7487        13.4318        16.6096      
       100   310.46675     -31912.649     -7272.7018      3290.3881      14.7487        13.4318        16.6096      
       200   325.95196     -31915.191      5031.5443      3290.3881      14.7487        13.4318        16.6096      
       300   311.21918     -31916.42      -6175.636       3290.3881      14.7487        13.4318        16.6096      
       400   298.9486      -31912.581     -16650.692      3290.3881      14.7487        13.4318        16.6096      
       500   310.1868      -31922.917     -2065.3858      3290.3881      14.7487        13.4318        16.6096      
       600   300.76315     -31919.327     -9394.9124      3290.3881      14.7487        13.4318        16.6096      
       700   298.7996      -31939.208      15059.339      3290.3881      14.7487        13.4318        16.6096      
       800   279.04213     -31939.865     -8881.7199      3290.3881      14.7487        13.4318        16.6096      
       900   290.57641     -31932.806     -2027.9366      3290.3881      14.7487        13.4318        16.6096      
      1000   279.09831     -31897.174     -6580.7839      3290.3881      14.7487        13.4318        16.6096      
      1100   312.51808     -31917.831      5462.9505      3290.3881      14.7487        13.4318        16.6096      
      1200   303.4917      -31920.946     -13448.326      3290.3881      14.7487        13.4318        16.6096      
      1300   294.97453     -31928.103      2647.3085      3290.3881      14.7487        13.4318        16.6096      
      1400   304.6782      -31937.931     -6908.3938      3290.3881      14.7487        13.4318        16.6096      
      1500   293.92115     -31927.214      10468.219      3290.3881      14.7487        13.4318        16.6096      
      1600   287.05066     -31913.077     -1749.7378      3290.3881      14.7487        13.4318        16.6096      
      1700   296.72992     -31916.472     -609.98217      3290.3881      14.7487        13.4318        16.6096      
      1800   295.44967     -31923.664      1251.5583      3290.3881      14.7487        13.4318        16.6096      
      1900   299.05031     -31943.451      1438.7863      3290.3881      14.7487        13.4318        16.6096      
      2000   287.08538     -31935.197     -10498.362      3290.3881      14.7487        13.4318        16.6096      
      2100   288.76064     -31912.279     -4296.9992      3290.3881      14.7487        13.4318        16.6096      
      2200   327.81048     -31925.875      1431.8066      3290.3881      14.7487        13.4318        16.6096      
      2300   313.81774     -31921.668      3334.6383      3290.3881      14.7487        13.4318        16.6096      
      2400   282.61613     -31903.046     -4111.3872      3290.3881      14.7487        13.4318        16.6096      
      2500   286.87229     -31904.192      16399.77       3290.3881      14.7487        13.4318        16.6096      
      2600   297.97423     -31913.465     -972.74462      3290.3881      14.7487        13.4318        16.6096      
      2700   324.19989     -31938.807     -5401.8624      3290.3881      14.7487        13.4318        16.6096      
      2800   276.94048     -31927.462      12455.891      3290.3881      14.7487        13.4318        16.6096      
      2900   268.7603      -31917.644      9991.3992      3290.3881      14.7487        13.4318        16.6096      
      3000   305.26008     -31915.739     -1192.4019      3290.3881      14.7487        13.4318        16.6096      
      3100   307.02827     -31913.891     -4868.0214      3290.3881      14.7487        13.4318        16.6096      
      3200   298.79189     -31919.044     -20035.234      3290.3881      14.7487        13.4318        16.6096      
      3300   287.62685     -31922.323     -2129.8783      3290.3881      14.7487        13.4318        16.6096      
      3400   281.80022     -31926.357     -18309.391      3290.3881      14.7487        13.4318        16.6096      
      3500   300.04421     -31923.894      14240.384      3290.3881      14.7487        13.4318        16.6096      
      3600   295.39478     -31894.442      6041.7051      3290.3881      14.7487        13.4318        16.6096      
      3700   309.51113     -31903.892     -2633.6915      3290.3881      14.7487        13.4318        16.6096      
      3800   287.11454     -31905.631      3026.223       3290.3881      14.7487        13.4318        16.6096      
      3900   301.5556      -31935.618     -8215.5485      3290.3881      14.7487        13.4318        16.6096      
      4000   280.40134     -31917.561      1003.2185      3290.3881      14.7487        13.4318        16.6096      
      4100   292.38684     -31915.066      17219.761      3290.3881      14.7487        13.4318        16.6096      
      4200   325.39811     -31921.248     -1884.5234      3290.3881      14.7487        13.4318        16.6096      
      4300   304.18733     -31881.026     -39.489659      3290.3881      14.7487        13.4318        16.6096      
      4400   321.52498     -31878.725      7120.3368      3290.3881      14.7487        13.4318        16.6096      
      4500   336.39184     -31930.801     -2147.7432      3290.3881      14.7487        13.4318        16.6096      
      4600   295.00471     -31918.666     -3508.2875      3290.3881      14.7487        13.4318        16.6096      
      4700   292.50564     -31927.682     -6581.4999      3290.3881      14.7487        13.4318        16.6096      
      4800   309.81333     -31951.538      10235.07       3290.3881      14.7487        13.4318        16.6096      
      4900   289.64654     -31932.259      3523.5137      3290.3881      14.7487        13.4318        16.6096      
      5000   297.19146     -31917.737     -11795.722      3290.3881      14.7487        13.4318        16.6096      
Loop time of 197.219 on 8 procs for 5000 steps with 271 atoms

Performance: 1.095 ns/day, 21.913 hours/ns, 25.353 timesteps/s, 6.871 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 113.48     | 137.08     | 166.72     | 179.5 | 69.50
Bond    | 0.0015476  | 0.0019489  | 0.0023327  |   0.7 |  0.00
Neigh   | 8.604      | 10.499     | 12.768     |  54.8 |  5.32
Comm    | 1.6376     | 31.286     | 54.923     | 375.9 | 15.86
Output  | 0.013003   | 0.014938   | 0.016629   |   1.0 |  0.01
Modify  | 15.988     | 18.255     | 20.115     |  41.5 |  9.26
Other   |            | 0.08706    |            |       |  0.04

Nlocal:         33.875 ave          40 max          23 min
Histogram: 1 0 0 0 0 2 1 2 1 1
Nghost:        2773.88 ave        2818 max        2713 min
Histogram: 1 0 0 0 3 0 1 0 2 1
Neighs:        19598.2 ave       23061 max       13579 min
Histogram: 1 0 0 0 0 2 1 2 1 1

Total # of neighbors = 156786
Ave neighs/atom = 578.54613
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 16.6096
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--6.1972)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*16.6096
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.1971999999999995978, deltaxy = 0.61972
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.0046999999999999265, deltaxz = 0.10047
print "yz = $(yz), deltayz = ${deltayz}"
yz = -1.8606000000000000316, deltayz = 0.18606
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -1.66096 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 106.8 | 108.7 | 110.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   296.48103     -31925.953     -12643.234      3290.3881      14.7487        13.4318        16.6096      
       100   311.27546     -31913.227     -7510.8301      3290.3881      14.7487        13.4318        16.6096      
       200   327.08824     -31915.198      5802.7949      3290.3881      14.7487        13.4318        16.6096      
       300   314.71948     -31916.318     -1180.0912      3290.3881      14.7487        13.4318        16.6096      
       400   302.08664     -31913.54      -2985.9271      3290.3881      14.7487        13.4318        16.6096      
       500   306.31557     -31922.146      1630.0475      3290.3881      14.7487        13.4318        16.6096      
       600   291.62829     -31917.076     -11333.022      3290.3881      14.7487        13.4318        16.6096      
       700   284.69303     -31936.392      6441.4784      3290.3881      14.7487        13.4318        16.6096      
       800   277.25409     -31939.076      961.97093      3290.3881      14.7487        13.4318        16.6096      
       900   295.37292     -31933.559     -1789.1527      3290.3881      14.7487        13.4318        16.6096      
      1000   308.93503     -31925.946     -5277.2914      3290.3881      14.7487        13.4318        16.6096      
      1100   302.36444     -31913.909      7646.6424      3290.3881      14.7487        13.4318        16.6096      
      1200   314.06486     -31926.851     -8076.1888      3290.3881      14.7487        13.4318        16.6096      
      1300   308.50552     -31938.227     -10927.775      3290.3881      14.7487        13.4318        16.6096      
      1400   270.30273     -31929.464     -1970.1097      3290.3881      14.7487        13.4318        16.6096      
      1500   276.87978     -31922.71       1304.2132      3290.3881      14.7487        13.4318        16.6096      
      1600   282.42315     -31912.118     -1559.9879      3290.3881      14.7487        13.4318        16.6096      
      1700   307.06149     -31918.596     -6717.5841      3290.3881      14.7487        13.4318        16.6096      
      1800   292.90391     -31899.772      2368.3612      3290.3881      14.7487        13.4318        16.6096      
      1900   292.00463     -31893.019     -1615.0062      3290.3881      14.7487        13.4318        16.6096      
      2000   304.41716     -31906.235     -4434.6555      3290.3881      14.7487        13.4318        16.6096      
      2100   278.59436     -31905.831     -18979.362      3290.3881      14.7487        13.4318        16.6096      
      2200   300.09234     -31920.009     -4578.368       3290.3881      14.7487        13.4318        16.6096      
      2300   291.28161     -31894.846     -1307.4667      3290.3881      14.7487        13.4318        16.6096      
      2400   304.49141     -31871.903      5053.4832      3290.3881      14.7487        13.4318        16.6096      
      2500   303.44623     -31866.035     -5253.8636      3290.3881      14.7487        13.4318        16.6096      
      2600   301.83797     -31897.219     -5494.4713      3290.3881      14.7487        13.4318        16.6096      
      2700   291.54988     -31898.06      -8491.6447      3290.3881      14.7487        13.4318        16.6096      
      2800   295.69469     -31900.5       -844.64729      3290.3881      14.7487        13.4318        16.6096      
      2900   272.96757     -31881.286     -10290.057      3290.3881      14.7487        13.4318        16.6096      
      3000   291.60049     -31912.076     -3478.1984      3290.3881      14.7487        13.4318        16.6096      
      3100   277.23614     -31914.222     -1955.6581      3290.3881      14.7487        13.4318        16.6096      
      3200   265.96285     -31892.962     -16610.059      3290.3881      14.7487        13.4318        16.6096      
      3300   319.52149     -31900         -1719.7919      3290.3881      14.7487        13.4318        16.6096      
      3400   328.04853     -31904.547      1090.9083      3290.3881      14.7487        13.4318        16.6096      
      3500   295.38189     -31896.016     -9183.9838      3290.3881      14.7487        13.4318        16.6096      
      3600   288.98099     -31906.448     -94.014947      3290.3881      14.7487        13.4318        16.6096      
      3700   315.73915     -31930.013      4704.1793      3290.3881      14.7487        13.4318        16.6096      
      3800   302.00558     -31918.661      9171.8781      3290.3881      14.7487        13.4318        16.6096      
      3900   299.87629     -31897.671      2275.3978      3290.3881      14.7487        13.4318        16.6096      
      4000   324.17848     -31901.104     -4846.6764      3290.3881      14.7487        13.4318        16.6096      
      4100   304.32921     -31895.138      6665.2318      3290.3881      14.7487        13.4318        16.6096      
      4200   303.58192     -31922.783     -9817.6288      3290.3881      14.7487        13.4318        16.6096      
      4300   306.78923     -31929.491     -5872.9763      3290.3881      14.7487        13.4318        16.6096      
      4400   312.37083     -31921.59       8127.8584      3290.3881      14.7487        13.4318        16.6096      
      4500   316.45225     -31906.902     -3502.5268      3290.3881      14.7487        13.4318        16.6096      
      4600   304.0826      -31894.139      2402.4147      3290.3881      14.7487        13.4318        16.6096      
      4700   299.27506     -31914.363     -4133.6921      3290.3881      14.7487        13.4318        16.6096      
      4800   301.62687     -31933.968      2222.4765      3290.3881      14.7487        13.4318        16.6096      
      4900   285.17866     -31921.423     -13979.524      3290.3881      14.7487        13.4318        16.6096      
      5000   310.83885     -31932.516      4425.1458      3290.3881      14.7487        13.4318        16.6096      
Loop time of 194.097 on 8 procs for 5000 steps with 271 atoms

Performance: 1.113 ns/day, 21.566 hours/ns, 25.760 timesteps/s, 6.981 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 115.41     | 133.22     | 155.39     | 141.5 | 68.63
Bond    | 0.0015267  | 0.001913   | 0.0020781  |   0.4 |  0.00
Neigh   | 8.9827     | 10.797     | 13.281     |  46.7 |  5.56
Comm    | 9.771      | 31.946     | 49.804     | 288.9 | 16.46
Output  | 0.01257    | 0.01421    | 0.015805   |   0.9 |  0.01
Modify  | 15.555     | 18.04      | 19.812     |  36.1 |  9.29
Other   |            | 0.08244    |            |       |  0.04

Nlocal:         33.875 ave          40 max          21 min
Histogram: 1 0 0 0 0 1 2 2 0 2
Nghost:        2884.38 ave        2936 max        2817 min
Histogram: 1 0 1 0 0 2 2 0 0 2
Neighs:        19569.2 ave       23129 max       12471 min
Histogram: 1 0 0 0 0 1 2 2 0 2

Total # of neighbors = 156554
Ave neighs/atom = 577.69004
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*16.6096
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 1.66096 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 106.8 | 108.7 | 110.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   296.48103     -31925.953     -12643.234      3290.3881      14.7487        13.4318        16.6096      
       100   310.62389     -31912.599     -7488.4147      3290.3881      14.7487        13.4318        16.6096      
       200   323.36021     -31912.347      3078.728       3290.3881      14.7487        13.4318        16.6096      
       300   311.09491     -31916.434     -10474.336      3290.3881      14.7487        13.4318        16.6096      
       400   300.24265     -31914.088     -15129.855      3290.3881      14.7487        13.4318        16.6096      
       500   323.4662      -31932.58      -1642.1285      3290.3881      14.7487        13.4318        16.6096      
       600   314.38328     -31933.192     -4824.4478      3290.3881      14.7487        13.4318        16.6096      
       700   287.92108     -31942.496      93.019324      3290.3881      14.7487        13.4318        16.6096      
       800   269.17438     -31925.224      1328.135       3290.3881      14.7487        13.4318        16.6096      
       900   294.79282     -31924.817     -4813.9683      3290.3881      14.7487        13.4318        16.6096      
      1000   288.5019      -31906.329     -9252.679       3290.3881      14.7487        13.4318        16.6096      
      1100   283.92369     -31902.137     -17291.849      3290.3881      14.7487        13.4318        16.6096      
      1200   287.81241     -31907.992     -9122.3549      3290.3881      14.7487        13.4318        16.6096      
      1300   279.7554      -31917.913     -6916.6455      3290.3881      14.7487        13.4318        16.6096      
      1400   286.5767      -31930.882     -2698.1684      3290.3881      14.7487        13.4318        16.6096      
      1500   283.34208     -31922.246     -10244.817      3290.3881      14.7487        13.4318        16.6096      
      1600   305.54304     -31913.29      -5313.3829      3290.3881      14.7487        13.4318        16.6096      
      1700   327.49359     -31920.465     -11177.029      3290.3881      14.7487        13.4318        16.6096      
      1800   297.07207     -31916.604      4376.0606      3290.3881      14.7487        13.4318        16.6096      
      1900   285.99447     -31928.184      6880.8268      3290.3881      14.7487        13.4318        16.6096      
      2000   310.09626     -31939.192      2204.8686      3290.3881      14.7487        13.4318        16.6096      
      2100   296.83007     -31915.728     -1558.7179      3290.3881      14.7487        13.4318        16.6096      
      2200   288.24224     -31886.616      3946.5402      3290.3881      14.7487        13.4318        16.6096      
      2300   322.46005     -31883.391     -2548.7633      3290.3881      14.7487        13.4318        16.6096      
      2400   342.684       -31893.503      10922.976      3290.3881      14.7487        13.4318        16.6096      
      2500   316.49402     -31918.233      10926.35       3290.3881      14.7487        13.4318        16.6096      
      2600   298.53949     -31912.989      8094.0395      3290.3881      14.7487        13.4318        16.6096      
      2700   334.06095     -31944.405     -2108.3623      3290.3881      14.7487        13.4318        16.6096      
      2800   312.9286      -31944.803     -3429.5507      3290.3881      14.7487        13.4318        16.6096      
      2900   295.36885     -31933.573      6190.4815      3290.3881      14.7487        13.4318        16.6096      
      3000   298.30981     -31910.184      8484.6288      3290.3881      14.7487        13.4318        16.6096      
      3100   312.87037     -31904.286     -851.72933      3290.3881      14.7487        13.4318        16.6096      
      3200   293.54185     -31886.929     -8678.7271      3290.3881      14.7487        13.4318        16.6096      
      3300   283.7724      -31888.748      3406.0286      3290.3881      14.7487        13.4318        16.6096      
      3400   293.68199     -31910.98      -3822.6723      3290.3881      14.7487        13.4318        16.6096      
      3500   307.00328     -31916.908     -5169.5782      3290.3881      14.7487        13.4318        16.6096      
      3600   294.37837     -31906.806      167.48841      3290.3881      14.7487        13.4318        16.6096      
      3700   304.34466     -31905.21       945.33732      3290.3881      14.7487        13.4318        16.6096      
      3800   301.94234     -31896.837     -815.85466      3290.3881      14.7487        13.4318        16.6096      
      3900   285.93313     -31891.783      20300.154      3290.3881      14.7487        13.4318        16.6096      
      4000   297.52272     -31922.227     -9109.5608      3290.3881      14.7487        13.4318        16.6096      
      4100   291.40972     -31919.28       8187.8591      3290.3881      14.7487        13.4318        16.6096      
      4200   293.90431     -31902.789      395.91745      3290.3881      14.7487        13.4318        16.6096      
      4300   290.24985     -31875.522      762.59665      3290.3881      14.7487        13.4318        16.6096      
      4400   310.12241     -31882.802     -18275.717      3290.3881      14.7487        13.4318        16.6096      
      4500   315.07069     -31903.559      138.71038      3290.3881      14.7487        13.4318        16.6096      
      4600   301.95096     -31898.359     -14420.452      3290.3881      14.7487        13.4318        16.6096      
      4700   307.62713     -31899.871     -667.51156      3290.3881      14.7487        13.4318        16.6096      
      4800   300.47729     -31883.836     -12942.3        3290.3881      14.7487        13.4318        16.6096      
      4900   316.26667     -31870.994      17774.351      3290.3881      14.7487        13.4318        16.6096      
      5000   324.6446      -31874.142     -3881.5204      3290.3881      14.7487        13.4318        16.6096      
Loop time of 167.26 on 8 procs for 5000 steps with 271 atoms

Performance: 1.291 ns/day, 18.584 hours/ns, 29.894 timesteps/s, 8.101 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 98.745     | 110.16     | 138.93     | 119.2 | 65.86
Bond    | 0.00098221 | 0.0014912  | 0.0019034  |   0.7 |  0.00
Neigh   | 8.3534     | 9.3158     | 12.313     |  42.9 |  5.57
Comm    | 2.1958     | 30.999     | 42.386     | 224.9 | 18.53
Output  | 0.010114   | 0.011704   | 0.013053   |   0.9 |  0.01
Modify  | 13.721     | 16.692     | 17.631     |  32.0 |  9.98
Other   |            | 0.07655    |            |       |  0.05

Nlocal:         33.875 ave          42 max          21 min
Histogram: 1 0 0 1 0 1 1 2 1 1
Nghost:        2682.88 ave        2739 max        2629 min
Histogram: 1 0 1 2 0 1 1 1 0 1
Neighs:        19572.5 ave       24174 max       12391 min
Histogram: 1 0 0 1 0 1 1 2 1 1

Total # of neighbors = 156580
Ave neighs/atom = 577.78598
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:42:42
