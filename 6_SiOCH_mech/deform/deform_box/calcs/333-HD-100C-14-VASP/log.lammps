LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 30*${nthermo}       # steps of equilibration run 10
variable nequil equal 30*100       
variable nrun equal 30*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 30*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-HD-100C-14-VASP
read_data       ${structure}.data
read_data       333-HD-100C-14-VASP.data
Reading data file ...
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.006 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 5.40573e-05 on 8 procs for 1 steps with 366 atoms

46.7% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.677e-06  | 1.677e-06  | 1.677e-06  |   0.0 |  3.10
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 4.469e-06  | 4.469e-06  | 4.469e-06  |   0.0 |  8.27
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 4.791e-05  |            |       | 88.63

Nlocal:          45.75 ave          50 max          38 min
Histogram: 1 0 0 0 0 2 1 1 1 2
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-HD-100C-14-VASP_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
run ${nequil}
run 3000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -29.52 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 131.2 | 133.5 | 136.5 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -43579.409      43399.428      1.8952586      3770.2978    
       100   501.31721     -43951.858     -5482.4294      1.8952586      3770.2978    
       200   461.37543     -44118.279      675.39958      1.8952586      3770.2978    
       300   358.21729     -44182.519     -4611.4587      1.8952586      3770.2978    
       400   342.69982     -44289.858     -10505.098      1.8952586      3770.2978    
       500   304.71689     -44336.453     -6863.721       1.8952586      3770.2978    
       600   277.61747     -44349.561      2371.2463      1.8952586      3770.2978    
       700   295.18902     -44362.622      215.76326      1.8952586      3770.2978    
       800   296.96454     -44334.344     -5171.6613      1.8952586      3770.2978    
       900   313.88552     -44330.146     -5703.9153      1.8952586      3770.2978    
      1000   303.04307     -44335.255     -927.32497      1.8952586      3770.2978    
      1100   290.28149     -44359.779     -14836.59       1.8952586      3770.2978    
      1200   265.90356     -44358.295     -10226.493      1.8952586      3770.2978    
      1300   282.41574     -44365.098     -5322.3059      1.8952586      3770.2978    
      1400   305.39048     -44359.171     -4136.1052      1.8952586      3770.2978    
      1500   313.51829     -44351.056      1748.3585      1.8952586      3770.2978    
      1600   309.16666     -44349.003     -3166.2655      1.8952586      3770.2978    
      1700   298.04054     -44359.319      3531.2606      1.8952586      3770.2978    
      1800   283.38286     -44366.171      4082.6337      1.8952586      3770.2978    
      1900   285.72907     -44373.574     -6905.8815      1.8952586      3770.2978    
      2000   291.16103     -44361.115     -10861.002      1.8952586      3770.2978    
      2100   312.15439     -44364.437     -17503.903      1.8952586      3770.2978    
      2200   309.5297      -44368.589     -4466.5763      1.8952586      3770.2978    
      2300   292.16701     -44375.512      4594.1211      1.8952586      3770.2978    
      2400   287.65004     -44385.544      2441.7332      1.8952586      3770.2978    
      2500   275.8479      -44364.562     -5702.8855      1.8952586      3770.2978    
      2600   301.62039     -44377.579     -10193.809      1.8952586      3770.2978    
      2700   309.51785     -44382.15      -579.03466      1.8952586      3770.2978    
      2800   287.35727     -44372.082      3941.7641      1.8952586      3770.2978    
      2900   290.06265     -44386.712     -3174.9246      1.8952586      3770.2978    
      3000   307.28953     -44410.088     -8204.6987      1.8952586      3770.2978    
Loop time of 165.84 on 8 procs for 3000 steps with 366 atoms

Performance: 0.781 ns/day, 30.711 hours/ns, 18.090 timesteps/s, 6.621 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 124.1      | 136.06     | 140.06     |  41.0 | 82.05
Bond    | 0.0080199  | 0.0090469  | 0.0097205  |   0.6 |  0.01
Neigh   | 9.9334     | 10.968     | 11.313     |  12.3 |  6.61
Comm    | 2.3859     | 6.3894     | 18.35      | 189.2 |  3.85
Output  | 0.0016719  | 0.0018142  | 0.0026783  |   0.8 |  0.00
Modify  | 11.985     | 12.328     | 13.374     |  11.7 |  7.43
Other   |            | 0.07916    |            |       |  0.05

Nlocal:          45.75 ave          52 max          42 min
Histogram: 2 1 1 0 1 0 1 1 0 1
Nghost:        3424.75 ave        3488 max        3357 min
Histogram: 2 0 0 0 1 2 1 0 0 2
Neighs:          31073 ave       35141 max       28693 min
Histogram: 3 1 0 0 1 1 1 0 0 1

Total # of neighbors = 248584
Ave neighs/atom = 679.19126
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333-HD-100C-14-VASP_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.724
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.9031
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.2465

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.4371
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 0.1778
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -7.584

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 15.724
variable dlen equal lx-${len0}
variable dlen equal lx-15.724
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.724
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.5839999999999996305, deltaxy = 0.07584
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.17780000000000001359, deltaxz = -0.001778
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43709999999999998854, deltayz = -0.004371
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.15724 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.15724 xy delta 0.07584 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.15724 xy delta 0.07584 xz delta -0.001778 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.8 | 133 | 135.4 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   307.28953     -44410.089     -8204.9606      1.8952586      3770.2978    
       100   298.71737     -44393.902     -10051.681      1.8958906      3769.041     
       200   308.21506     -44387.243      3116.1396      1.896523       3767.7843    
       300   316.62558     -44379.356     -1963.8633      1.8971558      3766.5275    
       400   320.3204      -44389.018      2185.3256      1.897789       3765.2707    
       500   297.30568     -44404.173     -4798.3651      1.8984227      3764.014     
       600   297.49234     -44411.738     -14749.117      1.8990568      3762.7572    
       700   301.57308     -44406.144     -2813.4114      1.8996913      3761.5004    
       800   284.88684     -44363.817     -11328.453      1.9003262      3760.2437    
       900   315.77394     -44375.972     -11439.744      1.9009615      3758.9869    
      1000   312.15808     -44388.386     -8124.7041      1.9015973      3757.7301    
      1100   320.47468     -44407.983     -1357.2702      1.9022335      3756.4734    
      1200   298.78699     -44396.809      2805.4797      1.9028701      3755.2166    
      1300   291.0382      -44411.579     -10884.832      1.9035072      3753.9598    
      1400   293.82167     -44412.517     -8405.1906      1.9041446      3752.7031    
      1500   297.3085      -44391.514      115.6374       1.9047826      3751.4463    
      1600   311.04219     -44374.314     -2696.452       1.9054209      3750.1895    
      1700   333.04456     -44407.229      7153.6955      1.9060596      3748.9328    
      1800   288.14445     -44384.865      10106.032      1.9066988      3747.676     
      1900   280.17638     -44386.531      2746.7997      1.9073384      3746.4192    
      2000   304.19031     -44405.073      4757.0182      1.9079785      3745.1625    
      2100   305.08767     -44380.028      7811.6408      1.908619       3743.9057    
      2200   309.92672     -44363.096     -389.35534      1.9092599      3742.6489    
      2300   308.60012     -44379.428      4095.6266      1.9099012      3741.3922    
      2400   295.12725     -44381.873      7737.8938      1.910543       3740.1354    
      2500   280.27948     -44377.457      6751.2621      1.9111852      3738.8786    
      2600   297.28169     -44396.567      14518.504      1.9118278      3737.6219    
      2700   306.53362     -44394.459      13716.809      1.9124709      3736.3651    
      2800   323.16716     -44376.19       3393.0824      1.9131144      3735.1084    
      2900   319.79111     -44366.465      7261.915       1.9137583      3733.8516    
      3000   305.98439     -44394.009      10692.689      1.9144027      3732.5948    
Loop time of 166.549 on 8 procs for 3000 steps with 366 atoms

Performance: 0.778 ns/day, 30.842 hours/ns, 18.013 timesteps/s, 6.593 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 97.297     | 129.17     | 140.65     | 123.7 | 77.55
Bond    | 0.0085253  | 0.0090458  | 0.009411   |   0.3 |  0.01
Neigh   | 7.9026     | 10.478     | 11.368     |  34.8 |  6.29
Comm    | 2.1304     | 13.633     | 45.505     | 381.0 |  8.19
Output  | 0.0096023  | 0.010941   | 0.012334   |   0.9 |  0.01
Modify  | 12.286     | 13.173     | 15.754     |  31.0 |  7.91
Other   |            | 0.07826    |            |       |  0.05

Nlocal:          45.75 ave          52 max          37 min
Histogram: 1 0 0 0 2 1 1 1 1 1
Nghost:        3420.25 ave        3494 max        3344 min
Histogram: 1 1 1 0 1 0 1 2 0 1
Neighs:        31384.6 ave       35453 max       25668 min
Histogram: 1 0 0 0 2 1 1 1 1 1

Total # of neighbors = 251077
Ave neighs/atom = 686.00273
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.724
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.15724 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.15724 xy delta -0.07584 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.15724 xy delta -0.07584 xz delta 0.001778 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.8 | 133 | 135.4 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   307.28953     -44410.089     -8204.9606      1.8952586      3770.2978    
       100   298.57518     -44394.018     -10021.383      1.8946271      3771.5546    
       200   309.45487     -44388.225      2239.0948      1.893996       3772.8113    
       300   314.84568     -44378.161     -2983.1029      1.8933653      3774.0681    
       400   317.03222     -44390.338     -3557.4876      1.892735       3775.3249    
       500   289.21836     -44397.929     -2855.9222      1.8921051      3776.5816    
       600   301.03683     -44415.998     -4965.17        1.8914757      3777.8384    
       700   302.51372     -44413.504      1028.7867      1.8908467      3779.0952    
       800   322.31051     -44422.998     -11195.045      1.8902181      3780.3519    
       900   314.67873     -44388.563     -11787.743      1.8895899      3781.6087    
      1000   324.16685     -44396.256      820.76269      1.8889621      3782.8655    
      1100   289.39321     -44390.905      4878.2962      1.8883347      3784.1222    
      1200   303.05604     -44414.576      999.16333      1.8877078      3785.379     
      1300   290.38833     -44394.909     -12723.538      1.8870813      3786.6358    
      1400   309.53715     -44405.66      -10649.576      1.8864552      3787.8925    
      1500   303.47101     -44372.995     -6744.6258      1.8858295      3789.1493    
      1600   319.72717     -44364.817     -11567.996      1.8852042      3790.4061    
      1700   305.601       -44367.639     -6654.694       1.8845794      3791.6628    
      1800   318.0055      -44410.247     -4868.905       1.8839549      3792.9196    
      1900   303.75606     -44405.825     -8390.6407      1.8833309      3794.1764    
      2000   303.39675     -44412.112     -9231.3728      1.8827073      3795.4331    
      2100   303.51443     -44408.667     -1653.2926      1.882084       3796.6899    
      2200   305.64635     -44383.805     -4079.363       1.8814613      3797.9466    
      2300   313.98595     -44376.332      4290.7195      1.8808389      3799.2034    
      2400   308.30692     -44376.577     -4972.5158      1.8802169      3800.4602    
      2500   313.73444     -44425.123     -12289.697      1.8795953      3801.7169    
      2600   296.52832     -44412.119     -8666.2197      1.8789742      3802.9737    
      2700   290.74878     -44387.273     -1495.7912      1.8783535      3804.2305    
      2800   323.64613     -44408.369     -1446.6307      1.8777331      3805.4872    
      2900   286.08762     -44381.631     -190.29707      1.8771132      3806.744     
      3000   291.08585     -44423.649     -5227.7409      1.8764937      3808.0008    
Loop time of 167.893 on 8 procs for 3000 steps with 366 atoms

Performance: 0.772 ns/day, 31.091 hours/ns, 17.869 timesteps/s, 6.540 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 94.908     | 126.27     | 142.48     | 138.9 | 75.21
Bond    | 0.0080092  | 0.0090228  | 0.0095619  |   0.4 |  0.01
Neigh   | 7.9761     | 10.375     | 11.929     |  37.5 |  6.18
Comm    | 1.0888     | 17.3       | 48.65      | 375.3 | 10.30
Output  | 0.010615   | 0.011937   | 0.013338   |   0.8 |  0.01
Modify  | 12.278     | 13.841     | 16.269     |  32.5 |  8.24
Other   |            | 0.08034    |            |       |  0.05

Nlocal:          45.75 ave          54 max          37 min
Histogram: 1 0 0 1 1 3 0 1 0 1
Nghost:         3424.5 ave        3493 max        3350 min
Histogram: 1 0 1 2 0 1 0 1 1 1
Neighs:        30727.6 ave       35912 max       25120 min
Histogram: 1 0 0 1 1 3 1 0 0 1

Total # of neighbors = 245821
Ave neighs/atom = 671.64208
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.9031
variable dlen equal ly-${len0}
variable dlen equal ly-13.9031
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.9031
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.5839999999999996305, deltaxy = 0.07584
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.17780000000000001359, deltaxz = -0.001778
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43709999999999998854, deltayz = -0.004371
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.139031 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.139031 yz delta -0.004371 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.8 | 133 | 135.4 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   307.28953     -44410.089     -8204.9606      1.8952586      3770.2978    
       100   298.72042     -44394.005     -10051.129      1.8958906      3769.041     
       200   310.29771     -44389.817      2687.2294      1.896523       3767.7843    
       300   311.77432     -44375.838     -2167.2129      1.8971558      3766.5275    
       400   315.8056      -44381.627      1765.154       1.897789       3765.2707    
       500   301.38135     -44403.174      2947.3422      1.8984227      3764.014     
       600   280.67854     -44392.773     -9377.6942      1.8990568      3762.7572    
       700   295.37718     -44397.092     -4678.7932      1.8996913      3761.5004    
       800   301.63478     -44381.683     -13875.621      1.9003262      3760.2437    
       900   291.50498     -44358.652      9564.2569      1.9009615      3758.9869    
      1000   296.27109     -44400.517      7795.5878      1.9015973      3757.7301    
      1100   283.25219     -44403.737      4203.8937      1.9022335      3756.4734    
      1200   293.19281     -44403.097     -8432.8355      1.9028701      3755.2166    
      1300   284.92639     -44372.792     -1755.8895      1.9035072      3753.9598    
      1400   309.91377     -44382.089      2820.275       1.9041446      3752.7031    
      1500   310.88322     -44400.584     -7544.4325      1.9047826      3751.4463    
      1600   286.88962     -44416.473     -359.69611      1.9054209      3750.1895    
      1700   289.92684     -44413.487      1705.578       1.9060596      3748.9328    
      1800   296.8286      -44399.595      6946.0839      1.9066988      3747.676     
      1900   306.71776     -44395.337      4625.5358      1.9073384      3746.4192    
      2000   304.70448     -44395.541     -3066.8229      1.9079785      3745.1625    
      2100   284.19182     -44414.814     -10336.931      1.908619       3743.9057    
      2200   291.46605     -44430.212      2878.6516      1.9092599      3742.6489    
      2300   290.6092      -44412.565     -2255.6798      1.9099012      3741.3922    
      2400   308.47129     -44405.701      2601.4673      1.910543       3740.1354    
      2500   306.94747     -44398.697      4902.3721      1.9111852      3738.8786    
      2600   303.155       -44403.145     -7076.7303      1.9118278      3737.6219    
      2700   299.76883     -44417.506      1617.5804      1.9124709      3736.3651    
      2800   305.3694      -44428.855      2896.1854      1.9131144      3735.1084    
      2900   286.35621     -44407.277      4665.5763      1.9137583      3733.8516    
      3000   310.51177     -44422.98      -2418.3595      1.9144027      3732.5948    
Loop time of 170.14 on 8 procs for 3000 steps with 366 atoms

Performance: 0.762 ns/day, 31.507 hours/ns, 17.632 timesteps/s, 6.453 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 96.665     | 128.17     | 141.77     | 137.6 | 75.33
Bond    | 0.0082326  | 0.0089704  | 0.0097545  |   0.5 |  0.01
Neigh   | 8.0447     | 10.476     | 11.619     |  38.2 |  6.16
Comm    | 4.0999     | 17.681     | 49.181     | 370.4 | 10.39
Output  | 0.0096989  | 0.011042   | 0.012371   |   0.8 |  0.01
Modify  | 12.541     | 13.71      | 16.16      |  33.5 |  8.06
Other   |            | 0.07963    |            |       |  0.05

Nlocal:          45.75 ave          52 max          41 min
Histogram: 1 3 0 0 1 0 0 2 0 1
Nghost:        3461.38 ave        3528 max        3388 min
Histogram: 2 0 0 0 1 1 2 0 0 2
Neighs:        31375.5 ave       35492 max       28468 min
Histogram: 1 3 0 0 1 0 1 1 0 1

Total # of neighbors = 251004
Ave neighs/atom = 685.80328
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.9031
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.139031 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.139031 yz delta 0.004371 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.8 | 133 | 135.4 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   307.28953     -44410.089     -8204.9606      1.8952586      3770.2978    
       100   298.62425     -44393.981     -10021.721      1.8946271      3771.5546    
       200   307.73709     -44386.091      2372.5964      1.893996       3772.8113    
       300   316.71521     -44378.834     -3227.044       1.8933653      3774.0681    
       400   314.83754     -44384.148      2838.9608      1.892735       3775.3249    
       500   287.28058     -44393.723      636.28039      1.8921051      3776.5816    
       600   295.04479     -44405.324     -7615.1542      1.8914757      3777.8384    
       700   305.89686     -44403.188     -3065.425       1.8908467      3779.0952    
       800   292.42404     -44368.6       -7136.2383      1.8902181      3780.3519    
       900   324.52676     -44384.801     -12368.902      1.8895899      3781.6087    
      1000   311.52841     -44389.266      1764.0456      1.8889621      3782.8655    
      1100   295.54897     -44405.467      2670.204       1.8883347      3784.1222    
      1200   281.89231     -44390.088     -3025.519       1.8877078      3785.379     
      1300   315.08475     -44406.151     -739.69057      1.8870813      3786.6358    
      1400   316.67774     -44397.198      2425.0799      1.8864552      3787.8925    
      1500   324.55234     -44389.768     -3891.225       1.8858295      3789.1493    
      1600   338.35012     -44410.317      1371.1934      1.8852042      3790.4061    
      1700   302.97785     -44406.868     -171.31197      1.8845794      3791.6628    
      1800   288.40247     -44403.278      8484.0234      1.8839549      3792.9196    
      1900   303.9416      -44413.62       7273.7801      1.8833309      3794.1764    
      2000   310.96591     -44399.945      4581.9022      1.8827073      3795.4331    
      2100   315.72153     -44386.229     -6268.6288      1.882084       3796.6899    
      2200   335.93684     -44423.26      -7159.7734      1.8814613      3797.9466    
      2300   290.95398     -44408.236      1671.1315      1.8808389      3799.2034    
      2400   293.19084     -44421.29      -4573.4887      1.8802169      3800.4602    
      2500   294.22938     -44409.51      -1540.7261      1.8795953      3801.7169    
      2600   294.68629     -44380.472     -1309.8738      1.8789742      3802.9737    
      2700   309.68392     -44397.629     -8206.55        1.8783535      3804.2305    
      2800   303.60464     -44391.32      -17656.345      1.8777331      3805.4872    
      2900   305.79037     -44402.259     -4727.2002      1.8771132      3806.744     
      3000   289.9569      -44399.238     -7395.8087      1.8764937      3808.0008    
Loop time of 166.247 on 8 procs for 3000 steps with 366 atoms

Performance: 0.780 ns/day, 30.786 hours/ns, 18.045 timesteps/s, 6.605 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 94.483     | 129.41     | 140.99     | 121.0 | 77.84
Bond    | 0.0078971  | 0.0088937  | 0.0094134  |   0.5 |  0.01
Neigh   | 7.9273     | 10.621     | 11.81      |  33.9 |  6.39
Comm    | 1.0432     | 12.616     | 47.533     | 387.3 |  7.59
Output  | 0.010243   | 0.011875   | 0.013619   |   1.0 |  0.01
Modify  | 12.282     | 13.492     | 16.211     |  30.4 |  8.12
Other   |            | 0.08253    |            |       |  0.05

Nlocal:          45.75 ave          51 max          37 min
Histogram: 1 0 0 0 1 1 2 0 1 2
Nghost:        3373.25 ave        3444 max        3301 min
Histogram: 1 0 1 2 0 0 2 1 0 1
Neighs:        30762.1 ave       34177 max       25077 min
Histogram: 1 0 0 0 2 0 2 0 1 2

Total # of neighbors = 246097
Ave neighs/atom = 672.39617
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.2465
variable dlen equal lz-${len0}
variable dlen equal lz-17.2465
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.2465
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.5839999999999996305, deltaxy = 0.07584
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.17780000000000001359, deltaxz = -0.001778
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43709999999999998854, deltayz = -0.004371
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -0.172465 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.8 | 133 | 135.4 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   307.28953     -44410.089     -8204.9606      1.8952586      3770.2978    
       100   298.6843      -44393.963     -10049.247      1.8958906      3769.041     
       200   308.64443     -44387.128      3658.229       1.896523       3767.7843    
       300   311.76139     -44373.868     -5134.6901      1.8971558      3766.5275    
       400   307.69871     -44379.527      4338.8266      1.897789       3765.2707    
       500   303.59814     -44413.68       8519.5945      1.8984227      3764.014     
       600   283.75809     -44401.129     -11675.258      1.8990568      3762.7572    
       700   301.5325      -44415.698     -8208.7719      1.8996913      3761.5004    
       800   307.32588     -44407.706     -12483.357      1.9003262      3760.2437    
       900   321.07174     -44393.146     -9092.0312      1.9009615      3758.9869    
      1000   305.28776     -44391.064      4718.1824      1.9015973      3757.7301    
      1100   282.37337     -44398.101      2971.6814      1.9022335      3756.4734    
      1200   290.31986     -44410.482     -8137.657       1.9028701      3755.2166    
      1300   297.25107     -44411.097     -5208.1417      1.9035072      3753.9598    
      1400   312.36668     -44411.751     -5345.8069      1.9041446      3752.7031    
      1500   317.373       -44396.494     -268.81834      1.9047826      3751.4463    
      1600   311.19243     -44397.581     -14930.764      1.9054209      3750.1895    
      1700   283.58103     -44410.492     -4805.5339      1.9060596      3748.9328    
      1800   278.38735     -44412.841     -9038.2185      1.9066988      3747.676     
      1900   293.27863     -44414.026     -13205.566      1.9073384      3746.4192    
      2000   303.69271     -44404.967     -5373.9706      1.9079785      3745.1625    
      2100   308.28616     -44395.958     -7603.4349      1.908619       3743.9057    
      2200   307.42965     -44388.364     -1347.0098      1.9092599      3742.6489    
      2300   318.94705     -44421.312      782.95494      1.9099012      3741.3922    
      2400   297.0053      -44430.197     -2933.3332      1.910543       3740.1354    
      2500   291.10701     -44427.545     -4745.9001      1.9111852      3738.8786    
      2600   298.71518     -44417.254     -21192.151      1.9118278      3737.6219    
      2700   314.57428     -44410.376     -2899.1492      1.9124709      3736.3651    
      2800   313.85699     -44415.624      900.65421      1.9131144      3735.1084    
      2900   303.72176     -44413.865     -10118.085      1.9137583      3733.8516    
      3000   291.17146     -44407.928     -2843.9234      1.9144027      3732.5948    
Loop time of 166.85 on 8 procs for 3000 steps with 366 atoms

Performance: 0.777 ns/day, 30.898 hours/ns, 17.980 timesteps/s, 6.581 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 96.89      | 132.62     | 140.98     | 119.2 | 79.48
Bond    | 0.0085729  | 0.0090705  | 0.0094719  |   0.3 |  0.01
Neigh   | 7.8831     | 10.706     | 11.456     |  33.1 |  6.42
Comm    | 2.0119     | 10.386     | 46.11      | 425.8 |  6.22
Output  | 0.010342   | 0.012167   | 0.013847   |   1.1 |  0.01
Modify  | 12.3       | 13.039     | 15.878     |  30.2 |  7.81
Other   |            | 0.07958    |            |       |  0.05

Nlocal:          45.75 ave          53 max          41 min
Histogram: 3 1 0 0 1 0 1 0 1 1
Nghost:        3449.88 ave        3516 max        3396 min
Histogram: 2 0 1 1 0 1 1 1 0 1
Neighs:        31395.6 ave       36197 max       28174 min
Histogram: 3 1 0 0 1 0 1 0 1 1

Total # of neighbors = 251165
Ave neighs/atom = 686.24317
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.2465
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 0.172465 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.8 | 133 | 135.4 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   307.28953     -44410.089     -8204.9606      1.8952586      3770.2978    
       100   298.6626      -44394.012     -10017.187      1.8946271      3771.5546    
       200   308.98581     -44388.335      1941.8023      1.893996       3772.8113    
       300   318.28896     -44381.809     -8269.7377      1.8933653      3774.0681    
       400   319.37516     -44387.789      1932.2916      1.892735       3775.3249    
       500   297.52233     -44404.398      6738.3843      1.8921051      3776.5816    
       600   286.37336     -44402.109     -3554.524       1.8914757      3777.8384    
       700   291.59938     -44398.742      8225.002       1.8908467      3779.0952    
       800   310.02817     -44401.021     -6834.4579      1.8902181      3780.3519    
       900   322.92896     -44390.966     -8503.8593      1.8895899      3781.6087    
      1000   310.44239     -44386.235     -2178.162       1.8889621      3782.8655    
      1100   288.54891     -44400.687      3385.4868      1.8883347      3784.1222    
      1200   295.16431     -44418.661     -5047.0689      1.8877078      3785.379     
      1300   274.17692     -44394.587     -13114.364      1.8870813      3786.6358    
      1400   316.36608     -44410.837     -10265.296      1.8864552      3787.8925    
      1500   324.67571     -44403.684     -8915.6558      1.8858295      3789.1493    
      1600   310.37859     -44394.857     -5338.4303      1.8852042      3790.4061    
      1700   305.71139     -44399.608     -4505.3655      1.8845794      3791.6628    
      1800   288.85348     -44390.237     -3745.8126      1.8839549      3792.9196    
      1900   277.1651      -44387.628     -10840.051      1.8833309      3794.1764    
      2000   275.87435     -44393.965     -300.8685       1.8827073      3795.4331    
      2100   316.05969     -44432.591     -905.1371       1.882084       3796.6899    
      2200   303.61958     -44395.018     -1578.0729      1.8814613      3797.9466    
      2300   301.73329     -44378.136      8493.9986      1.8808389      3799.2034    
      2400   302.19555     -44389.749     -4099.1011      1.8802169      3800.4602    
      2500   304.44234     -44427.556     -16506.361      1.8795953      3801.7169    
      2600   277.45416     -44398.35      -4650.5592      1.8789742      3802.9737    
      2700   287.30614     -44395.834     -2934.7321      1.8783535      3804.2305    
      2800   307.08674     -44406.966     -575.27994      1.8777331      3805.4872    
      2900   316.28931     -44402.494     -3473.2475      1.8771132      3806.744     
      3000   314.61119     -44375.998      2120.576       1.8764937      3808.0008    
Loop time of 164.881 on 8 procs for 3000 steps with 366 atoms

Performance: 0.786 ns/day, 30.533 hours/ns, 18.195 timesteps/s, 6.659 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 95.695     | 131.19     | 139.56     | 118.9 | 79.57
Bond    | 0.0085736  | 0.0090207  | 0.0094724  |   0.3 |  0.01
Neigh   | 7.8369     | 10.671     | 11.421     |  33.5 |  6.47
Comm    | 1.645      | 10.027     | 45.519     | 430.0 |  6.08
Output  | 0.0098457  | 0.011241   | 0.012592   |   0.9 |  0.01
Modify  | 12.149     | 12.89      | 15.741     |  30.6 |  7.82
Other   |            | 0.07954    |            |       |  0.05

Nlocal:          45.75 ave          51 max          41 min
Histogram: 1 1 1 1 0 1 0 1 0 2
Nghost:        3386.25 ave        3448 max        3325 min
Histogram: 1 0 1 2 0 0 2 1 0 1
Neighs:        30758.5 ave       34085 max       27654 min
Histogram: 1 1 1 1 0 1 1 0 0 2

Total # of neighbors = 246068
Ave neighs/atom = 672.31694
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 15.724
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.4371)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.724
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.5839999999999996305, deltaxy = 0.07584
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.17780000000000001359, deltaxz = -0.001778
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43709999999999998854, deltayz = -0.004371
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -0.15724 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.8 | 133 | 135.4 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   307.28953     -44410.089     -8204.9606      1.8952586      3770.2978    
       100   298.68982     -44393.995     -10025.109      1.8952586      3770.2978    
       200   308.53095     -44387.665      2886.7574      1.8952586      3770.2978    
       300   312.74298     -44374.771     -6847.6309      1.8952586      3770.2978    
       400   309.95656     -44377.762      2103.3808      1.8952586      3770.2978    
       500   295.54513     -44403.048      4837.7601      1.8952586      3770.2978    
       600   279.27215     -44394.78      -2854.2038      1.8952586      3770.2978    
       700   309.85392     -44416.329     -2625.6786      1.8952586      3770.2978    
       800   298.69394     -44385.639     -8300.7138      1.8952586      3770.2978    
       900   309.44771     -44373.205     -2934.1844      1.8952586      3770.2978    
      1000   307.37079     -44388.4        14876.772      1.8952586      3770.2978    
      1100   285.97765     -44401.15       9474.16        1.8952586      3770.2978    
      1200   292.89846     -44413.847      11196.357      1.8952586      3770.2978    
      1300   293.28849     -44410.428      10439.331      1.8952586      3770.2978    
      1400   301.8533      -44392.281     -7893.114       1.8952586      3770.2978    
      1500   338.70504     -44415.784      3977.2662      1.8952586      3770.2978    
      1600   278.5584      -44367.315     -10080.783      1.8952586      3770.2978    
      1700   320.70466     -44434.302      3668.7041      1.8952586      3770.2978    
      1800   273.98229     -44418.946      10526.276      1.8952586      3770.2978    
      1900   272.56063     -44431.195      2163.5081      1.8952586      3770.2978    
      2000   275.22546     -44415.419      3773.6762      1.8952586      3770.2978    
      2100   294.80706     -44402.36      -6163.0682      1.8952586      3770.2978    
      2200   317.66459     -44401.418     -5777.9244      1.8952586      3770.2978    
      2300   314.82241     -44406.335     -1391.6617      1.8952586      3770.2978    
      2400   304.88639     -44419.806      6474.3113      1.8952586      3770.2978    
      2500   303.02267     -44428.276     -4906.2013      1.8952586      3770.2978    
      2600   281.83476     -44409.877     -3348.2946      1.8952586      3770.2978    
      2700   300.79785     -44404.737     -7631.6981      1.8952586      3770.2978    
      2800   300.81698     -44381.455     -13687.688      1.8952586      3770.2978    
      2900   292.51827     -44378.173     -1332.2199      1.8952586      3770.2978    
      3000   285.72049     -44393.561     -11614.657      1.8952586      3770.2978    
Loop time of 165.637 on 8 procs for 3000 steps with 366 atoms

Performance: 0.782 ns/day, 30.673 hours/ns, 18.112 timesteps/s, 6.629 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 95.677     | 124.59     | 140.58     | 159.1 | 75.22
Bond    | 0.0084233  | 0.0090447  | 0.0095661  |   0.3 |  0.01
Neigh   | 7.847      | 10.152     | 11.48      |  45.2 |  6.13
Comm    | 1.6897     | 17.693     | 46.592     | 422.2 | 10.68
Output  | 0.0096811  | 0.011062   | 0.012399   |   0.9 |  0.01
Modify  | 11.779     | 13.106     | 15.432     |  40.1 |  7.91
Other   |            | 0.07675    |            |       |  0.05

Nlocal:          45.75 ave          53 max          39 min
Histogram: 1 0 2 1 0 2 0 0 1 1
Nghost:        3432.25 ave        3516 max        3355 min
Histogram: 1 1 1 1 0 1 0 2 0 1
Neighs:        31020.8 ave       35685 max       26738 min
Histogram: 1 1 1 1 0 1 1 0 1 1

Total # of neighbors = 248166
Ave neighs/atom = 678.04918
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.724
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 0.15724 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.8 | 133 | 135.4 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   307.28953     -44410.089     -8204.9606      1.8952586      3770.2978    
       100   298.66407     -44393.98      -10047.729      1.8952586      3770.2978    
       200   309.25344     -44387.979      2988.9188      1.8952586      3770.2978    
       300   312.92557     -44376.068     -6120.1362      1.8952586      3770.2978    
       400   318.11972     -44390.008      6287.6063      1.8952586      3770.2978    
       500   289.7001      -44398.742      9025.395       1.8952586      3770.2978    
       600   285.50351     -44400.702     -10715.571      1.8952586      3770.2978    
       700   302.04815     -44412.365     -6188.9249      1.8952586      3770.2978    
       800   298.63712     -44387.033     -4615.6613      1.8952586      3770.2978    
       900   311.65215     -44374.666     -9210.1405      1.8952586      3770.2978    
      1000   327.15073     -44413.128      2265.9058      1.8952586      3770.2978    
      1100   304.50066     -44404.542      1077.1363      1.8952586      3770.2978    
      1200   294.25212     -44414.084      1955.3478      1.8952586      3770.2978    
      1300   292.96065     -44428.44      -1134.3326      1.8952586      3770.2978    
      1400   300.97194     -44426.278      5289.7362      1.8952586      3770.2978    
      1500   312.84719     -44407.803     -9531.7323      1.8952586      3770.2978    
      1600   319.40342     -44398.946     -531.51543      1.8952586      3770.2978    
      1700   298.18336     -44387.036      7460.0886      1.8952586      3770.2978    
      1800   299.80127     -44406.922     -9178.4002      1.8952586      3770.2978    
      1900   298.61101     -44417.234     -12645.863      1.8952586      3770.2978    
      2000   308.84176     -44432.199     -6366.336       1.8952586      3770.2978    
      2100   306.47668     -44413.515     -16231.324      1.8952586      3770.2978    
      2200   325.98122     -44406.609      2060.9247      1.8952586      3770.2978    
      2300   299.66516     -44393.602      2674.7982      1.8952586      3770.2978    
      2400   286.98044     -44405.59      -4252.207       1.8952586      3770.2978    
      2500   286.40681     -44408.229     -16458.417      1.8952586      3770.2978    
      2600   292.56132     -44405.894     -9058.2514      1.8952586      3770.2978    
      2700   309.61372     -44399.732     -24865.379      1.8952586      3770.2978    
      2800   315.90476     -44378.56      -12848.342      1.8952586      3770.2978    
      2900   317.75334     -44376.63      -4728.047       1.8952586      3770.2978    
      3000   302.15844     -44398.997      348.96434      1.8952586      3770.2978    
Loop time of 157.58 on 8 procs for 3000 steps with 366 atoms

Performance: 0.822 ns/day, 29.181 hours/ns, 19.038 timesteps/s, 6.968 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 92.487     | 112.58     | 133.22     | 128.1 | 71.44
Bond    | 0.0080379  | 0.0083653  | 0.0085793  |   0.2 |  0.01
Neigh   | 7.9289     | 9.6666     | 11.415     |  37.4 |  6.13
Comm    | 1.1942     | 21.849     | 41.935     | 290.8 | 13.87
Output  | 0.0086284  | 0.0097879  | 0.010855   |   0.8 |  0.01
Modify  | 11.655     | 13.396     | 15.143     |  31.9 |  8.50
Other   |            | 0.07265    |            |       |  0.05

Nlocal:          45.75 ave          53 max          39 min
Histogram: 1 0 3 0 1 0 0 0 1 2
Nghost:        3432.75 ave        3496 max        3367 min
Histogram: 1 0 2 1 0 0 1 2 0 1
Neighs:        31045.9 ave       35632 max       26675 min
Histogram: 1 0 3 0 1 0 0 0 1 2

Total # of neighbors = 248367
Ave neighs/atom = 678.59836
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.9031
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-0.1778)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.9031
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.5839999999999996305, deltaxy = 0.07584
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.17780000000000001359, deltaxz = -0.001778
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43709999999999998854, deltayz = -0.004371
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -0.139031 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.8 | 133 | 135.4 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   307.28953     -44410.089     -8204.9606      1.8952586      3770.2978    
       100   298.70061     -44394.02      -10041.394      1.8952586      3770.2978    
       200   309.03313     -44388.198      3050.6502      1.8952586      3770.2978    
       300   313.33932     -44376.07      -5329.1745      1.8952586      3770.2978    
       400   306.30461     -44373.831      2257.7509      1.8952586      3770.2978    
       500   305.70754     -44414.169      8756.6483      1.8952586      3770.2978    
       600   278.32453     -44392.69      -3135.2723      1.8952586      3770.2978    
       700   307.18486     -44409.35       679.08207      1.8952586      3770.2978    
       800   301.18925     -44390.119     -6032.7645      1.8952586      3770.2978    
       900   320.8778      -44389.95      -4053.5796      1.8952586      3770.2978    
      1000   295.09803     -44362.504     -3451.8745      1.8952586      3770.2978    
      1100   299.89664     -44405.251      7518.4221      1.8952586      3770.2978    
      1200   303.84247     -44423.544     -1728.8864      1.8952586      3770.2978    
      1300   293.12649     -44409.08       1186.4298      1.8952586      3770.2978    
      1400   309.35498     -44397.909     -5107.2307      1.8952586      3770.2978    
      1500   306.84843     -44384.611     -7905.6623      1.8952586      3770.2978    
      1600   312.68003     -44393.42       3155.3065      1.8952586      3770.2978    
      1700   302.38004     -44389.715      3750.1294      1.8952586      3770.2978    
      1800   293.70333     -44385.894      1507.3711      1.8952586      3770.2978    
      1900   296.19808     -44402.901     -7495.0768      1.8952586      3770.2978    
      2000   276.87435     -44394.232     -7406.4697      1.8952586      3770.2978    
      2100   284.4621      -44409.726     -11988.836      1.8952586      3770.2978    
      2200   316.18767     -44429.299     -194.73461      1.8952586      3770.2978    
      2300   299.88701     -44390.689      192.04893      1.8952586      3770.2978    
      2400   305.61204     -44394.732      5422.541       1.8952586      3770.2978    
      2500   310.60913     -44427.929     -5444.8579      1.8952586      3770.2978    
      2600   287.91049     -44428.282     -122.83631      1.8952586      3770.2978    
      2700   298.3268      -44430.98      -7961.8917      1.8952586      3770.2978    
      2800   284.47971     -44398.675      4309.0813      1.8952586      3770.2978    
      2900   303.43124     -44397.908     -6063.0014      1.8952586      3770.2978    
      3000   300.28247     -44391.836      8057.6442      1.8952586      3770.2978    
Loop time of 115.66 on 8 procs for 3000 steps with 366 atoms

Performance: 1.121 ns/day, 21.418 hours/ns, 25.938 timesteps/s, 9.493 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 82.539     | 85.614     | 95.649     |  42.9 | 74.02
Bond    | 0.006919   | 0.0075463  | 0.0081425  |   0.4 |  0.01
Neigh   | 7.7259     | 8.0134     | 8.9903     |  13.3 |  6.93
Comm    | 1.4471     | 11.492     | 14.574     | 117.4 |  9.94
Output  | 0.0063111  | 0.0073507  | 0.0083189  |   0.8 |  0.01
Modify  | 9.4856     | 10.456     | 10.737     |  11.6 |  9.04
Other   |            | 0.06971    |            |       |  0.06

Nlocal:          45.75 ave          52 max          37 min
Histogram: 1 0 1 1 0 1 1 0 0 3
Nghost:        3407.88 ave        3468 max        3354 min
Histogram: 1 1 1 1 0 0 2 1 0 1
Neighs:        31051.4 ave       35157 max       25400 min
Histogram: 1 0 1 1 0 1 1 0 0 3

Total # of neighbors = 248411
Ave neighs/atom = 678.71858
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.9031
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 0.139031 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.8 | 133 | 135.4 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   307.28953     -44410.089     -8204.9606      1.8952586      3770.2978    
       100   298.65313     -44393.957     -10020.384      1.8952586      3770.2978    
       200   308.72168     -44387.525      2693.1215      1.8952586      3770.2978    
       300   313.6538      -44376.018     -6943.4002      1.8952586      3770.2978    
       400   306.50493     -44374.04       751.93848      1.8952586      3770.2978    
       500   301.38154     -44408.047      8980.0174      1.8952586      3770.2978    
       600   278.94637     -44393.121     -933.27581      1.8952586      3770.2978    
       700   301.41901     -44407.209      3488.9628      1.8952586      3770.2978    
       800   316.28235     -44404.53      -1512.7044      1.8952586      3770.2978    
       900   324.27329     -44389.053     -7760.3613      1.8952586      3770.2978    
      1000   314.74209     -44388.022      7685.3184      1.8952586      3770.2978    
      1100   292.70784     -44401.331     -3790.8833      1.8952586      3770.2978    
      1200   295.03828     -44413.254      7469.7961      1.8952586      3770.2978    
      1300   296.77294     -44413.324     -823.10211      1.8952586      3770.2978    
      1400   315.85752     -44409.123     -12659.647      1.8952586      3770.2978    
      1500   330.51882     -44400.837      2168.263       1.8952586      3770.2978    
      1600   310.66979     -44391.793     -8453.6488      1.8952586      3770.2978    
      1700   307.52182     -44415.441     -10502.135      1.8952586      3770.2978    
      1800   317.26614     -44430.542     -5849.9582      1.8952586      3770.2978    
      1900   293.82239     -44402.238      555.79734      1.8952586      3770.2978    
      2000   303.89068     -44398.425      2100.5664      1.8952586      3770.2978    
      2100   312.96556     -44394.632     -5019.4318      1.8952586      3770.2978    
      2200   319.00523     -44408.73      -3406.4629      1.8952586      3770.2978    
      2300   300.67573     -44423.24       1572.5484      1.8952586      3770.2978    
      2400   297.26067     -44430.361     -1671.636       1.8952586      3770.2978    
      2500   282.52757     -44404.371     -7484.6541      1.8952586      3770.2978    
      2600   323.24749     -44415.614     -4557.9593      1.8952586      3770.2978    
      2700   327.10582     -44418.243     -6752.0305      1.8952586      3770.2978    
      2800   285.2117      -44386.586     -925.13072      1.8952586      3770.2978    
      2900   282.33864     -44393.006      2634.2189      1.8952586      3770.2978    
      3000   299.86506     -44414.396     -6722.7012      1.8952586      3770.2978    
Loop time of 96.1352 on 8 procs for 3000 steps with 366 atoms

Performance: 1.348 ns/day, 17.803 hours/ns, 31.206 timesteps/s, 11.421 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 73.927     | 76.392     | 78.32      |  16.3 | 79.46
Bond    | 0.0061295  | 0.0065886  | 0.007176   |   0.4 |  0.01
Neigh   | 7.7165     | 7.9048     | 8.0808     |   3.7 |  8.22
Comm    | 0.8678     | 2.8023     | 5.2705     |  85.2 |  2.91
Output  | 0.0055611  | 0.0065582  | 0.0074146  |   0.8 |  0.01
Modify  | 8.7835     | 8.9533     | 9.1393     |   3.5 |  9.31
Other   |            | 0.0693     |            |       |  0.07

Nlocal:          45.75 ave          52 max          39 min
Histogram: 1 1 1 0 1 0 1 1 0 2
Nghost:        3429.38 ave        3502 max        3362 min
Histogram: 1 0 2 1 0 0 2 1 0 1
Neighs:        31030.2 ave       35196 max       26695 min
Histogram: 1 1 1 0 1 0 1 1 1 1

Total # of neighbors = 248242
Ave neighs/atom = 678.25683
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.2465
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--7.584)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.2465
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.5839999999999996305, deltaxy = 0.07584
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.17780000000000001359, deltaxz = -0.001778
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43709999999999998854, deltayz = -0.004371
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -0.172465 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.8 | 133 | 135.4 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   307.28953     -44410.089     -8204.9606      1.8952586      3770.2978    
       100   298.65457     -44394.019     -10038.128      1.8952586      3770.2978    
       200   309.41452     -44388.874      2541.0356      1.8952586      3770.2978    
       300   312.55749     -44375.149     -6314.7478      1.8952586      3770.2978    
       400   315.23657     -44383.787     -303.09056      1.8952586      3770.2978    
       500   304.28523     -44410.291     -1960.8714      1.8952586      3770.2978    
       600   285.8591      -44401.507     -1572.0986      1.8952586      3770.2978    
       700   307.14172     -44411.3       -5455.048       1.8952586      3770.2978    
       800   304.00573     -44387.258     -1332.9932      1.8952586      3770.2978    
       900   292.81318     -44361.524     -7066.684       1.8952586      3770.2978    
      1000   303.93656     -44416.385      12789.893      1.8952586      3770.2978    
      1100   291.40519     -44416.207      5170.51        1.8952586      3770.2978    
      1200   286.30233     -44394.865     -3196.6852      1.8952586      3770.2978    
      1300   303.03796     -44389.479     -6769.9672      1.8952586      3770.2978    
      1400   298.89901     -44392.255     -11624.023      1.8952586      3770.2978    
      1500   305.3799      -44422.372      3038.1406      1.8952586      3770.2978    
      1600   281.51144     -44423.651     -6312.2003      1.8952586      3770.2978    
      1700   272.41098     -44434.334      1637.3135      1.8952586      3770.2978    
      1800   269.70937     -44417.149      578.48         1.8952586      3770.2978    
      1900   313.09109     -44425.394     -3671.9762      1.8952586      3770.2978    
      2000   306.67445     -44403.319     -6976.4677      1.8952586      3770.2978    
      2100   306.4964      -44397.518      796.70353      1.8952586      3770.2978    
      2200   304.96982     -44406.411      1543.7055      1.8952586      3770.2978    
      2300   294.50202     -44423.795     -2287.0054      1.8952586      3770.2978    
      2400   297.06929     -44431.42      -1339.3027      1.8952586      3770.2978    
      2500   281.73374     -44399.2       -1688.6796      1.8952586      3770.2978    
      2600   302.07304     -44404.615      3542.8273      1.8952586      3770.2978    
      2700   298.51801     -44399.508     -4699.2378      1.8952586      3770.2978    
      2800   303.33852     -44400.931     -1253.5985      1.8952586      3770.2978    
      2900   307.1776      -44400.704     -4227.4679      1.8952586      3770.2978    
      3000   304.05255     -44408.414     -1797.2309      1.8952586      3770.2978    
Loop time of 95.9389 on 8 procs for 3000 steps with 366 atoms

Performance: 1.351 ns/day, 17.766 hours/ns, 31.270 timesteps/s, 11.445 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 73.003     | 76.245     | 78.175     |  18.4 | 79.47
Bond    | 0.0061311  | 0.0067249  | 0.0073359  |   0.5 |  0.01
Neigh   | 7.7097     | 7.9126     | 8.0995     |   4.2 |  8.25
Comm    | 0.80383    | 2.7419     | 5.9875     |  97.0 |  2.86
Output  | 0.0056007  | 0.0066313  | 0.0074946  |   0.8 |  0.01
Modify  | 8.7789     | 8.9585     | 9.158      |   3.9 |  9.34
Other   |            | 0.06775    |            |       |  0.07

Nlocal:          45.75 ave          53 max          39 min
Histogram: 1 1 0 0 2 2 0 1 0 1
Nghost:           3418 ave        3485 max        3348 min
Histogram: 2 0 0 1 0 2 0 1 1 1
Neighs:        31041.4 ave       35487 max       26732 min
Histogram: 1 1 0 0 2 1 1 1 0 1

Total # of neighbors = 248331
Ave neighs/atom = 678.5
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.2465
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 0.172465 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.8 | 133 | 135.4 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   307.28953     -44410.089     -8204.9606      1.8952586      3770.2978    
       100   298.69076     -44393.973     -10028.17       1.8952586      3770.2978    
       200   308.74903     -44387.104      2903.7726      1.8952586      3770.2978    
       300   317.58845     -44379.863     -7839.8204      1.8952586      3770.2978    
       400   306.2266      -44374.8        8082.0671      1.8952586      3770.2978    
       500   313.64563     -44422.79       2154.7417      1.8952586      3770.2978    
       600   281.92533     -44396.434     -7719.649       1.8952586      3770.2978    
       700   306.07544     -44414.389      6085.8242      1.8952586      3770.2978    
       800   306.94029     -44400.792      139.3326       1.8952586      3770.2978    
       900   301.47426     -44366.177     -10843.114      1.8952586      3770.2978    
      1000   326.59923     -44391.324     -4626.3583      1.8952586      3770.2978    
      1100   288.15379     -44390.056      445.54166      1.8952586      3770.2978    
      1200   295.95817     -44411.146     -5068.6707      1.8952586      3770.2978    
      1300   299.69093     -44415.656      309.14144      1.8952586      3770.2978    
      1400   303.00165     -44403.242     -12165.75       1.8952586      3770.2978    
      1500   308.64604     -44381.441     -3919.0686      1.8952586      3770.2978    
      1600   313.02019     -44385.854     -13571.191      1.8952586      3770.2978    
      1700   294.27161     -44410.835     -9898.2527      1.8952586      3770.2978    
      1800   292.29586     -44416.285     -3812.8551      1.8952586      3770.2978    
      1900   300.71253     -44420.05      -10431.711      1.8952586      3770.2978    
      2000   294.16457     -44399.07      -14416.071      1.8952586      3770.2978    
      2100   311.84373     -44396.05      -8514.4017      1.8952586      3770.2978    
      2200   317.75763     -44390.218     -807.18736      1.8952586      3770.2978    
      2300   302.20597     -44412.677     -9475.627       1.8952586      3770.2978    
      2400   301.76515     -44428.509      1589.8465      1.8952586      3770.2978    
      2500   284.8687      -44410.63      -7852.4706      1.8952586      3770.2978    
      2600   309.23566     -44419.364     -6537.7018      1.8952586      3770.2978    
      2700   306.21375     -44396.313     -489.71933      1.8952586      3770.2978    
      2800   317.37905     -44397.773     -4107.3542      1.8952586      3770.2978    
      2900   319.89793     -44429.975      1407.2406      1.8952586      3770.2978    
      3000   280.41653     -44411.632     -8327.9944      1.8952586      3770.2978    
Loop time of 95.9205 on 8 procs for 3000 steps with 366 atoms

Performance: 1.351 ns/day, 17.763 hours/ns, 31.276 timesteps/s, 11.447 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 72.63      | 75.883     | 77.783     |  17.8 | 79.11
Bond    | 0.0059361  | 0.0065734  | 0.007063   |   0.4 |  0.01
Neigh   | 7.6861     | 7.88       | 8.065      |   3.9 |  8.22
Comm    | 1.0615     | 2.9742     | 6.2374     |  90.2 |  3.10
Output  | 0.0055528  | 0.0065428  | 0.0074053  |   0.7 |  0.01
Modify  | 8.9282     | 9.1009     | 9.286      |   3.5 |  9.49
Other   |            | 0.06907    |            |       |  0.07

Nlocal:          45.75 ave          52 max          39 min
Histogram: 1 1 0 1 1 1 0 1 0 2
Nghost:        3409.12 ave        3481 max        3344 min
Histogram: 1 0 2 1 0 1 1 1 0 1
Neighs:        31075.2 ave       35051 max       26696 min
Histogram: 1 1 1 0 1 1 0 1 0 2

Total # of neighbors = 248602
Ave neighs/atom = 679.24044
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:31:37
