LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.1                  # the deformation magnitude 0.01

# Read the initial sctructure
# box tilt large
variable structure string 333-HD-100C-14-VASP
read_data       ${structure}.data
read_data       333-HD-100C-14-VASP.data
Reading data file ...
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.006 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 6.07595e-05 on 8 procs for 1 steps with 366 atoms

45.7% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.48e-07   | 1.8375e-07 | 2.08e-07   |   0.0 |  0.30
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 9.56e-07   | 1.8599e-06 | 6.764e-06  |   0.0 |  3.06
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 5.872e-05  |            |       | 96.64

Nlocal:          45.75 ave          50 max          38 min
Histogram: 1 0 0 0 0 2 1 1 1 2
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-HD-100C-14-VASP_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 5000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -29.52 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 131.2 | 133.5 | 136.5 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -43579.409      43399.428      1.8952586      3770.2978    
       100   501.31721     -43951.858     -5482.4294      1.8952586      3770.2978    
       200   461.37543     -44118.279      675.39958      1.8952586      3770.2978    
       300   358.21729     -44182.519     -4611.4587      1.8952586      3770.2978    
       400   342.69982     -44289.858     -10505.098      1.8952586      3770.2978    
       500   304.71689     -44336.453     -6863.721       1.8952586      3770.2978    
       600   277.61747     -44349.561      2371.2463      1.8952586      3770.2978    
       700   295.18902     -44362.622      215.76326      1.8952586      3770.2978    
       800   296.96454     -44334.344     -5171.6613      1.8952586      3770.2978    
       900   313.88552     -44330.146     -5703.9153      1.8952586      3770.2978    
      1000   303.04307     -44335.255     -927.32497      1.8952586      3770.2978    
      1100   290.28149     -44359.779     -14836.59       1.8952586      3770.2978    
      1200   265.90356     -44358.295     -10226.493      1.8952586      3770.2978    
      1300   282.41574     -44365.098     -5322.3059      1.8952586      3770.2978    
      1400   305.39048     -44359.171     -4136.1052      1.8952586      3770.2978    
      1500   313.51829     -44351.056      1748.3585      1.8952586      3770.2978    
      1600   309.16666     -44349.003     -3166.2655      1.8952586      3770.2978    
      1700   298.04054     -44359.319      3531.2606      1.8952586      3770.2978    
      1800   283.38286     -44366.171      4082.6337      1.8952586      3770.2978    
      1900   285.72907     -44373.574     -6905.8815      1.8952586      3770.2978    
      2000   291.16103     -44361.115     -10861.002      1.8952586      3770.2978    
      2100   312.15439     -44364.437     -17503.903      1.8952586      3770.2978    
      2200   309.5297      -44368.589     -4466.5763      1.8952586      3770.2978    
      2300   292.16701     -44375.512      4594.1211      1.8952586      3770.2978    
      2400   287.65004     -44385.544      2441.7332      1.8952586      3770.2978    
      2500   275.8479      -44364.562     -5702.8855      1.8952586      3770.2978    
      2600   301.62039     -44377.579     -10193.809      1.8952586      3770.2978    
      2700   309.51785     -44382.15      -579.03466      1.8952586      3770.2978    
      2800   287.35727     -44372.082      3941.7641      1.8952586      3770.2978    
      2900   290.06265     -44386.712     -3174.9246      1.8952586      3770.2978    
      3000   307.28953     -44410.088     -8204.6987      1.8952586      3770.2978    
      3100   298.6791      -44393.991     -10027.254      1.8952586      3770.2978    
      3200   308.86366     -44387.786      2918.4398      1.8952586      3770.2978    
      3300   313.51166     -44376.238     -5789.8157      1.8952586      3770.2978    
      3400   311.56426     -44380.152      3094.0511      1.8952586      3770.2978    
      3500   302.39599     -44410.762      11718.017      1.8952586      3770.2978    
      3600   275.01119     -44390.062     -812.4305       1.8952586      3770.2978    
      3700   300.36938     -44405.204      1486.0412      1.8952586      3770.2978    
      3800   317.55279     -44401.165     -11614.927      1.8952586      3770.2978    
      3900   309.82914     -44389.655     -852.53962      1.8952586      3770.2978    
      4000   299.46771     -44423.935      3496.0927      1.8952586      3770.2978    
      4100   296.82809     -44424.042     -39.165496      1.8952586      3770.2978    
      4200   303.69164     -44413.851     -6084.786       1.8952586      3770.2978    
      4300   301.85504     -44396.831     -7523.8664      1.8952586      3770.2978    
      4400   324.85813     -44414.476     -4386.1599      1.8952586      3770.2978    
      4500   307.37604     -44418.851     -9997.7426      1.8952586      3770.2978    
      4600   300.21666     -44437.099      980.46608      1.8952586      3770.2978    
      4700   296.26633     -44427.675      1577.6979      1.8952586      3770.2978    
      4800   309.18573     -44418.812     -6228.8239      1.8952586      3770.2978    
      4900   317.26467     -44410.722      406.29778      1.8952586      3770.2978    
      5000   313.86144     -44406.269      4512.9579      1.8952586      3770.2978    
Loop time of 278.089 on 8 procs for 5000 steps with 366 atoms

Performance: 0.777 ns/day, 30.899 hours/ns, 17.980 timesteps/s, 6.581 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 216.96     | 228.4      | 234.36     |  36.1 | 82.13
Bond    | 0.0017266  | 0.0020632  | 0.0024729  |   0.5 |  0.00
Neigh   | 18.113     | 18.835     | 19.753     |  10.8 |  6.77
Comm    | 3.6649     | 9.6478     | 21.089     | 176.1 |  3.47
Output  | 0.0032605  | 0.0035302  | 0.0050572  |   1.0 |  0.00
Modify  | 20.151     | 21.084     | 21.802     |  10.3 |  7.58
Other   |            | 0.1123     |            |       |  0.04

Nlocal:          45.75 ave          52 max          38 min
Histogram: 1 0 1 1 0 2 0 0 0 3
Nghost:        3410.62 ave        3482 max        3341 min
Histogram: 1 0 2 1 0 0 1 2 0 1
Neighs:        31038.1 ave       34881 max       26097 min
Histogram: 1 0 1 1 1 1 0 0 0 3

Total # of neighbors = 248305
Ave neighs/atom = 678.42896
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333-HD-100C-14-VASP_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.724
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.9031
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.2465

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.4371
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 0.1778
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -7.584

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 15.724
variable dlen equal lx-${len0}
variable dlen equal lx-15.724
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*15.724
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.5839999999999996305, deltaxy = 0.7584
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.17780000000000001359, deltaxz = -0.01778
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43709999999999998854, deltayz = -0.04371
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.5724 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.5724 xy delta 0.7584 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.5724 xy delta 0.7584 xz delta -0.01778 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130 | 132.6 | 135.4 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   313.86144     -44406.269      4512.7738      3770.2978      15.724         13.9031        17.2465      
       100   297.43593     -44418.125     -4357.7326      3762.7572      15.692552      13.9031        17.2465      
       200   290.2867      -44430.081     -9038.2577      3755.2166      15.661104      13.9031        17.2465      
       300   302.03319     -44438.889     -789.67015      3747.676       15.629656      13.9031        17.2465      
       400   300.11409     -44426.114     -413.02816      3740.1354      15.598208      13.9031        17.2465      
       500   318.20774     -44416.691     -5374.7664      3732.5948      15.56676       13.9031        17.2465      
       600   321.66094     -44407.723      9203.7625      3725.0542      15.535312      13.9031        17.2465      
       700   315.70874     -44431.688      5307.8035      3717.5136      15.503864      13.9031        17.2465      
       800   282.28162     -44399.923      3488.5055      3709.973       15.472416      13.9031        17.2465      
       900   283.13281     -44399.894      3725.6191      3702.4324      15.440968      13.9031        17.2465      
      1000   303.15536     -44429.439      9924.5136      3694.8918      15.40952       13.9031        17.2465      
      1100   294.97183     -44434.247      4953.1393      3687.3512      15.378072      13.9031        17.2465      
      1200   274.53216     -44422.025      6064.5294      3679.8107      15.346624      13.9031        17.2465      
      1300   278.87138     -44408.821      6474.483       3672.2701      15.315176      13.9031        17.2465      
      1400   329.4473      -44418.376      12370.634      3664.7295      15.283728      13.9031        17.2465      
      1500   325.14168     -44417.663      5034.8276      3657.1889      15.25228       13.9031        17.2465      
      1600   300.47157     -44418.166      9104.871       3649.6483      15.220832      13.9031        17.2465      
      1700   289.69007     -44411.607      5336.2032      3642.1077      15.189384      13.9031        17.2465      
      1800   305.22941     -44422.3        11631.828      3634.5671      15.157936      13.9031        17.2465      
      1900   290.16469     -44421.654      11517.926      3627.0265      15.126488      13.9031        17.2465      
      2000   285.62019     -44442.656      14658.528      3619.4859      15.09504       13.9031        17.2465      
      2100   273.14981     -44428.085      10090.162      3611.9453      15.063592      13.9031        17.2465      
      2200   317.95596     -44433.197      10812.69       3604.4047      15.032144      13.9031        17.2465      
      2300   308.56889     -44398.528      22770.075      3596.8641      15.000696      13.9031        17.2465      
      2400   314.03463     -44409.364      27934.267      3589.3235      14.969248      13.9031        17.2465      
      2500   316.1343      -44432.182      22771.225      3581.7829      14.9378        13.9031        17.2465      
      2600   285.41041     -44406.371      24343.553      3574.2423      14.906352      13.9031        17.2465      
      2700   303.00653     -44415.709      21238.973      3566.7017      14.874904      13.9031        17.2465      
      2800   277.39683     -44384.544      13515.3        3559.1611      14.843456      13.9031        17.2465      
      2900   290.17932     -44411.855      24926.612      3551.6205      14.812008      13.9031        17.2465      
      3000   286.80723     -44413.214      24616.556      3544.0799      14.78056       13.9031        17.2465      
      3100   295.66168     -44397.341      24169.022      3536.5393      14.749112      13.9031        17.2465      
      3200   323.52899     -44390.49       37223.742      3528.9987      14.717664      13.9031        17.2465      
      3300   320.1695      -44382.855      22508.255      3521.4581      14.686216      13.9031        17.2465      
      3400   304.22466     -44366.411      31961.969      3513.9175      14.654768      13.9031        17.2465      
      3500   319.41747     -44376.314      38854.999      3506.377       14.62332       13.9031        17.2465      
      3600   303.09295     -44362.726      30282.019      3498.8364      14.591872      13.9031        17.2465      
      3700   296.53899     -44368.494      22273.325      3491.2958      14.560424      13.9031        17.2465      
      3800   318.98657     -44393.565      38881.884      3483.7552      14.528976      13.9031        17.2465      
      3900   300.81437     -44380.478      39404.558      3476.2146      14.497528      13.9031        17.2465      
      4000   274.83421     -44380.993      40292.003      3468.674       14.46608       13.9031        17.2465      
      4100   270.92692     -44368.246      43286.403      3461.1334      14.434632      13.9031        17.2465      
      4200   304.55891     -44370.781      42912.228      3453.5928      14.403184      13.9031        17.2465      
      4300   314.10831     -44353.803      52389.994      3446.0522      14.371736      13.9031        17.2465      
      4400   304.81723     -44320.022      37695.761      3438.5116      14.340288      13.9031        17.2465      
      4500   287.25034     -44301.702      51485.639      3430.971       14.30884       13.9031        17.2465      
      4600   302.04412     -44340.621      52960.836      3423.4304      14.277392      13.9031        17.2465      
      4700   286.7303      -44315.392      51708.679      3415.8898      14.245944      13.9031        17.2465      
      4800   286.12613     -44278.697      49135.427      3408.3492      14.214496      13.9031        17.2465      
      4900   316.95661     -44283.805      44539.204      3400.8086      14.183048      13.9031        17.2465      
      5000   313.75552     -44283.856      50330.579      3393.268       14.1516        13.9031        17.2465      
Loop time of 303.974 on 8 procs for 5000 steps with 366 atoms

Performance: 0.711 ns/day, 33.775 hours/ns, 16.449 timesteps/s, 6.020 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 239.02     | 251.71     | 257.28     |  34.3 | 82.81
Bond    | 0.001828   | 0.0021134  | 0.0024763  |   0.5 |  0.00
Neigh   | 19.144     | 20.02      | 21.495     |  16.0 |  6.59
Comm    | 2.8345     | 8.4013     | 21.137     | 188.7 |  2.76
Output  | 0.018689   | 0.021229   | 0.023634   |   1.1 |  0.01
Modify  | 22.186     | 23.696     | 24.54      |  14.9 |  7.80
Other   |            | 0.1248     |            |       |  0.04

Nlocal:          45.75 ave          52 max          39 min
Histogram: 2 0 0 1 0 1 2 0 1 1
Nghost:        3638.12 ave        3725 max        3558 min
Histogram: 1 2 0 0 1 1 0 2 0 1
Neighs:        34554.5 ave       39029 max       29837 min
Histogram: 2 0 1 0 0 1 1 1 1 1

Total # of neighbors = 276436
Ave neighs/atom = 755.28962
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*15.724
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.5724 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.5724 xy delta -0.7584 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.5724 xy delta -0.7584 xz delta 0.01778 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130 | 132.6 | 135.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   313.86144     -44406.269      4512.7738      3770.2978      15.724         13.9031        17.2465      
       100   297.29789     -44418.055     -4234.2169      3777.8384      15.755448      13.9031        17.2465      
       200   290.88463     -44427.263     -14370.926      3785.379       15.786896      13.9031        17.2465      
       300   294.56159     -44425.647     -2613.4621      3792.9196      15.818344      13.9031        17.2465      
       400   301.55262     -44412.774     -14448.873      3800.4602      15.849792      13.9031        17.2465      
       500   318.00974     -44400.249     -18334.686      3808.0008      15.88124       13.9031        17.2465      
       600   309.8294      -44407.035     -13152.784      3815.5414      15.912688      13.9031        17.2465      
       700   294.69768     -44412.628     -24453.771      3823.082       15.944136      13.9031        17.2465      
       800   298.95781     -44413.178     -14450.358      3830.6226      15.975584      13.9031        17.2465      
       900   279.03146     -44394.188     -7859.174       3838.1632      16.007032      13.9031        17.2465      
      1000   306.76326     -44407.214     -7854.199       3845.7038      16.03848       13.9031        17.2465      
      1100   317.44136     -44387.193     -27868.034      3853.2443      16.069928      13.9031        17.2465      
      1200   306.79478     -44376.259     -9074.4335      3860.7849      16.101376      13.9031        17.2465      
      1300   271.31592     -44371.635     -19145.032      3868.3255      16.132824      13.9031        17.2465      
      1400   305.16501     -44404.518     -22741.074      3875.8661      16.164272      13.9031        17.2465      
      1500   301.76337     -44394.719     -22993.377      3883.4067      16.19572       13.9031        17.2465      
      1600   298.43152     -44374.612     -22042.023      3890.9473      16.227168      13.9031        17.2465      
      1700   310.10439     -44351.962     -18103.118      3898.4879      16.258616      13.9031        17.2465      
      1800   324.65495     -44342.75      -29982.347      3906.0285      16.290064      13.9031        17.2465      
      1900   320.1436      -44356.622     -25670.556      3913.5691      16.321512      13.9031        17.2465      
      2000   307.61046     -44363.625     -19644.184      3921.1097      16.35296       13.9031        17.2465      
      2100   296.64867     -44345.977     -20755.996      3928.6503      16.384408      13.9031        17.2465      
      2200   312.50867     -44349.919     -28314.715      3936.1909      16.415856      13.9031        17.2465      
      2300   287.37192     -44314.32      -17657.507      3943.7315      16.447304      13.9031        17.2465      
      2400   291.93303     -44330.869     -22546.822      3951.2721      16.478752      13.9031        17.2465      
      2500   281.45069     -44333.362     -21800.353      3958.8127      16.5102        13.9031        17.2465      
      2600   306.01021     -44353.161     -22313.409      3966.3533      16.541648      13.9031        17.2465      
      2700   305.12968     -44311.046     -24066.009      3973.8939      16.573096      13.9031        17.2465      
      2800   331.3897      -44318.228     -25103.533      3981.4345      16.604544      13.9031        17.2465      
      2900   297.92445     -44297.032     -25072.261      3988.9751      16.635992      13.9031        17.2465      
      3000   310.22577     -44314.786     -27873.207      3996.5157      16.66744       13.9031        17.2465      
      3100   292.97135     -44294.863     -22165.427      4004.0563      16.698888      13.9031        17.2465      
      3200   290.97569     -44282.632     -19624.054      4011.5969      16.730336      13.9031        17.2465      
      3300   314.60595     -44258.175     -34606.302      4019.1375      16.761784      13.9031        17.2465      
      3400   306.45065     -44238.908     -32387.065      4026.678       16.793232      13.9031        17.2465      
      3500   301.25243     -44257.537     -29734.359      4034.2186      16.82468       13.9031        17.2465      
      3600   303.08577     -44270.978     -29996.699      4041.7592      16.856128      13.9031        17.2465      
      3700   288.6084      -44253.618     -25778.807      4049.2998      16.887576      13.9031        17.2465      
      3800   308.00994     -44268.546     -22233.916      4056.8404      16.919024      13.9031        17.2465      
      3900   306.3164      -44268.263     -37312.079      4064.381       16.950472      13.9031        17.2465      
      4000   283.02207     -44255.455     -46203.932      4071.9216      16.98192       13.9031        17.2465      
      4100   299.17116     -44268.684     -26449.439      4079.4622      17.013368      13.9031        17.2465      
      4200   311.3733      -44256.687     -32295.262      4087.0028      17.044816      13.9031        17.2465      
      4300   310.45182     -44220.674     -29001.496      4094.5434      17.076264      13.9031        17.2465      
      4400   300.70226     -44191.679     -26249.209      4102.084       17.107712      13.9031        17.2465      
      4500   314.46468     -44209.294     -41415.487      4109.6246      17.13916       13.9031        17.2465      
      4600   287.75617     -44207.704     -29769.912      4117.1652      17.170608      13.9031        17.2465      
      4700   297.46529     -44223.402     -39405.338      4124.7058      17.202056      13.9031        17.2465      
      4800   309.39777     -44230.595     -31076.507      4132.2464      17.233504      13.9031        17.2465      
      4900   284.3324      -44183.688     -22897.858      4139.787       17.264952      13.9031        17.2465      
      5000   309.3182      -44170.613     -39464.786      4147.3276      17.2964        13.9031        17.2465      
Loop time of 260.849 on 8 procs for 5000 steps with 366 atoms

Performance: 0.828 ns/day, 28.983 hours/ns, 19.168 timesteps/s, 7.016 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 162.09     | 208.28     | 219.8      | 124.6 | 79.85
Bond    | 0.0017562  | 0.002045   | 0.0023874  |   0.5 |  0.00
Neigh   | 12.241     | 16.007     | 17.975     |  39.4 |  6.14
Comm    | 2.7923     | 14.313     | 60.452     | 475.0 |  5.49
Output  | 0.018228   | 0.020392   | 0.022418   |   1.0 |  0.01
Modify  | 20.096     | 22.108     | 25.938     |  34.2 |  8.48
Other   |            | 0.1201     |            |       |  0.05

Nlocal:          45.75 ave          52 max          38 min
Histogram: 1 0 0 1 2 1 0 0 2 1
Nghost:         3288.5 ave        3344 max        3229 min
Histogram: 1 0 1 0 2 1 0 2 0 1
Neighs:        28172.1 ave       31884 max       23494 min
Histogram: 1 0 0 1 3 0 0 0 2 1

Total # of neighbors = 225377
Ave neighs/atom = 615.78415
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.9031
variable dlen equal ly-${len0}
variable dlen equal ly-13.9031
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.9031
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.5839999999999996305, deltaxy = 0.7584
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.17780000000000001359, deltaxz = -0.01778
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43709999999999998854, deltayz = -0.04371
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.39031 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.39031 yz delta -0.04371 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130 | 132.6 | 135.4 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   313.86144     -44406.269      4512.7738      3770.2978      15.724         13.9031        17.2465      
       100   297.37762     -44418.068     -4309.4814      3762.7572      15.724         13.875294      17.2465      
       200   290.47851     -44429.703     -10315.477      3755.2166      15.724         13.847488      17.2465      
       300   302.3212      -44441.434      2424.5211      3747.676       15.724         13.819681      17.2465      
       400   296.71772     -44427.479     -5944.3454      3740.1354      15.724         13.791875      17.2465      
       500   317.27437     -44422.929     -15144.941      3732.5948      15.724         13.764069      17.2465      
       600   322.68162     -44416.838      9071.702       3725.0542      15.724         13.736263      17.2465      
       700   294.45307     -44417.698     -608.10678      3717.5136      15.724         13.708457      17.2465      
       800   290.45172     -44427.089      690.1773       3709.973       15.724         13.68065       17.2465      
       900   305.97789     -44432.316      3802.9796      3702.4324      15.724         13.652844      17.2465      
      1000   314.27336     -44423.674      9285.983       3694.8918      15.724         13.625038      17.2465      
      1100   296.57861     -44397.592     -6062.3844      3687.3512      15.724         13.597232      17.2465      
      1200   309.15471     -44437.837      13558.678      3679.8107      15.724         13.569426      17.2465      
      1300   297.12343     -44437.447      13239.346      3672.2701      15.724         13.541619      17.2465      
      1400   291.79556     -44435.507      33.977738      3664.7295      15.724         13.513813      17.2465      
      1500   296.81243     -44416.125      9449.1501      3657.1889      15.724         13.486007      17.2465      
      1600   303.13079     -44393.487      9937.5429      3649.6483      15.724         13.458201      17.2465      
      1700   319.93028     -44413.813      789.82778      3642.1077      15.724         13.430395      17.2465      
      1800   299.49222     -44404.196      9748.6368      3634.5671      15.724         13.402588      17.2465      
      1900   303.51512     -44417.976      15184.652      3627.0265      15.724         13.374782      17.2465      
      2000   303.15504     -44435.881      17608.196      3619.4859      15.724         13.346976      17.2465      
      2100   290.14558     -44430.174      11272.027      3611.9453      15.724         13.31917       17.2465      
      2200   304.13145     -44434.843      17120.824      3604.4047      15.724         13.291364      17.2465      
      2300   304.21552     -44405.134      16059.045      3596.8641      15.724         13.263557      17.2465      
      2400   320.5438      -44382.593      22523.881      3589.3235      15.724         13.235751      17.2465      
      2500   323.32336     -44401.982      36459.255      3581.7829      15.724         13.207945      17.2465      
      2600   316.6404      -44404.892      21147.6        3574.2423      15.724         13.180139      17.2465      
      2700   297.81239     -44396.227      9380.4697      3566.7017      15.724         13.152333      17.2465      
      2800   305.31108     -44417.007      19048.86       3559.1611      15.724         13.124526      17.2465      
      2900   287.89492     -44399.072      31406.541      3551.6205      15.724         13.09672       17.2465      
      3000   291.46346     -44377.187      28568.407      3544.0799      15.724         13.068914      17.2465      
      3100   312.4654      -44356.278      24628.997      3536.5393      15.724         13.041108      17.2465      
      3200   299.66393     -44343.527      28112.071      3528.9987      15.724         13.013302      17.2465      
      3300   307.08679     -44369.86       27109.257      3521.4581      15.724         12.985495      17.2465      
      3400   295.71759     -44363.018      32795.367      3513.9175      15.724         12.957689      17.2465      
      3500   308.89823     -44374.957      33518.098      3506.377       15.724         12.929883      17.2465      
      3600   294.17176     -44369.111      16738.067      3498.8364      15.724         12.902077      17.2465      
      3700   281.58783     -44368.256      36089.828      3491.2958      15.724         12.874271      17.2465      
      3800   310.62585     -44377.876      36865.47       3483.7552      15.724         12.846464      17.2465      
      3900   319.61002     -44330.801      35464.75       3476.2146      15.724         12.818658      17.2465      
      4000   325.87283     -44336.84       32852.074      3468.674       15.724         12.790852      17.2465      
      4100   312.15794     -44335.146      34975.679      3461.1334      15.724         12.763046      17.2465      
      4200   290.08318     -44324.384      26668.181      3453.5928      15.724         12.73524       17.2465      
      4300   298.32098     -44331.424      52926.543      3446.0522      15.724         12.707433      17.2465      
      4400   280.45001     -44309.21       37157.292      3438.5116      15.724         12.679627      17.2465      
      4500   287.16482     -44323.566      42630.757      3430.971       15.724         12.651821      17.2465      
      4600   290.72336     -44333.122      50562.697      3423.4304      15.724         12.624015      17.2465      
      4700   285.6658      -44327.667      48992.37       3415.8898      15.724         12.596209      17.2465      
      4800   297.82716     -44310.431      56616.518      3408.3492      15.724         12.568402      17.2465      
      4900   293.74881     -44265.479      44377.328      3400.8086      15.724         12.540596      17.2465      
      5000   320.66192     -44278.343      56111.221      3393.268       15.724         12.51279       17.2465      
Loop time of 306.525 on 8 procs for 5000 steps with 366 atoms

Performance: 0.705 ns/day, 34.058 hours/ns, 16.312 timesteps/s, 5.970 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 175.3      | 238.31     | 259.75     | 188.8 | 77.74
Bond    | 0.0017504  | 0.002062   | 0.002398   |   0.5 |  0.00
Neigh   | 14.815     | 19.377     | 22.218     |  52.2 |  6.32
Comm    | 2.5304     | 23.966     | 87.008     | 595.4 |  7.82
Output  | 0.017812   | 0.020294   | 0.022264   |   1.1 |  0.01
Modify  | 21.847     | 24.732     | 29.27      |  46.4 |  8.07
Other   |            | 0.1219     |            |       |  0.04

Nlocal:          45.75 ave          53 max          38 min
Histogram: 1 0 1 1 1 0 2 0 1 1
Nghost:        3789.25 ave        3881 max        3696 min
Histogram: 1 0 1 1 1 0 2 1 0 1
Neighs:        34527.1 ave       39757 max       29158 min
Histogram: 1 0 1 2 0 1 1 0 1 1

Total # of neighbors = 276217
Ave neighs/atom = 754.69126
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.9031
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.39031 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.39031 yz delta 0.04371 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130 | 132.6 | 135.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   313.86144     -44406.269      4512.7738      3770.2978      15.724         13.9031        17.2465      
       100   297.37327     -44418.068     -4292.3351      3777.8384      15.724         13.930906      17.2465      
       200   292.23179     -44430.851     -12069.704      3785.379       15.724         13.958712      17.2465      
       300   292.22773     -44425.83      -7504.7022      3792.9196      15.724         13.986519      17.2465      
       400   305.35309     -44418.045     -7092.9675      3800.4602      15.724         14.014325      17.2465      
       500   314.21975     -44397.154     -9044.2349      3808.0008      15.724         14.042131      17.2465      
       600   320.98998     -44401.922     -2842.38        3815.5414      15.724         14.069937      17.2465      
       700   302.53788     -44390.749     -8496.2094      3823.082       15.724         14.097743      17.2465      
       800   300.72621     -44393.657     -13299.235      3830.6226      15.724         14.12555       17.2465      
       900   304.33456     -44400.568     -6559.4672      3838.1632      15.724         14.153356      17.2465      
      1000   307.91238     -44408.479      4188.8982      3845.7038      15.724         14.181162      17.2465      
      1100   283.1219      -44404.47      -15304.389      3853.2443      15.724         14.208968      17.2465      
      1200   288.54749     -44417.002     -16324.539      3860.7849      15.724         14.236774      17.2465      
      1300   290.69063     -44387.787     -14174.387      3868.3255      15.724         14.264581      17.2465      
      1400   303.1709      -44373.947     -21409.494      3875.8661      15.724         14.292387      17.2465      
      1500   308.38591     -44362.232     -5487.7832      3883.4067      15.724         14.320193      17.2465      
      1600   304.8867      -44360.719     -21507.529      3890.9473      15.724         14.347999      17.2465      
      1700   299.03042     -44364.749     -14360.273      3898.4879      15.724         14.375805      17.2465      
      1800   280.93505     -44369.559     -22409.911      3906.0285      15.724         14.403612      17.2465      
      1900   285.04638     -44382.118     -13082.258      3913.5691      15.724         14.431418      17.2465      
      2000   285.86179     -44361.393     -21276.044      3921.1097      15.724         14.459224      17.2465      
      2100   290.08336     -44345.525     -24315.858      3928.6503      15.724         14.48703       17.2465      
      2200   307.85752     -44346.132     -16802.102      3936.1909      15.724         14.514836      17.2465      
      2300   307.47467     -44333.084     -25861.119      3943.7315      15.724         14.542643      17.2465      
      2400   300.52051     -44331.245     -24733.401      3951.2721      15.724         14.570449      17.2465      
      2500   275.42153     -44325.692     -22874.273      3958.8127      15.724         14.598255      17.2465      
      2600   285.20303     -44336.876     -22119.761      3966.3533      15.724         14.626061      17.2465      
      2700   292.80424     -44307.15      -18568.27       3973.8939      15.724         14.653867      17.2465      
      2800   314.27882     -44309.64      -25508.694      3981.4345      15.724         14.681674      17.2465      
      2900   292.45934     -44293.002     -26887.588      3988.9751      15.724         14.70948       17.2465      
      3000   289.95746     -44295.538     -22825.515      3996.5157      15.724         14.737286      17.2465      
      3100   310.16133     -44308.982     -37099.363      4004.0563      15.724         14.765092      17.2465      
      3200   325.39088     -44291.894     -27255.702      4011.5969      15.724         14.792898      17.2465      
      3300   339.60375     -44285.87      -23741.677      4019.1375      15.724         14.820705      17.2465      
      3400   290.502       -44260.193     -25729.552      4026.678       15.724         14.848511      17.2465      
      3500   286.41406     -44267.149     -32973.506      4034.2186      15.724         14.876317      17.2465      
      3600   294.18819     -44270.574     -31642.459      4041.7592      15.724         14.904123      17.2465      
      3700   299.16366     -44269.679     -26597.955      4049.2998      15.724         14.931929      17.2465      
      3800   291.13983     -44277.741     -20779.419      4056.8404      15.724         14.959736      17.2465      
      3900   275.93339     -44274.408     -32773.2        4064.381       15.724         14.987542      17.2465      
      4000   291.8923      -44289.548     -28837.359      4071.9216      15.724         15.015348      17.2465      
      4100   293.72778     -44247.067     -32129.431      4079.4622      15.724         15.043154      17.2465      
      4200   302.27853     -44231.937     -40482.89       4087.0028      15.724         15.07096       17.2465      
      4300   297.50752     -44219.575     -32756.297      4094.5434      15.724         15.098767      17.2465      
      4400   299.50341     -44230.27      -32079.597      4102.084       15.724         15.126573      17.2465      
      4500   271.16495     -44211.502     -27998.32       4109.6246      15.724         15.154379      17.2465      
      4600   301.79803     -44226.98      -33128.709      4117.1652      15.724         15.182185      17.2465      
      4700   306.17253     -44184.03      -31046.932      4124.7058      15.724         15.209991      17.2465      
      4800   308.96156     -44164.614     -29099.974      4132.2464      15.724         15.237798      17.2465      
      4900   311.86013     -44172.341     -26197.116      4139.787       15.724         15.265604      17.2465      
      5000   296.28905     -44165.7       -28038.308      4147.3276      15.724         15.29341       17.2465      
Loop time of 258.158 on 8 procs for 5000 steps with 366 atoms

Performance: 0.837 ns/day, 28.684 hours/ns, 19.368 timesteps/s, 7.089 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 167.71     | 206.54     | 216.21     | 105.0 | 80.00
Bond    | 0.0017329  | 0.0020479  | 0.0023371  |   0.5 |  0.00
Neigh   | 14.68      | 17.428     | 19.303     |  29.8 |  6.75
Comm    | 2.568      | 12.235     | 51.099     | 431.8 |  4.74
Output  | 0.017776   | 0.020228   | 0.022115   |   0.9 |  0.01
Modify  | 19.893     | 21.817     | 24.543     |  26.8 |  8.45
Other   |            | 0.1201     |            |       |  0.05

Nlocal:          45.75 ave          56 max          34 min
Histogram: 1 0 0 1 2 1 1 0 1 1
Nghost:        3111.25 ave        3154 max        3075 min
Histogram: 2 1 0 0 1 0 2 0 1 1
Neighs:        28244.2 ave       34254 max       21073 min
Histogram: 1 0 0 1 2 1 1 0 1 1

Total # of neighbors = 225954
Ave neighs/atom = 617.36066
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.2465
variable dlen equal lz-${len0}
variable dlen equal lz-17.2465
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.2465
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.5839999999999996305, deltaxy = 0.7584
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.17780000000000001359, deltaxz = -0.01778
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43709999999999998854, deltayz = -0.04371
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -1.72465 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130 | 132.6 | 135.4 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   313.86144     -44406.269      4512.7738      3770.2978      15.724         13.9031        17.2465      
       100   297.3751      -44418.068     -4309.5146      3762.7572      15.724         13.9031        17.212007    
       200   289.33938     -44425.99      -7498.7202      3755.2166      15.724         13.9031        17.177514    
       300   299.19302     -44437.372      330.84067      3747.676       15.724         13.9031        17.143021    
       400   289.94562     -44414.217      331.54252      3740.1354      15.724         13.9031        17.108528    
       500   312.87382     -44404.438     -2200.7504      3732.5948      15.724         13.9031        17.074035    
       600   317.52672     -44392.308      6404.8052      3725.0542      15.724         13.9031        17.039542    
       700   296.09208     -44393.418      7015.091       3717.5136      15.724         13.9031        17.005049    
       800   311.18708     -44421.76       1453.6043      3709.973       15.724         13.9031        16.970556    
       900   288.85455     -44403.101     -9482.3509      3702.4324      15.724         13.9031        16.936063    
      1000   285.58314     -44398.041      15179.326      3694.8918      15.724         13.9031        16.90157     
      1100   287.01478     -44394.446      9436.3829      3687.3512      15.724         13.9031        16.867077    
      1200   302.43713     -44407.959      11754.011      3679.8107      15.724         13.9031        16.832584    
      1300   302.10522     -44425.251      1485.9374      3672.2701      15.724         13.9031        16.798091    
      1400   298.64468     -44430.625      8246.6398      3664.7295      15.724         13.9031        16.763598    
      1500   283.72759     -44411.686      7247.4741      3657.1889      15.724         13.9031        16.729105    
      1600   282.95215     -44391.632      15950.688      3649.6483      15.724         13.9031        16.694612    
      1700   304.74593     -44370.537      19819.36       3642.1077      15.724         13.9031        16.660119    
      1800   315.59507     -44389.616      17988.046      3634.5671      15.724         13.9031        16.625626    
      1900   319.27326     -44416.985      22687.188      3627.0265      15.724         13.9031        16.591133    
      2000   301.58968     -44407.44       20165.843      3619.4859      15.724         13.9031        16.55664     
      2100   297.37856     -44411.966      12675.958      3611.9453      15.724         13.9031        16.522147    
      2200   295.61202     -44410.674      10608.419      3604.4047      15.724         13.9031        16.487654    
      2300   290.38647     -44400.95       13729.17       3596.8641      15.724         13.9031        16.453161    
      2400   292.827       -44397.4        36129.485      3589.3235      15.724         13.9031        16.418668    
      2500   317.55062     -44403.24       14502.389      3581.7829      15.724         13.9031        16.384175    
      2600   301.66555     -44389.274      14060.295      3574.2423      15.724         13.9031        16.349682    
      2700   293.29868     -44398.055      33607.482      3566.7017      15.724         13.9031        16.315189    
      2800   285.25482     -44399.394      26904.742      3559.1611      15.724         13.9031        16.280696    
      2900   293.20661     -44383.498      34346.019      3551.6205      15.724         13.9031        16.246203    
      3000   295.09972     -44330.445      32482.412      3544.0799      15.724         13.9031        16.21171     
      3100   318.36502     -44343.676      30293.868      3536.5393      15.724         13.9031        16.177217    
      3200   312.56156     -44352.003      28937.225      3528.9987      15.724         13.9031        16.142724    
      3300   310.76575     -44370.869      34118.181      3521.4581      15.724         13.9031        16.108231    
      3400   297.71402     -44366.463      35360.36       3513.9175      15.724         13.9031        16.073738    
      3500   287.80668     -44352.818      27969.926      3506.377       15.724         13.9031        16.039245    
      3600   296.81074     -44362.827      27795.177      3498.8364      15.724         13.9031        16.004752    
      3700   294.05052     -44343.355      30122.238      3491.2958      15.724         13.9031        15.970259    
      3800   317.04878     -44331.192      37728.333      3483.7552      15.724         13.9031        15.935766    
      3900   323.81748     -44338.69       37529.807      3476.2146      15.724         13.9031        15.901273    
      4000   297.60724     -44337.63       24880.633      3468.674       15.724         13.9031        15.86678     
      4100   297.67825     -44338.593      42393.534      3461.1334      15.724         13.9031        15.832287    
      4200   295.08175     -44324.002      35808.246      3453.5928      15.724         13.9031        15.797794    
      4300   301.33314     -44316.915      46059.231      3446.0522      15.724         13.9031        15.763301    
      4400   327.39563     -44319.347      40699.218      3438.5116      15.724         13.9031        15.728808    
      4500   314.78919     -44292.325      41004.416      3430.971       15.724         13.9031        15.694315    
      4600   306.67585     -44305.598      51211.568      3423.4304      15.724         13.9031        15.659822    
      4700   301.08328     -44302.093      43391.924      3415.8898      15.724         13.9031        15.625329    
      4800   293.1697      -44286.653      54861.885      3408.3492      15.724         13.9031        15.590836    
      4900   325.09899     -44301.41       34524.637      3400.8086      15.724         13.9031        15.556343    
      5000   305.34388     -44236.758      45605.928      3393.268       15.724         13.9031        15.52185     
Loop time of 304.564 on 8 procs for 5000 steps with 366 atoms

Performance: 0.709 ns/day, 33.840 hours/ns, 16.417 timesteps/s, 6.009 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 219.98     | 245.4      | 255.77     |  79.1 | 80.57
Bond    | 0.0017524  | 0.0020872  | 0.0024023  |   0.5 |  0.00
Neigh   | 17.524     | 19.777     | 21.812     |  26.8 |  6.49
Comm    | 4.0622     | 14.443     | 39.798     | 326.1 |  4.74
Output  | 0.017879   | 0.020253   | 0.022299   |   1.0 |  0.01
Modify  | 22.722     | 24.8       | 27.123     |  24.5 |  8.14
Other   |            | 0.1228     |            |       |  0.04

Nlocal:          45.75 ave          53 max          39 min
Histogram: 1 0 1 2 1 0 1 1 0 1
Nghost:        3705.88 ave        3787 max        3640 min
Histogram: 2 0 0 1 3 0 0 1 0 1
Neighs:        34551.9 ave       39699 max       29763 min
Histogram: 1 0 1 2 1 0 1 1 0 1

Total # of neighbors = 276415
Ave neighs/atom = 755.23224
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.2465
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 1.72465 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130 | 132.6 | 135.4 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   313.86144     -44406.269      4512.7738      3770.2978      15.724         13.9031        17.2465      
       100   297.3751      -44418.068     -4292.311       3777.8384      15.724         13.9031        17.280993    
       200   289.11833     -44428.542     -9751.2758      3785.379       15.724         13.9031        17.315486    
       300   303.911       -44438.988     -7957.8305      3792.9196      15.724         13.9031        17.349979    
       400   295.90971     -44409.161     -10101.709      3800.4602      15.724         13.9031        17.384472    
       500   306.9322      -44384.589     -14007.607      3808.0008      15.724         13.9031        17.418965    
       600   320.42391     -44397.087     -10056.648      3815.5414      15.724         13.9031        17.453458    
       700   298.88123     -44388.504     -10943.987      3823.082       15.724         13.9031        17.487951    
       800   310.54509     -44410.51      -20490.56       3830.6226      15.724         13.9031        17.522444    
       900   284.09306     -44396.463     -154.35808      3838.1632      15.724         13.9031        17.556937    
      1000   306.54479     -44422.139     -3560.3306      3845.7038      15.724         13.9031        17.59143     
      1100   288.57931     -44390.194     -18482.987      3853.2443      15.724         13.9031        17.625923    
      1200   343.22445     -44418.282     -7217.9412      3860.7849      15.724         13.9031        17.660416    
      1300   329.42874     -44393.533     -11272.101      3868.3255      15.724         13.9031        17.694909    
      1400   298.66743     -44387.768     -16362.5        3875.8661      15.724         13.9031        17.729402    
      1500   290.65945     -44386.568     -15170.103      3883.4067      15.724         13.9031        17.763895    
      1600   284.47278     -44382.345     -22394.23       3890.9473      15.724         13.9031        17.798388    
      1700   271.50521     -44364.591     -31873.14       3898.4879      15.724         13.9031        17.832881    
      1800   308.03715     -44357.668     -27970.387      3906.0285      15.724         13.9031        17.867374    
      1900   323.3039      -44350.836     -12778.001      3913.5691      15.724         13.9031        17.901867    
      2000   320.93305     -44365.803     -17623.759      3921.1097      15.724         13.9031        17.93636     
      2100   307.86746     -44367.115     -20456.182      3928.6503      15.724         13.9031        17.970853    
      2200   304.79603     -44362.548     -23656.334      3936.1909      15.724         13.9031        18.005346    
      2300   312.60759     -44360.49      -30955.889      3943.7315      15.724         13.9031        18.039839    
      2400   294.92512     -44362.905     -22926.057      3951.2721      15.724         13.9031        18.074332    
      2500   289.35848     -44370.4       -20557.578      3958.8127      15.724         13.9031        18.108825    
      2600   291.66825     -44352.581     -25372.224      3966.3533      15.724         13.9031        18.143318    
      2700   308.23806     -44341.482     -25309.692      3973.8939      15.724         13.9031        18.177811    
      2800   288.9131      -44308.863     -29550.991      3981.4345      15.724         13.9031        18.212304    
      2900   315.51945     -44354.644     -29007.92       3988.9751      15.724         13.9031        18.246797    
      3000   295.87385     -44342.414     -34550.94       3996.5157      15.724         13.9031        18.28129     
      3100   285.61511     -44309.123     -25665.055      4004.0563      15.724         13.9031        18.315783    
      3200   318.9552      -44321.261     -26620.691      4011.5969      15.724         13.9031        18.350276    
      3300   316.56125     -44292.151     -30402.74       4019.1375      15.724         13.9031        18.384769    
      3400   307.54144     -44286.471     -30437.489      4026.678       15.724         13.9031        18.419262    
      3500   298.71392     -44296.987     -31205.565      4034.2186      15.724         13.9031        18.453755    
      3600   297.2304      -44300.55      -34289.852      4041.7592      15.724         13.9031        18.488248    
      3700   310.80024     -44301.761     -29716.946      4049.2998      15.724         13.9031        18.522741    
      3800   305.01471     -44261.256     -33856.414      4056.8404      15.724         13.9031        18.557234    
      3900   317.26964     -44239.779     -45466.437      4064.381       15.724         13.9031        18.591727    
      4000   305.34114     -44229.973     -39519.447      4071.9216      15.724         13.9031        18.62622     
      4100   303.98051     -44234.379     -39907.687      4079.4622      15.724         13.9031        18.660713    
      4200   310.34403     -44241.904     -37006.226      4087.0028      15.724         13.9031        18.695206    
      4300   300.46446     -44238.89      -47104.058      4094.5434      15.724         13.9031        18.729699    
      4400   286.16564     -44220.094     -48465.897      4102.084       15.724         13.9031        18.764192    
      4500   299.30629     -44223.234     -44475.154      4109.6246      15.724         13.9031        18.798685    
      4600   314.47698     -44229.385     -48485.21       4117.1652      15.724         13.9031        18.833178    
      4700   320.72427     -44254.835     -35937.996      4124.7058      15.724         13.9031        18.867671    
      4800   272.7492      -44212.712     -26697.908      4132.2464      15.724         13.9031        18.902164    
      4900   297.58436     -44216.09      -34323.429      4139.787       15.724         13.9031        18.936657    
      5000   276.51188     -44161.286     -25211.863      4147.3276      15.724         13.9031        18.97115     
Loop time of 259.491 on 8 procs for 5000 steps with 366 atoms

Performance: 0.832 ns/day, 28.832 hours/ns, 19.268 timesteps/s, 7.052 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 164.3      | 206.52     | 216.84     | 115.6 | 79.59
Bond    | 0.0018116  | 0.0020597  | 0.0022173  |   0.3 |  0.00
Neigh   | 13.142     | 16.101     | 17.27      |  30.4 |  6.20
Comm    | 4.8096     | 15.121     | 57.375     | 427.5 |  5.83
Output  | 0.01762    | 0.020024   | 0.022176   |   1.1 |  0.01
Modify  | 20.449     | 21.614     | 24.549     |  26.1 |  8.33
Other   |            | 0.1119     |            |       |  0.04

Nlocal:          45.75 ave          51 max          38 min
Histogram: 1 0 1 1 0 0 1 1 2 1
Nghost:         3188.5 ave        3259 max        3109 min
Histogram: 1 1 1 0 1 0 1 0 2 1
Neighs:          28122 ave       31354 max       23371 min
Histogram: 1 0 1 1 0 0 0 3 1 1

Total # of neighbors = 224976
Ave neighs/atom = 614.68852
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 15.724
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.4371)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*15.724
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.5839999999999996305, deltaxy = 0.7584
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.17780000000000001359, deltaxz = -0.01778
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43709999999999998854, deltayz = -0.04371
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -1.5724 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130 | 132.6 | 135.4 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   313.86144     -44406.269      4512.7738      3770.2978      15.724         13.9031        17.2465      
       100   297.3751      -44418.068     -4300.8956      3770.2978      15.724         13.9031        17.2465      
       200   288.48691     -44428.867     -5177.8196      3770.2978      15.724         13.9031        17.2465      
       300   296.36784     -44435.429     -2188.1495      3770.2978      15.724         13.9031        17.2465      
       400   298.27864     -44413.288     -2109.2225      3770.2978      15.724         13.9031        17.2465      
       500   326.40223     -44417.688     -13563.997      3770.2978      15.724         13.9031        17.2465      
       600   312.01877     -44406.885     -6108.0694      3770.2978      15.724         13.9031        17.2465      
       700   279.19437     -44414.013      898.74805      3770.2978      15.724         13.9031        17.2465      
       800   307.75317     -44445.132     -6704.636       3770.2978      15.724         13.9031        17.2465      
       900   306.95071     -44431.817      832.83488      3770.2978      15.724         13.9031        17.2465      
      1000   314.71697     -44423.035     -5936.6033      3770.2978      15.724         13.9031        17.2465      
      1100   305.69426     -44408.345     -7351.8734      3770.2978      15.724         13.9031        17.2465      
      1200   300.94436     -44428.398     -8811.2806      3770.2978      15.724         13.9031        17.2465      
      1300   282.11658     -44428.759      4960.368       3770.2978      15.724         13.9031        17.2465      
      1400   295.46452     -44432.82      -2381.5476      3770.2978      15.724         13.9031        17.2465      
      1500   307.97085     -44422.742     -16214.617      3770.2978      15.724         13.9031        17.2465      
      1600   301.14054     -44388.302     -5717.3219      3770.2978      15.724         13.9031        17.2465      
      1700   309.87947     -44413.457     -7795.6392      3770.2978      15.724         13.9031        17.2465      
      1800   299.37842     -44439.513     -20688.144      3770.2978      15.724         13.9031        17.2465      
      1900   291.12477     -44427.098      2015.4681      3770.2978      15.724         13.9031        17.2465      
      2000   305.79409     -44420.187      5107.4133      3770.2978      15.724         13.9031        17.2465      
      2100   297.36139     -44394.617     -2228.6485      3770.2978      15.724         13.9031        17.2465      
      2200   317.06393     -44394.329     -8540.5895      3770.2978      15.724         13.9031        17.2465      
      2300   320.87986     -44409.84      -7205.8891      3770.2978      15.724         13.9031        17.2465      
      2400   289.4143      -44408.172     -11221.821      3770.2978      15.724         13.9031        17.2465      
      2500   294.78867     -44417.337     -639.48466      3770.2978      15.724         13.9031        17.2465      
      2600   297.07392     -44413.213     -7910.6897      3770.2978      15.724         13.9031        17.2465      
      2700   303.95708     -44398.489     -5372.7169      3770.2978      15.724         13.9031        17.2465      
      2800   302.31326     -44381.081      3130.5374      3770.2978      15.724         13.9031        17.2465      
      2900   303.72812     -44398.505     -4729.2617      3770.2978      15.724         13.9031        17.2465      
      3000   304.17699     -44421.162     -6168.5981      3770.2978      15.724         13.9031        17.2465      
      3100   294.18257     -44417.169     -1140.7824      3770.2978      15.724         13.9031        17.2465      
      3200   299.86093     -44421.401     -1367.9765      3770.2978      15.724         13.9031        17.2465      
      3300   289.12875     -44383.532     -10014.748      3770.2978      15.724         13.9031        17.2465      
      3400   306.78333     -44376.517      1189.9235      3770.2978      15.724         13.9031        17.2465      
      3500   300.32493     -44382.473      2020.4247      3770.2978      15.724         13.9031        17.2465      
      3600   302.511       -44397.714     -3051.4364      3770.2978      15.724         13.9031        17.2465      
      3700   294.85411     -44398.519     -5261.0397      3770.2978      15.724         13.9031        17.2465      
      3800   299.46206     -44400.949     -3464.122       3770.2978      15.724         13.9031        17.2465      
      3900   303.94863     -44398.165     -5764.0609      3770.2978      15.724         13.9031        17.2465      
      4000   304.83887     -44377.582      1084.4133      3770.2978      15.724         13.9031        17.2465      
      4100   323.8373      -44369.122     -2862.265       3770.2978      15.724         13.9031        17.2465      
      4200   295.57537     -44357.736     -1269.3612      3770.2978      15.724         13.9031        17.2465      
      4300   296.5698      -44381.816      8488.555       3770.2978      15.724         13.9031        17.2465      
      4400   280.93692     -44367.815     -11665.21       3770.2978      15.724         13.9031        17.2465      
      4500   295.94591     -44387.25      -10646.089      3770.2978      15.724         13.9031        17.2465      
      4600   283.22773     -44382.257     -3188.5541      3770.2978      15.724         13.9031        17.2465      
      4700   294.57845     -44412.667     -7711.6086      3770.2978      15.724         13.9031        17.2465      
      4800   271.46045     -44382.182     -1508.7573      3770.2978      15.724         13.9031        17.2465      
      4900   316.48119     -44389.371     -2193.321       3770.2978      15.724         13.9031        17.2465      
      5000   284.12286     -44339.268      1255.2895      3770.2978      15.724         13.9031        17.2465      
Loop time of 278.278 on 8 procs for 5000 steps with 366 atoms

Performance: 0.776 ns/day, 30.920 hours/ns, 17.968 timesteps/s, 6.576 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 192.94     | 226.89     | 234.92     |  87.1 | 81.53
Bond    | 0.0017437  | 0.0021013  | 0.0024761  |   0.4 |  0.00
Neigh   | 16.305     | 18.659     | 19.316     |  21.3 |  6.71
Comm    | 3.3653     | 11.4       | 45.375     | 389.1 |  4.10
Output  | 0.017143   | 0.020049   | 0.022461   |   1.3 |  0.01
Modify  | 20.536     | 21.186     | 23.527     |  19.8 |  7.61
Other   |            | 0.1172     |            |       |  0.04

Nlocal:          45.75 ave          54 max          41 min
Histogram: 3 0 1 2 0 0 0 0 0 2
Nghost:        3418.88 ave        3479 max        3349 min
Histogram: 2 0 0 0 0 3 1 0 0 2
Neighs:        31041.8 ave       36035 max       28203 min
Histogram: 3 0 1 2 0 0 0 0 0 2

Total # of neighbors = 248334
Ave neighs/atom = 678.5082
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*15.724
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 1.5724 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130 | 132.6 | 135.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   313.86144     -44406.269      4512.7738      3770.2978      15.724         13.9031        17.2465      
       100   297.3751      -44418.068     -4300.8956      3770.2978      15.724         13.9031        17.2465      
       200   289.93746     -44428.294     -7949.43        3770.2978      15.724         13.9031        17.2465      
       300   302.90761     -44440.521     -1605.9263      3770.2978      15.724         13.9031        17.2465      
       400   299.40498     -44417.836     -6958.3383      3770.2978      15.724         13.9031        17.2465      
       500   297.48034     -44385.563     -11889.208      3770.2978      15.724         13.9031        17.2465      
       600   313.22326     -44403.095     -2086.1929      3770.2978      15.724         13.9031        17.2465      
       700   308.1527      -44412.713     -6570.3318      3770.2978      15.724         13.9031        17.2465      
       800   299.41958     -44411.727     -7407.9076      3770.2978      15.724         13.9031        17.2465      
       900   286.13358     -44407.319     -2256.9215      3770.2978      15.724         13.9031        17.2465      
      1000   297.28546     -44423.194      867.41076      3770.2978      15.724         13.9031        17.2465      
      1100   302.71747     -44423.107     -1501.9569      3770.2978      15.724         13.9031        17.2465      
      1200   325.30958     -44415.788     -2731.9096      3770.2978      15.724         13.9031        17.2465      
      1300   314.5638      -44389.443     -3284.004       3770.2978      15.724         13.9031        17.2465      
      1400   303.17092     -44402.521     -12460.437      3770.2978      15.724         13.9031        17.2465      
      1500   290.62885     -44402.971     -8186.0783      3770.2978      15.724         13.9031        17.2465      
      1600   295.91256     -44405.548     -1272.5323      3770.2978      15.724         13.9031        17.2465      
      1700   305.97487     -44408.68      -7225.6492      3770.2978      15.724         13.9031        17.2465      
      1800   312.8737      -44396.165     -12884.559      3770.2978      15.724         13.9031        17.2465      
      1900   325.23091     -44390.305     -3393.3876      3770.2978      15.724         13.9031        17.2465      
      2000   300.72313     -44367.593      4278.303       3770.2978      15.724         13.9031        17.2465      
      2100   311.7793      -44411.202      176.99004      3770.2978      15.724         13.9031        17.2465      
      2200   279.3782      -44385.643     -6911.4969      3770.2978      15.724         13.9031        17.2465      
      2300   292.48241     -44391.128      2204.2921      3770.2978      15.724         13.9031        17.2465      
      2400   311.81139     -44407.986     -6551.8937      3770.2978      15.724         13.9031        17.2465      
      2500   277.67965     -44393.047     -8268.5697      3770.2978      15.724         13.9031        17.2465      
      2600   291.93425     -44420.406     -1350.8828      3770.2978      15.724         13.9031        17.2465      
      2700   304.44817     -44414.278      7637.8294      3770.2978      15.724         13.9031        17.2465      
      2800   301.63294     -44378.309      3004.8429      3770.2978      15.724         13.9031        17.2465      
      2900   307.27443     -44379.899      2627.741       3770.2978      15.724         13.9031        17.2465      
      3000   306.29486     -44393.327     -11115.199      3770.2978      15.724         13.9031        17.2465      
      3100   275.38884     -44372.3       -1437.4136      3770.2978      15.724         13.9031        17.2465      
      3200   293.50413     -44390.169     -198.04069      3770.2978      15.724         13.9031        17.2465      
      3300   306.09984     -44408.82       3126.2947      3770.2978      15.724         13.9031        17.2465      
      3400   297.27848     -44411.44      -1073.2447      3770.2978      15.724         13.9031        17.2465      
      3500   280.21985     -44409.275     -127.16678      3770.2978      15.724         13.9031        17.2465      
      3600   280.51985     -44388.288     -9953.1468      3770.2978      15.724         13.9031        17.2465      
      3700   307.03514     -44387.897     -3654.1986      3770.2978      15.724         13.9031        17.2465      
      3800   296.22873     -44373.305      3614.2242      3770.2978      15.724         13.9031        17.2465      
      3900   304.44138     -44386.067      6225.7472      3770.2978      15.724         13.9031        17.2465      
      4000   284.22787     -44389.021     -14400.078      3770.2978      15.724         13.9031        17.2465      
      4100   295.71472     -44411.837     -852.50592      3770.2978      15.724         13.9031        17.2465      
      4200   312.26549     -44395.535     -7232.8974      3770.2978      15.724         13.9031        17.2465      
      4300   303.70302     -44357.118     -1376.5232      3770.2978      15.724         13.9031        17.2465      
      4400   296.28787     -44355.453     -83.614639      3770.2978      15.724         13.9031        17.2465      
      4500   300.95627     -44376.112     -5524.845       3770.2978      15.724         13.9031        17.2465      
      4600   301.28636     -44373.618     -10864.518      3770.2978      15.724         13.9031        17.2465      
      4700   293.6438      -44375.11      -10395.627      3770.2978      15.724         13.9031        17.2465      
      4800   266.08127     -44378.408      3041.0502      3770.2978      15.724         13.9031        17.2465      
      4900   297.95177     -44399.638      586.41527      3770.2978      15.724         13.9031        17.2465      
      5000   322.29933     -44391.584     -2727.2892      3770.2978      15.724         13.9031        17.2465      
Loop time of 264.731 on 8 procs for 5000 steps with 366 atoms

Performance: 0.816 ns/day, 29.415 hours/ns, 18.887 timesteps/s, 6.913 katom-step/s
99.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 154.38     | 200.42     | 220.06     | 153.5 | 75.71
Bond    | 0.0015854  | 0.0018567  | 0.0020996  |   0.4 |  0.00
Neigh   | 13.625     | 17.874     | 19.204     |  46.2 |  6.75
Comm    | 4.0647     | 23.711     | 69.745     | 446.2 |  8.96
Output  | 0.016964   | 0.020032   | 0.022345   |   1.1 |  0.01
Modify  | 21.257     | 22.599     | 26.858     |  41.2 |  8.54
Other   |            | 0.1053     |            |       |  0.04

Nlocal:          45.75 ave          52 max          38 min
Histogram: 1 0 0 1 1 1 0 3 0 1
Nghost:        3438.62 ave        3511 max        3388 min
Histogram: 2 0 0 2 1 1 1 0 0 1
Neighs:          31110 ave       35094 max       26120 min
Histogram: 1 0 0 1 1 1 0 3 0 1

Total # of neighbors = 248880
Ave neighs/atom = 680
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.9031
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-0.1778)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.9031
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.5839999999999996305, deltaxy = 0.7584
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.17780000000000001359, deltaxz = -0.01778
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43709999999999998854, deltayz = -0.04371
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -1.39031 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130 | 132.6 | 135.4 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   313.86144     -44406.269      4512.7738      3770.2978      15.724         13.9031        17.2465      
       100   297.3751      -44418.068     -4300.8956      3770.2978      15.724         13.9031        17.2465      
       200   287.89509     -44428.428     -9600.1443      3770.2978      15.724         13.9031        17.2465      
       300   302.67526     -44442.082     -3737.3442      3770.2978      15.724         13.9031        17.2465      
       400   295.54903     -44409.448     -6288.4275      3770.2978      15.724         13.9031        17.2465      
       500   307.17188     -44399.902     -11311.747      3770.2978      15.724         13.9031        17.2465      
       600   312.12849     -44409.562     -11379.946      3770.2978      15.724         13.9031        17.2465      
       700   293.86888     -44401.362      6871.1455      3770.2978      15.724         13.9031        17.2465      
       800   310.56309     -44425.296     -9808.9247      3770.2978      15.724         13.9031        17.2465      
       900   287.02517     -44413.533      6123.3596      3770.2978      15.724         13.9031        17.2465      
      1000   297.22511     -44429.232      2016.3948      3770.2978      15.724         13.9031        17.2465      
      1100   291.84995     -44430.364     -8201.0075      3770.2978      15.724         13.9031        17.2465      
      1200   292.69237     -44431.013     -4970.5678      3770.2978      15.724         13.9031        17.2465      
      1300   306.25235     -44420.643     -4523.7182      3770.2978      15.724         13.9031        17.2465      
      1400   302.08698     -44399.806     -9979.5707      3770.2978      15.724         13.9031        17.2465      
      1500   312.34078     -44411.211      3542.8441      3770.2978      15.724         13.9031        17.2465      
      1600   286.21517     -44413.868      5539.0044      3770.2978      15.724         13.9031        17.2465      
      1700   273.95758     -44410.405      2013.4436      3770.2978      15.724         13.9031        17.2465      
      1800   281.75401     -44401.498     -2162.4291      3770.2978      15.724         13.9031        17.2465      
      1900   288.68741     -44391.148     -4268.4398      3770.2978      15.724         13.9031        17.2465      
      2000   322.4835      -44410.913      5827.6969      3770.2978      15.724         13.9031        17.2465      
      2100   316.43544     -44372.497      7936.074       3770.2978      15.724         13.9031        17.2465      
      2200   308.73075     -44380.547     -13431.81       3770.2978      15.724         13.9031        17.2465      
      2300   306.95368     -44410.251     -630.62668      3770.2978      15.724         13.9031        17.2465      
      2400   302.84857     -44420.739     -10626.171      3770.2978      15.724         13.9031        17.2465      
      2500   294.82574     -44418.606     -3110.8903      3770.2978      15.724         13.9031        17.2465      
      2600   313.01247     -44423.984     -13420.31       3770.2978      15.724         13.9031        17.2465      
      2700   312.78363     -44388.207     -397.40492      3770.2978      15.724         13.9031        17.2465      
      2800   316.71744     -44384.18      -5274.3814      3770.2978      15.724         13.9031        17.2465      
      2900   303.6334      -44385.698     -12196.996      3770.2978      15.724         13.9031        17.2465      
      3000   320.3769      -44413.664     -14607.671      3770.2978      15.724         13.9031        17.2465      
      3100   299.74119     -44405.432     -9151.9539      3770.2978      15.724         13.9031        17.2465      
      3200   300.62375     -44417.395      1366.4727      3770.2978      15.724         13.9031        17.2465      
      3300   317.69842     -44427.473     -8138.4613      3770.2978      15.724         13.9031        17.2465      
      3400   305.05647     -44379.058     -7388.6412      3770.2978      15.724         13.9031        17.2465      
      3500   309.21632     -44361.958     -4491.9211      3770.2978      15.724         13.9031        17.2465      
      3600   309.59817     -44381.765     -6255.0817      3770.2978      15.724         13.9031        17.2465      
      3700   299.83321     -44391.295     -8885.9072      3770.2978      15.724         13.9031        17.2465      
      3800   301.44243     -44401.659     -16026.025      3770.2978      15.724         13.9031        17.2465      
      3900   284.39381     -44383.549     -17116.039      3770.2978      15.724         13.9031        17.2465      
      4000   269.60635     -44371.552      2342.5547      3770.2978      15.724         13.9031        17.2465      
      4100   291.10743     -44406.772     -9088.6164      3770.2978      15.724         13.9031        17.2465      
      4200   301.04878     -44428.4       -4969.0373      3770.2978      15.724         13.9031        17.2465      
      4300   294.43779     -44407.059     -6211.4823      3770.2978      15.724         13.9031        17.2465      
      4400   307.53849     -44386.038     -4362.6737      3770.2978      15.724         13.9031        17.2465      
      4500   311.22595     -44386.189      575.78818      3770.2978      15.724         13.9031        17.2465      
      4600   284.9851      -44375.83      -9196.3627      3770.2978      15.724         13.9031        17.2465      
      4700   295.54877     -44398.615     -8296.1558      3770.2978      15.724         13.9031        17.2465      
      4800   284.36563     -44384.113     -3175.552       3770.2978      15.724         13.9031        17.2465      
      4900   298.50232     -44388.505     -6128.4634      3770.2978      15.724         13.9031        17.2465      
      5000   291.01452     -44376.503     -3565.4774      3770.2978      15.724         13.9031        17.2465      
Loop time of 185.054 on 8 procs for 5000 steps with 366 atoms

Performance: 1.167 ns/day, 20.562 hours/ns, 27.019 timesteps/s, 9.889 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 137.62     | 143.4      | 152.36     |  34.8 | 77.49
Bond    | 0.0011034  | 0.0013516  | 0.0016316  |   0.5 |  0.00
Neigh   | 12.585     | 13.057     | 13.784     |  10.6 |  7.06
Comm    | 3.087      | 12.041     | 17.843     | 120.0 |  6.51
Output  | 0.013024   | 0.014686   | 0.016207   |   0.9 |  0.01
Modify  | 15.698     | 16.439     | 16.922     |   9.5 |  8.88
Other   |            | 0.09767    |            |       |  0.05

Nlocal:          45.75 ave          50 max          41 min
Histogram: 1 1 1 0 0 2 0 1 0 2
Nghost:        3391.25 ave        3457 max        3314 min
Histogram: 2 0 0 0 0 3 1 0 0 2
Neighs:        31068.9 ave       33977 max       28298 min
Histogram: 2 1 0 0 0 2 0 1 0 2

Total # of neighbors = 248551
Ave neighs/atom = 679.10109
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.9031
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 1.39031 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130 | 132.6 | 135.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   313.86144     -44406.269      4512.7738      3770.2978      15.724         13.9031        17.2465      
       100   297.3751      -44418.068     -4300.8956      3770.2978      15.724         13.9031        17.2465      
       200   289.89838     -44430.276     -6383.6412      3770.2978      15.724         13.9031        17.2465      
       300   301.17219     -44439.14      -3860.6446      3770.2978      15.724         13.9031        17.2465      
       400   300.21471     -44419.97      -1488.2262      3770.2978      15.724         13.9031        17.2465      
       500   316.33618     -44409.775     -10642.449      3770.2978      15.724         13.9031        17.2465      
       600   318.46539     -44413.78      -8215.3813      3770.2978      15.724         13.9031        17.2465      
       700   292.00259     -44400.175      1698.8165      3770.2978      15.724         13.9031        17.2465      
       800   294.30872     -44407.772     -10794.308      3770.2978      15.724         13.9031        17.2465      
       900   298.54705     -44413.038     -1609.4172      3770.2978      15.724         13.9031        17.2465      
      1000   318.70523     -44429.927      846.71819      3770.2978      15.724         13.9031        17.2465      
      1100   297.0347      -44404.23       5558.259       3770.2978      15.724         13.9031        17.2465      
      1200   293.9378      -44403.55      -14196.786      3770.2978      15.724         13.9031        17.2465      
      1300   298.25597     -44414.077     -8751.3385      3770.2978      15.724         13.9031        17.2465      
      1400   277.09108     -44404.3       -9623.975       3770.2978      15.724         13.9031        17.2465      
      1500   305.8018      -44442.168     -19257.689      3770.2978      15.724         13.9031        17.2465      
      1600   308.77029     -44436.047     -10447.016      3770.2978      15.724         13.9031        17.2465      
      1700   290.85411     -44384.169     -6127.3693      3770.2978      15.724         13.9031        17.2465      
      1800   324.42048     -44405.207     -6399.8186      3770.2978      15.724         13.9031        17.2465      
      1900   302.86895     -44394.266     -9197.139       3770.2978      15.724         13.9031        17.2465      
      2000   285.46433     -44408.674      4931.2425      3770.2978      15.724         13.9031        17.2465      
      2100   308.38538     -44430.513     -8463.117       3770.2978      15.724         13.9031        17.2465      
      2200   306.40805     -44409.883     -9126.6098      3770.2978      15.724         13.9031        17.2465      
      2300   314.12114     -44396.141     -8363.6491      3770.2978      15.724         13.9031        17.2465      
      2400   316.4633      -44403.335     -12144.163      3770.2978      15.724         13.9031        17.2465      
      2500   291.18395     -44412.601     -867.67201      3770.2978      15.724         13.9031        17.2465      
      2600   285.42431     -44412.578      4211.0578      3770.2978      15.724         13.9031        17.2465      
      2700   294.29461     -44410.561      884.79377      3770.2978      15.724         13.9031        17.2465      
      2800   309.70159     -44393.703     -896.30545      3770.2978      15.724         13.9031        17.2465      
      2900   318.55375     -44396.166     -2438.7393      3770.2978      15.724         13.9031        17.2465      
      3000   310.4477      -44401.019     -6949.0602      3770.2978      15.724         13.9031        17.2465      
      3100   311.2574      -44420.061      2684.7141      3770.2978      15.724         13.9031        17.2465      
      3200   302.96457     -44420.762     -13360.525      3770.2978      15.724         13.9031        17.2465      
      3300   299.96004     -44421.138     -6449.5046      3770.2978      15.724         13.9031        17.2465      
      3400   294.97718     -44417.73      -8573.1837      3770.2978      15.724         13.9031        17.2465      
      3500   303.87806     -44414.526     -12671.959      3770.2978      15.724         13.9031        17.2465      
      3600   286.36392     -44374.9        3474.1912      3770.2978      15.724         13.9031        17.2465      
      3700   317.62118     -44383.52      -3391.3156      3770.2978      15.724         13.9031        17.2465      
      3800   286.03858     -44356.154      2074.196       3770.2978      15.724         13.9031        17.2465      
      3900   301.03696     -44407.005     -2938.1916      3770.2978      15.724         13.9031        17.2465      
      4000   277.83898     -44389.39      -14439.331      3770.2978      15.724         13.9031        17.2465      
      4100   296.46048     -44391.529     -8039.9388      3770.2978      15.724         13.9031        17.2465      
      4200   311.11916     -44389.375     -9470.0152      3770.2978      15.724         13.9031        17.2465      
      4300   296.20896     -44372.296     -4113.6826      3770.2978      15.724         13.9031        17.2465      
      4400   299.64959     -44404.988     -19248.809      3770.2978      15.724         13.9031        17.2465      
      4500   281.93006     -44401.127     -999.37345      3770.2978      15.724         13.9031        17.2465      
      4600   292.08062     -44393.155     -7014.6594      3770.2978      15.724         13.9031        17.2465      
      4700   304.17299     -44379.866     -2970.1031      3770.2978      15.724         13.9031        17.2465      
      4800   297.84945     -44362.999     -8332.3528      3770.2978      15.724         13.9031        17.2465      
      4900   323.7573      -44365.501     -2068.3827      3770.2978      15.724         13.9031        17.2465      
      5000   313.6003      -44350.67       5895.5398      3770.2978      15.724         13.9031        17.2465      
Loop time of 160.743 on 8 procs for 5000 steps with 366 atoms

Performance: 1.344 ns/day, 17.860 hours/ns, 31.106 timesteps/s, 11.385 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 123.52     | 128.37     | 131.43     |  22.8 | 79.86
Bond    | 0.00090692 | 0.0011094  | 0.0012931  |   0.4 |  0.00
Neigh   | 11.972     | 12.442     | 12.921     |   8.3 |  7.74
Comm    | 1.3185     | 4.3831     | 9.2338     | 123.4 |  2.73
Output  | 0.012773   | 0.014335   | 0.015634   |   0.8 |  0.01
Modify  | 14.968     | 15.438     | 15.901     |   7.4 |  9.60
Other   |            | 0.09257    |            |       |  0.06

Nlocal:          45.75 ave          54 max          38 min
Histogram: 1 1 0 2 0 0 3 0 0 1
Nghost:        3469.25 ave        3544 max        3411 min
Histogram: 1 0 3 0 0 0 3 0 0 1
Neighs:        31049.1 ave       36433 max       25972 min
Histogram: 1 1 0 2 0 0 2 1 0 1

Total # of neighbors = 248393
Ave neighs/atom = 678.6694
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.2465
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--7.584)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.2465
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.5839999999999996305, deltaxy = 0.7584
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.17780000000000001359, deltaxz = -0.01778
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43709999999999998854, deltayz = -0.04371
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -1.72465 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130 | 132.6 | 135.4 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   313.86144     -44406.269      4512.7738      3770.2978      15.724         13.9031        17.2465      
       100   297.37837     -44418.068     -4300.8525      3770.2978      15.724         13.9031        17.2465      
       200   291.1219      -44430.576     -10773.116      3770.2978      15.724         13.9031        17.2465      
       300   293.13853     -44430.117      1121.7905      3770.2978      15.724         13.9031        17.2465      
       400   299.6804      -44420.909     -5457.7553      3770.2978      15.724         13.9031        17.2465      
       500   324.42432     -44419.328     -10556.348      3770.2978      15.724         13.9031        17.2465      
       600   318.09817     -44401.851     -5654.9128      3770.2978      15.724         13.9031        17.2465      
       700   325.82653     -44447.632      982.38316      3770.2978      15.724         13.9031        17.2465      
       800   297.25649     -44428.164     -10420.197      3770.2978      15.724         13.9031        17.2465      
       900   281.16839     -44415.632     -81.530414      3770.2978      15.724         13.9031        17.2465      
      1000   309.51594     -44428.36      -4156.8275      3770.2978      15.724         13.9031        17.2465      
      1100   294.01985     -44386.836     -3669.4546      3770.2978      15.724         13.9031        17.2465      
      1200   322.99989     -44395.308     -9049.9603      3770.2978      15.724         13.9031        17.2465      
      1300   315.96755     -44374.3       -16331.796      3770.2978      15.724         13.9031        17.2465      
      1400   316.44997     -44407.674     -13844.584      3770.2978      15.724         13.9031        17.2465      
      1500   290.65551     -44404.412     -10729.154      3770.2978      15.724         13.9031        17.2465      
      1600   298.48285     -44417.142      5701.6046      3770.2978      15.724         13.9031        17.2465      
      1700   292.99509     -44407.415      2025.4866      3770.2978      15.724         13.9031        17.2465      
      1800   293.04834     -44385.582     -4408.8078      3770.2978      15.724         13.9031        17.2465      
      1900   319.05279     -44387.091     -475.46385      3770.2978      15.724         13.9031        17.2465      
      2000   296.41005     -44389.458     -1430.1386      3770.2978      15.724         13.9031        17.2465      
      2100   283.92895     -44390.244     -1648.8785      3770.2978      15.724         13.9031        17.2465      
      2200   301.68518     -44411.883     -3245.1653      3770.2978      15.724         13.9031        17.2465      
      2300   295.9155      -44409.287     -9753.6083      3770.2978      15.724         13.9031        17.2465      
      2400   303.37639     -44422.517     -4786.5185      3770.2978      15.724         13.9031        17.2465      
      2500   298.76912     -44433.674     -4997.0016      3770.2978      15.724         13.9031        17.2465      
      2600   291.1982      -44415.455     -2269.8555      3770.2978      15.724         13.9031        17.2465      
      2700   327.72312     -44414.867     -4984.3897      3770.2978      15.724         13.9031        17.2465      
      2800   325.59223     -44405.931     -4314.5889      3770.2978      15.724         13.9031        17.2465      
      2900   302.26531     -44395.172     -6390.7736      3770.2978      15.724         13.9031        17.2465      
      3000   287.75664     -44387.362     -5488.8263      3770.2978      15.724         13.9031        17.2465      
      3100   307.51662     -44405.265     -8123.8506      3770.2978      15.724         13.9031        17.2465      
      3200   300.2775      -44396.707     -5832.0866      3770.2978      15.724         13.9031        17.2465      
      3300   300.70393     -44425.227     -4692.9385      3770.2978      15.724         13.9031        17.2465      
      3400   282.89235     -44422.143     -15695.083      3770.2978      15.724         13.9031        17.2465      
      3500   289.66651     -44404.657     -12609.426      3770.2978      15.724         13.9031        17.2465      
      3600   299.84589     -44386.374     -2188.4643      3770.2978      15.724         13.9031        17.2465      
      3700   301.73604     -44374.766     -8871.7676      3770.2978      15.724         13.9031        17.2465      
      3800   304.20431     -44384.657     -17409.613      3770.2978      15.724         13.9031        17.2465      
      3900   283.71458     -44388.579     -11368.455      3770.2978      15.724         13.9031        17.2465      
      4000   281.3419      -44393.884     -6764.2816      3770.2978      15.724         13.9031        17.2465      
      4100   292.05239     -44364.719     -13519.548      3770.2978      15.724         13.9031        17.2465      
      4200   303.32776     -44347.709     -3099.2039      3770.2978      15.724         13.9031        17.2465      
      4300   311.96321     -44366.428     -12713.034      3770.2978      15.724         13.9031        17.2465      
      4400   292.23189     -44366.39      -3913.6152      3770.2978      15.724         13.9031        17.2465      
      4500   297.70051     -44373.574     -10550.122      3770.2978      15.724         13.9031        17.2465      
      4600   298.50316     -44358.42      -5783.7829      3770.2978      15.724         13.9031        17.2465      
      4700   322.79653     -44351.658     -9758.4845      3770.2978      15.724         13.9031        17.2465      
      4800   298.46475     -44300.555     -3140.2878      3770.2978      15.724         13.9031        17.2465      
      4900   311.68655     -44332.646     -5596.4333      3770.2978      15.724         13.9031        17.2465      
      5000   306.61327     -44350.382     -9577.3343      3770.2978      15.724         13.9031        17.2465      
Loop time of 161.107 on 8 procs for 5000 steps with 366 atoms

Performance: 1.341 ns/day, 17.901 hours/ns, 31.035 timesteps/s, 11.359 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 125.45     | 129.66     | 131.78     |  18.9 | 80.48
Bond    | 0.00094253 | 0.0011125  | 0.0012812  |   0.4 |  0.00
Neigh   | 12.192     | 12.541     | 12.887     |   5.8 |  7.78
Comm    | 1.7319     | 3.8644     | 8.0787     | 109.8 |  2.40
Output  | 0.010157   | 0.011824   | 0.01322    |   1.0 |  0.01
Modify  | 14.601     | 14.939     | 15.276     |   5.2 |  9.27
Other   |            | 0.09122    |            |       |  0.06

Nlocal:          45.75 ave          52 max          38 min
Histogram: 1 0 0 0 2 2 0 2 0 1
Nghost:         3562.5 ave        3654 max        3481 min
Histogram: 1 0 2 0 1 1 1 1 0 1
Neighs:        31077.4 ave       35260 max       26072 min
Histogram: 1 0 0 0 3 1 0 2 0 1

Total # of neighbors = 248619
Ave neighs/atom = 679.28689
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.2465
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 1.72465 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130 | 132.6 | 135.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   313.86144     -44406.269      4512.7738      3770.2978      15.724         13.9031        17.2465      
       100   297.37288     -44418.068     -4300.9249      3770.2978      15.724         13.9031        17.2465      
       200   291.27609     -44430.665     -11075.352      3770.2978      15.724         13.9031        17.2465      
       300   295.43087     -44431.99      -6334.2125      3770.2978      15.724         13.9031        17.2465      
       400   295.05186     -44408.806     -2043.9961      3770.2978      15.724         13.9031        17.2465      
       500   311.0911      -44402.253     -15062.53       3770.2978      15.724         13.9031        17.2465      
       600   305.5908      -44402.468      1161.8064      3770.2978      15.724         13.9031        17.2465      
       700   297.72152     -44399.181     -4075.7442      3770.2978      15.724         13.9031        17.2465      
       800   295.13522     -44403.024      1164.3217      3770.2978      15.724         13.9031        17.2465      
       900   314.17124     -44435.046     -3044.1317      3770.2978      15.724         13.9031        17.2465      
      1000   295.95797     -44423.923     -7565.3061      3770.2978      15.724         13.9031        17.2465      
      1100   287.38936     -44418.41       1479.973       3770.2978      15.724         13.9031        17.2465      
      1200   310.07003     -44400.056      8818.2152      3770.2978      15.724         13.9031        17.2465      
      1300   326.89849     -44406.126     -126.77828      3770.2978      15.724         13.9031        17.2465      
      1400   310.50482     -44409.881     -14132.082      3770.2978      15.724         13.9031        17.2465      
      1500   297.45687     -44413.352     -5118.925       3770.2978      15.724         13.9031        17.2465      
      1600   289.99741     -44412.312     -6203.621       3770.2978      15.724         13.9031        17.2465      
      1700   290.18023     -44402.172     -5032.7536      3770.2978      15.724         13.9031        17.2465      
      1800   309.62962     -44381.327     -16761.407      3770.2978      15.724         13.9031        17.2465      
      1900   299.62948     -44367.476      4734.3151      3770.2978      15.724         13.9031        17.2465      
      2000   306.22504     -44388.95      -2477.4724      3770.2978      15.724         13.9031        17.2465      
      2100   306.2657      -44395.885     -16223.887      3770.2978      15.724         13.9031        17.2465      
      2200   298.54565     -44392.403     -8565.8402      3770.2978      15.724         13.9031        17.2465      
      2300   303.87912     -44398.45      -4617.9844      3770.2978      15.724         13.9031        17.2465      
      2400   285.48378     -44382.624     -8113.3231      3770.2978      15.724         13.9031        17.2465      
      2500   292.67646     -44390.092      4667.3219      3770.2978      15.724         13.9031        17.2465      
      2600   321.81897     -44380.835      11100.714      3770.2978      15.724         13.9031        17.2465      
      2700   322.90163     -44366.166      3809.0099      3770.2978      15.724         13.9031        17.2465      
      2800   315.69212     -44380.977      12409.108      3770.2978      15.724         13.9031        17.2465      
      2900   300.94961     -44382.147     -7410.3984      3770.2978      15.724         13.9031        17.2465      
      3000   314.87943     -44404.54      -7234.6689      3770.2978      15.724         13.9031        17.2465      
      3100   307.97083     -44410.264     -7950.4115      3770.2978      15.724         13.9031        17.2465      
      3200   288.84405     -44395.131     -2070.1369      3770.2978      15.724         13.9031        17.2465      
      3300   292.35752     -44380.837      4943.1754      3770.2978      15.724         13.9031        17.2465      
      3400   325.75015     -44376.917      6381.9597      3770.2978      15.724         13.9031        17.2465      
      3500   303.01369     -44350.74      -21978.461      3770.2978      15.724         13.9031        17.2465      
      3600   299.03581     -44365.8        2771.3265      3770.2978      15.724         13.9031        17.2465      
      3700   302.39972     -44384.008     -1425.1271      3770.2978      15.724         13.9031        17.2465      
      3800   295.22892     -44371.657     -12718.878      3770.2978      15.724         13.9031        17.2465      
      3900   299.52162     -44371.133     -9601.7661      3770.2978      15.724         13.9031        17.2465      
      4000   299.87142     -44365.746     -3738.7542      3770.2978      15.724         13.9031        17.2465      
      4100   326.26651     -44370.515      9528.0762      3770.2978      15.724         13.9031        17.2465      
      4200   325.40281     -44352.166     -1211.9083      3770.2978      15.724         13.9031        17.2465      
      4300   301.20959     -44333.946     -5457.6972      3770.2978      15.724         13.9031        17.2465      
      4400   278.62566     -44334.611     -699.65894      3770.2978      15.724         13.9031        17.2465      
      4500   283.10388     -44342.42      -7871.548       3770.2978      15.724         13.9031        17.2465      
      4600   280.67911     -44334.715      329.46334      3770.2978      15.724         13.9031        17.2465      
      4700   287.90816     -44329.391      5471.866       3770.2978      15.724         13.9031        17.2465      
      4800   311.78472     -44338.066     -12652.994      3770.2978      15.724         13.9031        17.2465      
      4900   305.79236     -44328.909     -3933.6924      3770.2978      15.724         13.9031        17.2465      
      5000   299.62099     -44339.56      -5260.1621      3770.2978      15.724         13.9031        17.2465      
Loop time of 157.956 on 8 procs for 5000 steps with 366 atoms

Performance: 1.367 ns/day, 17.551 hours/ns, 31.654 timesteps/s, 11.586 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 120.09     | 125.11     | 127.97     |  24.1 | 79.21
Bond    | 0.0009326  | 0.0010988  | 0.0012915  |   0.4 |  0.00
Neigh   | 12.396     | 12.915     | 13.431     |   9.3 |  8.18
Comm    | 1.3311     | 4.1909     | 9.2093     | 131.5 |  2.65
Output  | 0.0099806  | 0.011519   | 0.012806   |   0.8 |  0.01
Modify  | 15.124     | 15.633     | 16.145     |   8.4 |  9.90
Other   |            | 0.09067    |            |       |  0.06

Nlocal:          45.75 ave          52 max          38 min
Histogram: 1 1 1 0 0 0 1 2 1 1
Nghost:        3313.25 ave        3370 max        3251 min
Histogram: 1 1 0 1 1 1 0 1 0 2
Neighs:        31083.8 ave       35152 max       26007 min
Histogram: 1 1 1 0 0 0 1 2 1 1

Total # of neighbors = 248670
Ave neighs/atom = 679.42623
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:53:01
