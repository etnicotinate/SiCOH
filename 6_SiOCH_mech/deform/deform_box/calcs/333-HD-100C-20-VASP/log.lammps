LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-HD-100C-20-VASP
read_data       ${structure}.data
read_data       333-HD-100C-20-VASP.data
Reading data file ...
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.009 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.865 | 6.865 | 6.865 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              326.3987       4076.9571    
         1   300            0              0              326.3987       4076.9571    
Loop time of 6.34464e-05 on 16 procs for 1 steps with 366 atoms

41.8% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.14e-07   | 2.4775e-07 | 3.58e-07   |   0.0 |  0.39
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 8.21e-07   | 1.5238e-06 | 1.826e-06  |   0.0 |  2.40
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 6.167e-05  |            |       | 97.21

Nlocal:          45.75 ave          58 max          36 min
Histogram: 1 0 2 1 1 1 1 0 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-HD-100C-20-VASP_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -29.52 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.9 | 140.6 | 142.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -43286.839      45299.205      0              1.9525358      3659.697     
       100   453.73021     -43940.878      66.565885     -7350.661       1.9525358      3659.697     
       200   360.61145     -44080.282     -7497.4627     -8642.9289      1.9525358      3659.697     
       300   312.54486     -44130.243     -2704.3417     -8460.4605      1.9525358      3659.697     
       400   339.49703     -44169.022     -2783.842      -9275.5697      1.9525358      3659.697     
       500   289.47916     -44164.497     -4504.4468     -10035.39       1.9525358      3659.697     
       600   307.90741     -44210.704     -4968.4129     -9381.9571      1.9525358      3659.697     
       700   282.33945     -44217.41      -3972.116      -6053.5219      1.9525358      3659.697     
       800   297.38633     -44238.375     -2430.1214     -9867.038       1.9525358      3659.697     
       900   330.53634     -44251.56      -634.21901     -5574.3949      1.9525358      3659.697     
      1000   295.93953     -44217.436      2497.6963     -1306.7964      1.9525358      3659.697     
      1100   305.57882     -44217.385      3615.5551     -7099.525       1.9525358      3659.697     
      1200   284.39529     -44249.124      982.94374     -12369.297      1.9525358      3659.697     
      1300   297.63115     -44281.753     -1769.07       -5724.2931      1.9525358      3659.697     
      1400   295.47633     -44272.534      5255.7205     -3308.5002      1.9525358      3659.697     
      1500   302.84159     -44266.986     -3083.948      -5347.8428      1.9525358      3659.697     
      1600   321.98286     -44265.139     -1304.5842     -6104.7605      1.9525358      3659.697     
      1700   329.279       -44269.304     -7511.8945     -4532.2341      1.9525358      3659.697     
      1800   328.54645     -44262.17      -5243.5458     -8054.1058      1.9525358      3659.697     
      1900   306.48947     -44286.257      7347.5983     -5295.9253      1.9525358      3659.697     
      2000   304.72355     -44272.42      -826.77281     -6927.5425      1.9525358      3659.697     
Loop time of 120.27 on 16 procs for 2000 steps with 366 atoms

Performance: 0.718 ns/day, 33.408 hours/ns, 16.629 timesteps/s, 6.086 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.16      | 91.028     | 92.966     |  16.2 | 75.69
Bond    | 0.00072204 | 0.00079787 | 0.00091344 |   0.0 |  0.00
Neigh   | 6.5333     | 6.7065     | 6.9723     |   5.7 |  5.58
Comm    | 8.4616     | 10.399     | 13.256     |  48.3 |  8.65
Output  | 0.0010439  | 0.0014623  | 0.0041607  |   2.7 |  0.00
Modify  | 11.471     | 11.78      | 11.937     |   4.6 |  9.79
Other   |            | 0.3535     |            |       |  0.29

Nlocal:          45.75 ave          52 max          36 min
Histogram: 1 0 0 1 1 1 1 0 1 2
Nghost:        3546.25 ave        3584 max        3510 min
Histogram: 1 0 1 0 2 2 0 1 0 1
Neighs:        32077.6 ave       36602 max       25716 min
Histogram: 1 0 0 1 1 2 0 0 1 2

Total # of neighbors = 256621
Ave neighs/atom = 701.15027
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]
# use tmp to save constants
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.1249
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.4224
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 16.909

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--6927.54245319725)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--6927.54245319725)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-3152.01919091302)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-3152.01919091302)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-1752.60364930571)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-1752.60364930571)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-3106.03955497172)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-3106.03955497172)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--1895.84222825305)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--1895.84222825305)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--1689.02435096823)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--1689.02435096823)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 16.1249
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.1249
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.161249 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.161249 xy delta 0.082539 xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.161249 xy delta 0.082539 xz delta -0.006162 remap x units box
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.4 | 139.6 | 140.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   304.72355     -44272.42      -827.02334      0              3659.697     
       100   315.32289     -44247.738      8800.438      -1363.7267      3657.8672    
       200   310.2581      -44259.51      -115.92546     -11492.661      3656.0373    
       300   287.59519     -44269.865     -1096.2188     -2134.2767      3654.2075    
       400   311.32505     -44277.587     -5662.2414     -8468.5591      3652.3776    
       500   311.1145      -44291.703      1974.0129     -7318.5021      3650.5478    
       600   291.02144     -44306.321      3346.2111     -9360.4942      3648.7179    
       700   314.42321     -44263.604      1554.9455     -10304.713      3646.8881    
       800   308.60986     -44302.942      2621.2518     -3217.9571      3645.0582    
       900   333.42533     -44280          1715.2961     -1014.1005      3643.2284    
      1000   288.83746     -44299.115     -5001.6347     -1535.1384      3641.3985    
      1100   299.07165     -44273.055     -14823.19      -8994.6481      3639.5687    
      1200   299.35102     -44295.841      2612.9973     -4424.6566      3637.7388    
      1300   303.48436     -44284.929     -1403.1074     -6457.6567      3635.909     
      1400   289.2242      -44293.49       3922.6859      84.274262      3634.0791    
      1500   317.57657     -44279.1        3249.334       367.33246      3632.2493    
      1600   301.98139     -44293.808      1740.7742     -276.96832      3630.4194    
      1700   310.94884     -44295.264     -9123.3547     -5750.4828      3628.5896    
      1800   291.92106     -44289.154      5358.9086     -4696.6942      3626.7597    
      1900   305.73561     -44289.158      9432.126      -1417.2953      3624.9299    
      2000   318.40979     -44290.783      9159.8724     -596.72977      3623.1       
Loop time of 122.707 on 16 procs for 2000 steps with 366 atoms

Performance: 0.704 ns/day, 34.085 hours/ns, 16.299 timesteps/s, 5.965 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 91.412     | 93.002     | 95.171     |  14.4 | 75.79
Bond    | 0.00072141 | 0.00082843 | 0.00096736 |   0.0 |  0.00
Neigh   | 6.512      | 6.6839     | 6.8262     |   3.3 |  5.45
Comm    | 8.2625     | 10.479     | 12.137     |  43.0 |  8.54
Output  | 0.006832   | 0.018415   | 0.03032    |   5.8 |  0.02
Modify  | 11.931     | 12.152     | 12.377     |   3.5 |  9.90
Other   |            | 0.3702     |            |       |  0.30

Nlocal:          45.75 ave          56 max          35 min
Histogram: 1 0 0 0 3 2 1 0 0 1
Nghost:        3569.62 ave        3592 max        3549 min
Histogram: 2 1 0 1 0 1 0 0 2 1
Neighs:        32416.4 ave       39592 max       25028 min
Histogram: 1 0 0 0 3 2 1 0 0 1

Total # of neighbors = 259331
Ave neighs/atom = 708.55464
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 64.1469594962192
variable C2neg equal ${d2}
variable C2neg equal 53.8107726756809
variable C3neg equal ${d3}
variable C3neg equal 63.6899012398703
variable C4neg equal ${d4}
variable C4neg equal 17.5425377547214
variable C5neg equal ${d5}
variable C5neg equal -24.7246070768447
variable C6neg equal ${d6}
variable C6neg equal -4.9904042649136

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.1249
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.161249 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.161249 xy delta -0.082539 xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.161249 xy delta -0.082539 xz delta 0.006162 remap x units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.4 | 139.6 | 140.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   304.72355     -44272.42      -827.02334      0              3659.697     
       100   315.32289     -44247.738      8791.6419     -1363.9057      3661.5269    
       200   310.96894     -44263.93      -1708.2914     -11671.056      3663.3567    
       300   288.63706     -44257.454     -5788.1695     -9178.5295      3665.1866    
       400   310.90783     -44279.916     -4915.327      -12878.809      3667.0164    
       500   304.71171     -44272.353     -4176.8925     -11586.012      3668.8463    
       600   277.35032     -44257.889     -2839.0232     -10922.71       3670.6761    
       700   305.33343     -44270.052     -9508.1991     -14983.786      3672.5059    
       800   282.53243     -44272.359      744.1621      -14639.771      3674.3358    
       900   329.51521     -44267.81       7992.6745     -18597.003      3676.1656    
      1000   311.30061     -44300.902     -511.8656      -13091.532      3677.9955    
      1100   315.23977     -44295.838     -12428.911     -12633.723      3679.8253    
      1200   293.88734     -44267.41       567.49316     -14049.244      3681.6552    
      1300   304.72072     -44287.891     -2776.438      -15714.527      3683.485     
      1400   301.92669     -44267.83      -11721.447     -15565.409      3685.3149    
      1500   321.68542     -44294.714     -2471.967      -14882.109      3687.1447    
      1600   285.64631     -44277.495     -851.49036     -17212.255      3688.9746    
      1700   297.71584     -44295.326     -10625.142     -13986.541      3690.8044    
      1800   274.9978      -44272.669     -1998.7467     -13548.889      3692.6343    
      1900   304.44972     -44292.318      1065.7837     -14973.112      3694.4641    
      2000   307.20072     -44306.906     -6135.1557     -19448.868      3696.294     
Loop time of 120.61 on 16 procs for 2000 steps with 366 atoms

Performance: 0.716 ns/day, 33.503 hours/ns, 16.582 timesteps/s, 6.069 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 89.578     | 91.875     | 94.097     |  15.6 | 76.18
Bond    | 0.000752   | 0.00081783 | 0.00095987 |   0.0 |  0.00
Neigh   | 6.53       | 6.6281     | 6.7307     |   2.4 |  5.50
Comm    | 7.5361     | 9.7024     | 12.029     |  47.6 |  8.04
Output  | 0.0060107  | 0.015631   | 0.022128   |   4.7 |  0.01
Modify  | 11.872     | 12.038     | 12.159     |   2.4 |  9.98
Other   |            | 0.3491     |            |       |  0.29

Nlocal:          45.75 ave          52 max          40 min
Histogram: 1 0 3 0 0 1 1 0 1 1
Nghost:        3527.38 ave        3542 max        3512 min
Histogram: 1 2 0 0 1 0 1 1 0 2
Neighs:        31791.8 ave       36117 max       27976 min
Histogram: 1 0 3 0 0 1 1 0 1 1

Total # of neighbors = 254334
Ave neighs/atom = 694.90164
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 126.872327038677
variable C2pos equal ${d2}
variable C2pos equal -17.2828427276978
variable C3pos equal ${d3}
variable C3pos equal 44.6162047434906
variable C4pos equal ${d4}
variable C4pos equal 6.81561380458213
variable C5pos equal ${d5}
variable C5pos equal 0.930345689168513
variable C6pos equal ${d6}
variable C6pos equal 15.2887718056738

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(64.1469594962192+${C1pos})
variable C11 equal 0.5*(64.1469594962192+126.872327038677)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(53.8107726756809+${C2pos})
variable C21 equal 0.5*(53.8107726756809+-17.2828427276978)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(63.6899012398703+${C3pos})
variable C31 equal 0.5*(63.6899012398703+44.6162047434906)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(17.5425377547214+${C4pos})
variable C41 equal 0.5*(17.5425377547214+6.81561380458213)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(-24.7246070768447+${C5pos})
variable C51 equal 0.5*(-24.7246070768447+0.930345689168513)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-4.9904042649136+${C6pos})
variable C61 equal 0.5*(-4.9904042649136+15.2887718056738)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.4224
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4224
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.134224 yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.134224 yz delta 0.006491 remap x units box
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.4 | 139.6 | 140.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   304.72355     -44272.42      -827.02334      0              3659.697     
       100   315.32289     -44247.738      8800.438      -1363.7267      3657.8672    
       200   305.02166     -44248.703     -2988.651      -10701.461      3656.0373    
       300   297.96004     -44240.225     -1117.9996     -5062.751       3654.2075    
       400   314.05363     -44255.011      4848.0379     -4442.7902      3652.3776    
       500   326.04873     -44259.136      10657.684     -3098.2379      3650.5478    
       600   327.07443     -44283.324      11159.174     -2222.6958      3648.7179    
       700   316.17688     -44293.51      -1111.1172     -2729.5349      3646.8881    
       800   303.57845     -44309.94      -89.878703     -7979.3761      3645.0582    
       900   295.97727     -44299.596     -162.57427     -6913.2719      3643.2284    
      1000   280.9228      -44282.297      6626.9224     -4483.0191      3641.3985    
      1100   304.04971     -44278.807     -8095.7814     -10459.241      3639.5687    
      1200   311.01503     -44289.841      13284.683     -6978.1318      3637.7388    
      1300   299.01354     -44257.527      11125.593     -4029.9294      3635.909     
      1400   315.3041      -44305.728      7063.3077     -3416.302       3634.0791    
      1500   278.28809     -44272.525      4900.9837     -7016.8074      3632.2493    
      1600   286.91129     -44289.706      1700.1471     -6243.362       3630.4194    
      1700   284.06054     -44310.688      7665.1533     -6254.5679      3628.5896    
      1800   303.06351     -44279.302      4286.1459     -435.66964      3626.7597    
      1900   298.23684     -44293.667      3360.9516      3245.5067      3624.9299    
      2000   315.85865     -44292.532      5793.0447     -3903.2551      3623.1       
Loop time of 122.274 on 16 procs for 2000 steps with 366 atoms

Performance: 0.707 ns/day, 33.965 hours/ns, 16.357 timesteps/s, 5.987 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 90.696     | 93.543     | 95.743     |  16.7 | 76.50
Bond    | 0.0007439  | 0.00082757 | 0.0009732  |   0.0 |  0.00
Neigh   | 6.5673     | 6.7511     | 6.9117     |   4.7 |  5.52
Comm    | 7.3386     | 9.5563     | 12.429     |  52.9 |  7.82
Output  | 0.0049159  | 0.016298   | 0.028573   |   6.2 |  0.01
Modify  | 11.881     | 12.057     | 12.284     |   4.0 |  9.86
Other   |            | 0.3501     |            |       |  0.29

Nlocal:          45.75 ave          51 max          36 min
Histogram: 1 0 0 0 1 0 2 0 3 1
Nghost:        3564.75 ave        3571 max        3557 min
Histogram: 1 0 1 0 1 2 0 1 0 2
Neighs:        32401.2 ave       36194 max       25724 min
Histogram: 1 0 0 0 1 1 1 2 1 1

Total # of neighbors = 259210
Ave neighs/atom = 708.22404
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 30.6435917724475
variable C2neg equal ${d2}
variable C2neg equal 70.5393287831931
variable C3neg equal ${d3}
variable C3neg equal 101.736518060254
variable C4neg equal ${d4}
variable C4neg equal 7.5291274560221
variable C5neg equal ${d5}
variable C5neg equal -21.7026327250601
variable C6neg equal ${d6}
variable C6neg equal 6.78950456989707

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4224
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.134224 yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.134224 yz delta -0.006491 remap x units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.4 | 139.6 | 140.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   304.72355     -44272.42      -827.02334      0              3659.697     
       100   315.32289     -44247.738      8791.6419     -1363.9057      3661.5269    
       200   308.14237     -44243.205     -7974.1056     -12614.182      3663.3567    
       300   323.33339     -44287.003      6385.6965     -7527.365       3665.1866    
       400   308.84343     -44266.803      6940.4267     -6688.8898      3667.0164    
       500   314.51395     -44261.025      3462.7344     -8607.3488      3668.8463    
       600   286.30242     -44255.692     -10160.383     -5763.9145      3670.6761    
       700   299.52742     -44260.85      -4924.8271     -6857.5309      3672.5059    
       800   296.24449     -44265.682      12248.403     -4517.5889      3674.3358    
       900   309.88966     -44281.504     -768.86867     -801.99535      3676.1656    
      1000   296.73885     -44289.548     -2505.3252     -7529.7924      3677.9955    
      1100   270.39991     -44312.939     -5115.925      -6980.0294      3679.8253    
      1200   293.91654     -44279.646     -7611.147      -10994.163      3681.6552    
      1300   301.5132      -44240.475     -8913.3473     -13214.011      3683.485     
      1400   319.05629     -44258.261      1286.3423     -10162.117      3685.3149    
      1500   297.34323     -44268.597     -4834.0926     -8243.8103      3687.1447    
      1600   324.27107     -44286.304     -3631.5291     -12120.946      3688.9746    
      1700   302.07265     -44266.305     -5773.213      -7415.9814      3690.8044    
      1800   296.34764     -44265.987     -8124.6819     -7477.8967      3692.6343    
      1900   310.87681     -44304.069      2556.7577     -10183.636      3694.4641    
      2000   303.7513      -44283.784     -8690.2091     -9478.147       3696.294     
Loop time of 120.372 on 16 procs for 2000 steps with 366 atoms

Performance: 0.718 ns/day, 33.437 hours/ns, 16.615 timesteps/s, 6.081 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 87.512     | 91.472     | 93.919     |  20.7 | 75.99
Bond    | 0.00071553 | 0.00080547 | 0.0010137  |   0.0 |  0.00
Neigh   | 6.3752     | 6.6187     | 6.7411     |   4.6 |  5.50
Comm    | 7.4391     | 9.8658     | 13.881     |  64.0 |  8.20
Output  | 0.0058032  | 0.012838   | 0.020411   |   4.4 |  0.01
Modify  | 11.836     | 12.011     | 12.267     |   3.8 |  9.98
Other   |            | 0.3909     |            |       |  0.32

Nlocal:          45.75 ave          53 max          34 min
Histogram: 1 0 0 0 1 1 2 1 1 1
Nghost:        3494.88 ave        3535 max        3451 min
Histogram: 1 0 0 2 1 1 1 0 1 1
Neighs:        31773.5 ave       36761 max       23870 min
Histogram: 1 0 0 0 1 1 2 1 1 1

Total # of neighbors = 254188
Ave neighs/atom = 694.50273
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 25.8440010303687
variable C2pos equal ${d2}
variable C2pos equal 43.9875126279174
variable C3pos equal ${d3}
variable C3pos equal 0.506109409434186
variable C4pos equal ${d4}
variable C4pos equal 4.80940393564874
variable C5pos equal ${d5}
variable C5pos equal 10.8543780669997
variable C6pos equal ${d6}
variable C6pos equal 4.22992066929282

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(30.6435917724475+${C1pos})
variable C12 equal 0.5*(30.6435917724475+25.8440010303687)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(70.5393287831931+${C2pos})
variable C22 equal 0.5*(70.5393287831931+43.9875126279174)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(101.736518060254+${C3pos})
variable C32 equal 0.5*(101.736518060254+0.506109409434186)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(7.5291274560221+${C4pos})
variable C42 equal 0.5*(7.5291274560221+4.80940393564874)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(-21.7026327250601+${C5pos})
variable C52 equal 0.5*(-21.7026327250601+10.8543780669997)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(6.78950456989707+${C6pos})
variable C62 equal 0.5*(6.78950456989707+4.22992066929282)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.909
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.909
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 -0.16909 remap x units box
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.3 | 139.5 | 140.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   304.72355     -44272.42      -827.02334      0              3659.697     
       100   315.32289     -44247.738      8800.438      -1363.7267      3657.8672    
       200   307.51215     -44264.728     -2739.4418     -9661.5966      3656.0373    
       300   311.73987     -44261.667      1988.9194     -6800.676       3654.2075    
       400   285.69136     -44265.414      6887.897      -7384.0578      3652.3776    
       500   277.31235     -44238.164     -9908.5448     -9582.28        3650.5478    
       600   301.92721     -44270.275      6623.5407     -6666.4118      3648.7179    
       700   298.72842     -44286.256      5452.4486     -1497.5428      3646.8881    
       800   287.48292     -44283.985      2008.9806     -1635.1639      3645.0582    
       900   294.64453     -44283.284      5150.1556     -4674.1668      3643.2284    
      1000   296.0502      -44264.55       8363.7515      222.46917      3641.3985    
      1100   311.59788     -44238.774      7488.03        3204.3189      3639.5687    
      1200   296.11249     -44263.077     -1788.2557     -4707.3866      3637.7388    
      1300   287.27836     -44250.607      6401.1684     -3056.9197      3635.909     
      1400   312.07574     -44279.454      1747.0152     -12001.606      3634.0791    
      1500   333.65649     -44288.776      3496.1819     -3047.0276      3632.2493    
      1600   317.30595     -44296.28       2664.4561     -1456.7436      3630.4194    
      1700   312.68225     -44300.227      14319.486     -3220.931       3628.5896    
      1800   323.82797     -44320.485     -88.701885     -1616.5141      3626.7597    
      1900   303.97611     -44272.779      877.57893     -4774.5277      3624.9299    
      2000   317.13087     -44319.254      5677.2643     -3137.849       3623.1       
Loop time of 123.537 on 16 procs for 2000 steps with 366 atoms

Performance: 0.699 ns/day, 34.316 hours/ns, 16.189 timesteps/s, 5.925 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 92.688     | 94.561     | 97.517     |  14.2 | 76.54
Bond    | 0.00070217 | 0.00080622 | 0.00097837 |   0.0 |  0.00
Neigh   | 6.6306     | 6.8099     | 6.9081     |   3.3 |  5.51
Comm    | 6.6979     | 9.6568     | 11.507     |  44.4 |  7.82
Output  | 0.0066128  | 0.012959   | 0.016857   |   3.3 |  0.01
Modify  | 11.975     | 12.113     | 12.31      |   2.9 |  9.81
Other   |            | 0.3824     |            |       |  0.31

Nlocal:          45.75 ave          55 max          35 min
Histogram: 1 0 0 1 2 1 0 1 1 1
Nghost:        3587.62 ave        3653 max        3525 min
Histogram: 1 0 1 1 2 0 1 1 0 1
Neighs:        32410.2 ave       38782 max       25308 min
Histogram: 1 0 0 2 1 1 0 1 1 1

Total # of neighbors = 259282
Ave neighs/atom = 708.42077
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 38.399069275658
variable C2neg equal ${d2}
variable C2neg equal 10.3836293931654
variable C3neg equal ${d3}
variable C3neg equal 125.150661062096
variable C4neg equal ${d4}
variable C4neg equal -1.55561670046485
variable C5neg equal ${d5}
variable C5neg equal -12.7222242225588
variable C6neg equal ${d6}
variable C6neg equal -14.5143559904128

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.909
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 0.16909 remap x units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.3 | 139.5 | 140.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   304.72355     -44272.42      -827.02334      0              3659.697     
       100   315.32289     -44247.738      8791.6419     -1363.9057      3661.5269    
       200   308.76365     -44266.36      -4154.5799     -10202.993      3663.3567    
       300   312.44147     -44263.883     -2841.5074     -8103.5245      3665.1866    
       400   291.554       -44243.177     -6434.7173     -13531.026      3667.0164    
       500   319.87002     -44260.535      2244.6494     -11994.63       3668.8463    
       600   341.16023     -44261.771     -4322.1144     -9691.1056      3670.6761    
       700   314.69907     -44277.295     -11639.183     -15984.392      3672.5059    
       800   299.36014     -44288.334     -6755.3183     -15210.977      3674.3358    
       900   292.90854     -44295.662     -9754.4145     -11353.332      3676.1656    
      1000   295.25134     -44296.205      7898.3451     -11415.49       3677.9955    
      1100   285.7578      -44297.981     -16498.228     -11502.243      3679.8253    
      1200   287.88173     -44304.562     -6544.6467     -11978.621      3681.6552    
      1300   283.42079     -44295.881     -14393.493     -15645.833      3683.485     
      1400   285.99931     -44291.601     -4888.3495     -10271.851      3685.3149    
      1500   303.88261     -44279.04      -3566.8893     -12889.267      3687.1447    
      1600   300.38085     -44286.879     -6363.2648     -10782.628      3688.9746    
      1700   291.39764     -44297.131     -6940.2657     -8885.161       3690.8044    
      1800   304.09181     -44280.601      954.91252     -11434.735      3692.6343    
      1900   299.32258     -44286.581     -13497.94      -7187.8777      3694.4641    
      2000   293.58824     -44304.988      4196.4206     -5385.5924      3696.294     
Loop time of 121.947 on 16 procs for 2000 steps with 366 atoms

Performance: 0.709 ns/day, 33.874 hours/ns, 16.401 timesteps/s, 6.003 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 91.234     | 92.757     | 95.983     |  14.5 | 76.06
Bond    | 0.00073209 | 0.00082723 | 0.00099192 |   0.0 |  0.00
Neigh   | 6.6413     | 6.7643     | 6.8616     |   2.3 |  5.55
Comm    | 6.7837     | 9.9885     | 11.507     |  43.9 |  8.19
Output  | 0.007137   | 0.011826   | 0.015762   |   2.7 |  0.01
Modify  | 11.93      | 12.041     | 12.167     |   1.8 |  9.87
Other   |            | 0.3833     |            |       |  0.31

Nlocal:          45.75 ave          54 max          37 min
Histogram: 1 1 2 0 0 0 0 1 2 1
Nghost:        3536.12 ave        3582 max        3498 min
Histogram: 1 0 2 1 1 1 0 0 1 1
Neighs:        31751.5 ave       37343 max       26151 min
Histogram: 1 1 2 0 0 0 0 2 1 1

Total # of neighbors = 254012
Ave neighs/atom = 694.02186
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -15.6238088073596
variable C2pos equal ${d2}
variable C2pos equal 13.9954952802534
variable C3pos equal ${d3}
variable C3pos equal 27.4806632953676
variable C4pos equal ${d4}
variable C4pos equal 4.54403475850494
variable C5pos equal ${d5}
variable C5pos equal 14.0893508053335
variable C6pos equal ${d6}
variable C6pos equal 4.60238109072685

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(38.399069275658+${C1pos})
variable C13 equal 0.5*(38.399069275658+-15.6238088073596)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(10.3836293931654+${C2pos})
variable C23 equal 0.5*(10.3836293931654+13.9954952802534)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(125.150661062096+${C3pos})
variable C33 equal 0.5*(125.150661062096+27.4806632953676)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-1.55561670046485+${C4pos})
variable C43 equal 0.5*(-1.55561670046485+4.54403475850494)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-12.7222242225588+${C5pos})
variable C53 equal 0.5*(-12.7222242225588+14.0893508053335)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-14.5143559904128+${C6pos})
variable C63 equal 0.5*(-14.5143559904128+4.60238109072685)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.909
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.909
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta -0.16909 remap x units box
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.4 | 139.6 | 140.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   304.72355     -44272.42      -827.02334      0              3659.697     
       100   315.32289     -44247.738      8796.0377     -1363.8163      3659.697     
       200   297.18536     -44261.724     -6956.4497     -13105.071      3659.697     
       300   309.71678     -44265.383     -2518.0485     -7173.2283      3659.697     
       400   294.47906     -44234.312     -7987.8727     -7082.4052      3659.697     
       500   303.41093     -44258.382     -9392.1234     -7727.0814      3659.697     
       600   318.28649     -44290.19      -423.98892     -8172.027       3659.697     
       700   304.88392     -44289.859      3494.6816     -15923.725      3659.697     
       800   288.59015     -44287.818     -2472.7614     -10726.777      3659.697     
       900   298.81917     -44305.117     -11847.524     -16966.412      3659.697     
      1000   315.51605     -44296.785      8024.5202     -8194.7251      3659.697     
      1100   312.09644     -44285.385     -53.454937     -11839.197      3659.697     
      1200   288.52376     -44285.743     -8383.0378     -7462.6885      3659.697     
      1300   320.83186     -44275.99       1232.593      -9937.4672      3659.697     
      1400   316.98394     -44287.506     -4829.2662     -10697.624      3659.697     
      1500   273.92622     -44281.47      -5549.3126     -11425.21       3659.697     
      1600   305.63231     -44309.938     -4338.9108     -13996.36       3659.697     
      1700   293.03362     -44313.527     -1188.6631     -13267.501      3659.697     
      1800   285.17375     -44300.149     -5367.7076     -11981.561      3659.697     
      1900   290.70959     -44297.085     -2037.1788     -7543.6496      3659.697     
      2000   322.83508     -44295.251      9493.0506     -10314.194      3659.697     
Loop time of 121.775 on 16 procs for 2000 steps with 366 atoms

Performance: 0.710 ns/day, 33.826 hours/ns, 16.424 timesteps/s, 6.011 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 90.657     | 92.934     | 95.514     |  15.7 | 76.32
Bond    | 0.00074636 | 0.00081938 | 0.00095851 |   0.0 |  0.00
Neigh   | 6.5586     | 6.6943     | 6.8296     |   3.0 |  5.50
Comm    | 7.1108     | 9.6824     | 11.904     |  47.8 |  7.95
Output  | 0.0063789  | 0.016514   | 0.027729   |   5.7 |  0.01
Modify  | 11.965     | 12.08      | 12.222     |   2.5 |  9.92
Other   |            | 0.3668     |            |       |  0.30

Nlocal:          45.75 ave          52 max          36 min
Histogram: 1 0 0 0 0 3 1 1 1 1
Nghost:        3542.12 ave        3557 max        3519 min
Histogram: 1 0 1 0 1 0 0 3 0 2
Neighs:        32092.2 ave       36491 max       25453 min
Histogram: 1 0 0 0 1 2 1 1 1 1

Total # of neighbors = 256738
Ave neighs/atom = 701.46995
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -34.315246043365
variable C2neg equal ${d2}
variable C2neg equal 11.2071804303861
variable C3neg equal ${d3}
variable C3neg equal 25.6694108902998
variable C4neg equal ${d4}
variable C4neg equal -0.71342760440215
variable C5neg equal ${d5}
variable C5neg equal -16.5507934949158
variable C6neg equal ${d6}
variable C6neg equal -8.88811333399809

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.909
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta 0.16909 remap x units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.4 | 139.6 | 140.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   304.72355     -44272.42      -827.02334      0              3659.697     
       100   315.32289     -44247.738      8796.0377     -1363.8163      3659.697     
       200   305.41133     -44249.083     -3571.9878     -10995.562      3659.697     
       300   299.35751     -44234.423     -1467.8866     -5460.5014      3659.697     
       400   318.74902     -44256.838      8787.9574     -6233.9537      3659.697     
       500   294.95605     -44249.017     -4208.8117     -630.54912      3659.697     
       600   311.76715     -44271.175     -2982.346      -7267.0624      3659.697     
       700   291.45765     -44261.59      -9037.9794     -6473.7073      3659.697     
       800   305.67691     -44288.38       3472.5801     -5947.934       3659.697     
       900   296.65116     -44298.922     -10210.508     -9074.676       3659.697     
      1000   312.90853     -44273.341      5198.3664     -8271.4315      3659.697     
      1100   287.76161     -44294.258      2070.9324     -12744.629      3659.697     
      1200   302.64893     -44300.042      4466.9899     -9870.5606      3659.697     
      1300   303.01335     -44287.256      456.31316     -5220.4969      3659.697     
      1400   304.40287     -44277.655     -7345.1393     -3940.2473      3659.697     
      1500   319.11094     -44278.165      5134.5944     -94.592617      3659.697     
      1600   327.7707      -44251.303     -8639.6646     -3184.2853      3659.697     
      1700   293.98913     -44269.456     -2674.8012     -5569.0401      3659.697     
      1800   321.87522     -44259.761     -3233.9245     -2649.0747      3659.697     
      1900   279.38027     -44253.086     -2791.8748     -2927.6235      3659.697     
      2000   303.94122     -44270.765      1386.472      -3689.0479      3659.697     
Loop time of 121.778 on 16 procs for 2000 steps with 366 atoms

Performance: 0.709 ns/day, 33.827 hours/ns, 16.423 timesteps/s, 6.011 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 91.785     | 93.013     | 94.521     |   8.2 | 76.38
Bond    | 0.00072437 | 0.00082622 | 0.00094247 |   0.0 |  0.00
Neigh   | 6.5968     | 6.671      | 6.8368     |   3.2 |  5.48
Comm    | 8.1599     | 9.7083     | 10.932     |  25.7 |  7.97
Output  | 0.0051775  | 0.015462   | 0.022505   |   5.2 |  0.01
Modify  | 11.777     | 12.026     | 12.122     |   3.2 |  9.88
Other   |            | 0.3433     |            |       |  0.28

Nlocal:          45.75 ave          55 max          35 min
Histogram: 1 0 0 1 1 2 1 0 0 2
Nghost:        3551.62 ave        3566 max        3538 min
Histogram: 2 0 1 1 0 1 0 0 2 1
Neighs:        32080.8 ave       38231 max       24830 min
Histogram: 1 0 1 0 1 3 0 0 0 2

Total # of neighbors = 256646
Ave neighs/atom = 701.21858
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -32.8140463644499
variable C2pos equal ${d2}
variable C2pos equal 19.9602296325763
variable C3pos equal ${d3}
variable C3pos equal -31.9564187207681
variable C4pos equal ${d4}
variable C4pos equal 7.19649790304332
variable C5pos equal ${d5}
variable C5pos equal 6.69672541689747
variable C6pos equal ${d6}
variable C6pos equal 4.81884338091853

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-34.315246043365+${C1pos})
variable C14 equal 0.5*(-34.315246043365+-32.8140463644499)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(11.2071804303861+${C2pos})
variable C24 equal 0.5*(11.2071804303861+19.9602296325763)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(25.6694108902998+${C3pos})
variable C34 equal 0.5*(25.6694108902998+-31.9564187207681)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(-0.71342760440215+${C4pos})
variable C44 equal 0.5*(-0.71342760440215+7.19649790304332)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-16.5507934949158+${C5pos})
variable C54 equal 0.5*(-16.5507934949158+6.69672541689747)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-8.88811333399809+${C6pos})
variable C64 equal 0.5*(-8.88811333399809+4.81884338091853)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.909
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.909
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta -0.16909 remap x units box
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.4 | 139.6 | 140.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   304.72355     -44272.42      -827.02334      0              3659.697     
       100   315.32289     -44247.738      8796.0377     -1363.8163      3659.697     
       200   318.88615     -44242.399     -8624.2726     -12650.355      3659.697     
       300   313.27539     -44299.52       4630.0352     -9790.1826      3659.697     
       400   295.27634     -44268.593     -4198.4568     -9085.6381      3659.697     
       500   292.09284     -44237.196     -1817.9297     -6575.975       3659.697     
       600   294.09565     -44294.03      -990.59531     -8963.5545      3659.697     
       700   284.13353     -44282.341      9916.3681     -8753.0068      3659.697     
       800   327.59525     -44294.266     -13244.726     -12600.342      3659.697     
       900   298.7888      -44286.925     -87.327294     -12116.527      3659.697     
      1000   305.7925      -44261.912      4621.0575     -10953.174      3659.697     
      1100   297.14001     -44293.468     -6064.343      -11877.897      3659.697     
      1200   317.29718     -44274.342     -6843.0398     -12693.385      3659.697     
      1300   298.54941     -44269.355      4370.7252     -10803.225      3659.697     
      1400   317.97896     -44251.302      7467.3895     -3218.6436      3659.697     
      1500   289.14569     -44234.048      3187.8864     -4408.4855      3659.697     
      1600   294.41328     -44241.446     -9491.9651     -9441.6678      3659.697     
      1700   316.69733     -44278.428     -3464.9857     -11454.175      3659.697     
      1800   316.92527     -44276.205      1744.4796     -5921.4171      3659.697     
      1900   297.62388     -44263.161      2492.4769      306.41704      3659.697     
      2000   309.85481     -44282.153      1328.2123     -6574.3434      3659.697     
Loop time of 120.381 on 16 procs for 2000 steps with 366 atoms

Performance: 0.718 ns/day, 33.439 hours/ns, 16.614 timesteps/s, 6.081 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.812     | 91.835     | 95.259     |  17.1 | 76.29
Bond    | 0.00076202 | 0.00083143 | 0.00096209 |   0.0 |  0.00
Neigh   | 6.4234     | 6.6172     | 6.8351     |   4.9 |  5.50
Comm    | 6.2657     | 9.7287     | 12.741     |  52.7 |  8.08
Output  | 0.0051836  | 0.012256   | 0.017063   |   3.9 |  0.01
Modify  | 11.637     | 11.856     | 12.003     |   3.5 |  9.85
Other   |            | 0.3308     |            |       |  0.27

Nlocal:          45.75 ave          52 max          40 min
Histogram: 2 1 0 0 0 2 0 1 1 1
Nghost:        3534.62 ave        3562 max        3506 min
Histogram: 1 0 2 0 0 2 0 2 0 1
Neighs:        32093.8 ave       36491 max       28242 min
Histogram: 2 1 0 0 1 1 0 1 1 1

Total # of neighbors = 256750
Ave neighs/atom = 701.50273
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 3.57878908520335
variable C2neg equal ${d2}
variable C2neg equal -16.212092446277
variable C3neg equal ${d3}
variable C3neg equal 24.0179838920529
variable C4neg equal ${d4}
variable C4neg equal 5.96395641031456
variable C5neg equal ${d5}
variable C5neg equal 4.01212719991233
variable C6neg equal ${d6}
variable C6neg equal 7.13761730413892

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.909
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta 0.16909 remap x units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.4 | 139.6 | 140.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   304.72355     -44272.42      -827.02334      0              3659.697     
       100   315.32289     -44247.738      8796.0377     -1363.8163      3659.697     
       200   304.97179     -44249.104     -3262.4106     -11016.856      3659.697     
       300   295.91922     -44234.295     -2616.1859     -5615.6186      3659.697     
       400   308.8311      -44267.342     -6928.2112     -8944.0428      3659.697     
       500   300.66585     -44261.618     -2104.9072     -11425.89       3659.697     
       600   298.5109      -44256.796      665.59052     -13187.774      3659.697     
       700   292.19846     -44286.734     -1031.1671     -11474.08       3659.697     
       800   328.34309     -44309.473      2503.1539     -11502.341      3659.697     
       900   298.95392     -44315.787     -3774.2045     -7937.5888      3659.697     
      1000   299.59995     -44291.99      -3688.7945     -12630.41       3659.697     
      1100   317.69168     -44280.204      1454.6787     -10373.055      3659.697     
      1200   300.82845     -44265.837     -6184.4506     -7690.6284      3659.697     
      1300   301.8626      -44286.9        4174.6413     -9323.2807      3659.697     
      1400   313.19152     -44273.038     -8608.8664     -13752.532      3659.697     
      1500   284.55435     -44281.786     -5468.4554     -7935.6451      3659.697     
      1600   295.59925     -44277.022      1998.4552     -8458.018       3659.697     
      1700   322.34066     -44276.105      232.40637     -9674.598       3659.697     
      1800   304.26013     -44276.814      1534.0948     -9667.3808      3659.697     
      1900   303.91302     -44291.427      1707.053      -10014.641      3659.697     
      2000   300.5078      -44284.908     -3791.9506     -12098.651      3659.697     
Loop time of 104.49 on 16 procs for 2000 steps with 366 atoms

Performance: 0.827 ns/day, 29.025 hours/ns, 19.141 timesteps/s, 7.005 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.555     | 73.047     | 86.219     | 106.9 | 69.91
Bond    | 0.00062769 | 0.00072675 | 0.00082365 |   0.0 |  0.00
Neigh   | 4.9698     | 5.747      | 6.674      |  26.2 |  5.50
Comm    | 1.565      | 14.738     | 26.237     | 238.0 | 14.10
Output  | 0.0038843  | 0.0059309  | 0.0070453  |   1.5 |  0.01
Modify  | 9.9751     | 10.902     | 11.678     |  19.1 | 10.43
Other   |            | 0.04938    |            |       |  0.05

Nlocal:          45.75 ave          53 max          39 min
Histogram: 2 0 1 2 0 0 0 0 0 3
Nghost:         3544.5 ave        3573 max        3522 min
Histogram: 1 0 2 1 1 1 1 0 0 1
Neighs:        32112.6 ave       37145 max       27484 min
Histogram: 2 0 1 2 0 0 0 0 0 3

Total # of neighbors = 256901
Ave neighs/atom = 701.9153
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 52.3962542211971
variable C2pos equal ${d2}
variable C2pos equal -5.42997901279983
variable C3pos equal ${d3}
variable C3pos equal -26.802320031658
variable C4pos equal ${d4}
variable C4pos equal 8.18937216073418
variable C5pos equal ${d5}
variable C5pos equal 16.8388376955406
variable C6pos equal ${d6}
variable C6pos equal 4.05541455175789

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(3.57878908520335+${C1pos})
variable C15 equal 0.5*(3.57878908520335+52.3962542211971)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-16.212092446277+${C2pos})
variable C25 equal 0.5*(-16.212092446277+-5.42997901279983)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(24.0179838920529+${C3pos})
variable C35 equal 0.5*(24.0179838920529+-26.802320031658)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(5.96395641031456+${C4pos})
variable C45 equal 0.5*(5.96395641031456+8.18937216073418)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(4.01212719991233+${C5pos})
variable C55 equal 0.5*(4.01212719991233+16.8388376955406)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(7.13761730413892+${C6pos})
variable C65 equal 0.5*(7.13761730413892+4.05541455175789)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.4224

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4224
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta -0.134224 remap x units box

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.4 | 139.6 | 140.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   304.72355     -44272.42      -827.02334      0              3659.697     
       100   315.32289     -44247.738      8796.0377     -1363.8163      3659.697     
       200   308.04637     -44249.278     -5257.4771     -12414.75       3659.697     
       300   316.48494     -44275.673      1948.4121     -5240.5846      3659.697     
       400   310.02801     -44274.541      4878.6736     -5560.4336      3659.697     
       500   319.62684     -44256.078     -1973.803      -14850.487      3659.697     
       600   300.25115     -44258.661      2331.7766     -8198.3606      3659.697     
       700   303.31851     -44273.383      2638.8179     -11315.603      3659.697     
       800   315.82411     -44291.039     -9526.5257     -14029.292      3659.697     
       900   303.51713     -44288.573     -239.02036     -7046.026       3659.697     
      1000   296.34066     -44288.799     -551.04153     -4540.4833      3659.697     
      1100   289.61494     -44271.143     -8775.7409     -6661.1319      3659.697     
      1200   314.01787     -44291.172      894.00611     -8462.6419      3659.697     
      1300   309.46327     -44280.51      -7547.2616     -11125.435      3659.697     
      1400   322.68684     -44274.897      1876.5297     -4231.9569      3659.697     
      1500   304.76024     -44269.255     -18004.476     -16895.619      3659.697     
      1600   316.0891      -44317.318      2353.4572     -18891.47       3659.697     
      1700   291.39865     -44278.922     -7744.6519     -13656.557      3659.697     
      1800   287.27013     -44305.908      4720.3534     -11398.85       3659.697     
      1900   290.48361     -44284.05      -4208.0185     -11480.783      3659.697     
      2000   295.74745     -44279.143     -820.08751     -12217.857      3659.697     
Loop time of 64.9771 on 16 procs for 2000 steps with 366 atoms

Performance: 1.330 ns/day, 18.049 hours/ns, 30.780 timesteps/s, 11.266 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 48.871     | 50.272     | 51.609     |  11.1 | 77.37
Bond    | 0.00040627 | 0.00048884 | 0.00057821 |   0.0 |  0.00
Neigh   | 4.8433     | 4.9109     | 5.0087     |   2.9 |  7.56
Comm    | 0.59119    | 1.9274     | 3.3264     |  56.6 |  2.97
Output  | 0.003046   | 0.005107   | 0.0062301  |   1.7 |  0.01
Modify  | 7.7158     | 7.8131     | 7.8809     |   2.3 | 12.02
Other   |            | 0.04819    |            |       |  0.07

Nlocal:          45.75 ave          50 max          36 min
Histogram: 1 0 0 0 1 0 1 0 3 2
Nghost:         3537.5 ave        3568 max        3501 min
Histogram: 1 0 1 0 1 0 2 2 0 1
Neighs:        32101.6 ave       35156 max       25550 min
Histogram: 1 0 0 0 1 0 1 0 3 2

Total # of neighbors = 256813
Ave neighs/atom = 701.67486
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -53.6041080196292
variable C2neg equal ${d2}
variable C2neg equal -18.2112815988511
variable C3neg equal ${d3}
variable C3neg equal -10.3040929499269
variable C4neg equal ${d4}
variable C4neg equal 10.8032155590244
variable C5neg equal ${d5}
variable C5neg equal -6.10085899541115
variable C6neg equal ${d6}
variable C6neg equal 26.6940938562895

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4224
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta 0.134224 remap x units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.4 | 139.6 | 140.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   304.72355     -44272.42      -827.02334      0              3659.697     
       100   315.32289     -44247.738      8796.0377     -1363.8163      3659.697     
       200   305.38772     -44249.913     -3131.9413     -11020.998      3659.697     
       300   296.09815     -44234.326     -3131.4519     -5552.933       3659.697     
       400   326.6776      -44268.389      1015.2229     -8669.3266      3659.697     
       500   301.97442     -44295.274     -6130.2049     -8070.9411      3659.697     
       600   314.42704     -44278.686     -7669.4083     -3429.0243      3659.697     
       700   266.42097     -44256.992      275.41149     -7102.6384      3659.697     
       800   300.39113     -44267.417     -4037.3644     -7870.645       3659.697     
       900   305.72129     -44266.127     -4099.4548     -12197.267      3659.697     
      1000   314.22992     -44272.615     -3364.3252     -14187.587      3659.697     
      1100   299.07632     -44286.994      3519.1845     -11942.445      3659.697     
      1200   281.47944     -44300.36      -5074.6375     -12520.99       3659.697     
      1300   302.04861     -44275.066     -674.85662     -12413.629      3659.697     
      1400   320.34309     -44282.218     -8469.1713     -11802.122      3659.697     
      1500   298.81781     -44287.523     -371.40259     -16132.651      3659.697     
      1600   300.31705     -44262.809      2652.4689     -10443.446      3659.697     
      1700   296.08985     -44244.963      5298.2065     -9589.2943      3659.697     
      1800   302.88832     -44272.776      242.18489     -7266.3108      3659.697     
      1900   302.60089     -44260.827     -10366.219     -13676.824      3659.697     
      2000   296.01174     -44251.169      2340.3422     -11097.132      3659.697     
Loop time of 62.9413 on 16 procs for 2000 steps with 366 atoms

Performance: 1.373 ns/day, 17.484 hours/ns, 31.776 timesteps/s, 11.630 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.805     | 48.278     | 49.721     |  12.2 | 76.70
Bond    | 0.00034774 | 0.00043389 | 0.00052533 |   0.0 |  0.00
Neigh   | 4.8205     | 4.9211     | 5.0437     |   3.6 |  7.82
Comm    | 0.58611    | 2.0304     | 3.5028     |  59.4 |  3.23
Output  | 0.0029143  | 0.0054616  | 0.0067864  |   2.0 |  0.01
Modify  | 7.5347     | 7.658      | 7.7585     |   2.9 | 12.17
Other   |            | 0.04788    |            |       |  0.08

Nlocal:          45.75 ave          52 max          36 min
Histogram: 1 0 0 1 0 1 1 3 0 1
Nghost:        3556.12 ave        3596 max        3513 min
Histogram: 1 0 0 2 1 0 2 1 0 1
Neighs:        32082.4 ave       36482 max       25504 min
Histogram: 1 0 0 1 0 1 1 3 0 1

Total # of neighbors = 256659
Ave neighs/atom = 701.2541
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 42.24836759866
variable C2pos equal ${d2}
variable C2pos equal 43.0785193743028
variable C3pos equal ${d3}
variable C3pos equal -39.615807849429
variable C4pos equal ${d4}
variable C4pos equal 6.58231226513063
variable C5pos equal ${d5}
variable C5pos equal 1.80543677639223
variable C6pos equal ${d6}
variable C6pos equal 3.13938186498844

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-53.6041080196292+${C1pos})
variable C16 equal 0.5*(-53.6041080196292+42.24836759866)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-18.2112815988511+${C2pos})
variable C26 equal 0.5*(-18.2112815988511+43.0785193743028)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-10.3040929499269+${C3pos})
variable C36 equal 0.5*(-10.3040929499269+-39.615807849429)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(10.8032155590244+${C4pos})
variable C46 equal 0.5*(10.8032155590244+6.58231226513063)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(-6.10085899541115+${C5pos})
variable C56 equal 0.5*(-6.10085899541115+1.80543677639223)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(26.6940938562895+${C6pos})
variable C66 equal 0.5*(26.6940938562895+3.13938186498844)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 95.5096432674481
variable C22all equal ${C22}
variable C22all equal 57.2634207055552
variable C33all equal ${C33}
variable C33all equal 76.3156621787318

variable C44all equal ${C44}
variable C44all equal 3.24153514932059
variable C55all equal ${C55}
variable C55all equal 10.4254824477265
variable C66all equal ${C66}
variable C66all equal 14.916737860639

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(28.2437964014081+${C21})
variable C12all equal 0.5*(28.2437964014081+18.2639649739915)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(11.3876302341492+${C31})
variable C13all equal 0.5*(11.3876302341492+54.1530529916805)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(12.1895623367094+${C32})
variable C23all equal 0.5*(12.1895623367094+51.1213137348441)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-33.5646462039075+${C41})
variable C14all equal 0.5*(-33.5646462039075+12.1790757796518)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(27.9875216532002+${C51})
variable C15all equal 0.5*(27.9875216532002+-11.8971306938381)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-5.6778702104846+${C61})
variable C16all equal 0.5*(-5.6778702104846+5.1491837703801)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(15.5837050314812+${C42})
variable C24all equal 0.5*(15.5837050314812+6.16926569583542)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-10.8210357295384+${C52})
variable C25all equal 0.5*(-10.8210357295384+-5.4241273290302)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(12.4336188877258+${C62})
variable C26all equal 0.5*(12.4336188877258+5.50971261959494)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(-3.14350391523415+${C43})
variable C34all equal 0.5*(-3.14350391523415+1.49420902902004)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-1.39216806980255+${C53})
variable C35all equal 0.5*(-1.39216806980255+0.68356329138735)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-24.959950399678+${C63})
variable C36all equal 0.5*(-24.959950399678+-4.95598744984298)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(7.07666428552437+${C54})
variable C45all equal 0.5*(7.07666428552437+-4.92703403900917)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(8.69276391207752+${C64})
variable C46all equal 0.5*(8.69276391207752+-2.03463497653978)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-2.14771110950946+${C65})
variable C56all equal 0.5*(-2.14771110950946+5.5965159279484)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by deform-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:24:10
