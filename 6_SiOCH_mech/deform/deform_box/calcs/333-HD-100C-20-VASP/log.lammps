LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.1                  # the deformation magnitude 0.01

variable FF string "CHONSi.ff C H O Si"   # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si
variable structure string 333-HD-100C-20-VASP

# Read the initial sctructure
# box tilt large
read_data       ${structure}.data
read_data       333-HD-100C-20-VASP.data
Reading data file ...
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.013 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -29.52 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 140.6 | 142.4 | 144 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0             -43286.839      0             -43286.839      41222.248    
        27   0             -44352.241      0             -44352.241     -1424.8718    
Loop time of 2.98204 on 16 procs for 27 steps with 366 atoms

97.4% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
     -43286.8393425787  -44352.2393605177  -44352.2405449269
  Force two-norm initial, final = 1044.8818 189.24856
  Force max component initial, final = 178.65596 70.851755
  Final line search alpha, max atom move = 0.0015771433 0.11174337
  Iterations, force evaluations = 27 63

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 1.712      | 2.006      | 2.3697     |  12.7 | 67.27
Bond    | 1.7699e-05 | 2.4324e-05 | 2.8375e-05 |   0.0 |  0.00
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.10231    | 0.46612    | 0.76015    |  26.4 | 15.63
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0.50617    | 0.50636    | 0.50668    |   0.0 | 16.98
Other   |            | 0.003487   |            |       |  0.12

Nlocal:          45.75 ave          58 max          36 min
Histogram: 1 0 2 1 1 1 1 0 0 1
Nghost:        3580.38 ave        3618 max        3535 min
Histogram: 1 2 0 1 0 0 0 0 2 2
Neighs:        32033.9 ave       39916 max       25708 min
Histogram: 1 0 2 1 1 1 1 0 0 1

Total # of neighbors = 256271
Ave neighs/atom = 700.19399
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-HD-100C-20-VASP_opt.data
System init for write_data ...
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 139 | 140.8 | 142.3 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -44352.24       2652.5456      1.9525358      3659.697     
       100   221.56833     -44228.915      407.40137      1.9525358      3659.697     
       200   263.34549     -44214.651      11909.14       1.9525358      3659.697     
       300   301.58638     -44198.916     -2391.9057      1.9525358      3659.697     
       400   314.50067     -44178.407     -4222.2272      1.9525358      3659.697     
       500   318.78053     -44186.951     -897.37378      1.9525358      3659.697     
       600   299.8655      -44214.55      -1255.4049      1.9525358      3659.697     
       700   313.06258     -44265.419     -3470.2835      1.9525358      3659.697     
       800   283.24895     -44259.694     -734.37469      1.9525358      3659.697     
       900   285.42758     -44252.508     -5051.7215      1.9525358      3659.697     
      1000   308.60102     -44243.533      8277.2003      1.9525358      3659.697     
      1100   306.73979     -44226.486     -1340.6028      1.9525358      3659.697     
      1200   313.79735     -44237.181     -4644.4502      1.9525358      3659.697     
      1300   316.34423     -44270.388     -5695.2466      1.9525358      3659.697     
      1400   291.95821     -44263.262     -4213.5383      1.9525358      3659.697     
      1500   299.78373     -44276.436      10884.417      1.9525358      3659.697     
      1600   288.61042     -44272.28      -4961.5345      1.9525358      3659.697     
      1700   310.10974     -44295.12      -822.58786      1.9525358      3659.697     
      1800   306.06711     -44280.699     -85.062415      1.9525358      3659.697     
      1900   311.40131     -44284.374     -8079.2488      1.9525358      3659.697     
      2000   280.6217      -44276.579     -5470.6208      1.9525358      3659.697     
      2100   280.57915     -44293.753     -7026.4976      1.9525358      3659.697     
      2200   299.23175     -44309.76       6983.3385      1.9525358      3659.697     
      2300   311.31638     -44287.809      5834.7863      1.9525358      3659.697     
      2400   328.7808      -44280.295      2122.5681      1.9525358      3659.697     
      2500   327.5925      -44293.135     -7810.8158      1.9525358      3659.697     
      2600   301.33026     -44289.901      6346.8509      1.9525358      3659.697     
      2700   300.66692     -44299.36       10797.491      1.9525358      3659.697     
      2800   298.87155     -44294.513      296.86254      1.9525358      3659.697     
      2900   298.39014     -44290.671     -2746.2416      1.9525358      3659.697     
      3000   294.86078     -44300.825     -2806.029       1.9525358      3659.697     
      3100   311.92588     -44314.106      866.46086      1.9525358      3659.697     
      3200   313.19592     -44300.875     -5747.762       1.9525358      3659.697     
      3300   323.11284     -44300.348      5323.4267      1.9525358      3659.697     
      3400   307.96877     -44300.256     -8146.11        1.9525358      3659.697     
      3500   285.84899     -44307.401      1053.4792      1.9525358      3659.697     
      3600   296.88172     -44324.172      1877.9712      1.9525358      3659.697     
      3700   311.13613     -44320.515      4225.3219      1.9525358      3659.697     
      3800   304.98039     -44303.706     -4036.2439      1.9525358      3659.697     
      3900   288.95569     -44314.438     -6328.7983      1.9525358      3659.697     
      4000   283.2031      -44327.6       -6544.9169      1.9525358      3659.697     
      4100   298.4293      -44330.578     -1537.5058      1.9525358      3659.697     
      4200   318.83671     -44325.579      3574.5279      1.9525358      3659.697     
      4300   309.87107     -44310.526      3600.9269      1.9525358      3659.697     
      4400   297.50103     -44305.326      16155.3        1.9525358      3659.697     
      4500   297.87185     -44312.596      3427.3713      1.9525358      3659.697     
      4600   280.98761     -44337.537      685.27958      1.9525358      3659.697     
      4700   290.86697     -44351.647      7838.7669      1.9525358      3659.697     
      4800   276.6688      -44309.587      6648.9194      1.9525358      3659.697     
      4900   302.69724     -44314.145     -3736.2147      1.9525358      3659.697     
      5000   311.203       -44316.869      3801.7018      1.9525358      3659.697     
Loop time of 299.577 on 16 procs for 5000 steps with 366 atoms

Performance: 0.721 ns/day, 33.286 hours/ns, 16.690 timesteps/s, 6.109 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 230.39     | 232.76     | 238.67     |  16.0 | 77.70
Bond    | 0.00177    | 0.0020518  | 0.002231   |   0.3 |  0.00
Neigh   | 16.362     | 16.58      | 17.038     |   5.0 |  5.53
Comm    | 19.435     | 25.471     | 27.85      |  48.9 |  8.50
Output  | 0.0031897  | 0.0039426  | 0.0090304  |   3.1 |  0.00
Modify  | 23.246     | 23.79      | 24.111     |   5.2 |  7.94
Other   |            | 0.9707     |            |       |  0.32

Nlocal:          45.75 ave          54 max          37 min
Histogram: 1 1 0 1 1 1 0 0 2 1
Nghost:        3564.38 ave        3624 max        3518 min
Histogram: 1 3 0 0 1 0 0 2 0 1
Neighs:        32065.2 ave       37287 max       26385 min
Histogram: 1 1 0 1 1 0 1 0 2 1

Total # of neighbors = 256522
Ave neighs/atom = 700.87978
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333-HD-100C-20-VASP_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.1249
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.4224
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 16.909

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal -0.6491
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 0.6162
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -8.2539

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 16.1249
variable dlen equal lx-${len0}
variable dlen equal lx-16.1249
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.002 seconds
  read_restart CPU = 0.006 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*16.1249
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.2538999999999997925, deltaxy = 0.82539
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.61619999999999996998, deltaxz = -0.06162
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6491000000000000103, deltayz = 0.06491
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.61249 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.61249 xy delta 0.82539 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.61249 xy delta 0.82539 xz delta -0.06162 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.8 | 140.4 | 142 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.203       -44316.869      3801.7709      3659.697       16.1249        13.4224        16.909       
       100   301.49091     -44324.628      4824.7379      3652.3776      16.09265       13.4224        16.909       
       200   292.25252     -44333.943      6102.6541      3645.0582      16.0604        13.4224        16.909       
       300   283.93698     -44327.67      -279.66412      3637.7388      16.028151      13.4224        16.909       
       400   302.36896     -44338.889      2184.2821      3630.4194      15.995901      13.4224        16.909       
       500   294.31157     -44317.527      14277.024      3623.1         15.963651      13.4224        16.909       
       600   303.31412     -44313.079      12741.935      3615.7806      15.931401      13.4224        16.909       
       700   306.36204     -44329.752      12091.535      3608.4613      15.899151      13.4224        16.909       
       800   286.68163     -44327.445      13192.385      3601.1419      15.866902      13.4224        16.909       
       900   301.40446     -44334.657      6652.4936      3593.8225      15.834652      13.4224        16.909       
      1000   314.86352     -44320.111      17611.277      3586.5031      15.802402      13.4224        16.909       
      1100   318.3695      -44309.623      6629.9716      3579.1837      15.770152      13.4224        16.909       
      1200   296.95734     -44327.226      16919.616      3571.8643      15.737902      13.4224        16.909       
      1300   288.93009     -44318.551      4366.717       3564.5449      15.705653      13.4224        16.909       
      1400   302.19048     -44324.791      14807.604      3557.2255      15.673403      13.4224        16.909       
      1500   285.73539     -44311.436      20990.643      3549.9061      15.641153      13.4224        16.909       
      1600   296.09312     -44328.024      16797.579      3542.5867      15.608903      13.4224        16.909       
      1700   312.72584     -44355.107      33362.251      3535.2673      15.576653      13.4224        16.909       
      1800   307.51085     -44337.703      11604.915      3527.9479      15.544404      13.4224        16.909       
      1900   308.91047     -44309.082      24376.994      3520.6285      15.512154      13.4224        16.909       
      2000   322.99119     -44282.066      36540.051      3513.3091      15.479904      13.4224        16.909       
      2100   305.99107     -44270.582      25402.82       3505.9897      15.447654      13.4224        16.909       
      2200   288.09888     -44278.623      21464.885      3498.6703      15.415404      13.4224        16.909       
      2300   318.85418     -44333.5        32472.511      3491.3509      15.383155      13.4224        16.909       
      2400   302.03437     -44319.629      31680.2        3484.0316      15.350905      13.4224        16.909       
      2500   293.87672     -44311.75       34333.75       3476.7122      15.318655      13.4224        16.909       
      2600   294.00842     -44315.696      23250.418      3469.3928      15.286405      13.4224        16.909       
      2700   283.55428     -44303.129      31396.793      3462.0734      15.254155      13.4224        16.909       
      2800   292.0261      -44314.277      37201.972      3454.754       15.221906      13.4224        16.909       
      2900   287.84176     -44289.712      32226.569      3447.4346      15.189656      13.4224        16.909       
      3000   298.50103     -44266.317      31308.052      3440.1152      15.157406      13.4224        16.909       
      3100   318.65966     -44275.134      42305.702      3432.7958      15.125156      13.4224        16.909       
      3200   319.11994     -44292.725      46107.944      3425.4764      15.092906      13.4224        16.909       
      3300   308.96081     -44283.954      42986.097      3418.157       15.060657      13.4224        16.909       
      3400   305.32478     -44280.693      46317.646      3410.8376      15.028407      13.4224        16.909       
      3500   296.20347     -44280.993      34487.246      3403.5182      14.996157      13.4224        16.909       
      3600   290.03229     -44279.511      28823.017      3396.1988      14.963907      13.4224        16.909       
      3700   308.23545     -44294.319      32926.11       3388.8794      14.931657      13.4224        16.909       
      3800   303.48535     -44254.767      34693.435      3381.56        14.899408      13.4224        16.909       
      3900   298.68004     -44203.855      30617.462      3374.2406      14.867158      13.4224        16.909       
      4000   303.83715     -44223.378      48702.66       3366.9212      14.834908      13.4224        16.909       
      4100   297.70045     -44225.146      39477.838      3359.6019      14.802658      13.4224        16.909       
      4200   300.04547     -44229.384      44553.77       3352.2825      14.770408      13.4224        16.909       
      4300   293.92851     -44232.064      58241.767      3344.9631      14.738159      13.4224        16.909       
      4400   308.06194     -44241.441      45663.654      3337.6437      14.705909      13.4224        16.909       
      4500   295.77924     -44231.325      49319.231      3330.3243      14.673659      13.4224        16.909       
      4600   292.60348     -44220.079      63860.652      3323.0049      14.641409      13.4224        16.909       
      4700   292.42043     -44195.448      57084.977      3315.6855      14.609159      13.4224        16.909       
      4800   305.50444     -44179.608      59492.66       3308.3661      14.57691       13.4224        16.909       
      4900   303.16293     -44169.28       65394.008      3301.0467      14.54466       13.4224        16.909       
      5000   303.24836     -44190.653      55455.216      3293.7273      14.51241       13.4224        16.909       
Loop time of 329.44 on 16 procs for 5000 steps with 366 atoms

Performance: 0.656 ns/day, 36.604 hours/ns, 15.177 timesteps/s, 5.555 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 247.29     | 255.26     | 263.96     |  33.0 | 77.48
Bond    | 0.0018676  | 0.0020976  | 0.0022749  |   0.4 |  0.00
Neigh   | 18.638     | 19.227     | 19.904     |   9.6 |  5.84
Comm    | 18.33      | 27.139     | 35.027     | 101.8 |  8.24
Output  | 0.029146   | 0.035462   | 0.041441   |   1.8 |  0.01
Modify  | 26.056     | 26.825     | 27.413     |   8.7 |  8.14
Other   |            | 0.954      |            |       |  0.29

Nlocal:          45.75 ave          52 max          39 min
Histogram: 1 1 1 0 0 2 0 0 2 1
Nghost:        3800.75 ave        3885 max        3710 min
Histogram: 1 1 2 0 0 0 0 1 1 2
Neighs:        35633.5 ave       39814 max       30834 min
Histogram: 1 1 1 0 0 2 0 0 1 2

Total # of neighbors = 285068
Ave neighs/atom = 778.87432
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*16.1249
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.61249 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.61249 xy delta -0.82539 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.61249 xy delta -0.82539 xz delta 0.06162 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.8 | 140.4 | 142 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.203       -44316.869      3801.7709      3659.697       16.1249        13.4224        16.909       
       100   301.14609     -44324.536      4894.245       3667.0164      16.15715       13.4224        16.909       
       200   285.95861     -44326.713      1242.0856      3674.3358      16.1894        13.4224        16.909       
       300   280.76931     -44324.274     -3142.4584      3681.6552      16.221649      13.4224        16.909       
       400   283.93022     -44312.593     -7426.4809      3688.9746      16.253899      13.4224        16.909       
       500   284.35035     -44297.258     -1877.7553      3696.294       16.286149      13.4224        16.909       
       600   292.6186      -44281.176     -869.52112      3703.6134      16.318399      13.4224        16.909       
       700   323.91328     -44303.426     -2330.1875      3710.9328      16.350649      13.4224        16.909       
       800   276.88528     -44267.127     -16281.189      3718.2522      16.382898      13.4224        16.909       
       900   292.24217     -44303.545     -4676.5849      3725.5716      16.415148      13.4224        16.909       
      1000   295.40741     -44297.373     -10822.34       3732.891       16.447398      13.4224        16.909       
      1100   304.31707     -44284.39      -9358.2812      3740.2103      16.479648      13.4224        16.909       
      1200   291.0717      -44242.539     -23331.791      3747.5297      16.511898      13.4224        16.909       
      1300   342.02786     -44252.418     -9593.5631      3754.8491      16.544147      13.4224        16.909       
      1400   329.94336     -44251.895     -1972.5763      3762.1685      16.576397      13.4224        16.909       
      1500   305.0553      -44251.649     -15515.784      3769.4879      16.608647      13.4224        16.909       
      1600   308.23946     -44272.186     -6278.7961      3776.8073      16.640897      13.4224        16.909       
      1700   281.69903     -44250.201     -23893.235      3784.1267      16.673147      13.4224        16.909       
      1800   310.56386     -44275.137     -17617.598      3791.4461      16.705396      13.4224        16.909       
      1900   289.24407     -44246.106     -14968.365      3798.7655      16.737646      13.4224        16.909       
      2000   300.12382     -44263.666     -9450.637       3806.0849      16.769896      13.4224        16.909       
      2100   298.17047     -44263.427     -11139.88       3813.4043      16.802146      13.4224        16.909       
      2200   305.606       -44248.611     -23723.765      3820.7237      16.834396      13.4224        16.909       
      2300   328.3912      -44235.917     -13891.925      3828.0431      16.866645      13.4224        16.909       
      2400   310.2503      -44200.882     -17229.78       3835.3625      16.898895      13.4224        16.909       
      2500   318.6115      -44232.541     -21532.973      3842.6819      16.931145      13.4224        16.909       
      2600   287.38581     -44211.665     -32928.724      3850.0013      16.963395      13.4224        16.909       
      2700   304.2911      -44219.577     -19393.127      3857.3206      16.995645      13.4224        16.909       
      2800   306.61982     -44219.494     -19816.88       3864.64        17.027894      13.4224        16.909       
      2900   284.82926     -44207.099     -25790.888      3871.9594      17.060144      13.4224        16.909       
      3000   290.44874     -44221.517     -15253.263      3879.2788      17.092394      13.4224        16.909       
      3100   286.69562     -44200.516     -33822.35       3886.5982      17.124644      13.4224        16.909       
      3200   313.724       -44180.524     -30583.896      3893.9176      17.156894      13.4224        16.909       
      3300   334.88957     -44191.803     -20226.558      3901.237       17.189143      13.4224        16.909       
      3400   296.43331     -44158.858     -18486.147      3908.5564      17.221393      13.4224        16.909       
      3500   299.41919     -44165.932     -24199.265      3915.8758      17.253643      13.4224        16.909       
      3600   280.70878     -44140.109     -38463.517      3923.1952      17.285893      13.4224        16.909       
      3700   314.39702     -44144.07      -24062.665      3930.5146      17.318143      13.4224        16.909       
      3800   315.84389     -44116.973     -19709.992      3937.834       17.350392      13.4224        16.909       
      3900   328.26115     -44124.631     -25102.451      3945.1534      17.382642      13.4224        16.909       
      4000   301.86893     -44120.857     -38912.604      3952.4728      17.414892      13.4224        16.909       
      4100   310.44967     -44128.449     -33556.729      3959.7922      17.447142      13.4224        16.909       
      4200   312.27198     -44130.746     -35005.472      3967.1116      17.479392      13.4224        16.909       
      4300   295.35046     -44113.946     -26303.08       3974.431       17.511641      13.4224        16.909       
      4400   287.16071     -44099.338     -34839.037      3981.7503      17.543891      13.4224        16.909       
      4500   336.73805     -44107.89      -27906.027      3989.0697      17.576141      13.4224        16.909       
      4600   297.66023     -44050.232     -34045.762      3996.3891      17.608391      13.4224        16.909       
      4700   291.28686     -44058.595     -48709.945      4003.7085      17.640641      13.4224        16.909       
      4800   291.2165      -44065.562     -38361.367      4011.0279      17.67289       13.4224        16.909       
      4900   268.43225     -44039.243     -26807.29       4018.3473      17.70514       13.4224        16.909       
      5000   296.97275     -44053.213     -26274.041      4025.6667      17.73739       13.4224        16.909       
Loop time of 280.488 on 16 procs for 5000 steps with 366 atoms

Performance: 0.770 ns/day, 31.165 hours/ns, 17.826 timesteps/s, 6.524 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 213.6      | 217.15     | 219.89     |  13.1 | 77.42
Bond    | 0.0017201  | 0.002052   | 0.0023143  |   0.4 |  0.00
Neigh   | 15.385     | 15.691     | 15.848     |   3.7 |  5.59
Comm    | 20.183     | 23.013     | 26.724     |  41.5 |  8.20
Output  | 0.030104   | 0.048726   | 0.076216   |   7.5 |  0.02
Modify  | 23.398     | 23.679     | 24.008     |   3.7 |  8.44
Other   |            | 0.9071     |            |       |  0.32

Nlocal:          45.75 ave          53 max          39 min
Histogram: 2 0 1 1 0 1 0 1 1 1
Nghost:           3369 ave        3402 max        3331 min
Histogram: 1 0 1 0 2 1 1 0 0 2
Neighs:          29070 ave       33450 max       24848 min
Histogram: 2 0 1 1 0 1 0 1 1 1

Total # of neighbors = 232560
Ave neighs/atom = 635.40984
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.4224
variable dlen equal ly-${len0}
variable dlen equal ly-13.4224
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.006 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.4224
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.2538999999999997925, deltaxy = 0.82539
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.61619999999999996998, deltaxz = -0.06162
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6491000000000000103, deltayz = 0.06491
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.34224 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.34224 yz delta 0.06491 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.8 | 140.4 | 142 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.203       -44316.869      3801.7709      3659.697       16.1249        13.4224        16.909       
       100   301.41936     -44324.187      4954.4332      3652.3776      16.1249        13.395555      16.909       
       200   288.0373      -44332.741      7053.3746      3645.0582      16.1249        13.36871       16.909       
       300   293.54511     -44342.181      9485.0586      3637.7388      16.1249        13.341866      16.909       
       400   275.27327     -44330.245     -1898.6445      3630.4194      16.1249        13.315021      16.909       
       500   273.21991     -44324.973      6240.3997      3623.1         16.1249        13.288176      16.909       
       600   297.65401     -44317.368      10111.989      3615.7806      16.1249        13.261331      16.909       
       700   315.13477     -44308.221     -2292.6767      3608.4613      16.1249        13.234486      16.909       
       800   316.00765     -44312.22       1930.7595      3601.1419      16.1249        13.207642      16.909       
       900   296.97611     -44322.226      7767.5171      3593.8225      16.1249        13.180797      16.909       
      1000   299.13408     -44332.166      16874.366      3586.5031      16.1249        13.153952      16.909       
      1100   303.87978     -44330.703      16574.215      3579.1837      16.1249        13.127107      16.909       
      1200   315.65411     -44317.491      3772.9989      3571.8643      16.1249        13.100262      16.909       
      1300   287.59709     -44278.181      8587.8739      3564.5449      16.1249        13.073418      16.909       
      1400   314.27914     -44289.796      19264.158      3557.2255      16.1249        13.046573      16.909       
      1500   313.83753     -44282.311      18805.88       3549.9061      16.1249        13.019728      16.909       
      1600   299.69187     -44290.423      18160.173      3542.5867      16.1249        12.992883      16.909       
      1700   310.3173      -44315.366      1524.5069      3535.2673      16.1249        12.966038      16.909       
      1800   289.95089     -44289.445      31732.074      3527.9479      16.1249        12.939194      16.909       
      1900   293.03053     -44290.42       22626.066      3520.6285      16.1249        12.912349      16.909       
      2000   292.22088     -44294.402      18268.895      3513.3091      16.1249        12.885504      16.909       
      2100   286.18386     -44295.373      19332.676      3505.9897      16.1249        12.858659      16.909       
      2200   286.19089     -44293.443      33609.849      3498.6703      16.1249        12.831814      16.909       
      2300   284.2072      -44263.711      13177.432      3491.3509      16.1249        12.80497       16.909       
      2400   310.20027     -44257.041      22849.017      3484.0316      16.1249        12.778125      16.909       
      2500   307.08486     -44244.135      17644.096      3476.7122      16.1249        12.75128       16.909       
      2600   302.53141     -44255.99       36173.857      3469.3928      16.1249        12.724435      16.909       
      2700   296.53647     -44267.263      21475.393      3462.0734      16.1249        12.69759       16.909       
      2800   295.82468     -44259.677      30851.448      3454.754       16.1249        12.670746      16.909       
      2900   310.80235     -44251.096      24495.157      3447.4346      16.1249        12.643901      16.909       
      3000   301.04045     -44231.151      29711.569      3440.1152      16.1249        12.617056      16.909       
      3100   306.96354     -44261.715      25319.515      3432.7958      16.1249        12.590211      16.909       
      3200   282.92096     -44247.673      35334.701      3425.4764      16.1249        12.563366      16.909       
      3300   288.79372     -44237.115      36566.213      3418.157       16.1249        12.536522      16.909       
      3400   290.08982     -44222.108      40220.007      3410.8376      16.1249        12.509677      16.909       
      3500   288.98579     -44209.224      50032.25       3403.5182      16.1249        12.482832      16.909       
      3600   291.91847     -44214.728      34858.419      3396.1988      16.1249        12.455987      16.909       
      3700   277.97706     -44218.935      34097.605      3388.8794      16.1249        12.429142      16.909       
      3800   304.20902     -44234.227      35376.837      3381.56        16.1249        12.402298      16.909       
      3900   296.92056     -44210.144      31114.849      3374.2406      16.1249        12.375453      16.909       
      4000   315.56635     -44202.176      33055.59       3366.9212      16.1249        12.348608      16.909       
      4100   311.32424     -44187.889      45700.106      3359.6019      16.1249        12.321763      16.909       
      4200   298.16966     -44184.768      40855.98       3352.2825      16.1249        12.294918      16.909       
      4300   297.53035     -44192.771      36127.107      3344.9631      16.1249        12.268074      16.909       
      4400   300.82551     -44191.585      32758.653      3337.6437      16.1249        12.241229      16.909       
      4500   284.65753     -44182.603      48724.022      3330.3243      16.1249        12.214384      16.909       
      4600   312.64158     -44208.934      48258.949      3323.0049      16.1249        12.187539      16.909       
      4700   307.9374      -44187.849      39905.248      3315.6855      16.1249        12.160694      16.909       
      4800   316.80623     -44179.561      56084.719      3308.3661      16.1249        12.13385       16.909       
      4900   312.93738     -44154.07       48576.843      3301.0467      16.1249        12.107005      16.909       
      5000   291.0625      -44124.022      57697.662      3293.7273      16.1249        12.08016       16.909       
Loop time of 332.528 on 16 procs for 5000 steps with 366 atoms

Performance: 0.650 ns/day, 36.948 hours/ns, 15.036 timesteps/s, 5.503 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 250        | 257.89     | 267.91     |  30.7 | 77.55
Bond    | 0.0018902  | 0.0020996  | 0.002222   |   0.3 |  0.00
Neigh   | 17.352     | 17.896     | 18.432     |   8.7 |  5.38
Comm    | 18.491     | 28.654     | 36.408     |  92.9 |  8.62
Output  | 0.030464   | 0.0368     | 0.043127   |   2.0 |  0.01
Modify  | 26.483     | 27.068     | 27.699     |   8.2 |  8.14
Other   |            | 0.9799     |            |       |  0.29

Nlocal:          45.75 ave          51 max          33 min
Histogram: 1 0 0 0 0 1 1 1 2 2
Nghost:        3982.38 ave        4055 max        3898 min
Histogram: 1 1 0 0 2 0 1 0 2 1
Neighs:        35609.2 ave       39970 max       26255 min
Histogram: 1 0 0 0 0 1 1 1 3 1

Total # of neighbors = 284874
Ave neighs/atom = 778.34426
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.4224
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.34224 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.34224 yz delta -0.06491 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.8 | 140.4 | 142 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.203       -44316.869      3801.7709      3659.697       16.1249        13.4224        16.909       
       100   301.21555     -44324.901      4733.4734      3667.0164      16.1249        13.449245      16.909       
       200   290.94038     -44330.974     -450.66531      3674.3358      16.1249        13.47609       16.909       
       300   285.75817     -44330.833     -7718.212       3681.6552      16.1249        13.502934      16.909       
       400   292.14899     -44325.882     -4645.4281      3688.9746      16.1249        13.529779      16.909       
       500   286.63678     -44303.678     -5599.0174      3696.294       16.1249        13.556624      16.909       
       600   296.77741     -44295.079     -4965.6955      3703.6134      16.1249        13.583469      16.909       
       700   297.21015     -44300.186     -4718.1187      3710.9328      16.1249        13.610314      16.909       
       800   283.17517     -44317.818     -21652.146      3718.2522      16.1249        13.637158      16.909       
       900   289.6585      -44324.815     -6025.5922      3725.5716      16.1249        13.664003      16.909       
      1000   279.53857     -44296.89      -12001.371      3732.891       16.1249        13.690848      16.909       
      1100   292.38365     -44280.065     -11411.475      3740.2103      16.1249        13.717693      16.909       
      1200   321.26789     -44282.348     -5999.3499      3747.5297      16.1249        13.744538      16.909       
      1300   329.48226     -44287.21      -3732.6674      3754.8491      16.1249        13.771382      16.909       
      1400   309.37474     -44302.092     -3174.1276      3762.1685      16.1249        13.798227      16.909       
      1500   283.28763     -44293.228     -13175.368      3769.4879      16.1249        13.825072      16.909       
      1600   277.64809     -44285.856     -10375.289      3776.8073      16.1249        13.851917      16.909       
      1700   306.95416     -44298.427     -8908.2449      3784.1267      16.1249        13.878762      16.909       
      1800   303.97906     -44265.92      -28834.58       3791.4461      16.1249        13.905606      16.909       
      1900   297.34818     -44258.391     -8789.6957      3798.7655      16.1249        13.932451      16.909       
      2000   307.7692      -44307.536     -13973.512      3806.0849      16.1249        13.959296      16.909       
      2100   294.81467     -44290.968     -8183.3447      3813.4043      16.1249        13.986141      16.909       
      2200   290.22059     -44263.083     -13373.662      3820.7237      16.1249        14.012986      16.909       
      2300   323.3441      -44274.424     -21830.002      3828.0431      16.1249        14.03983       16.909       
      2400   309.14265     -44251.063     -18326.325      3835.3625      16.1249        14.066675      16.909       
      2500   297.55467     -44272.189     -23743.354      3842.6819      16.1249        14.09352       16.909       
      2600   287.58305     -44263.199     -20312.486      3850.0013      16.1249        14.120365      16.909       
      2700   298.70292     -44274.373     -7777.051       3857.3206      16.1249        14.14721       16.909       
      2800   305.49476     -44273.246     -17347.922      3864.64        16.1249        14.174054      16.909       
      2900   307.19847     -44242.381     -23353.229      3871.9594      16.1249        14.200899      16.909       
      3000   312.42886     -44223.806     -23837.761      3879.2788      16.1249        14.227744      16.909       
      3100   295.53537     -44226.619     -22339.264      3886.5982      16.1249        14.254589      16.909       
      3200   288.79819     -44235.717     -27226.427      3893.9176      16.1249        14.281434      16.909       
      3300   288.84642     -44227.744     -26173.846      3901.237       16.1249        14.308278      16.909       
      3400   318.63276     -44240.003     -13942.942      3908.5564      16.1249        14.335123      16.909       
      3500   296.25863     -44213.63      -24178.394      3915.8758      16.1249        14.361968      16.909       
      3600   278.74858     -44218.822     -26105.953      3923.1952      16.1249        14.388813      16.909       
      3700   289.92202     -44223.18      -33222.858      3930.5146      16.1249        14.415658      16.909       
      3800   323.63169     -44246.276     -22399.645      3937.834       16.1249        14.442502      16.909       
      3900   293.96921     -44210.513     -28539.138      3945.1534      16.1249        14.469347      16.909       
      4000   281.02157     -44179.284     -20793.534      3952.4728      16.1249        14.496192      16.909       
      4100   304.05225     -44176.347     -31263.815      3959.7922      16.1249        14.523037      16.909       
      4200   312.11434     -44184.425     -27038.936      3967.1116      16.1249        14.549882      16.909       
      4300   306.83003     -44201.107     -30029.14       3974.431       16.1249        14.576726      16.909       
      4400   297.68647     -44200.727     -29301.331      3981.7503      16.1249        14.603571      16.909       
      4500   290.77877     -44190.411     -32222.833      3989.0697      16.1249        14.630416      16.909       
      4600   279.98261     -44163.516     -25558.492      3996.3891      16.1249        14.657261      16.909       
      4700   306.43387     -44165.504     -30230.476      4003.7085      16.1249        14.684106      16.909       
      4800   316.76639     -44162.787     -23950.788      4011.0279      16.1249        14.71095       16.909       
      4900   288.13834     -44158.175     -33236.381      4018.3473      16.1249        14.737795      16.909       
      5000   303.49942     -44181.385     -34121.665      4025.6667      16.1249        14.76464       16.909       
Loop time of 278.722 on 16 procs for 5000 steps with 366 atoms

Performance: 0.775 ns/day, 30.969 hours/ns, 17.939 timesteps/s, 6.566 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 213.8      | 216.74     | 220.46     |  16.4 | 77.76
Bond    | 0.0018326  | 0.0021161  | 0.0024991  |   0.5 |  0.00
Neigh   | 15.217     | 15.486     | 15.876     |   5.6 |  5.56
Comm    | 18.265     | 22.136     | 25.154     |  52.4 |  7.94
Output  | 0.029858   | 0.042466   | 0.059034   |   5.2 |  0.02
Modify  | 22.988     | 23.417     | 23.747     |   5.1 |  8.40
Other   |            | 0.9022     |            |       |  0.32

Nlocal:          45.75 ave          51 max          35 min
Histogram: 1 0 0 1 0 0 1 0 4 1
Nghost:        3255.25 ave        3303 max        3193 min
Histogram: 1 0 0 2 0 1 1 1 0 2
Neighs:        29088.6 ave       32275 max       22444 min
Histogram: 1 0 0 1 0 0 1 0 3 2

Total # of neighbors = 232709
Ave neighs/atom = 635.81694
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 16.909
variable dlen equal lz-${len0}
variable dlen equal lz-16.909
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*16.909
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.2538999999999997925, deltaxy = 0.82539
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.61619999999999996998, deltaxz = -0.06162
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6491000000000000103, deltayz = 0.06491
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -1.6909 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.8 | 140.4 | 142 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.203       -44316.869      3801.7709      3659.697       16.1249        13.4224        16.909       
       100   301.36037     -44324.467      4727.9711      3652.3776      16.1249        13.4224        16.875182    
       200   282.43625     -44321.087      3824.6416      3645.0582      16.1249        13.4224        16.841364    
       300   281.51448     -44319.647      7875.8939      3637.7388      16.1249        13.4224        16.807546    
       400   292.96155     -44318.451      2381.7071      3630.4194      16.1249        13.4224        16.773728    
       500   278.82166     -44289.378      14720.525      3623.1         16.1249        13.4224        16.73991     
       600   301.01985     -44291.778      5188.9129      3615.7806      16.1249        13.4224        16.706092    
       700   321.71597     -44330.148      2791.6511      3608.4613      16.1249        13.4224        16.672274    
       800   287.62465     -44319.366      2587.7735      3601.1419      16.1249        13.4224        16.638456    
       900   278.36417     -44295.029      3843.8946      3593.8225      16.1249        13.4224        16.604638    
      1000   317.72565     -44309.093      1968.1095      3586.5031      16.1249        13.4224        16.57082     
      1100   318.53151     -44300.572      2810.7911      3579.1837      16.1249        13.4224        16.537002    
      1200   295.37745     -44311.416      22021.401      3571.8643      16.1249        13.4224        16.503184    
      1300   271.93838     -44276.335      23595.661      3564.5449      16.1249        13.4224        16.469366    
      1400   312.90002     -44300.11       11157.978      3557.2255      16.1249        13.4224        16.435548    
      1500   311.35689     -44280.359      31036.495      3549.9061      16.1249        13.4224        16.40173     
      1600   300.34857     -44274.803      17760.702      3542.5867      16.1249        13.4224        16.367912    
      1700   298.00109     -44291.954      20511.805      3535.2673      16.1249        13.4224        16.334094    
      1800   288.56919     -44284.357      13654.799      3527.9479      16.1249        13.4224        16.300276    
      1900   306.10641     -44293.647      13552.955      3520.6285      16.1249        13.4224        16.266458    
      2000   276.48092     -44269.089      19989.021      3513.3091      16.1249        13.4224        16.23264     
      2100   298.08867     -44302.054      21028.399      3505.9897      16.1249        13.4224        16.198822    
      2200   289.77913     -44282.166      22857.335      3498.6703      16.1249        13.4224        16.165004    
      2300   287.08729     -44256.919      18717.195      3491.3509      16.1249        13.4224        16.131186    
      2400   322.53152     -44250.731      23283.584      3484.0316      16.1249        13.4224        16.097368    
      2500   326.83805     -44259.136      23311.812      3476.7122      16.1249        13.4224        16.06355     
      2600   303.72049     -44254.105      34630.383      3469.3928      16.1249        13.4224        16.029732    
      2700   297.78299     -44260.88       29462.561      3462.0734      16.1249        13.4224        15.995914    
      2800   295.30385     -44264.636      28484.816      3454.754       16.1249        13.4224        15.962096    
      2900   304.04186     -44265.042      21989.937      3447.4346      16.1249        13.4224        15.928278    
      3000   290.37584     -44246.119      27872.091      3440.1152      16.1249        13.4224        15.89446     
      3100   304.34273     -44239.608      35108.753      3432.7958      16.1249        13.4224        15.860642    
      3200   298.76411     -44207.255      32880.511      3425.4764      16.1249        13.4224        15.826824    
      3300   305.03537     -44223.592      43902.478      3418.157       16.1249        13.4224        15.793006    
      3400   294.94009     -44225.844      41450.675      3410.8376      16.1249        13.4224        15.759188    
      3500   292.2593      -44214.643      38199.437      3403.5182      16.1249        13.4224        15.72537     
      3600   299.02855     -44218.574      43317.34       3396.1988      16.1249        13.4224        15.691552    
      3700   292.28161     -44227.636      49762.601      3388.8794      16.1249        13.4224        15.657734    
      3800   301.08054     -44241.296      38462.176      3381.56        16.1249        13.4224        15.623916    
      3900   304.41718     -44223.145      47205.322      3374.2406      16.1249        13.4224        15.590098    
      4000   290.21519     -44189.861      42490.787      3366.9212      16.1249        13.4224        15.55628     
      4100   286.57283     -44183.452      35486.63       3359.6019      16.1249        13.4224        15.522462    
      4200   303.65385     -44220.746      43426.151      3352.2825      16.1249        13.4224        15.488644    
      4300   299.03292     -44210.637      47380.378      3344.9631      16.1249        13.4224        15.454826    
      4400   288.97426     -44179.238      38553.149      3337.6437      16.1249        13.4224        15.421008    
      4500   296.57471     -44189.429      41318.366      3330.3243      16.1249        13.4224        15.38719     
      4600   296.44697     -44205.84       46185.764      3323.0049      16.1249        13.4224        15.353372    
      4700   281.87066     -44181.151      37835.758      3315.6855      16.1249        13.4224        15.319554    
      4800   311.03685     -44206.799      55366.435      3308.3661      16.1249        13.4224        15.285736    
      4900   284.55399     -44174.148      47947.652      3301.0467      16.1249        13.4224        15.251918    
      5000   275.32148     -44175.61       62041.845      3293.7273      16.1249        13.4224        15.2181      
Loop time of 326.647 on 16 procs for 5000 steps with 366 atoms

Performance: 0.661 ns/day, 36.294 hours/ns, 15.307 timesteps/s, 5.602 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 248.33     | 254.32     | 259.96     |  27.0 | 77.86
Bond    | 0.0018421  | 0.0020999  | 0.0022763  |   0.3 |  0.00
Neigh   | 17.129     | 17.52      | 17.879     |   6.3 |  5.36
Comm    | 20.934     | 26.635     | 32.807     |  84.2 |  8.15
Output  | 0.026668   | 0.032026   | 0.03719    |   1.7 |  0.01
Modify  | 26.706     | 27.133     | 27.592     |   5.5 |  8.31
Other   |            | 1.006      |            |       |  0.31

Nlocal:          45.75 ave          54 max          34 min
Histogram: 1 0 0 1 0 1 2 1 0 2
Nghost:        3872.88 ave        3950 max        3804 min
Histogram: 1 0 2 1 0 1 1 1 0 1
Neighs:        35567.6 ave       41190 max       27194 min
Histogram: 1 0 0 1 0 1 2 1 0 2

Total # of neighbors = 284541
Ave neighs/atom = 777.43443
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*16.909
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 1.6909 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.8 | 140.4 | 142 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.203       -44316.869      3801.7709      3659.697       16.1249        13.4224        16.909       
       100   301.29732     -44324.727      4929.3601      3667.0164      16.1249        13.4224        16.942818    
       200   287.34181     -44327.201      1224.7313      3674.3358      16.1249        13.4224        16.976636    
       300   281.84442     -44325.644      1204.8464      3681.6552      16.1249        13.4224        17.010454    
       400   286.69459     -44318.375     -2832.7846      3688.9746      16.1249        13.4224        17.044272    
       500   297.33557     -44312.184     -8850.5179      3696.294       16.1249        13.4224        17.07809     
       600   303.85732     -44298.833     -3179.3494      3703.6134      16.1249        13.4224        17.111908    
       700   309.43619     -44308.814     -8463.268       3710.9328      16.1249        13.4224        17.145726    
       800   277.5087      -44305.932     -7422.9261      3718.2522      16.1249        13.4224        17.179544    
       900   286.4221      -44309.451     -5730.4342      3725.5716      16.1249        13.4224        17.213362    
      1000   292.97389     -44299.752     -12290.759      3732.891       16.1249        13.4224        17.24718     
      1100   303.20785     -44287.937     -11573.847      3740.2103      16.1249        13.4224        17.280998    
      1200   326.49347     -44281.055     -18488.079      3747.5297      16.1249        13.4224        17.314816    
      1300   313.13981     -44284.35      -20285.286      3754.8491      16.1249        13.4224        17.348634    
      1400   299.22938     -44294.219     -18407.954      3762.1685      16.1249        13.4224        17.382452    
      1500   302.54141     -44310.683     -22997.161      3769.4879      16.1249        13.4224        17.41627     
      1600   296.8391      -44310.314     -4231.2128      3776.8073      16.1249        13.4224        17.450088    
      1700   309.98447     -44320.69      -6694.5127      3784.1267      16.1249        13.4224        17.483906    
      1800   285.15765     -44272.63      -22490.85       3791.4461      16.1249        13.4224        17.517724    
      1900   319.87669     -44276.399     -12535.28       3798.7655      16.1249        13.4224        17.551542    
      2000   323.5858      -44281.684     -22488.494      3806.0849      16.1249        13.4224        17.58536     
      2100   273.55522     -44251.758     -6893.3453      3813.4043      16.1249        13.4224        17.619178    
      2200   292.31662     -44269.409     -19408.408      3820.7237      16.1249        13.4224        17.652996    
      2300   298.65957     -44264.345     -25376.554      3828.0431      16.1249        13.4224        17.686814    
      2400   318.07825     -44268.411     -18855.066      3835.3625      16.1249        13.4224        17.720632    
      2500   301.23246     -44240.977     -21496.769      3842.6819      16.1249        13.4224        17.75445     
      2600   294.4393      -44257.269     -18736.329      3850.0013      16.1249        13.4224        17.788268    
      2700   270.33854     -44240.528     -20570.468      3857.3206      16.1249        13.4224        17.822086    
      2800   321.82031     -44289.915     -17321.413      3864.64        16.1249        13.4224        17.855904    
      2900   304.16339     -44261.207     -24774.645      3871.9594      16.1249        13.4224        17.889722    
      3000   302.18245     -44249.173     -31484.035      3879.2788      16.1249        13.4224        17.92354     
      3100   305.80184     -44246.804     -29948.348      3886.5982      16.1249        13.4224        17.957358    
      3200   290.53992     -44247.661     -29415.74       3893.9176      16.1249        13.4224        17.991176    
      3300   284.01976     -44248.027     -27293.624      3901.237       16.1249        13.4224        18.024994    
      3400   281.38349     -44233.629     -32822.203      3908.5564      16.1249        13.4224        18.058812    
      3500   296.97851     -44205.063     -27961.87       3915.8758      16.1249        13.4224        18.09263     
      3600   336.06661     -44225.311     -25337.383      3923.1952      16.1249        13.4224        18.126448    
      3700   301.85469     -44197.147     -30244.984      3930.5146      16.1249        13.4224        18.160266    
      3800   269.55755     -44179.224     -20242.364      3937.834       16.1249        13.4224        18.194084    
      3900   308.74129     -44217.88      -31241.731      3945.1534      16.1249        13.4224        18.227902    
      4000   289.18785     -44193.28      -29406.844      3952.4728      16.1249        13.4224        18.26172     
      4100   296.99315     -44180.829     -27479.564      3959.7922      16.1249        13.4224        18.295538    
      4200   319.73718     -44156.534     -28752.175      3967.1116      16.1249        13.4224        18.329356    
      4300   318.57286     -44156.943     -38850.908      3974.431       16.1249        13.4224        18.363174    
      4400   306.99845     -44163.644     -32037.832      3981.7503      16.1249        13.4224        18.396992    
      4500   293.98153     -44157.646     -31225.675      3989.0697      16.1249        13.4224        18.43081     
      4600   307.0205      -44172.121     -27390.899      3996.3891      16.1249        13.4224        18.464628    
      4700   296.10404     -44177.714     -28942.665      4003.7085      16.1249        13.4224        18.498446    
      4800   286.3159      -44171.896     -43515.619      4011.0279      16.1249        13.4224        18.532264    
      4900   298.49077     -44166.472     -25345.498      4018.3473      16.1249        13.4224        18.566082    
      5000   326.84237     -44148.087     -40781.941      4025.6667      16.1249        13.4224        18.5999      
Loop time of 282.311 on 16 procs for 5000 steps with 366 atoms

Performance: 0.765 ns/day, 31.368 hours/ns, 17.711 timesteps/s, 6.482 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 213.7      | 217.9      | 226.41     |  24.8 | 77.18
Bond    | 0.0018066  | 0.0020895  | 0.0022978  |   0.4 |  0.00
Neigh   | 14.765     | 15.169     | 15.792     |   7.2 |  5.37
Comm    | 15.815     | 24.45      | 28.774     |  75.0 |  8.66
Output  | 0.035573   | 0.044763   | 0.053353   |   2.3 |  0.02
Modify  | 23.194     | 23.828     | 24.375     |   6.6 |  8.44
Other   |            | 0.9222     |            |       |  0.33

Nlocal:          45.75 ave          50 max          39 min
Histogram: 2 0 0 0 0 0 1 2 1 2
Nghost:        3341.12 ave        3397 max        3292 min
Histogram: 2 0 1 1 0 1 1 0 1 1
Neighs:        29038.8 ave       31954 max       24852 min
Histogram: 1 1 0 0 0 1 0 3 1 1

Total # of neighbors = 232310
Ave neighs/atom = 634.72678
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 16.1249
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz--0.6491)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*16.1249
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.2538999999999997925, deltaxy = 0.82539
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.61619999999999996998, deltaxz = -0.06162
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6491000000000000103, deltayz = 0.06491
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -1.61249 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.8 | 140.4 | 142 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.203       -44316.869      3801.7709      3659.697       16.1249        13.4224        16.909       
       100   301.32533     -44324.639      4883.5287      3659.697       16.1249        13.4224        16.909       
       200   288.84872     -44329.998      2487.7436      3659.697       16.1249        13.4224        16.909       
       300   287.38422     -44332.338      5605.7883      3659.697       16.1249        13.4224        16.909       
       400   292.5864      -44326.755     -4991.7491      3659.697       16.1249        13.4224        16.909       
       500   286.09647     -44307.742      5245.1182      3659.697       16.1249        13.4224        16.909       
       600   295.80374     -44301.141     -2295.177       3659.697       16.1249        13.4224        16.909       
       700   323.55107     -44320.265     -2914.6282      3659.697       16.1249        13.4224        16.909       
       800   297.37759     -44316.29      -1009.7809      3659.697       16.1249        13.4224        16.909       
       900   293.54811     -44330.685     -10709.082      3659.697       16.1249        13.4224        16.909       
      1000   294.4734      -44318.227      7031.0093      3659.697       16.1249        13.4224        16.909       
      1100   289.25433     -44293.854     -15483.885      3659.697       16.1249        13.4224        16.909       
      1200   302.62444     -44290.541     -4055.1264      3659.697       16.1249        13.4224        16.909       
      1300   313.71948     -44286.106     -5262.6494      3659.697       16.1249        13.4224        16.909       
      1400   317.6097      -44299.94      -6413.0971      3659.697       16.1249        13.4224        16.909       
      1500   293.52024     -44299.538     -5480.263       3659.697       16.1249        13.4224        16.909       
      1600   289.44733     -44310.564     -635.94487      3659.697       16.1249        13.4224        16.909       
      1700   293.70159     -44302.346     -5195.9714      3659.697       16.1249        13.4224        16.909       
      1800   305.16526     -44284.861      3553.9722      3659.697       16.1249        13.4224        16.909       
      1900   322.37211     -44283.543      1830.0035      3659.697       16.1249        13.4224        16.909       
      2000   325.36557     -44310.455      9878.5744      3659.697       16.1249        13.4224        16.909       
      2100   302.29715     -44291.625      1280.9408      3659.697       16.1249        13.4224        16.909       
      2200   312.74185     -44300.705      4300.6754      3659.697       16.1249        13.4224        16.909       
      2300   293.40051     -44294.427      7916.8155      3659.697       16.1249        13.4224        16.909       
      2400   277.71348     -44291.785      15758.93       3659.697       16.1249        13.4224        16.909       
      2500   275.16539     -44272.477     -5028.1887      3659.697       16.1249        13.4224        16.909       
      2600   302.43102     -44265.405     -5090.624       3659.697       16.1249        13.4224        16.909       
      2700   310.90969     -44268.839     -2229.7601      3659.697       16.1249        13.4224        16.909       
      2800   308.11731     -44279.677      4981.5031      3659.697       16.1249        13.4224        16.909       
      2900   290.56654     -44272.317      6199.6535      3659.697       16.1249        13.4224        16.909       
      3000   290.18614     -44272.21       4790.8823      3659.697       16.1249        13.4224        16.909       
      3100   294.64796     -44272.166     -5643.0692      3659.697       16.1249        13.4224        16.909       
      3200   314.90649     -44256.06       7111.6139      3659.697       16.1249        13.4224        16.909       
      3300   323.2681      -44249.541      2959.3387      3659.697       16.1249        13.4224        16.909       
      3400   309.52428     -44256.494     -6480.9405      3659.697       16.1249        13.4224        16.909       
      3500   300.32047     -44262.167      2022.532       3659.697       16.1249        13.4224        16.909       
      3600   298.36341     -44258.957      6600.5183      3659.697       16.1249        13.4224        16.909       
      3700   285.01625     -44229.859      5976.6481      3659.697       16.1249        13.4224        16.909       
      3800   304.33063     -44210.397     -6935.69        3659.697       16.1249        13.4224        16.909       
      3900   314.91751     -44220.296      4519.9081      3659.697       16.1249        13.4224        16.909       
      4000   289.2607      -44212.143     -5572.7021      3659.697       16.1249        13.4224        16.909       
      4100   303.4911      -44244.364     -4167.0378      3659.697       16.1249        13.4224        16.909       
      4200   301.67819     -44251.196      5911.812       3659.697       16.1249        13.4224        16.909       
      4300   294.36449     -44240.127      12813.728      3659.697       16.1249        13.4224        16.909       
      4400   292.83168     -44227.695     -7712.9912      3659.697       16.1249        13.4224        16.909       
      4500   327.04343     -44254.588      4821.6371      3659.697       16.1249        13.4224        16.909       
      4600   305.75226     -44215.447      8513.1721      3659.697       16.1249        13.4224        16.909       
      4700   316.61774     -44227.89      -149.99178      3659.697       16.1249        13.4224        16.909       
      4800   289.63517     -44227.763      6790.5597      3659.697       16.1249        13.4224        16.909       
      4900   287.7828      -44220.023      5367.508       3659.697       16.1249        13.4224        16.909       
      5000   301.15024     -44216.449     -79.061939      3659.697       16.1249        13.4224        16.909       
Loop time of 304.75 on 16 procs for 5000 steps with 366 atoms

Performance: 0.709 ns/day, 33.861 hours/ns, 16.407 timesteps/s, 6.005 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 230.95     | 234.99     | 239.4      |  17.9 | 77.11
Bond    | 0.0018896  | 0.0020933  | 0.0023616  |   0.4 |  0.00
Neigh   | 16.603     | 17.162     | 17.485     |   6.6 |  5.63
Comm    | 21.71      | 26.187     | 30.288     |  53.0 |  8.59
Output  | 0.025964   | 0.029493   | 0.033473   |   1.5 |  0.01
Modify  | 25.003     | 25.411     | 25.948     |   5.2 |  8.34
Other   |            | 0.9689     |            |       |  0.32

Nlocal:          45.75 ave          53 max          36 min
Histogram: 1 0 0 2 1 0 0 1 2 1
Nghost:        3607.12 ave        3644 max        3574 min
Histogram: 3 0 1 0 0 0 1 1 0 2
Neighs:        32052.1 ave       36701 max       25658 min
Histogram: 1 0 0 3 0 0 0 1 2 1

Total # of neighbors = 256417
Ave neighs/atom = 700.5929
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*16.1249
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 1.61249 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.8 | 140.4 | 142 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.203       -44316.869      3801.7709      3659.697       16.1249        13.4224        16.909       
       100   301.34829     -44324.591      4802.1897      3659.697       16.1249        13.4224        16.909       
       200   284.3963      -44323.603     -1220.3919      3659.697       16.1249        13.4224        16.909       
       300   286.73277     -44330.605      3661.3761      3659.697       16.1249        13.4224        16.909       
       400   288.90435     -44323.488     -3022.9529      3659.697       16.1249        13.4224        16.909       
       500   300.36525     -44314.125     -5412.2299      3659.697       16.1249        13.4224        16.909       
       600   305.95088     -44304.667      1316.5211      3659.697       16.1249        13.4224        16.909       
       700   291.62808     -44310.695      3606.5534      3659.697       16.1249        13.4224        16.909       
       800   283.04019     -44313.811     -4432.5768      3659.697       16.1249        13.4224        16.909       
       900   293.34297     -44317.334      1412.7665      3659.697       16.1249        13.4224        16.909       
      1000   315.80555     -44329.849     -2492.1497      3659.697       16.1249        13.4224        16.909       
      1100   300.23256     -44312.887     -1953.2289      3659.697       16.1249        13.4224        16.909       
      1200   281.8368      -44322.438      2595.3153      3659.697       16.1249        13.4224        16.909       
      1300   268.75628     -44307.952      12031.364      3659.697       16.1249        13.4224        16.909       
      1400   288.89825     -44305.073      3127.6876      3659.697       16.1249        13.4224        16.909       
      1500   309.12476     -44288.371     -5834.1737      3659.697       16.1249        13.4224        16.909       
      1600   300.98822     -44277.236     -3578.6439      3659.697       16.1249        13.4224        16.909       
      1700   309.42793     -44302.347      8592.1526      3659.697       16.1249        13.4224        16.909       
      1800   298.08081     -44301.925     -3441.6411      3659.697       16.1249        13.4224        16.909       
      1900   304.07127     -44319.774      13014.525      3659.697       16.1249        13.4224        16.909       
      2000   298.18225     -44336.253      1752.2582      3659.697       16.1249        13.4224        16.909       
      2100   292.68619     -44334.12      -7148.8523      3659.697       16.1249        13.4224        16.909       
      2200   302.32904     -44336.271      3771.0552      3659.697       16.1249        13.4224        16.909       
      2300   297.27474     -44313.543      10544.857      3659.697       16.1249        13.4224        16.909       
      2400   300.01255     -44301.859      5800.7369      3659.697       16.1249        13.4224        16.909       
      2500   304.09305     -44304.461      2070.2905      3659.697       16.1249        13.4224        16.909       
      2600   294.58401     -44318.32      -4381.6668      3659.697       16.1249        13.4224        16.909       
      2700   280.86934     -44317.85       5156.3506      3659.697       16.1249        13.4224        16.909       
      2800   299.3057      -44334.236      7343.4339      3659.697       16.1249        13.4224        16.909       
      2900   306.44009     -44339.561     -4037.421       3659.697       16.1249        13.4224        16.909       
      3000   304.15135     -44325.062      12989.815      3659.697       16.1249        13.4224        16.909       
      3100   322.78648     -44333.538     -3031.887       3659.697       16.1249        13.4224        16.909       
      3200   312.72944     -44324.642     -6082.1864      3659.697       16.1249        13.4224        16.909       
      3300   306.75271     -44340.326     -6250.2974      3659.697       16.1249        13.4224        16.909       
      3400   308.47621     -44347.131     -2741.5001      3659.697       16.1249        13.4224        16.909       
      3500   298.64232     -44333.738      3134.6774      3659.697       16.1249        13.4224        16.909       
      3600   298.4483      -44309.733     -2514.9407      3659.697       16.1249        13.4224        16.909       
      3700   314.76304     -44301.604      13843.419      3659.697       16.1249        13.4224        16.909       
      3800   303.75412     -44298.963      2054.4665      3659.697       16.1249        13.4224        16.909       
      3900   314.02156     -44328.663     -1926.5763      3659.697       16.1249        13.4224        16.909       
      4000   310.09747     -44327.05      -3290.2573      3659.697       16.1249        13.4224        16.909       
      4100   282.92972     -44297.216      4470.3276      3659.697       16.1249        13.4224        16.909       
      4200   282.00465     -44302.291     -3016.2358      3659.697       16.1249        13.4224        16.909       
      4300   295.25764     -44337.338     -3253.7232      3659.697       16.1249        13.4224        16.909       
      4400   280.30671     -44308.657     -5797.7301      3659.697       16.1249        13.4224        16.909       
      4500   279.72534     -44274.583      3745.6809      3659.697       16.1249        13.4224        16.909       
      4600   302.02429     -44280.794     -944.80519      3659.697       16.1249        13.4224        16.909       
      4700   298.61994     -44283.43      -12553.094      3659.697       16.1249        13.4224        16.909       
      4800   285.88726     -44284.537      568.60579      3659.697       16.1249        13.4224        16.909       
      4900   303.9382      -44310.146     -888.53401      3659.697       16.1249        13.4224        16.909       
      5000   295.11241     -44299.035     -4313.3907      3659.697       16.1249        13.4224        16.909       
Loop time of 298.32 on 16 procs for 5000 steps with 366 atoms

Performance: 0.724 ns/day, 33.147 hours/ns, 16.761 timesteps/s, 6.134 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 229.01     | 233.95     | 237.16     |  16.4 | 78.42
Bond    | 0.0018752  | 0.0020985  | 0.0024198  |   0.4 |  0.00
Neigh   | 16.191     | 16.341     | 16.503     |   2.8 |  5.48
Comm    | 19.574     | 22.786     | 27.615     |  52.3 |  7.64
Output  | 0.033322   | 0.05452    | 0.077996   |   6.6 |  0.02
Modify  | 24.125     | 24.331     | 24.554     |   2.7 |  8.16
Other   |            | 0.8534     |            |       |  0.29

Nlocal:          45.75 ave          51 max          35 min
Histogram: 1 0 0 0 2 0 1 0 1 3
Nghost:        3536.88 ave        3571 max        3502 min
Histogram: 1 0 0 1 3 0 1 1 0 1
Neighs:        32028.5 ave       35730 max       24647 min
Histogram: 1 0 0 0 2 0 1 0 1 3

Total # of neighbors = 256228
Ave neighs/atom = 700.0765
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.4224
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-0.6162)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.007 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.4224
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.2538999999999997925, deltaxy = 0.82539
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.61619999999999996998, deltaxz = -0.06162
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6491000000000000103, deltayz = 0.06491
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -1.34224 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.8 | 140.4 | 142 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.203       -44316.869      3801.7709      3659.697       16.1249        13.4224        16.909       
       100   301.36887     -44324.581      4881.6372      3659.697       16.1249        13.4224        16.909       
       200   282.84553     -44326.377      1917.6276      3659.697       16.1249        13.4224        16.909       
       300   284.71172     -44337.812      3588.8786      3659.697       16.1249        13.4224        16.909       
       400   293.73572     -44311.499      5288.3872      3659.697       16.1249        13.4224        16.909       
       500   297.49463     -44283.639      3502.1968      3659.697       16.1249        13.4224        16.909       
       600   302.19737     -44285.729     -1090.6481      3659.697       16.1249        13.4224        16.909       
       700   295.49443     -44305.022      1418.8605      3659.697       16.1249        13.4224        16.909       
       800   283.67653     -44307.43      -3803.7324      3659.697       16.1249        13.4224        16.909       
       900   296.05823     -44317.475     -1064.8266      3659.697       16.1249        13.4224        16.909       
      1000   319.50844     -44325.713      3483.8693      3659.697       16.1249        13.4224        16.909       
      1100   307.98227     -44280.349      5357.3531      3659.697       16.1249        13.4224        16.909       
      1200   338.98074     -44317.211     -6528.4672      3659.697       16.1249        13.4224        16.909       
      1300   323.60654     -44341.517     -1697.9608      3659.697       16.1249        13.4224        16.909       
      1400   289.32767     -44314.356      5719.0039      3659.697       16.1249        13.4224        16.909       
      1500   296.17652     -44319.218      1786.3928      3659.697       16.1249        13.4224        16.909       
      1600   291.46251     -44307.152     -2948.1804      3659.697       16.1249        13.4224        16.909       
      1700   305.97185     -44310.862      9530.9972      3659.697       16.1249        13.4224        16.909       
      1800   310.92093     -44311.554     -4678.683       3659.697       16.1249        13.4224        16.909       
      1900   301.56497     -44322.302     -3168.6072      3659.697       16.1249        13.4224        16.909       
      2000   275.8746      -44318.367      7897.2357      3659.697       16.1249        13.4224        16.909       
      2100   305.99085     -44337.991      10705.611      3659.697       16.1249        13.4224        16.909       
      2200   302.20666     -44313.972      13990.252      3659.697       16.1249        13.4224        16.909       
      2300   296.70757     -44305.847      1216.1866      3659.697       16.1249        13.4224        16.909       
      2400   311.02433     -44321.826     -1447.9105      3659.697       16.1249        13.4224        16.909       
      2500   290.94651     -44311.726      4765.5748      3659.697       16.1249        13.4224        16.909       
      2600   295.50037     -44321.092     -12805.094      3659.697       16.1249        13.4224        16.909       
      2700   289.78086     -44310.396     -7272.9786      3659.697       16.1249        13.4224        16.909       
      2800   298.35612     -44310.766      7121.7319      3659.697       16.1249        13.4224        16.909       
      2900   287.28744     -44293.071     -3336.568       3659.697       16.1249        13.4224        16.909       
      3000   298.19867     -44287.986     -2059.6614      3659.697       16.1249        13.4224        16.909       
      3100   295.78417     -44280.718      2050.1556      3659.697       16.1249        13.4224        16.909       
      3200   301.99348     -44311.857     -11395.113      3659.697       16.1249        13.4224        16.909       
      3300   288.54717     -44310.429      5339.7624      3659.697       16.1249        13.4224        16.909       
      3400   303.55023     -44312.102     -1393.5557      3659.697       16.1249        13.4224        16.909       
      3500   288.99511     -44277.463     -7385.3962      3659.697       16.1249        13.4224        16.909       
      3600   294.49154     -44280.512     -489.31894      3659.697       16.1249        13.4224        16.909       
      3700   317.61012     -44310.765      10893.306      3659.697       16.1249        13.4224        16.909       
      3800   317.3488      -44314.42      -396.3266       3659.697       16.1249        13.4224        16.909       
      3900   297.23458     -44298.445      6143.5499      3659.697       16.1249        13.4224        16.909       
      4000   295.03108     -44302.027     -301.64009      3659.697       16.1249        13.4224        16.909       
      4100   279.08159     -44292.938      6013.9943      3659.697       16.1249        13.4224        16.909       
      4200   291.22303     -44292.87      -5081.0986      3659.697       16.1249        13.4224        16.909       
      4300   292.3104      -44282.648      2468.8169      3659.697       16.1249        13.4224        16.909       
      4400   312.51389     -44288.483     -4892.356       3659.697       16.1249        13.4224        16.909       
      4500   303.86898     -44266.927      7162.8651      3659.697       16.1249        13.4224        16.909       
      4600   295.1003      -44284.153     -4600.3853      3659.697       16.1249        13.4224        16.909       
      4700   288.9407      -44293.651      8596.3615      3659.697       16.1249        13.4224        16.909       
      4800   315.26925     -44301.38       329.66219      3659.697       16.1249        13.4224        16.909       
      4900   328.52813     -44299.192      5176.471       3659.697       16.1249        13.4224        16.909       
      5000   306.49566     -44278.64       1496.5172      3659.697       16.1249        13.4224        16.909       
Loop time of 301.769 on 16 procs for 5000 steps with 366 atoms

Performance: 0.716 ns/day, 33.530 hours/ns, 16.569 timesteps/s, 6.064 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 229.76     | 233.83     | 240.12     |  21.1 | 77.49
Bond    | 0.0017975  | 0.0021172  | 0.0023599  |   0.4 |  0.00
Neigh   | 15.956     | 16.578     | 17.043     |   8.5 |  5.49
Comm    | 19.396     | 25.701     | 29.923     |  64.1 |  8.52
Output  | 0.032871   | 0.040447   | 0.047633   |   2.1 |  0.01
Modify  | 24.096     | 24.604     | 25.298     |   7.6 |  8.15
Other   |            | 1.011      |            |       |  0.34

Nlocal:          45.75 ave          54 max          40 min
Histogram: 2 0 2 0 1 1 1 0 0 1
Nghost:         3593.5 ave        3657 max        3535 min
Histogram: 1 1 1 0 2 1 0 0 1 1
Neighs:        32052.6 ave       37251 max       28107 min
Histogram: 1 1 1 1 1 0 2 0 0 1

Total # of neighbors = 256421
Ave neighs/atom = 700.60383
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.4224
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 1.34224 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.8 | 140.4 | 142 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.203       -44316.869      3801.7709      3659.697       16.1249        13.4224        16.909       
       100   301.3143      -44324.649      4815.3223      3659.697       16.1249        13.4224        16.909       
       200   287.7817      -44332.194      2906.7239      3659.697       16.1249        13.4224        16.909       
       300   285.06651     -44337.315      169.59963      3659.697       16.1249        13.4224        16.909       
       400   294.05147     -44303.57      -2474.3443      3659.697       16.1249        13.4224        16.909       
       500   322.24828     -44308.325     -1106.275       3659.697       16.1249        13.4224        16.909       
       600   297.8418      -44288.49      -2217.6038      3659.697       16.1249        13.4224        16.909       
       700   300.88537     -44319.096     -1607.5564      3659.697       16.1249        13.4224        16.909       
       800   287.95304     -44317.924     -5370.4494      3659.697       16.1249        13.4224        16.909       
       900   300.0117      -44325.357     -6390.7232      3659.697       16.1249        13.4224        16.909       
      1000   298.90794     -44290.567      2081.5731      3659.697       16.1249        13.4224        16.909       
      1100   337.15598     -44304.841     -6669.9769      3659.697       16.1249        13.4224        16.909       
      1200   323.7896      -44311.05      -729.65345      3659.697       16.1249        13.4224        16.909       
      1300   315.3222      -44320.36       1235.8176      3659.697       16.1249        13.4224        16.909       
      1400   300.18446     -44319.685      4591.3064      3659.697       16.1249        13.4224        16.909       
      1500   283.61093     -44309.482      2017.8708      3659.697       16.1249        13.4224        16.909       
      1600   303.81972     -44322.252      1471.587       3659.697       16.1249        13.4224        16.909       
      1700   319.10796     -44296.051      10514.661      3659.697       16.1249        13.4224        16.909       
      1800   321.61698     -44294.337      5308.7752      3659.697       16.1249        13.4224        16.909       
      1900   306.94427     -44301.453     -5535.1684      3659.697       16.1249        13.4224        16.909       
      2000   291.17054     -44300.504     -8181.784       3659.697       16.1249        13.4224        16.909       
      2100   300.59309     -44311.023     -4148.113       3659.697       16.1249        13.4224        16.909       
      2200   301.71682     -44312.073      6534.9019      3659.697       16.1249        13.4224        16.909       
      2300   301.13036     -44314.274     -1516.8853      3659.697       16.1249        13.4224        16.909       
      2400   269.78179     -44298.616     -7523.1789      3659.697       16.1249        13.4224        16.909       
      2500   299.30094     -44328.719     -5602.0467      3659.697       16.1249        13.4224        16.909       
      2600   296.98771     -44300.863     -9644.6113      3659.697       16.1249        13.4224        16.909       
      2700   314.39218     -44291.454     -12004.955      3659.697       16.1249        13.4224        16.909       
      2800   327.51164     -44303.804     -2955.8895      3659.697       16.1249        13.4224        16.909       
      2900   282.74045     -44269.167     -553.30085      3659.697       16.1249        13.4224        16.909       
      3000   306.95684     -44301.609      881.20145      3659.697       16.1249        13.4224        16.909       
      3100   284.56032     -44288.369     -385.30763      3659.697       16.1249        13.4224        16.909       
      3200   300.53957     -44312.477     -76.383288      3659.697       16.1249        13.4224        16.909       
      3300   294.42392     -44307.226      8773.061       3659.697       16.1249        13.4224        16.909       
      3400   304.59701     -44289.69      -2883.6333      3659.697       16.1249        13.4224        16.909       
      3500   312.24513     -44279.741     -784.40691      3659.697       16.1249        13.4224        16.909       
      3600   320.93693     -44299.502      1918.9216      3659.697       16.1249        13.4224        16.909       
      3700   281.97316     -44283.947      5372.3748      3659.697       16.1249        13.4224        16.909       
      3800   277.33336     -44275.854     -405.03747      3659.697       16.1249        13.4224        16.909       
      3900   284.03211     -44268.362     -11246.391      3659.697       16.1249        13.4224        16.909       
      4000   309.16592     -44281.495     -7400.8993      3659.697       16.1249        13.4224        16.909       
      4100   291.80353     -44268.295     -2709.4082      3659.697       16.1249        13.4224        16.909       
      4200   302.06279     -44302.389     -3428.8117      3659.697       16.1249        13.4224        16.909       
      4300   277.37991     -44298.076      756.96836      3659.697       16.1249        13.4224        16.909       
      4400   281.71165     -44286.372      164.18608      3659.697       16.1249        13.4224        16.909       
      4500   306.27053     -44293.305     -4092.7229      3659.697       16.1249        13.4224        16.909       
      4600   298.76281     -44271.162     -39.849729      3659.697       16.1249        13.4224        16.909       
      4700   305.72915     -44256.455     -13548.447      3659.697       16.1249        13.4224        16.909       
      4800   335.8944      -44251.965      3755.4276      3659.697       16.1249        13.4224        16.909       
      4900   308.15798     -44239.69       777.74966      3659.697       16.1249        13.4224        16.909       
      5000   283.79622     -44250.085      2384.9704      3659.697       16.1249        13.4224        16.909       
Loop time of 260.003 on 16 procs for 5000 steps with 366 atoms

Performance: 0.831 ns/day, 28.889 hours/ns, 19.231 timesteps/s, 7.038 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 156.2      | 200.42     | 220.24     | 143.7 | 77.09
Bond    | 0.0014331  | 0.0017658  | 0.0020077  |   0.4 |  0.00
Neigh   | 12.207     | 15.63      | 17.579     |  40.1 |  6.01
Comm    | 1.6926     | 21.512     | 65.747     | 438.7 |  8.27
Output  | 0.015159   | 0.017536   | 0.019416   |   0.9 |  0.01
Modify  | 20.323     | 22.288     | 25.723     |  33.9 |  8.57
Other   |            | 0.1288     |            |       |  0.05

Nlocal:          45.75 ave          51 max          41 min
Histogram: 1 1 2 0 0 0 1 1 0 2
Nghost:        3559.62 ave        3573 max        3537 min
Histogram: 1 0 1 0 0 0 3 0 2 1
Neighs:        32062.6 ave       35909 max       28856 min
Histogram: 2 1 1 0 0 1 1 0 0 2

Total # of neighbors = 256501
Ave neighs/atom = 700.8224
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 16.909
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--8.2539)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*16.909
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.2538999999999997925, deltaxy = 0.82539
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.61619999999999996998, deltaxz = -0.06162
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6491000000000000103, deltayz = 0.06491
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -1.6909 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.8 | 140.4 | 142 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.203       -44316.869      3801.7709      3659.697       16.1249        13.4224        16.909       
       100   301.2654      -44324.429      4988.5722      3659.697       16.1249        13.4224        16.909       
       200   288.05971     -44332.563      1818.6992      3659.697       16.1249        13.4224        16.909       
       300   287.33657     -44340.291     -2406.3383      3659.697       16.1249        13.4224        16.909       
       400   292.4551      -44325.753     -7741.8593      3659.697       16.1249        13.4224        16.909       
       500   296.93035     -44292.971      1688.556       3659.697       16.1249        13.4224        16.909       
       600   308.89338     -44297.716      1131.357       3659.697       16.1249        13.4224        16.909       
       700   289.45482     -44292.844      1533.1241      3659.697       16.1249        13.4224        16.909       
       800   295.65044     -44323.102     -5524.8603      3659.697       16.1249        13.4224        16.909       
       900   302.67603     -44328.546      3437.8882      3659.697       16.1249        13.4224        16.909       
      1000   306.61888     -44318.281     -4342.4452      3659.697       16.1249        13.4224        16.909       
      1100   314.89101     -44301.618      6211.0879      3659.697       16.1249        13.4224        16.909       
      1200   322.80473     -44306.734      15530.727      3659.697       16.1249        13.4224        16.909       
      1300   294.99055     -44310.36       3059.8123      3659.697       16.1249        13.4224        16.909       
      1400   288.87968     -44320.257      1230.8902      3659.697       16.1249        13.4224        16.909       
      1500   292.76269     -44320.081     -2479.9365      3659.697       16.1249        13.4224        16.909       
      1600   307.6115      -44320.67      -3268.187       3659.697       16.1249        13.4224        16.909       
      1700   313.72205     -44297.219     -11407.669      3659.697       16.1249        13.4224        16.909       
      1800   331.42527     -44293.19      -12153.413      3659.697       16.1249        13.4224        16.909       
      1900   306.3812      -44294.733     -7070.752       3659.697       16.1249        13.4224        16.909       
      2000   293.44897     -44293.292      13191.341      3659.697       16.1249        13.4224        16.909       
      2100   295.56425     -44299.939     -2454.0691      3659.697       16.1249        13.4224        16.909       
      2200   306.85101     -44319.82       2528.3703      3659.697       16.1249        13.4224        16.909       
      2300   300.91935     -44315.905      9875.3937      3659.697       16.1249        13.4224        16.909       
      2400   285.97088     -44300.979      6668.7945      3659.697       16.1249        13.4224        16.909       
      2500   302.56309     -44326.806      5210.53        3659.697       16.1249        13.4224        16.909       
      2600   284.80178     -44299.008     -204.71101      3659.697       16.1249        13.4224        16.909       
      2700   305.41206     -44291.911      7921.5312      3659.697       16.1249        13.4224        16.909       
      2800   296.03213     -44262.619     -1926.0915      3659.697       16.1249        13.4224        16.909       
      2900   304.02585     -44273.072      61.733758      3659.697       16.1249        13.4224        16.909       
      3000   302.48308     -44308.339      4198.3836      3659.697       16.1249        13.4224        16.909       
      3100   300.1048      -44310.285      662.63489      3659.697       16.1249        13.4224        16.909       
      3200   294.96969     -44281.685      10087.91       3659.697       16.1249        13.4224        16.909       
      3300   304.37221     -44271.575      8102.321       3659.697       16.1249        13.4224        16.909       
      3400   311.71764     -44276.118     -8390.4333      3659.697       16.1249        13.4224        16.909       
      3500   321.90346     -44288.909      9929.521       3659.697       16.1249        13.4224        16.909       
      3600   318.86159     -44291.354     -5600.5227      3659.697       16.1249        13.4224        16.909       
      3700   305.11437     -44280.628     -11024.666      3659.697       16.1249        13.4224        16.909       
      3800   294.57555     -44278.171      2873.4902      3659.697       16.1249        13.4224        16.909       
      3900   285.39621     -44276.552      9019.1271      3659.697       16.1249        13.4224        16.909       
      4000   287.63142     -44293.977      9237.3597      3659.697       16.1249        13.4224        16.909       
      4100   302.73508     -44288.323     -9790.4283      3659.697       16.1249        13.4224        16.909       
      4200   306.97819     -44256.875      11497.871      3659.697       16.1249        13.4224        16.909       
      4300   299.43602     -44245.706      8040.5928      3659.697       16.1249        13.4224        16.909       
      4400   292.56367     -44254.847      2703.4058      3659.697       16.1249        13.4224        16.909       
      4500   291.26539     -44265.728      11356.525      3659.697       16.1249        13.4224        16.909       
      4600   286.81012     -44253.173      6565.8665      3659.697       16.1249        13.4224        16.909       
      4700   304.5657      -44260.898     -1473.2166      3659.697       16.1249        13.4224        16.909       
      4800   300.216       -44246.823     -8476.2269      3659.697       16.1249        13.4224        16.909       
      4900   320.41601     -44257.617     -8963.7856      3659.697       16.1249        13.4224        16.909       
      5000   311.12628     -44272.372      4413.5653      3659.697       16.1249        13.4224        16.909       
Loop time of 161.727 on 16 procs for 5000 steps with 366 atoms

Performance: 1.336 ns/day, 17.970 hours/ns, 30.916 timesteps/s, 11.315 katom-step/s
100.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 123.8      | 127.55     | 132.46     |  24.2 | 78.87
Bond    | 0.00089748 | 0.0011234  | 0.0013664  |   0.5 |  0.00
Neigh   | 12.177     | 12.384     | 12.62      |   4.8 |  7.66
Comm    | 1.1379     | 6.0551     | 9.7861     | 111.1 |  3.74
Output  | 0.011858   | 0.013539   | 0.01474    |   0.7 |  0.01
Modify  | 15.335     | 15.595     | 15.794     |   4.3 |  9.64
Other   |            | 0.1245     |            |       |  0.08

Nlocal:          45.75 ave          54 max          37 min
Histogram: 1 1 1 0 0 2 0 1 1 1
Nghost:         3740.5 ave        3812 max        3672 min
Histogram: 2 2 0 0 0 0 0 1 1 2
Neighs:        32039.5 ave       37342 max       26141 min
Histogram: 1 1 1 0 0 1 1 1 0 2

Total # of neighbors = 256316
Ave neighs/atom = 700.31694
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*16.909
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 1.6909 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.8 | 140.4 | 142 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   311.203       -44316.869      3801.7709      3659.697       16.1249        13.4224        16.909       
       100   301.39576     -44324.668      4725.2254      3659.697       16.1249        13.4224        16.909       
       200   285.08737     -44328.258      5136.1459      3659.697       16.1249        13.4224        16.909       
       300   281.96573     -44329.92       451.68881      3659.697       16.1249        13.4224        16.909       
       400   291.20505     -44294.937     -1982.1056      3659.697       16.1249        13.4224        16.909       
       500   297.45872     -44273.715      7638.307       3659.697       16.1249        13.4224        16.909       
       600   306.47496     -44300.055      819.14552      3659.697       16.1249        13.4224        16.909       
       700   309.83898     -44331.329     -633.6713       3659.697       16.1249        13.4224        16.909       
       800   286.04131     -44312.873     -137.60749      3659.697       16.1249        13.4224        16.909       
       900   290.04681     -44305.976      89.424945      3659.697       16.1249        13.4224        16.909       
      1000   317.27507     -44303.121      5274.893       3659.697       16.1249        13.4224        16.909       
      1100   318.10584     -44292.924     -6989.6465      3659.697       16.1249        13.4224        16.909       
      1200   303.98364     -44303.868      5433.2704      3659.697       16.1249        13.4224        16.909       
      1300   293.00833     -44309.767      6222.9976      3659.697       16.1249        13.4224        16.909       
      1400   298.84607     -44311.8        11522.9        3659.697       16.1249        13.4224        16.909       
      1500   289.48259     -44293.282      4093.4197      3659.697       16.1249        13.4224        16.909       
      1600   302.93717     -44303.005     -939.53127      3659.697       16.1249        13.4224        16.909       
      1700   308.16196     -44302.079      2971.1604      3659.697       16.1249        13.4224        16.909       
      1800   311.65443     -44299.595     -208.09467      3659.697       16.1249        13.4224        16.909       
      1900   298.94985     -44299.939     -2858.7532      3659.697       16.1249        13.4224        16.909       
      2000   288.80364     -44301.696      9624.2973      3659.697       16.1249        13.4224        16.909       
      2100   302.62035     -44308.839      9273.929       3659.697       16.1249        13.4224        16.909       
      2200   306.97876     -44277.81       8550.8457      3659.697       16.1249        13.4224        16.909       
      2300   306.78776     -44257.08       7359.341       3659.697       16.1249        13.4224        16.909       
      2400   326.35149     -44293.139      4550.2067      3659.697       16.1249        13.4224        16.909       
      2500   293.90769     -44277.774     -301.96572      3659.697       16.1249        13.4224        16.909       
      2600   290.32778     -44266.175      2928.126       3659.697       16.1249        13.4224        16.909       
      2700   296.22421     -44255.766      7363.32        3659.697       16.1249        13.4224        16.909       
      2800   300.83114     -44250.911      1489.7961      3659.697       16.1249        13.4224        16.909       
      2900   302.56708     -44279.079      4329.8401      3659.697       16.1249        13.4224        16.909       
      3000   274.96136     -44270.452      1863.4638      3659.697       16.1249        13.4224        16.909       
      3100   292.74416     -44279.284      7186.0875      3659.697       16.1249        13.4224        16.909       
      3200   305.16382     -44273.941     -2941.8374      3659.697       16.1249        13.4224        16.909       
      3300   316.23544     -44248.575      2814.4217      3659.697       16.1249        13.4224        16.909       
      3400   317.20592     -44250.601      13917.627      3659.697       16.1249        13.4224        16.909       
      3500   293.49606     -44258.835     -4688.1172      3659.697       16.1249        13.4224        16.909       
      3600   301.46902     -44269.179     -3716.2643      3659.697       16.1249        13.4224        16.909       
      3700   303.4857      -44274.618      4769.772       3659.697       16.1249        13.4224        16.909       
      3800   316.13697     -44274.796     -3393.8211      3659.697       16.1249        13.4224        16.909       
      3900   302.97793     -44236.059      274.77597      3659.697       16.1249        13.4224        16.909       
      4000   314.43376     -44228.301     -6126.1016      3659.697       16.1249        13.4224        16.909       
      4100   302.50828     -44245.425      2026.9153      3659.697       16.1249        13.4224        16.909       
      4200   293.36624     -44252.441      2921.2941      3659.697       16.1249        13.4224        16.909       
      4300   305.32068     -44266.679      5410.1303      3659.697       16.1249        13.4224        16.909       
      4400   305.92607     -44248.431      5698.4089      3659.697       16.1249        13.4224        16.909       
      4500   297.62201     -44209.338      5529.6202      3659.697       16.1249        13.4224        16.909       
      4600   311.43122     -44200.591      7036.8495      3659.697       16.1249        13.4224        16.909       
      4700   306.899       -44216.271      200.43748      3659.697       16.1249        13.4224        16.909       
      4800   302.99569     -44246.673     -1570.4691      3659.697       16.1249        13.4224        16.909       
      4900   283.35046     -44215.239     -2714.5724      3659.697       16.1249        13.4224        16.909       
      5000   303.54306     -44214.404      7652.9699      3659.697       16.1249        13.4224        16.909       
Loop time of 150.826 on 16 procs for 5000 steps with 366 atoms

Performance: 1.432 ns/day, 16.758 hours/ns, 33.151 timesteps/s, 12.133 katom-step/s
100.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 115.5      | 117.91     | 122.36     |  21.4 | 78.17
Bond    | 0.00083734 | 0.0010877  | 0.0012778  |   0.5 |  0.00
Neigh   | 11.914     | 12.034     | 12.191     |   2.8 |  7.98
Comm    | 1.0303     | 5.4852     | 7.8751     |  99.2 |  3.64
Output  | 0.012275   | 0.014437   | 0.0161     |   0.9 |  0.01
Modify  | 15.076     | 15.264     | 15.377     |   2.6 | 10.12
Other   |            | 0.1224     |            |       |  0.08

Nlocal:          45.75 ave          54 max          37 min
Histogram: 1 1 0 1 1 1 0 0 2 1
Nghost:         3419.5 ave        3479 max        3377 min
Histogram: 1 1 2 1 1 0 0 0 1 1
Neighs:        32046.2 ave       37735 max       26325 min
Histogram: 2 0 0 1 1 1 0 2 0 1

Total # of neighbors = 256370
Ave neighs/atom = 700.46448
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 1:00:12
