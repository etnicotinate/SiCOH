LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-EXP-6-vasp
read_data       ${structure}.data
read_data       333-EXP-6-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (15.4861 14.0699 16.771) with tilt (-7.3915 0.9919 1.0308)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.007 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.864 | 6.864 | 6.864 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              244.12834      3053.9296    
         1   300            0              0              244.12834      3053.9296    
Loop time of 5.40959e-05 on 16 procs for 1 steps with 274 atoms

61.9% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.57e-07   | 1.8875e-07 | 2.24e-07   |   0.0 |  0.35
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 1.03e-06   | 1.1472e-06 | 1.368e-06  |   0.0 |  2.12
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 5.276e-05  |            |       | 97.53

Nlocal:          34.25 ave          43 max          26 min
Histogram: 1 1 0 0 2 1 1 1 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-EXP-6-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -8.2 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 103.8 | 104.4 | 105.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -29318.373      56055.99       0              1.3867102      3654.1976    
       100   929.37889     -31276.172     -6776.5451     -16425.616      1.3867102      3654.1976    
       200   561.69918     -31684.595     -3162.6506     -5580.2         1.3867102      3654.1976    
       300   424.75242     -31882.749     -1701.3789     -2498.4151      1.3867102      3654.1976    
       400   362.65484     -31955.33       14056.174     -2489.4823      1.3867102      3654.1976    
       500   336.2228      -31974.368      4509.7415      2338.8921      1.3867102      3654.1976    
       600   309.71421     -32006.802     -3470.8491     -1888.4943      1.3867102      3654.1976    
       700   341.00594     -32064.878     -5461.6995     -3186.2187      1.3867102      3654.1976    
       800   287.53885     -32064.674     -19270.252     -1411.4557      1.3867102      3654.1976    
       900   305.19687     -32088.53      -580.98578     -2103.5998      1.3867102      3654.1976    
      1000   329.60592     -32115.223     -3023.3774     -6185.1291      1.3867102      3654.1976    
      1100   310.40949     -32084.276      5794.8446     -8640.4688      1.3867102      3654.1976    
      1200   304.04077     -32090.357     -12220.159     -9185.7777      1.3867102      3654.1976    
      1300   296.24155     -32138.326     -5763.26        506.16108      1.3867102      3654.1976    
      1400   288.34986     -32143.744     -8894.4975     -952.9082       1.3867102      3654.1976    
      1500   277.31708     -32142.96      -7112.5148      783.9022       1.3867102      3654.1976    
      1600   280.86051     -32149.243     -4981.8046     -6768.1425      1.3867102      3654.1976    
      1700   297.83522     -32146.811     -2953.7333     -4966.9777      1.3867102      3654.1976    
      1800   311.16622     -32145.605     -1307.1228     -3829.8745      1.3867102      3654.1976    
      1900   319.80376     -32122.386      5543.151       1815.6988      1.3867102      3654.1976    
      2000   309.89476     -32157.481     -5771.6653      2719.3268      1.3867102      3654.1976    
Loop time of 73.3032 on 16 procs for 2000 steps with 274 atoms

Performance: 1.179 ns/day, 20.362 hours/ns, 27.284 timesteps/s, 7.476 katom-step/s
98.7% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 50.893     | 52.511     | 54.172     |  16.0 | 71.64
Bond    | 0.0006728  | 0.00082988 | 0.00098346 |   0.0 |  0.00
Neigh   | 4.3939     | 4.4536     | 4.4964     |   1.4 |  6.08
Comm    | 5.3427     | 7.0433     | 8.6047     |  43.3 |  9.61
Output  | 0.0010887  | 0.0013241  | 0.0025341  |   1.3 |  0.00
Modify  | 8.925      | 8.9945     | 9.0569     |   1.3 | 12.27
Other   |            | 0.2983     |            |       |  0.41

Nlocal:          34.25 ave          39 max          30 min
Histogram: 1 2 1 0 1 0 0 0 1 2
Nghost:        2584.38 ave        2594 max        2568 min
Histogram: 1 0 1 0 0 2 0 0 2 2
Neighs:        17982.9 ave       20376 max       15946 min
Histogram: 3 0 1 0 1 0 0 0 1 2

Total # of neighbors = 143863
Ave neighs/atom = 525.04745
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]
# use tmp to save constants
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.4861
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 14.0699
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 16.771

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-2719.32679462815)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-2719.32679462815)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--4232.72260699021)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--4232.72260699021)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-3823.56018002069)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-3823.56018002069)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-523.660273781631)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-523.660273781631)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--229.666754041452)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--229.666754041452)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-1064.7910988342)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-1064.7910988342)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 15.4861
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4861 14.0699 16.771) with tilt (-7.3915 0.9919 1.0308)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.002 seconds
  read_restart CPU = 0.006 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.4861
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.154861 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.154861 xy delta 0.073915 xz delta ${deltaxz} remap x units box
fix deform_n all deform 100 x delta 0 -0.154861 xy delta 0.073915 xz delta -0.009919 remap x units box
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 101.9 | 102.4 | 102.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.89476     -32157.481     -5771.6471      0              3654.1976    
       100   292.13399     -32162.98       2597.6596     -1388.3694      3652.3705    
       200   294.10148     -32156.176     -12218.974     -5310.3084      3650.5434    
       300   312.64929     -32157.932     -2847.8442      229.41875      3648.7163    
       400   288.65227     -32140.473     -4564.1562     -6956.3163      3646.8892    
       500   287.40462     -32158.24       1960.2531     -4670.6868      3645.0621    
       600   307.45946     -32176.625      4091.9606      621.59704      3643.235     
       700   285.61998     -32152.112     -7938.8677      3399.8019      3641.4079    
       800   322.71971     -32172.369     -6596.0088      1224.3966      3639.5808    
       900   293.72363     -32138.826     -9781.1678     -4174.4646      3637.7537    
      1000   293.43021     -32148.195     -4536.1216     -758.84033      3635.9266    
      1100   289.38914     -32168.957     -4899.9159      2189.3879      3634.0995    
      1200   295.84629     -32165.293     -8963.2825      100.84778      3632.2724    
      1300   314.49721     -32159.553     -5912.1679      517.3797       3630.4453    
      1400   292.1357      -32138.151     -10652.205      2187.0489      3628.6182    
      1500   290.47213     -32158.725     -4438.2671      3966.9672      3626.7911    
      1600   275.84418     -32171.673      899.38404      2821.8403      3624.964     
      1700   296.73007     -32163.61      -5297.9272      49.027717      3623.1369    
      1800   334.37974     -32167.666      2606.0663      4738.9223      3621.3098    
      1900   316.51911     -32163.404      1757.0166     -51.205413      3619.4827    
      2000   307.5447      -32161.609      2333.3926      5927.4723      3617.6556    
Loop time of 74.7893 on 16 procs for 2000 steps with 274 atoms

Performance: 1.155 ns/day, 20.775 hours/ns, 26.742 timesteps/s, 7.327 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 52.833     | 53.914     | 55.086     |   8.7 | 72.09
Bond    | 0.00062332 | 0.0008186  | 0.00093293 |   0.0 |  0.00
Neigh   | 4.3651     | 4.4225     | 4.4771     |   2.1 |  5.91
Comm    | 5.7474     | 6.9097     | 7.9416     |  23.5 |  9.24
Output  | 0.0063859  | 0.011051   | 0.015262   |   3.4 |  0.01
Modify  | 9.0801     | 9.1657     | 9.2884     |   2.1 | 12.26
Other   |            | 0.3651     |            |       |  0.49

Nlocal:          34.25 ave          39 max          29 min
Histogram: 1 1 1 0 1 0 0 0 2 2
Nghost:        2612.38 ave        2633 max        2588 min
Histogram: 1 0 1 0 2 1 0 0 2 1
Neighs:        18148.8 ave       20479 max       15628 min
Histogram: 2 1 0 1 0 0 0 0 2 2

Total # of neighbors = 145190
Ave neighs/atom = 529.89051
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 32.5065343379511
variable C2neg equal ${d2}
variable C2neg equal 18.3513743143074
variable C3neg equal ${d3}
variable C3neg equal -63.6879348834647
variable C4neg equal ${d4}
variable C4neg equal 14.0148194027869
variable C5neg equal ${d5}
variable C5neg equal 4.88884117019817
variable C6neg equal ${d6}
variable C6neg equal -9.3441858396931

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4861 14.0699 16.771) with tilt (-7.3915 0.9919 1.0308)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.4861
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.154861 xy delta ${deltaxy} xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.154861 xy delta -0.073915 xz delta ${deltaxz} remap x units box
fix deform_p all deform 100 x delta 0 0.154861 xy delta -0.073915 xz delta 0.009919 remap x units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 1
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 101.9 | 102.4 | 102.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.89476     -32157.481     -5771.6471      0              3654.1976    
       100   292.13399     -32162.98       2595.0633     -1388.9379      3656.0247    
       200   294.09125     -32155.864     -12875.238     -5925.6973      3657.8518    
       300   305.71536     -32162.497     -6575.4916     -1574.1209      3659.6789    
       400   314.14128     -32142.802     -10563.255     -9738.9522      3661.506     
       500   284.753       -32143.525     -3897.2626     -4107.4152      3663.3331    
       600   301.8398      -32167.896     -12593.843     -5462.225       3665.1602    
       700   285.94625     -32149.034     -3642.807      -307.08426      3666.9873    
       800   289.28379     -32130.326     -8427.9337      71.979276      3668.8144    
       900   313.94053     -32156.879     -4108.1034     -6267.7818      3670.6415    
      1000   300.78225     -32140.976     -4978.6262     -1352.6214      3672.4686    
      1100   291.76638     -32156.981     -8094.6386     -2811.0467      3674.2957    
      1200   299.74447     -32167.539      585.87976      1103.6588      3676.1228    
      1300   311.65885     -32164.044     -10270.949     -6273.2768      3677.9499    
      1400   309.24143     -32196.983      2454.7903     -3485.3688      3679.777     
      1500   279.99951     -32171.495     -1485.4007      189.40161      3681.6041    
      1600   300.20157     -32163.494     -9938.6228     -7811.0341      3683.4312    
      1700   250.93349     -32152.798     -12892.526     -4450.2671      3685.2583    
      1800   288.44553     -32159.345     -5425.108      -4147.0768      3687.0854    
      1900   299.97004     -32180.292     -5833.5522     -4181.8873      3688.9125    
      2000   300.31836     -32199.951     -8261.1703     -3634.2072      3690.7396    
Loop time of 73.6864 on 16 procs for 2000 steps with 274 atoms

Performance: 1.173 ns/day, 20.468 hours/ns, 27.142 timesteps/s, 7.437 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 50.897     | 53.188     | 55.082     |  16.0 | 72.18
Bond    | 0.0006391  | 0.0008057  | 0.0009805  |   0.0 |  0.00
Neigh   | 4.0398     | 4.1516     | 4.2458     |   3.3 |  5.63
Comm    | 5.1265     | 6.9848     | 9.291      |  44.5 |  9.48
Output  | 0.0069076  | 0.010713   | 0.014517   |   2.9 |  0.01
Modify  | 8.8921     | 9.0067     | 9.1356     |   3.1 | 12.22
Other   |            | 0.344      |            |       |  0.47

Nlocal:          34.25 ave          39 max          30 min
Histogram: 1 1 1 1 1 0 0 1 1 1
Nghost:         2584.5 ave        2624 max        2553 min
Histogram: 2 1 0 0 2 1 0 0 0 2
Neighs:        17820.2 ave       20031 max       15696 min
Histogram: 1 1 1 1 1 0 0 1 0 2

Total # of neighbors = 142562
Ave neighs/atom = 520.29927
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 64.3771830289255
variable C2pos equal ${d2}
variable C2pos equal 34.2143835477671
variable C3pos equal ${d3}
variable C3pos equal 35.0946022764494
variable C4pos equal ${d4}
variable C4pos equal -2.12504314725275
variable C5pos equal ${d5}
variable C5pos equal -3.93947945251289
variable C6pos equal ${d6}
variable C6pos equal -1.88738963147881

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(32.5065343379511+${C1pos})
variable C11 equal 0.5*(32.5065343379511+64.3771830289255)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(18.3513743143074+${C2pos})
variable C21 equal 0.5*(18.3513743143074+34.2143835477671)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(-63.6879348834647+${C3pos})
variable C31 equal 0.5*(-63.6879348834647+35.0946022764494)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(14.0148194027869+${C4pos})
variable C41 equal 0.5*(14.0148194027869+-2.12504314725275)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(4.88884117019817+${C5pos})
variable C51 equal 0.5*(4.88884117019817+-3.93947945251289)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-9.3441858396931+${C6pos})
variable C61 equal 0.5*(-9.3441858396931+-1.88738963147881)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 14.0699
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4861 14.0699 16.771) with tilt (-7.3915 0.9919 1.0308)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.0699
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.140699 yz delta ${deltayz} remap x units box
fix deform_n all deform 100 y delta 0 -0.140699 yz delta -0.010308 remap x units box
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 101.9 | 102.4 | 102.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.89476     -32157.481     -5771.6471      0              3654.1976    
       100   292.13399     -32162.98       2597.6596     -1388.3694      3652.3705    
       200   294.08602     -32156.292     -12125.483     -5543.6631      3650.5434    
       300   313.4347      -32160.355     -3715.8569     -221.29962      3648.7163    
       400   296.18644     -32149.333     -6978.6329     -5212.2005      3646.8892    
       500   297.42249     -32139.35      -3296.4442     -1753.5799      3645.0621    
       600   293.55765     -32159.646     -2062.1952     -1220.5178      3643.235     
       700   305.83031     -32161.115     -2695.1323     -5018.1612      3641.4079    
       800   312.94227     -32161.488     -9.3713714     -2469.7957      3639.5808    
       900   283.87193     -32174.21      -147.95216     -2591.6373      3637.7537    
      1000   287.03989     -32160.619     -6512.9643     -1198.25        3635.9266    
      1100   281.96906     -32146.463      5898.4135     -1939.361       3634.0995    
      1200   299.06853     -32171.276     -1280.8136      931.56613      3632.2724    
      1300   275.07107     -32157.145     -3831.6396     -176.40839      3630.4453    
      1400   288.68701     -32171.522      9396.2989      224.93016      3628.6182    
      1500   293.22079     -32162.714      1108.6085      312.89508      3626.7911    
      1600   301.442       -32166.956     -3297.1918      66.315053      3624.964     
      1700   303.94346     -32161.926     -5261.4585     -3679.9065      3623.1369    
      1800   277.08944     -32151.819     -2927.7703      1430.1171      3621.3098    
      1900   299.2776      -32151.637     -2367.5644      6286.5366      3619.4827    
      2000   303.90733     -32167.972     -4763.6607      325.35686      3617.6556    
Loop time of 74.9203 on 16 procs for 2000 steps with 274 atoms

Performance: 1.153 ns/day, 20.811 hours/ns, 26.695 timesteps/s, 7.314 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.317     | 53.787     | 55.587     |  17.9 | 71.79
Bond    | 0.00061846 | 0.00080491 | 0.00097656 |   0.0 |  0.00
Neigh   | 4.3532     | 4.4471     | 4.502      |   2.4 |  5.94
Comm    | 5.3247     | 7.1366     | 9.5538     |  48.9 |  9.53
Output  | 0.0046859  | 0.0089379  | 0.012784   |   3.5 |  0.01
Modify  | 9.0672     | 9.1617     | 9.2863     |   2.4 | 12.23
Other   |            | 0.3782     |            |       |  0.50

Nlocal:          34.25 ave          40 max          29 min
Histogram: 2 1 1 0 0 0 1 0 2 1
Nghost:        2610.75 ave        2633 max        2586 min
Histogram: 1 0 0 2 2 0 0 0 2 1
Neighs:        18165.2 ave       21042 max       15641 min
Histogram: 2 1 1 0 0 0 1 0 2 1

Total # of neighbors = 145322
Ave neighs/atom = 530.37226
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -24.2569003753101
variable C2neg equal ${d2}
variable C2neg equal -50.6477065414329
variable C3neg equal ${d3}
variable C3neg equal -40.3301847565572
variable C4neg equal ${d4}
variable C4neg equal 4.5640097457856
variable C5neg equal ${d5}
variable C5neg equal 15.7425418110316
variable C6neg equal ${d6}
variable C6neg equal -16.3523323140422

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4861 14.0699 16.771) with tilt (-7.3915 0.9919 1.0308)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.0699
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.140699 yz delta ${deltayz} remap x units box
fix deform_p all deform 100 y delta 0 0.140699 yz delta 0.010308 remap x units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 2
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 101.9 | 102.4 | 102.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.89476     -32157.481     -5771.6471      0              3654.1976    
       100   292.13399     -32162.98       2595.0633     -1388.9379      3656.0247    
       200   294.73493     -32155.872     -12947.538     -5751.031       3657.8518    
       300   320.09668     -32162.798     -6020.2436     -559.52985      3659.6789    
       400   327.59707     -32134.816     -17298.145     -7802.5675      3661.506     
       500   338.65902     -32150.191     -5227.9179     -215.07128      3663.3331    
       600   317.98602     -32154.663     -5191.3941     -5329.0043      3665.1602    
       700   297.71522     -32143.94       1051.134       46.719491      3666.9873    
       800   301.77687     -32150.858     -9476.3593     -6262.7535      3668.8144    
       900   289.40259     -32130.511     -4412.7297     -2933.5401      3670.6415    
      1000   294.70512     -32142.063     -11716.824     -2579.4597      3672.4686    
      1100   325.2944      -32142.151     -12668.304     -1713.9578      3674.2957    
      1200   313.81474     -32158.866     -12913.793     -7485.3645      3676.1228    
      1300   308.42054     -32142.001     -17986.108     -3142.4698      3677.9499    
      1400   302.14224     -32139.65      -7287.0472     -1989.709       3679.777     
      1500   332.36511     -32131.839     -16663.232      34.523524      3681.6041    
      1600   299.55678     -32139.574     -1631.3771      208.93144      3683.4312    
      1700   306.64802     -32137.629     -1880.7839      139.65924      3685.2583    
      1800   284.58569     -32145.719     -1951.6012     -224.49465      3687.0854    
      1900   294.48512     -32163.045      656.01577      4774.2697      3688.9125    
      2000   295.42609     -32168.544     -10908.961     -3076.811       3690.7396    
Loop time of 73.6619 on 16 procs for 2000 steps with 274 atoms

Performance: 1.173 ns/day, 20.462 hours/ns, 27.151 timesteps/s, 7.439 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.215     | 52.638     | 55.654     |  19.3 | 71.46
Bond    | 0.00064028 | 0.00080508 | 0.0009776  |   0.0 |  0.00
Neigh   | 4.2693     | 4.3685     | 4.4938     |   3.4 |  5.93
Comm    | 4.2832     | 7.2186     | 8.6772     |  51.0 |  9.80
Output  | 0.0050282  | 0.0091688  | 0.012712   |   3.3 |  0.01
Modify  | 8.9359     | 9.0709     | 9.2099     |   2.5 | 12.31
Other   |            | 0.356      |            |       |  0.48

Nlocal:          34.25 ave          40 max          30 min
Histogram: 2 0 0 2 0 1 1 1 0 1
Nghost:        2585.25 ave        2610 max        2557 min
Histogram: 1 0 0 1 1 1 2 1 0 1
Neighs:        17800.6 ave       20680 max       15658 min
Histogram: 2 0 0 2 1 1 0 1 0 1

Total # of neighbors = 142405
Ave neighs/atom = 519.72628
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 58.7293666420364
variable C2pos equal ${d2}
variable C2pos equal 98.6626771979344
variable C3pos equal ${d3}
variable C3pos equal 75.8522331479447
variable C4pos equal ${d4}
variable C4pos equal 5.97669580890272
variable C5pos equal ${d5}
variable C5pos equal -10.9732787789659
variable C6pos equal ${d6}
variable C6pos equal 1.73625846416679

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(-24.2569003753101+${C1pos})
variable C12 equal 0.5*(-24.2569003753101+58.7293666420364)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(-50.6477065414329+${C2pos})
variable C22 equal 0.5*(-50.6477065414329+98.6626771979344)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(-40.3301847565572+${C3pos})
variable C32 equal 0.5*(-40.3301847565572+75.8522331479447)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(4.5640097457856+${C4pos})
variable C42 equal 0.5*(4.5640097457856+5.97669580890272)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(15.7425418110316+${C5pos})
variable C52 equal 0.5*(15.7425418110316+-10.9732787789659)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(-16.3523323140422+${C6pos})
variable C62 equal 0.5*(-16.3523323140422+1.73625846416679)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.771
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4861 14.0699 16.771) with tilt (-7.3915 0.9919 1.0308)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.771
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 ${delta} remap x units box
fix deform_n all deform 100 z delta 0 -0.16771 remap x units box
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 101.9 | 102.4 | 102.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.89476     -32157.481     -5771.6471      0              3654.1976    
       100   292.13399     -32162.98       2597.6596     -1388.3694      3652.3705    
       200   294.25499     -32156.074     -11989.15      -5524.3115      3650.5434    
       300   311.77321     -32159.983     -3663.9909     -339.552        3648.7163    
       400   286.12884     -32135.209     -11814.304     -6021.2166      3646.8892    
       500   309.36803     -32138.577     -6465.0601     -5984.9277      3645.0621    
       600   324.62231     -32155.853     -22348.413     -7006.8131      3643.235     
       700   297.61951     -32135.769     -8625.3659     -1723.6266      3641.4079    
       800   294.84988     -32138.469     -5460.6202     -2047.9077      3639.5808    
       900   282.02747     -32169.01      -3197.1836      2520.3397      3637.7537    
      1000   291.11307     -32140.695     -6803.027       1085.4779      3635.9266    
      1100   308.39411     -32161.767     -8503.8052     -3281.0599      3634.0995    
      1200   304.73436     -32170.062      11084.412      699.13179      3632.2724    
      1300   322.89262     -32191.676      4786.4545      2737.2372      3630.4453    
      1400   281.42056     -32193.395     -1838.7906      2570.8529      3628.6182    
      1500   318.50044     -32170.933      7117.4727      2173.2286      3626.7911    
      1600   293.78946     -32163.689      6140.0189      3748.8974      3624.964     
      1700   311.41384     -32166.97      -2518.0047     -3639.2014      3623.1369    
      1800   319.21858     -32182.474     -3586.0855      3644.5557      3621.3098    
      1900   310.78279     -32163.454     -6347.418      -1315.6147      3619.4827    
      2000   293.73945     -32160.024      1763.524       1418.7936      3617.6556    
Loop time of 74.5252 on 16 procs for 2000 steps with 274 atoms

Performance: 1.159 ns/day, 20.701 hours/ns, 26.837 timesteps/s, 7.353 katom-step/s
98.7% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 53.088     | 53.812     | 55.129     |   8.4 | 72.21
Bond    | 0.00067452 | 0.00081506 | 0.00096447 |   0.0 |  0.00
Neigh   | 4.2766     | 4.4169     | 4.5228     |   3.1 |  5.93
Comm    | 5.4715     | 6.7787     | 7.485      |  23.2 |  9.10
Output  | 0.0095566  | 0.015125   | 0.021726   |   3.6 |  0.02
Modify  | 8.9783     | 9.1381     | 9.3145     |   3.1 | 12.26
Other   |            | 0.3637     |            |       |  0.49

Nlocal:          34.25 ave          40 max          28 min
Histogram: 2 0 0 0 1 2 1 0 0 2
Nghost:        2608.12 ave        2627 max        2594 min
Histogram: 1 1 1 1 1 1 0 1 0 1
Neighs:        18147.9 ave       21050 max       15124 min
Histogram: 2 0 0 1 1 1 1 0 0 2

Total # of neighbors = 145183
Ave neighs/atom = 529.86496
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -13.1776529741949
variable C2neg equal ${d2}
variable C2neg equal 33.4211794698878
variable C3neg equal ${d3}
variable C3neg equal -23.0314365601995
variable C4neg equal ${d4}
variable C4neg equal -4.88851584496169
variable C5neg equal ${d5}
variable C5neg equal 23.9356659688805
variable C6neg equal ${d6}
variable C6neg equal -5.47753447279046

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4861 14.0699 16.771) with tilt (-7.3915 0.9919 1.0308)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.771
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 ${delta} remap x units box
fix deform_p all deform 100 z delta 0 0.16771 remap x units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 3
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 101.9 | 102.4 | 102.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.89476     -32157.481     -5771.6471      0              3654.1976    
       100   292.13399     -32162.98       2595.0633     -1388.9379      3656.0247    
       200   294.55026     -32156.207     -13132.864     -5776.2898      3657.8518    
       300   331.80621     -32174.073     -5366.4296     -465.60431      3659.6789    
       400   299.69942     -32149.408     -2372.6635     -6674.7391      3661.506     
       500   325.3675      -32158.763     -2235.8561     -947.36257      3663.3331    
       600   298.87394     -32138.6       -16876.916     -5828.1767      3665.1602    
       700   327.03091     -32160.051     -3601.4986      994.83334      3666.9873    
       800   292.96919     -32130.077     -3955.482      -4906.0394      3668.8144    
       900   294.98099     -32126.588     -5192.913      -3125.359       3670.6415    
      1000   297.17716     -32142.212     -2863.2997      2937.2828      3672.4686    
      1100   302.63869     -32150.429     -4371.7019     -1311.9241      3674.2957    
      1200   319.90497     -32169.253     -2879.0701     -6963.1077      3676.1228    
      1300   305.7252      -32165.011     -7834.1583     -5414.48        3677.9499    
      1400   282.99615     -32159.457     -8323.4817     -7051.3429      3679.777     
      1500   303.27782     -32170.58      -7779.7354     -4590.3733      3681.6041    
      1600   282.33751     -32185.707     -6605.7695     -4400.3082      3683.4312    
      1700   281.89072     -32165.021     -9643.5221     -6329.1026      3685.2583    
      1800   296.53464     -32175.127      1991.8278     -3089.9788      3687.0854    
      1900   272.18934     -32159.481     -1174.282      -338.00009      3688.9125    
      2000   275.55456     -32170.605     -11259.54      -2702.2506      3690.7396    
Loop time of 73.8791 on 16 procs for 2000 steps with 274 atoms

Performance: 1.169 ns/day, 20.522 hours/ns, 27.071 timesteps/s, 7.418 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.458     | 52.965     | 54.655     |  16.1 | 71.69
Bond    | 0.00065512 | 0.00079914 | 0.00096298 |   0.0 |  0.00
Neigh   | 4.2845     | 4.3998     | 4.4691     |   2.6 |  5.96
Comm    | 5.5516     | 7.171      | 8.7006     |  43.3 |  9.71
Output  | 0.0059995  | 0.010511   | 0.013856   |   3.4 |  0.01
Modify  | 8.8731     | 8.9876     | 9.1446     |   2.9 | 12.17
Other   |            | 0.3443     |            |       |  0.47

Nlocal:          34.25 ave          41 max          29 min
Histogram: 1 0 2 1 0 3 0 0 0 1
Nghost:        2600.62 ave        2619 max        2561 min
Histogram: 1 0 0 0 0 2 0 1 2 2
Neighs:          17795 ave       21238 max       15094 min
Histogram: 1 0 2 1 1 2 0 0 0 1

Total # of neighbors = 142360
Ave neighs/atom = 519.56204
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 54.9341333930772
variable C2pos equal ${d2}
variable C2pos equal 107.294234258776
variable C3pos equal ${d3}
variable C3pos equal 107.269301523243
variable C4pos equal ${d4}
variable C4pos equal -7.31731344463375
variable C5pos equal ${d5}
variable C5pos equal -10.9063997864867
variable C6pos equal ${d6}
variable C6pos equal -0.808987067632475

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(-13.1776529741949+${C1pos})
variable C13 equal 0.5*(-13.1776529741949+54.9341333930772)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(33.4211794698878+${C2pos})
variable C23 equal 0.5*(33.4211794698878+107.294234258776)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(-23.0314365601995+${C3pos})
variable C33 equal 0.5*(-23.0314365601995+107.269301523243)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-4.88851584496169+${C4pos})
variable C43 equal 0.5*(-4.88851584496169+-7.31731344463375)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(23.9356659688805+${C5pos})
variable C53 equal 0.5*(23.9356659688805+-10.9063997864867)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-5.47753447279046+${C6pos})
variable C63 equal 0.5*(-5.47753447279046+-0.808987067632475)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.771
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4861 14.0699 16.771) with tilt (-7.3915 0.9919 1.0308)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.771
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta ${delta} remap x units box
fix deform_n all deform 100 yz delta -0.16771 remap x units box
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 101.9 | 102.4 | 102.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.89476     -32157.481     -5771.6471      0              3654.1976    
       100   292.13399     -32162.98       2596.3608     -1388.6538      3654.1976    
       200   294.65413     -32155.918     -12547.141     -5622.1406      3654.1976    
       300   313.29025     -32158.527     -3430.6978     -33.836713      3654.1976    
       400   300.64229     -32158.538     -8412.6278     -7665.2632      3654.1976    
       500   327.08571     -32147.442     -6391.0352     -5920.5874      3654.1976    
       600   294.12206     -32156.353      1516.135      -1855.6848      3654.1976    
       700   316.9717      -32135.247     -6207.0597     -978.38416      3654.1976    
       800   290.95698     -32145.305     -16202.47      -7211.1654      3654.1976    
       900   294.63858     -32155.346     -15447.308     -6075.894       3654.1976    
      1000   298.16275     -32148.227     -9621.4448     -2403.0383      3654.1976    
      1100   314.82402     -32162.875     -3087.27       -1231.5528      3654.1976    
      1200   311.37672     -32154.706      3849.1698     -4912.3377      3654.1976    
      1300   311.9567      -32170.225     -10939.678     -4668.4147      3654.1976    
      1400   316.28696     -32171.771     -4311.966      -4804.5836      3654.1976    
      1500   291.74097     -32159.056      3395.1293     -1625.7263      3654.1976    
      1600   283.01559     -32157.297     -7546.0209     -3467.5863      3654.1976    
      1700   294.20563     -32166.901     -941.12247     -2797.5202      3654.1976    
      1800   320.74591     -32177.098     -5336.6022     -2070.8266      3654.1976    
      1900   280.27374     -32187.214      6450.886      -3709.3591      3654.1976    
      2000   290.78705     -32147.834     -2638.1463     -34.921609      3654.1976    
Loop time of 73.914 on 16 procs for 2000 steps with 274 atoms

Performance: 1.169 ns/day, 20.532 hours/ns, 27.058 timesteps/s, 7.414 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 50.855     | 53.378     | 55.458     |  16.2 | 72.22
Bond    | 0.00068665 | 0.00081065 | 0.00096324 |   0.0 |  0.00
Neigh   | 4.319      | 4.3879     | 4.4553     |   2.2 |  5.94
Comm    | 4.8154     | 6.8611     | 9.3331     |  44.5 |  9.28
Output  | 0.007993   | 0.014669   | 0.021748   |   4.4 |  0.02
Modify  | 8.8417     | 8.97       | 9.0802     |   2.2 | 12.14
Other   |            | 0.3015     |            |       |  0.41

Nlocal:          34.25 ave          40 max          30 min
Histogram: 1 1 1 2 0 0 0 1 1 1
Nghost:        2581.38 ave        2591 max        2569 min
Histogram: 2 0 0 1 0 0 1 2 0 2
Neighs:        17964.2 ave       20862 max       15827 min
Histogram: 1 1 3 0 0 0 0 2 0 1

Total # of neighbors = 143714
Ave neighs/atom = 524.50365
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -27.9074219470433
variable C2neg equal ${d2}
variable C2neg equal -31.4271979243425
variable C3neg equal ${d3}
variable C3neg equal -17.248295157971
variable C4neg equal ${d4}
variable C4neg equal 2.39469071199704
variable C5neg equal ${d5}
variable C5neg equal -2.70521837464854
variable C6neg equal ${d6}
variable C6neg equal -0.388068472571497

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4861 14.0699 16.771) with tilt (-7.3915 0.9919 1.0308)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.771
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta ${delta} remap x units box
fix deform_p all deform 100 yz delta 0.16771 remap x units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 4
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 101.9 | 102.4 | 102.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.89476     -32157.481     -5771.6471      0              3654.1976    
       100   292.13399     -32162.98       2596.3608     -1388.6538      3654.1976    
       200   294.17707     -32156.338     -12540.098     -5654.6195      3654.1976    
       300   315.78974     -32160.746     -4653.9289     -606.15126      3654.1976    
       400   292.44644     -32159.055     -7758.3194     -7261.2494      3654.1976    
       500   287.58373     -32134.992     -7513.8377     -4555.6597      3654.1976    
       600   291.37848     -32153.941     -6571.7547     -4363.016       3654.1976    
       700   278.64055     -32159.174     -15094.028     -2809.0025      3654.1976    
       800   285.54657     -32164.172     -2169.1504     -3260.236       3654.1976    
       900   333.92338     -32152.354     -4846.1135     -6949.7528      3654.1976    
      1000   335.95255     -32158.574      6925.2679     -4292.9075      3654.1976    
      1100   286.4223      -32148.989      215.22224     -1391.6642      3654.1976    
      1200   273.30509     -32150.38       2300.2861     -2530.9063      3654.1976    
      1300   313.15238     -32171.656     -7160.6985     -2977.508       3654.1976    
      1400   329.63734     -32170.578     -4280.2288     -1134.4803      3654.1976    
      1500   322.90927     -32136.619     -3095.0328      1732.9006      3654.1976    
      1600   309.00871     -32170.932     -6100.3678     -6337.4092      3654.1976    
      1700   310.11937     -32156.017     -5783.7836     -1651.2397      3654.1976    
      1800   307.44835     -32150.434      1103.3322     -1777.3273      3654.1976    
      1900   293.47245     -32151.632      3739.7997     -4574.6104      3654.1976    
      2000   312.41241     -32176.604     -635.63607      273.16274      3654.1976    
Loop time of 74.462 on 16 procs for 2000 steps with 274 atoms

Performance: 1.160 ns/day, 20.684 hours/ns, 26.859 timesteps/s, 7.359 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.805     | 53.292     | 54.562     |  14.2 | 71.57
Bond    | 0.00063599 | 0.00080045 | 0.00096799 |   0.0 |  0.00
Neigh   | 4.3733     | 4.4131     | 4.4776     |   1.5 |  5.93
Comm    | 5.8864     | 7.1809     | 8.6923     |  38.7 |  9.64
Output  | 0.0053177  | 0.0099118  | 0.014259   |   3.6 |  0.01
Modify  | 9.0603     | 9.1874     | 9.3015     |   2.7 | 12.34
Other   |            | 0.378      |            |       |  0.51

Nlocal:          34.25 ave          38 max          31 min
Histogram: 1 2 1 0 1 0 0 0 2 1
Nghost:        2578.25 ave        2603 max        2547 min
Histogram: 1 0 1 0 0 1 3 1 0 1
Neighs:        17998.8 ave       19839 max       16375 min
Histogram: 1 2 1 0 1 0 0 0 2 1

Total # of neighbors = 143990
Ave neighs/atom = 525.51095
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 24.7857572997975
variable C2pos equal ${d2}
variable C2pos equal 14.6863747241556
variable C3pos equal ${d3}
variable C3pos equal 79.5941181377575
variable C4pos equal ${d4}
variable C4pos equal 2.40879073736174
variable C5pos equal ${d5}
variable C5pos equal -16.3854073723342
variable C6pos equal ${d6}
variable C6pos equal -0.323377525927287

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-27.9074219470433+${C1pos})
variable C14 equal 0.5*(-27.9074219470433+24.7857572997975)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(-31.4271979243425+${C2pos})
variable C24 equal 0.5*(-31.4271979243425+14.6863747241556)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-17.248295157971+${C3pos})
variable C34 equal 0.5*(-17.248295157971+79.5941181377575)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(2.39469071199704+${C4pos})
variable C44 equal 0.5*(2.39469071199704+2.40879073736174)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-2.70521837464854+${C5pos})
variable C54 equal 0.5*(-2.70521837464854+-16.3854073723342)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-0.388068472571497+${C6pos})
variable C64 equal 0.5*(-0.388068472571497+-0.323377525927287)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.771
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4861 14.0699 16.771) with tilt (-7.3915 0.9919 1.0308)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.771
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta ${delta} remap x units box
fix deform_n all deform 100 xz delta -0.16771 remap x units box
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 101.9 | 102.4 | 102.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.89476     -32157.481     -5771.6471      0              3654.1976    
       100   292.13399     -32162.98       2596.3608     -1388.6538      3654.1976    
       200   294.27562     -32156.1       -12308.286     -5652.3188      3654.1976    
       300   315.34734     -32160.344     -4429.9038     -289.06121      3654.1976    
       400   287.25542     -32143.865     -9792.2447     -3817.6918      3654.1976    
       500   313.73609     -32148.72      -3101.0311     -6509.188       3654.1976    
       600   295.29315     -32156.896     -577.191        1988.2844      3654.1976    
       700   285.03648     -32159.379     -6079.2022      1618.5834      3654.1976    
       800   305.99307     -32159.663     -12919.089     -3766.4754      3654.1976    
       900   313.12455     -32147.186     -5913.9183     -4015.4554      3654.1976    
      1000   315.77107     -32152.851     -87.14587       2062.5931      3654.1976    
      1100   282.37069     -32155.46      -7353.1386     -872.15254      3654.1976    
      1200   324.06023     -32168.936     -7626.2433     -2470.3951      3654.1976    
      1300   316.05323     -32172.912     -166.40368     -3241.4936      3654.1976    
      1400   293.3603      -32192.38      -4998.3831      3306.7667      3654.1976    
      1500   280.50773     -32174.605     -6845.6341      836.6268       3654.1976    
      1600   286.5361      -32152.013     -8959.2058     -4372.3962      3654.1976    
      1700   317.70387     -32176.982      713.39212     -3721.6793      3654.1976    
      1800   303.95109     -32172.359     -6211.237      -9043.4845      3654.1976    
      1900   327.64451     -32190.722     -6506.27       -2550.9836      3654.1976    
      2000   309.7095      -32165.992     -367.36315     -7035.3104      3654.1976    
Loop time of 74.4655 on 16 procs for 2000 steps with 274 atoms

Performance: 1.160 ns/day, 20.685 hours/ns, 26.858 timesteps/s, 7.359 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.758     | 53.855     | 55.555     |  16.8 | 72.32
Bond    | 0.00067557 | 0.00083198 | 0.00099544 |   0.0 |  0.00
Neigh   | 4.3751     | 4.4331     | 4.4859     |   1.6 |  5.95
Comm    | 5.1108     | 6.7956     | 8.8792     |  47.2 |  9.13
Output  | 0.0057126  | 0.01054    | 0.014714   |   3.3 |  0.01
Modify  | 8.9759     | 9.0595     | 9.1406     |   1.7 | 12.17
Other   |            | 0.3113     |            |       |  0.42

Nlocal:          34.25 ave          42 max          28 min
Histogram: 2 0 1 0 1 1 2 0 0 1
Nghost:        2602.88 ave        2622 max        2581 min
Histogram: 1 1 1 0 1 1 0 0 0 3
Neighs:        17969.2 ave       21830 max       14858 min
Histogram: 2 0 0 1 1 1 2 0 0 1

Total # of neighbors = 143754
Ave neighs/atom = 524.64964
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -98.838861020289
variable C2neg equal ${d2}
variable C2neg equal -44.9615539871273
variable C3neg equal ${d3}
variable C3neg equal -88.3784588068635
variable C4neg equal ${d4}
variable C4neg equal -24.1032465211344
variable C5neg equal ${d5}
variable C5neg equal 17.9205875568967
variable C6neg equal ${d6}
variable C6neg equal 1.03020496097136

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4861 14.0699 16.771) with tilt (-7.3915 0.9919 1.0308)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.771
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta ${delta} remap x units box
fix deform_p all deform 100 xz delta 0.16771 remap x units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 5
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 101.9 | 102.4 | 102.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.89476     -32157.481     -5771.6471      0              3654.1976    
       100   292.13399     -32162.98       2596.3608     -1388.6538      3654.1976    
       200   294.55965     -32156.252     -12783.597     -5647.128       3654.1976    
       300   312.93459     -32157.256     -3341.9935     -215.16888      3654.1976    
       400   288.01486     -32137.935     -5214.0198     -7016.3048      3654.1976    
       500   320.22333     -32158.438      6105.5528     -4650.7494      3654.1976    
       600   254.86272     -32149.265      2882.1348      2776.2124      3654.1976    
       700   297.53612     -32155.841     -8049.9475      121.88129      3654.1976    
       800   286.07756     -32136.002      289.53921      1700.5966      3654.1976    
       900   307.56185     -32160.003     -7115.8476     -2502.0561      3654.1976    
      1000   306.56302     -32164.555      4048.4523     -44.722013      3654.1976    
      1100   301.02561     -32145.446      1922.8646      3778.4143      3654.1976    
      1200   294.24104     -32153.975     -8098.3297      1724.5075      3654.1976    
      1300   319.55017     -32178.498     -5801.5349     -2287.9708      3654.1976    
      1400   310.64515     -32148.657      6385.3932     -2935.4023      3654.1976    
      1500   326.11407     -32171.879      2276.2304     -258.24792      3654.1976    
      1600   298.75535     -32151.175      6375.7901      21.462129      3654.1976    
      1700   317.58615     -32169.107     -6832.2702     -1470.1182      3654.1976    
      1800   295.20261     -32145.682      3624.8933     -872.73828      3654.1976    
      1900   306.54764     -32158.952     -9517.7958     -4003.4452      3654.1976    
      2000   311.67815     -32153.552      6081.1825      76.103277      3654.1976    
Loop time of 74.2164 on 16 procs for 2000 steps with 274 atoms

Performance: 1.164 ns/day, 20.616 hours/ns, 26.948 timesteps/s, 7.384 katom-step/s
98.7% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.582     | 53.196     | 54.581     |  14.2 | 71.68
Bond    | 0.00066904 | 0.00082506 | 0.00096653 |   0.0 |  0.00
Neigh   | 4.2031     | 4.2931     | 4.3786     |   2.7 |  5.78
Comm    | 5.8551     | 7.2064     | 8.8795     |  39.0 |  9.71
Output  | 0.0061163  | 0.0088122  | 0.011573   |   2.2 |  0.01
Modify  | 8.9889     | 9.1428     | 9.2533     |   2.5 | 12.32
Other   |            | 0.3682     |            |       |  0.50

Nlocal:          34.25 ave          38 max          28 min
Histogram: 1 0 1 0 0 0 1 2 0 3
Nghost:        2588.62 ave        2625 max        2547 min
Histogram: 1 1 0 1 1 0 0 3 0 1
Neighs:        17969.1 ave       19846 max       14799 min
Histogram: 1 0 1 0 0 0 2 1 1 2

Total # of neighbors = 143753
Ave neighs/atom = 524.64599
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 26.7824622878885
variable C2pos equal ${d2}
variable C2pos equal -8.20604662891427
variable C3pos equal ${d3}
variable C3pos equal 29.8491706106359
variable C4pos equal ${d4}
variable C4pos equal -9.1338920161823
variable C5pos equal ${d5}
variable C5pos equal 0.965986870505717
variable C6pos equal ${d6}
variable C6pos equal 11.3293378624502

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-98.838861020289+${C1pos})
variable C15 equal 0.5*(-98.838861020289+26.7824622878885)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-44.9615539871273+${C2pos})
variable C25 equal 0.5*(-44.9615539871273+-8.20604662891427)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-88.3784588068635+${C3pos})
variable C35 equal 0.5*(-88.3784588068635+29.8491706106359)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-24.1032465211344+${C4pos})
variable C45 equal 0.5*(-24.1032465211344+-9.1338920161823)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(17.9205875568967+${C5pos})
variable C55 equal 0.5*(17.9205875568967+0.965986870505717)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(1.03020496097136+${C6pos})
variable C65 equal 0.5*(1.03020496097136+11.3293378624502)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp

# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 14.0699

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4861 14.0699 16.771) with tilt (-7.3915 0.9919 1.0308)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.0699
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_n all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta ${delta} remap x units box
fix deform_n all deform 100 xy delta -0.140699 remap x units box

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 101.9 | 102.4 | 102.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.89476     -32157.481     -5771.6471      0              3654.1976    
       100   292.13399     -32162.98       2596.3608     -1388.6538      3654.1976    
       200   294.43186     -32156.167     -12360.72      -5645.1029      3654.1976    
       300   314.40596     -32159.154     -4280.9876     -184.36581      3654.1976    
       400   284.7645      -32140.965     -10000.589     -5897.6163      3654.1976    
       500   289.18555     -32145.159      849.7911      -4171.3057      3654.1976    
       600   292.47835     -32155.768     -11780.303     -4432.2931      3654.1976    
       700   316.61317     -32169.271     -14826.234      671.89878      3654.1976    
       800   303.23837     -32138.524     -19356.8       -6255.2913      3654.1976    
       900   311.29572     -32161.954     -7826.9741      745.38047      3654.1976    
      1000   280.92526     -32143.883      1330.8286      2553.3917      3654.1976    
      1100   309.12132     -32151.165     -2612.5998     -1431.4523      3654.1976    
      1200   319.81824     -32148.788     -3118.4924     -2517.039       3654.1976    
      1300   300.74305     -32157.639     -6079.2544     -1999.8004      3654.1976    
      1400   281.76281     -32155.865     -3364.7747     -1199.5335      3654.1976    
      1500   283.11229     -32151.822     -13316.288     -1259.5053      3654.1976    
      1600   313.56243     -32153.023      1089.9513      896.05345      3654.1976    
      1700   295.33603     -32139.855     -2752.9838      259.45236      3654.1976    
      1800   311.85589     -32159.33      -16287.857      753.28092      3654.1976    
      1900   308.64815     -32152.562      1732.9939      2032.0952      3654.1976    
      2000   284.26474     -32156.459      6651.5508      600.37543      3654.1976    
Loop time of 74.315 on 16 procs for 2000 steps with 274 atoms

Performance: 1.163 ns/day, 20.643 hours/ns, 26.912 timesteps/s, 7.374 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.197     | 53.226     | 55.82      |  18.2 | 71.62
Bond    | 0.00068001 | 0.0008468  | 0.00098827 |   0.0 |  0.00
Neigh   | 4.2778     | 4.3555     | 4.4505     |   2.9 |  5.86
Comm    | 4.7345     | 7.2961     | 9.3471     |  48.7 |  9.82
Output  | 0.0059727  | 0.010389   | 0.016455   |   3.5 |  0.01
Modify  | 8.926      | 9.0624     | 9.179      |   2.5 | 12.19
Other   |            | 0.3636     |            |       |  0.49

Nlocal:          34.25 ave          40 max          29 min
Histogram: 2 0 1 1 0 1 0 1 0 2
Nghost:        2586.88 ave        2601 max        2565 min
Histogram: 1 0 1 0 0 2 1 0 1 2
Neighs:        17997.8 ave       20861 max       15359 min
Histogram: 2 0 1 1 0 1 0 1 0 2

Total # of neighbors = 143982
Ave neighs/atom = 525.48175
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_n

# Obtain new stress tensor Negative deformation
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -21.4702746938822
variable C2neg equal ${d2}
variable C2neg equal -42.340975443301
variable C3neg equal ${d3}
variable C3neg equal -78.292543626835
variable C4neg equal ${d4}
variable C4neg equal 6.92899864497292
variable C5neg equal ${d5}
variable C5neg equal -5.95732270378123
variable C6neg equal ${d6}
variable C6neg equal -1.2747360151027

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4861 14.0699 16.771) with tilt (-7.3915 0.9919 1.0308)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.0699
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap x units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap x units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap x units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap x units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap x units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta ${delta} remap x units box
fix deform_p all deform 100 xy delta 0.140699 remap x units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# equilibration
fix 4 all nve
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 50 ${seed}
fix 5 all langevin 300 300 50 123457

# save trajectory
if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
variable dir1 equal ${dir}
variable dir1 equal 6
run ${nrun}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 101.9 | 102.4 | 102.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.89476     -32157.481     -5771.6471      0              3654.1976    
       100   292.13399     -32162.98       2596.3608     -1388.6538      3654.1976    
       200   294.47691     -32156.108     -12737.643     -5668.2388      3654.1976    
       300   313.95539     -32159.228     -3697.2528     -381.64442      3654.1976    
       400   291.23567     -32153.112     -11617.939     -7785.8446      3654.1976    
       500   309.07943     -32145.717     -1798.8976     -9740.0324      3654.1976    
       600   290.01331     -32157.539      2329.804       3985.0083      3654.1976    
       700   316.40193     -32143.642     -6932.3693      461.16281      3654.1976    
       800   291.41816     -32160.467     -2824.6142     -344.17577      3654.1976    
       900   288.22671     -32147.283     -18710.144     -6337.3367      3654.1976    
      1000   297.69588     -32166.008      4744.9201     -92.665352      3654.1976    
      1100   311.54907     -32148.358     -4657.1023     -2750.8001      3654.1976    
      1200   321.72039     -32158.179     -3571.9682      1211.9224      3654.1976    
      1300   301.47093     -32158.664      6467.4424     -4962.7582      3654.1976    
      1400   298.66378     -32184.606     -7171.6078     -1645.321       3654.1976    
      1500   310.98794     -32168.515     -3807.2332      653.63556      3654.1976    
      1600   298.5277      -32152.75      -8340.7615     -4572.4466      3654.1976    
      1700   305.08397     -32182.734      4979.5998     -4873.8051      3654.1976    
      1800   289.17013     -32161.187     -1409.9984      3165.796       3654.1976    
      1900   285.965       -32175.221     -5712.2674     -3852.591       3654.1976    
      2000   308.38845     -32186.593      3451.2103      5271.0062      3654.1976    
Loop time of 74.6001 on 16 procs for 2000 steps with 274 atoms

Performance: 1.158 ns/day, 20.722 hours/ns, 26.810 timesteps/s, 7.346 katom-step/s
98.7% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 52.006     | 53.741     | 56.012     |  16.7 | 72.04
Bond    | 0.00068461 | 0.00082452 | 0.00098021 |   0.0 |  0.00
Neigh   | 4.3904     | 4.4171     | 4.4697     |   1.1 |  5.92
Comm    | 4.708      | 6.9012     | 8.5873     |  45.9 |  9.25
Output  | 0.0055049  | 0.008997   | 0.013078   |   2.9 |  0.01
Modify  | 9.1101     | 9.1425     | 9.1811     |   0.8 | 12.26
Other   |            | 0.3882     |            |       |  0.52

Nlocal:          34.25 ave          39 max          29 min
Histogram: 2 0 0 1 1 0 1 0 0 3
Nghost:        2582.38 ave        2604 max        2556 min
Histogram: 1 0 3 0 0 0 0 1 0 3
Neighs:        17969.2 ave       20356 max       15341 min
Histogram: 2 0 0 1 1 1 0 0 1 2

Total # of neighbors = 143754
Ave neighs/atom = 524.64964
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
unfix deform_p

# Obtain new stress tensor
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -25.8548911970435
variable C2pos equal ${d2}
variable C2pos equal -24.6385588442204
variable C3pos equal ${d3}
variable C3pos equal 5.32552983288222
variable C4pos equal ${d4}
variable C4pos equal -3.17505611552709
variable C5pos equal ${d5}
variable C5pos equal -6.61707471299957
variable C6pos equal ${d6}
variable C6pos equal 17.0651930316012

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-21.4702746938822+${C1pos})
variable C16 equal 0.5*(-21.4702746938822+-25.8548911970435)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-42.340975443301+${C2pos})
variable C26 equal 0.5*(-42.340975443301+-24.6385588442204)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-78.292543626835+${C3pos})
variable C36 equal 0.5*(-78.292543626835+5.32552983288222)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(6.92899864497292+${C4pos})
variable C46 equal 0.5*(6.92899864497292+-3.17505611552709)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(-5.95732270378123+${C5pos})
variable C56 equal 0.5*(-5.95732270378123+-6.61707471299957)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(-1.2747360151027+${C6pos})
variable C66 equal 0.5*(-1.2747360151027+17.0651930316012)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 48.4418586834383
variable C22all equal ${C22}
variable C22all equal 24.0074853282507
variable C33all equal ${C33}
variable C33all equal 42.1189324815218

variable C44all equal ${C44}
variable C44all equal 2.40174072467939
variable C55all equal ${C55}
variable C55all equal 9.44328721370121
variable C66all equal ${C66}
variable C66all equal 7.89522850824925

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(17.2362331333632+${C21})
variable C12all equal 0.5*(17.2362331333632+26.2828789310372)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(20.8782402094411+${C31})
variable C13all equal 0.5*(20.8782402094411+-14.2966663035076)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(70.3577068643319+${C32})
variable C23all equal 0.5*(70.3577068643319+17.7610241956938)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-1.5608323236229+${C41})
variable C14all equal 0.5*(-1.5608323236229+5.94488812776707)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-36.0281993662003+${C51})
variable C15all equal 0.5*(-36.0281993662003+0.47468085884264)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-23.6625829454629+${C61})
variable C16all equal 0.5*(-23.6625829454629+-5.61578773558595)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-8.37041160009345+${C42})
variable C24all equal 0.5*(-8.37041160009345+5.27035277734416)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-26.5838003080208+${C52})
variable C25all equal 0.5*(-26.5838003080208+2.38463151603285)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-33.4897671437607+${C62})
variable C26all equal 0.5*(-33.4897671437607+-7.30803692493771)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(31.1729114898933+${C43})
variable C34all equal 0.5*(31.1729114898933+-6.10291464479772)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-29.2646440981138+${C53})
variable C35all equal 0.5*(-29.2646440981138+6.5146330911969)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-36.4835068969764+${C63})
variable C36all equal 0.5*(-36.4835068969764+-3.14326077021147)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-16.6185692686583+${C54})
variable C45all equal 0.5*(-16.6185692686583+-9.54531287349137)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(1.87697126472292+${C64})
variable C46all equal 0.5*(1.87697126472292+-0.355722999249392)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-6.2871987083904+${C65})
variable C56all equal 0.5*(-6.2871987083904+6.17977141171078)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by deform-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:16:06
