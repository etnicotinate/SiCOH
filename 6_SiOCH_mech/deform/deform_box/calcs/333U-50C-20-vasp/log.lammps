LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 30*${nthermo}       # steps of equilibration run 10
variable nequil equal 30*100       
variable nrun equal 30*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 30*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-20-vasp
read_data       ${structure}.data
read_data       333U-50C-20-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.006 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 5.73139e-05 on 8 procs for 1 steps with 350 atoms

61.3% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.118e-06  | 1.4234e-06 | 2.305e-06  |   0.0 |  2.48
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 5.378e-06  | 5.6309e-06 | 6.565e-06  |   0.0 |  9.82
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 5.026e-05  |            |       | 87.69

Nlocal:          43.75 ave          50 max          39 min
Histogram: 2 0 1 0 2 0 2 0 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-20-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
run ${nequil}
run 3000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -10.66 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.2 | 123.4 | 124.7 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -39436.432      138394.29      1.7278661      3758.8201    
       100   727.72694     -40293.204     -25486.886      1.7278661      3758.8201    
       200   598.70825     -40608.063     -20042.47       1.7278661      3758.8201    
       300   448.08153     -40775.317     -8719.4702      1.7278661      3758.8201    
       400   368.07576     -40916.064      12042.815      1.7278661      3758.8201    
       500   323.74279     -41017.02       5264.1982      1.7278661      3758.8201    
       600   292.42643     -41079.333     -9613.6408      1.7278661      3758.8201    
       700   280.08727     -41117.333     -3802.0268      1.7278661      3758.8201    
       800   268.90731     -41110.232     -13437.613      1.7278661      3758.8201    
       900   319.17604     -41127.933     -3878.1757      1.7278661      3758.8201    
      1000   313.85132     -41097.112     -12021.215      1.7278661      3758.8201    
      1100   297.80969     -41081.579      591.86918      1.7278661      3758.8201    
      1200   306.37949     -41113.974     -11363.523      1.7278661      3758.8201    
      1300   289.63524     -41124.704     -20535.279      1.7278661      3758.8201    
      1400   304.07464     -41146.229     -7746.2702      1.7278661      3758.8201    
      1500   306.29072     -41133.388     -2623.9505      1.7278661      3758.8201    
      1600   311.25329     -41114.363     -13340.379      1.7278661      3758.8201    
      1700   332.68075     -41130.152     -10184.373      1.7278661      3758.8201    
      1800   314.58786     -41139.559     -8919.2577      1.7278661      3758.8201    
      1900   279.07015     -41133.25      -1530.5775      1.7278661      3758.8201    
      2000   280.41135     -41139.933     -9024.6146      1.7278661      3758.8201    
      2100   303.63133     -41142.077     -4542.2177      1.7278661      3758.8201    
      2200   317.77941     -41133.579     -10072.475      1.7278661      3758.8201    
      2300   306.53749     -41119.342      2072.9476      1.7278661      3758.8201    
      2400   305.02057     -41135.935     -1116.6651      1.7278661      3758.8201    
      2500   300.58531     -41152.233     -6429.0853      1.7278661      3758.8201    
      2600   286.38545     -41144.478      1213.3547      1.7278661      3758.8201    
      2700   288.34425     -41134.461     -7970.2447      1.7278661      3758.8201    
      2800   314.78606     -41141.832      107.37236      1.7278661      3758.8201    
      2900   303.64746     -41134.267     -2626.4138      1.7278661      3758.8201    
      3000   289.07373     -41130.871     -12463.225      1.7278661      3758.8201    
Loop time of 146.188 on 8 procs for 3000 steps with 350 atoms

Performance: 0.887 ns/day, 27.072 hours/ns, 20.521 timesteps/s, 7.183 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 100.91     | 116.59     | 122.38     |  60.7 | 79.76
Bond    | 0.0085005  | 0.0090647  | 0.0094626  |   0.3 |  0.01
Neigh   | 8.4439     | 9.4343     | 9.9019     |  14.3 |  6.45
Comm    | 2.132      | 7.9143     | 23.603     | 233.1 |  5.41
Output  | 0.001715   | 0.0018526  | 0.0027424  |   0.8 |  0.00
Modify  | 11.693     | 12.161     | 13.155     |  12.6 |  8.32
Other   |            | 0.0746     |            |       |  0.05

Nlocal:          43.75 ave          55 max          34 min
Histogram: 1 1 0 1 1 2 1 0 0 1
Nghost:        3165.38 ave        3218 max        3114 min
Histogram: 2 1 0 1 0 0 0 2 1 1
Neighs:        28504.1 ave       35381 max       22460 min
Histogram: 1 0 1 1 1 2 1 0 0 1

Total # of neighbors = 228033
Ave neighs/atom = 651.52286
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333U-50C-20-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.2382
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 14.5028
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.0085

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal -0.642
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal -0.4482
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -6.2627

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 15.2382
variable dlen equal lx-${len0}
variable dlen equal lx-15.2382
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.2382
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.2626999999999997115, deltaxy = 0.062627
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.4481999999999999873, deltaxz = 0.004482
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6420000000000000151, deltayz = 0.00642
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.152382 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.152382 xy delta 0.062627 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.152382 xy delta 0.062627 xz delta 0.004482 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 123.3 | 125.2 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.07373     -41130.871     -12463.228      1.7278661      3758.8201    
       100   300.42848     -41133.817     -5357.5356      1.7284423      3757.5672    
       200   315.68403     -41133.758     -1122.9418      1.7290188      3756.3142    
       300   289.00834     -41116.245     -12281.407      1.7295957      3755.0613    
       400   285.26987     -41137.494      988.89074      1.730173       3753.8083    
       500   279.87669     -41139.996     -8714.6221      1.7307507      3752.5554    
       600   289.09186     -41144.351      938.53552      1.7313288      3751.3025    
       700   294.93249     -41134.978     -881.53909      1.7319072      3750.0495    
       800   310.02757     -41130.448     -12683.767      1.7324861      3748.7966    
       900   311.33463     -41128.449     -6879.9173      1.7330653      3747.5436    
      1000   295.19911     -41132.865     -2712.8212      1.7336449      3746.2907    
      1100   299.98976     -41152.15       1197.9398      1.7342249      3745.0378    
      1200   283.09188     -41137.707     -14226.671      1.7348053      3743.7848    
      1300   289.80223     -41124.925      3513.8953      1.7353861      3742.5319    
      1400   319.07214     -41130.321     -1537.9515      1.7359673      3741.2789    
      1500   313.8253      -41131.13       6175.329       1.7365489      3740.026     
      1600   299.52375     -41144.891     -12001.152      1.7371308      3738.7731    
      1700   280.57315     -41141.602     -8888.7769      1.7377132      3737.5201    
      1800   310.1491      -41169.494     -2632.3304      1.7382959      3736.2672    
      1900   310.7035      -41156.704     -4833.8861      1.738879       3735.0142    
      2000   311.89925     -41146.294     -8828.3656      1.7394625      3733.7613    
      2100   315.15244     -41164.199     -7564.6974      1.7400464      3732.5084    
      2200   290.33608     -41171.151     -3514.7613      1.7406307      3731.2554    
      2300   287.5556      -41172.977     -4864.8178      1.7412154      3730.0025    
      2400   301.56101     -41174.994     -10138.01       1.7418005      3728.7495    
      2500   320.70977     -41173.167     -9192.0478      1.742386       3727.4966    
      2600   301.67258     -41139.327     -9939.3412      1.7429719      3726.2437    
      2700   309.89679     -41141.74      -1525.7733      1.7435581      3724.9907    
      2800   311.36869     -41167.096     -1337.2415      1.7441448      3723.7378    
      2900   314.90455     -41196.452      2844.8599      1.7447319      3722.4848    
      3000   290.79438     -41179.036     -4315.879       1.7453193      3721.2319    
Loop time of 148.284 on 8 procs for 3000 steps with 350 atoms

Performance: 0.874 ns/day, 27.460 hours/ns, 20.231 timesteps/s, 7.081 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.561     | 117.79     | 124.68     | 109.7 | 79.44
Bond    | 0.008484   | 0.0089803  | 0.0095427  |   0.3 |  0.01
Neigh   | 7.0738     | 9.4236     | 9.9784     |  29.3 |  6.36
Comm    | 1.6587     | 8.5581     | 39.789     | 406.9 |  5.77
Output  | 0.0092174  | 0.010732   | 0.011853   |   0.9 |  0.01
Modify  | 11.863     | 12.415     | 14.772     |  25.6 |  8.37
Other   |            | 0.07738    |            |       |  0.05

Nlocal:          43.75 ave          52 max          34 min
Histogram: 1 0 1 1 0 1 2 0 1 1
Nghost:        3191.25 ave        3255 max        3133 min
Histogram: 2 0 1 0 1 1 1 0 1 1
Neighs:          28780 ave       33743 max       22735 min
Histogram: 1 0 1 1 0 1 2 0 1 1

Total # of neighbors = 230240
Ave neighs/atom = 657.82857
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.2382
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.152382 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.152382 xy delta -0.062627 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.152382 xy delta -0.062627 xz delta -0.004482 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 123.3 | 125.2 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.07373     -41130.871     -12463.228      1.7278661      3758.8201    
       100   300.34688     -41133.822     -5340.2308      1.7272904      3760.073     
       200   316.33009     -41133.291     -1161.2468      1.726715       3761.326     
       300   290.16995     -41116.518     -12986.25       1.72614        3762.5789    
       400   293.61906     -41148.622     -14022.964      1.7255654      3763.8319    
       500   288.03675     -41155.266     -16299.508      1.7249911      3765.0848    
       600   290.14662     -41148.933      7620.3273      1.7244173      3766.3377    
       700   304.82753     -41141.079     -3581.9555      1.7238438      3767.5907    
       800   328.61947     -41142.776     -15431.276      1.7232707      3768.8436    
       900   311.11422     -41128.734     -15392.475      1.722698       3770.0966    
      1000   303.63595     -41144.694     -6252.1039      1.7221257      3771.3495    
      1100   290.54098     -41143.342     -3277.5993      1.7215538      3772.6024    
      1200   296.3566      -41139.274     -9448.0412      1.7209822      3773.8554    
      1300   301.31483     -41128.006     -20986.193      1.720411       3775.1083    
      1400   312.97009     -41125.409     -6668.1463      1.7198402      3776.3613    
      1500   303.72861     -41111.283     -18241.826      1.7192698      3777.6142    
      1600   303.53301     -41120.209     -11283.694      1.7186997      3778.8671    
      1700   284.01914     -41116.775     -17858.993      1.7181301      3780.1201    
      1800   307.28606     -41155.657     -2231.5427      1.7175608      3781.373     
      1900   292.23672     -41148.683     -14772.807      1.7169918      3782.626     
      2000   290.82499     -41139.02      -15988.579      1.7164233      3783.8789    
      2100   315.25264     -41130.286     -14497.419      1.7158551      3785.1318    
      2200   303.75715     -41116.083     -942.23662      1.7152873      3786.3848    
      2300   316.73558     -41151.689     -8780.9889      1.7147199      3787.6377    
      2400   302.02207     -41154.104     -16320.098      1.7141529      3788.8907    
      2500   312.18217     -41169.972     -8810.4071      1.7135862      3790.1436    
      2600   289.77316     -41165.069     -13983.773      1.7130199      3791.3966    
      2700   278.05474     -41168.818     -30259.41       1.712454       3792.6495    
      2800   278.32639     -41164.398     -14276.272      1.7118885      3793.9024    
      2900   295.70071     -41170.853     -25996.208      1.7113233      3795.1554    
      3000   294.23687     -41167.965     -4074.717       1.7107585      3796.4083    
Loop time of 149.216 on 8 procs for 3000 steps with 350 atoms

Performance: 0.869 ns/day, 27.633 hours/ns, 20.105 timesteps/s, 7.037 katom-step/s
98.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 96.113     | 116.81     | 122.83     |  77.5 | 78.28
Bond    | 0.0086967  | 0.0089     | 0.0092606  |   0.2 |  0.01
Neigh   | 7.8108     | 9.4225     | 9.942      |  21.7 |  6.31
Comm    | 3.5141     | 9.5394     | 30.261     | 271.8 |  6.39
Output  | 0.009577   | 0.011049   | 0.012112   |   0.9 |  0.01
Modify  | 12.731     | 13.343     | 14.937     |  18.0 |  8.94
Other   |            | 0.07936    |            |       |  0.05

Nlocal:          43.75 ave          52 max          38 min
Histogram: 2 0 2 0 1 1 0 1 0 1
Nghost:        3150.62 ave        3208 max        3095 min
Histogram: 1 1 1 0 0 2 1 0 1 1
Neighs:        28234.1 ave       33209 max       24806 min
Histogram: 2 0 2 0 2 0 0 1 0 1

Total # of neighbors = 225873
Ave neighs/atom = 645.35143
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 14.5028
variable dlen equal ly-${len0}
variable dlen equal ly-14.5028
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.5028
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.2626999999999997115, deltaxy = 0.062627
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.4481999999999999873, deltaxz = 0.004482
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6420000000000000151, deltayz = 0.00642
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.145028 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.145028 yz delta 0.00642 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 123.3 | 125.2 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.07373     -41130.871     -12463.228      1.7278661      3758.8201    
       100   300.40105     -41133.834     -5329.5316      1.7284423      3757.5672    
       200   315.44525     -41132.605     -370.15895      1.7290188      3756.3142    
       300   286.97495     -41114.927     -12821.149      1.7295957      3755.0613    
       400   288.54372     -41144.025     -12215.496      1.730173       3753.8083    
       500   288.33473     -41155.657     -4761.1721      1.7307507      3752.5554    
       600   286.66616     -41147.285      4882.5571      1.7313288      3751.3025    
       700   289.95863     -41128.505     -9418.1291      1.7319072      3750.0495    
       800   319.07153     -41134.471     -9132.2234      1.7324861      3748.7966    
       900   308.77552     -41123.943     -2730.0173      1.7330653      3747.5436    
      1000   296.37483     -41130.561     -18019.322      1.7336449      3746.2907    
      1100   273.27991     -41127.396     -15403.962      1.7342249      3745.0378    
      1200   277.74703     -41132.52      -814.69661      1.7348053      3743.7848    
      1300   301.8118      -41138.746      3480.9209      1.7353861      3742.5319    
      1400   325.92072     -41153.657      8410.2039      1.7359673      3741.2789    
      1500   294.65777     -41129.156      5726.0969      1.7365489      3740.026     
      1600   283.79497     -41138.337     -19196.881      1.7371308      3738.7731    
      1700   280.4873      -41142.057     -20001.17       1.7377132      3737.5201    
      1800   286.48738     -41137.697     -4296.7832      1.7382959      3736.2672    
      1900   325.07339     -41169.343      12796.894      1.738879       3735.0142    
      2000   312.02627     -41174.525     -1787.7377      1.7394625      3733.7613    
      2100   296.78896     -41185.049     -1661.019       1.7400464      3732.5084    
      2200   303.4879      -41191.659     -5656.9764      1.7406307      3731.2554    
      2300   309.84452     -41189.439     -5534.4474      1.7412154      3730.0025    
      2400   306.543       -41159.853      1286.4665      1.7418005      3728.7495    
      2500   311.14572     -41138.149     -6590.6649      1.742386       3727.4966    
      2600   321.19859     -41164.624     -15211.414      1.7429719      3726.2437    
      2700   302.32551     -41171.587     -8002.5932      1.7435581      3724.9907    
      2800   317.47944     -41189.878     -11573.382      1.7441448      3723.7378    
      2900   302.7503      -41190.768     -278.30731      1.7447319      3722.4848    
      3000   306.24958     -41213.788      2866.7447      1.7453193      3721.2319    
Loop time of 148.871 on 8 procs for 3000 steps with 350 atoms

Performance: 0.871 ns/day, 27.569 hours/ns, 20.152 timesteps/s, 7.053 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 95.087     | 118.7      | 124.83     |  84.0 | 79.73
Bond    | 0.0087998  | 0.0091605  | 0.0094899  |   0.3 |  0.01
Neigh   | 7.6705     | 9.4828     | 9.9859     |  23.2 |  6.37
Comm    | 2.1625     | 8.2963     | 31.909     | 317.7 |  5.57
Output  | 0.010259   | 0.011997   | 0.013209   |   1.0 |  0.01
Modify  | 11.779     | 12.293     | 14.111     |  20.5 |  8.26
Other   |            | 0.07749    |            |       |  0.05

Nlocal:          43.75 ave          58 max          34 min
Histogram: 1 0 2 2 1 1 0 0 0 1
Nghost:        3209.75 ave        3273 max        3157 min
Histogram: 2 0 1 1 0 2 0 0 0 2
Neighs:        28773.2 ave       37522 max       22723 min
Histogram: 1 0 1 3 1 1 0 0 0 1

Total # of neighbors = 230186
Ave neighs/atom = 657.67429
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.5028
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.145028 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.145028 yz delta -0.00642 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 123.3 | 125.2 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.07373     -41130.871     -12463.228      1.7278661      3758.8201    
       100   300.36563     -41133.804     -5335.642       1.7272904      3760.073     
       200   316.437       -41133.924     -1678.4681      1.726715       3761.326     
       300   290.80981     -41116.367     -12144.143      1.72614        3762.5789    
       400   294.09459     -41148.255     -15144.327      1.7255654      3763.8319    
       500   271.34058     -41137.273     -1884.7649      1.7249911      3765.0848    
       600   296.38797     -41155.918      2658.7666      1.7244173      3766.3377    
       700   296.0718      -41135.342     -6416.8345      1.7238438      3767.5907    
       800   319.12566     -41136.822     -12025.533      1.7232707      3768.8436    
       900   311.95013     -41125.717     -8657.1881      1.722698       3770.0966    
      1000   286.75655     -41119.158      7045.3638      1.7221257      3771.3495    
      1100   297.13089     -41148.162     -17322.398      1.7215538      3772.6024    
      1200   290.17073     -41140.185     -5119.4084      1.7209822      3773.8554    
      1300   300.68971     -41124.992     -8739.9632      1.720411       3775.1083    
      1400   323.56033     -41130.088     -3201.0102      1.7198402      3776.3613    
      1500   309.49221     -41130.337     -10053.912      1.7192698      3777.6142    
      1600   299.89425     -41149.155     -4106.6164      1.7186997      3778.8671    
      1700   302.54661     -41165.986      6856.8691      1.7181301      3780.1201    
      1800   295.52778     -41147.182     -2250.5477      1.7175608      3781.373     
      1900   328.09963     -41157.804      3521.2075      1.7169918      3782.626     
      2000   301.4543      -41137.162     -16192.485      1.7164233      3783.8789    
      2100   291.40598     -41144.385     -23835.063      1.7158551      3785.1318    
      2200   289.21416     -41169.409     -15353.891      1.7152873      3786.3848    
      2300   288.17228     -41161.587     -16426.778      1.7147199      3787.6377    
      2400   296.80136     -41147.029     -14268.025      1.7141529      3788.8907    
      2500   329.18777     -41173.253     -7110.1375      1.7135862      3790.1436    
      2600   307.96248     -41153.449     -11462.072      1.7130199      3791.3966    
      2700   306.0047      -41156.972     -6614.4654      1.712454       3792.6495    
      2800   283.69991     -41145.298     -2191.4301      1.7118885      3793.9024    
      2900   275.26385     -41142.777     -11559.294      1.7113233      3795.1554    
      3000   288.34657     -41136.003     -13634.181      1.7107585      3796.4083    
Loop time of 145.373 on 8 procs for 3000 steps with 350 atoms

Performance: 0.891 ns/day, 26.921 hours/ns, 20.637 timesteps/s, 7.223 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.83      | 112.58     | 121.63     | 120.8 | 77.44
Bond    | 0.0082638  | 0.0088899  | 0.0095031  |   0.5 |  0.01
Neigh   | 6.9821     | 9.1033     | 9.8631     |  33.7 |  6.26
Comm    | 2.1361     | 11.189     | 36.94      | 383.2 |  7.70
Output  | 0.009407   | 0.010719   | 0.011823   |   0.8 |  0.01
Modify  | 11.635     | 12.402     | 14.532     |  28.9 |  8.53
Other   |            | 0.07709    |            |       |  0.05

Nlocal:          43.75 ave          55 max          38 min
Histogram: 3 1 1 0 1 0 0 1 0 1
Nghost:        3150.62 ave        3212 max        3100 min
Histogram: 2 1 0 1 0 1 1 0 0 2
Neighs:        28193.5 ave       34935 max       24385 min
Histogram: 2 1 1 1 1 0 0 1 0 1

Total # of neighbors = 225548
Ave neighs/atom = 644.42286
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.0085
variable dlen equal lz-${len0}
variable dlen equal lz-17.0085
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.0085
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.2626999999999997115, deltaxy = 0.062627
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.4481999999999999873, deltaxz = 0.004482
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6420000000000000151, deltayz = 0.00642
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -0.170085 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 123.3 | 125.2 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.07373     -41130.871     -12463.228      1.7278661      3758.8201    
       100   300.37493     -41133.804     -5333.3056      1.7284423      3757.5672    
       200   316.20271     -41134.377     -803.23426      1.7290188      3756.3142    
       300   286.37233     -41113.589     -10442.996      1.7295957      3755.0613    
       400   284.73498     -41139.063     -14712.322      1.730173       3753.8083    
       500   278.48633     -41145.454     -5444.1473      1.7307507      3752.5554    
       600   293.15481     -41157.575      2590.3097      1.7313288      3751.3025    
       700   277.81406     -41124.696     -12699.99       1.7319072      3750.0495    
       800   309.63512     -41128.468     -4010.1036      1.7324861      3748.7966    
       900   310.74677     -41122.22      -4781.6699      1.7330653      3747.5436    
      1000   292.87565     -41127.173     -5740.7519      1.7336449      3746.2907    
      1100   291.03348     -41143.706     -18258.843      1.7342249      3745.0378    
      1200   283.14488     -41142.563     -8411.0916      1.7348053      3743.7848    
      1300   301.53662     -41143.796      729.15391      1.7353861      3742.5319    
      1400   312.93622     -41131.355     -1290.9587      1.7359673      3741.2789    
      1500   316.84901     -41133.184      7122.3031      1.7365489      3740.026     
      1600   303.16994     -41140.858     -1256.8154      1.7371308      3738.7731    
      1700   292.24322     -41144.584     -4859.1821      1.7377132      3737.5201    
      1800   307.69903     -41160.221     -10533.099      1.7382959      3736.2672    
      1900   298.60198     -41140.764     -7377.5504      1.738879       3735.0142    
      2000   293.72966     -41134.444      1603.4978      1.7394625      3733.7613    
      2100   302.83653     -41151.827     -9649.7851      1.7400464      3732.5084    
      2200   266.72924     -41129.589     -14068.006      1.7406307      3731.2554    
      2300   301.68636     -41167.081      552.86644      1.7412154      3730.0025    
      2400   301.35457     -41151.988     -13934.524      1.7418005      3728.7495    
      2500   309.56996     -41130.338     -10900.683      1.742386       3727.4966    
      2600   320.85131     -41139.425     -3978.1416      1.7429719      3726.2437    
      2700   302.40034     -41142.283      10540.242      1.7435581      3724.9907    
      2800   285.4006      -41143.705     -6047.9442      1.7441448      3723.7378    
      2900   289.65106     -41149.765      2245.9517      1.7447319      3722.4848    
      3000   305.05206     -41158.884     -10252.69       1.7453193      3721.2319    
Loop time of 147.348 on 8 procs for 3000 steps with 350 atoms

Performance: 0.880 ns/day, 27.287 hours/ns, 20.360 timesteps/s, 7.126 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 85.931     | 112.43     | 123.59     | 140.5 | 76.30
Bond    | 0.0081748  | 0.0088475  | 0.0096163  |   0.5 |  0.01
Neigh   | 7.0389     | 9.0581     | 10.22      |  39.3 |  6.15
Comm    | 1.8028     | 12.956     | 39.461     | 413.8 |  8.79
Output  | 0.0087143  | 0.010076   | 0.011249   |   0.9 |  0.01
Modify  | 11.644     | 12.809     | 14.832     |  33.1 |  8.69
Other   |            | 0.07335    |            |       |  0.05

Nlocal:          43.75 ave          52 max          36 min
Histogram: 2 0 0 1 1 0 2 0 1 1
Nghost:        3193.38 ave        3232 max        3153 min
Histogram: 2 1 1 0 0 0 0 1 1 2
Neighs:        28776.6 ave       33712 max       24044 min
Histogram: 2 0 0 1 1 0 2 1 0 1

Total # of neighbors = 230213
Ave neighs/atom = 657.75143
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.0085
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 0.170085 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 123.3 | 125.2 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.07373     -41130.871     -12463.228      1.7278661      3758.8201    
       100   300.38409     -41133.851     -5337.4886      1.7272904      3760.073     
       200   315.48231     -41132.549     -1494.0912      1.726715       3761.326     
       300   288.05545     -41114.382     -13636.092      1.72614        3762.5789    
       400   290.8658      -41145.286     -16815.555      1.7255654      3763.8319    
       500   281.41123     -41147.099     -5679.9474      1.7249911      3765.0848    
       600   293.38174     -41150.744      6992.254       1.7244173      3766.3377    
       700   293.11487     -41127.252     -6476.6633      1.7238438      3767.5907    
       800   310.33299     -41123.666     -4065.1275      1.7232707      3768.8436    
       900   307.87614     -41119.356     -13489.525      1.722698       3770.0966    
      1000   293.52303     -41125.92      -6868.5009      1.7221257      3771.3495    
      1100   300.74736     -41149.225     -9776.9358      1.7215538      3772.6024    
      1200   286.07306     -41132.4       -13013.479      1.7209822      3773.8554    
      1300   311.07322     -41140.595     -14316.389      1.720411       3775.1083    
      1400   316.29242     -41125.028     -11662.946      1.7198402      3776.3613    
      1500   310.3257      -41112.055     -5573.2361      1.7192698      3777.6142    
      1600   296.40893     -41108.547     -12069.878      1.7186997      3778.8671    
      1700   293.93        -41121.801     -10632.712      1.7181301      3780.1201    
      1800   290.21107     -41126.417     -9204.0733      1.7175608      3781.373     
      1900   302.36954     -41135.555     -925.43136      1.7169918      3782.626     
      2000   297.87095     -41122.721      6519.1012      1.7164233      3783.8789    
      2100   292.62962     -41097.7       -18292.089      1.7158551      3785.1318    
      2200   295.76511     -41083.476     -2018.7842      1.7152873      3786.3848    
      2300   313.69859     -41122.644     -21233.399      1.7147199      3787.6377    
      2400   310.87095     -41147.755     -10496.047      1.7141529      3788.8907    
      2500   296.2543      -41139.276     -3737.524       1.7135862      3790.1436    
      2600   314.81653     -41161.973     -15523.119      1.7130199      3791.3966    
      2700   308.90718     -41142.63      -31588.949      1.712454       3792.6495    
      2800   312.87933     -41134.021     -7044.9051      1.7118885      3793.9024    
      2900   307.59108     -41130.837     -1103.4424      1.7113233      3795.1554    
      3000   313.77886     -41160.639     -362.71876      1.7107585      3796.4083    
Loop time of 144.909 on 8 procs for 3000 steps with 350 atoms

Performance: 0.894 ns/day, 26.835 hours/ns, 20.703 timesteps/s, 7.246 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 84.255     | 111.22     | 121.7      | 142.2 | 76.75
Bond    | 0.0081303  | 0.0087135  | 0.0095588  |   0.5 |  0.01
Neigh   | 6.9878     | 8.964      | 9.7803     |  38.2 |  6.19
Comm    | 1.7321     | 12.213     | 39.181     | 429.3 |  8.43
Output  | 0.0088328  | 0.010244   | 0.011425   |   0.9 |  0.01
Modify  | 11.606     | 12.42      | 14.404     |  32.5 |  8.57
Other   |            | 0.07406    |            |       |  0.05

Nlocal:          43.75 ave          55 max          36 min
Histogram: 1 2 0 1 1 2 0 0 0 1
Nghost:        3154.25 ave        3187 max        3121 min
Histogram: 2 0 0 0 2 0 1 2 0 1
Neighs:        28206.9 ave       34965 max       23525 min
Histogram: 1 2 0 1 1 2 0 0 0 1

Total # of neighbors = 225655
Ave neighs/atom = 644.72857
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 15.2382
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz--0.642)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.2382
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.2626999999999997115, deltaxy = 0.062627
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.4481999999999999873, deltaxz = 0.004482
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6420000000000000151, deltayz = 0.00642
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -0.152382 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 123.3 | 125.2 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.07373     -41130.871     -12463.228      1.7278661      3758.8201    
       100   300.40656     -41133.839     -5326.834       1.7278661      3758.8201    
       200   315.08235     -41132.535     -1007.9965      1.7278661      3758.8201    
       300   286.89266     -41113.712     -12701.855      1.7278661      3758.8201    
       400   286.55045     -41141.271     -15028.828      1.7278661      3758.8201    
       500   280.2294      -41146.172     -13666.875      1.7278661      3758.8201    
       600   287.33105     -41146.516      5374.2086      1.7278661      3758.8201    
       700   294.11859     -41131.046     -4862.1274      1.7278661      3758.8201    
       800   315.29943     -41128.029     -7373.0414      1.7278661      3758.8201    
       900   324.50986     -41141.86      -12155.211      1.7278661      3758.8201    
      1000   301.56891     -41152.319      4163.0965      1.7278661      3758.8201    
      1100   286.71145     -41149.047     -3742.7378      1.7278661      3758.8201    
      1200   298.37023     -41151.623     -9502.3522      1.7278661      3758.8201    
      1300   307.22506     -41140.923     -3847.4431      1.7278661      3758.8201    
      1400   316.63235     -41130.543     -1448.4513      1.7278661      3758.8201    
      1500   296.79041     -41119.134     -14998.597      1.7278661      3758.8201    
      1600   285.32334     -41127.479     -8618.0142      1.7278661      3758.8201    
      1700   305.17654     -41156.958     -1875.6207      1.7278661      3758.8201    
      1800   279.5005      -41121.087     -11746.665      1.7278661      3758.8201    
      1900   309.35977     -41131.466     -18395.186      1.7278661      3758.8201    
      2000   312.81145     -41139.893     -12800.511      1.7278661      3758.8201    
      2100   301.68082     -41160.442     -7220.4502      1.7278661      3758.8201    
      2200   279.98391     -41150.283     -8993.1502      1.7278661      3758.8201    
      2300   292.47574     -41148.017     -1836.8         1.7278661      3758.8201    
      2400   310.15161     -41154.463     -14753.237      1.7278661      3758.8201    
      2500   311.19759     -41164.901     -9285.5502      1.7278661      3758.8201    
      2600   294.25917     -41157.468     -7106.918       1.7278661      3758.8201    
      2700   274.49706     -41163.741     -22858.426      1.7278661      3758.8201    
      2800   279.21746     -41181.342     -21203.56       1.7278661      3758.8201    
      2900   295.67871     -41167.993     -17240.247      1.7278661      3758.8201    
      3000   318.65858     -41172.283     -22814.645      1.7278661      3758.8201    
Loop time of 146.826 on 8 procs for 3000 steps with 350 atoms

Performance: 0.883 ns/day, 27.190 hours/ns, 20.432 timesteps/s, 7.151 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.05      | 112.54     | 122.98     | 131.7 | 76.65
Bond    | 0.0082521  | 0.0087724  | 0.0099742  |   0.6 |  0.01
Neigh   | 7.0878     | 9.096      | 10.077     |  36.5 |  6.20
Comm    | 2.1035     | 12.543     | 39.033     | 394.5 |  8.54
Output  | 0.0094228  | 0.010822   | 0.012082   |   0.9 |  0.01
Modify  | 11.569     | 12.555     | 14.568     |  31.2 |  8.55
Other   |            | 0.07393    |            |       |  0.05

Nlocal:          43.75 ave          55 max          37 min
Histogram: 2 0 2 1 0 2 0 0 0 1
Nghost:         3158.5 ave        3207 max        3114 min
Histogram: 2 1 1 0 0 0 0 2 0 2
Neighs:          28511 ave       35330 max       24421 min
Histogram: 2 1 1 0 1 2 0 0 0 1

Total # of neighbors = 228088
Ave neighs/atom = 651.68
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.2382
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 0.152382 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 123.3 | 125.2 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.07373     -41130.871     -12463.228      1.7278661      3758.8201    
       100   300.35306     -41133.817     -5347.5545      1.7278661      3758.8201    
       200   316.96727     -41134.911     -1635.2969      1.7278661      3758.8201    
       300   285.00063     -41111.232     -11909.035      1.7278661      3758.8201    
       400   285.23882     -41139.551     -12928.631      1.7278661      3758.8201    
       500   278.02629     -41145.136     -7822.3073      1.7278661      3758.8201    
       600   289.76041     -41151.439     -5840.4198      1.7278661      3758.8201    
       700   286.05796     -41128.669     -1380.044       1.7278661      3758.8201    
       800   313.6584      -41133.136     -7336.7224      1.7278661      3758.8201    
       900   318.027       -41136.069     -16293.545      1.7278661      3758.8201    
      1000   314.89291     -41161.641     -11723.772      1.7278661      3758.8201    
      1100   289.34774     -41158.092     -11517.494      1.7278661      3758.8201    
      1200   279.61697     -41153.958      1949.3224      1.7278661      3758.8201    
      1300   285.86526     -41136.589      716.94071      1.7278661      3758.8201    
      1400   293.71127     -41114.86      -4922.2423      1.7278661      3758.8201    
      1500   320.65254     -41132.319     -1305.5327      1.7278661      3758.8201    
      1600   300.61783     -41127.556     -19235.771      1.7278661      3758.8201    
      1700   308.02603     -41158.32      -18974.782      1.7278661      3758.8201    
      1800   289.95442     -41149.787     -6800.2469      1.7278661      3758.8201    
      1900   318.5353      -41184.289      8445.5757      1.7278661      3758.8201    
      2000   282.84484     -41161.498      14539.275      1.7278661      3758.8201    
      2100   259.04581     -41149.086     -16317.488      1.7278661      3758.8201    
      2200   304.3678      -41185.176     -11549.914      1.7278661      3758.8201    
      2300   288.72584     -41137.673     -4100.0303      1.7278661      3758.8201    
      2400   311.58346     -41152.116     -10157.31       1.7278661      3758.8201    
      2500   309.89707     -41166.745     -11150.611      1.7278661      3758.8201    
      2600   304.96068     -41174.678      531.74572      1.7278661      3758.8201    
      2700   302.82226     -41167.567     -13879.601      1.7278661      3758.8201    
      2800   293.69459     -41154.49      -3953.4855      1.7278661      3758.8201    
      2900   312.80847     -41158.936      5068.5668      1.7278661      3758.8201    
      3000   330.54575     -41148.208     -12498.536      1.7278661      3758.8201    
Loop time of 146.633 on 8 procs for 3000 steps with 350 atoms

Performance: 0.884 ns/day, 27.154 hours/ns, 20.459 timesteps/s, 7.161 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 84.223     | 113.62     | 122.11     | 111.3 | 77.49
Bond    | 0.0083729  | 0.0090354  | 0.0095508  |   0.4 |  0.01
Neigh   | 7.0632     | 9.1508     | 9.889      |  27.9 |  6.24
Comm    | 2.8072     | 11.293     | 40.701     | 353.3 |  7.70
Output  | 0.0092531  | 0.010605   | 0.011758   |   0.9 |  0.01
Modify  | 11.73      | 12.473     | 14.558     |  23.9 |  8.51
Other   |            | 0.07574    |            |       |  0.05

Nlocal:          43.75 ave          54 max          36 min
Histogram: 1 1 1 1 1 1 0 1 0 1
Nghost:        3165.38 ave        3232 max        3088 min
Histogram: 1 1 0 1 1 0 0 2 0 2
Neighs:        28486.2 ave       34635 max       23817 min
Histogram: 2 0 1 1 1 1 0 1 0 1

Total # of neighbors = 227890
Ave neighs/atom = 651.11429
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 14.5028
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz--0.4482)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.5028
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.2626999999999997115, deltaxy = 0.062627
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.4481999999999999873, deltaxz = 0.004482
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6420000000000000151, deltayz = 0.00642
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -0.145028 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 123.3 | 125.2 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.07373     -41130.871     -12463.228      1.7278661      3758.8201    
       100   300.37635     -41133.809     -5332.5173      1.7278661      3758.8201    
       200   316.22529     -41134.01      -1385.2579      1.7278661      3758.8201    
       300   286.77927     -41113.177     -12141.125      1.7278661      3758.8201    
       400   285.41689     -41140.533     -13623.741      1.7278661      3758.8201    
       500   284.72019     -41151.787     -11040.419      1.7278661      3758.8201    
       600   284.5648      -41144.13       3819.566       1.7278661      3758.8201    
       700   286.86927     -41124.9       -314.05932      1.7278661      3758.8201    
       800   327.61028     -41140.589      576.12983      1.7278661      3758.8201    
       900   316.496       -41128.402      1581.9704      1.7278661      3758.8201    
      1000   286.50389     -41128.473     -14289.726      1.7278661      3758.8201    
      1100   278.95793     -41147.7       -9330.8437      1.7278661      3758.8201    
      1200   285.12404     -41155.847     -11127.416      1.7278661      3758.8201    
      1300   279.20218     -41127.097     -9453.0781      1.7278661      3758.8201    
      1400   308.25636     -41128.496      4357.7865      1.7278661      3758.8201    
      1500   311.53741     -41136.352     -9866.1138      1.7278661      3758.8201    
      1600   280.79177     -41126.074     -5394.4108      1.7278661      3758.8201    
      1700   292.40072     -41149.346      9765.9145      1.7278661      3758.8201    
      1800   285.01321     -41151.136      71.558728      1.7278661      3758.8201    
      1900   285.90774     -41144.145      11247.973      1.7278661      3758.8201    
      2000   319.28416     -41155.765     -12962.338      1.7278661      3758.8201    
      2100   306.30468     -41138.259     -10764.029      1.7278661      3758.8201    
      2200   296.15866     -41151.523      3685.2596      1.7278661      3758.8201    
      2300   297.56234     -41175.604     -12302.406      1.7278661      3758.8201    
      2400   273.69331     -41187.698     -20990.395      1.7278661      3758.8201    
      2500   288.06452     -41202.228     -8666.678       1.7278661      3758.8201    
      2600   300.2879      -41188.748     -3086.8003      1.7278661      3758.8201    
      2700   286.63059     -41161.484     -5896.1037      1.7278661      3758.8201    
      2800   294.26965     -41156.103      161.09771      1.7278661      3758.8201    
      2900   315.15933     -41160.125     -5953.134       1.7278661      3758.8201    
      3000   290.38277     -41149.481     -3047.5367      1.7278661      3758.8201    
Loop time of 147.081 on 8 procs for 3000 steps with 350 atoms

Performance: 0.881 ns/day, 27.237 hours/ns, 20.397 timesteps/s, 7.139 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 84.829     | 113.44     | 122.65     | 113.6 | 77.13
Bond    | 0.0086461  | 0.0090532  | 0.0096008  |   0.3 |  0.01
Neigh   | 7.1018     | 9.1934     | 10.004     |  28.4 |  6.25
Comm    | 2.598      | 11.801     | 40.404     | 352.1 |  8.02
Output  | 0.0096127  | 0.011358   | 0.012487   |   1.0 |  0.01
Modify  | 11.733     | 12.549     | 14.656     |  24.5 |  8.53
Other   |            | 0.07393    |            |       |  0.05

Nlocal:          43.75 ave          52 max          36 min
Histogram: 1 0 2 0 1 1 1 1 0 1
Nghost:        3164.25 ave        3225 max        3105 min
Histogram: 2 0 1 1 0 0 1 0 2 1
Neighs:        28479.1 ave       33461 max       23743 min
Histogram: 1 0 2 0 1 1 1 1 0 1

Total # of neighbors = 227833
Ave neighs/atom = 650.95143
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.5028
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 0.145028 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 123.3 | 125.2 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.07373     -41130.871     -12463.228      1.7278661      3758.8201    
       100   300.38229     -41133.845     -5338.9854      1.7278661      3758.8201    
       200   315.48821     -41133.055     -647.5468       1.7278661      3758.8201    
       300   286.7828      -41113.484     -12443.84       1.7278661      3758.8201    
       400   285.55426     -41139.795     -14594          1.7278661      3758.8201    
       500   279.71065     -41146.898     -11806.22       1.7278661      3758.8201    
       600   293.81602     -41156.525      11457.613      1.7278661      3758.8201    
       700   288.32385     -41132.737     -8045.8085      1.7278661      3758.8201    
       800   321.41358     -41140.068     -4674.6268      1.7278661      3758.8201    
       900   315.92744     -41133.502     -910.43802      1.7278661      3758.8201    
      1000   289.41262     -41133.954     -7760.6669      1.7278661      3758.8201    
      1100   286.19271     -41150.488     -1736.8851      1.7278661      3758.8201    
      1200   299.95083     -41169.365     -14496.251      1.7278661      3758.8201    
      1300   298.33014     -41154.215     -8506.1967      1.7278661      3758.8201    
      1400   296.24468     -41129.658     -1954.0485      1.7278661      3758.8201    
      1500   309.5097      -41137.736     -11997.807      1.7278661      3758.8201    
      1600   301.93986     -41145.425     -282.23758      1.7278661      3758.8201    
      1700   285.01809     -41144.906     -7398.9262      1.7278661      3758.8201    
      1800   300.18584     -41162.521     -26594.409      1.7278661      3758.8201    
      1900   289.96063     -41157.198     -10608.548      1.7278661      3758.8201    
      2000   273.80434     -41142.413     -11695.425      1.7278661      3758.8201    
      2100   305.51131     -41148.899     -4805.4516      1.7278661      3758.8201    
      2200   304.48213     -41135.288     -18915.92       1.7278661      3758.8201    
      2300   304.92875     -41144.428     -5817.172       1.7278661      3758.8201    
      2400   290.65713     -41162.488     -1369.5897      1.7278661      3758.8201    
      2500   298.14113     -41181.229     -16599.356      1.7278661      3758.8201    
      2600   293.88706     -41165.287     -5136.5112      1.7278661      3758.8201    
      2700   313.72655     -41153.326     -7021.2196      1.7278661      3758.8201    
      2800   298.11915     -41141.143     -19386.02       1.7278661      3758.8201    
      2900   312.32732     -41161.788     -15603.265      1.7278661      3758.8201    
      3000   293.66275     -41150.558     -11020.826      1.7278661      3758.8201    
Loop time of 147.828 on 8 procs for 3000 steps with 350 atoms

Performance: 0.877 ns/day, 27.376 hours/ns, 20.294 timesteps/s, 7.103 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 100.99     | 116.14     | 123.75     |  81.9 | 78.57
Bond    | 0.00832    | 0.0088163  | 0.009322   |   0.4 |  0.01
Neigh   | 8.0388     | 9.2821     | 10.004     |  21.3 |  6.28
Comm    | 2.4548     | 10.052     | 25.201     | 278.3 |  6.80
Output  | 0.0093771  | 0.010808   | 0.011838   |   0.9 |  0.01
Modify  | 11.53      | 12.255     | 13.5       |  18.6 |  8.29
Other   |            | 0.07692    |            |       |  0.05

Nlocal:          43.75 ave          55 max          36 min
Histogram: 2 1 0 1 1 0 2 0 0 1
Nghost:        3179.38 ave        3233 max        3127 min
Histogram: 2 0 1 1 0 0 1 0 2 1
Neighs:        28493.2 ave       35359 max       23838 min
Histogram: 2 1 0 1 1 0 2 0 0 1

Total # of neighbors = 227946
Ave neighs/atom = 651.27429
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.0085
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--6.2627)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.0085
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.2626999999999997115, deltaxy = 0.062627
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.4481999999999999873, deltaxz = 0.004482
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6420000000000000151, deltayz = 0.00642
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -0.170085 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 123.3 | 125.2 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.07373     -41130.871     -12463.228      1.7278661      3758.8201    
       100   300.38194     -41133.807     -5344.3038      1.7278661      3758.8201    
       200   315.07352     -41132.157     -1127.6709      1.7278661      3758.8201    
       300   286.01786     -41112.132     -12820.638      1.7278661      3758.8201    
       400   282.40077     -41136.579     -18225.467      1.7278661      3758.8201    
       500   276.89063     -41144.92      -4955.2711      1.7278661      3758.8201    
       600   303.46099     -41169.05       4125.3064      1.7278661      3758.8201    
       700   280.3439      -41128.276     -10646.865      1.7278661      3758.8201    
       800   328.67676     -41150.946      4171.0961      1.7278661      3758.8201    
       900   318.41673     -41136.595     -11148.133      1.7278661      3758.8201    
      1000   300.72537     -41142.602      4795.611       1.7278661      3758.8201    
      1100   297.55644     -41156.24      -13259.443      1.7278661      3758.8201    
      1200   281.66153     -41147.085      367.41454      1.7278661      3758.8201    
      1300   289.12266     -41142.939      1704.275       1.7278661      3758.8201    
      1400   295.56306     -41120.291      38.893847      1.7278661      3758.8201    
      1500   327.41184     -41139.616      3432.5761      1.7278661      3758.8201    
      1600   312.77655     -41133.436     -18211.696      1.7278661      3758.8201    
      1700   279.91815     -41122.687     -11255.766      1.7278661      3758.8201    
      1800   294.59874     -41144.65      -6280.414       1.7278661      3758.8201    
      1900   305.29002     -41149.14      -6481.9684      1.7278661      3758.8201    
      2000   300.98835     -41129.532     -8677.8998      1.7278661      3758.8201    
      2100   304.57627     -41131.365     -5825.3653      1.7278661      3758.8201    
      2200   303.85177     -41155.186     -5211.2771      1.7278661      3758.8201    
      2300   288.82619     -41156.248     -17943.768      1.7278661      3758.8201    
      2400   284.60508     -41131.765     -23717.432      1.7278661      3758.8201    
      2500   300.47449     -41124.062     -3017.7044      1.7278661      3758.8201    
      2600   295.05659     -41119.432     -17168.522      1.7278661      3758.8201    
      2700   318.24956     -41152.785     -11834.063      1.7278661      3758.8201    
      2800   306.47201     -41161.969     -330.55753      1.7278661      3758.8201    
      2900   272.92314     -41144.452     -12577.148      1.7278661      3758.8201    
      3000   306.77579     -41158.896     -7612.0485      1.7278661      3758.8201    
Loop time of 145.408 on 8 procs for 3000 steps with 350 atoms

Performance: 0.891 ns/day, 26.927 hours/ns, 20.632 timesteps/s, 7.221 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.855     | 111.09     | 121.83     | 122.5 | 76.40
Bond    | 0.0082018  | 0.0086392  | 0.0090043  |   0.3 |  0.01
Neigh   | 7.1033     | 9.0366     | 10.056     |  34.5 |  6.21
Comm    | 2.1146     | 12.852     | 37.087     | 360.2 |  8.84
Output  | 0.0090667  | 0.010448   | 0.011426   |   0.9 |  0.01
Modify  | 11.31      | 12.332     | 14.277     |  29.7 |  8.48
Other   |            | 0.07381    |            |       |  0.05

Nlocal:          43.75 ave          52 max          35 min
Histogram: 1 0 1 1 1 0 2 1 0 1
Nghost:         3190.5 ave        3235 max        3154 min
Histogram: 2 0 1 1 0 1 1 1 0 1
Neighs:        28484.6 ave       33468 max       23131 min
Histogram: 1 0 1 1 1 0 2 1 0 1

Total # of neighbors = 227877
Ave neighs/atom = 651.07714
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.0085
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 0.170085 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 123.3 | 125.2 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   289.07373     -41130.871     -12463.228      1.7278661      3758.8201    
       100   300.38975     -41133.873     -5308.2259      1.7278661      3758.8201    
       200   315.01489     -41132.979      296.41236      1.7278661      3758.8201    
       300   290.15242     -41116.294     -12951.173      1.7278661      3758.8201    
       400   291.11857     -41146.033     -8434.9025      1.7278661      3758.8201    
       500   281.79777     -41150.705     -5292.7204      1.7278661      3758.8201    
       600   293.33144     -41158.743      7080.2964      1.7278661      3758.8201    
       700   294.10443     -41139.127     -7223.1152      1.7278661      3758.8201    
       800   329.97613     -41149.9       -5377.364       1.7278661      3758.8201    
       900   320.6466      -41134.012      2184.091       1.7278661      3758.8201    
      1000   283.39486     -41121.984      13059.722      1.7278661      3758.8201    
      1100   282.55808     -41141.888     -2385.862       1.7278661      3758.8201    
      1200   285.18338     -41146.47      -11342.715      1.7278661      3758.8201    
      1300   293.66497     -41132.697     -11398.801      1.7278661      3758.8201    
      1400   309.83053     -41124.572      358.69677      1.7278661      3758.8201    
      1500   297.45028     -41106.689      2465.8437      1.7278661      3758.8201    
      1600   311.59879     -41131.664     -14954.155      1.7278661      3758.8201    
      1700   298.03274     -41139.232     -7995.0106      1.7278661      3758.8201    
      1800   283.68018     -41137.134     -11506.875      1.7278661      3758.8201    
      1900   300.97384     -41150.2       -1817.8349      1.7278661      3758.8201    
      2000   306.85947     -41129.849      4252.0478      1.7278661      3758.8201    
      2100   301.76998     -41115.433     -18447.867      1.7278661      3758.8201    
      2200   296.85849     -41129.806      677.55077      1.7278661      3758.8201    
      2300   288.18832     -41136.54       13083.945      1.7278661      3758.8201    
      2400   294.2829      -41140.68      -4457.5507      1.7278661      3758.8201    
      2500   288.949       -41131.473     -14123.061      1.7278661      3758.8201    
      2600   305.5504      -41144.12      -7912.6139      1.7278661      3758.8201    
      2700   289.58964     -41137.931     -16116.618      1.7278661      3758.8201    
      2800   264.938       -41124.886     -13889.481      1.7278661      3758.8201    
      2900   297.32502     -41152.501     -10973.435      1.7278661      3758.8201    
      3000   322.2703      -41150.367     -4737.6801      1.7278661      3758.8201    
Loop time of 137.015 on 8 procs for 3000 steps with 350 atoms

Performance: 0.946 ns/day, 25.373 hours/ns, 21.895 timesteps/s, 7.663 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 79.346     | 102.43     | 112.93     | 133.0 | 74.75
Bond    | 0.0072977  | 0.0079568  | 0.0086272  |   0.4 |  0.01
Neigh   | 6.985      | 8.8649     | 9.9436     |  37.7 |  6.47
Comm    | 2.9513     | 13.456     | 36.527     | 366.7 |  9.82
Output  | 0.0081617  | 0.0093634  | 0.010177   |   0.8 |  0.01
Modify  | 11.092     | 12.183     | 14.078     |  32.4 |  8.89
Other   |            | 0.06944    |            |       |  0.05

Nlocal:          43.75 ave          54 max          36 min
Histogram: 2 0 1 2 0 0 1 1 0 1
Nghost:        3169.38 ave        3228 max        3103 min
Histogram: 1 1 0 0 0 4 0 0 0 2
Neighs:          28507 ave       34711 max       23729 min
Histogram: 2 0 0 3 0 0 1 1 0 1

Total # of neighbors = 228056
Ave neighs/atom = 651.58857
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:31:42
