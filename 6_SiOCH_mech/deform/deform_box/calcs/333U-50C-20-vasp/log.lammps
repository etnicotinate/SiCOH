LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.1                  # the deformation magnitude 0.01

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-20-vasp
read_data       ${structure}.data
read_data       333U-50C-20-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.006 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 5.37074e-05 on 8 procs for 1 steps with 350 atoms

50.5% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.36e-07   | 1.7825e-07 | 2.38e-07   |   0.0 |  0.33
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 1.657e-06  | 2.1182e-06 | 2.393e-06  |   0.0 |  3.94
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 5.141e-05  |            |       | 95.72

Nlocal:          43.75 ave          50 max          39 min
Histogram: 2 0 1 0 2 0 2 0 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-20-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 5000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -10.66 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.2 | 123.4 | 124.7 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -39436.432      138394.29      1.7278661      3758.8201    
       100   727.72694     -40293.204     -25486.886      1.7278661      3758.8201    
       200   598.70825     -40608.063     -20042.47       1.7278661      3758.8201    
       300   448.08153     -40775.317     -8719.4702      1.7278661      3758.8201    
       400   368.07576     -40916.064      12042.815      1.7278661      3758.8201    
       500   323.74279     -41017.02       5264.1982      1.7278661      3758.8201    
       600   292.42643     -41079.333     -9613.6408      1.7278661      3758.8201    
       700   280.08727     -41117.333     -3802.0268      1.7278661      3758.8201    
       800   268.90731     -41110.232     -13437.613      1.7278661      3758.8201    
       900   319.17604     -41127.933     -3878.1757      1.7278661      3758.8201    
      1000   313.85132     -41097.112     -12021.215      1.7278661      3758.8201    
      1100   297.80969     -41081.579      591.86918      1.7278661      3758.8201    
      1200   306.37949     -41113.974     -11363.523      1.7278661      3758.8201    
      1300   289.63524     -41124.704     -20535.279      1.7278661      3758.8201    
      1400   304.07464     -41146.229     -7746.2702      1.7278661      3758.8201    
      1500   306.29072     -41133.388     -2623.9505      1.7278661      3758.8201    
      1600   311.25329     -41114.363     -13340.379      1.7278661      3758.8201    
      1700   332.68075     -41130.152     -10184.373      1.7278661      3758.8201    
      1800   314.58786     -41139.559     -8919.2577      1.7278661      3758.8201    
      1900   279.07015     -41133.25      -1530.5775      1.7278661      3758.8201    
      2000   280.41135     -41139.933     -9024.6146      1.7278661      3758.8201    
      2100   303.63133     -41142.077     -4542.2177      1.7278661      3758.8201    
      2200   317.77941     -41133.579     -10072.475      1.7278661      3758.8201    
      2300   306.53749     -41119.342      2072.9476      1.7278661      3758.8201    
      2400   305.02057     -41135.935     -1116.6651      1.7278661      3758.8201    
      2500   300.58531     -41152.233     -6429.0853      1.7278661      3758.8201    
      2600   286.38545     -41144.478      1213.3547      1.7278661      3758.8201    
      2700   288.34425     -41134.461     -7970.2447      1.7278661      3758.8201    
      2800   314.78606     -41141.832      107.37236      1.7278661      3758.8201    
      2900   303.64746     -41134.267     -2626.4138      1.7278661      3758.8201    
      3000   289.07373     -41130.871     -12463.225      1.7278661      3758.8201    
      3100   300.38045     -41133.827     -5337.1393      1.7278661      3758.8201    
      3200   315.54145     -41133.07      -1149.8075      1.7278661      3758.8201    
      3300   286.8497      -41113.732     -11649.172      1.7278661      3758.8201    
      3400   289.03842     -41143.995     -16007.242      1.7278661      3758.8201    
      3500   282.2079      -41149.458     -9980.5624      1.7278661      3758.8201    
      3600   288.78748     -41149.707     -2376.8828      1.7278661      3758.8201    
      3700   287.06854     -41128.144     -3392.4589      1.7278661      3758.8201    
      3800   301.64214     -41116.82      -8404.678       1.7278661      3758.8201    
      3900   312.73064     -41122.635     -5645.3576      1.7278661      3758.8201    
      4000   305.50163     -41134.754     -15359.643      1.7278661      3758.8201    
      4100   286.27913     -41133.978     -6168.0629      1.7278661      3758.8201    
      4200   290.83643     -41143.353     -7294.5098      1.7278661      3758.8201    
      4300   303.06383     -41142.635     -2669.4766      1.7278661      3758.8201    
      4400   313.39461     -41135.584     -1540.4279      1.7278661      3758.8201    
      4500   293.52904     -41109.21      -10064.498      1.7278661      3758.8201    
      4600   316.55654     -41137.301     -8541.8152      1.7278661      3758.8201    
      4700   290.69209     -41132.252     -10977.88       1.7278661      3758.8201    
      4800   290.49621     -41147.512     -8332.7452      1.7278661      3758.8201    
      4900   288.5505      -41147.925      1042.2228      1.7278661      3758.8201    
      5000   297.5373      -41137.034     -14475.576      1.7278661      3758.8201    
Loop time of 244.641 on 8 procs for 5000 steps with 350 atoms

Performance: 0.883 ns/day, 27.182 hours/ns, 20.438 timesteps/s, 7.153 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 196.68     | 201.33     | 204.75     |  20.6 | 82.29
Bond    | 0.0018496  | 0.0020773  | 0.0023939  |   0.4 |  0.00
Neigh   | 15.966     | 16.369     | 16.67      |   6.1 |  6.69
Comm    | 3.6514     | 7.0802     | 11.731     | 110.2 |  2.89
Output  | 0.0030971  | 0.003344   | 0.0046445  |   0.9 |  0.00
Modify  | 19.446     | 19.75      | 20.156     |   5.6 |  8.07
Other   |            | 0.1097     |            |       |  0.04

Nlocal:          43.75 ave          53 max          37 min
Histogram: 1 1 0 2 1 1 1 0 0 1
Nghost:         3154.5 ave        3209 max        3104 min
Histogram: 2 0 1 1 0 0 1 1 1 1
Neighs:          28499 ave       34098 max       24485 min
Histogram: 1 1 1 1 2 0 1 0 0 1

Total # of neighbors = 227992
Ave neighs/atom = 651.40571
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333U-50C-20-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.2382
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 14.5028
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.0085

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal -0.642
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal -0.4482
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -6.2627

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 15.2382
variable dlen equal lx-${len0}
variable dlen equal lx-15.2382
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*15.2382
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.2626999999999997115, deltaxy = 0.62627
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.4481999999999999873, deltaxz = 0.04482
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6420000000000000151, deltayz = 0.0642
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.52382 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.52382 xy delta 0.62627 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.52382 xy delta 0.62627 xz delta 0.04482 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.9 | 122.9 | 124.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   297.5373      -41137.034     -14475.629      3758.8201      15.2382        14.5028        17.0085      
       100   301.89306     -41120.748     -12553.857      3751.3025      15.207724      14.5028        17.0085      
       200   287.95192     -41113.958     -13723.362      3743.7848      15.177247      14.5028        17.0085      
       300   303.03186     -41152.488     -6387.3575      3736.2672      15.146771      14.5028        17.0085      
       400   302.92328     -41158.281     -15586.781      3728.7495      15.116294      14.5028        17.0085      
       500   296.71445     -41154.116     -1016.1584      3721.2319      15.085818      14.5028        17.0085      
       600   322.04737     -41179.292     -7347.317       3713.7143      15.055342      14.5028        17.0085      
       700   273.88689     -41154.555      3892.1582      3706.1966      15.024865      14.5028        17.0085      
       800   290.22223     -41163.903     -17521.028      3698.679       14.994389      14.5028        17.0085      
       900   306.53003     -41169.996     -4682.214       3691.1613      14.963912      14.5028        17.0085      
      1000   295.13041     -41150.16      -9000.6751      3683.6437      14.933436      14.5028        17.0085      
      1100   297.70724     -41148.077      4564.0133      3676.1261      14.90296       14.5028        17.0085      
      1200   307.24559     -41154.832     -10231.756      3668.6084      14.872483      14.5028        17.0085      
      1300   309.04736     -41171.301     -11174.451      3661.0908      14.842007      14.5028        17.0085      
      1400   315.41753     -41182.615      4629.5521      3653.5731      14.81153       14.5028        17.0085      
      1500   300.39301     -41169.816     -1746.8245      3646.0555      14.781054      14.5028        17.0085      
      1600   313.14213     -41179.606      392.6874       3638.5379      14.750578      14.5028        17.0085      
      1700   287.74201     -41163.485     -15871.658      3631.0202      14.720101      14.5028        17.0085      
      1800   272.6745      -41176.222      2871.4752      3623.5026      14.689625      14.5028        17.0085      
      1900   293.55924     -41201.495      16557.442      3615.9849      14.659148      14.5028        17.0085      
      2000   288.52217     -41167.728     -861.87905      3608.4673      14.628672      14.5028        17.0085      
      2100   338.31097     -41197.516      7182.7378      3600.9497      14.598196      14.5028        17.0085      
      2200   291.12161     -41150.196      4619.1092      3593.432       14.567719      14.5028        17.0085      
      2300   304.47091     -41181.34       24844.756      3585.9144      14.537243      14.5028        17.0085      
      2400   283.71179     -41179.7       -2987.4594      3578.3967      14.506766      14.5028        17.0085      
      2500   277.38483     -41160.381      7147.0032      3570.8791      14.47629       14.5028        17.0085      
      2600   320.37801     -41173.085      23711.862      3563.3615      14.445814      14.5028        17.0085      
      2700   317.68242     -41157.352      2257.1875      3555.8438      14.415337      14.5028        17.0085      
      2800   318.91138     -41163.388      13186.844      3548.3262      14.384861      14.5028        17.0085      
      2900   291.76836     -41160.479      10505.797      3540.8085      14.354384      14.5028        17.0085      
      3000   294.87734     -41157.9        14359.004      3533.2909      14.323908      14.5028        17.0085      
      3100   292.16586     -41133.746      2828.2482      3525.7733      14.293432      14.5028        17.0085      
      3200   332.22159     -41145.669      16847.249      3518.2556      14.262955      14.5028        17.0085      
      3300   310.485       -41124.197      22593.523      3510.738       14.232479      14.5028        17.0085      
      3400   305.60716     -41146.176      13723.657      3503.2203      14.202002      14.5028        17.0085      
      3500   314.53634     -41152.985      29516.375      3495.7027      14.171526      14.5028        17.0085      
      3600   305.66906     -41152.063      6127.6879      3488.1851      14.14105       14.5028        17.0085      
      3700   306.78805     -41166.068      26632.617      3480.6674      14.110573      14.5028        17.0085      
      3800   292.4252      -41152.126      19442.252      3473.1498      14.080097      14.5028        17.0085      
      3900   294.8496      -41165.872      13539.091      3465.6321      14.04962       14.5028        17.0085      
      4000   284.07149     -41167.41       20618.685      3458.1145      14.019144      14.5028        17.0085      
      4100   298.22067     -41152.749      13579.711      3450.5969      13.988668      14.5028        17.0085      
      4200   316.03512     -41132.402      7926.6035      3443.0792      13.958191      14.5028        17.0085      
      4300   301.88547     -41115.82       18671.168      3435.5616      13.927715      14.5028        17.0085      
      4400   313.17514     -41125.579      4921.0943      3428.0439      13.897238      14.5028        17.0085      
      4500   305.11038     -41126.91       28001.769      3420.5263      13.866762      14.5028        17.0085      
      4600   302.68745     -41114.399      22016.606      3413.0087      13.836286      14.5028        17.0085      
      4700   306.57168     -41111.406      27212.795      3405.491       13.805809      14.5028        17.0085      
      4800   286.3714      -41095.194      34569.868      3397.9734      13.775333      14.5028        17.0085      
      4900   309.32374     -41123.302      22712.101      3390.4557      13.744856      14.5028        17.0085      
      5000   291.83514     -41105.764      33503.073      3382.9381      13.71438       14.5028        17.0085      
Loop time of 267.267 on 8 procs for 5000 steps with 350 atoms

Performance: 0.808 ns/day, 29.696 hours/ns, 18.708 timesteps/s, 6.548 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 204.26     | 214.28     | 222.76     |  39.1 | 80.17
Bond    | 0.0018579  | 0.0020664  | 0.0024344  |   0.4 |  0.00
Neigh   | 16.015     | 16.858     | 17.667     |  13.3 |  6.31
Comm    | 4.6217     | 13.096     | 23.093     | 158.1 |  4.90
Output  | 0.017021   | 0.019613   | 0.021419   |   1.1 |  0.01
Modify  | 22.086     | 22.898     | 23.72      |  11.3 |  8.57
Other   |            | 0.113      |            |       |  0.04

Nlocal:          43.75 ave          49 max          37 min
Histogram: 1 1 0 1 1 0 0 1 1 2
Nghost:           3403 ave        3455 max        3349 min
Histogram: 1 2 1 0 0 0 0 1 2 1
Neighs:        31662.4 ave       35238 max       27135 min
Histogram: 1 1 1 0 1 0 0 1 1 2

Total # of neighbors = 253299
Ave neighs/atom = 723.71143
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*15.2382
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.52382 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.52382 xy delta -0.62627 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.52382 xy delta -0.62627 xz delta -0.04482 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121 | 122.9 | 125 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   297.5373      -41137.034     -14475.629      3758.8201      15.2382        14.5028        17.0085      
       100   301.99939     -41120.707     -12583.633      3766.3377      15.268676      14.5028        17.0085      
       200   286.57518     -41117.484     -16046.574      3773.8554      15.299153      14.5028        17.0085      
       300   309.59035     -41164.069     -6205.5214      3781.373       15.329629      14.5028        17.0085      
       400   306.22904     -41161.279     -17827.621      3788.8907      15.360106      14.5028        17.0085      
       500   300.46315     -41145.498     -17683.705      3796.4083      15.390582      14.5028        17.0085      
       600   300.79313     -41138.822     -7830.3368      3803.926       15.421058      14.5028        17.0085      
       700   288.56813     -41129.519     -18477.2        3811.4436      15.451535      14.5028        17.0085      
       800   290.76641     -41145.562     -24451.384      3818.9612      15.482011      14.5028        17.0085      
       900   281.81106     -41143.855     -11741.412      3826.4789      15.512488      14.5028        17.0085      
      1000   300.91112     -41138.943     -9218.1383      3833.9965      15.542964      14.5028        17.0085      
      1100   317.87321     -41114.9       -18431.228      3841.5142      15.57344       14.5028        17.0085      
      1200   312.76007     -41111.18      -14905.7        3849.0318      15.603917      14.5028        17.0085      
      1300   293.76302     -41102.522     -8005.2016      3856.5494      15.634393      14.5028        17.0085      
      1400   299.42178     -41112.608     -22343.555      3864.0671      15.66487       14.5028        17.0085      
      1500   290.28991     -41112.09      -12184.499      3871.5847      15.695346      14.5028        17.0085      
      1600   296.72831     -41122.992     -23109.988      3879.1024      15.725822      14.5028        17.0085      
      1700   302.55768     -41113.516     -6493.166       3886.62        15.756299      14.5028        17.0085      
      1800   320.94501     -41090.091     -10044.143      3894.1376      15.786775      14.5028        17.0085      
      1900   337.78685     -41088.395     -29090.678      3901.6553      15.817252      14.5028        17.0085      
      2000   317.9314      -41094.57      -20108.152      3909.1729      15.847728      14.5028        17.0085      
      2100   307.36861     -41096.559     -17718.843      3916.6906      15.878204      14.5028        17.0085      
      2200   296.66698     -41097.371     -21471.916      3924.2082      15.908681      14.5028        17.0085      
      2300   311.059       -41126.187     -19203.777      3931.7258      15.939157      14.5028        17.0085      
      2400   293.21776     -41107.467     -24488.611      3939.2435      15.969634      14.5028        17.0085      
      2500   305.62123     -41109.41      -26005.161      3946.7611      16.00011       14.5028        17.0085      
      2600   292.28105     -41090.004     -6979.6544      3954.2788      16.030586      14.5028        17.0085      
      2700   302.12089     -41094.044     -19093.003      3961.7964      16.061063      14.5028        17.0085      
      2800   305.3366      -41111.309     -16970.281      3969.314       16.091539      14.5028        17.0085      
      2900   294.35884     -41097.679     -21131.28       3976.8317      16.122016      14.5028        17.0085      
      3000   305.74877     -41079.944     -19331.886      3984.3493      16.152492      14.5028        17.0085      
      3100   321.35759     -41080.354     -25908.881      3991.867       16.182968      14.5028        17.0085      
      3200   299.56523     -41081.991     -13678.938      3999.3846      16.213445      14.5028        17.0085      
      3300   293.31907     -41094.978     -19580.053      4006.9022      16.243921      14.5028        17.0085      
      3400   294.65302     -41106.762     -22001.924      4014.4199      16.274398      14.5028        17.0085      
      3500   288.25819     -41093.581     -31450.533      4021.9375      16.304874      14.5028        17.0085      
      3600   306.96023     -41097.137     -24803.811      4029.4552      16.33535       14.5028        17.0085      
      3700   319.92276     -41078.76      -23249.422      4036.9728      16.365827      14.5028        17.0085      
      3800   326.2622      -41082.361     -23964.936      4044.4904      16.396303      14.5028        17.0085      
      3900   286.58143     -41066.822     -16514.848      4052.0081      16.42678       14.5028        17.0085      
      4000   291.42426     -41069.991     -17806.991      4059.5257      16.457256      14.5028        17.0085      
      4100   294.12339     -41072.949     -14942.217      4067.0434      16.487732      14.5028        17.0085      
      4200   289.37114     -41076.598     -23497.289      4074.561       16.518209      14.5028        17.0085      
      4300   296.66175     -41090.314     -28155.958      4082.0786      16.548685      14.5028        17.0085      
      4400   268.77602     -41077.33      -35216.693      4089.5963      16.579162      14.5028        17.0085      
      4500   279.31272     -41069.766     -25714.234      4097.1139      16.609638      14.5028        17.0085      
      4600   295.42062     -41045.978     -36929.491      4104.6316      16.640114      14.5028        17.0085      
      4700   325.36302     -41058.495     -23349.432      4112.1492      16.670591      14.5028        17.0085      
      4800   302.12761     -41050.94      -18278.261      4119.6668      16.701067      14.5028        17.0085      
      4900   298.87622     -41059.933     -22742.097      4127.1845      16.731544      14.5028        17.0085      
      5000   298.09839     -41066.337     -27918.614      4134.7021      16.76202       14.5028        17.0085      
Loop time of 230.009 on 8 procs for 5000 steps with 350 atoms

Performance: 0.939 ns/day, 25.557 hours/ns, 21.738 timesteps/s, 7.608 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 131.35     | 181.07     | 191.42     | 141.0 | 78.72
Bond    | 0.0018282  | 0.0020174  | 0.0023984  |   0.4 |  0.00
Neigh   | 11.11      | 14.985     | 16.227     |  39.0 |  6.52
Comm    | 3.0002     | 13.355     | 63.08      | 519.3 |  5.81
Output  | 0.018283   | 0.020856   | 0.023338   |   1.2 |  0.01
Modify  | 19.236     | 20.471     | 24.35      |  33.3 |  8.90
Other   |            | 0.1101     |            |       |  0.05

Nlocal:          43.75 ave          53 max          35 min
Histogram: 2 0 0 1 0 3 0 0 1 1
Nghost:           2985 ave        3045 max        2934 min
Histogram: 1 1 1 2 0 0 1 0 1 1
Neighs:          25865 ave       31044 max       20756 min
Histogram: 2 0 0 0 1 3 0 0 1 1

Total # of neighbors = 206920
Ave neighs/atom = 591.2
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 14.5028
variable dlen equal ly-${len0}
variable dlen equal ly-14.5028
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*14.5028
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.2626999999999997115, deltaxy = 0.62627
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.4481999999999999873, deltaxz = 0.04482
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6420000000000000151, deltayz = 0.0642
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.45028 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.45028 yz delta 0.0642 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.9 | 122.9 | 124.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   297.5373      -41137.034     -14475.629      3758.8201      15.2382        14.5028        17.0085      
       100   302.1431      -41120.591     -12524.609      3751.3025      15.2382        14.473794      17.0085      
       200   285.64133     -41117.368     -15837.703      3743.7848      15.2382        14.444789      17.0085      
       300   298.98015     -41159.676     -3671.8052      3736.2672      15.2382        14.415783      17.0085      
       400   306.5308      -41172.209     -19161.537      3728.7495      15.2382        14.386778      17.0085      
       500   312.57746     -41173.521      6808.9972      3721.2319      15.2382        14.357772      17.0085      
       600   301.09316     -41146.588     -545.52288      3713.7143      15.2382        14.328766      17.0085      
       700   296.11172     -41143.935     -7753.0892      3706.1966      15.2382        14.299761      17.0085      
       800   307.90037     -41182.835     -171.39614      3698.679       15.2382        14.270755      17.0085      
       900   307.0806      -41184.746     -5820.5025      3691.1613      15.2382        14.24175       17.0085      
      1000   299.76686     -41170.907     -17170.541      3683.6437      15.2382        14.212744      17.0085      
      1100   283.04416     -41159.727     -2768.0797      3676.1261      15.2382        14.183738      17.0085      
      1200   302.81648     -41170.597     -7520.5287      3668.6084      15.2382        14.154733      17.0085      
      1300   324.39579     -41176.836     -3852.3713      3661.0908      15.2382        14.125727      17.0085      
      1400   309.82278     -41163.597      5798.9671      3653.5731      15.2382        14.096722      17.0085      
      1500   296.31789     -41160.792      8247.3714      3646.0555      15.2382        14.067716      17.0085      
      1600   287.84986     -41163.358     -13242.772      3638.5379      15.2382        14.03871       17.0085      
      1700   288.06964     -41178.881     -8156.3525      3631.0202      15.2382        14.009705      17.0085      
      1800   279.69865     -41191.97      -2642.2924      3623.5026      15.2382        13.980699      17.0085      
      1900   296.61994     -41193.37       1994.8357      3615.9849      15.2382        13.951694      17.0085      
      2000   300.34525     -41152.015      6712.6324      3608.4673      15.2382        13.922688      17.0085      
      2100   310.96018     -41160.429      12812.452      3600.9497      15.2382        13.893682      17.0085      
      2200   298.33631     -41152.992      10339.919      3593.432       15.2382        13.864677      17.0085      
      2300   285.62311     -41150.256      11952.519      3585.9144      15.2382        13.835671      17.0085      
      2400   287.33347     -41163.381      3521.7649      3578.3967      15.2382        13.806666      17.0085      
      2500   282.23662     -41166.314      12901.998      3570.8791      15.2382        13.77766       17.0085      
      2600   286.16632     -41152.588      13158.506      3563.3615      15.2382        13.748654      17.0085      
      2700   314.01594     -41149.062      12158.923      3555.8438      15.2382        13.719649      17.0085      
      2800   317.49106     -41146.643      11313.592      3548.3262      15.2382        13.690643      17.0085      
      2900   319.67092     -41174.11       4147.9718      3540.8085      15.2382        13.661638      17.0085      
      3000   318.78987     -41184.691      29949.666      3533.2909      15.2382        13.632632      17.0085      
      3100   294.97359     -41166.779      20917.883      3525.7733      15.2382        13.603626      17.0085      
      3200   307.36009     -41185.045      14088.896      3518.2556      15.2382        13.574621      17.0085      
      3300   289.01129     -41162.567      9181.5065      3510.738       15.2382        13.545615      17.0085      
      3400   303.64242     -41166.699      12137.649      3503.2203      15.2382        13.51661       17.0085      
      3500   299.78539     -41157.349     -6797.5009      3495.7027      15.2382        13.487604      17.0085      
      3600   305.56548     -41175.807      9610.268       3488.1851      15.2382        13.458598      17.0085      
      3700   293.32729     -41174.583      9786.1856      3480.6674      15.2382        13.429593      17.0085      
      3800   289.64747     -41171.438      24254.895      3473.1498      15.2382        13.400587      17.0085      
      3900   305.68432     -41190.058      19495.82       3465.6321      15.2382        13.371582      17.0085      
      4000   291.77912     -41201.211      11475.671      3458.1145      15.2382        13.342576      17.0085      
      4100   302.5642      -41216.254      26304.054      3450.5969      15.2382        13.31357       17.0085      
      4200   291.74453     -41185.845      18078.155      3443.0792      15.2382        13.284565      17.0085      
      4300   306.47392     -41172.422      12673.636      3435.5616      15.2382        13.255559      17.0085      
      4400   314.76465     -41168.548      13211.751      3428.0439      15.2382        13.226554      17.0085      
      4500   308.44615     -41168.94       1022.5883      3420.5263      15.2382        13.197548      17.0085      
      4600   289.99731     -41156.779      8948.7612      3413.0087      15.2382        13.168542      17.0085      
      4700   307.81708     -41184.845      32297.812      3405.491       15.2382        13.139537      17.0085      
      4800   299.33873     -41181.97       16971.491      3397.9734      15.2382        13.110531      17.0085      
      4900   273.44737     -41172.268      23788.545      3390.4557      15.2382        13.081526      17.0085      
      5000   280.69444     -41166.657      22419.391      3382.9381      15.2382        13.05252       17.0085      
Loop time of 267.238 on 8 procs for 5000 steps with 350 atoms

Performance: 0.808 ns/day, 29.693 hours/ns, 18.710 timesteps/s, 6.548 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 192.74     | 213.91     | 222.65     |  64.2 | 80.04
Bond    | 0.0018792  | 0.002044   | 0.0022531  |   0.3 |  0.00
Neigh   | 15.53      | 16.932     | 18.375     |  19.9 |  6.34
Comm    | 5.4959     | 14.228     | 35.406     | 248.9 |  5.32
Output  | 0.017977   | 0.020132   | 0.021925   |   1.0 |  0.01
Modify  | 20.599     | 22.034     | 23.436     |  17.4 |  8.24
Other   |            | 0.1118     |            |       |  0.04

Nlocal:          43.75 ave          49 max          38 min
Histogram: 1 0 0 3 0 0 1 2 0 1
Nghost:         3462.5 ave        3532 max        3414 min
Histogram: 3 0 1 0 1 1 0 0 1 1
Neighs:          31711 ave       35281 max       27753 min
Histogram: 1 0 0 3 0 0 2 1 0 1

Total # of neighbors = 253688
Ave neighs/atom = 724.82286
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*14.5028
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.45028 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.45028 yz delta -0.0642 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121 | 122.9 | 125 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   297.5373      -41137.034     -14475.629      3758.8201      15.2382        14.5028        17.0085      
       100   301.82417     -41121.012     -12480.473      3766.3377      15.2382        14.531806      17.0085      
       200   286.81117     -41114.88      -13038.743      3773.8554      15.2382        14.560811      17.0085      
       300   303.7123      -41152.273     -6019.2623      3781.373       15.2382        14.589817      17.0085      
       400   306.40108     -41154.292     -23494.538      3788.8907      15.2382        14.618822      17.0085      
       500   310.21035     -41157.836     -6537.4463      3796.4083      15.2382        14.647828      17.0085      
       600   301.07369     -41147.985     -9314.1793      3803.926       15.2382        14.676834      17.0085      
       700   303.86009     -41167.507     -5156.1551      3811.4436      15.2382        14.705839      17.0085      
       800   287.68759     -41165.996     -18693.739      3818.9612      15.2382        14.734845      17.0085      
       900   287.62655     -41140.519     -18750.596      3826.4789      15.2382        14.76385       17.0085      
      1000   302.13871     -41120.02      -17677.059      3833.9965      15.2382        14.792856      17.0085      
      1100   320.44186     -41139.083     -14636.856      3841.5142      15.2382        14.821862      17.0085      
      1200   287.96563     -41124.1       -16567.435      3849.0318      15.2382        14.850867      17.0085      
      1300   292.75786     -41133.871     -18627.02       3856.5494      15.2382        14.879873      17.0085      
      1400   306.05243     -41129.36      -19154.115      3864.0671      15.2382        14.908878      17.0085      
      1500   325.19685     -41107.421     -21479.305      3871.5847      15.2382        14.937884      17.0085      
      1600   306.96011     -41080.689     -10969.854      3879.1024      15.2382        14.96689       17.0085      
      1700   310.87523     -41100.852     -9431.1874      3886.62        15.2382        14.995895      17.0085      
      1800   294.10646     -41100.39      -13075.554      3894.1376      15.2382        15.024901      17.0085      
      1900   303.66361     -41115.848     -22456.133      3901.6553      15.2382        15.053906      17.0085      
      2000   291.04936     -41112.256     -20525.115      3909.1729      15.2382        15.082912      17.0085      
      2100   290.91799     -41111.325     -20094.339      3916.6906      15.2382        15.111918      17.0085      
      2200   302.01963     -41098.824     -5422.208       3924.2082      15.2382        15.140923      17.0085      
      2300   308.06711     -41074.993     -8679.4948      3931.7258      15.2382        15.169929      17.0085      
      2400   301.75711     -41064.055     -16461.815      3939.2435      15.2382        15.198934      17.0085      
      2500   293.00055     -41081.431     -11040.594      3946.7611      15.2382        15.22794       17.0085      
      2600   300.00318     -41093.898     -15921.872      3954.2788      15.2382        15.256946      17.0085      
      2700   312.94882     -41097.222     -26748.072      3961.7964      15.2382        15.285951      17.0085      
      2800   294.43091     -41064.424     -27383.609      3969.314       15.2382        15.314957      17.0085      
      2900   309.44802     -41052.103     -10139.69       3976.8317      15.2382        15.343962      17.0085      
      3000   292.3018      -41036.669     -33373.059      3984.3493      15.2382        15.372968      17.0085      
      3100   313.09485     -41077.469     -33892.976      3991.867       15.2382        15.401974      17.0085      
      3200   316.66753     -41086.287     -22954.91       3999.3846      15.2382        15.430979      17.0085      
      3300   288.08398     -41056.398     -25739.743      4006.9022      15.2382        15.459985      17.0085      
      3400   303.90463     -41041.583     -20534.479      4014.4199      15.2382        15.48899       17.0085      
      3500   329.13232     -41030.125     -19806.564      4021.9375      15.2382        15.517996      17.0085      
      3600   308.00452     -41006.033     -31359.808      4029.4552      15.2382        15.547002      17.0085      
      3700   307.35567     -41034.747     -13709.169      4036.9728      15.2382        15.576007      17.0085      
      3800   301.43319     -41039.937     -21066.891      4044.4904      15.2382        15.605013      17.0085      
      3900   296.95677     -41032.45      -23199.607      4052.0081      15.2382        15.634018      17.0085      
      4000   293.1649      -41027.001     -33651.356      4059.5257      15.2382        15.663024      17.0085      
      4100   271.02444     -41023.676     -29400.556      4067.0434      15.2382        15.69203       17.0085      
      4200   285.72865     -41044.464     -30423.644      4074.561       15.2382        15.721035      17.0085      
      4300   291.12042     -41025.423     -11128.749      4082.0786      15.2382        15.750041      17.0085      
      4400   312.23315     -41004.864     -13358.623      4089.5963      15.2382        15.779046      17.0085      
      4500   321.68533     -41015.201     -23656.167      4097.1139      15.2382        15.808052      17.0085      
      4600   317.19894     -41027.872     -20189.05       4104.6316      15.2382        15.837058      17.0085      
      4700   293.10739     -41008.296     -23577.854      4112.1492      15.2382        15.866063      17.0085      
      4800   319.7663      -41036.669     -21538.166      4119.6668      15.2382        15.895069      17.0085      
      4900   289.36454     -41019.849     -15514.781      4127.1845      15.2382        15.924074      17.0085      
      5000   298.6618      -41051.292     -14284.48       4134.7021      15.2382        15.95308       17.0085      
Loop time of 228.373 on 8 procs for 5000 steps with 350 atoms

Performance: 0.946 ns/day, 25.375 hours/ns, 21.894 timesteps/s, 7.663 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 150.93     | 176.42     | 190.34     | 108.8 | 77.25
Bond    | 0.0017404  | 0.0019394  | 0.0021099  |   0.3 |  0.00
Neigh   | 11.979     | 14.5       | 16.136     |  35.1 |  6.35
Comm    | 3.0769     | 16.997     | 42.48      | 350.5 |  7.44
Output  | 0.016791   | 0.018754   | 0.020234   |   0.9 |  0.01
Modify  | 18.692     | 20.33      | 22.87      |  29.9 |  8.90
Other   |            | 0.1071     |            |       |  0.05

Nlocal:          43.75 ave          52 max          38 min
Histogram: 3 0 1 0 0 2 0 1 0 1
Nghost:        2931.25 ave        2972 max        2884 min
Histogram: 1 1 0 0 0 2 2 0 0 2
Neighs:          25871 ave       30388 max       22716 min
Histogram: 3 0 0 1 0 2 0 1 0 1

Total # of neighbors = 206968
Ave neighs/atom = 591.33714
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.0085
variable dlen equal lz-${len0}
variable dlen equal lz-17.0085
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.0085
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.2626999999999997115, deltaxy = 0.62627
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.4481999999999999873, deltaxz = 0.04482
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6420000000000000151, deltayz = 0.0642
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -1.70085 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.9 | 122.9 | 124.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   297.5373      -41137.034     -14475.629      3758.8201      15.2382        14.5028        17.0085      
       100   302.15554     -41120.455     -12524.064      3751.3025      15.2382        14.5028        16.974483    
       200   284.50444     -41116.854     -16474.245      3743.7848      15.2382        14.5028        16.940466    
       300   306.63075     -41165.174     -8212.3327      3736.2672      15.2382        14.5028        16.906449    
       400   301.57311     -41163.696     -22923.083      3728.7495      15.2382        14.5028        16.872432    
       500   307.58669     -41171.049     -10458.145      3721.2319      15.2382        14.5028        16.838415    
       600   305.31578     -41164.534     -9052.2356      3713.7143      15.2382        14.5028        16.804398    
       700   304.06184     -41162.153     -9961.4411      3706.1966      15.2382        14.5028        16.770381    
       800   290.62661     -41164.326     -3470.9068      3698.679       15.2382        14.5028        16.736364    
       900   278.22885     -41159.074     -5884.216       3691.1613      15.2382        14.5028        16.702347    
      1000   303.34562     -41180.406     -9591.8935      3683.6437      15.2382        14.5028        16.66833     
      1100   313.72173     -41149.876      1311.2769      3676.1261      15.2382        14.5028        16.634313    
      1200   324.59661     -41164.58      -2818.3828      3668.6084      15.2382        14.5028        16.600296    
      1300   305.30123     -41156.931     -3324.0636      3661.0908      15.2382        14.5028        16.566279    
      1400   304.42367     -41164.931      7175.4852      3653.5731      15.2382        14.5028        16.532262    
      1500   303.90294     -41166.608      3781.1254      3646.0555      15.2382        14.5028        16.498245    
      1600   301.68144     -41176.875      510.69546      3638.5379      15.2382        14.5028        16.464228    
      1700   289.79695     -41168.597     -4330.5859      3631.0202      15.2382        14.5028        16.430211    
      1800   284.04455     -41176.259      276.88413      3623.5026      15.2382        14.5028        16.396194    
      1900   290.93209     -41206.581      4354.9636      3615.9849      15.2382        14.5028        16.362177    
      2000   280.21243     -41179.236      12599.977      3608.4673      15.2382        14.5028        16.32816     
      2100   295.32499     -41173.676      16902.813      3600.9497      15.2382        14.5028        16.294143    
      2200   296.19042     -41157.291      727.02282      3593.432       15.2382        14.5028        16.260126    
      2300   283.26603     -41152.875      5222.7935      3585.9144      15.2382        14.5028        16.226109    
      2400   307.41841     -41193.033      1752.0974      3578.3967      15.2382        14.5028        16.192092    
      2500   303.76027     -41195.229      5124.2471      3570.8791      15.2382        14.5028        16.158075    
      2600   304.06338     -41181.973      13835.257      3563.3615      15.2382        14.5028        16.124058    
      2700   312.5817      -41184.057      2084.2072      3555.8438      15.2382        14.5028        16.090041    
      2800   300.14784     -41178.298     -2879.2756      3548.3262      15.2382        14.5028        16.056024    
      2900   306.19433     -41208.595      6856.534       3540.8085      15.2382        14.5028        16.022007    
      3000   278.11482     -41183.765     -2295.7091      3533.2909      15.2382        14.5028        15.98799     
      3100   288.789       -41180.844      16600.536      3525.7733      15.2382        14.5028        15.953973    
      3200   310.45144     -41189.922      12991.694      3518.2556      15.2382        14.5028        15.919956    
      3300   306.11325     -41180.853      5828.4382      3510.738       15.2382        14.5028        15.885939    
      3400   292.47876     -41194.816      5906.617       3503.2203      15.2382        14.5028        15.851922    
      3500   282.86756     -41200.197      18016.611      3495.7027      15.2382        14.5028        15.817905    
      3600   295.90219     -41210.122      21963.053      3488.1851      15.2382        14.5028        15.783888    
      3700   286.09918     -41201.221      9790.2661      3480.6674      15.2382        14.5028        15.749871    
      3800   295.95692     -41200.197      25478.843      3473.1498      15.2382        14.5028        15.715854    
      3900   306.0245      -41187.144      18038.243      3465.6321      15.2382        14.5028        15.681837    
      4000   299.86281     -41172.823      16070.572      3458.1145      15.2382        14.5028        15.64782     
      4100   302.13468     -41199.161      21766.259      3450.5969      15.2382        14.5028        15.613803    
      4200   293.08686     -41207.373      26764.204      3443.0792      15.2382        14.5028        15.579786    
      4300   296.92117     -41200.189      19533.691      3435.5616      15.2382        14.5028        15.545769    
      4400   318.46725     -41213.287      33342.534      3428.0439      15.2382        14.5028        15.511752    
      4500   309.14923     -41205.613      36130.878      3420.5263      15.2382        14.5028        15.477735    
      4600   312.15797     -41230.946      36929.385      3413.0087      15.2382        14.5028        15.443718    
      4700   286.83416     -41208.108      29028.882      3405.491       15.2382        14.5028        15.409701    
      4800   299.54554     -41196.273      37415.175      3397.9734      15.2382        14.5028        15.375684    
      4900   302.00959     -41171.004      29237.337      3390.4557      15.2382        14.5028        15.341667    
      5000   303.74479     -41175.317      35697.61       3382.9381      15.2382        14.5028        15.30765     
Loop time of 263.725 on 8 procs for 5000 steps with 350 atoms

Performance: 0.819 ns/day, 29.303 hours/ns, 18.959 timesteps/s, 6.636 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 156.25     | 196.76     | 222.35     | 206.8 | 74.61
Bond    | 0.0018798  | 0.0020503  | 0.0023204  |   0.4 |  0.00
Neigh   | 12.235     | 15.435     | 18.011     |  57.8 |  5.85
Comm    | 2.7014     | 28.328     | 68.82      | 545.2 | 10.74
Output  | 0.018348   | 0.020939   | 0.023182   |   1.1 |  0.01
Modify  | 20.501     | 23.08      | 26.261     |  47.2 |  8.75
Other   |            | 0.1041     |            |       |  0.04

Nlocal:          43.75 ave          55 max          34 min
Histogram: 1 0 0 2 3 0 1 0 0 1
Nghost:        3424.88 ave        3476 max        3381 min
Histogram: 4 0 0 0 0 0 0 0 2 2
Neighs:        31673.5 ave       39287 max       25057 min
Histogram: 1 0 0 2 3 0 1 0 0 1

Total # of neighbors = 253388
Ave neighs/atom = 723.96571
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.0085
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 1.70085 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.9 | 122.9 | 124.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   297.5373      -41137.034     -14475.629      3758.8201      15.2382        14.5028        17.0085      
       100   301.73326     -41120.924     -12654.483      3766.3377      15.2382        14.5028        17.042517    
       200   292.23855     -41119.082     -16517.879      3773.8554      15.2382        14.5028        17.076534    
       300   311.45994     -41161.342     -7235.7952      3781.373       15.2382        14.5028        17.110551    
       400   310.10194     -41165.522     -14677.306      3788.8907      15.2382        14.5028        17.144568    
       500   314.53237     -41165.408     -10088.47       3796.4083      15.2382        14.5028        17.178585    
       600   293.9669      -41135.747     -5081.5087      3803.926       15.2382        14.5028        17.212602    
       700   301.0477      -41131.022     -12800.838      3811.4436      15.2382        14.5028        17.246619    
       800   307.3355      -41133.093     -13046.581      3818.9612      15.2382        14.5028        17.280636    
       900   304.66648     -41134.831     -19653.487      3826.4789      15.2382        14.5028        17.314653    
      1000   301.99844     -41146.528     -19070.396      3833.9965      15.2382        14.5028        17.34867     
      1100   283.53309     -41130.037     -21893.327      3841.5142      15.2382        14.5028        17.382687    
      1200   313.41111     -41150.246     -13379.72       3849.0318      15.2382        14.5028        17.416704    
      1300   307.55125     -41109.514     -10963.718      3856.5494      15.2382        14.5028        17.450721    
      1400   298.58596     -41088.421     -15142.464      3864.0671      15.2382        14.5028        17.484738    
      1500   326.45482     -41125.702     -8793.9089      3871.5847      15.2382        14.5028        17.518755    
      1600   300.44647     -41126.636     -17050.051      3879.1024      15.2382        14.5028        17.552772    
      1700   286.09899     -41109.439     -25653.851      3886.62        15.2382        14.5028        17.586789    
      1800   295.45543     -41099.533     -13248.606      3894.1376      15.2382        14.5028        17.620806    
      1900   292.37675     -41078.954     -10724.027      3901.6553      15.2382        14.5028        17.654823    
      2000   338.23725     -41098.774     -10897.661      3909.1729      15.2382        14.5028        17.68884     
      2100   304.41423     -41073.12      -6138.6207      3916.6906      15.2382        14.5028        17.722857    
      2200   285.3592      -41088.911     -12045.121      3924.2082      15.2382        14.5028        17.756874    
      2300   296.93647     -41096.376     -9668.1122      3931.7258      15.2382        14.5028        17.790891    
      2400   298.3143      -41084.106     -12254.557      3939.2435      15.2382        14.5028        17.824908    
      2500   299.87863     -41066.346     -26499.137      3946.7611      15.2382        14.5028        17.858925    
      2600   321.75321     -41069.498     -20040.872      3954.2788      15.2382        14.5028        17.892942    
      2700   303.4823      -41067.671     -32556.814      3961.7964      15.2382        14.5028        17.926959    
      2800   288.13592     -41070.753     -19741.638      3969.314       15.2382        14.5028        17.960976    
      2900   305.09606     -41086.973     -14599.627      3976.8317      15.2382        14.5028        17.994993    
      3000   298.0836      -41079.74      -14861.322      3984.3493      15.2382        14.5028        18.02901     
      3100   311.13598     -41082.211     -25863.112      3991.867       15.2382        14.5028        18.063027    
      3200   301.7585      -41060.217     -7970.3885      3999.3846      15.2382        14.5028        18.097044    
      3300   283.3872      -41046.939     -11001.485      4006.9022      15.2382        14.5028        18.131061    
      3400   318.86563     -41076.565     -13527.783      4014.4199      15.2382        14.5028        18.165078    
      3500   301.17325     -41077.66      -15569.849      4021.9375      15.2382        14.5028        18.199095    
      3600   284.90351     -41066.631     -18441.137      4029.4552      15.2382        14.5028        18.233112    
      3700   283.70048     -41069.736     -23366.516      4036.9728      15.2382        14.5028        18.267129    
      3800   294.41959     -41065.204     -14798.758      4044.4904      15.2382        14.5028        18.301146    
      3900   314.37405     -41060.724     -15095.954      4052.0081      15.2382        14.5028        18.335163    
      4000   316.56011     -41050.843     -19108.872      4059.5257      15.2382        14.5028        18.36918     
      4100   305.00189     -41056.146     -13107.02       4067.0434      15.2382        14.5028        18.403197    
      4200   307.4109      -41079.064     -22251.448      4074.561       15.2382        14.5028        18.437214    
      4300   307.71395     -41079.979     -19199.394      4082.0786      15.2382        14.5028        18.471231    
      4400   305.12035     -41082.605     -18756.934      4089.5963      15.2382        14.5028        18.505248    
      4500   279.8228      -41070.654     -11247.728      4097.1139      15.2382        14.5028        18.539265    
      4600   298.95235     -41070.003     -26261.796      4104.6316      15.2382        14.5028        18.573282    
      4700   317.33405     -41056.111     -23184.632      4112.1492      15.2382        14.5028        18.607299    
      4800   285.5068      -41016.41      -13800.601      4119.6668      15.2382        14.5028        18.641316    
      4900   302.86784     -41055.805     -25844.802      4127.1845      15.2382        14.5028        18.675333    
      5000   290.42255     -41048.829     -22376.334      4134.7021      15.2382        14.5028        18.70935     
Loop time of 228.855 on 8 procs for 5000 steps with 350 atoms

Performance: 0.944 ns/day, 25.428 hours/ns, 21.848 timesteps/s, 7.647 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 135.73     | 167.69     | 192.21     | 171.7 | 73.27
Bond    | 0.0016456  | 0.001975   | 0.002281   |   0.4 |  0.00
Neigh   | 10.374     | 13         | 15.313     |  52.7 |  5.68
Comm    | 2.246      | 26.77      | 58.734     | 429.7 | 11.70
Output  | 0.016925   | 0.019087   | 0.021037   |   1.0 |  0.01
Modify  | 18.951     | 21.277     | 23.9       |  41.3 |  9.30
Other   |            | 0.09594    |            |       |  0.04

Nlocal:          43.75 ave          51 max          39 min
Histogram: 2 1 1 1 1 0 0 0 0 2
Nghost:           2954 ave        3023 max        2902 min
Histogram: 2 0 0 2 0 2 1 0 0 1
Neighs:        25846.6 ave       29879 max       23310 min
Histogram: 2 1 1 2 0 0 0 0 0 2

Total # of neighbors = 206773
Ave neighs/atom = 590.78
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 15.2382
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz--0.642)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*15.2382
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.2626999999999997115, deltaxy = 0.62627
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.4481999999999999873, deltaxz = 0.04482
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6420000000000000151, deltayz = 0.0642
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -1.52382 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.9 | 122.9 | 124.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   297.5373      -41137.034     -14475.629      3758.8201      15.2382        14.5028        17.0085      
       100   301.91272     -41120.534     -12528.61       3758.8201      15.2382        14.5028        17.0085      
       200   290.49934     -41120.436     -16461.131      3758.8201      15.2382        14.5028        17.0085      
       300   313.55517     -41170.194     -4932.3031      3758.8201      15.2382        14.5028        17.0085      
       400   303.27024     -41163.105     -24050.549      3758.8201      15.2382        14.5028        17.0085      
       500   311.87572     -41172.85      -13040.887      3758.8201      15.2382        14.5028        17.0085      
       600   311.3005      -41156.14      -8853.4634      3758.8201      15.2382        14.5028        17.0085      
       700   304.4932      -41139.29      -5188.3185      3758.8201      15.2382        14.5028        17.0085      
       800   305.49898     -41156.387     -5342.8324      3758.8201      15.2382        14.5028        17.0085      
       900   285.48667     -41155.594     -13833.112      3758.8201      15.2382        14.5028        17.0085      
      1000   308.3562      -41172.862     -520.09584      3758.8201      15.2382        14.5028        17.0085      
      1100   320.67505     -41155.408     -10014.224      3758.8201      15.2382        14.5028        17.0085      
      1200   318.63299     -41128.989     -6457.2958      3758.8201      15.2382        14.5028        17.0085      
      1300   321.76063     -41148.201     -14574.587      3758.8201      15.2382        14.5028        17.0085      
      1400   298.54653     -41152.38      -6003.6744      3758.8201      15.2382        14.5028        17.0085      
      1500   290.80513     -41141.5       -97.00828       3758.8201      15.2382        14.5028        17.0085      
      1600   299.2002      -41144.081     -3714.3409      3758.8201      15.2382        14.5028        17.0085      
      1700   299.33943     -41136.952     -1001.6015      3758.8201      15.2382        14.5028        17.0085      
      1800   303.50965     -41142.456     -12427.157      3758.8201      15.2382        14.5028        17.0085      
      1900   295.24826     -41157.609     -7706.6824      3758.8201      15.2382        14.5028        17.0085      
      2000   287.8498      -41160.106     -10136.528      3758.8201      15.2382        14.5028        17.0085      
      2100   305.0822      -41152.435     -13830.435      3758.8201      15.2382        14.5028        17.0085      
      2200   302.60705     -41117.042     -10501.749      3758.8201      15.2382        14.5028        17.0085      
      2300   308.13421     -41126.279     -5334.7998      3758.8201      15.2382        14.5028        17.0085      
      2400   311.24033     -41140.696     -9516.7832      3758.8201      15.2382        14.5028        17.0085      
      2500   297.4349      -41141.436     -504.78614      3758.8201      15.2382        14.5028        17.0085      
      2600   321.25386     -41170.359     -6597.4259      3758.8201      15.2382        14.5028        17.0085      
      2700   298.24192     -41160.041     -16515.559      3758.8201      15.2382        14.5028        17.0085      
      2800   276.89488     -41168.391     -692.3592       3758.8201      15.2382        14.5028        17.0085      
      2900   288.57143     -41179.875     -19296.897      3758.8201      15.2382        14.5028        17.0085      
      3000   305.48406     -41159.715     -20394.54       3758.8201      15.2382        14.5028        17.0085      
      3100   302.20478     -41140.114      2761.3562      3758.8201      15.2382        14.5028        17.0085      
      3200   316.87787     -41143.647     -1610.6957      3758.8201      15.2382        14.5028        17.0085      
      3300   284.68325     -41119.745     -12858.74       3758.8201      15.2382        14.5028        17.0085      
      3400   301.58842     -41152.489     -1630.9889      3758.8201      15.2382        14.5028        17.0085      
      3500   300.29674     -41167.436     -6009.4125      3758.8201      15.2382        14.5028        17.0085      
      3600   282.59458     -41160.839      5533.6726      3758.8201      15.2382        14.5028        17.0085      
      3700   276.24847     -41166.003     -13924.052      3758.8201      15.2382        14.5028        17.0085      
      3800   280.22723     -41154.258     -13060.828      3758.8201      15.2382        14.5028        17.0085      
      3900   301.86047     -41140.861     -14493.017      3758.8201      15.2382        14.5028        17.0085      
      4000   308.17019     -41136.248     -5006.9806      3758.8201      15.2382        14.5028        17.0085      
      4100   286.58239     -41119.306     -4696.7018      3758.8201      15.2382        14.5028        17.0085      
      4200   313.11944     -41141.453     -5183.4653      3758.8201      15.2382        14.5028        17.0085      
      4300   290.14581     -41107.774     -465.16433      3758.8201      15.2382        14.5028        17.0085      
      4400   321.20469     -41133.909     -15396.751      3758.8201      15.2382        14.5028        17.0085      
      4500   291.47987     -41125.982     -16909.731      3758.8201      15.2382        14.5028        17.0085      
      4600   309.33596     -41155.862     -15225.602      3758.8201      15.2382        14.5028        17.0085      
      4700   283.58988     -41134.125     -14723.777      3758.8201      15.2382        14.5028        17.0085      
      4800   305.71295     -41135.145     -16358.802      3758.8201      15.2382        14.5028        17.0085      
      4900   325.88146     -41122.379      1874.281       3758.8201      15.2382        14.5028        17.0085      
      5000   306.44545     -41098.015     -36372.554      3758.8201      15.2382        14.5028        17.0085      
Loop time of 240.399 on 8 procs for 5000 steps with 350 atoms

Performance: 0.899 ns/day, 26.711 hours/ns, 20.799 timesteps/s, 7.280 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 146.47     | 163.27     | 201.43     | 172.1 | 67.92
Bond    | 0.0015091  | 0.0018447  | 0.0021922  |   0.5 |  0.00
Neigh   | 11.69      | 13.559     | 17.956     |  60.5 |  5.64
Comm    | 2.8651     | 41.032     | 57.825     | 343.2 | 17.07
Output  | 0.016124   | 0.018054   | 0.019856   |   0.9 |  0.01
Modify  | 18.003     | 22.423     | 24.32      |  47.3 |  9.33
Other   |            | 0.09229    |            |       |  0.04

Nlocal:          43.75 ave          49 max          34 min
Histogram: 1 0 0 0 1 1 0 1 3 1
Nghost:        3180.75 ave        3206 max        3162 min
Histogram: 2 1 0 1 0 2 0 1 0 1
Neighs:        28542.9 ave       31636 max       22461 min
Histogram: 1 0 0 0 0 2 0 2 2 1

Total # of neighbors = 228343
Ave neighs/atom = 652.40857
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*15.2382
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 1.52382 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121 | 122.9 | 125 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   297.5373      -41137.034     -14475.629      3758.8201      15.2382        14.5028        17.0085      
       100   301.94679     -41120.823     -12621.352      3758.8201      15.2382        14.5028        17.0085      
       200   284.77896     -41116.073     -16471.059      3758.8201      15.2382        14.5028        17.0085      
       300   303.94799     -41167.459     -7701.7941      3758.8201      15.2382        14.5028        17.0085      
       400   308.99344     -41179.157     -17294.38       3758.8201      15.2382        14.5028        17.0085      
       500   307.40684     -41167.271     -4406.8026      3758.8201      15.2382        14.5028        17.0085      
       600   307.57198     -41149.224     -2620.0674      3758.8201      15.2382        14.5028        17.0085      
       700   298.69666     -41130.556     -10232.071      3758.8201      15.2382        14.5028        17.0085      
       800   307.35834     -41167.956     -22741.207      3758.8201      15.2382        14.5028        17.0085      
       900   300.1531      -41179.025     -20050.599      3758.8201      15.2382        14.5028        17.0085      
      1000   299.7847      -41163.622     -2513.8616      3758.8201      15.2382        14.5028        17.0085      
      1100   312.87999     -41156.679     -6622.9655      3758.8201      15.2382        14.5028        17.0085      
      1200   309.02036     -41151.779     -17081.16       3758.8201      15.2382        14.5028        17.0085      
      1300   301.19862     -41145.01      -16484.872      3758.8201      15.2382        14.5028        17.0085      
      1400   292.34955     -41140.458     -4095.5443      3758.8201      15.2382        14.5028        17.0085      
      1500   304.49728     -41176.448     -4197.1683      3758.8201      15.2382        14.5028        17.0085      
      1600   276.28038     -41158.447     -17969.495      3758.8201      15.2382        14.5028        17.0085      
      1700   297.07855     -41168.388      89.039973      3758.8201      15.2382        14.5028        17.0085      
      1800   308.28614     -41151.893     -11976.585      3758.8201      15.2382        14.5028        17.0085      
      1900   320.16424     -41144.086     -762.48481      3758.8201      15.2382        14.5028        17.0085      
      2000   325.03909     -41168.129     -15850.724      3758.8201      15.2382        14.5028        17.0085      
      2100   293.45871     -41147.007     -16913.388      3758.8201      15.2382        14.5028        17.0085      
      2200   303.69505     -41166.122     -5076.5552      3758.8201      15.2382        14.5028        17.0085      
      2300   307.343       -41175.996     -17215.081      3758.8201      15.2382        14.5028        17.0085      
      2400   290.38352     -41158.268     -5950.3848      3758.8201      15.2382        14.5028        17.0085      
      2500   308.62742     -41173.3       -5276.928       3758.8201      15.2382        14.5028        17.0085      
      2600   290.39716     -41140.103     -9687.3968      3758.8201      15.2382        14.5028        17.0085      
      2700   312.70198     -41141.833     -6372.655       3758.8201      15.2382        14.5028        17.0085      
      2800   298.45123     -41125.11      -18458.758      3758.8201      15.2382        14.5028        17.0085      
      2900   293.99892     -41153.98      -10118.47       3758.8201      15.2382        14.5028        17.0085      
      3000   272.14205     -41143.823     -11650.958      3758.8201      15.2382        14.5028        17.0085      
      3100   292.53461     -41156.355     -15906.911      3758.8201      15.2382        14.5028        17.0085      
      3200   295.90525     -41149.328      4162.3728      3758.8201      15.2382        14.5028        17.0085      
      3300   299.38683     -41136.117      3730.9309      3758.8201      15.2382        14.5028        17.0085      
      3400   329.26255     -41158.735     -8329.164       3758.8201      15.2382        14.5028        17.0085      
      3500   327.98068     -41193.701     -10326.39       3758.8201      15.2382        14.5028        17.0085      
      3600   285.48794     -41172.322     -20401.175      3758.8201      15.2382        14.5028        17.0085      
      3700   289.26914     -41175.307     -6114.6952      3758.8201      15.2382        14.5028        17.0085      
      3800   304.72398     -41167.934     -16451.685      3758.8201      15.2382        14.5028        17.0085      
      3900   313.09276     -41158.568     -11443.185      3758.8201      15.2382        14.5028        17.0085      
      4000   324.31036     -41167.681     -2587.5933      3758.8201      15.2382        14.5028        17.0085      
      4100   283.43889     -41162.017     -7071.8891      3758.8201      15.2382        14.5028        17.0085      
      4200   293.89403     -41177.549     -3387.3593      3758.8201      15.2382        14.5028        17.0085      
      4300   293.9381      -41164.743      2937.7755      3758.8201      15.2382        14.5028        17.0085      
      4400   300.14749     -41147.943     -4582.7065      3758.8201      15.2382        14.5028        17.0085      
      4500   320.18613     -41140.91      -4898.4054      3758.8201      15.2382        14.5028        17.0085      
      4600   302.82562     -41129.334     -8502.8591      3758.8201      15.2382        14.5028        17.0085      
      4700   297.73071     -41160.788     -1378.459       3758.8201      15.2382        14.5028        17.0085      
      4800   298.58299     -41168.11      -17083.427      3758.8201      15.2382        14.5028        17.0085      
      4900   290.54476     -41151.078     -8224.5178      3758.8201      15.2382        14.5028        17.0085      
      5000   319.98186     -41154.978     -311.17634      3758.8201      15.2382        14.5028        17.0085      
Loop time of 239.465 on 8 procs for 5000 steps with 350 atoms

Performance: 0.902 ns/day, 26.607 hours/ns, 20.880 timesteps/s, 7.308 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 141.29     | 164.59     | 201.27     | 202.8 | 68.73
Bond    | 0.0014743  | 0.001799   | 0.0020213  |   0.4 |  0.00
Neigh   | 11.161     | 13.184     | 17.008     |  66.5 |  5.51
Comm    | 3.4458     | 40.123     | 63.42      | 410.8 | 16.76
Output  | 0.016308   | 0.018109   | 0.019431   |   0.8 |  0.01
Modify  | 17.609     | 21.45      | 23.489     |  52.4 |  8.96
Other   |            | 0.09408    |            |       |  0.04

Nlocal:          43.75 ave          53 max          37 min
Histogram: 3 0 0 0 2 0 1 1 0 1
Nghost:        3172.88 ave        3265 max        3098 min
Histogram: 2 0 0 1 2 0 2 0 0 1
Neighs:        28458.6 ave       34010 max       24428 min
Histogram: 3 0 0 0 2 0 1 1 0 1

Total # of neighbors = 227669
Ave neighs/atom = 650.48286
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 14.5028
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz--0.4482)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*14.5028
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.2626999999999997115, deltaxy = 0.62627
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.4481999999999999873, deltaxz = 0.04482
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6420000000000000151, deltayz = 0.0642
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -1.45028 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.9 | 122.9 | 124.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   297.5373      -41137.034     -14475.629      3758.8201      15.2382        14.5028        17.0085      
       100   301.87044     -41120.524     -12554.611      3758.8201      15.2382        14.5028        17.0085      
       200   289.52349     -41121.113     -16434.318      3758.8201      15.2382        14.5028        17.0085      
       300   304.37609     -41166.906     -13270.245      3758.8201      15.2382        14.5028        17.0085      
       400   304.32873     -41173.063     -16764.247      3758.8201      15.2382        14.5028        17.0085      
       500   299.6176      -41160.507     -5258.8902      3758.8201      15.2382        14.5028        17.0085      
       600   307.25636     -41146.515     -3435.6983      3758.8201      15.2382        14.5028        17.0085      
       700   299.41136     -41132.92      -14942.245      3758.8201      15.2382        14.5028        17.0085      
       800   287.09698     -41147.734     -5676.8936      3758.8201      15.2382        14.5028        17.0085      
       900   283.09939     -41163.063     -16295.263      3758.8201      15.2382        14.5028        17.0085      
      1000   279.95444     -41142.26      -4211.8305      3758.8201      15.2382        14.5028        17.0085      
      1100   312.8176      -41158.815     -12111.039      3758.8201      15.2382        14.5028        17.0085      
      1200   286.35778     -41129.91      -18718.364      3758.8201      15.2382        14.5028        17.0085      
      1300   296.65004     -41142.911      1447.6795      3758.8201      15.2382        14.5028        17.0085      
      1400   292.25371     -41139.051     -10348.516      3758.8201      15.2382        14.5028        17.0085      
      1500   309.66903     -41167.166     -19392.815      3758.8201      15.2382        14.5028        17.0085      
      1600   297.61234     -41159.667     -7635.8649      3758.8201      15.2382        14.5028        17.0085      
      1700   320.04248     -41167.847     -3849.9948      3758.8201      15.2382        14.5028        17.0085      
      1800   299.36312     -41141.013     -18436.131      3758.8201      15.2382        14.5028        17.0085      
      1900   305.94176     -41179.862     -23227.349      3758.8201      15.2382        14.5028        17.0085      
      2000   294.92971     -41177.791     -14811.08       3758.8201      15.2382        14.5028        17.0085      
      2100   285.38647     -41163.366      1005.5115      3758.8201      15.2382        14.5028        17.0085      
      2200   314.84703     -41166.372     -5335.5281      3758.8201      15.2382        14.5028        17.0085      
      2300   321.78619     -41161.919     -22265.454      3758.8201      15.2382        14.5028        17.0085      
      2400   311.91498     -41160.21      -9980.5641      3758.8201      15.2382        14.5028        17.0085      
      2500   302.8153      -41169.228     -11950.557      3758.8201      15.2382        14.5028        17.0085      
      2600   287.66598     -41162.874      5799.8168      3758.8201      15.2382        14.5028        17.0085      
      2700   281.80386     -41151.669     -4802.2782      3758.8201      15.2382        14.5028        17.0085      
      2800   294.98979     -41161.976     -24295.568      3758.8201      15.2382        14.5028        17.0085      
      2900   307.91007     -41159.621     -18219.194      3758.8201      15.2382        14.5028        17.0085      
      3000   305.76549     -41148.606     -4964.9139      3758.8201      15.2382        14.5028        17.0085      
      3100   297.62419     -41151.132     -12318.526      3758.8201      15.2382        14.5028        17.0085      
      3200   296.78607     -41175.741      1180.0596      3758.8201      15.2382        14.5028        17.0085      
      3300   296.81449     -41181.524     -5864.9363      3758.8201      15.2382        14.5028        17.0085      
      3400   290.73387     -41156.921     -8363.2211      3758.8201      15.2382        14.5028        17.0085      
      3500   297.95051     -41151.447     -15068.416      3758.8201      15.2382        14.5028        17.0085      
      3600   307.86551     -41159.133     -9831.0589      3758.8201      15.2382        14.5028        17.0085      
      3700   297.58513     -41154.718     -9540.7848      3758.8201      15.2382        14.5028        17.0085      
      3800   279.84737     -41151.707     -14520.108      3758.8201      15.2382        14.5028        17.0085      
      3900   292.55721     -41170.633     -17697.68       3758.8201      15.2382        14.5028        17.0085      
      4000   290.49839     -41184.509     -24338.836      3758.8201      15.2382        14.5028        17.0085      
      4100   281.62754     -41183.159     -8516.2452      3758.8201      15.2382        14.5028        17.0085      
      4200   299.48796     -41169.223     -5581.4866      3758.8201      15.2382        14.5028        17.0085      
      4300   304.94752     -41155.67       4316.9876      3758.8201      15.2382        14.5028        17.0085      
      4400   311.29435     -41161.084     -6193.9937      3758.8201      15.2382        14.5028        17.0085      
      4500   296.36807     -41157.39      -12419.982      3758.8201      15.2382        14.5028        17.0085      
      4600   289.27244     -41187.075     -10858.683      3758.8201      15.2382        14.5028        17.0085      
      4700   285.20709     -41186.163     -11038.039      3758.8201      15.2382        14.5028        17.0085      
      4800   290.87146     -41168.072     -3817.3372      3758.8201      15.2382        14.5028        17.0085      
      4900   299.67185     -41158.658      564.3716       3758.8201      15.2382        14.5028        17.0085      
      5000   282.21327     -41130.199     -12299.357      3758.8201      15.2382        14.5028        17.0085      
Loop time of 239.303 on 8 procs for 5000 steps with 350 atoms

Performance: 0.903 ns/day, 26.589 hours/ns, 20.894 timesteps/s, 7.313 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 141.73     | 165.06     | 202.04     | 206.2 | 68.97
Bond    | 0.0015914  | 0.0018425  | 0.0022191  |   0.5 |  0.00
Neigh   | 11.492     | 13.61      | 17.309     |  68.6 |  5.69
Comm    | 2.0777     | 39.053     | 62.373     | 423.9 | 16.32
Output  | 0.01516    | 0.01711    | 0.018413   |   0.9 |  0.01
Modify  | 17.747     | 21.472     | 23.57      |  55.0 |  8.97
Other   |            | 0.09195    |            |       |  0.04

Nlocal:          43.75 ave          48 max          35 min
Histogram: 1 0 0 1 1 0 0 1 1 3
Nghost:        3174.88 ave        3216 max        3144 min
Histogram: 2 1 0 0 2 1 0 1 0 1
Neighs:          28513 ave       31270 max       23146 min
Histogram: 1 0 0 1 1 0 0 1 2 2

Total # of neighbors = 228104
Ave neighs/atom = 651.72571
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*14.5028
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 1.45028 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121 | 122.9 | 125 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   297.5373      -41137.034     -14475.629      3758.8201      15.2382        14.5028        17.0085      
       100   301.96132     -41120.849     -12582.451      3758.8201      15.2382        14.5028        17.0085      
       200   284.02244     -41115.302     -16702.894      3758.8201      15.2382        14.5028        17.0085      
       300   305.58703     -41165.495     -7719.2431      3758.8201      15.2382        14.5028        17.0085      
       400   300.5786      -41165.875     -16351.135      3758.8201      15.2382        14.5028        17.0085      
       500   317.0557      -41175.388      5770.207       3758.8201      15.2382        14.5028        17.0085      
       600   308.51417     -41147.253      2519.8411      3758.8201      15.2382        14.5028        17.0085      
       700   301.47895     -41129.774     -3270.1883      3758.8201      15.2382        14.5028        17.0085      
       800   298.26709     -41146.69      -22364.24       3758.8201      15.2382        14.5028        17.0085      
       900   281.95209     -41156.244     -11188.967      3758.8201      15.2382        14.5028        17.0085      
      1000   290.57892     -41159.132     -11601.272      3758.8201      15.2382        14.5028        17.0085      
      1100   319.32441     -41166.736     -13649.026      3758.8201      15.2382        14.5028        17.0085      
      1200   318.10851     -41153.028     -12411.571      3758.8201      15.2382        14.5028        17.0085      
      1300   303.98427     -41151.11      -2679.0756      3758.8201      15.2382        14.5028        17.0085      
      1400   279.32638     -41151.773     -7795.0434      3758.8201      15.2382        14.5028        17.0085      
      1500   288.56502     -41165.696     -7226.217       3758.8201      15.2382        14.5028        17.0085      
      1600   296.50875     -41147.94      -2522.5878      3758.8201      15.2382        14.5028        17.0085      
      1700   307.77277     -41140.045     -9538.1756      3758.8201      15.2382        14.5028        17.0085      
      1800   319.02525     -41152.566     -22473.504      3758.8201      15.2382        14.5028        17.0085      
      1900   291.80663     -41137.285     -858.3198       3758.8201      15.2382        14.5028        17.0085      
      2000   289.51654     -41141.459     -7193.2834      3758.8201      15.2382        14.5028        17.0085      
      2100   296.89075     -41142.342      5077.8019      3758.8201      15.2382        14.5028        17.0085      
      2200   310.70817     -41159.689     -13166.97       3758.8201      15.2382        14.5028        17.0085      
      2300   277.92118     -41132.561     -7424.106       3758.8201      15.2382        14.5028        17.0085      
      2400   292.66942     -41152.929     -7541.7957      3758.8201      15.2382        14.5028        17.0085      
      2500   295.13004     -41136.65       1081.3551      3758.8201      15.2382        14.5028        17.0085      
      2600   318.38112     -41134.119      881.36989      3758.8201      15.2382        14.5028        17.0085      
      2700   305.93117     -41119.585     -11554.171      3758.8201      15.2382        14.5028        17.0085      
      2800   301.2539      -41139.77      -9564.4614      3758.8201      15.2382        14.5028        17.0085      
      2900   316.58936     -41174.073     -14046.462      3758.8201      15.2382        14.5028        17.0085      
      3000   287.67304     -41143.578     -15930.535      3758.8201      15.2382        14.5028        17.0085      
      3100   313.40695     -41150.187     -9657.8616      3758.8201      15.2382        14.5028        17.0085      
      3200   324.46783     -41147.01      -9563.1016      3758.8201      15.2382        14.5028        17.0085      
      3300   303.28069     -41144.428     -5439.1749      3758.8201      15.2382        14.5028        17.0085      
      3400   281.81948     -41155.883     -18316.515      3758.8201      15.2382        14.5028        17.0085      
      3500   301.90913     -41163.12      -7250.3935      3758.8201      15.2382        14.5028        17.0085      
      3600   291.61392     -41133.013     -2805.7767      3758.8201      15.2382        14.5028        17.0085      
      3700   297.87226     -41125.673     -11234.685      3758.8201      15.2382        14.5028        17.0085      
      3800   324.25746     -41132.106     -17701.902      3758.8201      15.2382        14.5028        17.0085      
      3900   343.74219     -41133.62      -6815.921       3758.8201      15.2382        14.5028        17.0085      
      4000   295.06346     -41116.926     -9022.9068      3758.8201      15.2382        14.5028        17.0085      
      4100   308.94324     -41153.782     -2332.5174      3758.8201      15.2382        14.5028        17.0085      
      4200   294.70015     -41155.427     -13888.04       3758.8201      15.2382        14.5028        17.0085      
      4300   281.21167     -41146.515     -10857.714      3758.8201      15.2382        14.5028        17.0085      
      4400   288.15117     -41133.213     -11558.106      3758.8201      15.2382        14.5028        17.0085      
      4500   301.0349      -41112.851     -14616.659      3758.8201      15.2382        14.5028        17.0085      
      4600   307.41007     -41119.093     -15186.139      3758.8201      15.2382        14.5028        17.0085      
      4700   324.664       -41159.988     -11624.017      3758.8201      15.2382        14.5028        17.0085      
      4800   288.95381     -41135.908     -15075.867      3758.8201      15.2382        14.5028        17.0085      
      4900   297.33351     -41149.801     -3210.372       3758.8201      15.2382        14.5028        17.0085      
      5000   295.21384     -41139.078      688.83469      3758.8201      15.2382        14.5028        17.0085      
Loop time of 241.218 on 8 procs for 5000 steps with 350 atoms

Performance: 0.895 ns/day, 26.802 hours/ns, 20.728 timesteps/s, 7.255 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 144.69     | 171.24     | 202.38     | 189.1 | 70.99
Bond    | 0.0015896  | 0.0018978  | 0.0021541  |   0.4 |  0.00
Neigh   | 11.203     | 13.873     | 17.135     |  61.8 |  5.75
Comm    | 2.7575     | 33.901     | 60.442     | 424.9 | 14.05
Output  | 0.020599   | 0.023206   | 0.025583   |   1.2 |  0.01
Modify  | 18.81      | 22.085     | 24.772     |  49.4 |  9.16
Other   |            | 0.09614    |            |       |  0.04

Nlocal:          43.75 ave          52 max          36 min
Histogram: 1 2 0 0 2 0 1 0 0 2
Nghost:        3169.25 ave        3250 max        3099 min
Histogram: 3 0 1 0 0 0 1 1 0 2
Neighs:        28490.5 ave       33498 max       23908 min
Histogram: 1 2 0 0 2 0 1 0 0 2

Total # of neighbors = 227924
Ave neighs/atom = 651.21143
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.0085
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--6.2627)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.0085
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.2626999999999997115, deltaxy = 0.62627
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.4481999999999999873, deltaxz = 0.04482
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6420000000000000151, deltayz = 0.0642
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -1.70085 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.9 | 122.9 | 124.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   297.5373      -41137.034     -14475.629      3758.8201      15.2382        14.5028        17.0085      
       100   302.06106     -41120.797     -12625.693      3758.8201      15.2382        14.5028        17.0085      
       200   283.03767     -41113.565     -19799.312      3758.8201      15.2382        14.5028        17.0085      
       300   301.50443     -41161.04      -7077.953       3758.8201      15.2382        14.5028        17.0085      
       400   299.20879     -41162.682     -18715.898      3758.8201      15.2382        14.5028        17.0085      
       500   313.70968     -41168.56      -6825.0233      3758.8201      15.2382        14.5028        17.0085      
       600   314.71349     -41163.402     -3702.6668      3758.8201      15.2382        14.5028        17.0085      
       700   284.10666     -41147.158     -20025.845      3758.8201      15.2382        14.5028        17.0085      
       800   302.59447     -41185.471     -10819.484      3758.8201      15.2382        14.5028        17.0085      
       900   276.1841      -41159.975     -16606.564      3758.8201      15.2382        14.5028        17.0085      
      1000   306.86309     -41166.032     -10263.573      3758.8201      15.2382        14.5028        17.0085      
      1100   303.9528      -41139.419     -15328.682      3758.8201      15.2382        14.5028        17.0085      
      1200   310.2154      -41137.831     -11430.862      3758.8201      15.2382        14.5028        17.0085      
      1300   282.61759     -41156.816      2050.6252      3758.8201      15.2382        14.5028        17.0085      
      1400   298.56847     -41177.801     -22745.643      3758.8201      15.2382        14.5028        17.0085      
      1500   298.83156     -41181.491      2746.5244      3758.8201      15.2382        14.5028        17.0085      
      1600   317.02386     -41189.657     -9637.9189      3758.8201      15.2382        14.5028        17.0085      
      1700   298.06665     -41166.112     -8964.4541      3758.8201      15.2382        14.5028        17.0085      
      1800   309.49059     -41183.886     -2944.137       3758.8201      15.2382        14.5028        17.0085      
      1900   293.82333     -41190.573     -17747.629      3758.8201      15.2382        14.5028        17.0085      
      2000   298.37296     -41195.077     -11007.065      3758.8201      15.2382        14.5028        17.0085      
      2100   308.57999     -41179.927     -9080.9521      3758.8201      15.2382        14.5028        17.0085      
      2200   322.63873     -41162.643     -6196.7525      3758.8201      15.2382        14.5028        17.0085      
      2300   311.08827     -41148.431     -11896.211      3758.8201      15.2382        14.5028        17.0085      
      2400   289.65191     -41165.533     -9326.1238      3758.8201      15.2382        14.5028        17.0085      
      2500   273.97697     -41165.983     -3788.4527      3758.8201      15.2382        14.5028        17.0085      
      2600   280.6173      -41156.984     -4205.7376      3758.8201      15.2382        14.5028        17.0085      
      2700   293.51235     -41140.874     -4210.6206      3758.8201      15.2382        14.5028        17.0085      
      2800   311.67294     -41150.474     -7583.402       3758.8201      15.2382        14.5028        17.0085      
      2900   295.37137     -41152.241     -6341.5661      3758.8201      15.2382        14.5028        17.0085      
      3000   285.16384     -41158.99       4926.5695      3758.8201      15.2382        14.5028        17.0085      
      3100   303.71069     -41178.693     -12738.319      3758.8201      15.2382        14.5028        17.0085      
      3200   298.82539     -41173.731     -3160.5533      3758.8201      15.2382        14.5028        17.0085      
      3300   299.67942     -41161.727     -7211.2136      3758.8201      15.2382        14.5028        17.0085      
      3400   309.66511     -41136.695     -13533.878      3758.8201      15.2382        14.5028        17.0085      
      3500   310.38717     -41135.998      4324.2641      3758.8201      15.2382        14.5028        17.0085      
      3600   318.21835     -41172.262     -12296.52       3758.8201      15.2382        14.5028        17.0085      
      3700   301.39262     -41162.262     -1423.9111      3758.8201      15.2382        14.5028        17.0085      
      3800   285.72642     -41144.721     -20313.684      3758.8201      15.2382        14.5028        17.0085      
      3900   301.79532     -41152.487     -9482.8092      3758.8201      15.2382        14.5028        17.0085      
      4000   317.61332     -41140.332     -4605.7618      3758.8201      15.2382        14.5028        17.0085      
      4100   316.31367     -41125.515     -6859.54        3758.8201      15.2382        14.5028        17.0085      
      4200   292.64051     -41134.462     -9703.0307      3758.8201      15.2382        14.5028        17.0085      
      4300   302.83226     -41153.533     -11164.212      3758.8201      15.2382        14.5028        17.0085      
      4400   292.94564     -41144.257     -10416.923      3758.8201      15.2382        14.5028        17.0085      
      4500   292.6825      -41155.139     -3563.0155      3758.8201      15.2382        14.5028        17.0085      
      4600   279.93551     -41148.716     -15210.5        3758.8201      15.2382        14.5028        17.0085      
      4700   267.12579     -41126.015      267.30458      3758.8201      15.2382        14.5028        17.0085      
      4800   315.10297     -41131.821     -5335.8183      3758.8201      15.2382        14.5028        17.0085      
      4900   310.70192     -41115.653     -15571.449      3758.8201      15.2382        14.5028        17.0085      
      5000   295.48162     -41121.764     -14677.345      3758.8201      15.2382        14.5028        17.0085      
Loop time of 247.509 on 8 procs for 5000 steps with 350 atoms

Performance: 0.873 ns/day, 27.501 hours/ns, 20.201 timesteps/s, 7.070 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 145.99     | 175.68     | 207.33     | 220.4 | 70.98
Bond    | 0.00164    | 0.0019327  | 0.002228   |   0.5 |  0.00
Neigh   | 11.693     | 14.507     | 17.783     |  66.8 |  5.86
Comm    | 2.7864     | 34.433     | 64.115     | 497.7 | 13.91
Output  | 0.01788    | 0.020197   | 0.021775   |   1.0 |  0.01
Modify  | 19.469     | 22.772     | 25.612     |  53.8 |  9.20
Other   |            | 0.09621    |            |       |  0.04

Nlocal:          43.75 ave          51 max          36 min
Histogram: 1 1 0 0 3 0 0 1 0 2
Nghost:         3281.5 ave        3341 max        3221 min
Histogram: 2 0 1 1 0 0 0 1 1 2
Neighs:        28501.6 ave       32841 max       23751 min
Histogram: 1 1 0 1 2 0 0 1 0 2

Total # of neighbors = 228013
Ave neighs/atom = 651.46571
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.0085
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 1.70085 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121 | 122.9 | 125 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   297.5373      -41137.034     -14475.629      3758.8201      15.2382        14.5028        17.0085      
       100   301.87053     -41120.792     -12487.544      3758.8201      15.2382        14.5028        17.0085      
       200   286.98424     -41116.73      -12388.751      3758.8201      15.2382        14.5028        17.0085      
       300   308.53423     -41162.345     -5385.5796      3758.8201      15.2382        14.5028        17.0085      
       400   307.1894      -41165.052     -23436.861      3758.8201      15.2382        14.5028        17.0085      
       500   312.53715     -41171.19      -4655.4722      3758.8201      15.2382        14.5028        17.0085      
       600   318.94541     -41162.137     -6898.1705      3758.8201      15.2382        14.5028        17.0085      
       700   302.92816     -41131.919     -11516.277      3758.8201      15.2382        14.5028        17.0085      
       800   309.74472     -41145.086     -6391.0992      3758.8201      15.2382        14.5028        17.0085      
       900   293.52055     -41152.262     -17259.145      3758.8201      15.2382        14.5028        17.0085      
      1000   279.90043     -41147.704     -4276.0491      3758.8201      15.2382        14.5028        17.0085      
      1100   309.01537     -41168.734     -9596.026       3758.8201      15.2382        14.5028        17.0085      
      1200   319.86798     -41143.693     -15247.009      3758.8201      15.2382        14.5028        17.0085      
      1300   314.47414     -41124.22      -2887.0658      3758.8201      15.2382        14.5028        17.0085      
      1400   292.02129     -41126.275     -7578.292       3758.8201      15.2382        14.5028        17.0085      
      1500   284.70203     -41135.87      -12870.339      3758.8201      15.2382        14.5028        17.0085      
      1600   321.93987     -41163.886     -6185.2662      3758.8201      15.2382        14.5028        17.0085      
      1700   316.8012      -41159.577     -4927.5493      3758.8201      15.2382        14.5028        17.0085      
      1800   297.79657     -41168.693      728.99211      3758.8201      15.2382        14.5028        17.0085      
      1900   310.08991     -41194.618     -10870.796      3758.8201      15.2382        14.5028        17.0085      
      2000   292.38968     -41170.611     -17968.089      3758.8201      15.2382        14.5028        17.0085      
      2100   288.81474     -41161.229     -2831.7872      3758.8201      15.2382        14.5028        17.0085      
      2200   309.71991     -41165.818     -9076.57        3758.8201      15.2382        14.5028        17.0085      
      2300   314.47968     -41171.051     -12449.78       3758.8201      15.2382        14.5028        17.0085      
      2400   287.35799     -41160.093     -10944.643      3758.8201      15.2382        14.5028        17.0085      
      2500   274.84641     -41165.125     -13428.496      3758.8201      15.2382        14.5028        17.0085      
      2600   278.98307     -41168.071     -13201.873      3758.8201      15.2382        14.5028        17.0085      
      2700   324.26597     -41175.888      1772.1874      3758.8201      15.2382        14.5028        17.0085      
      2800   308.07142     -41137.515     -15474.868      3758.8201      15.2382        14.5028        17.0085      
      2900   333.67519     -41176.39      -15055.86       3758.8201      15.2382        14.5028        17.0085      
      3000   305.69535     -41162.002     -9246.1726      3758.8201      15.2382        14.5028        17.0085      
      3100   285.54162     -41149.618     -16704.598      3758.8201      15.2382        14.5028        17.0085      
      3200   302.87286     -41176.26       2106.7327      3758.8201      15.2382        14.5028        17.0085      
      3300   291.21705     -41184.874     -11075.852      3758.8201      15.2382        14.5028        17.0085      
      3400   270.99484     -41168.397     -12612.379      3758.8201      15.2382        14.5028        17.0085      
      3500   302.29764     -41171.827     -13468.803      3758.8201      15.2382        14.5028        17.0085      
      3600   298.69867     -41139.122     -9556.3314      3758.8201      15.2382        14.5028        17.0085      
      3700   317.47981     -41158.448     -12216.909      3758.8201      15.2382        14.5028        17.0085      
      3800   273.30068     -41128.372     -15618.968      3758.8201      15.2382        14.5028        17.0085      
      3900   291.59563     -41152         -10207.009      3758.8201      15.2382        14.5028        17.0085      
      4000   286.11944     -41139.471      4129.9416      3758.8201      15.2382        14.5028        17.0085      
      4100   296.53591     -41152.992     -17107.579      3758.8201      15.2382        14.5028        17.0085      
      4200   292.65195     -41167.488     -14088.799      3758.8201      15.2382        14.5028        17.0085      
      4300   287.27565     -41168.88      -5771.0066      3758.8201      15.2382        14.5028        17.0085      
      4400   294.7537      -41156.835     -4047.2122      3758.8201      15.2382        14.5028        17.0085      
      4500   309.58179     -41141.66      -14109.299      3758.8201      15.2382        14.5028        17.0085      
      4600   327.46168     -41150.605     -24101.499      3758.8201      15.2382        14.5028        17.0085      
      4700   301.27951     -41154.44      -8740.2077      3758.8201      15.2382        14.5028        17.0085      
      4800   308.3584      -41166.386     -8336.6813      3758.8201      15.2382        14.5028        17.0085      
      4900   290.37829     -41149.689     -20864.054      3758.8201      15.2382        14.5028        17.0085      
      5000   296.9269      -41151.784     -9420.1551      3758.8201      15.2382        14.5028        17.0085      
Loop time of 223.768 on 8 procs for 5000 steps with 350 atoms

Performance: 0.965 ns/day, 24.863 hours/ns, 22.345 timesteps/s, 7.821 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 131.08     | 153.75     | 186.31     | 198.4 | 68.71
Bond    | 0.0014381  | 0.0016788  | 0.0019807  |   0.4 |  0.00
Neigh   | 10.936     | 13.05      | 16.588     |  66.5 |  5.83
Comm    | 2.8893     | 35.452     | 58.109     | 413.1 | 15.84
Output  | 0.015315   | 0.01712    | 0.01839    |   0.9 |  0.01
Modify  | 17.844     | 21.409     | 23.549     |  52.3 |  9.57
Other   |            | 0.08845    |            |       |  0.04

Nlocal:          43.75 ave          53 max          38 min
Histogram: 1 1 2 1 1 0 1 0 0 1
Nghost:        3082.38 ave        3135 max        3028 min
Histogram: 1 0 2 0 0 2 1 0 0 2
Neighs:          28497 ave       34102 max       24511 min
Histogram: 1 1 0 3 0 1 1 0 0 1

Total # of neighbors = 227976
Ave neighs/atom = 651.36
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:52:43
