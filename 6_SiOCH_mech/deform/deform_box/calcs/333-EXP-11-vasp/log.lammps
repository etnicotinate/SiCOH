LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 30*${nthermo}       # steps of equilibration run 10
variable nequil equal 30*100       
variable nrun equal 30*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 30*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-EXP-11-vasp
read_data       ${structure}.data
read_data       333-EXP-11-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.008 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.364 | 6.364 | 6.364 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 8.31287e-05 on 8 procs for 1 steps with 274 atoms

53.1% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 9.08e-07   | 1.9471e-06 | 3.213e-06  |   0.0 |  2.34
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 2.515e-06  | 4.2599e-06 | 6.007e-06  |   0.0 |  5.12
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 7.692e-05  |            |       | 92.53

Nlocal:          34.25 ave          40 max          23 min
Histogram: 1 0 0 0 0 0 2 3 1 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-EXP-11-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
run ${nequil}
run 3000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -8.2 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109.8 | 110.8 | 111.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -29524.072      53373.102      1.4594291      3472.1201    
       100   940.83325     -30895.433     -22221.566      1.4594291      3472.1201    
       200   655.32859     -31410.555     -8415.0945      1.4594291      3472.1201    
       300   492.44705     -31703.584     -1794.1004      1.4594291      3472.1201    
       400   382.80684     -31863.571     -399.08344      1.4594291      3472.1201    
       500   340.51122     -31988.881     -4396.9622      1.4594291      3472.1201    
       600   278.76054     -32030.093     -12030.124      1.4594291      3472.1201    
       700   252.54387     -32039.073     -16008.085      1.4594291      3472.1201    
       800   303.17696     -32059.227     -7196.0812      1.4594291      3472.1201    
       900   316.31868     -32035.623      1880.9547      1.4594291      3472.1201    
      1000   302.25251     -32011.681      399.58501      1.4594291      3472.1201    
      1100   315.72134     -32030.621     -1937.705       1.4594291      3472.1201    
      1200   304.92451     -32062.996     -4858.2292      1.4594291      3472.1201    
      1300   271.27974     -32068.968     -12188.651      1.4594291      3472.1201    
      1400   282.30555     -32083.975     -5263.1535      1.4594291      3472.1201    
      1500   284.15138     -32063.957     -2027.0405      1.4594291      3472.1201    
      1600   304.84901     -32054.903     -8468.5027      1.4594291      3472.1201    
      1700   320.05144     -32056.724     -12833.076      1.4594291      3472.1201    
      1800   304.8515      -32060.022     -6647.9777      1.4594291      3472.1201    
      1900   292.71773     -32083.757     -1193.4113      1.4594291      3472.1201    
      2000   272.13786     -32083.142      6047.8677      1.4594291      3472.1201    
      2100   289.96718     -32084.631      9390.5456      1.4594291      3472.1201    
      2200   287.75492     -32058.426     -9151.3398      1.4594291      3472.1201    
      2300   335.25197     -32079.165     -16200.698      1.4594291      3472.1201    
      2400   310.32653     -32067.983      2160.6232      1.4594291      3472.1201    
      2500   290.62987     -32076.478     -2874.5909      1.4594291      3472.1201    
      2600   291.63604     -32096.204      1291.0485      1.4594291      3472.1201    
      2700   278.45821     -32085.212      2152.4342      1.4594291      3472.1201    
      2800   295.16014     -32075.293      11384.18       1.4594291      3472.1201    
      2900   321.3704      -32074.659      4968.7777      1.4594291      3472.1201    
      3000   317.98161     -32069.827      4987.1493      1.4594291      3472.1201    
Loop time of 112.599 on 8 procs for 3000 steps with 274 atoms

Performance: 1.151 ns/day, 20.852 hours/ns, 26.643 timesteps/s, 7.300 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 62.829     | 83.209     | 94.292     | 133.2 | 73.90
Bond    | 0.0083958  | 0.0088284  | 0.0096022  |   0.5 |  0.01
Neigh   | 4.7967     | 6.0336     | 6.7799     |  31.7 |  5.36
Comm    | 1.6698     | 12.755     | 33.148     | 340.3 | 11.33
Output  | 0.0014725  | 0.0016088  | 0.0024535  |   0.8 |  0.00
Modify  | 9.785      | 10.525     | 11.756     |  24.0 |  9.35
Other   |            | 0.06521    |            |       |  0.06

Nlocal:          34.25 ave          44 max          19 min
Histogram: 1 0 0 1 0 1 0 4 0 1
Nghost:        2825.62 ave        2855 max        2798 min
Histogram: 1 1 1 0 1 1 0 2 0 1
Neighs:        18936.9 ave       24035 max       10743 min
Histogram: 1 0 0 1 0 1 0 4 0 1

Total # of neighbors = 151495
Ave neighs/atom = 552.90146
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333-EXP-11-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.8189
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 12.842
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 16.0755

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.4312
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 1.195
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -8.3798

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 16.8189
variable dlen equal lx-${len0}
variable dlen equal lx-16.8189
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.8189
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.168189 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.168189 xy delta 0.083798 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.168189 xy delta 0.083798 xz delta -0.01195 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 110.2 | 111.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   317.98161     -32069.827      4987.0995      1.4594291      3472.1201    
       100   315.67948     -32093.181     -2921.9207      1.4599157      3470.9628    
       200   272.69871     -32080.371     -4914.8958      1.4604027      3469.8054    
       300   294.04078     -32093.635     -4201.3419      1.46089        3468.648     
       400   306.76498     -32083.817     -4027.3478      1.4613776      3467.4906    
       500   296.31445     -32065.332      2064.9743      1.4618655      3466.3333    
       600   292.10293     -32068.646      1073.1852      1.4623538      3465.1759    
       700   292.4886      -32082.187     -4025.656       1.4628424      3464.0185    
       800   304.45972     -32103.783     -2028.7589      1.4633313      3462.8612    
       900   298.84579     -32097.819     -4580.8298      1.4638206      3461.7038    
      1000   293.22276     -32074.203     -3169.0159      1.4643101      3460.5464    
      1100   323.14858     -32083.694      4752.5304      1.4648         3459.389     
      1200   292.56232     -32059.695     -15612.384      1.4652903      3458.2317    
      1300   308.67614     -32087.921     -2254.0165      1.4657808      3457.0743    
      1400   282.37929     -32086.391     -1630.995       1.4662717      3455.9169    
      1500   288.54795     -32096.778     -3864.0641      1.4667629      3454.7595    
      1600   302.35178     -32096.528      1908.1836      1.4672545      3453.6022    
      1700   314.40271     -32089.106     -17855.336      1.4677463      3452.4448    
      1800   311.18204     -32077.944      976.22074      1.4682385      3451.2874    
      1900   302.76961     -32089.027      3621.9231      1.4687311      3450.13      
      2000   292.90581     -32102.34      -868.258        1.4692239      3448.9727    
      2100   292.71082     -32107.114     -11112.805      1.4697171      3447.8153    
      2200   296.76249     -32101.798     -2311.1122      1.4702106      3446.6579    
      2300   289.28301     -32074.656      952.79694      1.4707045      3445.5006    
      2400   322.67358     -32085.933     -10040.964      1.4711987      3444.3432    
      2500   312.15569     -32082.711     -2401.9293      1.4716932      3443.1858    
      2600   290.77712     -32092.69      -7884.552       1.4721881      3442.0284    
      2700   284.46392     -32102.342     -6925.7738      1.4726832      3440.8711    
      2800   293.39354     -32100.668      7753.1003      1.4731788      3439.7137    
      2900   304.63038     -32082.798     -1027.1079      1.4736746      3438.5563    
      3000   318.50317     -32078.379      7295.4605      1.4741708      3437.3989    
Loop time of 115.864 on 8 procs for 3000 steps with 274 atoms

Performance: 1.119 ns/day, 21.456 hours/ns, 25.893 timesteps/s, 7.095 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.207     | 85.522     | 96.833     | 142.4 | 73.81
Bond    | 0.0084901  | 0.0090978  | 0.0097163  |   0.4 |  0.01
Neigh   | 4.807      | 6.1091     | 6.8419     |  33.9 |  5.27
Comm    | 2.0776     | 13.399     | 35.722     | 359.8 | 11.56
Output  | 0.0082135  | 0.0096298  | 0.010885   |   0.9 |  0.01
Modify  | 10.009     | 10.744     | 12.049     |  25.5 |  9.27
Other   |            | 0.0706     |            |       |  0.06

Nlocal:          34.25 ave          42 max          23 min
Histogram: 1 1 0 1 0 0 0 2 2 1
Nghost:        2836.75 ave        2857 max        2812 min
Histogram: 1 0 1 1 1 0 1 1 0 2
Neighs:        19112.2 ave       23145 max       13086 min
Histogram: 1 1 0 1 0 0 0 1 1 3

Total # of neighbors = 152898
Ave neighs/atom = 558.0219
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.8189
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.168189 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.168189 xy delta -0.083798 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.168189 xy delta -0.083798 xz delta 0.01195 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 110.2 | 111.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   317.98161     -32069.827      4987.0995      1.4594291      3472.1201    
       100   315.72099     -32093.211     -2917.4376      1.4589428      3473.2775    
       200   273.48312     -32080.423     -8507.0559      1.4584568      3474.4349    
       300   290.57358     -32089.644     -4803.1151      1.4579711      3475.5923    
       400   301.05582     -32077.429     -201.71404      1.4574858      3476.7496    
       500   296.67989     -32065.723     -929.15659      1.4570008      3477.907     
       600   298.2891      -32078.464     -4744.9713      1.4565161      3479.0644    
       700   266.66815     -32070.62      -10556.138      1.4560317      3480.2218    
       800   292.08653     -32096.761     -99.996681      1.4555476      3481.3791    
       900   293.46503     -32088.615     -8914.6839      1.4550639      3482.5365    
      1000   302.7288      -32072.772      5396.3791      1.4545805      3483.6939    
      1100   329.34008     -32087.465      876.93984      1.4540974      3484.8512    
      1200   286.95406     -32072.418     -12531.693      1.4536146      3486.0086    
      1300   306.4885      -32102.635      2077.131       1.4531322      3487.166     
      1400   275.90681     -32085.915     -1813.4965      1.4526501      3488.3234    
      1500   298.77171     -32091.091     -7151.3912      1.4521683      3489.4807    
      1600   317.58495     -32079.037     -3362.4714      1.4516868      3490.6381    
      1700   319.23722     -32070.978     -4724.8594      1.4512056      3491.7955    
      1800   309.92497     -32081.073     -7200.466       1.4507247      3492.9529    
      1900   288.37747     -32085.234      108.81575      1.4502442      3494.1102    
      2000   299.96978     -32107.32      -5389.8307      1.449764       3495.2676    
      2100   295.98809     -32102.012     -6535.0148      1.4492841      3496.425     
      2200   294.1564      -32084.319     -9552.0928      1.4488045      3497.5824    
      2300   320.81838     -32092.841     -9747.3083      1.4483253      3498.7397    
      2400   313.20287     -32099.682      1400.4291      1.4478463      3499.8971    
      2500   293.39164     -32105.373     -667.22009      1.4473677      3501.0545    
      2600   283.12424     -32103.594      7174.4349      1.4468894      3502.2118    
      2700   289.46029     -32103.534     -7403.8622      1.4464114      3503.3692    
      2800   296.72234     -32100.304     -11628.005      1.4459337      3504.5266    
      2900   315.19962     -32110.852     -6408.1859      1.4454564      3505.684     
      3000   293.33786     -32100.336     -5088.1956      1.4449793      3506.8413    
Loop time of 113.866 on 8 procs for 3000 steps with 274 atoms

Performance: 1.138 ns/day, 21.086 hours/ns, 26.347 timesteps/s, 7.219 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 61.789     | 84.24      | 95.678     | 139.4 | 73.98
Bond    | 0.0082917  | 0.0091183  | 0.009821   |   0.5 |  0.01
Neigh   | 4.6835     | 6.0152     | 6.6777     |  33.7 |  5.28
Comm    | 1.7251     | 13.172     | 35.64      | 352.7 | 11.57
Output  | 0.0078937  | 0.0090967  | 0.010215   |   0.8 |  0.01
Modify  | 9.6918     | 10.352     | 11.695     |  25.7 |  9.09
Other   |            | 0.06999    |            |       |  0.06

Nlocal:          34.25 ave          44 max          21 min
Histogram: 1 0 0 2 0 0 2 1 1 1
Nghost:        2787.75 ave        2809 max        2775 min
Histogram: 3 0 0 2 0 1 1 0 0 1
Neighs:        18737.6 ave       23694 max       11744 min
Histogram: 1 0 1 1 0 0 0 3 1 1

Total # of neighbors = 149901
Ave neighs/atom = 547.08394
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 12.842
variable dlen equal ly-${len0}
variable dlen equal ly-12.842
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.842
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.12842 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.12842 yz delta -0.004312 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 110.2 | 111.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   317.98161     -32069.827      4987.0995      1.4594291      3472.1201    
       100   315.74271     -32093.181     -2924.4115      1.4599157      3470.9628    
       200   272.55137     -32080.322     -10362.508      1.4604027      3469.8054    
       300   294.08987     -32093.805     -2952.814       1.46089        3468.648     
       400   301.45007     -32078.844     -4971.8701      1.4613776      3467.4906    
       500   300.10777     -32070.353     -2622.1315      1.4618655      3466.3333    
       600   317.72803     -32092.964     -3045.1879      1.4623538      3465.1759    
       700   292.72366     -32088.953     -4873.3149      1.4628424      3464.0185    
       800   290.67374     -32097.723     -379.4073       1.4633313      3462.8612    
       900   292.44611     -32099.211     -9885.034       1.4638206      3461.7038    
      1000   299.805       -32080.879     -3026.1634      1.4643101      3460.5464    
      1100   303.17149     -32068.465      6695.2284      1.4648         3459.389     
      1200   304.65408     -32077.086     -17950.298      1.4652903      3458.2317    
      1300   291.6672      -32088.164     -2381.7225      1.4657808      3457.0743    
      1400   287.58221     -32104.058      684.91679      1.4662717      3455.9169    
      1500   286.99159     -32106.957     -392.28438      1.4667629      3454.7595    
      1600   302.29372     -32099.834      8079.289       1.4672545      3453.6022    
      1700   315.96702     -32083.013     -14192.617      1.4677463      3452.4448    
      1800   304.69508     -32065.309     -5912.1284      1.4682385      3451.2874    
      1900   310.74066     -32086.668      1213.2027      1.4687311      3450.13      
      2000   304.43557     -32108.518     -10689.92       1.4692239      3448.9727    
      2100   289.54637     -32114.631     -10448.035      1.4697171      3447.8153    
      2200   301.4408      -32121.757     -9238.686       1.4702106      3446.6579    
      2300   299.4172      -32101.162     -8373.9542      1.4707045      3445.5006    
      2400   309.94195     -32082.801     -2123.6223      1.4711987      3444.3432    
      2500   318.99167     -32074.613     -13462.997      1.4716932      3443.1858    
      2600   301.78846     -32083.645     -7473.4273      1.4721881      3442.0284    
      2700   309.19485     -32122.896      8066.6958      1.4726832      3440.8711    
      2800   294.60477     -32133.169     -10568.457      1.4731788      3439.7137    
      2900   292.78505     -32129.198      1327.139       1.4736746      3438.5563    
      3000   303.63902     -32120.403     -15598.543      1.4741708      3437.3989    
Loop time of 115.125 on 8 procs for 3000 steps with 274 atoms

Performance: 1.126 ns/day, 21.319 hours/ns, 26.059 timesteps/s, 7.140 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 62.816     | 84.328     | 96.599     | 148.0 | 73.25
Bond    | 0.0081571  | 0.0089729  | 0.0097669  |   0.5 |  0.01
Neigh   | 4.7734     | 6.0661     | 6.8381     |  36.3 |  5.27
Comm    | 1.7312     | 14.008     | 35.534     | 363.3 | 12.17
Output  | 0.0084213  | 0.0097042  | 0.010873   |   0.9 |  0.01
Modify  | 9.8656     | 10.635     | 11.939     |  27.5 |  9.24
Other   |            | 0.06895    |            |       |  0.06

Nlocal:          34.25 ave          44 max          24 min
Histogram: 2 0 1 0 0 0 2 1 1 1
Nghost:         2858.5 ave        2881 max        2844 min
Histogram: 1 2 1 0 2 0 1 0 0 1
Neighs:        19113.2 ave       24232 max       13599 min
Histogram: 2 1 0 0 0 0 2 1 1 1

Total # of neighbors = 152906
Ave neighs/atom = 558.05109
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.842
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.12842 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.12842 yz delta 0.004312 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 110.2 | 111.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   317.98161     -32069.827      4987.0995      1.4594291      3472.1201    
       100   315.63709     -32093.216     -2899.6144      1.4589428      3473.2775    
       200   273.55562     -32080.709     -9889.0088      1.4584568      3474.4349    
       300   294.96989     -32093.135     -4418.7515      1.4579711      3475.5923    
       400   301.79742     -32078.674      3953.3867      1.4574858      3476.7496    
       500   291.81982     -32061.012     -4755.6387      1.4570008      3477.907     
       600   302.86648     -32076.086     -12804.838      1.4565161      3479.0644    
       700   283.89663     -32076.762      1628.5778      1.4560317      3480.2218    
       800   292.07656     -32093.805     -8969.3508      1.4555476      3481.3791    
       900   280.55486     -32081.379     -5655.1443      1.4550639      3482.5365    
      1000   297.21103     -32077.669     -6962.6398      1.4545805      3483.6939    
      1100   307.85357     -32078.053     -5795.404       1.4540974      3484.8512    
      1200   301.05621     -32075.096     -20162.447      1.4536146      3486.0086    
      1300   293.06654     -32076.525      8578.8264      1.4531322      3487.166     
      1400   294.94483     -32087.723     -9062.2013      1.4526501      3488.3234    
      1500   285.22255     -32079.961     -2542.0927      1.4521683      3489.4807    
      1600   297.97581     -32079.31       2578.9312      1.4516868      3490.6381    
      1700   312.87369     -32086.786     -12446.315      1.4512056      3491.7955    
      1800   307.93849     -32088.741     -15272.461      1.4507247      3492.9529    
      1900   313.45358     -32100.049     -5278.8855      1.4502442      3494.1102    
      2000   289.59178     -32079.702     -6771.2703      1.449764       3495.2676    
      2100   309.99562     -32084.426     -3432.2281      1.4492841      3496.425     
      2200   306.9727      -32071.466     -8316.5191      1.4488045      3497.5824    
      2300   315.40077     -32086.132     -10600.059      1.4483253      3498.7397    
      2400   295.61543     -32085.652     -7068.6449      1.4478463      3499.8971    
      2500   288.54277     -32091.573     -13259.324      1.4473677      3501.0545    
      2600   281.07171     -32080.465      705.355        1.4468894      3502.2118    
      2700   313.60675     -32086.464     -7755.8442      1.4464114      3503.3692    
      2800   304.36475     -32069.42       6202.365       1.4459337      3504.5266    
      2900   323.38749     -32087.406     -9228.7417      1.4454564      3505.684     
      3000   312.04714     -32091.243      9556.5077      1.4449793      3506.8413    
Loop time of 114.98 on 8 procs for 3000 steps with 274 atoms

Performance: 1.127 ns/day, 21.293 hours/ns, 26.092 timesteps/s, 7.149 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 66.176     | 86.657     | 96.483     | 125.2 | 75.37
Bond    | 0.0083208  | 0.0090818  | 0.0096671  |   0.5 |  0.01
Neigh   | 4.6931     | 6.2599     | 6.9339     |  31.6 |  5.44
Comm    | 1.2884     | 11.135     | 31.59      | 349.2 |  9.68
Output  | 0.0087255  | 0.0099753  | 0.011153   |   0.8 |  0.01
Modify  | 10.174     | 10.839     | 12.441     |  24.4 |  9.43
Other   |            | 0.07033    |            |       |  0.06

Nlocal:          34.25 ave          44 max          22 min
Histogram: 2 0 1 0 0 1 0 1 1 2
Nghost:        2801.62 ave        2840 max        2769 min
Histogram: 1 1 1 0 2 0 2 0 0 1
Neighs:        18716.6 ave       23730 max       12240 min
Histogram: 2 0 1 0 0 0 1 1 1 2

Total # of neighbors = 149733
Ave neighs/atom = 546.4708
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 16.0755
variable dlen equal lz-${len0}
variable dlen equal lz-16.0755
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.0755
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -0.160755 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 110.2 | 111.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   317.98161     -32069.827      4987.0995      1.4594291      3472.1201    
       100   315.71326     -32093.213     -2929.1321      1.4599157      3470.9628    
       200   272.60861     -32080.887     -9550.0474      1.4604027      3469.8054    
       300   293.89122     -32092.366     -5607.7481      1.46089        3468.648     
       400   307.08395     -32082.622     -3915.184       1.4613776      3467.4906    
       500   299.06549     -32068.14      -4735.046       1.4618655      3466.3333    
       600   298.44998     -32075.877     -1776.586       1.4623538      3465.1759    
       700   282.47702     -32076.531     -50.558167      1.4628424      3464.0185    
       800   298.08818     -32098.866     -4268.1806      1.4633313      3462.8612    
       900   280.61994     -32082.866     -196.26529      1.4638206      3461.7038    
      1000   311.08452     -32087.849     -264.59334      1.4643101      3460.5464    
      1100   306.87804     -32076.059      9923.7171      1.4648         3459.389     
      1200   308.85412     -32079.737     -13335.24       1.4652903      3458.2317    
      1300   294.56642     -32079.788     -9778.3525      1.4657808      3457.0743    
      1400   304.43614     -32101.919     -4362.8721      1.4662717      3455.9169    
      1500   278.55469     -32085.719     -2450.1209      1.4667629      3454.7595    
      1600   287.75967     -32086.492      2871.6908      1.4672545      3453.6022    
      1700   302.61814     -32083.518     -4973.9616      1.4677463      3452.4448    
      1800   290.71108     -32064.864      252.04341      1.4682385      3451.2874    
      1900   309.50655     -32083.841      11413.484      1.4687311      3450.13      
      2000   301.76319     -32088.589     -3446.7216      1.4692239      3448.9727    
      2100   318.60442     -32107.281      3521.2441      1.4697171      3447.8153    
      2200   298.45404     -32092.068     -10990.818      1.4702106      3446.6579    
      2300   291.57016     -32084.475     -2642.9541      1.4707045      3445.5006    
      2400   311.98686     -32094.797      6660.1354      1.4711987      3444.3432    
      2500   316.63173     -32097.178      6948.792       1.4716932      3443.1858    
      2600   304.97118     -32094.922      5557.1021      1.4721881      3442.0284    
      2700   292.40162     -32087.479     -7544.4875      1.4726832      3440.8711    
      2800   285.00116     -32084.723     -5187.2865      1.4731788      3439.7137    
      2900   295.97015     -32086.257     -5398.7067      1.4736746      3438.5563    
      3000   310.58689     -32089.821     -1388.5135      1.4741708      3437.3989    
Loop time of 117.591 on 8 procs for 3000 steps with 274 atoms

Performance: 1.102 ns/day, 21.776 hours/ns, 25.512 timesteps/s, 6.990 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 90.873     | 95.01      | 98.802     |  27.0 | 80.80
Bond    | 0.0083944  | 0.0091474  | 0.010164   |   0.7 |  0.01
Neigh   | 6.577      | 6.7941     | 7.1063     |   6.1 |  5.78
Comm    | 1.2604     | 5.0674     | 9.2129     | 117.7 |  4.31
Output  | 0.0089056  | 0.010166   | 0.011287   |   0.9 |  0.01
Modify  | 10.319     | 10.628     | 10.875     |   5.1 |  9.04
Other   |            | 0.07263    |            |       |  0.06

Nlocal:          34.25 ave          44 max          20 min
Histogram: 1 0 0 1 1 0 1 2 1 1
Nghost:        2851.62 ave        2866 max        2836 min
Histogram: 1 0 1 0 2 1 1 0 0 2
Neighs:        19115.9 ave       24279 max       11427 min
Histogram: 1 0 0 1 1 0 1 2 1 1

Total # of neighbors = 152927
Ave neighs/atom = 558.12774
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.0755
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 0.160755 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 110.2 | 111.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   317.98161     -32069.827      4987.0995      1.4594291      3472.1201    
       100   315.65111     -32093.196     -2917.6089      1.4589428      3473.2775    
       200   274.17901     -32080.851     -8308.5707      1.4584568      3474.4349    
       300   290.29207     -32089.953     -5833.0604      1.4579711      3475.5923    
       400   296.41078     -32074.037     -1186.4979      1.4574858      3476.7496    
       500   290.48064     -32059.954     -7327.5714      1.4570008      3477.907     
       600   304.2768      -32080.934     -1458.328       1.4565161      3479.0644    
       700   297.92516     -32093.549     -14042.983      1.4560317      3480.2218    
       800   304.92373     -32107.933     -4276.3042      1.4555476      3481.3791    
       900   305.62027     -32102.122      2300.7851      1.4550639      3482.5365    
      1000   322.29031     -32091.05       1318.4026      1.4545805      3483.6939    
      1100   309.77349     -32074.48      -3096.8188      1.4540974      3484.8512    
      1200   289.98698     -32068.601     -16565.78       1.4536146      3486.0086    
      1300   291.95261     -32086.069     -7570.7705      1.4531322      3487.166     
      1400   292.80483     -32096.106     -2056.2429      1.4526501      3488.3234    
      1500   276.82142     -32075.728     -8948.107       1.4521683      3489.4807    
      1600   287.70304     -32063.44      -7034.1857      1.4516868      3490.6381    
      1700   304.14431     -32063.821      3818.2049      1.4512056      3491.7955    
      1800   315.25746     -32078.142     -1896.3733      1.4507247      3492.9529    
      1900   301.56857     -32084.772      149.53238      1.4502442      3494.1102    
      2000   280.22102     -32081.773     -8958.0837      1.449764       3495.2676    
      2100   286.85669     -32086.757      3391.8678      1.4492841      3496.425     
      2200   290.10438     -32073.965     -861.23646      1.4488045      3497.5824    
      2300   304.70525     -32066.138     -517.49407      1.4483253      3498.7397    
      2400   303.7391      -32061.617     -814.99055      1.4478463      3499.8971    
      2500   315.36547     -32083.352      2272.8536      1.4473677      3501.0545    
      2600   278.68261     -32066.432     -9132.3135      1.4468894      3502.2118    
      2700   303.23033     -32089.806     -6049.0273      1.4464114      3503.3692    
      2800   295.66511     -32075.528     -1823.079       1.4459337      3504.5266    
      2900   314.07113     -32075.024     -2154.302       1.4454564      3505.684     
      3000   328.32716     -32079.059     -4315.7217      1.4449793      3506.8413    
Loop time of 115.881 on 8 procs for 3000 steps with 274 atoms

Performance: 1.118 ns/day, 21.459 hours/ns, 25.889 timesteps/s, 7.093 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.424     | 93.199     | 97.418     |  30.2 | 80.43
Bond    | 0.0081595  | 0.0090417  | 0.0099175  |   0.7 |  0.01
Neigh   | 6.563      | 6.6878     | 6.9327     |   4.6 |  5.77
Comm    | 1.0641     | 5.2994     | 10.084     | 127.1 |  4.57
Output  | 0.0085646  | 0.0097739  | 0.010855   |   0.8 |  0.01
Modify  | 10.366     | 10.604     | 10.755     |   3.7 |  9.15
Other   |            | 0.0719     |            |       |  0.06

Nlocal:          34.25 ave          46 max          19 min
Histogram: 1 0 0 2 0 1 0 2 1 1
Nghost:           2796 ave        2818 max        2770 min
Histogram: 1 0 2 0 1 0 2 0 0 2
Neighs:        18728.2 ave       24830 max       10652 min
Histogram: 1 0 0 2 0 1 0 2 1 1

Total # of neighbors = 149826
Ave neighs/atom = 546.81022
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 16.8189
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.4312)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.8189
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -0.168189 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 110.2 | 111.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   317.98161     -32069.827      4987.0995      1.4594291      3472.1201    
       100   315.65869     -32093.213     -2905.0415      1.4594291      3472.1201    
       200   272.89082     -32080.305     -9312.2928      1.4594291      3472.1201    
       300   291.92752     -32091.146     -3692.169       1.4594291      3472.1201    
       400   300.58059     -32078.005     -2407.1754      1.4594291      3472.1201    
       500   293.22827     -32063.903     -4239.8909      1.4594291      3472.1201    
       600   301.26132     -32079.065     -5830.2146      1.4594291      3472.1201    
       700   280.19699     -32080.704     -20475.923      1.4594291      3472.1201    
       800   296.59754     -32102.556     -4911.6642      1.4594291      3472.1201    
       900   288.86882     -32088.946     -3055.1522      1.4594291      3472.1201    
      1000   329.34147     -32094.709     -4256.0828      1.4594291      3472.1201    
      1100   313.12747     -32070.797     -875.99253      1.4594291      3472.1201    
      1200   312.35343     -32086.832     -8610.3711      1.4594291      3472.1201    
      1300   275.12337     -32084.871     -6671.3006      1.4594291      3472.1201    
      1400   288.71388     -32112.543     -2593.7325      1.4594291      3472.1201    
      1500   294.58949     -32112.646     -9221.615       1.4594291      3472.1201    
      1600   295.88675     -32096.085     -7269.995       1.4594291      3472.1201    
      1700   304.37793     -32079.416     -2912.1337      1.4594291      3472.1201    
      1800   326.17167     -32088.901     -4334.0277      1.4594291      3472.1201    
      1900   302.36118     -32084.445     -1175.1051      1.4594291      3472.1201    
      2000   285.85317     -32099.265      1611.8569      1.4594291      3472.1201    
      2100   287.99645     -32111.266     -15561.165      1.4594291      3472.1201    
      2200   308.83636     -32126.304     -7301.7962      1.4594291      3472.1201    
      2300   290.21683     -32100.464     -600.05731      1.4594291      3472.1201    
      2400   308.75096     -32101.756     -9702.9178      1.4594291      3472.1201    
      2500   306.1435      -32091.129     -6820.0798      1.4594291      3472.1201    
      2600   312.92142     -32095.052     -9592.4403      1.4594291      3472.1201    
      2700   297.65413     -32090.592     -7071.7967      1.4594291      3472.1201    
      2800   273.59116     -32080.299     -15109.583      1.4594291      3472.1201    
      2900   307.13247     -32113.433     -3682.1935      1.4594291      3472.1201    
      3000   295.32152     -32109.122     -13091.475      1.4594291      3472.1201    
Loop time of 116.792 on 8 procs for 3000 steps with 274 atoms

Performance: 1.110 ns/day, 21.628 hours/ns, 25.687 timesteps/s, 7.038 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 81.361     | 92.228     | 98.038     |  55.8 | 78.97
Bond    | 0.0081472  | 0.0089531  | 0.0095597  |   0.5 |  0.01
Neigh   | 5.758      | 6.5939     | 6.983      |  13.5 |  5.65
Comm    | 1.343      | 7.1721     | 18.068     | 200.9 |  6.14
Output  | 0.0092792  | 0.010587   | 0.011818   |   0.9 |  0.01
Modify  | 10.329     | 10.708     | 11.52      |  10.4 |  9.17
Other   |            | 0.07095    |            |       |  0.06

Nlocal:          34.25 ave          45 max          24 min
Histogram: 2 1 0 0 0 1 1 2 0 1
Nghost:        2814.62 ave        2847 max        2780 min
Histogram: 1 0 1 0 2 2 0 1 0 1
Neighs:        18927.9 ave       24497 max       13471 min
Histogram: 2 1 0 0 0 1 1 2 0 1

Total # of neighbors = 151423
Ave neighs/atom = 552.63869
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.8189
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 0.168189 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 110.2 | 111.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   317.98161     -32069.827      4987.0995      1.4594291      3472.1201    
       100   315.70132     -32093.203     -2940.4704      1.4594291      3472.1201    
       200   272.41318     -32080.005     -10941.499      1.4594291      3472.1201    
       300   290.65697     -32089.17      -6537.7426      1.4594291      3472.1201    
       400   294.19524     -32071.659      1206.5327      1.4594291      3472.1201    
       500   292.67939     -32060.067     -1540.1679      1.4594291      3472.1201    
       600   303.01344     -32075.498     -4920.7655      1.4594291      3472.1201    
       700   277.66164     -32075.034     -10773.947      1.4594291      3472.1201    
       800   302.72002     -32106.493     -6145.4463      1.4594291      3472.1201    
       900   304.69986     -32102.501      6044.7672      1.4594291      3472.1201    
      1000   291.03947     -32062.912      5307.781       1.4594291      3472.1201    
      1100   341.42758     -32084.98      -3732.2961      1.4594291      3472.1201    
      1200   299.54856     -32054.974     -5417.6326      1.4594291      3472.1201    
      1300   298.18081     -32074.167     -4445.1036      1.4594291      3472.1201    
      1400   292.3541      -32089.233     -10050.655      1.4594291      3472.1201    
      1500   265.37141     -32061.9        2678.835       1.4594291      3472.1201    
      1600   303.25728     -32069.913     -8849.0868      1.4594291      3472.1201    
      1700   324.58406     -32070.265      3574.63        1.4594291      3472.1201    
      1800   301.4109      -32064.284      5879.0008      1.4594291      3472.1201    
      1900   281.92674     -32079.301     -275.13918      1.4594291      3472.1201    
      2000   286.47459     -32098.56       5215.4544      1.4594291      3472.1201    
      2100   268.93843     -32083.264     -6361.1673      1.4594291      3472.1201    
      2200   313.69351     -32097.61      -11308.117      1.4594291      3472.1201    
      2300   313.11497     -32081.554     -1837.4013      1.4594291      3472.1201    
      2400   312.5739      -32081.08      -1592.3183      1.4594291      3472.1201    
      2500   311.74709     -32093.707     -3543.2892      1.4594291      3472.1201    
      2600   293.71498     -32095.27       1449.9782      1.4594291      3472.1201    
      2700   279.27379     -32089.724      1608.6227      1.4594291      3472.1201    
      2800   293.18931     -32086.37       2315.0094      1.4594291      3472.1201    
      2900   325.57575     -32096.776     -7706.3367      1.4594291      3472.1201    
      3000   281.31236     -32061.601      3469.3131      1.4594291      3472.1201    
Loop time of 116.943 on 8 procs for 3000 steps with 274 atoms

Performance: 1.108 ns/day, 21.656 hours/ns, 25.654 timesteps/s, 7.029 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 89.336     | 93.814     | 98.192     |  33.0 | 80.22
Bond    | 0.0082278  | 0.0089942  | 0.0098093  |   0.6 |  0.01
Neigh   | 6.4639     | 6.7556     | 7.011      |   6.7 |  5.78
Comm    | 1.2933     | 5.6866     | 10.166     | 134.5 |  4.86
Output  | 0.0089677  | 0.010171   | 0.011255   |   0.8 |  0.01
Modify  | 10.344     | 10.59      | 10.855     |   5.2 |  9.06
Other   |            | 0.07711    |            |       |  0.07

Nlocal:          34.25 ave          43 max          23 min
Histogram: 2 0 1 0 0 0 0 2 0 3
Nghost:        2814.12 ave        2837 max        2801 min
Histogram: 2 0 3 0 1 0 0 0 1 1
Neighs:        18904.6 ave       23495 max       12987 min
Histogram: 2 0 1 0 0 0 2 0 0 3

Total # of neighbors = 151237
Ave neighs/atom = 551.95985
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 12.842
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-1.195)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.842
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -0.12842 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 110.2 | 111.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   317.98161     -32069.827      4987.0995      1.4594291      3472.1201    
       100   315.71262     -32093.224     -2931.5364      1.4594291      3472.1201    
       200   273.15427     -32080.49      -9893.1367      1.4594291      3472.1201    
       300   292.68624     -32092.063     -3725.6967      1.4594291      3472.1201    
       400   303.86596     -32080.882     -3194.5018      1.4594291      3472.1201    
       500   300.31139     -32069.019     -2795.0184      1.4594291      3472.1201    
       600   309.4547      -32083.694     -2623.9722      1.4594291      3472.1201    
       700   273.90316     -32071.62      -11776.513      1.4594291      3472.1201    
       800   293.76114     -32094.281     -1881.0669      1.4594291      3472.1201    
       900   281.66956     -32079.34      -3835.6623      1.4594291      3472.1201    
      1000   305.21514     -32079.552      6420.6567      1.4594291      3472.1201    
      1100   306.84108     -32072.374      3962.3416      1.4594291      3472.1201    
      1200   303.77389     -32077.586     -5162.8398      1.4594291      3472.1201    
      1300   280.51767     -32071.52      -3164.5428      1.4594291      3472.1201    
      1400   272.8704      -32076.035     -17948.439      1.4594291      3472.1201    
      1500   307.04243     -32089.92      -5186.9641      1.4594291      3472.1201    
      1600   318.5099      -32092.747     -1713.7263      1.4594291      3472.1201    
      1700   296.72305     -32078.476     -6673.0364      1.4594291      3472.1201    
      1800   285.04481     -32087.062      6754.2496      1.4594291      3472.1201    
      1900   289.92724     -32101.203     -2275.9092      1.4594291      3472.1201    
      2000   293.76681     -32092.628     -2040.5571      1.4594291      3472.1201    
      2100   309.97687     -32080.58      -7041.0614      1.4594291      3472.1201    
      2200   321.30511     -32083.326     -4845.6923      1.4594291      3472.1201    
      2300   293.5389      -32082.224     -8624.2958      1.4594291      3472.1201    
      2400   295.18417     -32101.278     -8484.3785      1.4594291      3472.1201    
      2500   293.86629     -32103.138     -2261.8598      1.4594291      3472.1201    
      2600   298.72147     -32094.675      6043.4942      1.4594291      3472.1201    
      2700   298.61496     -32077.966     -9352.3883      1.4594291      3472.1201    
      2800   326.91897     -32089.738     -1725.7066      1.4594291      3472.1201    
      2900   313.15794     -32081.305     -14049.517      1.4594291      3472.1201    
      3000   316.347       -32093.312      2125.7777      1.4594291      3472.1201    
Loop time of 116.43 on 8 procs for 3000 steps with 274 atoms

Performance: 1.113 ns/day, 21.561 hours/ns, 25.767 timesteps/s, 7.060 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 84.607     | 92.911     | 96.859     |  42.9 | 79.80
Bond    | 0.0080354  | 0.0089465  | 0.0095198  |   0.6 |  0.01
Neigh   | 5.9915     | 6.6709     | 7.0865     |  11.4 |  5.73
Comm    | 2.2992     | 6.2505     | 14.532     | 165.3 |  5.37
Output  | 0.0082798  | 0.0093942  | 0.01036    |   0.8 |  0.01
Modify  | 10.081     | 10.505     | 11.207     |   9.5 |  9.02
Other   |            | 0.07474    |            |       |  0.06

Nlocal:          34.25 ave          45 max          23 min
Histogram: 2 0 1 0 0 0 2 2 0 1
Nghost:         2812.5 ave        2853 max        2793 min
Histogram: 3 1 0 1 1 0 1 0 0 1
Neighs:        18906.5 ave       24502 max       12929 min
Histogram: 2 0 1 0 0 0 2 2 0 1

Total # of neighbors = 151252
Ave neighs/atom = 552.0146
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.842
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 0.12842 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 110.2 | 111.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   317.98161     -32069.827      4987.0995      1.4594291      3472.1201    
       100   315.65214     -32093.188     -2914.54        1.4594291      3472.1201    
       200   272.67179     -32080.196     -10522.408      1.4594291      3472.1201    
       300   295.25585     -32093.661     -5587.4751      1.4594291      3472.1201    
       400   300.89384     -32077.48      -1176.4611      1.4594291      3472.1201    
       500   303.73932     -32070.984     -5588.5625      1.4594291      3472.1201    
       600   310.88252     -32085.607     -3335.8127      1.4594291      3472.1201    
       700   290.10896     -32084.541     -7953.6588      1.4594291      3472.1201    
       800   292.56554     -32096.848      428.94868      1.4594291      3472.1201    
       900   295.23856     -32096.335     -11871.653      1.4594291      3472.1201    
      1000   315.34434     -32090.65       4817.5428      1.4594291      3472.1201    
      1100   337.77377     -32098.636      3711.9897      1.4594291      3472.1201    
      1200   306.38844     -32080.76      -5760.5494      1.4594291      3472.1201    
      1300   299.85433     -32088.064      8012.3405      1.4594291      3472.1201    
      1400   298.31792     -32099.194      1664.2249      1.4594291      3472.1201    
      1500   279.09058     -32091.718     -6263.1835      1.4594291      3472.1201    
      1600   286.79676     -32085.542     -25.114071      1.4594291      3472.1201    
      1700   304.19246     -32073.638      1403.7984      1.4594291      3472.1201    
      1800   321.99368     -32079.859      5656.6222      1.4594291      3472.1201    
      1900   303.46788     -32076.337     -6201.3175      1.4594291      3472.1201    
      2000   275.27612     -32072.158     -15416.502      1.4594291      3472.1201    
      2100   292.98959     -32093.2       -3471.8498      1.4594291      3472.1201    
      2200   289.16304     -32088.747     -10506.213      1.4594291      3472.1201    
      2300   305.68852     -32091.049      5262.6589      1.4594291      3472.1201    
      2400   303.05326     -32072.719     -2711.226       1.4594291      3472.1201    
      2500   321.00799     -32087.081     -6553.7093      1.4594291      3472.1201    
      2600   302.99865     -32079.945     -7932.833       1.4594291      3472.1201    
      2700   304.47549     -32097.892     -3282.0132      1.4594291      3472.1201    
      2800   285.75823     -32099.405      6389.2774      1.4594291      3472.1201    
      2900   285.78559     -32096.539      4449.2251      1.4594291      3472.1201    
      3000   307.36482     -32102.757     -13872.786      1.4594291      3472.1201    
Loop time of 115.656 on 8 procs for 3000 steps with 274 atoms

Performance: 1.121 ns/day, 21.418 hours/ns, 25.939 timesteps/s, 7.107 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 66.332     | 90.404     | 96.843     |  99.3 | 78.17
Bond    | 0.0082853  | 0.0090006  | 0.0096036  |   0.4 |  0.01
Neigh   | 4.7129     | 6.4976     | 6.9994     |  26.9 |  5.62
Comm    | 1.6329     | 8.071      | 32.121     | 332.2 |  6.98
Output  | 0.0079782  | 0.0092403  | 0.010193   |   0.8 |  0.01
Modify  | 10.074     | 10.591     | 12.405     |  21.4 |  9.16
Other   |            | 0.07393    |            |       |  0.06

Nlocal:          34.25 ave          42 max          20 min
Histogram: 1 0 0 1 1 0 0 0 3 2
Nghost:        2810.38 ave        2831 max        2792 min
Histogram: 2 0 0 1 1 0 3 0 0 1
Neighs:        18916.6 ave       22927 max       11293 min
Histogram: 1 0 0 1 1 0 0 0 3 2

Total # of neighbors = 151333
Ave neighs/atom = 552.31022
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 16.0755
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--8.3798)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.0755
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -0.160755 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 110.2 | 111.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   317.98161     -32069.827      4987.0995      1.4594291      3472.1201    
       100   315.74931     -32093.241     -2904.3656      1.4594291      3472.1201    
       200   273.76219     -32081.197     -9092.8148      1.4594291      3472.1201    
       300   293.02342     -32092.084     -3812.3714      1.4594291      3472.1201    
       400   308.43354     -32084.592     -4118.2399      1.4594291      3472.1201    
       500   292.77514     -32065.43      -2001.6733      1.4594291      3472.1201    
       600   296.4284      -32078.403      2913.2345      1.4594291      3472.1201    
       700   285.24585     -32084.828     -3119.531       1.4594291      3472.1201    
       800   286.74612     -32090.804      1848.5009      1.4594291      3472.1201    
       900   276.25911     -32073.968      99.180141      1.4594291      3472.1201    
      1000   290.50641     -32065.681     -11032.469      1.4594291      3472.1201    
      1100   336.00883     -32096.64       1902.0853      1.4594291      3472.1201    
      1200   288.33582     -32069.948     -2489.1316      1.4594291      3472.1201    
      1300   297.99306     -32088.271      669.3647       1.4594291      3472.1201    
      1400   297.58828     -32083.695     -1139.2726      1.4594291      3472.1201    
      1500   298.41649     -32067.555     -6727.1837      1.4594291      3472.1201    
      1600   320.92982     -32072.881     -4650.6976      1.4594291      3472.1201    
      1700   292.15977     -32057.151      4250.3347      1.4594291      3472.1201    
      1800   304.8372      -32087.574     -3673.322       1.4594291      3472.1201    
      1900   297.93138     -32103.289     -625.49348      1.4594291      3472.1201    
      2000   301.13029     -32113.211     -6418.5666      1.4594291      3472.1201    
      2100   290.80182     -32092.801     -8029.328       1.4594291      3472.1201    
      2200   320.76835     -32090.211     -6258.0002      1.4594291      3472.1201    
      2300   304.10092     -32068.469     -11946.083      1.4594291      3472.1201    
      2400   306.77112     -32082.922     -13872.081      1.4594291      3472.1201    
      2500   296.72616     -32104.556     -9687.2586      1.4594291      3472.1201    
      2600   266.84028     -32092.917     -5267.1905      1.4594291      3472.1201    
      2700   298.5771      -32096.64      -11524.013      1.4594291      3472.1201    
      2800   321.58114     -32085.462     -7328.5339      1.4594291      3472.1201    
      2900   322.14369     -32071.012     -3008.5982      1.4594291      3472.1201    
      3000   314.63379     -32068.32       7242.9418      1.4594291      3472.1201    
Loop time of 116.159 on 8 procs for 3000 steps with 274 atoms

Performance: 1.116 ns/day, 21.511 hours/ns, 25.827 timesteps/s, 7.076 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.842     | 93.664     | 96.726     |  29.8 | 80.63
Bond    | 0.0081758  | 0.00915    | 0.0097953  |   0.6 |  0.01
Neigh   | 6.5475     | 6.7171     | 7.0652     |   6.5 |  5.78
Comm    | 2.1078     | 5.1716     | 9.9916     | 127.2 |  4.45
Output  | 0.0088158  | 0.010022   | 0.011108   |   0.8 |  0.01
Modify  | 10.151     | 10.512     | 10.681     |   5.6 |  9.05
Other   |            | 0.0746     |            |       |  0.06

Nlocal:          34.25 ave          41 max          22 min
Histogram: 1 0 0 2 0 0 0 0 3 2
Nghost:        2821.62 ave        2845 max        2795 min
Histogram: 1 0 0 1 2 1 1 0 1 1
Neighs:        18920.2 ave       22452 max       12319 min
Histogram: 1 0 0 2 0 0 0 0 3 2

Total # of neighbors = 151362
Ave neighs/atom = 552.41606
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.0755
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 0.160755 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.9 | 110.2 | 111.1 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   317.98161     -32069.827      4987.0995      1.4594291      3472.1201    
       100   315.64125     -32093.191     -2916.6299      1.4594291      3472.1201    
       200   272.50061     -32079.97      -8647.9649      1.4594291      3472.1201    
       300   289.52389     -32089.556     -2574.9369      1.4594291      3472.1201    
       400   307.71091     -32083.208     -2408.0331      1.4594291      3472.1201    
       500   306.49175     -32074.237      4363.9799      1.4594291      3472.1201    
       600   299.24626     -32080.674     -1215.8234      1.4594291      3472.1201    
       700   281.39153     -32083.257     -10830.044      1.4594291      3472.1201    
       800   305.74193     -32109.4        1266.564       1.4594291      3472.1201    
       900   298.32882     -32095.126     -13165.815      1.4594291      3472.1201    
      1000   291.51887     -32062.754      5871.153       1.4594291      3472.1201    
      1100   302.3636      -32058.907      6587.8784      1.4594291      3472.1201    
      1200   308.03255     -32074.844     -19496.107      1.4594291      3472.1201    
      1300   289.14628     -32087.049     -1799.5713      1.4594291      3472.1201    
      1400   272.89984     -32089.771     -7914.1335      1.4594291      3472.1201    
      1500   304.65363     -32107.468      4540.5893      1.4594291      3472.1201    
      1600   305.2762      -32087.29      -11079.625      1.4594291      3472.1201    
      1700   318.27001     -32077.8       -13382.931      1.4594291      3472.1201    
      1800   318.60068     -32080.964     -1652.2489      1.4594291      3472.1201    
      1900   304.74652     -32095.445      4918.757       1.4594291      3472.1201    
      2000   274.48894     -32090.701      7548.373       1.4594291      3472.1201    
      2100   301.85606     -32100.705      1672.9635      1.4594291      3472.1201    
      2200   308.65405     -32090.373     -4731.1609      1.4594291      3472.1201    
      2300   302.95944     -32078.59      -19283.864      1.4594291      3472.1201    
      2400   301.4947      -32074.121     -5780.8156      1.4594291      3472.1201    
      2500   306.44944     -32089.002      1878.2584      1.4594291      3472.1201    
      2600   304.24898     -32104.007     -2560.6164      1.4594291      3472.1201    
      2700   268.29761     -32076.9       -4822.1885      1.4594291      3472.1201    
      2800   302.859       -32090.863     -8180.4079      1.4594291      3472.1201    
      2900   318.24195     -32086.745     -17679.439      1.4594291      3472.1201    
      3000   327.82507     -32086.912      6416.8263      1.4594291      3472.1201    
Loop time of 107.228 on 8 procs for 3000 steps with 274 atoms

Performance: 1.209 ns/day, 19.857 hours/ns, 27.978 timesteps/s, 7.666 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 56.161     | 76.381     | 89.114     | 165.2 | 71.23
Bond    | 0.0074576  | 0.0081771  | 0.0086707  |   0.6 |  0.01
Neigh   | 4.6913     | 5.9694     | 6.9916     |  40.2 |  5.57
Comm    | 1.3027     | 14.013     | 34.202     | 385.2 | 13.07
Output  | 0.0081774  | 0.0092685  | 0.010375   |   0.8 |  0.01
Modify  | 9.7378     | 10.779     | 12.072     |  30.7 | 10.05
Other   |            | 0.06901    |            |       |  0.06

Nlocal:          34.25 ave          45 max          19 min
Histogram: 1 1 0 0 0 1 1 2 1 1
Nghost:           2810 ave        2843 max        2792 min
Histogram: 3 1 0 1 1 0 0 1 0 1
Neighs:        18901.1 ave       24493 max       10704 min
Histogram: 1 0 1 0 0 1 0 3 1 1

Total # of neighbors = 151209
Ave neighs/atom = 551.85766
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:24:56
