LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 30*${nthermo}       # steps of equilibration run 10
variable nequil equal 30*100       
variable nrun equal 30*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 30*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-48-vasp
read_data       ${structure}.data
read_data       333U-50C-48-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.007 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 5.6868e-05 on 8 procs for 1 steps with 386 atoms

54.3% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.047e-06  | 1.8506e-06 | 2.025e-06  |   0.0 |  3.25
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 4.47e-06   | 4.6969e-06 | 6.285e-06  |   0.0 |  8.26
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 5.032e-05  |            |       | 88.49

Nlocal:          48.25 ave          57 max          44 min
Histogram: 1 3 1 0 2 0 0 0 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-48-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
run ${nequil}
run 3000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -0.82 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.5 | 134.6 | 136.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -43252.041      122314.38      1.7215889      3934.8755    
       100   687.78657     -44005.613     -8794.9944      1.7215889      3934.8755    
       200   532.95414     -44212.652      4685.379       1.7215889      3934.8755    
       300   428.38322     -44394.229      13642.414      1.7215889      3934.8755    
       400   357.48885     -44522.718      7814.9119      1.7215889      3934.8755    
       500   305.20861     -44601.4        10808.086      1.7215889      3934.8755    
       600   295.50212     -44683.072     -513.875        1.7215889      3934.8755    
       700   280.46427     -44711.699     -1603.7978      1.7215889      3934.8755    
       800   279.60643     -44705.198      4769.2458      1.7215889      3934.8755    
       900   318.26234     -44701.239     -1818.0216      1.7215889      3934.8755    
      1000   330.13743     -44680.939      314.21565      1.7215889      3934.8755    
      1100   306.37201     -44671.549      338.51067      1.7215889      3934.8755    
      1200   285.35817     -44690.413      18102.578      1.7215889      3934.8755    
      1300   282.87873     -44713.783      16541.07       1.7215889      3934.8755    
      1400   283.9657      -44719.988      13551.045      1.7215889      3934.8755    
      1500   299.28169     -44731.239     -5446.4411      1.7215889      3934.8755    
      1600   295.10399     -44708.179      13091.763      1.7215889      3934.8755    
      1700   306.5935      -44695.641      12607.525      1.7215889      3934.8755    
      1800   307.96105     -44688.824      114.19541      1.7215889      3934.8755    
      1900   297.5467      -44689.544     -11232.833      1.7215889      3934.8755    
      2000   297.63273     -44718.624      3681.1426      1.7215889      3934.8755    
      2100   284.48949     -44729.07       1810.321       1.7215889      3934.8755    
      2200   299.39507     -44746.849      9777.7339      1.7215889      3934.8755    
      2300   309.12185     -44739.177      11871.005      1.7215889      3934.8755    
      2400   299.81281     -44711.424      2203.2625      1.7215889      3934.8755    
      2500   301.13092     -44712.816      7486.3507      1.7215889      3934.8755    
      2600   306.0768      -44733.777      3844.6675      1.7215889      3934.8755    
      2700   294.99852     -44744.953      10956.358      1.7215889      3934.8755    
      2800   294.76019     -44755.788      4132.5298      1.7215889      3934.8755    
      2900   285.45879     -44739.503     -2290.237       1.7215889      3934.8755    
      3000   309.50281     -44750.322      2435.9873      1.7215889      3934.8755    
Loop time of 152.939 on 8 procs for 3000 steps with 386 atoms

Performance: 0.847 ns/day, 28.322 hours/ns, 19.616 timesteps/s, 7.572 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 89         | 113.16     | 128.98     | 172.3 | 73.99
Bond    | 0.0077894  | 0.0081004  | 0.0092258  |   0.5 |  0.01
Neigh   | 7.0231     | 8.8144     | 9.9713     |  45.9 |  5.76
Comm    | 1.5252     | 17.353     | 41.5       | 439.9 | 11.35
Output  | 0.0014595  | 0.0015578  | 0.002188   |   0.6 |  0.00
Modify  | 12.386     | 13.531     | 15.315     |  37.2 |  8.85
Other   |            | 0.07063    |            |       |  0.05

Nlocal:          48.25 ave          57 max          43 min
Histogram: 2 0 2 0 1 2 0 0 0 1
Nghost:        3448.25 ave        3477 max        3431 min
Histogram: 2 1 0 3 0 0 0 1 0 1
Neighs:        33067.5 ave       38626 max       29810 min
Histogram: 2 0 2 0 2 1 0 0 0 1

Total # of neighbors = 264540
Ave neighs/atom = 685.33679
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333U-50C-48-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.7222
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.589
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.3161

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal -0.018
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal -0.3071
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -7.3464

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 16.7222
variable dlen equal lx-${len0}
variable dlen equal lx-16.7222
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.7222
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.3464000000000000412, deltaxy = 0.073464
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.3070999999999999841, deltaxz = 0.003071
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.01799999999999999864, deltayz = 0.00018
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.167222 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.167222 xy delta 0.073464 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.167222 xy delta 0.073464 xz delta 0.003071 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134 | 134.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   309.50281     -44750.322      2435.91        1.7215889      3934.8755    
       100   314.72473     -44742.344      8355.1018      1.722163       3933.5639    
       200   324.39348     -44746.769      10860.58       1.7227374      3932.2523    
       300   295.24448     -44730.477      1982.3877      1.7233122      3930.9406    
       400   293.51022     -44743.421      7557.3661      1.7238874      3929.629     
       500   292.77315     -44744.07      -1073.8838      1.724463       3928.3174    
       600   316.21171     -44757.937     -2506.6813      1.725039       3927.0058    
       700   305.3888      -44739.251      3516.3334      1.7256154      3925.6941    
       800   295.18376     -44728.29       527.28197      1.7261921      3924.3825    
       900   300.98809     -44734.833      6572.303       1.7267692      3923.0709    
      1000   297.55475     -44743.094      4186.7914      1.7273467      3921.7593    
      1100   275.69185     -44734.413     -10488.886      1.7279246      3920.4476    
      1200   291.37814     -44746.654      19533.643      1.7285029      3919.136     
      1300   301.91539     -44739.943      10282.609      1.7290816      3917.8244    
      1400   321.29808     -44753.371      14171.474      1.7296607      3916.5128    
      1500   303.89405     -44743.387      16835.581      1.7302401      3915.2011    
      1600   298.48267     -44770.666     -7870.5956      1.73082        3913.8895    
      1700   302.80059     -44786.838     -7770.9588      1.7314002      3912.5779    
      1800   282.99145     -44747.683      23826.812      1.7319808      3911.2663    
      1900   306.2409      -44757.98       3159.9034      1.7325618      3909.9546    
      2000   297.4453      -44748.749     -12621.335      1.7331432      3908.643     
      2100   306.6907      -44759.769      6516.9781      1.733725       3907.3314    
      2200   296.96463     -44754.865     -2978.1801      1.7343072      3906.0198    
      2300   293.92993     -44783.083     -1848.0648      1.7348897      3904.7081    
      2400   293.9302      -44800.086      15178.572      1.7354727      3903.3965    
      2500   295.02399     -44784.132      2884.5176      1.7360561      3902.0849    
      2600   304.45471     -44772.385     -775.94423      1.7366398      3900.7733    
      2700   295.2852      -44757.492      14874.701      1.7372239      3899.4616    
      2800   296.95085     -44752.569      8312.8189      1.7378085      3898.15      
      2900   302.75044     -44750.958     -4897.0468      1.7383934      3896.8384    
      3000   324.76542     -44770.028      13901.941      1.7389787      3895.5268    
Loop time of 153.872 on 8 procs for 3000 steps with 386 atoms

Performance: 0.842 ns/day, 28.495 hours/ns, 19.497 timesteps/s, 7.526 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 89.824     | 109.85     | 129.57     | 180.5 | 71.39
Bond    | 0.0077546  | 0.0081806  | 0.0090912  |   0.5 |  0.01
Neigh   | 7.0472     | 8.5516     | 10.089     |  47.6 |  5.56
Comm    | 1.6746     | 21.405     | 41.405     | 408.8 | 13.91
Output  | 0.0078246  | 0.0090062  | 0.0098714  |   0.6 |  0.01
Modify  | 12.444     | 13.978     | 15.464     |  37.4 |  9.08
Other   |            | 0.0733     |            |       |  0.05

Nlocal:          48.25 ave          61 max          38 min
Histogram: 1 0 0 3 1 2 0 0 0 1
Nghost:        3450.25 ave        3483 max        3407 min
Histogram: 1 0 0 0 1 3 1 1 0 1
Neighs:          33362 ave       41653 max       26699 min
Histogram: 1 0 0 3 1 2 0 0 0 1

Total # of neighbors = 266896
Ave neighs/atom = 691.44041
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.7222
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.167222 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.167222 xy delta -0.073464 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.167222 xy delta -0.073464 xz delta -0.003071 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134.1 | 134.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   309.50281     -44750.322      2435.91        1.7215889      3934.8755    
       100   314.6963      -44742.424      8342.0307      1.7210153      3936.1871    
       200   327.30349     -44750.381      10027.271      1.720442       3937.4988    
       300   297.88105     -44734.013      7713.4062      1.7198691      3938.8104    
       400   282.92597     -44730.444      11809.288      1.7192965      3940.122     
       500   291.42195     -44735.871      1208.9666      1.7187244      3941.4336    
       600   312.71048     -44741.536      6619.4936      1.7181526      3942.7453    
       700   323.46065     -44748.42       5928.5958      1.7175812      3944.0569    
       800   299.4854      -44734.923     -6391.8456      1.7170102      3945.3685    
       900   303.45654     -44747.547      6902.8997      1.7164396      3946.6801    
      1000   309.38893     -44759.745      5631.2021      1.7158694      3947.9918    
      1100   306.83878     -44759.715      9654.208       1.7152995      3949.3034    
      1200   291.75602     -44735.221      7503.72        1.71473        3950.615     
      1300   295.27403     -44720.775      12707.118      1.7141609      3951.9266    
      1400   297.05295     -44714.7       -1530.4206      1.7135922      3953.2383    
      1500   284.73406     -44710.455     -6051.6157      1.7130238      3954.5499    
      1600   290.58868     -44753.338     -20596.515      1.7124558      3955.8615    
      1700   276.45366     -44742.412      9663.8669      1.7118882      3957.1731    
      1800   308.6365      -44758.677      1310.3736      1.711321       3958.4848    
      1900   312.76046     -44747.216      3296.1048      1.7107541      3959.7964    
      2000   298.36365     -44727.499     -3518.8848      1.7101877      3961.108     
      2100   304.44891     -44733.996      11918.946      1.7096216      3962.4196    
      2200   294.04556     -44732.398     -2843.1375      1.7090558      3963.7313    
      2300   301.86099     -44752.878     -1859.7623      1.7084905      3965.0429    
      2400   289.23975     -44739.337      3078.6045      1.7079255      3966.3545    
      2500   284.91108     -44731.922     -8.2268114      1.7073609      3967.6661    
      2600   307.16777     -44746.302      3929.8633      1.7067967      3968.9778    
      2700   310.9869      -44742.417     -4016.0753      1.7062328      3970.2894    
      2800   299.2254      -44724.044     -10920.297      1.7056693      3971.601     
      2900   288.49008     -44716.423     -12035.285      1.7051062      3972.9126    
      3000   298.02495     -44743.718      3754.2482      1.7045435      3974.2243    
Loop time of 151.714 on 8 procs for 3000 steps with 386 atoms

Performance: 0.854 ns/day, 28.095 hours/ns, 19.774 timesteps/s, 7.633 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 87.503     | 107.82     | 127.78     | 182.1 | 71.06
Bond    | 0.0076218  | 0.0080432  | 0.0091128  |   0.5 |  0.01
Neigh   | 6.993      | 8.4542     | 10.019     |  48.4 |  5.57
Comm    | 1.4938     | 21.465     | 41.782     | 408.0 | 14.15
Output  | 0.0079009  | 0.0091238  | 0.0099877  |   0.6 |  0.01
Modify  | 12.327     | 13.889     | 15.336     |  38.0 |  9.15
Other   |            | 0.07385    |            |       |  0.05

Nlocal:          48.25 ave          58 max          40 min
Histogram: 1 1 1 2 0 0 1 0 1 1
Nghost:        3451.12 ave        3485 max        3423 min
Histogram: 1 0 1 2 1 1 1 0 0 1
Neighs:        32731.2 ave       38903 max       27514 min
Histogram: 1 1 1 2 0 0 1 0 1 1

Total # of neighbors = 261850
Ave neighs/atom = 678.36788
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.589
variable dlen equal ly-${len0}
variable dlen equal ly-13.589
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.589
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.3464000000000000412, deltaxy = 0.073464
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.3070999999999999841, deltaxz = 0.003071
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.01799999999999999864, deltayz = 0.00018
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.13589 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.13589 yz delta 0.00018 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134 | 134.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   309.50281     -44750.322      2435.91        1.7215889      3934.8755    
       100   314.81748     -44742.42       8459.0332      1.722163       3933.5639    
       200   325.13593     -44747.621      9097.5078      1.7227374      3932.2523    
       300   295.84226     -44730.516      4463.5979      1.7233122      3930.9406    
       400   290.12901     -44738.148     -2151.7193      1.7238874      3929.629     
       500   293.80488     -44741.969      19.901648      1.724463       3928.3174    
       600   310.97906     -44753.162      2335.0157      1.725039       3927.0058    
       700   303.59504     -44733.432      7544.367       1.7256154      3925.6941    
       800   299.02821     -44721.516     -4976.2641      1.7261921      3924.3825    
       900   316.19848     -44738.353      1653.8011      1.7267692      3923.0709    
      1000   315.52743     -44757.67       17995.984      1.7273467      3921.7593    
      1100   298.25538     -44762.373      5474.1358      1.7279246      3920.4476    
      1200   291.76266     -44757.586     -5818.726       1.7285029      3919.136     
      1300   298.80048     -44751.28       4829.9096      1.7290816      3917.8244    
      1400   301.77082     -44729.154     -6400.0076      1.7296607      3916.5128    
      1500   305.89166     -44726.708      10320.457      1.7302401      3915.2011    
      1600   309.79373     -44744.591     -5440.3458      1.73082        3913.8895    
      1700   286.93712     -44759.003      6464.698       1.7314002      3912.5779    
      1800   278.01449     -44745.593      14368.014      1.7319808      3911.2663    
      1900   290.6563      -44735.945     -823.62726      1.7325618      3909.9546    
      2000   312.14523     -44759.989      17492.919      1.7331432      3908.643     
      2100   287.43686     -44737.875      6291.7523      1.733725       3907.3314    
      2200   322.63879     -44741.808      12360.845      1.7343072      3906.0198    
      2300   341.69822     -44750.146     -1566.6006      1.7348897      3904.7081    
      2400   304.78369     -44736.563      6836.7153      1.7354727      3903.3965    
      2500   297.73224     -44744.397      5956.0209      1.7360561      3902.0849    
      2600   308.15049     -44771.258      6204.4004      1.7366398      3900.7733    
      2700   304.4435      -44775.596      4122.1033      1.7372239      3899.4616    
      2800   279.31545     -44733.931      5231.7632      1.7378085      3898.15      
      2900   309.67296     -44728.255      14449.263      1.7383934      3896.8384    
      3000   305.33304     -44731.482      16816.068      1.7389787      3895.5268    
Loop time of 156.817 on 8 procs for 3000 steps with 386 atoms

Performance: 0.826 ns/day, 29.040 hours/ns, 19.131 timesteps/s, 7.384 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 87.692     | 114.02     | 130.26     | 168.9 | 72.71
Bond    | 0.0077455  | 0.0081893  | 0.009645   |   0.7 |  0.01
Neigh   | 7.0986     | 8.8738     | 10.147     |  42.6 |  5.66
Comm    | 2.9477     | 19.191     | 45.528     | 411.5 | 12.24
Output  | 0.0084219  | 0.0099134  | 0.01096    |   0.7 |  0.01
Modify  | 13.375     | 14.637     | 16.416     |  33.5 |  9.33
Other   |            | 0.07418    |            |       |  0.05

Nlocal:          48.25 ave          54 max          44 min
Histogram: 1 2 0 1 0 0 2 1 0 1
Nghost:         3487.5 ave        3505 max        3473 min
Histogram: 1 1 1 1 1 1 0 0 1 1
Neighs:          33386 ave       37169 max       30588 min
Histogram: 2 1 0 1 0 1 2 0 0 1

Total # of neighbors = 267088
Ave neighs/atom = 691.93782
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.589
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.13589 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.13589 yz delta -0.00018 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134.1 | 134.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   309.50281     -44750.322      2435.91        1.7215889      3934.8755    
       100   314.70771     -44742.502      8224.0205      1.7210153      3936.1871    
       200   325.83853     -44748.344      11525.093      1.720442       3937.4988    
       300   298.57771     -44735.647      7567.3059      1.7198691      3938.8104    
       400   291.11921     -44741.461      3944.6194      1.7192965      3940.122     
       500   288.69426     -44740.219     -4970.4466      1.7187244      3941.4336    
       600   309.22435     -44750.458     -7463.9889      1.7181526      3942.7453    
       700   291.89974     -44723.777      3179.7936      1.7175812      3944.0569    
       800   302.60203     -44733.311      589.36596      1.7170102      3945.3685    
       900   304.83765     -44733.457     -112.09918      1.7164396      3946.6801    
      1000   312.6051      -44747.02      -3140.903       1.7158694      3947.9918    
      1100   294.03823     -44731.815      2650.6172      1.7152995      3949.3034    
      1200   307.84881     -44752.213      2618.2841      1.71473        3950.615     
      1300   306.58828     -44752.143      7925.9742      1.7141609      3951.9266    
      1400   283.42208     -44730.83      -6209.6456      1.7135922      3953.2383    
      1500   311.24128     -44763.137      6957.0007      1.7130238      3954.5499    
      1600   297.38325     -44758.73      -156.84022      1.7124558      3955.8615    
      1700   293.92167     -44760.051      4784.9638      1.7118882      3957.1731    
      1800   296.73776     -44751.316      467.19132      1.711321       3958.4848    
      1900   323.00226     -44753.487      9184.7102      1.7107541      3959.7964    
      2000   316.20023     -44745.19      -2363.2592      1.7101877      3961.108     
      2100   288.75123     -44746.718     -6134.6895      1.7096216      3962.4196    
      2200   279.15025     -44751.355     -608.96581      1.7090558      3963.7313    
      2300   309.63141     -44772.762     -4463.6651      1.7084905      3965.0429    
      2400   297.88441     -44738.437      2285.5312      1.7079255      3966.3545    
      2500   314.92923     -44751.112      6146.2933      1.7073609      3967.6661    
      2600   309.44835     -44753.422     -138.58097      1.7067967      3968.9778    
      2700   318.46332     -44772.599      1524.7093      1.7062328      3970.2894    
      2800   267.96122     -44753.273     -87.868072      1.7056693      3971.601     
      2900   276.44761     -44776.154      2893.3661      1.7051062      3972.9126    
      3000   284.2917      -44759.308      3540.4601      1.7045435      3974.2243    
Loop time of 156.951 on 8 procs for 3000 steps with 386 atoms

Performance: 0.826 ns/day, 29.065 hours/ns, 19.114 timesteps/s, 7.378 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.24      | 118.37     | 131.42     | 168.8 | 75.42
Bond    | 0.0073456  | 0.008256   | 0.0095403  |   0.7 |  0.01
Neigh   | 7.022      | 9.2592     | 10.438     |  42.7 |  5.90
Comm    | 1.4877     | 14.527     | 46.652     | 481.4 |  9.26
Output  | 0.0089782  | 0.010524   | 0.011701   |   0.8 |  0.01
Modify  | 13.489     | 14.691     | 16.953     |  34.5 |  9.36
Other   |            | 0.08017    |            |       |  0.05

Nlocal:          48.25 ave          56 max          41 min
Histogram: 1 0 2 1 1 0 1 0 0 2
Nghost:        3453.25 ave        3496 max        3433 min
Histogram: 2 2 1 0 0 2 0 0 0 1
Neighs:        32707.9 ave       37618 max       28190 min
Histogram: 1 1 1 1 1 0 1 0 0 2

Total # of neighbors = 261663
Ave neighs/atom = 677.88342
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.3161
variable dlen equal lz-${len0}
variable dlen equal lz-17.3161
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.3161
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.3464000000000000412, deltaxy = 0.073464
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.3070999999999999841, deltaxz = 0.003071
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.01799999999999999864, deltayz = 0.00018
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -0.173161 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134 | 134.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   309.50281     -44750.322      2435.91        1.7215889      3934.8755    
       100   314.74909     -44742.381      8341.5748      1.722163       3933.5639    
       200   325.3494      -44747.58       11897.484      1.7227374      3932.2523    
       300   298.66342     -44734.594      11686.214      1.7233122      3930.9406    
       400   297.3694      -44748.957      12745.979      1.7238874      3929.629     
       500   285.42584     -44736.109      1371.0347      1.724463       3928.3174    
       600   314.66976     -44756.64      -2597.9655      1.725039       3927.0058    
       700   291.39219     -44721.987      1054.0968      1.7256154      3925.6941    
       800   283.14427     -44713.868     -587.40069      1.7261921      3924.3825    
       900   293.80364     -44725.149     -6979.8986      1.7267692      3923.0709    
      1000   312.38772     -44758.54       4462.4385      1.7273467      3921.7593    
      1100   293.12126     -44752.109      4364.2125      1.7279246      3920.4476    
      1200   286.65346     -44742.405      6058.7928      1.7285029      3919.136     
      1300   296.58936     -44741.446      10396.548      1.7290816      3917.8244    
      1400   317.28037     -44750.628     -3307.682       1.7296607      3916.5128    
      1500   305.22879     -44729.346     -969.44831      1.7302401      3915.2011    
      1600   297.94267     -44736.182     -2477.4085      1.73082        3913.8895    
      1700   272.63376     -44740.214      5918.9575      1.7314002      3912.5779    
      1800   288.58359     -44757.554      6048.7764      1.7319808      3911.2663    
      1900   306.85619     -44754.385      11507.267      1.7325618      3909.9546    
      2000   311.474       -44746.201      22414.5        1.7331432      3908.643     
      2100   303.43434     -44741.118     -1368.0242      1.733725       3907.3314    
      2200   307.37962     -44754.449      8652.1409      1.7343072      3906.0198    
      2300   308.22192     -44775.784      7111.6936      1.7348897      3904.7081    
      2400   289.6986      -44783.06       12468.589      1.7354727      3903.3965    
      2500   260.79772     -44784.226      8097.6252      1.7360561      3902.0849    
      2600   269.27892     -44780.072     -3491.5836      1.7366398      3900.7733    
      2700   289.11284     -44760.951      14167.472      1.7372239      3899.4616    
      2800   289.35624     -44741.111     -3900.1248      1.7378085      3898.15      
      2900   317.17339     -44758.477      7775.7202      1.7383934      3896.8384    
      3000   279.86165     -44725.613      20291.596      1.7389787      3895.5268    
Loop time of 159.229 on 8 procs for 3000 steps with 386 atoms

Performance: 0.814 ns/day, 29.487 hours/ns, 18.841 timesteps/s, 7.273 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 87.174     | 120.01     | 133.72     | 170.9 | 75.37
Bond    | 0.0071189  | 0.0080899  | 0.0094108  |   0.7 |  0.01
Neigh   | 7.0747     | 9.3229     | 10.505     |  42.7 |  5.86
Comm    | 1.3643     | 15.059     | 47.883     | 481.8 |  9.46
Output  | 0.008981   | 0.010523   | 0.0117     |   0.8 |  0.01
Modify  | 13.527     | 14.737     | 17.015     |  34.6 |  9.26
Other   |            | 0.07787    |            |       |  0.05

Nlocal:          48.25 ave          57 max          41 min
Histogram: 1 0 2 1 0 2 1 0 0 1
Nghost:         3492.5 ave        3523 max        3473 min
Histogram: 2 0 1 1 2 0 0 1 0 1
Neighs:          33377 ave       39149 max       28703 min
Histogram: 1 0 2 1 1 1 1 0 0 1

Total # of neighbors = 267016
Ave neighs/atom = 691.7513
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.3161
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 0.173161 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134 | 134.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   309.50281     -44750.322      2435.91        1.7215889      3934.8755    
       100   314.72722     -44742.45       8337.1183      1.7210153      3936.1871    
       200   327.60223     -44750.438      10317.542      1.720442       3937.4988    
       300   297.84491     -44733.109      8695.2025      1.7198691      3938.8104    
       400   285.9416      -44733.233      3601.8101      1.7192965      3940.122     
       500   284.64259     -44731.386      6700.7749      1.7187244      3941.4336    
       600   314.94022     -44751.216     -6355.4867      1.7181526      3942.7453    
       700   303.65191     -44732.076      1719.2378      1.7175812      3944.0569    
       800   305.24793     -44743.325      580.50225      1.7170102      3945.3685    
       900   316.9493      -44764.22      -788.53979      1.7164396      3946.6801    
      1000   310.91364     -44762.234      5052.837       1.7158694      3947.9918    
      1100   304.07242     -44748.125      116.61394      1.7152995      3949.3034    
      1200   307.86518     -44733.658      1756.2236      1.71473        3950.615     
      1300   323.87134     -44745.654     -10839.91       1.7141609      3951.9266    
      1400   307.03406     -44754.508     -654.08107      1.7135922      3953.2383    
      1500   302.26117     -44763.405      1336.9386      1.7130238      3954.5499    
      1600   288.34334     -44745.708      366.65626      1.7124558      3955.8615    
      1700   317.64458     -44754.177     -2491.4025      1.7118882      3957.1731    
      1800   307.64759     -44742.019     -6723.2171      1.711321       3958.4848    
      1900   299.486       -44747.098      10102.527      1.7107541      3959.7964    
      2000   293.64463     -44755.501      23167.837      1.7101877      3961.108     
      2100   287.40603     -44750.901      8583.3266      1.7096216      3962.4196    
      2200   303.36032     -44750.117     -6087.9577      1.7090558      3963.7313    
      2300   313.00879     -44731.102      12108.986      1.7084905      3965.0429    
      2400   304.55614     -44724.547      9494.8266      1.7079255      3966.3545    
      2500   289.90916     -44735.618     -7450.9946      1.7073609      3967.6661    
      2600   300.5402      -44756.547      3471.987       1.7067967      3968.9778    
      2700   285.74709     -44741.302     -4551.5117      1.7062328      3970.2894    
      2800   299.6435      -44746.362      2909.9745      1.7056693      3971.601     
      2900   296.54418     -44723.913      1045.1672      1.7051062      3972.9126    
      3000   319.70969     -44737.242     -4248.2314      1.7045435      3974.2243    
Loop time of 156.398 on 8 procs for 3000 steps with 386 atoms

Performance: 0.829 ns/day, 28.963 hours/ns, 19.182 timesteps/s, 7.404 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.047     | 118.1      | 130.81     | 168.2 | 75.51
Bond    | 0.0070925  | 0.0081605  | 0.0093502  |   0.7 |  0.01
Neigh   | 7.0288     | 9.2446     | 10.411     |  42.2 |  5.91
Comm    | 1.7073     | 14.409     | 46.44      | 481.0 |  9.21
Output  | 0.0091141  | 0.010592   | 0.011773   |   0.8 |  0.01
Modify  | 13.356     | 14.552     | 16.8       |  34.4 |  9.30
Other   |            | 0.07757    |            |       |  0.05

Nlocal:          48.25 ave          59 max          39 min
Histogram: 1 0 1 2 0 1 1 1 0 1
Nghost:        3448.75 ave        3467 max        3432 min
Histogram: 1 0 2 1 0 0 2 1 0 1
Neighs:        32739.6 ave       39555 max       26849 min
Histogram: 1 0 3 0 0 1 1 1 0 1

Total # of neighbors = 261917
Ave neighs/atom = 678.54145
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 16.7222
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz--0.018)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.7222
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.3464000000000000412, deltaxy = 0.073464
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.3070999999999999841, deltaxz = 0.003071
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.01799999999999999864, deltayz = 0.00018
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -0.167222 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134 | 134.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   309.50281     -44750.322      2435.91        1.7215889      3934.8755    
       100   314.73433     -44742.4        8333.807       1.7215889      3934.8755    
       200   325.66822     -44748.528      11063.339      1.7215889      3934.8755    
       300   295.20328     -44731.156      9672.9004      1.7215889      3934.8755    
       400   295.06217     -44745.872      11247.131      1.7215889      3934.8755    
       500   284.83994     -44735.791      2611.4027      1.7215889      3934.8755    
       600   309.02371     -44750.243     -10190.156      1.7215889      3934.8755    
       700   312.64377     -44748.218     -457.42807      1.7215889      3934.8755    
       800   298.59172     -44735.774      293.75454      1.7215889      3934.8755    
       900   296.63109     -44734.977      7262.9261      1.7215889      3934.8755    
      1000   303.92759     -44746.02      -2253.5016      1.7215889      3934.8755    
      1100   288.37419     -44737.671     -5867.7052      1.7215889      3934.8755    
      1200   300.89163     -44754.937      9210.3332      1.7215889      3934.8755    
      1300   312.82941     -44761.37       1891.4319      1.7215889      3934.8755    
      1400   304.22563     -44753.779      17217.103      1.7215889      3934.8755    
      1500   294.41125     -44757.034     -8037.3431      1.7215889      3934.8755    
      1600   281.44264     -44763.897      12293.071      1.7215889      3934.8755    
      1700   288.704       -44759.758      5418.2183      1.7215889      3934.8755    
      1800   306.20379     -44745.803      4745.067       1.7215889      3934.8755    
      1900   304.57484     -44746.537      7760.5024      1.7215889      3934.8755    
      2000   300.03579     -44747.38      -1011.755       1.7215889      3934.8755    
      2100   278.23757     -44751.197      8209.1262      1.7215889      3934.8755    
      2200   285.50008     -44771.741      2711.3416      1.7215889      3934.8755    
      2300   287.9261      -44762.919      4909.2154      1.7215889      3934.8755    
      2400   293.38936     -44754.376     -5720.1759      1.7215889      3934.8755    
      2500   292.45798     -44733.448     -2742.9202      1.7215889      3934.8755    
      2600   310.47903     -44744.276      6216.81        1.7215889      3934.8755    
      2700   294.05931     -44733.355     -2771.8503      1.7215889      3934.8755    
      2800   307.69318     -44753.092      1702.5772      1.7215889      3934.8755    
      2900   299.01013     -44751.854      8667.065       1.7215889      3934.8755    
      3000   311.79612     -44772.875     -9651.3774      1.7215889      3934.8755    
Loop time of 157.92 on 8 procs for 3000 steps with 386 atoms

Performance: 0.821 ns/day, 29.245 hours/ns, 18.997 timesteps/s, 7.333 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 87.115     | 119.17     | 132.23     | 168.3 | 75.46
Bond    | 0.0073206  | 0.0082208  | 0.0093505  |   0.6 |  0.01
Neigh   | 7.0847     | 9.323      | 10.556     |  42.4 |  5.90
Comm    | 1.6137     | 14.662     | 46.707     | 479.2 |  9.28
Output  | 0.008931   | 0.010491   | 0.011664   |   0.8 |  0.01
Modify  | 13.407     | 14.665     | 16.931     |  34.5 |  9.29
Other   |            | 0.07783    |            |       |  0.05

Nlocal:          48.25 ave          55 max          41 min
Histogram: 1 0 2 0 0 2 1 0 0 2
Nghost:         3451.5 ave        3473 max        3421 min
Histogram: 1 0 1 1 0 0 2 0 1 2
Neighs:          33061 ave       37399 max       28408 min
Histogram: 1 0 2 0 0 2 1 0 0 2

Total # of neighbors = 264488
Ave neighs/atom = 685.20207
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.7222
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 0.167222 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134.1 | 134.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   309.50281     -44750.322      2435.91        1.7215889      3934.8755    
       100   314.74293     -44742.434      8345.2546      1.7215889      3934.8755    
       200   326.90905     -44749.466      10244.592      1.7215889      3934.8755    
       300   299.21804     -44735.505      7800.4753      1.7215889      3934.8755    
       400   281.67076     -44730.572      946.82077      1.7215889      3934.8755    
       500   288.42244     -44736.978      2608.0617      1.7215889      3934.8755    
       600   310.94643     -44745.615     -755.46955      1.7215889      3934.8755    
       700   310.16305     -44729.534      13895.998      1.7215889      3934.8755    
       800   311.00329     -44737.573      6281.948       1.7215889      3934.8755    
       900   288.30445     -44732.689      5766.6085      1.7215889      3934.8755    
      1000   287.60876     -44744.21       11530.912      1.7215889      3934.8755    
      1100   304.63188     -44763.845     -2129.9679      1.7215889      3934.8755    
      1200   306.00857     -44751.641      5520.6942      1.7215889      3934.8755    
      1300   295.26624     -44729.869      4670.0413      1.7215889      3934.8755    
      1400   303.02814     -44735.739      2477.3959      1.7215889      3934.8755    
      1500   298.72806     -44743.566      14331.977      1.7215889      3934.8755    
      1600   296.97922     -44766.766     -14643.345      1.7215889      3934.8755    
      1700   286.31961     -44760.335     -2150.7119      1.7215889      3934.8755    
      1800   309.97532     -44767.493      2161.1239      1.7215889      3934.8755    
      1900   303.25752     -44728.481      1555.228       1.7215889      3934.8755    
      2000   313.01575     -44737.817     -0.93100515     1.7215889      3934.8755    
      2100   306.86689     -44757.015      13519.762      1.7215889      3934.8755    
      2200   298.44391     -44776.304     -1797.6034      1.7215889      3934.8755    
      2300   299.18527     -44776.366      697.98908      1.7215889      3934.8755    
      2400   271.06389     -44735.184      16558.563      1.7215889      3934.8755    
      2500   303.17261     -44749.674     -4855.4342      1.7215889      3934.8755    
      2600   320.97874     -44757.851     -5048.6007      1.7215889      3934.8755    
      2700   302.99546     -44752.842      6541.6782      1.7215889      3934.8755    
      2800   289.26704     -44773.912      3699.5665      1.7215889      3934.8755    
      2900   284.15891     -44762.786      5545.1623      1.7215889      3934.8755    
      3000   295.66358     -44757.698      9956.8578      1.7215889      3934.8755    
Loop time of 158.155 on 8 procs for 3000 steps with 386 atoms

Performance: 0.819 ns/day, 29.288 hours/ns, 18.969 timesteps/s, 7.322 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 87.014     | 119.41     | 132.61     | 169.9 | 75.50
Bond    | 0.0072215  | 0.0082195  | 0.0094609  |   0.7 |  0.01
Neigh   | 7.077      | 9.3139     | 10.503     |  42.3 |  5.89
Comm    | 1.5353     | 14.739     | 47.116     | 483.1 |  9.32
Output  | 0.0089703  | 0.010585   | 0.011814   |   0.8 |  0.01
Modify  | 13.387     | 14.596     | 16.864     |  34.6 |  9.23
Other   |            | 0.07916    |            |       |  0.05

Nlocal:          48.25 ave          58 max          39 min
Histogram: 1 0 1 0 3 1 0 0 1 1
Nghost:        3443.62 ave        3483 max        3418 min
Histogram: 1 1 2 1 0 1 1 0 0 1
Neighs:        33043.6 ave       39303 max       27179 min
Histogram: 1 0 1 0 3 1 0 0 1 1

Total # of neighbors = 264349
Ave neighs/atom = 684.84197
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.589
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz--0.3071)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.589
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.3464000000000000412, deltaxy = 0.073464
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.3070999999999999841, deltaxz = 0.003071
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.01799999999999999864, deltayz = 0.00018
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -0.13589 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134 | 134.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   309.50281     -44750.322      2435.91        1.7215889      3934.8755    
       100   314.72422     -44742.416      8342.5719      1.7215889      3934.8755    
       200   324.90084     -44746.879      13482.895      1.7215889      3934.8755    
       300   298.0331      -44733.434      7852.9251      1.7215889      3934.8755    
       400   287.32621     -44737.853      3832.8036      1.7215889      3934.8755    
       500   282.10312     -44734.174     -219.23651      1.7215889      3934.8755    
       600   296.99358     -44735.248     -6898.0329      1.7215889      3934.8755    
       700   307.44682     -44730.593      4868.0637      1.7215889      3934.8755    
       800   293.97363     -44710.703     -72.012777      1.7215889      3934.8755    
       900   301.06844     -44722.934      995.45022      1.7215889      3934.8755    
      1000   309.63156     -44757.117     -2394.804       1.7215889      3934.8755    
      1100   280.85377     -44739.582      3099.77        1.7215889      3934.8755    
      1200   299.93714     -44756.85       14705.33       1.7215889      3934.8755    
      1300   306.68304     -44748.575      11002.813      1.7215889      3934.8755    
      1400   307.64617     -44728.785     -6072.8145      1.7215889      3934.8755    
      1500   340.02675     -44761.416      9730.3339      1.7215889      3934.8755    
      1600   287.9672      -44741.351     -6531.4568      1.7215889      3934.8755    
      1700   294.09766     -44762.205      6667.4099      1.7215889      3934.8755    
      1800   277.67736     -44736.002     -7436.2211      1.7215889      3934.8755    
      1900   298.28254     -44735.867      16965.898      1.7215889      3934.8755    
      2000   292.6142      -44718.646     -1825.7209      1.7215889      3934.8755    
      2100   297.01819     -44733.235     -911.79354      1.7215889      3934.8755    
      2200   279.51207     -44760.739     -1385.1589      1.7215889      3934.8755    
      2300   292.19717     -44770.86      -4090.6522      1.7215889      3934.8755    
      2400   301.28214     -44754.925      8400.0142      1.7215889      3934.8755    
      2500   305.56802     -44742.33       3240.5997      1.7215889      3934.8755    
      2600   316.96342     -44760.178      9562.6701      1.7215889      3934.8755    
      2700   304.12502     -44773.678     -3524.9106      1.7215889      3934.8755    
      2800   285.34689     -44777.413      3583.8169      1.7215889      3934.8755    
      2900   282.56936     -44770.418      1066.0164      1.7215889      3934.8755    
      3000   298.18417     -44766.046      3436.2114      1.7215889      3934.8755    
Loop time of 155.307 on 8 procs for 3000 steps with 386 atoms

Performance: 0.834 ns/day, 28.761 hours/ns, 19.317 timesteps/s, 7.456 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.497     | 111.74     | 129.18     | 144.9 | 71.95
Bond    | 0.0071229  | 0.0080137  | 0.0088378  |   0.5 |  0.01
Neigh   | 7.0419     | 8.8238     | 10.011     |  35.8 |  5.68
Comm    | 2.2861     | 19.713     | 44.948     | 344.6 | 12.69
Output  | 0.0088027  | 0.010459   | 0.011648   |   0.8 |  0.01
Modify  | 13.771     | 14.937     | 16.737     |  27.9 |  9.62
Other   |            | 0.07422    |            |       |  0.05

Nlocal:          48.25 ave          59 max          39 min
Histogram: 1 1 0 1 2 0 1 0 1 1
Nghost:        3460.25 ave        3504 max        3433 min
Histogram: 1 2 1 1 0 2 0 0 0 1
Neighs:        33022.6 ave       39951 max       27136 min
Histogram: 1 1 0 2 1 0 1 1 0 1

Total # of neighbors = 264181
Ave neighs/atom = 684.40674
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.589
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 0.13589 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134.1 | 134.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   309.50281     -44750.322      2435.91        1.7215889      3934.8755    
       100   314.7484      -44742.418      8337.749       1.7215889      3934.8755    
       200   326.82932     -44750.188      10323.944      1.7215889      3934.8755    
       300   297.46547     -44733.975      9422.9763      1.7215889      3934.8755    
       400   286.9535      -44735.377      3945.3121      1.7215889      3934.8755    
       500   287.29396     -44733.847      9134.685       1.7215889      3934.8755    
       600   309.09117     -44741.344      1276.1736      1.7215889      3934.8755    
       700   297.12256     -44712.691     -933.15693      1.7215889      3934.8755    
       800   297.55833     -44710.3        4324.9299      1.7215889      3934.8755    
       900   302.90501     -44723.948     -541.04694      1.7215889      3934.8755    
      1000   303.35548     -44752.526      7843.3294      1.7215889      3934.8755    
      1100   300.83935     -44768.279      9671.5328      1.7215889      3934.8755    
      1200   298.8481      -44765.143     -669.09381      1.7215889      3934.8755    
      1300   319.67162     -44767.809      8783.2695      1.7215889      3934.8755    
      1400   325.0143      -44755.117      4049.1946      1.7215889      3934.8755    
      1500   316.07718     -44737.725     -3782.5692      1.7215889      3934.8755    
      1600   282.89344     -44736.957     -4822.9387      1.7215889      3934.8755    
      1700   279.06144     -44749.898     -3610.7541      1.7215889      3934.8755    
      1800   289.58232     -44746.683      7325.454       1.7215889      3934.8755    
      1900   290.8409      -44731.865      19022.299      1.7215889      3934.8755    
      2000   312.89696     -44745.602      3776.0316      1.7215889      3934.8755    
      2100   318.12064     -44722.713     -542.96167      1.7215889      3934.8755    
      2200   303.09047     -44689.473     -16679.131      1.7215889      3934.8755    
      2300   301.03634     -44718.488      5208.1724      1.7215889      3934.8755    
      2400   302.92679     -44744.204     -5283.5844      1.7215889      3934.8755    
      2500   275.18194     -44732.008     -5769.5711      1.7215889      3934.8755    
      2600   284.03401     -44744.556      3054.0478      1.7215889      3934.8755    
      2700   295.50913     -44740.444      9711.6908      1.7215889      3934.8755    
      2800   300.46163     -44717.728      6107.9233      1.7215889      3934.8755    
      2900   324.16444     -44723.578      3970.2809      1.7215889      3934.8755    
      3000   303.21199     -44739.523      13331.617      1.7215889      3934.8755    
Loop time of 139.036 on 8 procs for 3000 steps with 386 atoms

Performance: 0.932 ns/day, 25.747 hours/ns, 21.577 timesteps/s, 8.329 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 83.328     | 92.28      | 116.16     | 134.9 | 66.37
Bond    | 0.0067771  | 0.007436   | 0.0079885  |   0.4 |  0.01
Neigh   | 7.022      | 7.633      | 9.4495     |  34.9 |  5.49
Comm    | 0.94521    | 24.8       | 33.764     | 260.2 | 17.84
Output  | 0.0075392  | 0.0090066  | 0.0099955  |   0.7 |  0.01
Modify  | 12.427     | 14.237     | 14.837     |  25.7 | 10.24
Other   |            | 0.06943    |            |       |  0.05

Nlocal:          48.25 ave          58 max          39 min
Histogram: 1 0 1 1 1 2 0 0 1 1
Nghost:        3463.25 ave        3513 max        3426 min
Histogram: 1 1 2 0 1 1 0 1 0 1
Neighs:          33028 ave       39237 max       27037 min
Histogram: 1 0 1 1 1 2 0 0 1 1

Total # of neighbors = 264224
Ave neighs/atom = 684.51813
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.3161
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--7.3464)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.3161
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.3464000000000000412, deltaxy = 0.073464
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.3070999999999999841, deltaxz = 0.003071
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.01799999999999999864, deltayz = 0.00018
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -0.173161 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134 | 134.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   309.50281     -44750.322      2435.91        1.7215889      3934.8755    
       100   314.68694     -44742.411      8332.4199      1.7215889      3934.8755    
       200   325.96934     -44748.858      10224.933      1.7215889      3934.8755    
       300   298.97249     -44735.1        9891.3482      1.7215889      3934.8755    
       400   288.5632      -44736.613      1230.2082      1.7215889      3934.8755    
       500   299.41912     -44748.701     -6452.8909      1.7215889      3934.8755    
       600   322.73303     -44760.768      4084.4         1.7215889      3934.8755    
       700   314.41578     -44745.079      11369.13       1.7215889      3934.8755    
       800   314.6903      -44758.054      6524.4813      1.7215889      3934.8755    
       900   276.71878     -44726.623      9387.8614      1.7215889      3934.8755    
      1000   295.98674     -44745.555      19991.275      1.7215889      3934.8755    
      1100   300.15994     -44744.229      5189.1704      1.7215889      3934.8755    
      1200   297.2826      -44730.717      4172.6953      1.7215889      3934.8755    
      1300   298.17183     -44728.534      16913.844      1.7215889      3934.8755    
      1400   286.50485     -44732.169      7120.9696      1.7215889      3934.8755    
      1500   276.73836     -44744.319      3083.3568      1.7215889      3934.8755    
      1600   305.07243     -44779.797      2239.6359      1.7215889      3934.8755    
      1700   304.54538     -44740.033      11092.319      1.7215889      3934.8755    
      1800   312.6629      -44736.435     -10597.196      1.7215889      3934.8755    
      1900   317.63879     -44756.166      337.73773      1.7215889      3934.8755    
      2000   292.03934     -44746.962      1003.5072      1.7215889      3934.8755    
      2100   297.59834     -44755.794      538.66802      1.7215889      3934.8755    
      2200   309.65893     -44745.933     -8736.8008      1.7215889      3934.8755    
      2300   320.35212     -44737.379      3650.0626      1.7215889      3934.8755    
      2400   300.20061     -44744.712      5175.1082      1.7215889      3934.8755    
      2500   299.0532      -44755.917      5703.4843      1.7215889      3934.8755    
      2600   308.32528     -44768.25       672.50779      1.7215889      3934.8755    
      2700   300.77425     -44760.126     -1469.7071      1.7215889      3934.8755    
      2800   284.28239     -44747.052      5831.4511      1.7215889      3934.8755    
      2900   281.60984     -44761.41       4984.6681      1.7215889      3934.8755    
      3000   275.20168     -44756.012      1456.6644      1.7215889      3934.8755    
Loop time of 103.064 on 8 procs for 3000 steps with 386 atoms

Performance: 1.257 ns/day, 19.086 hours/ns, 29.108 timesteps/s, 11.236 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 81.172     | 82.764     | 85.063     |  13.0 | 80.30
Bond    | 0.0064838  | 0.0072057  | 0.0078238  |   0.5 |  0.01
Neigh   | 7.0282     | 7.0766     | 7.1369     |   1.6 |  6.87
Comm    | 0.74561    | 3.0273     | 4.6278     |  67.9 |  2.94
Output  | 0.0054702  | 0.0065919  | 0.0073143  |   0.6 |  0.01
Modify  | 10.062     | 10.111     | 10.145     |   1.0 |  9.81
Other   |            | 0.07045    |            |       |  0.07

Nlocal:          48.25 ave          56 max          44 min
Histogram: 2 2 0 1 1 0 0 1 0 1
Nghost:        3449.38 ave        3478 max        3418 min
Histogram: 1 1 1 0 1 0 1 0 1 2
Neighs:        33058.2 ave       37944 max       30348 min
Histogram: 2 2 0 1 1 0 0 1 0 1

Total # of neighbors = 264466
Ave neighs/atom = 685.14508
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.3161
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 0.173161 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134.1 | 134.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   309.50281     -44750.322      2435.91        1.7215889      3934.8755    
       100   314.79926     -44742.455      8386.6091      1.7215889      3934.8755    
       200   325.19688     -44747.737      10754.7        1.7215889      3934.8755    
       300   298.62302     -44734.661      2549.9735      1.7215889      3934.8755    
       400   293.94822     -44744.353      3023.5657      1.7215889      3934.8755    
       500   288.86531     -44739.712      43.322178      1.7215889      3934.8755    
       600   317.37918     -44760.06       4865.0213      1.7215889      3934.8755    
       700   309.83935     -44745.91       6371.305       1.7215889      3934.8755    
       800   315.95989     -44748.442     -721.49542      1.7215889      3934.8755    
       900   302.32775     -44731.901     -2479.4111      1.7215889      3934.8755    
      1000   309.6415      -44750.301      14135.42       1.7215889      3934.8755    
      1100   293.38874     -44743.878     -538.11939      1.7215889      3934.8755    
      1200   287.77459     -44749.127     -4482.2709      1.7215889      3934.8755    
      1300   290.02747     -44750.7       -1743.5247      1.7215889      3934.8755    
      1400   300.51831     -44738.671      3013.8719      1.7215889      3934.8755    
      1500   308.71964     -44721.627      8260.5124      1.7215889      3934.8755    
      1600   296.81536     -44720.733      6367.8898      1.7215889      3934.8755    
      1700   292.56812     -44737.226      233.48099      1.7215889      3934.8755    
      1800   311.77977     -44766.94       10629.665      1.7215889      3934.8755    
      1900   277.71039     -44731.352      2108.0172      1.7215889      3934.8755    
      2000   289.72942     -44739.247      1195.8675      1.7215889      3934.8755    
      2100   320.24869     -44740.204      1724.2156      1.7215889      3934.8755    
      2200   316.76505     -44726.983     -318.5101       1.7215889      3934.8755    
      2300   295.6744      -44726.22      -687.89552      1.7215889      3934.8755    
      2400   303.59455     -44762.956      2309.896       1.7215889      3934.8755    
      2500   307.84413     -44767.344      3650.4607      1.7215889      3934.8755    
      2600   299.04194     -44753.335      18069.159      1.7215889      3934.8755    
      2700   317.96001     -44753.813     -204.67138      1.7215889      3934.8755    
      2800   327.72772     -44736.217      8654.9204      1.7215889      3934.8755    
      2900   311.27691     -44727.932     -2620.9188      1.7215889      3934.8755    
      3000   299.2294      -44749.17      -412.92888      1.7215889      3934.8755    
Loop time of 96.3858 on 8 procs for 3000 steps with 386 atoms

Performance: 1.345 ns/day, 17.849 hours/ns, 31.125 timesteps/s, 12.014 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 75.165     | 76.436     | 78.548     |  13.1 | 79.30
Bond    | 0.0061703  | 0.0067703  | 0.0071773  |   0.4 |  0.01
Neigh   | 7.0064     | 7.0709     | 7.1388     |   1.5 |  7.34
Comm    | 0.7231     | 2.8174     | 4.0953     |  67.4 |  2.92
Output  | 0.0055466  | 0.006667   | 0.0073955  |   0.7 |  0.01
Modify  | 9.9118     | 9.9791     | 10.027     |   1.0 | 10.35
Other   |            | 0.06854    |            |       |  0.07

Nlocal:          48.25 ave          58 max          37 min
Histogram: 1 0 0 1 1 3 0 0 1 1
Nghost:        3453.38 ave        3483 max        3427 min
Histogram: 3 0 0 0 1 1 0 1 0 2
Neighs:        33061.2 ave       39355 max       25786 min
Histogram: 1 0 0 1 1 3 0 0 1 1

Total # of neighbors = 264490
Ave neighs/atom = 685.20725
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:31:39
