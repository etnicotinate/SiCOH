LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.1                  # the deformation magnitude 0.01

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-48-vasp
read_data       ${structure}.data
read_data       333U-50C-48-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.008 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 7.51026e-05 on 8 procs for 1 steps with 386 atoms

100.7% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.2e-07    | 2.6588e-07 | 4.48e-07   |   0.0 |  0.35
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 7.78e-07   | 1.4209e-06 | 2.418e-06  |   0.0 |  1.89
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 7.342e-05  |            |       | 97.75

Nlocal:          48.25 ave          57 max          44 min
Histogram: 1 3 1 0 2 0 0 0 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-48-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 5000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -0.82 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.5 | 134.6 | 136.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -43252.041      122314.38      1.7215889      3934.8755    
       100   687.78657     -44005.613     -8794.9944      1.7215889      3934.8755    
       200   532.95414     -44212.652      4685.379       1.7215889      3934.8755    
       300   428.38322     -44394.229      13642.414      1.7215889      3934.8755    
       400   357.48885     -44522.718      7814.9119      1.7215889      3934.8755    
       500   305.20861     -44601.4        10808.086      1.7215889      3934.8755    
       600   295.50212     -44683.072     -513.875        1.7215889      3934.8755    
       700   280.46427     -44711.699     -1603.7978      1.7215889      3934.8755    
       800   279.60643     -44705.198      4769.2458      1.7215889      3934.8755    
       900   318.26234     -44701.239     -1818.0216      1.7215889      3934.8755    
      1000   330.13743     -44680.939      314.21565      1.7215889      3934.8755    
      1100   306.37201     -44671.549      338.51067      1.7215889      3934.8755    
      1200   285.35817     -44690.413      18102.578      1.7215889      3934.8755    
      1300   282.87873     -44713.783      16541.07       1.7215889      3934.8755    
      1400   283.9657      -44719.988      13551.045      1.7215889      3934.8755    
      1500   299.28169     -44731.239     -5446.4411      1.7215889      3934.8755    
      1600   295.10399     -44708.179      13091.763      1.7215889      3934.8755    
      1700   306.5935      -44695.641      12607.525      1.7215889      3934.8755    
      1800   307.96105     -44688.824      114.19541      1.7215889      3934.8755    
      1900   297.5467      -44689.544     -11232.833      1.7215889      3934.8755    
      2000   297.63273     -44718.624      3681.1426      1.7215889      3934.8755    
      2100   284.48949     -44729.07       1810.321       1.7215889      3934.8755    
      2200   299.39507     -44746.849      9777.7339      1.7215889      3934.8755    
      2300   309.12185     -44739.177      11871.005      1.7215889      3934.8755    
      2400   299.81281     -44711.424      2203.2625      1.7215889      3934.8755    
      2500   301.13092     -44712.816      7486.3507      1.7215889      3934.8755    
      2600   306.0768      -44733.777      3844.6675      1.7215889      3934.8755    
      2700   294.99852     -44744.953      10956.358      1.7215889      3934.8755    
      2800   294.76019     -44755.788      4132.5298      1.7215889      3934.8755    
      2900   285.45879     -44739.503     -2290.237       1.7215889      3934.8755    
      3000   309.50281     -44750.322      2435.9873      1.7215889      3934.8755    
      3100   314.73712     -44742.419      8340.3933      1.7215889      3934.8755    
      3200   326.53126     -44749.437      10657.911      1.7215889      3934.8755    
      3300   295.16909     -44731.493      8257.407       1.7215889      3934.8755    
      3400   292.9241      -44743.045      8182.1669      1.7215889      3934.8755    
      3500   283.20046     -44729.674      4780.2246      1.7215889      3934.8755    
      3600   305.51784     -44738.131      1590.8649      1.7215889      3934.8755    
      3700   301.51588     -44726.194      4467.4394      1.7215889      3934.8755    
      3800   294.5715      -44718.063      4049.8417      1.7215889      3934.8755    
      3900   300.41981     -44726.758      2634.9868      1.7215889      3934.8755    
      4000   312.16215     -44750.027      2877.9817      1.7215889      3934.8755    
      4100   289.12908     -44738.722     -2872.6379      1.7215889      3934.8755    
      4200   305.58818     -44759.726     -13594.074      1.7215889      3934.8755    
      4300   308.09624     -44755.606      5295.1338      1.7215889      3934.8755    
      4400   296.91399     -44738.061      5085.6296      1.7215889      3934.8755    
      4500   323.07252     -44754.198     -4029.3777      1.7215889      3934.8755    
      4600   291.16467     -44724.781     -7238.1595      1.7215889      3934.8755    
      4700   279.14905     -44740.685      9001.4202      1.7215889      3934.8755    
      4800   299.96085     -44770.766      2160.0338      1.7215889      3934.8755    
      4900   292.84799     -44743.583      3770.9843      1.7215889      3934.8755    
      5000   328.55655     -44747.086      6918.6963      1.7215889      3934.8755    
Loop time of 255.271 on 8 procs for 5000 steps with 386 atoms

Performance: 0.846 ns/day, 28.363 hours/ns, 19.587 timesteps/s, 7.561 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 146.05     | 188.28     | 214.42     | 222.8 | 73.76
Bond    | 0.0016705  | 0.0018307  | 0.0021976  |   0.4 |  0.00
Neigh   | 11.334     | 14.848     | 17.157     |  68.7 |  5.82
Comm    | 3.0514     | 29.192     | 71.384     | 565.6 | 11.44
Output  | 0.0025043  | 0.0026579  | 0.0036093  |   0.7 |  0.00
Modify  | 20.554     | 22.851     | 26.393     |  55.8 |  8.95
Other   |            | 0.09225    |            |       |  0.04

Nlocal:          48.25 ave          56 max          40 min
Histogram: 1 1 1 1 0 0 1 0 2 1
Nghost:        3457.75 ave        3494 max        3433 min
Histogram: 1 1 3 0 1 0 0 0 0 2
Neighs:        33034.8 ave       37996 max       27757 min
Histogram: 1 1 1 1 0 0 1 0 1 2

Total # of neighbors = 264278
Ave neighs/atom = 684.65803
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333U-50C-48-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.7222
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.589
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.3161

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal -0.018
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal -0.3071
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -7.3464

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 16.7222
variable dlen equal lx-${len0}
variable dlen equal lx-16.7222
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*16.7222
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.3464000000000000412, deltaxy = 0.73464
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.3070999999999999841, deltaxz = 0.03071
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.01799999999999999864, deltayz = 0.0018
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.67222 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.67222 xy delta 0.73464 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.67222 xy delta 0.73464 xz delta 0.03071 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.4 | 134.5 | 136.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   328.55655     -44747.086      6918.7212      3934.8755      16.7222        13.589         17.3161      
       100   307.1385      -44715.451      24303.352      3927.0058      16.688756      13.589         17.3161      
       200   310.30904     -44744.179     -9200.8689      3919.136       16.655311      13.589         17.3161      
       300   310.20567     -44749.833     -1009.1676      3911.2663      16.621867      13.589         17.3161      
       400   285.44003     -44740.364      6906.0507      3903.3965      16.588422      13.589         17.3161      
       500   287.11734     -44751.618      14109.353      3895.5268      16.554978      13.589         17.3161      
       600   286.56874     -44739.954      6455.4532      3887.657       16.521534      13.589         17.3161      
       700   322.23636     -44769.229     -252.16287      3879.7873      16.488089      13.589         17.3161      
       800   286.84958     -44747.247      1666.8072      3871.9175      16.454645      13.589         17.3161      
       900   298.38535     -44752.985      11548.264      3864.0478      16.4212        13.589         17.3161      
      1000   307.66378     -44752.423      10763.206      3856.178       16.387756      13.589         17.3161      
      1100   306.64245     -44770.991      8609.328       3848.3083      16.354312      13.589         17.3161      
      1200   288.66562     -44765.779      5626.3246      3840.4385      16.320867      13.589         17.3161      
      1300   301.76721     -44770.763      19881.35       3832.5687      16.287423      13.589         17.3161      
      1400   281.43996     -44734.214      8698.9744      3824.699       16.253978      13.589         17.3161      
      1500   294.06392     -44754.49       12924.543      3816.8292      16.220534      13.589         17.3161      
      1600   265.78221     -44744.551      5093.9404      3808.9595      16.18709       13.589         17.3161      
      1700   285.1063      -44755.635      10819.845      3801.0897      16.153645      13.589         17.3161      
      1800   307.21365     -44755.929      20946.803      3793.22        16.120201      13.589         17.3161      
      1900   323.18312     -44754.189      14487.683      3785.3502      16.086756      13.589         17.3161      
      2000   298.62167     -44757.528      10492.81       3777.4805      16.053312      13.589         17.3161      
      2100   287.99869     -44748.091      25225.643      3769.6107      16.019868      13.589         17.3161      
      2200   297.65586     -44748.317      26420.643      3761.741       15.986423      13.589         17.3161      
      2300   293.18888     -44744.019      8738.9945      3753.8712      15.952979      13.589         17.3161      
      2400   282.84442     -44731.5        29544.582      3746.0015      15.919534      13.589         17.3161      
      2500   308.07047     -44744.109      9436.6177      3738.1317      15.88609       13.589         17.3161      
      2600   284.76746     -44727.474      34245.338      3730.262       15.852646      13.589         17.3161      
      2700   288.31713     -44735.279      33581.984      3722.3922      15.819201      13.589         17.3161      
      2800   292.61155     -44732.569      13934.777      3714.5225      15.785757      13.589         17.3161      
      2900   320.99515     -44746.166      35652.421      3706.6527      15.752312      13.589         17.3161      
      3000   297.20856     -44729.457      24555.881      3698.783       15.718868      13.589         17.3161      
      3100   288.00114     -44739.93       23742.026      3690.9132      15.685424      13.589         17.3161      
      3200   308.61576     -44747.32       12876.408      3683.0435      15.651979      13.589         17.3161      
      3300   310.74194     -44727.534      24763.083      3675.1737      15.618535      13.589         17.3161      
      3400   310.56512     -44722.954      20721.229      3667.304       15.58509       13.589         17.3161      
      3500   286.98525     -44713.703      28376.814      3659.4342      15.551646      13.589         17.3161      
      3600   290.73348     -44723.65       35184.102      3651.5645      15.518202      13.589         17.3161      
      3700   300.05558     -44730.949      8196.8105      3643.6947      15.484757      13.589         17.3161      
      3800   303.04126     -44723.872      12361.629      3635.825       15.451313      13.589         17.3161      
      3900   312.70675     -44706.365      28484.593      3627.9552      15.417868      13.589         17.3161      
      4000   332.23937     -44684.538      48697.776      3620.0855      15.384424      13.589         17.3161      
      4100   311.36325     -44676.138      40740.849      3612.2157      15.35098       13.589         17.3161      
      4200   317.23675     -44696.355      32189.844      3604.346       15.317535      13.589         17.3161      
      4300   296.21154     -44680.778      34906.358      3596.4762      15.284091      13.589         17.3161      
      4400   283.38205     -44672.341      45374.827      3588.6065      15.250646      13.589         17.3161      
      4500   313.09863     -44688.424      36314.041      3580.7367      15.217202      13.589         17.3161      
      4600   300.9877      -44680.342      34804.745      3572.867       15.183758      13.589         17.3161      
      4700   302.68956     -44678.495      45017.145      3564.9972      15.150313      13.589         17.3161      
      4800   299.34961     -44653.869      27348.258      3557.1275      15.116869      13.589         17.3161      
      4900   308.1325      -44663.836      48796.909      3549.2577      15.083424      13.589         17.3161      
      5000   300.66463     -44655.421      36188.045      3541.388       15.04998       13.589         17.3161      
Loop time of 290.986 on 8 procs for 5000 steps with 386 atoms

Performance: 0.742 ns/day, 32.332 hours/ns, 17.183 timesteps/s, 6.633 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 166.08     | 221.31     | 244.1      | 189.2 | 76.06
Bond    | 0.0018098  | 0.0020175  | 0.0024268  |   0.4 |  0.00
Neigh   | 13.552     | 18.219     | 20.287     |  58.1 |  6.26
Comm    | 3.1509     | 25.901     | 81.135     | 552.7 |  8.90
Output  | 0.015721   | 0.018143   | 0.019605   |   0.8 |  0.01
Modify  | 23.356     | 25.423     | 30.106     |  49.5 |  8.74
Other   |            | 0.1075     |            |       |  0.04

Nlocal:          48.25 ave          53 max          44 min
Histogram: 1 0 1 3 0 0 1 0 1 1
Nghost:        3691.75 ave        3738 max        3648 min
Histogram: 1 1 0 1 1 1 1 0 1 1
Neighs:        36784.2 ave       40292 max       33645 min
Histogram: 1 0 1 3 0 0 1 0 1 1

Total # of neighbors = 294274
Ave neighs/atom = 762.36788
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*16.7222
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.67222 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.67222 xy delta -0.73464 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.67222 xy delta -0.73464 xz delta -0.03071 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134.5 | 136.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   328.55655     -44747.086      6918.7212      3934.8755      16.7222        13.589         17.3161      
       100   306.30092     -44714.893      23911.441      3942.7453      16.755644      13.589         17.3161      
       200   302.80117     -44751.076     -8348.6778      3950.615       16.789089      13.589         17.3161      
       300   306.09831     -44761.925      6349.2734      3958.4848      16.822533      13.589         17.3161      
       400   290.70556     -44749.825      39.419057      3966.3545      16.855978      13.589         17.3161      
       500   285.4716      -44750.796      370.69926      3974.2243      16.889422      13.589         17.3161      
       600   283.35279     -44747.666     -6985.3303      3982.094       16.922866      13.589         17.3161      
       700   290.4623      -44742.358     -1684.6113      3989.9638      16.956311      13.589         17.3161      
       800   298.84179     -44744.803     -217.27722      3997.8335      16.989755      13.589         17.3161      
       900   317.1059      -44776.725     -8045.5739      4005.7033      17.0232        13.589         17.3161      
      1000   300.7706      -44776.414      6776.9149      4013.573       17.056644      13.589         17.3161      
      1100   297.13549     -44762.905      5345.7416      4021.4428      17.090088      13.589         17.3161      
      1200   310.23094     -44760.433      6434.6765      4029.3125      17.123533      13.589         17.3161      
      1300   293.7016      -44724.8        4348.5749      4037.1823      17.156977      13.589         17.3161      
      1400   299.23905     -44745.927      344.80514      4045.052       17.190422      13.589         17.3161      
      1500   301.69089     -44764.631     -12332.391      4052.9218      17.223866      13.589         17.3161      
      1600   298.2882      -44757.203     -7772.2845      4060.7915      17.25731       13.589         17.3161      
      1700   315.421       -44746.905     -10857.902      4068.6613      17.290755      13.589         17.3161      
      1800   312.41003     -44705.902     -4066.5938      4076.531       17.324199      13.589         17.3161      
      1900   319.2224      -44725.46      -10288.506      4084.4008      17.357644      13.589         17.3161      
      2000   301.67605     -44729.096     -17249.434      4092.2705      17.391088      13.589         17.3161      
      2100   311.46446     -44741.406      4590.5971      4100.1403      17.424532      13.589         17.3161      
      2200   298.72994     -44743.319     -4312.7803      4108.01        17.457977      13.589         17.3161      
      2300   282.72261     -44743.476     -6412.5286      4115.8798      17.491421      13.589         17.3161      
      2400   300.66846     -44753.733     -9068.1101      4123.7495      17.524866      13.589         17.3161      
      2500   301.43675     -44725.255     -11200.26       4131.6193      17.55831       13.589         17.3161      
      2600   311.26907     -44706.848     -10987.995      4139.489       17.591754      13.589         17.3161      
      2700   297.99074     -44706.489     -6817.3934      4147.3588      17.625199      13.589         17.3161      
      2800   314.40505     -44758.21      -14306.712      4155.2285      17.658643      13.589         17.3161      
      2900   284.2519      -44733.102     -25769.009      4163.0983      17.692088      13.589         17.3161      
      3000   300.72194     -44753.091     -17602.343      4170.968       17.725532      13.589         17.3161      
      3100   322.42237     -44769.379     -15641.037      4178.8378      17.758976      13.589         17.3161      
      3200   291.58098     -44742.628     -8754.0708      4186.7075      17.792421      13.589         17.3161      
      3300   288.25331     -44741.322     -19722.809      4194.5773      17.825865      13.589         17.3161      
      3400   287.73692     -44735.13      -16612.862      4202.447       17.85931       13.589         17.3161      
      3500   310.33715     -44731.895     -7485.1669      4210.3168      17.892754      13.589         17.3161      
      3600   308.28878     -44704.47      -10304.383      4218.1865      17.926198      13.589         17.3161      
      3700   311.62148     -44716.755     -11290.849      4226.0563      17.959643      13.589         17.3161      
      3800   295.40096     -44726.318     -10130.845      4233.9261      17.993087      13.589         17.3161      
      3900   290.07122     -44722.748     -14526.902      4241.7958      18.026532      13.589         17.3161      
      4000   298.28696     -44713.179     -15849.334      4249.6656      18.059976      13.589         17.3161      
      4100   293.76595     -44682.646     -24186.88       4257.5353      18.09342       13.589         17.3161      
      4200   323.65251     -44681.109     -5002.4446      4265.4051      18.126865      13.589         17.3161      
      4300   313.89337     -44680.603     -14771.062      4273.2748      18.160309      13.589         17.3161      
      4400   301.61306     -44693.911     -20348.883      4281.1446      18.193754      13.589         17.3161      
      4500   310.77633     -44719.998     -14732          4289.0143      18.227198      13.589         17.3161      
      4600   303.58348     -44726.684     -15464.745      4296.8841      18.260642      13.589         17.3161      
      4700   287.64285     -44707.069     -16805.609      4304.7538      18.294087      13.589         17.3161      
      4800   286.9883      -44708.188     -27072.957      4312.6236      18.327531      13.589         17.3161      
      4900   294.33872     -44717.913     -23017.453      4320.4933      18.360976      13.589         17.3161      
      5000   296.07021     -44705.873     -10964.385      4328.3631      18.39442       13.589         17.3161      
Loop time of 263.297 on 8 procs for 5000 steps with 386 atoms

Performance: 0.820 ns/day, 29.255 hours/ns, 18.990 timesteps/s, 7.330 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 151.69     | 209.39     | 220.74     | 151.6 | 79.52
Bond    | 0.0018919  | 0.0021087  | 0.0024386  |   0.4 |  0.00
Neigh   | 11.292     | 15.581     | 16.551     |  41.7 |  5.92
Comm    | 3.3852     | 14.729     | 72.449     | 571.7 |  5.59
Output  | 0.017114   | 0.019651   | 0.021441   |   0.9 |  0.01
Modify  | 22.505     | 23.46      | 27.74      |  33.9 |  8.91
Other   |            | 0.1182     |            |       |  0.04

Nlocal:          48.25 ave          56 max          37 min
Histogram: 1 0 1 0 0 2 1 1 0 2
Nghost:        3271.62 ave        3293 max        3252 min
Histogram: 2 0 0 0 2 2 1 0 0 1
Neighs:        29975.2 ave       34548 max       23236 min
Histogram: 1 0 1 0 0 2 1 1 0 2

Total # of neighbors = 239802
Ave neighs/atom = 621.2487
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.589
variable dlen equal ly-${len0}
variable dlen equal ly-13.589
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.589
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.3464000000000000412, deltaxy = 0.73464
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.3070999999999999841, deltaxz = 0.03071
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.01799999999999999864, deltayz = 0.0018
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.3589 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.3589 yz delta 0.0018 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.4 | 134.5 | 136.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   328.55655     -44747.086      6918.7212      3934.8755      16.7222        13.589         17.3161      
       100   306.91132     -44715.259      24231.489      3927.0058      16.7222        13.561822      17.3161      
       200   306.25088     -44748.161     -9292.3863      3919.136       16.7222        13.534644      17.3161      
       300   312.40013     -44763.53      -5155.0474      3911.2663      16.7222        13.507466      17.3161      
       400   285.98434     -44741.766      9388.9639      3903.3965      16.7222        13.480288      17.3161      
       500   275.29379     -44738.581      703.04567      3895.5268      16.7222        13.45311       17.3161      
       600   292.95271     -44756.493      4425.775       3887.657       16.7222        13.425932      17.3161      
       700   308.20516     -44754.159      17418.17       3879.7873      16.7222        13.398754      17.3161      
       800   320.64411     -44744.085      8546.58        3871.9175      16.7222        13.371576      17.3161      
       900   290.0294      -44714.599      6340.7034      3864.0478      16.7222        13.344398      17.3161      
      1000   299.26766     -44754.432      12233.044      3856.178       16.7222        13.31722       17.3161      
      1100   285.16768     -44735.173      16827.447      3848.3083      16.7222        13.290042      17.3161      
      1200   296.83959     -44747.233      5299.4105      3840.4385      16.7222        13.262864      17.3161      
      1300   288.68587     -44759.778      27149.779      3832.5687      16.7222        13.235686      17.3161      
      1400   298.28554     -44769.789      3209.2483      3824.699       16.7222        13.208508      17.3161      
      1500   288.75948     -44746.429      12038.308      3816.8292      16.7222        13.18133       17.3161      
      1600   288.58613     -44732.681      15619.898      3808.9595      16.7222        13.154152      17.3161      
      1700   313.86428     -44747.003      9104.2991      3801.0897      16.7222        13.126974      17.3161      
      1800   289.01996     -44754.263      13515.107      3793.22        16.7222        13.099796      17.3161      
      1900   290.87435     -44763.784      12158.539      3785.3502      16.7222        13.072618      17.3161      
      2000   281.82157     -44754.648      4969.9541      3777.4805      16.7222        13.04544       17.3161      
      2100   300.3432      -44770.14       2699.8936      3769.6107      16.7222        13.018262      17.3161      
      2200   294.78223     -44752.215      16941.485      3761.741       16.7222        12.991084      17.3161      
      2300   302.196       -44751.035      15993.294      3753.8712      16.7222        12.963906      17.3161      
      2400   309.13348     -44751.849      31355.891      3746.0015      16.7222        12.936728      17.3161      
      2500   319.60368     -44760.738      19410.905      3738.1317      16.7222        12.90955       17.3161      
      2600   294.1501      -44751.783      10500.969      3730.262       16.7222        12.882372      17.3161      
      2700   299.53698     -44749.407      16224.201      3722.3922      16.7222        12.855194      17.3161      
      2800   307.58803     -44736.9        19026.442      3714.5225      16.7222        12.828016      17.3161      
      2900   308.74244     -44715.751      31090.551      3706.6527      16.7222        12.800838      17.3161      
      3000   303.12945     -44683.395      22000.987      3698.783       16.7222        12.77366       17.3161      
      3100   322.85035     -44716.834      8318.2615      3690.9132      16.7222        12.746482      17.3161      
      3200   301.96662     -44715.993      33760.848      3683.0435      16.7222        12.719304      17.3161      
      3300   311.6899      -44730.452      40734.49       3675.1737      16.7222        12.692126      17.3161      
      3400   308.60466     -44730.318      17109.076      3667.304       16.7222        12.664948      17.3161      
      3500   291.41083     -44712.452      25486.311      3659.4342      16.7222        12.63777       17.3161      
      3600   291.06252     -44727.487      28472.656      3651.5645      16.7222        12.610592      17.3161      
      3700   273.99879     -44721.605      43475.077      3643.6947      16.7222        12.583414      17.3161      
      3800   282.2058      -44727.567      35334.766      3635.825       16.7222        12.556236      17.3161      
      3900   312.29494     -44716.593      10730.235      3627.9552      16.7222        12.529058      17.3161      
      4000   294.60262     -44680.534      41339.673      3620.0855      16.7222        12.50188       17.3161      
      4100   296.73227     -44693.03       32115.696      3612.2157      16.7222        12.474702      17.3161      
      4200   297.7422      -44705.329      40057.653      3604.346       16.7222        12.447524      17.3161      
      4300   292.18486     -44699.349      36771.903      3596.4762      16.7222        12.420346      17.3161      
      4400   287.71259     -44679.054      49422.1        3588.6065      16.7222        12.393168      17.3161      
      4500   302.00329     -44657.591      40942.545      3580.7367      16.7222        12.36599       17.3161      
      4600   305.77946     -44635.423      43484.284      3572.867       16.7222        12.338812      17.3161      
      4700   302.46149     -44641.787      30096.662      3564.9972      16.7222        12.311634      17.3161      
      4800   298.72112     -44655.211      48249.075      3557.1275      16.7222        12.284456      17.3161      
      4900   289.11694     -44647.018      30488.556      3549.2577      16.7222        12.257278      17.3161      
      5000   294.64206     -44661.171      40191.586      3541.388       16.7222        12.2301        17.3161      
Loop time of 303.922 on 8 procs for 5000 steps with 386 atoms

Performance: 0.711 ns/day, 33.769 hours/ns, 16.452 timesteps/s, 6.350 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 176.12     | 243.56     | 258.04     | 163.9 | 80.14
Bond    | 0.0018729  | 0.0021443  | 0.0026029  |   0.5 |  0.00
Neigh   | 12.397     | 17.32      | 18.491     |  45.3 |  5.70
Comm    | 2.5467     | 17.028     | 84.484     | 620.0 |  5.60
Output  | 0.016763   | 0.019441   | 0.021143   |   0.9 |  0.01
Modify  | 24.72      | 25.873     | 30.789     |  37.0 |  8.51
Other   |            | 0.1172     |            |       |  0.04

Nlocal:          48.25 ave          52 max          44 min
Histogram: 2 1 0 0 0 1 0 1 1 2
Nghost:        3812.25 ave        3853 max        3777 min
Histogram: 3 1 0 0 0 0 0 2 0 2
Neighs:        36786.8 ave       39464 max       33503 min
Histogram: 2 1 0 0 0 1 0 1 0 3

Total # of neighbors = 294294
Ave neighs/atom = 762.41969
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.589
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.3589 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.3589 yz delta -0.0018 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134.5 | 136.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   328.55655     -44747.086      6918.7212      3934.8755      16.7222        13.589         17.3161      
       100   306.56825     -44715.131      24005.707      3942.7453      16.7222        13.616178      17.3161      
       200   307.55082     -44754.535     -6489.3658      3950.615       16.7222        13.643356      17.3161      
       300   322.58751     -44782.621      3883.2093      3958.4848      16.7222        13.670534      17.3161      
       400   297.39764     -44759.808     -2410.2775      3966.3545      16.7222        13.697712      17.3161      
       500   290.59831     -44761.537      3549.5084      3974.2243      16.7222        13.72489       17.3161      
       600   300.92464     -44776.981      2099.2021      3982.094       16.7222        13.752068      17.3161      
       700   294.30695     -44750.201      21954.661      3989.9638      16.7222        13.779246      17.3161      
       800   333.39437     -44747.813     -6967.577       3997.8335      16.7222        13.806424      17.3161      
       900   309.43768     -44729.753     -6452.5503      4005.7033      16.7222        13.833602      17.3161      
      1000   322.10359     -44763.548     -16993.105      4013.573       16.7222        13.86078       17.3161      
      1100   291.35174     -44736.294     -11064.723      4021.4428      16.7222        13.887958      17.3161      
      1200   287.60843     -44732.535      1336.7323      4029.3125      16.7222        13.915136      17.3161      
      1300   293.88127     -44739.389     -4294.6714      4037.1823      16.7222        13.942314      17.3161      
      1400   278.15169     -44741.06      -11001.164      4045.052       16.7222        13.969492      17.3161      
      1500   287.60197     -44767.594     -11340.428      4052.9218      16.7222        13.99667       17.3161      
      1600   290.59667     -44753.764     -7310.6927      4060.7915      16.7222        14.023848      17.3161      
      1700   302.04019     -44721.374     -1273.0563      4068.6613      16.7222        14.051026      17.3161      
      1800   294.5973      -44704.813     -16924.888      4076.531       16.7222        14.078204      17.3161      
      1900   311.44961     -44732.819      6846.2427      4084.4008      16.7222        14.105382      17.3161      
      2000   302.26794     -44739.32      -13568.009      4092.2705      16.7222        14.13256       17.3161      
      2100   282.37443     -44720.192      1257.0132      4100.1403      16.7222        14.159738      17.3161      
      2200   286.48747     -44722.029     -4136.1782      4108.01        16.7222        14.186916      17.3161      
      2300   298.18669     -44711.499     -16828.993      4115.8798      16.7222        14.214094      17.3161      
      2400   323.96315     -44690.173      9438.4654      4123.7495      16.7222        14.241272      17.3161      
      2500   305.16741     -44684.959     -26896.032      4131.6193      16.7222        14.26845       17.3161      
      2600   312.88676     -44714.317     -14025.644      4139.489       16.7222        14.295628      17.3161      
      2700   297.05316     -44703.831     -10448.199      4147.3588      16.7222        14.322806      17.3161      
      2800   302.98866     -44719.302     -21907.227      4155.2285      16.7222        14.349984      17.3161      
      2900   295.76232     -44726.78      -8060.4928      4163.0983      16.7222        14.377162      17.3161      
      3000   298.62794     -44732.265     -7381.3797      4170.968       16.7222        14.40434       17.3161      
      3100   292.04352     -44709.016     -21534.484      4178.8378      16.7222        14.431518      17.3161      
      3200   322.54568     -44697.8       -22413.578      4186.7075      16.7222        14.458696      17.3161      
      3300   319.68389     -44681.397     -26290.058      4194.5773      16.7222        14.485874      17.3161      
      3400   292.1254      -44680.056     -20365.68       4202.447       16.7222        14.513052      17.3161      
      3500   296.67551     -44696.684     -12981.057      4210.3168      16.7222        14.54023       17.3161      
      3600   289.59053     -44694.808     -19589.446      4218.1865      16.7222        14.567408      17.3161      
      3700   308.45581     -44722.458     -16348.352      4226.0563      16.7222        14.594586      17.3161      
      3800   292.25041     -44717.912     -23693.248      4233.9261      16.7222        14.621764      17.3161      
      3900   279.85484     -44722.322     -19022.609      4241.7958      16.7222        14.648942      17.3161      
      4000   278.68169     -44713.44      -14058.42       4249.6656      16.7222        14.67612       17.3161      
      4100   301.70886     -44685.934     -5466.1006      4257.5353      16.7222        14.703298      17.3161      
      4200   304.58509     -44669.723     -22068.904      4265.4051      16.7222        14.730476      17.3161      
      4300   299.6504      -44662.841     -19178.882      4273.2748      16.7222        14.757654      17.3161      
      4400   296.5585      -44678.22      -8787.5031      4281.1446      16.7222        14.784832      17.3161      
      4500   301.19634     -44685.939     -14633.816      4289.0143      16.7222        14.81201       17.3161      
      4600   302.84041     -44672.841     -24219.457      4296.8841      16.7222        14.839188      17.3161      
      4700   309.86204     -44644.805     -17653.575      4304.7538      16.7222        14.866366      17.3161      
      4800   342.95312     -44653.66      -18897.951      4312.6236      16.7222        14.893544      17.3161      
      4900   326.79584     -44665.173     -16198.582      4320.4933      16.7222        14.920722      17.3161      
      5000   299.99966     -44662.603     -8553.0728      4328.3631      16.7222        14.9479        17.3161      
Loop time of 260.461 on 8 procs for 5000 steps with 386 atoms

Performance: 0.829 ns/day, 28.940 hours/ns, 19.197 timesteps/s, 7.410 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 148.29     | 205.97     | 217.75     | 153.0 | 79.08
Bond    | 0.0019722  | 0.0021599  | 0.0026501  |   0.4 |  0.00
Neigh   | 10.749     | 15.228     | 16.515     |  44.4 |  5.85
Comm    | 3.7215     | 15.502     | 73.194     | 557.9 |  5.95
Output  | 0.01767    | 0.020079   | 0.021844   |   0.9 |  0.01
Modify  | 22.342     | 23.63      | 28.104     |  35.6 |  9.07
Other   |            | 0.112      |            |       |  0.04

Nlocal:          48.25 ave          59 max          35 min
Histogram: 1 0 1 0 1 1 2 1 0 1
Nghost:        3168.38 ave        3235 max        3113 min
Histogram: 2 0 1 0 1 2 0 0 1 1
Neighs:        29980.6 ave       36146 max       22207 min
Histogram: 1 0 1 0 1 1 2 0 1 1

Total # of neighbors = 239845
Ave neighs/atom = 621.3601
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.3161
variable dlen equal lz-${len0}
variable dlen equal lz-17.3161
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.3161
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.3464000000000000412, deltaxy = 0.73464
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.3070999999999999841, deltaxz = 0.03071
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.01799999999999999864, deltayz = 0.0018
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -1.73161 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.4 | 134.5 | 136.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   328.55655     -44747.086      6918.7212      3934.8755      16.7222        13.589         17.3161      
       100   306.69818     -44714.905      24675.001      3927.0058      16.7222        13.589         17.281468    
       200   302.96362     -44741.08      -2599.1655      3919.136       16.7222        13.589         17.246836    
       300   314.22036     -44766.336      4814.625       3911.2663      16.7222        13.589         17.212203    
       400   297.71653     -44754.297      14766.537      3903.3965      16.7222        13.589         17.177571    
       500   286.58988     -44755.906      4516.3068      3895.5268      16.7222        13.589         17.142939    
       600   294.80221     -44768.288      14104.695      3887.657       16.7222        13.589         17.108307    
       700   289.78187     -44750.932      17745.818      3879.7873      16.7222        13.589         17.073675    
       800   303.90607     -44720.263      7618.4469      3871.9175      16.7222        13.589         17.039042    
       900   304.13842     -44702.457      7741.7268      3864.0478      16.7222        13.589         17.00441     
      1000   327.02086     -44751.78       7977.3223      3856.178       16.7222        13.589         16.969778    
      1100   298.701       -44730.785      7602.1492      3848.3083      16.7222        13.589         16.935146    
      1200   297.33178     -44727.636      15799.126      3840.4385      16.7222        13.589         16.900514    
      1300   294.73999     -44724.755      31144.266      3832.5687      16.7222        13.589         16.865881    
      1400   306.1283      -44758.564      17048.801      3824.699       16.7222        13.589         16.831249    
      1500   286.74623     -44745.96       13372.168      3816.8292      16.7222        13.589         16.796617    
      1600   292.52355     -44741.048      8545.2322      3808.9595      16.7222        13.589         16.761985    
      1700   296.73656     -44743.362      8220.4367      3801.0897      16.7222        13.589         16.727353    
      1800   288.5138      -44743.117      8529.6885      3793.22        16.7222        13.589         16.69272     
      1900   292.01743     -44768.326      20430.709      3785.3502      16.7222        13.589         16.658088    
      2000   292.4377      -44764.28       7848.6954      3777.4805      16.7222        13.589         16.623456    
      2100   326.42531     -44770.843      16695.419      3769.6107      16.7222        13.589         16.588824    
      2200   296.99889     -44714.424      15150.491      3761.741       16.7222        13.589         16.554192    
      2300   315.32737     -44751.286      11215.115      3753.8712      16.7222        13.589         16.519559    
      2400   303.97291     -44761.929      24891.382      3746.0015      16.7222        13.589         16.484927    
      2500   296.40213     -44750.602      22651.523      3738.1317      16.7222        13.589         16.450295    
      2600   300.12069     -44752.098      31260.82       3730.262       16.7222        13.589         16.415663    
      2700   285.97764     -44739.332      29667.823      3722.3922      16.7222        13.589         16.381031    
      2800   295.05314     -44759.672      11053.634      3714.5225      16.7222        13.589         16.346398    
      2900   294.22237     -44761.524      13291.939      3706.6527      16.7222        13.589         16.311766    
      3000   319.88287     -44772.287      20727.331      3698.783       16.7222        13.589         16.277134    
      3100   306.34587     -44734.28       5742.6221      3690.9132      16.7222        13.589         16.242502    
      3200   295.96152     -44715.633      17995.226      3683.0435      16.7222        13.589         16.20787     
      3300   297.14461     -44734.999      23271.927      3675.1737      16.7222        13.589         16.173237    
      3400   298.80796     -44749.911      34657.303      3667.304       16.7222        13.589         16.138605    
      3500   295.71482     -44739.227      22023.846      3659.4342      16.7222        13.589         16.103973    
      3600   311.19631     -44754.235      27840.73       3651.5645      16.7222        13.589         16.069341    
      3700   289.62827     -44747.845      36566.277      3643.6947      16.7222        13.589         16.034709    
      3800   299.57022     -44756.023      28988.64       3635.825       16.7222        13.589         16.000076    
      3900   288.40026     -44737.703      21553.667      3627.9552      16.7222        13.589         15.965444    
      4000   314.08956     -44745.615      29908.999      3620.0855      16.7222        13.589         15.930812    
      4100   297.93177     -44728.842      31946.903      3612.2157      16.7222        13.589         15.89618     
      4200   293.54046     -44729.539      23245.75       3604.346       16.7222        13.589         15.861548    
      4300   292.29343     -44725.65       37187.603      3596.4762      16.7222        13.589         15.826915    
      4400   308.58055     -44738.88       26930.302      3588.6065      16.7222        13.589         15.792283    
      4500   304.08553     -44708.733      34592.342      3580.7367      16.7222        13.589         15.757651    
      4600   312.13844     -44690.67       24910.716      3572.867       16.7222        13.589         15.723019    
      4700   311.19092     -44698.474      42726.775      3564.9972      16.7222        13.589         15.688387    
      4800   301.7948      -44704.639      21308.951      3557.1275      16.7222        13.589         15.653754    
      4900   304.1075      -44706.168      25836.223      3549.2577      16.7222        13.589         15.619122    
      5000   307.56525     -44709.31       31910.812      3541.388       16.7222        13.589         15.58449     
Loop time of 300.14 on 8 procs for 5000 steps with 386 atoms

Performance: 0.720 ns/day, 33.349 hours/ns, 16.659 timesteps/s, 6.430 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 170.65     | 237.93     | 252.99     | 171.4 | 79.27
Bond    | 0.0019231  | 0.0021233  | 0.0025215  |   0.4 |  0.00
Neigh   | 12.074     | 16.789     | 18.03      |  45.4 |  5.59
Comm    | 4.5834     | 19.633     | 86.935     | 596.9 |  6.54
Output  | 0.01714    | 0.019776   | 0.02147    |   0.9 |  0.01
Modify  | 24.412     | 25.647     | 30.35      |  36.7 |  8.55
Other   |            | 0.1177     |            |       |  0.04

Nlocal:          48.25 ave          58 max          44 min
Histogram: 3 1 1 0 1 1 0 0 0 1
Nghost:        3732.12 ave        3761 max        3694 min
Histogram: 1 1 0 0 0 2 2 0 0 2
Neighs:        36766.1 ave       43722 max       33691 min
Histogram: 3 1 1 0 2 0 0 0 0 1

Total # of neighbors = 294129
Ave neighs/atom = 761.99223
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.3161
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 1.73161 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.4 | 134.5 | 136.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   328.55655     -44747.086      6918.7212      3934.8755      16.7222        13.589         17.3161      
       100   306.66271     -44715.237      23689.182      3942.7453      16.7222        13.589         17.350732    
       200   302.73689     -44749.621     -4397.6654      3950.615       16.7222        13.589         17.385364    
       300   317.20307     -44772.234     -7896.6957      3958.4848      16.7222        13.589         17.419997    
       400   287.14286     -44743.259      12718.555      3966.3545      16.7222        13.589         17.454629    
       500   282.41465     -44752.784      13241.321      3974.2243      16.7222        13.589         17.489261    
       600   294.98183     -44754.609      2832.6386      3982.094       16.7222        13.589         17.523893    
       700   293.2525      -44718.906     -16414.331      3989.9638      16.7222        13.589         17.558525    
       800   325.57965     -44723.595      1042.8781      3997.8335      16.7222        13.589         17.593158    
       900   306.48409     -44727.83      -7019.3299      4005.7033      16.7222        13.589         17.62779     
      1000   314.67995     -44745.67       1106.7132      4013.573       16.7222        13.589         17.662422    
      1100   302.112       -44749.13       2833.6619      4021.4428      16.7222        13.589         17.697054    
      1200   304.02399     -44763.152      6314.7286      4029.3125      16.7222        13.589         17.731686    
      1300   298.11021     -44767.49       4531.6504      4037.1823      16.7222        13.589         17.766319    
      1400   286.95254     -44757.356     -9282.2281      4045.052       16.7222        13.589         17.800951    
      1500   274.57656     -44739.79      -3197.4252      4052.9218      16.7222        13.589         17.835583    
      1600   280.12914     -44752.674     -5014.5368      4060.7915      16.7222        13.589         17.870215    
      1700   300.54705     -44776.715      2916.8864      4068.6613      16.7222        13.589         17.904847    
      1800   293.67283     -44756.277      1460.5845      4076.531       16.7222        13.589         17.93948     
      1900   305.35699     -44735.949     -14081.23       4084.4008      16.7222        13.589         17.974112    
      2000   295.89597     -44695.268     -1522.7321      4092.2705      16.7222        13.589         18.008744    
      2100   305.50347     -44719.707     -11714.17       4100.1403      16.7222        13.589         18.043376    
      2200   300.33544     -44730.451     -6439.4234      4108.01        16.7222        13.589         18.078008    
      2300   307.91022     -44744.847     -17119.119      4115.8798      16.7222        13.589         18.112641    
      2400   289.96635     -44735.062     -20740.199      4123.7495      16.7222        13.589         18.147273    
      2500   293.70071     -44749.695     -5808.9197      4131.6193      16.7222        13.589         18.181905    
      2600   289.82948     -44740.957     -4687.8102      4139.489       16.7222        13.589         18.216537    
      2700   271.22615     -44710.526     -17752.962      4147.3588      16.7222        13.589         18.251169    
      2800   304.18152     -44715.33      -15905.369      4155.2285      16.7222        13.589         18.285802    
      2900   292.3325      -44693.341     -21201.617      4163.0983      16.7222        13.589         18.320434    
      3000   313.58499     -44735.198     -7916.5017      4170.968       16.7222        13.589         18.355066    
      3100   298.22676     -44738.571      1002.1539      4178.8378      16.7222        13.589         18.389698    
      3200   276.17496     -44713.7       -5653.3203      4186.7075      16.7222        13.589         18.42433     
      3300   290.84419     -44724.609      1416.4491      4194.5773      16.7222        13.589         18.458963    
      3400   318.34629     -44719.957     -9444.6944      4202.447       16.7222        13.589         18.493595    
      3500   321.99111     -44705.479     -6700.1106      4210.3168      16.7222        13.589         18.528227    
      3600   288.28004     -44699.84      -2957.7201      4218.1865      16.7222        13.589         18.562859    
      3700   292.56227     -44712.959     -8620.0646      4226.0563      16.7222        13.589         18.597491    
      3800   298.7331      -44708.282     -12967.612      4233.9261      16.7222        13.589         18.632124    
      3900   296.87342     -44686         -15333.698      4241.7958      16.7222        13.589         18.666756    
      4000   321.10503     -44697.194     -5686.4563      4249.6656      16.7222        13.589         18.701388    
      4100   293.60495     -44685.142     -15853.617      4257.5353      16.7222        13.589         18.73602     
      4200   295.16048     -44703.137     -14273.39       4265.4051      16.7222        13.589         18.770652    
      4300   292.7637      -44702.978     -18639.843      4273.2748      16.7222        13.589         18.805285    
      4400   302.33758     -44695.657     -8214.3295      4281.1446      16.7222        13.589         18.839917    
      4500   315.23022     -44695.284     -17049.478      4289.0143      16.7222        13.589         18.874549    
      4600   296.51775     -44709.193     -20629.06       4296.8841      16.7222        13.589         18.909181    
      4700   297.37294     -44706.078     -24755.468      4304.7538      16.7222        13.589         18.943813    
      4800   302.55738     -44696.929     -5716.0329      4312.6236      16.7222        13.589         18.978446    
      4900   320.77993     -44698.995     -10452.577      4320.4933      16.7222        13.589         19.013078    
      5000   297.64366     -44691.791     -11974.002      4328.3631      16.7222        13.589         19.04771     
Loop time of 260.629 on 8 procs for 5000 steps with 386 atoms

Performance: 0.829 ns/day, 28.959 hours/ns, 19.184 timesteps/s, 7.405 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 149.22     | 201.08     | 220.22     | 183.5 | 77.15
Bond    | 0.0019137  | 0.0020816  | 0.0024255  |   0.4 |  0.00
Neigh   | 10.154     | 13.933     | 15.373     |  49.2 |  5.35
Comm    | 2.3227     | 21.458     | 73.349     | 561.7 |  8.23
Output  | 0.016841   | 0.019385   | 0.021019   |   0.9 |  0.01
Modify  | 22.599     | 24.032     | 27.786     |  37.5 |  9.22
Other   |            | 0.1086     |            |       |  0.04

Nlocal:          48.25 ave          56 max          41 min
Histogram: 1 1 0 0 2 1 2 0 0 1
Nghost:           3200 ave        3230 max        3158 min
Histogram: 2 0 0 0 0 1 1 2 1 1
Neighs:        30012.2 ave       34708 max       25666 min
Histogram: 1 1 0 1 1 1 2 0 0 1

Total # of neighbors = 240098
Ave neighs/atom = 622.01554
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 16.7222
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz--0.018)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*16.7222
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.3464000000000000412, deltaxy = 0.73464
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.3070999999999999841, deltaxz = 0.03071
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.01799999999999999864, deltayz = 0.0018
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -1.67222 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.4 | 134.5 | 136.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   328.55655     -44747.086      6918.7212      3934.8755      16.7222        13.589         17.3161      
       100   306.60889     -44714.874      24619.933      3934.8755      16.7222        13.589         17.3161      
       200   301.9253      -44748.075     -5307.3715      3934.8755      16.7222        13.589         17.3161      
       300   306.32808     -44761.595      1871.4962      3934.8755      16.7222        13.589         17.3161      
       400   288.82022     -44748.763      3956.2289      3934.8755      16.7222        13.589         17.3161      
       500   277.45245     -44737.443      6932.5245      3934.8755      16.7222        13.589         17.3161      
       600   304.84246     -44778.972     -973.59199      3934.8755      16.7222        13.589         17.3161      
       700   298.18451     -44763.101      1782.2761      3934.8755      16.7222        13.589         17.3161      
       800   303.71873     -44734.017      9641.5283      3934.8755      16.7222        13.589         17.3161      
       900   320.39074     -44747.952     -3215.8536      3934.8755      16.7222        13.589         17.3161      
      1000   325.89294     -44783.343     -2810.6432      3934.8755      16.7222        13.589         17.3161      
      1100   308.00896     -44777.181     -131.4793       3934.8755      16.7222        13.589         17.3161      
      1200   297.17805     -44763.759      8152.7548      3934.8755      16.7222        13.589         17.3161      
      1300   301.55133     -44767.391      8826.0999      3934.8755      16.7222        13.589         17.3161      
      1400   318.04059     -44782.492     -9346.0058      3934.8755      16.7222        13.589         17.3161      
      1500   289.54943     -44771.452      1924.3182      3934.8755      16.7222        13.589         17.3161      
      1600   295.2507      -44789.197     -4000.1825      3934.8755      16.7222        13.589         17.3161      
      1700   302.15253     -44776.168      9964.2352      3934.8755      16.7222        13.589         17.3161      
      1800   310.32949     -44759.613      11416.058      3934.8755      16.7222        13.589         17.3161      
      1900   303.69176     -44750.971     -2831.6094      3934.8755      16.7222        13.589         17.3161      
      2000   306.49403     -44769.484     -5393.3856      3934.8755      16.7222        13.589         17.3161      
      2100   298.58098     -44768.513     -4188.4127      3934.8755      16.7222        13.589         17.3161      
      2200   297.33151     -44768.917      10297.285      3934.8755      16.7222        13.589         17.3161      
      2300   306.40665     -44781.75      -4411.1465      3934.8755      16.7222        13.589         17.3161      
      2400   277.55136     -44769.356     -9762.8081      3934.8755      16.7222        13.589         17.3161      
      2500   289.30779     -44794.334     -1896.4659      3934.8755      16.7222        13.589         17.3161      
      2600   308.03177     -44789.468      5496.9167      3934.8755      16.7222        13.589         17.3161      
      2700   311.01871     -44767.571     -9740.5058      3934.8755      16.7222        13.589         17.3161      
      2800   293.61237     -44747.001      15042.738      3934.8755      16.7222        13.589         17.3161      
      2900   306.91116     -44783.624     -2748.1387      3934.8755      16.7222        13.589         17.3161      
      3000   290.89383     -44795.925     -8271.8045      3934.8755      16.7222        13.589         17.3161      
      3100   301.49858     -44797.021      4217.7653      3934.8755      16.7222        13.589         17.3161      
      3200   293.8654      -44758.608      1160.2607      3934.8755      16.7222        13.589         17.3161      
      3300   296.55765     -44741.789      9055.0155      3934.8755      16.7222        13.589         17.3161      
      3400   312.94878     -44754.865     -4739.2806      3934.8755      16.7222        13.589         17.3161      
      3500   302.52308     -44767.199      1641.4539      3934.8755      16.7222        13.589         17.3161      
      3600   290.90772     -44784.085     -10617.829      3934.8755      16.7222        13.589         17.3161      
      3700   286.83907     -44769.927      4738.5703      3934.8755      16.7222        13.589         17.3161      
      3800   299.57934     -44764.539      12372.556      3934.8755      16.7222        13.589         17.3161      
      3900   307.29091     -44750.189     -159.08505      3934.8755      16.7222        13.589         17.3161      
      4000   297.10963     -44739.85       2447.9876      3934.8755      16.7222        13.589         17.3161      
      4100   293.77358     -44772.366      4159.6195      3934.8755      16.7222        13.589         17.3161      
      4200   279.84443     -44764.883     -880.07615      3934.8755      16.7222        13.589         17.3161      
      4300   282.27008     -44748.026      4488.3524      3934.8755      16.7222        13.589         17.3161      
      4400   323.53901     -44777.063      528.85875      3934.8755      16.7222        13.589         17.3161      
      4500   296.71646     -44745.549      7501.93        3934.8755      16.7222        13.589         17.3161      
      4600   291.54916     -44750.389      2666.1266      3934.8755      16.7222        13.589         17.3161      
      4700   277.1194      -44771.267      2114.7655      3934.8755      16.7222        13.589         17.3161      
      4800   272.1494      -44771.492     -7707.211       3934.8755      16.7222        13.589         17.3161      
      4900   274.25784     -44744.678     -280.61589      3934.8755      16.7222        13.589         17.3161      
      5000   297.77038     -44751.262     -72.721388      3934.8755      16.7222        13.589         17.3161      
Loop time of 279.849 on 8 procs for 5000 steps with 386 atoms

Performance: 0.772 ns/day, 31.094 hours/ns, 17.867 timesteps/s, 6.897 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 159.33     | 222.83     | 235.97     | 161.3 | 79.63
Bond    | 0.0019355  | 0.0022427  | 0.0029835  |   0.7 |  0.00
Neigh   | 11.826     | 16.678     | 17.745     |  45.5 |  5.96
Comm    | 2.3951     | 15.517     | 79.026     | 611.4 |  5.54
Output  | 0.017185   | 0.020385   | 0.022367   |   1.0 |  0.01
Modify  | 23.634     | 24.685     | 29.539     |  37.4 |  8.82
Other   |            | 0.1145     |            |       |  0.04

Nlocal:          48.25 ave          61 max          42 min
Histogram: 3 1 0 1 1 1 0 0 0 1
Nghost:        3482.62 ave        3510 max        3454 min
Histogram: 1 1 0 1 1 1 1 0 0 2
Neighs:        33027.6 ave       41283 max       28932 min
Histogram: 3 1 0 1 1 1 0 0 0 1

Total # of neighbors = 264221
Ave neighs/atom = 684.51036
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*16.7222
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 1.67222 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134.5 | 136.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   328.55655     -44747.086      6918.7212      3934.8755      16.7222        13.589         17.3161      
       100   306.7995      -44715.229      23629.836      3934.8755      16.7222        13.589         17.3161      
       200   300.39359     -44747.181     -6156.1867      3934.8755      16.7222        13.589         17.3161      
       300   308.24112     -44766.392     -15.44673       3934.8755      16.7222        13.589         17.3161      
       400   301.18306     -44762.731      10553.718      3934.8755      16.7222        13.589         17.3161      
       500   270.98888     -44735.946      11092.695      3934.8755      16.7222        13.589         17.3161      
       600   293.0037      -44750.583     -4447.7412      3934.8755      16.7222        13.589         17.3161      
       700   307.62046     -44739.339      12345.355      3934.8755      16.7222        13.589         17.3161      
       800   311.9692      -44727.661      5934.1125      3934.8755      16.7222        13.589         17.3161      
       900   309.23576     -44743.377      5623.9423      3934.8755      16.7222        13.589         17.3161      
      1000   308.49514     -44766.105      9603.2875      3934.8755      16.7222        13.589         17.3161      
      1100   301.13516     -44751.623     -11606.205      3934.8755      16.7222        13.589         17.3161      
      1200   282.80999     -44725.453      7670.8203      3934.8755      16.7222        13.589         17.3161      
      1300   298.84745     -44745.549     -8052.3711      3934.8755      16.7222        13.589         17.3161      
      1400   294.1346      -44756.992     -7928.3283      3934.8755      16.7222        13.589         17.3161      
      1500   278.15817     -44763.181     -271.79561      3934.8755      16.7222        13.589         17.3161      
      1600   276.3553      -44759.415      7985.6576      3934.8755      16.7222        13.589         17.3161      
      1700   292.20877     -44739.334     -8092.7731      3934.8755      16.7222        13.589         17.3161      
      1800   300.34095     -44724.225     -9155.6468      3934.8755      16.7222        13.589         17.3161      
      1900   310.38767     -44743.114     -7171.7608      3934.8755      16.7222        13.589         17.3161      
      2000   311.81782     -44766.497     -60.683395      3934.8755      16.7222        13.589         17.3161      
      2100   285.8295      -44747.728     -6370.714       3934.8755      16.7222        13.589         17.3161      
      2200   293.63303     -44760.783      112.38027      3934.8755      16.7222        13.589         17.3161      
      2300   286.63685     -44751.434      6393.5161      3934.8755      16.7222        13.589         17.3161      
      2400   309.90649     -44736.493     -11303.355      3934.8755      16.7222        13.589         17.3161      
      2500   320.51556     -44725.835      4015.1248      3934.8755      16.7222        13.589         17.3161      
      2600   294.20428     -44720.069      4511.5968      3934.8755      16.7222        13.589         17.3161      
      2700   281.20824     -44735.658     -2679.0182      3934.8755      16.7222        13.589         17.3161      
      2800   294.61759     -44754.977      3612.0037      3934.8755      16.7222        13.589         17.3161      
      2900   309.04046     -44769.74      -235.64269      3934.8755      16.7222        13.589         17.3161      
      3000   312.4797      -44736.979      4332.4054      3934.8755      16.7222        13.589         17.3161      
      3100   316.24443     -44724.795      3611.9052      3934.8755      16.7222        13.589         17.3161      
      3200   303.18651     -44726.579      6761.6032      3934.8755      16.7222        13.589         17.3161      
      3300   293.44376     -44724.789      2018.2228      3934.8755      16.7222        13.589         17.3161      
      3400   301.79372     -44738.76      -2590.0036      3934.8755      16.7222        13.589         17.3161      
      3500   288.07942     -44728.351      956.32501      3934.8755      16.7222        13.589         17.3161      
      3600   285.4117      -44728.485     -6769.663       3934.8755      16.7222        13.589         17.3161      
      3700   309.62907     -44755.267     -581.29564      3934.8755      16.7222        13.589         17.3161      
      3800   313.55122     -44765.394     -1868.0577      3934.8755      16.7222        13.589         17.3161      
      3900   293.89451     -44755.155      7083.5127      3934.8755      16.7222        13.589         17.3161      
      4000   300.05375     -44756.286     -4137.2932      3934.8755      16.7222        13.589         17.3161      
      4100   315.16658     -44735.435      4288.0778      3934.8755      16.7222        13.589         17.3161      
      4200   313.7681      -44723.344     -1157.8189      3934.8755      16.7222        13.589         17.3161      
      4300   309.02744     -44725.424      6287.3352      3934.8755      16.7222        13.589         17.3161      
      4400   301.89172     -44732.223      4299.578       3934.8755      16.7222        13.589         17.3161      
      4500   291.07        -44730.248      4159.3248      3934.8755      16.7222        13.589         17.3161      
      4600   285.87022     -44719.656      6118.3798      3934.8755      16.7222        13.589         17.3161      
      4700   299.05174     -44721.794     -1600.0129      3934.8755      16.7222        13.589         17.3161      
      4800   313.68272     -44717.08       1862.6869      3934.8755      16.7222        13.589         17.3161      
      4900   329.53921     -44730.723      2003.6929      3934.8755      16.7222        13.589         17.3161      
      5000   292.25854     -44722.275      5616.9706      3934.8755      16.7222        13.589         17.3161      
Loop time of 282.004 on 8 procs for 5000 steps with 386 atoms

Performance: 0.766 ns/day, 31.334 hours/ns, 17.730 timesteps/s, 6.844 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 218.87     | 232.39     | 236.9      |  37.8 | 82.41
Bond    | 0.0019698  | 0.002166   | 0.0025469  |   0.4 |  0.00
Neigh   | 16.172     | 17.297     | 17.795     |  12.3 |  6.13
Comm    | 3.7263     | 8.2249     | 21.793     | 201.6 |  2.92
Output  | 0.01718    | 0.020222   | 0.022106   |   1.0 |  0.01
Modify  | 23.485     | 23.95      | 25.033     |  10.1 |  8.49
Other   |            | 0.1195     |            |       |  0.04

Nlocal:          48.25 ave          59 max          40 min
Histogram: 1 1 0 2 1 1 1 0 0 1
Nghost:        3470.75 ave        3513 max        3431 min
Histogram: 1 0 2 0 0 2 2 0 0 1
Neighs:        33063.6 ave       40010 max       27700 min
Histogram: 1 1 0 2 1 1 1 0 0 1

Total # of neighbors = 264509
Ave neighs/atom = 685.25648
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.589
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz--0.3071)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.589
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.3464000000000000412, deltaxy = 0.73464
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.3070999999999999841, deltaxz = 0.03071
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.01799999999999999864, deltayz = 0.0018
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -1.3589 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.4 | 134.5 | 136.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   328.55655     -44747.086      6918.7212      3934.8755      16.7222        13.589         17.3161      
       100   306.64566     -44714.811      24283.039      3934.8755      16.7222        13.589         17.3161      
       200   302.73716     -44748.165     -6233.4708      3934.8755      16.7222        13.589         17.3161      
       300   311.63694     -44765.718     -4173.3937      3934.8755      16.7222        13.589         17.3161      
       400   280.09371     -44736.086      10968.961      3934.8755      16.7222        13.589         17.3161      
       500   271.58576     -44737.324      11537.497      3934.8755      16.7222        13.589         17.3161      
       600   295.00046     -44755.969      9569.9228      3934.8755      16.7222        13.589         17.3161      
       700   298.95968     -44727.078      531.06775      3934.8755      16.7222        13.589         17.3161      
       800   309.46503     -44723.416     -170.7729       3934.8755      16.7222        13.589         17.3161      
       900   314.70188     -44750.639     -7868.961       3934.8755      16.7222        13.589         17.3161      
      1000   304.74311     -44760.392     -4837.7462      3934.8755      16.7222        13.589         17.3161      
      1100   296.59476     -44755.567      4814.4517      3934.8755      16.7222        13.589         17.3161      
      1200   297.48522     -44750.676      6677.5357      3934.8755      16.7222        13.589         17.3161      
      1300   302.43854     -44739.341     -5865.8753      3934.8755      16.7222        13.589         17.3161      
      1400   318.10867     -44737.056     -2702.5326      3934.8755      16.7222        13.589         17.3161      
      1500   304.22132     -44735.346      8561.8081      3934.8755      16.7222        13.589         17.3161      
      1600   286.12845     -44745.192      1486.8594      3934.8755      16.7222        13.589         17.3161      
      1700   291.86826     -44749.12       12680.284      3934.8755      16.7222        13.589         17.3161      
      1800   299.39111     -44742.068      12856.003      3934.8755      16.7222        13.589         17.3161      
      1900   325.47175     -44744.854     -2561.0742      3934.8755      16.7222        13.589         17.3161      
      2000   342.86423     -44734.155      7527.9803      3934.8755      16.7222        13.589         17.3161      
      2100   315.33601     -44710.885      4050.8842      3934.8755      16.7222        13.589         17.3161      
      2200   307.29422     -44741.765     -507.11704      3934.8755      16.7222        13.589         17.3161      
      2300   300.73941     -44747.176      3562.2457      3934.8755      16.7222        13.589         17.3161      
      2400   296.25874     -44750.866      6708.3169      3934.8755      16.7222        13.589         17.3161      
      2500   284.04223     -44747.001     -3179.263       3934.8755      16.7222        13.589         17.3161      
      2600   311.05152     -44771.897      1568.7489      3934.8755      16.7222        13.589         17.3161      
      2700   309.51606     -44739.138      3198.0912      3934.8755      16.7222        13.589         17.3161      
      2800   317.24084     -44729.976     -3519.919       3934.8755      16.7222        13.589         17.3161      
      2900   304.93756     -44730.118     -2283.4239      3934.8755      16.7222        13.589         17.3161      
      3000   288.8584      -44740.362     -6614.9967      3934.8755      16.7222        13.589         17.3161      
      3100   298.68994     -44752.313     -5204.6465      3934.8755      16.7222        13.589         17.3161      
      3200   292.08959     -44745.426      9108.4381      3934.8755      16.7222        13.589         17.3161      
      3300   301.15642     -44758.386     -3560.5376      3934.8755      16.7222        13.589         17.3161      
      3400   293.64371     -44751.423     -9375.8922      3934.8755      16.7222        13.589         17.3161      
      3500   311.60122     -44779.452      6994.8225      3934.8755      16.7222        13.589         17.3161      
      3600   312.49165     -44796.558      7567.009       3934.8755      16.7222        13.589         17.3161      
      3700   292.20796     -44774.169      16558.038      3934.8755      16.7222        13.589         17.3161      
      3800   309.63982     -44756.067      1431.3617      3934.8755      16.7222        13.589         17.3161      
      3900   284.99936     -44704.694      391.22574      3934.8755      16.7222        13.589         17.3161      
      4000   308.37408     -44737.573      7062.2369      3934.8755      16.7222        13.589         17.3161      
      4100   304.80373     -44749.964     -8037.3512      3934.8755      16.7222        13.589         17.3161      
      4200   323.16673     -44795.849     -3400.7109      3934.8755      16.7222        13.589         17.3161      
      4300   286.42081     -44756.469     -5051.3459      3934.8755      16.7222        13.589         17.3161      
      4400   293.10444     -44750.671     -4046.7358      3934.8755      16.7222        13.589         17.3161      
      4500   308.56001     -44750.155      1335.6521      3934.8755      16.7222        13.589         17.3161      
      4600   320.02997     -44743.353      8050.8313      3934.8755      16.7222        13.589         17.3161      
      4700   295.27806     -44736.555      7293.0271      3934.8755      16.7222        13.589         17.3161      
      4800   302.22031     -44764.119      13243.919      3934.8755      16.7222        13.589         17.3161      
      4900   292.32953     -44745.046      1471.9492      3934.8755      16.7222        13.589         17.3161      
      5000   287.24534     -44724.398      17132.904      3934.8755      16.7222        13.589         17.3161      
Loop time of 271.687 on 8 procs for 5000 steps with 386 atoms

Performance: 0.795 ns/day, 30.187 hours/ns, 18.404 timesteps/s, 7.104 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 197.44     | 218.36     | 227.22     |  79.4 | 80.37
Bond    | 0.0017626  | 0.002022   | 0.0023966  |   0.4 |  0.00
Neigh   | 14.596     | 16.375     | 17.326     |  23.6 |  6.03
Comm    | 4.3245     | 13.216     | 34.156     | 323.3 |  4.86
Output  | 0.015958   | 0.018426   | 0.020006   |   0.9 |  0.01
Modify  | 22.675     | 23.605     | 25.363     |  19.4 |  8.69
Other   |            | 0.1141     |            |       |  0.04

Nlocal:          48.25 ave          54 max          43 min
Histogram: 3 0 0 0 0 2 0 1 1 1
Nghost:           3438 ave        3458 max        3420 min
Histogram: 2 0 0 2 0 1 1 1 0 1
Neighs:        33052.5 ave       36759 max       29587 min
Histogram: 1 2 0 0 0 2 0 1 1 1

Total # of neighbors = 264420
Ave neighs/atom = 685.02591
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.589
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 1.3589 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134.5 | 136.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   328.55655     -44747.086      6918.7212      3934.8755      16.7222        13.589         17.3161      
       100   306.69303     -44715.273      23944.122      3934.8755      16.7222        13.589         17.3161      
       200   300.47247     -44749.741     -3787.4839      3934.8755      16.7222        13.589         17.3161      
       300   309.95759     -44770.754     -4323.588       3934.8755      16.7222        13.589         17.3161      
       400   295.64003     -44756.815      10639.027      3934.8755      16.7222        13.589         17.3161      
       500   283.74775     -44749.299      9820.8038      3934.8755      16.7222        13.589         17.3161      
       600   309.09036     -44768.543      945.97447      3934.8755      16.7222        13.589         17.3161      
       700   317.32959     -44742.969      3276.6643      3934.8755      16.7222        13.589         17.3161      
       800   308.06156     -44727.153      4090.5927      3934.8755      16.7222        13.589         17.3161      
       900   313.80735     -44762.75       5639.2411      3934.8755      16.7222        13.589         17.3161      
      1000   287.0363      -44741.033      10740.554      3934.8755      16.7222        13.589         17.3161      
      1100   293.80076     -44757.737     -13930.614      3934.8755      16.7222        13.589         17.3161      
      1200   288.04466     -44753.274     -2319.1701      3934.8755      16.7222        13.589         17.3161      
      1300   317.34286     -44769.411      10715.877      3934.8755      16.7222        13.589         17.3161      
      1400   331.82127     -44758.173     -1334.2916      3934.8755      16.7222        13.589         17.3161      
      1500   301.11006     -44725.967      7224.3212      3934.8755      16.7222        13.589         17.3161      
      1600   298.46576     -44757.123      290.54088      3934.8755      16.7222        13.589         17.3161      
      1700   292.36851     -44760.533      7816.4612      3934.8755      16.7222        13.589         17.3161      
      1800   300.6657      -44766.238      5366.0475      3934.8755      16.7222        13.589         17.3161      
      1900   295.50105     -44759.384      4805.207       3934.8755      16.7222        13.589         17.3161      
      2000   322.74784     -44788.929      728.07231      3934.8755      16.7222        13.589         17.3161      
      2100   307.13327     -44796.129      3640.7593      3934.8755      16.7222        13.589         17.3161      
      2200   299.44234     -44799.572     -14709.565      3934.8755      16.7222        13.589         17.3161      
      2300   291.14056     -44782.323      2253.5679      3934.8755      16.7222        13.589         17.3161      
      2400   299.16082     -44761.356      11379.979      3934.8755      16.7222        13.589         17.3161      
      2500   317.57908     -44758.974      3831.5123      3934.8755      16.7222        13.589         17.3161      
      2600   305.90863     -44759.077      6199.6255      3934.8755      16.7222        13.589         17.3161      
      2700   315.23126     -44783.354     -227.29876      3934.8755      16.7222        13.589         17.3161      
      2800   295.78452     -44770.357      2640.1632      3934.8755      16.7222        13.589         17.3161      
      2900   308.34285     -44789.878      3790.3838      3934.8755      16.7222        13.589         17.3161      
      3000   300.76615     -44784.164      25926.552      3934.8755      16.7222        13.589         17.3161      
      3100   282.36435     -44760.812     -2121.8185      3934.8755      16.7222        13.589         17.3161      
      3200   309.16412     -44779.821      5099.146       3934.8755      16.7222        13.589         17.3161      
      3300   296.08511     -44753.399      15381.8        3934.8755      16.7222        13.589         17.3161      
      3400   304.09088     -44749.905      5285.2316      3934.8755      16.7222        13.589         17.3161      
      3500   319.68894     -44785.293     -823.31253      3934.8755      16.7222        13.589         17.3161      
      3600   305.73266     -44794.037      4053.6758      3934.8755      16.7222        13.589         17.3161      
      3700   285.98074     -44782.182      2501.5693      3934.8755      16.7222        13.589         17.3161      
      3800   291.44576     -44778.139      16843.58       3934.8755      16.7222        13.589         17.3161      
      3900   312.30552     -44763.858      3635.5456      3934.8755      16.7222        13.589         17.3161      
      4000   304.93912     -44746.787     -7645.7336      3934.8755      16.7222        13.589         17.3161      
      4100   327.2738      -44785.884      5330.3974      3934.8755      16.7222        13.589         17.3161      
      4200   306.53797     -44775.138      15757.29       3934.8755      16.7222        13.589         17.3161      
      4300   281.70497     -44762.068     -875.75573      3934.8755      16.7222        13.589         17.3161      
      4400   273.95148     -44758.371      6917.6907      3934.8755      16.7222        13.589         17.3161      
      4500   285.99146     -44769.03       2725.0457      3934.8755      16.7222        13.589         17.3161      
      4600   332.06372     -44776.41       7431.0302      3934.8755      16.7222        13.589         17.3161      
      4700   322.14907     -44762.645      4822.8798      3934.8755      16.7222        13.589         17.3161      
      4800   287.66249     -44748.497      5332.1943      3934.8755      16.7222        13.589         17.3161      
      4900   304.32286     -44782.853      9813.0947      3934.8755      16.7222        13.589         17.3161      
      5000   295.41236     -44768.725      9981.5072      3934.8755      16.7222        13.589         17.3161      
Loop time of 242.705 on 8 procs for 5000 steps with 386 atoms

Performance: 0.890 ns/day, 26.967 hours/ns, 20.601 timesteps/s, 7.952 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 142.68     | 166.38     | 202.74     | 135.4 | 68.55
Bond    | 0.0013648  | 0.0016361  | 0.0020947  |   0.5 |  0.00
Neigh   | 11.445     | 13.427     | 16.025     |  35.1 |  5.53
Comm    | 2.5284     | 38.85      | 62.579     | 280.2 | 16.01
Output  | 0.015269   | 0.017541   | 0.018981   |   0.8 |  0.01
Modify  | 21.288     | 23.929     | 25.889     |  26.3 |  9.86
Other   |            | 0.0963     |            |       |  0.04

Nlocal:          48.25 ave          56 max          43 min
Histogram: 2 0 2 1 1 0 0 0 1 1
Nghost:        3476.38 ave        3515 max        3439 min
Histogram: 1 1 2 0 0 1 1 0 0 2
Neighs:        33079.5 ave       37990 max       29688 min
Histogram: 2 0 2 1 1 0 0 0 1 1

Total # of neighbors = 264636
Ave neighs/atom = 685.58549
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.3161
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--7.3464)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.3161
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.3464000000000000412, deltaxy = 0.73464
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.3070999999999999841, deltaxz = 0.03071
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.01799999999999999864, deltayz = 0.0018
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -1.73161 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.4 | 134.5 | 136.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   328.55655     -44747.086      6918.7212      3934.8755      16.7222        13.589         17.3161      
       100   306.60483     -44715.03       24251.069      3934.8755      16.7222        13.589         17.3161      
       200   303.39341     -44752.44      -3733.6717      3934.8755      16.7222        13.589         17.3161      
       300   312.46251     -44772.094      4028.4201      3934.8755      16.7222        13.589         17.3161      
       400   293.72973     -44756.825      9217.6152      3934.8755      16.7222        13.589         17.3161      
       500   286.77594     -44758.274      4268.2707      3934.8755      16.7222        13.589         17.3161      
       600   308.4408      -44777.769     -8345.7137      3934.8755      16.7222        13.589         17.3161      
       700   295.99952     -44738.446     -2369.5829      3934.8755      16.7222        13.589         17.3161      
       800   323.97428     -44740.022     -3933.444       3934.8755      16.7222        13.589         17.3161      
       900   328.94802     -44754.046     -2860.2348      3934.8755      16.7222        13.589         17.3161      
      1000   290.95297     -44736.92       18951.987      3934.8755      16.7222        13.589         17.3161      
      1100   294.89562     -44751.669      8933.5741      3934.8755      16.7222        13.589         17.3161      
      1200   286.37256     -44751.446      4593.73        3934.8755      16.7222        13.589         17.3161      
      1300   303.56371     -44766.757      9023.738       3934.8755      16.7222        13.589         17.3161      
      1400   305.87569     -44755.169     -8364.4738      3934.8755      16.7222        13.589         17.3161      
      1500   282.06652     -44730.971      9449.865       3934.8755      16.7222        13.589         17.3161      
      1600   289.98124     -44754.012      1870.8114      3934.8755      16.7222        13.589         17.3161      
      1700   286.68223     -44755.572      92.114984      3934.8755      16.7222        13.589         17.3161      
      1800   300.51879     -44766.72      -2257.8851      3934.8755      16.7222        13.589         17.3161      
      1900   304.00706     -44773.444     -2680.8582      3934.8755      16.7222        13.589         17.3161      
      2000   291.52938     -44775.495     -13081.392      3934.8755      16.7222        13.589         17.3161      
      2100   293.08034     -44778.97       1811.9862      3934.8755      16.7222        13.589         17.3161      
      2200   304.87003     -44774.031     -1992.8752      3934.8755      16.7222        13.589         17.3161      
      2300   308.43129     -44746.762     -834.84582      3934.8755      16.7222        13.589         17.3161      
      2400   310.55496     -44740.509      2678.8849      3934.8755      16.7222        13.589         17.3161      
      2500   305.50296     -44771.79      -486.75871      3934.8755      16.7222        13.589         17.3161      
      2600   307.65784     -44773.053      1600.1577      3934.8755      16.7222        13.589         17.3161      
      2700   306.49506     -44769.434     -6979.1712      3934.8755      16.7222        13.589         17.3161      
      2800   297.882       -44751.976      1506.5062      3934.8755      16.7222        13.589         17.3161      
      2900   307.75443     -44775.013      994.20782      3934.8755      16.7222        13.589         17.3161      
      3000   292.31474     -44785.306     -5630.1436      3934.8755      16.7222        13.589         17.3161      
      3100   293.15292     -44781.716      10039.659      3934.8755      16.7222        13.589         17.3161      
      3200   295.00238     -44765.891     -3496.2252      3934.8755      16.7222        13.589         17.3161      
      3300   312.55204     -44749.368     -5722.5392      3934.8755      16.7222        13.589         17.3161      
      3400   321.46796     -44725.057     -2097.0517      3934.8755      16.7222        13.589         17.3161      
      3500   312.38044     -44732.134      4873.6799      3934.8755      16.7222        13.589         17.3161      
      3600   319.64831     -44764.208      8629.9544      3934.8755      16.7222        13.589         17.3161      
      3700   312.4797      -44765.865     -5674.3038      3934.8755      16.7222        13.589         17.3161      
      3800   270.72245     -44739.63       1525.0247      3934.8755      16.7222        13.589         17.3161      
      3900   294.8293      -44776.071     -5078.3006      3934.8755      16.7222        13.589         17.3161      
      4000   300.01748     -44766.225     -3880.7823      3934.8755      16.7222        13.589         17.3161      
      4100   301.33199     -44737.347     -6972.4487      3934.8755      16.7222        13.589         17.3161      
      4200   331.5332      -44719.933      386.26464      3934.8755      16.7222        13.589         17.3161      
      4300   323.21923     -44705.281     -8204.1779      3934.8755      16.7222        13.589         17.3161      
      4400   308.12883     -44713.554      5780.293       3934.8755      16.7222        13.589         17.3161      
      4500   308.84339     -44739.491      8433.7264      3934.8755      16.7222        13.589         17.3161      
      4600   298.74065     -44744.68       12775.808      3934.8755      16.7222        13.589         17.3161      
      4700   308.90713     -44761.232      187.77888      3934.8755      16.7222        13.589         17.3161      
      4800   284.8039      -44730.127     -7160.2934      3934.8755      16.7222        13.589         17.3161      
      4900   322.16907     -44741.706      123.11584      3934.8755      16.7222        13.589         17.3161      
      5000   325.85809     -44717.757      447.43332      3934.8755      16.7222        13.589         17.3161      
Loop time of 176.553 on 8 procs for 5000 steps with 386 atoms

Performance: 1.223 ns/day, 19.617 hours/ns, 28.320 timesteps/s, 10.932 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 140.44     | 143.08     | 145.88     |  15.9 | 81.04
Bond    | 0.0013008  | 0.0014562  | 0.0020299  |   0.6 |  0.00
Neigh   | 11.811     | 12.219     | 12.609     |   9.3 |  6.92
Comm    | 1.3707     | 4.1521     | 6.758      |  92.9 |  2.35
Output  | 0.014512   | 0.016786   | 0.018148   |   0.8 |  0.01
Modify  | 16.616     | 16.991     | 17.383     |   7.5 |  9.62
Other   |            | 0.09659    |            |       |  0.05

Nlocal:          48.25 ave          56 max          42 min
Histogram: 1 0 3 0 0 2 0 1 0 1
Nghost:        3603.75 ave        3646 max        3563 min
Histogram: 1 1 1 1 0 1 0 1 1 1
Neighs:        33051.9 ave       38008 max       29229 min
Histogram: 1 1 2 0 1 1 0 1 0 1

Total # of neighbors = 264415
Ave neighs/atom = 685.01295
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.3161
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 1.73161 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134.5 | 136.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   328.55655     -44747.086      6918.7212      3934.8755      16.7222        13.589         17.3161      
       100   306.98068     -44715.541      23942.954      3934.8755      16.7222        13.589         17.3161      
       200   306.77521     -44748.969     -8265.1928      3934.8755      16.7222        13.589         17.3161      
       300   313.52202     -44766.314      5995.0308      3934.8755      16.7222        13.589         17.3161      
       400   290.3663      -44746.719      10402.779      3934.8755      16.7222        13.589         17.3161      
       500   288.01724     -44754.857      1572.0924      3934.8755      16.7222        13.589         17.3161      
       600   290.02445     -44748.104      3672.3806      3934.8755      16.7222        13.589         17.3161      
       700   299.53424     -44724.102      5043.0964      3934.8755      16.7222        13.589         17.3161      
       800   324.86129     -44730.157      4412.3436      3934.8755      16.7222        13.589         17.3161      
       900   320.72857     -44745.42       421.38324      3934.8755      16.7222        13.589         17.3161      
      1000   304.23156     -44739.102      3009.9454      3934.8755      16.7222        13.589         17.3161      
      1100   316.89967     -44768.197      10192.156      3934.8755      16.7222        13.589         17.3161      
      1200   307.39571     -44775.049      10658.251      3934.8755      16.7222        13.589         17.3161      
      1300   293.85117     -44763.586      9559.3365      3934.8755      16.7222        13.589         17.3161      
      1400   296.12053     -44758.801      839.28872      3934.8755      16.7222        13.589         17.3161      
      1500   311.52203     -44730.436      5022.7659      3934.8755      16.7222        13.589         17.3161      
      1600   311.05304     -44722.678      3428.8084      3934.8755      16.7222        13.589         17.3161      
      1700   293.7923      -44724.078      6200.8849      3934.8755      16.7222        13.589         17.3161      
      1800   286.35813     -44726.093      4342.3584      3934.8755      16.7222        13.589         17.3161      
      1900   281.80565     -44719.442      6249.7997      3934.8755      16.7222        13.589         17.3161      
      2000   307.61275     -44744.198      6180.2537      3934.8755      16.7222        13.589         17.3161      
      2100   292.48768     -44742.502      10060.607      3934.8755      16.7222        13.589         17.3161      
      2200   289.07249     -44749.928      4703.9262      3934.8755      16.7222        13.589         17.3161      
      2300   304.44282     -44744.578      2695.3285      3934.8755      16.7222        13.589         17.3161      
      2400   301.61115     -44705.205     -2272.7522      3934.8755      16.7222        13.589         17.3161      
      2500   306.35975     -44694.847     -22.907066      3934.8755      16.7222        13.589         17.3161      
      2600   303.41747     -44719.783      8016.9182      3934.8755      16.7222        13.589         17.3161      
      2700   301.24005     -44735.644      9964.3251      3934.8755      16.7222        13.589         17.3161      
      2800   286.03308     -44707.82      -8855.8554      3934.8755      16.7222        13.589         17.3161      
      2900   291.82128     -44705.088     -3540.5481      3934.8755      16.7222        13.589         17.3161      
      3000   305.39053     -44696.688     -3076.4795      3934.8755      16.7222        13.589         17.3161      
      3100   299.33177     -44668.432      1187.7295      3934.8755      16.7222        13.589         17.3161      
      3200   316.96963     -44704.737      7613.6558      3934.8755      16.7222        13.589         17.3161      
      3300   309.699       -44721.542      24543.435      3934.8755      16.7222        13.589         17.3161      
      3400   287.85325     -44700.148      2227.2228      3934.8755      16.7222        13.589         17.3161      
      3500   310.68646     -44712.055     -597.6528       3934.8755      16.7222        13.589         17.3161      
      3600   289.46206     -44688.966     -3077.0041      3934.8755      16.7222        13.589         17.3161      
      3700   306.31296     -44727.514     -6723.5484      3934.8755      16.7222        13.589         17.3161      
      3800   308.08056     -44736.11      -5835.9421      3934.8755      16.7222        13.589         17.3161      
      3900   307.9075      -44733.477      6964.5045      3934.8755      16.7222        13.589         17.3161      
      4000   288.04952     -44701.091      13098.587      3934.8755      16.7222        13.589         17.3161      
      4100   317.52401     -44726.903      9789.1389      3934.8755      16.7222        13.589         17.3161      
      4200   306.97747     -44711.961     -2189.5165      3934.8755      16.7222        13.589         17.3161      
      4300   312.26842     -44719.868      6905.1931      3934.8755      16.7222        13.589         17.3161      
      4400   303.20615     -44724.882     -4683.3285      3934.8755      16.7222        13.589         17.3161      
      4500   291.78354     -44724.599      13936.626      3934.8755      16.7222        13.589         17.3161      
      4600   294.33582     -44719.633      3098.4089      3934.8755      16.7222        13.589         17.3161      
      4700   303.2897      -44682.037      424.94881      3934.8755      16.7222        13.589         17.3161      
      4800   326.2213      -44687.812      13893.019      3934.8755      16.7222        13.589         17.3161      
      4900   318.30793     -44701.757      3958.3362      3934.8755      16.7222        13.589         17.3161      
      5000   298.69885     -44701.95      -1506.2631      3934.8755      16.7222        13.589         17.3161      
Loop time of 159.289 on 8 procs for 5000 steps with 386 atoms

Performance: 1.356 ns/day, 17.699 hours/ns, 31.389 timesteps/s, 12.116 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 122.54     | 125.25     | 128.36     |  16.4 | 78.63
Bond    | 0.0010516  | 0.0012798  | 0.0016501  |   0.5 |  0.00
Neigh   | 12.309     | 12.762     | 13.201     |   9.8 |  8.01
Comm    | 1.1421     | 4.2405     | 6.9691     |  89.0 |  2.66
Output  | 0.014247   | 0.016438   | 0.017853   |   0.8 |  0.01
Modify  | 16.509     | 16.932     | 17.371     |   8.3 | 10.63
Other   |            | 0.09053    |            |       |  0.06

Nlocal:          48.25 ave          58 max          42 min
Histogram: 3 0 0 1 1 1 0 0 1 1
Nghost:        3354.75 ave        3390 max        3325 min
Histogram: 2 0 1 1 0 1 0 1 1 1
Neighs:          33024 ave       39377 max       28868 min
Histogram: 3 0 0 1 1 1 0 0 1 1

Total # of neighbors = 264192
Ave neighs/atom = 684.43523
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:55:48
