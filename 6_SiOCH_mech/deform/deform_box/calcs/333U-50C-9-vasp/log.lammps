LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 30*${nthermo}       # steps of equilibration run 10
variable nequil equal 30*100       
variable nrun equal 30*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 30*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-9-vasp
read_data       ${structure}.data
read_data       333U-50C-9-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.006 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 5.31839e-05 on 8 procs for 1 steps with 386 atoms

53.8% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.816e-06  | 1.816e-06  | 1.816e-06  |   0.0 |  3.41
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 4.54e-06   | 4.54e-06   | 4.54e-06   |   0.0 |  8.54
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 4.683e-05  |            |       | 88.05

Nlocal:          48.25 ave          55 max          40 min
Histogram: 2 0 0 0 2 0 1 0 1 2
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-9-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
run ${nequil}
run 3000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -0.82 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 142.4 | 144.4 | 146.4 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -43202.648      118796.37      1.7478941      3875.657     
       100   631.0338      -43895.466     -4819.2253      1.7478941      3875.657     
       200   533.30843     -44157.498      15862.756      1.7478941      3875.657     
       300   425.22341     -44305.336      2256.7082      1.7478941      3875.657     
       400   350.71086     -44415.617      8647.0575      1.7478941      3875.657     
       500   327.82267     -44524.572      11246.901      1.7478941      3875.657     
       600   281.23069     -44560.92       9461.1727      1.7478941      3875.657     
       700   266.77522     -44585.699      10549.532      1.7478941      3875.657     
       800   303.32794     -44620.951      15593.795      1.7478941      3875.657     
       900   299.36152     -44595.018      4527.8559      1.7478941      3875.657     
      1000   319.16248     -44598.921     -1186.3394      1.7478941      3875.657     
      1100   314.01384     -44597.008      4234.2333      1.7478941      3875.657     
      1200   296.63954     -44596.234      2232.5129      1.7478941      3875.657     
      1300   297.2041      -44617.222      7165.1973      1.7478941      3875.657     
      1400   298.61517     -44631.197      11973.132      1.7478941      3875.657     
      1500   302.89362     -44634.621      14442.442      1.7478941      3875.657     
      1600   302.27445     -44633.277      10672.965      1.7478941      3875.657     
      1700   299.78312     -44632.561      3910.9904      1.7478941      3875.657     
      1800   304.25195     -44648.038     -6322.9145      1.7478941      3875.657     
      1900   301.44067     -44659.194      23690.598      1.7478941      3875.657     
      2000   289.87138     -44655.159      8378.5973      1.7478941      3875.657     
      2100   301.28218     -44667.342     -2611.4715      1.7478941      3875.657     
      2200   303.40474     -44665.078      13772.112      1.7478941      3875.657     
      2300   302.72932     -44654.236     -8117.9902      1.7478941      3875.657     
      2400   298.23291     -44646.643      14731.88       1.7478941      3875.657     
      2500   295.62437     -44648.964      3601.6509      1.7478941      3875.657     
      2600   314.28699     -44679.893      8252.674       1.7478941      3875.657     
      2700   285.32117     -44673.293     -9809.669       1.7478941      3875.657     
      2800   289.2142      -44686.236     -12047.076      1.7478941      3875.657     
      2900   285.88087     -44660.043      4061.6564      1.7478941      3875.657     
      3000   340.84522     -44694.627      2804.997       1.7478941      3875.657     
Loop time of 169.27 on 8 procs for 3000 steps with 386 atoms

Performance: 0.766 ns/day, 31.346 hours/ns, 17.723 timesteps/s, 6.841 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 137.45     | 140.03     | 142.59     |  15.7 | 82.72
Bond    | 0.0074958  | 0.0084109  | 0.0093156  |   0.6 |  0.00
Neigh   | 11.184     | 11.361     | 11.533     |   3.5 |  6.71
Comm    | 2.0922     | 4.6621     | 7.2351     |  86.0 |  2.75
Output  | 0.0015885  | 0.0017258  | 0.00251    |   0.7 |  0.00
Modify  | 12.953     | 13.129     | 13.31      |   3.3 |  7.76
Other   |            | 0.07971    |            |       |  0.05

Nlocal:          48.25 ave          58 max          40 min
Histogram: 1 1 1 2 0 0 1 0 0 2
Nghost:         3723.5 ave        3796 max        3645 min
Histogram: 1 1 0 1 1 0 1 1 1 1
Neighs:        33606.2 ave       40009 max       27942 min
Histogram: 1 1 1 2 0 0 1 0 0 2

Total # of neighbors = 268850
Ave neighs/atom = 696.50259
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333U-50C-9-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.6078
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.4502
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.3502

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.0034
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal -1.0717
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -9.4505

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 16.6078
variable dlen equal lx-${len0}
variable dlen equal lx-16.6078
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.6078
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.094505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.010717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -3.4e-05
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.166078 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.166078 xy delta 0.094505 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.166078 xy delta 0.094505 xz delta 0.010717 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 142 | 144.2 | 146.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   340.84522     -44694.626      2805.0797      1.7478941      3875.657     
       100   307.14948     -44662.551     -1744.357       1.748477       3874.3651    
       200   307.97937     -44692.653      247.6777       1.7490602      3873.0732    
       300   283.93931     -44684.43       2529.4321      1.7496438      3871.7813    
       400   301.9847      -44695.115     -2046.1978      1.7502278      3870.4895    
       500   284.94039     -44650.469      17085.545      1.7508121      3869.1976    
       600   309.57246     -44657.273     -2989.4666      1.7513969      3867.9057    
       700   309.46156     -44665.04       1704.8812      1.7519821      3866.6138    
       800   307.0594      -44684.227      7092.5892      1.7525676      3865.3219    
       900   293.50953     -44679.919      13029.503      1.7531536      3864.03      
      1000   307.89333     -44682.805     -676.43065      1.7537399      3862.7381    
      1100   309.67973     -44671.81      -28.416922      1.7543267      3861.4463    
      1200   297.76632     -44657.352      4612.4102      1.7549138      3860.1544    
      1300   295.68118     -44674.233      17027.289      1.7555013      3858.8625    
      1400   300.96412     -44706.156      3876.0617      1.7560892      3857.5706    
      1500   301.23146     -44698.596      2572.4323      1.7566775      3856.2787    
      1600   312.78686     -44698.095      8881.2753      1.7572662      3854.9868    
      1700   284.28451     -44655.352      18751.743      1.7578553      3853.6949    
      1800   307.46417     -44658.597      10134.735      1.7584448      3852.4031    
      1900   315.0564      -44659.242      5570.3169      1.7590347      3851.1112    
      2000   305.74904     -44676.138      12770.616      1.759625       3849.8193    
      2100   292.99916     -44684.071      5400.9103      1.7602156      3848.5274    
      2200   286.88391     -44678.56       2563.8611      1.7608067      3847.2355    
      2300   297.44914     -44680.24       4465.4972      1.7613982      3845.9436    
      2400   310.10883     -44651.151      5094.8256      1.76199        3844.6517    
      2500   311.46434     -44651.2       -2259.4852      1.7625823      3843.3599    
      2600   297.85732     -44658.068     -1874.9922      1.763175       3842.068     
      2700   289.56164     -44667.923     -1883.6822      1.763768       3840.7761    
      2800   295.85843     -44680.897      10168.399      1.7643615      3839.4842    
      2900   287.75437     -44669.345      2294.8431      1.7649554      3838.1923    
      3000   299.75498     -44680.411     -4910.8084      1.7655496      3836.9004    
Loop time of 171.894 on 8 procs for 3000 steps with 386 atoms

Performance: 0.754 ns/day, 31.832 hours/ns, 17.453 timesteps/s, 6.737 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 138.65     | 141.89     | 145.46     |  19.6 | 82.54
Bond    | 0.0078183  | 0.0086269  | 0.0092621  |   0.6 |  0.01
Neigh   | 11.252     | 11.44      | 11.668     |   3.9 |  6.66
Comm    | 1.5338     | 5.109      | 8.3593     | 103.5 |  2.97
Output  | 0.0091303  | 0.010655   | 0.011846   |   0.7 |  0.01
Modify  | 13.132     | 13.358     | 13.548     |   3.5 |  7.77
Other   |            | 0.08252    |            |       |  0.05

Nlocal:          48.25 ave          57 max          41 min
Histogram: 2 1 0 1 0 1 1 0 1 1
Nghost:        3759.62 ave        3796 max        3713 min
Histogram: 1 1 1 0 1 0 0 0 2 2
Neighs:        33923.1 ave       39879 max       29073 min
Histogram: 2 1 0 1 0 1 1 0 1 1

Total # of neighbors = 271385
Ave neighs/atom = 703.06995
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.6078
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.166078 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.166078 xy delta -0.094505 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.166078 xy delta -0.094505 xz delta -0.010717 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 142 | 144.2 | 146.7 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   340.84522     -44694.626      2805.0797      1.7478941      3875.657     
       100   307.08348     -44662.435     -1754.377       1.7473117      3876.9489    
       200   305.70227     -44691.146     -728.97515      1.7467296      3878.2408    
       300   279.22426     -44677.522      7048.4263      1.746148       3879.5327    
       400   298.77076     -44687.922     -8464.1334      1.7455667      3880.8245    
       500   288.92778     -44653.749      3198.4365      1.7449858      3882.1164    
       600   317.87514     -44665.209      3088.9901      1.7444053      3883.4083    
       700   306.22196     -44664.558      950.36682      1.7438252      3884.7002    
       800   279.5916      -44657.233      8712.454       1.7432455      3885.9921    
       900   301.00822     -44684.862      1883.8965      1.7426661      3887.284     
      1000   311.79166     -44669.24       4405.3279      1.7420872      3888.5758    
      1100   315.70803     -44669.399      4050.9554      1.7415086      3889.8677    
      1200   293.37804     -44666.101     -5056.4735      1.7409304      3891.1596    
      1300   286.71987     -44679.708      6283.2294      1.7403526      3892.4515    
      1400   290.99753     -44682.505      119.88776      1.7397752      3893.7434    
      1500   315.0468      -44673.437      4646.5291      1.7391981      3895.0353    
      1600   316.48208     -44662.168     -601.97884      1.7386215      3896.3272    
      1700   318.73205     -44686.948      2455.075       1.7380452      3897.619     
      1800   289.27757     -44675.569      1214.6716      1.7374693      3898.9109    
      1900   274.12135     -44658.605      8978.037       1.7368938      3900.2028    
      2000   308.49228     -44668.156     -6954.6759      1.7363187      3901.4947    
      2100   314.7741      -44665.805      7354.9552      1.7357439      3902.7866    
      2200   297.37837     -44652.273     -2775.4358      1.7351696      3904.0785    
      2300   305.61547     -44666.512      4423.059       1.7345956      3905.3704    
      2400   304.1424      -44683.196     -350.59033      1.734022       3906.6622    
      2500   275.73995     -44678.94       1412.7567      1.7334487      3907.9541    
      2600   284.38493     -44689.358      7147.0399      1.7328759      3909.246     
      2700   299.46027     -44663.881      12703.366      1.7323034      3910.5379    
      2800   312.69335     -44668.822      5086.9393      1.7317313      3911.8298    
      2900   323.47491     -44706.283     -6292.801       1.7311596      3913.1217    
      3000   315.62578     -44720.336      2107.0536      1.7305882      3914.4136    
Loop time of 159.114 on 8 procs for 3000 steps with 386 atoms

Performance: 0.815 ns/day, 29.466 hours/ns, 18.854 timesteps/s, 7.278 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 130.18     | 131.71     | 134.26     |  13.2 | 82.77
Bond    | 0.0079384  | 0.0085084  | 0.0090654  |   0.4 |  0.01
Neigh   | 10.052     | 10.146     | 10.308     |   2.9 |  6.38
Comm    | 1.7435     | 4.3092     | 5.8327     |  73.0 |  2.71
Output  | 0.0093493  | 0.010813   | 0.011926   |   0.7 |  0.01
Modify  | 12.698     | 12.853     | 12.952     |   2.6 |  8.08
Other   |            | 0.08058    |            |       |  0.05

Nlocal:          48.25 ave          53 max          43 min
Histogram: 1 1 0 1 0 1 1 0 1 2
Nghost:        3464.12 ave        3475 max        3452 min
Histogram: 1 0 0 1 1 2 2 0 0 1
Neighs:        33314.5 ave       36356 max       29988 min
Histogram: 2 0 1 0 1 0 1 0 2 1

Total # of neighbors = 266516
Ave neighs/atom = 690.45596
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.4502
variable dlen equal ly-${len0}
variable dlen equal ly-13.4502
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4502
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.094505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.010717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -3.4e-05
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.134502 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.134502 yz delta -3.4e-05 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 142 | 144.2 | 146.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   340.84522     -44694.626      2805.0797      1.7478941      3875.657     
       100   307.14886     -44662.481     -1739.128       1.748477       3874.3651    
       200   306.61364     -44691.362     -683.4023       1.7490602      3873.0732    
       300   279.9189      -44679.524      2168.5231      1.7496438      3871.7813    
       400   296.99419     -44687.893     -8215.5607      1.7502278      3870.4895    
       500   284.14774     -44649.536      11300.809      1.7508121      3869.1976    
       600   320.97415     -44669.448      1940.5655      1.7513969      3867.9057    
       700   312.16144     -44672.389      8024.1826      1.7519821      3866.6138    
       800   289.1579      -44671.279      4224.9416      1.7525676      3865.3219    
       900   299.36031     -44687.936      5144.3625      1.7531536      3864.03      
      1000   313.62724     -44680.678      6840.9634      1.7537399      3862.7381    
      1100   305.00406     -44660.052      13483.019      1.7543267      3861.4463    
      1200   307.70778     -44677.261      202.63436      1.7549138      3860.1544    
      1300   283.27954     -44673.202      1693.2529      1.7555013      3858.8625    
      1400   296.54238     -44689.394      8024.5602      1.7560892      3857.5706    
      1500   308.5396      -44676.991      9100.9666      1.7566775      3856.2787    
      1600   321.24143     -44660.232      7648.3661      1.7572662      3854.9868    
      1700   307.66095     -44654.762      6435.8313      1.7578553      3853.6949    
      1800   302.65778     -44681.181      5271.1566      1.7584448      3852.4031    
      1900   297.44473     -44691.133      16471.046      1.7590347      3851.1112    
      2000   305.37342     -44694.904      8940.1455      1.759625       3849.8193    
      2100   304.11491     -44670.646      11840.837      1.7602156      3848.5274    
      2200   330.02111     -44683.239      6662.2852      1.7608067      3847.2355    
      2300   295.99476     -44674.419      2900.2021      1.7613982      3845.9436    
      2400   274.3862      -44676.377     -2729.7835      1.76199        3844.6517    
      2500   304.64032     -44698.113     -716.57545      1.7625823      3843.3599    
      2600   302.87176     -44684.082      8366.1409      1.763175       3842.068     
      2700   292.77671     -44663.076     -1139.3262      1.763768       3840.7761    
      2800   311.92082     -44690.223      6568.4334      1.7643615      3839.4842    
      2900   308.92871     -44721.614     -763.10634      1.7649554      3838.1923    
      3000   280.71697     -44704.825      12856.622      1.7655496      3836.9004    
Loop time of 172.744 on 8 procs for 3000 steps with 386 atoms

Performance: 0.750 ns/day, 31.990 hours/ns, 17.367 timesteps/s, 6.704 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 138.57     | 141.91     | 146.54     |  20.3 | 82.15
Bond    | 0.0077739  | 0.008391   | 0.0093807  |   0.6 |  0.00
Neigh   | 11.313     | 11.504     | 11.747     |   3.9 |  6.66
Comm    | 1.1935     | 5.832      | 9.1779     | 100.4 |  3.38
Output  | 0.0093652  | 0.010812   | 0.011891   |   0.7 |  0.01
Modify  | 13.155     | 13.396     | 13.591     |   3.6 |  7.75
Other   |            | 0.08353    |            |       |  0.05

Nlocal:          48.25 ave          59 max          43 min
Histogram: 2 3 0 1 0 0 0 0 1 1
Nghost:        3787.75 ave        3823 max        3743 min
Histogram: 1 0 1 1 1 0 1 0 1 2
Neighs:        33926.5 ave       41043 max       30428 min
Histogram: 2 3 0 1 0 0 0 0 1 1

Total # of neighbors = 271412
Ave neighs/atom = 703.1399
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4502
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.134502 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.134502 yz delta 3.4e-05 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 142 | 144.2 | 146.7 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   340.84522     -44694.626      2805.0797      1.7478941      3875.657     
       100   307.07702     -44662.551     -1774.8251      1.7473117      3876.9489    
       200   307.03874     -44692.584     -43.456616      1.7467296      3878.2408    
       300   285.63611     -44685.804      4731.2672      1.746148       3879.5327    
       400   308.61842     -44701.979     -3894.6293      1.7455667      3880.8245    
       500   290.98423     -44659.998      5772.0977      1.7449858      3882.1164    
       600   314.10273     -44665.681      9710.3877      1.7444053      3883.4083    
       700   311.37235     -44673.436     -4885.4105      1.7438252      3884.7002    
       800   306.92275     -44692.81      -365.07291      1.7432455      3885.9921    
       900   273.16417     -44665.533      14070.879      1.7426661      3887.284     
      1000   315.03389     -44691.276      844.24683      1.7420872      3888.5758    
      1100   305.96424     -44669.187      10372.554      1.7415086      3889.8677    
      1200   295.5396      -44665.741      6953.6833      1.7409304      3891.1596    
      1300   291.82572     -44688.922      9948.6935      1.7403526      3892.4515    
      1400   282.66983     -44684.583      476.00252      1.7397752      3893.7434    
      1500   296.89381     -44674.989      3091.2363      1.7391981      3895.0353    
      1600   315.0916      -44685.789      2633.2142      1.7386215      3896.3272    
      1700   296.85517     -44666.526      1125.2401      1.7380452      3897.619     
      1800   297.87707     -44671.474      5801.4949      1.7374693      3898.9109    
      1900   297.41908     -44679.39       14134.367      1.7368938      3900.2028    
      2000   279.67052     -44668.093      5030.5969      1.7363187      3901.4947    
      2100   304.24156     -44686.635      4437.9138      1.7357439      3902.7866    
      2200   301.4265      -44659.493     -6831.4351      1.7351696      3904.0785    
      2300   318.37124     -44660.418      6254.6269      1.7345956      3905.3704    
      2400   313.20888     -44662.819     -1128.5783      1.734022       3906.6622    
      2500   281.00997     -44669.259      1658.3734      1.7334487      3907.9541    
      2600   286.077       -44684.857     -4758.3466      1.7328759      3909.246     
      2700   272.59042     -44664.361      786.16929      1.7323034      3910.5379    
      2800   316.69384     -44682.286      22841.889      1.7317313      3911.8298    
      2900   287.56474     -44643.081     -3999.0441      1.7311596      3913.1217    
      3000   313.79517     -44680.932     -6136.9305      1.7305882      3914.4136    
Loop time of 158.811 on 8 procs for 3000 steps with 386 atoms

Performance: 0.816 ns/day, 29.409 hours/ns, 18.890 timesteps/s, 7.292 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 119.74     | 129.78     | 134.24     |  35.8 | 81.72
Bond    | 0.0076539  | 0.0083023  | 0.0089199  |   0.5 |  0.01
Neigh   | 9.4335     | 10.021     | 10.303     |   7.5 |  6.31
Comm    | 1.5406     | 6.0036     | 16.052     | 166.5 |  3.78
Output  | 0.0093155  | 0.010851   | 0.011911   |   0.7 |  0.01
Modify  | 12.628     | 12.908     | 13.493     |   6.6 |  8.13
Other   |            | 0.07918    |            |       |  0.05

Nlocal:          48.25 ave          51 max          44 min
Histogram: 2 0 0 0 0 1 0 1 3 1
Nghost:        3460.38 ave        3499 max        3431 min
Histogram: 1 1 2 0 1 0 2 0 0 1
Neighs:        33251.5 ave       34999 max       30521 min
Histogram: 2 0 0 0 0 1 0 1 3 1

Total # of neighbors = 266012
Ave neighs/atom = 689.15026
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.3502
variable dlen equal lz-${len0}
variable dlen equal lz-17.3502
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.3502
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.094505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.010717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -3.4e-05
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -0.173502 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 142 | 144.2 | 146.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   340.84522     -44694.626      2805.0797      1.7478941      3875.657     
       100   307.12579     -44662.522     -1763.3005      1.748477       3874.3651    
       200   306.55418     -44691.06      -467.77963      1.7490602      3873.0732    
       300   281.02977     -44680.511      4070.3953      1.7496438      3871.7813    
       400   301.96318     -44693.41       192.30127      1.7502278      3870.4895    
       500   284.21055     -44646.229      3005.9798      1.7508121      3869.1976    
       600   307.89221     -44651.815      8476.6487      1.7513969      3867.9057    
       700   305.51054     -44659.935      2762.0697      1.7519821      3866.6138    
       800   302.93576     -44678.428     -3765.2011      1.7525676      3865.3219    
       900   303.14057     -44687.478      9878.3986      1.7531536      3864.03      
      1000   316.82287     -44688.655      10214.156      1.7537399      3862.7381    
      1100   317.1636      -44680.306      6918.1876      1.7543267      3861.4463    
      1200   301.67625     -44674.723      5244.4597      1.7549138      3860.1544    
      1300   302.42344     -44704.781     -1377.2022      1.7555013      3858.8625    
      1400   313.19512     -44721.4        2770.6125      1.7560892      3857.5706    
      1500   291.43169     -44674.827     -1291.5833      1.7566775      3856.2787    
      1600   298.36268     -44678.752      3221.396       1.7572662      3854.9868    
      1700   289.98139     -44668.955      3669.4921      1.7578553      3853.6949    
      1800   306.81436     -44684.675      13788.137      1.7584448      3852.4031    
      1900   308.60106     -44685.795      4063.4681      1.7590347      3851.1112    
      2000   312.23917     -44695.986      4734.3126      1.759625       3849.8193    
      2100   287.81739     -44687.238     -1002.7789      1.7602156      3848.5274    
      2200   284.81646     -44689.896      15690.43       1.7608067      3847.2355    
      2300   299.62935     -44682.769     -2351.0196      1.7613982      3845.9436    
      2400   309.67656     -44665.219      762.31285      1.76199        3844.6517    
      2500   313.5999      -44675.585      1809.8346      1.7625823      3843.3599    
      2600   310.50352     -44688.064      7949.3556      1.763175       3842.068     
      2700   293.642       -44690.81       20176.142      1.763768       3840.7761    
      2800   286.52696     -44700.817     -1263.9431      1.7643615      3839.4842    
      2900   283.32932     -44716.25      -3236.7121      1.7649554      3838.1923    
      3000   288.57483     -44708.478      8625.781       1.7655496      3836.9004    
Loop time of 172.091 on 8 procs for 3000 steps with 386 atoms

Performance: 0.753 ns/day, 31.869 hours/ns, 17.433 timesteps/s, 6.729 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 99.173     | 136.04     | 145.47     | 121.2 | 79.05
Bond    | 0.0076352  | 0.0083483  | 0.0090532  |   0.6 |  0.00
Neigh   | 8.3321     | 11.093     | 11.903     |  31.8 |  6.45
Comm    | 1.6086     | 11.056     | 47.92      | 425.1 |  6.42
Output  | 0.0091716  | 0.010726   | 0.011832   |   0.7 |  0.01
Modify  | 13.001     | 13.801     | 16.578     |  28.6 |  8.02
Other   |            | 0.08011    |            |       |  0.05

Nlocal:          48.25 ave          57 max          41 min
Histogram: 2 0 1 1 0 2 0 0 1 1
Nghost:        3776.88 ave        3820 max        3733 min
Histogram: 1 1 1 1 0 0 0 2 1 1
Neighs:        33962.2 ave       39857 max       29074 min
Histogram: 2 0 1 1 0 2 0 0 1 1

Total # of neighbors = 271698
Ave neighs/atom = 703.88083
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.3502
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 0.173502 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 142 | 144.2 | 146.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   340.84522     -44694.626      2805.0797      1.7478941      3875.657     
       100   307.09272     -44662.506     -1761.0066      1.7473117      3876.9489    
       200   307.37177     -44692.74      -856.41617      1.7467296      3878.2408    
       300   281.70956     -44681.372      1373.9409      1.746148       3879.5327    
       400   297.36917     -44687.293     -3418.9149      1.7455667      3880.8245    
       500   281.98531     -44644.965      7461.6246      1.7449858      3882.1164    
       600   300.70435     -44642.28       509.7881       1.7444053      3883.4083    
       700   311.63922     -44665.782      10546.574      1.7438252      3884.7002    
       800   301.15956     -44682.441      5976.0373      1.7432455      3885.9921    
       900   275.9907      -44667.971      5296.7458      1.7426661      3887.284     
      1000   302.88523     -44679.489     -9968.5283      1.7420872      3888.5758    
      1100   306.62501     -44663.701     -4220.692       1.7415086      3889.8677    
      1200   305.16036     -44667.765      3228.2952      1.7409304      3891.1596    
      1300   300.84597     -44689.479      9900.6727      1.7403526      3892.4515    
      1400   287.8443      -44688.477      16082.304      1.7397752      3893.7434    
      1500   281.25243     -44673.014     -576.202        1.7391981      3895.0353    
      1600   322.0145      -44676.441      5054.2049      1.7386215      3896.3272    
      1700   306.53623     -44666.095      1091.5096      1.7380452      3897.619     
      1800   301.48881     -44682.748      9786.2961      1.7374693      3898.9109    
      1900   299.19511     -44699.207      15684.87       1.7368938      3900.2028    
      2000   294.12841     -44693.404      2961.8246      1.7363187      3901.4947    
      2100   306.71806     -44681.925      6143.1332      1.7357439      3902.7866    
      2200   294.89848     -44641.725      10110.987      1.7351696      3904.0785    
      2300   298.96711     -44656.256      2233.546       1.7345956      3905.3704    
      2400   287.307       -44689.381     -2573.3356      1.734022       3906.6622    
      2500   300.59101     -44706.939      9123.0694      1.7334487      3907.9541    
      2600   298.25813     -44692.794     -127.79262      1.7328759      3909.246     
      2700   312.30756     -44696.277     -1575.6351      1.7323034      3910.5379    
      2800   287.79648     -44693.284     -5107.4432      1.7317313      3911.8298    
      2900   291.81906     -44715.909     -10953.603      1.7311596      3913.1217    
      3000   284.94097     -44703.432     -10465.206      1.7305882      3914.4136    
Loop time of 170.025 on 8 procs for 3000 steps with 386 atoms

Performance: 0.762 ns/day, 31.486 hours/ns, 17.644 timesteps/s, 6.811 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 97.937     | 134.1      | 143.98     | 119.9 | 78.87
Bond    | 0.0076285  | 0.0083131  | 0.0090771  |   0.5 |  0.00
Neigh   | 8.2687     | 10.979     | 11.618     |  31.1 |  6.46
Comm    | 1.3612     | 11.263     | 47.419     | 413.7 |  6.62
Output  | 0.00954    | 0.011166   | 0.012296   |   0.7 |  0.01
Modify  | 12.961     | 13.586     | 16.312     |  28.1 |  7.99
Other   |            | 0.07914    |            |       |  0.05

Nlocal:          48.25 ave          58 max          38 min
Histogram: 1 1 0 1 0 2 0 1 1 1
Nghost:        3727.12 ave        3756 max        3676 min
Histogram: 1 0 1 0 0 0 1 2 1 2
Neighs:        33224.2 ave       39595 max       26384 min
Histogram: 1 1 0 1 0 2 0 1 1 1

Total # of neighbors = 265794
Ave neighs/atom = 688.58549
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 16.6078
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.0034)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.6078
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.094505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.010717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -3.4e-05
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -0.166078 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 142 | 144.2 | 146.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   340.84522     -44694.626      2805.0797      1.7478941      3875.657     
       100   307.11476     -44662.512     -1758.8097      1.7478941      3875.657     
       200   306.96751     -44692.069     -836.064        1.7478941      3875.657     
       300   282.23969     -44681.703      1729.662       1.7478941      3875.657     
       400   294.87494     -44686.373     -6959.0198      1.7478941      3875.657     
       500   286.73149     -44652.645      5605.107       1.7478941      3875.657     
       600   324.40107     -44672.589      2002.1456      1.7478941      3875.657     
       700   291.66612     -44648.268      16545.512      1.7478941      3875.657     
       800   299.0056      -44676.993     -9248.243       1.7478941      3875.657     
       900   289.43906     -44672.356      8497.7805      1.7478941      3875.657     
      1000   296.50811     -44656.767      972.43513      1.7478941      3875.657     
      1100   318.70072     -44674.46       12031.796      1.7478941      3875.657     
      1200   299.36302     -44670.172     -2212.7833      1.7478941      3875.657     
      1300   287.80225     -44674.857     -9488.8398      1.7478941      3875.657     
      1400   294.13581     -44690.183      496.54204      1.7478941      3875.657     
      1500   300.67354     -44673.493      13163.145      1.7478941      3875.657     
      1600   302.7946      -44653.872     -2623.1328      1.7478941      3875.657     
      1700   304.39326     -44665.88       7210.3934      1.7478941      3875.657     
      1800   304.41372     -44697.912      410.76772      1.7478941      3875.657     
      1900   277.1961      -44676.748      1429.9666      1.7478941      3875.657     
      2000   289.34901     -44680.674      2971.46        1.7478941      3875.657     
      2100   304.51126     -44683.437      4015.3444      1.7478941      3875.657     
      2200   312.43661     -44681.652      4021.4619      1.7478941      3875.657     
      2300   325.80772     -44682.526      5041.7231      1.7478941      3875.657     
      2400   324.7567      -44655.927      3292.587       1.7478941      3875.657     
      2500   303.37293     -44643.867      8196.6816      1.7478941      3875.657     
      2600   288.48954     -44660.312      5927.0878      1.7478941      3875.657     
      2700   286.38806     -44667.503      2214.4412      1.7478941      3875.657     
      2800   288.06978     -44668.71       2422.1994      1.7478941      3875.657     
      2900   299.62406     -44682.488      9076.8582      1.7478941      3875.657     
      3000   302.56668     -44682.337      14316.91       1.7478941      3875.657     
Loop time of 170.839 on 8 procs for 3000 steps with 386 atoms

Performance: 0.759 ns/day, 31.637 hours/ns, 17.560 timesteps/s, 6.778 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 98.292     | 134.91     | 144.35     | 121.0 | 78.97
Bond    | 0.0075406  | 0.0083846  | 0.009071   |   0.6 |  0.00
Neigh   | 8.3034     | 11.056     | 11.732     |  31.5 |  6.47
Comm    | 1.711      | 11.163     | 47.779     | 420.7 |  6.53
Output  | 0.0092513  | 0.010835   | 0.011932   |   0.7 |  0.01
Modify  | 12.939     | 13.608     | 16.377     |  28.5 |  7.97
Other   |            | 0.07867    |            |       |  0.05

Nlocal:          48.25 ave          62 max          39 min
Histogram: 1 1 2 1 0 1 1 0 0 1
Nghost:        3775.12 ave        3813 max        3711 min
Histogram: 1 0 0 0 2 0 1 1 2 1
Neighs:        33581.8 ave       42737 max       27247 min
Histogram: 1 1 2 0 1 1 1 0 0 1

Total # of neighbors = 268654
Ave neighs/atom = 695.99482
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.6078
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 0.166078 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 142 | 144.2 | 146.7 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   340.84522     -44694.626      2805.0797      1.7478941      3875.657     
       100   307.10029     -44662.518     -1760.1897      1.7478941      3875.657     
       200   306.76192     -44691.807     -827.21181      1.7478941      3875.657     
       300   280.46471     -44680.246      3425.7399      1.7478941      3875.657     
       400   299.84771     -44689.78      -5412.8819      1.7478941      3875.657     
       500   285.20304     -44649.45       3536.6234      1.7478941      3875.657     
       600   304.60764     -44647.846      15008.891      1.7478941      3875.657     
       700   308.53094     -44662.881      708.60914      1.7478941      3875.657     
       800   303.83933     -44683.321      5156.0106      1.7478941      3875.657     
       900   289.84312     -44680.464      11179.878      1.7478941      3875.657     
      1000   296.26454     -44670.375     -1290.345       1.7478941      3875.657     
      1100   325.15763     -44687.115      8913.178       1.7478941      3875.657     
      1200   303.72207     -44674.213      2788.7577      1.7478941      3875.657     
      1300   280.81379     -44667.656      3243.7015      1.7478941      3875.657     
      1400   296.24622     -44693.972     -2793.7887      1.7478941      3875.657     
      1500   296.65287     -44693.782      1334.0246      1.7478941      3875.657     
      1600   303.22362     -44675.334      14335.782      1.7478941      3875.657     
      1700   325.56258     -44685.371      4656.3664      1.7478941      3875.657     
      1800   309.76001     -44680.281      4000.4315      1.7478941      3875.657     
      1900   285.29339     -44685.201     -6314.5628      1.7478941      3875.657     
      2000   290.00827     -44689.684      731.11294      1.7478941      3875.657     
      2100   277.01862     -44664.426      7821.1737      1.7478941      3875.657     
      2200   310.95657     -44677.691     -9185.9746      1.7478941      3875.657     
      2300   299.36179     -44659.378      979.57335      1.7478941      3875.657     
      2400   322.08693     -44694.257      7330.2398      1.7478941      3875.657     
      2500   295.5069      -44687.187      8677.1036      1.7478941      3875.657     
      2600   301.38291     -44709.363     -8356.2743      1.7478941      3875.657     
      2700   306.67855     -44715.449     -519.22933      1.7478941      3875.657     
      2800   312.02962     -44682.243      7164.875       1.7478941      3875.657     
      2900   339.23247     -44698.535      677.14499      1.7478941      3875.657     
      3000   317.11046     -44707.745      1893.6773      1.7478941      3875.657     
Loop time of 159.281 on 8 procs for 3000 steps with 386 atoms

Performance: 0.814 ns/day, 29.496 hours/ns, 18.835 timesteps/s, 7.270 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 91.644     | 123.92     | 134.24     | 127.9 | 77.80
Bond    | 0.0074805  | 0.0082615  | 0.0088582  |   0.5 |  0.01
Neigh   | 7.4131     | 9.6428     | 10.315     |  32.5 |  6.05
Comm    | 1.8805     | 12.205     | 44.478     | 407.3 |  7.66
Output  | 0.0088523  | 0.010217   | 0.01111    |   0.6 |  0.01
Modify  | 12.739     | 13.416     | 15.66      |  27.7 |  8.42
Other   |            | 0.07677    |            |       |  0.05

Nlocal:          48.25 ave          52 max          43 min
Histogram: 1 1 0 1 0 0 1 2 0 2
Nghost:        3495.75 ave        3516 max        3476 min
Histogram: 2 0 2 0 0 0 0 1 2 1
Neighs:          33618 ave       35997 max       30090 min
Histogram: 1 1 0 1 0 0 1 1 1 2

Total # of neighbors = 268944
Ave neighs/atom = 696.74611
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.4502
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz--1.0717)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4502
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.094505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.010717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -3.4e-05
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -0.134502 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 142 | 144.2 | 146.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   340.84522     -44694.626      2805.0797      1.7478941      3875.657     
       100   307.09756     -44662.49      -1763.6219      1.7478941      3875.657     
       200   307.13591     -44692.29      -728.78911      1.7478941      3875.657     
       300   279.70126     -44679.351      684.40341      1.7478941      3875.657     
       400   295.58743     -44686.251     -3320.2949      1.7478941      3875.657     
       500   299.54404     -44665.874      11479.705      1.7478941      3875.657     
       600   314.90993     -44662.268      7796.8549      1.7478941      3875.657     
       700   315.85361     -44678.461      9481.3645      1.7478941      3875.657     
       800   292.27457     -44676.276     -6465.7927      1.7478941      3875.657     
       900   288.16815     -44675.098      12743.004      1.7478941      3875.657     
      1000   300.48486     -44662.619      9125.9532      1.7478941      3875.657     
      1100   312.69132     -44670.208      2079.7587      1.7478941      3875.657     
      1200   302.41913     -44678.145     -1834.2756      1.7478941      3875.657     
      1300   297.65142     -44687.559      85.254051      1.7478941      3875.657     
      1400   283.67151     -44668.809      399.21331      1.7478941      3875.657     
      1500   317.82403     -44670.425      12235.001      1.7478941      3875.657     
      1600   307.1823      -44644.147     -3028.8305      1.7478941      3875.657     
      1700   305.30456     -44654.891      1516.8048      1.7478941      3875.657     
      1800   291.77711     -44671.583     -1639.0693      1.7478941      3875.657     
      1900   291.85038     -44677.754      15422.436      1.7478941      3875.657     
      2000   303.45792     -44686.901     -582.0532       1.7478941      3875.657     
      2100   306.23075     -44672.932      7128.9992      1.7478941      3875.657     
      2200   307.67349     -44652.041      15319.087      1.7478941      3875.657     
      2300   306.92659     -44634.92       1032.885       1.7478941      3875.657     
      2400   304.06328     -44661.951     -1913.3944      1.7478941      3875.657     
      2500   288.79308     -44670.302     -5211.9052      1.7478941      3875.657     
      2600   301.51018     -44687.318     -5149.5324      1.7478941      3875.657     
      2700   304.00171     -44678.802      5666.5614      1.7478941      3875.657     
      2800   300.65336     -44651.824      1858.2163      1.7478941      3875.657     
      2900   323.36921     -44654.679      6538.161       1.7478941      3875.657     
      3000   316.70814     -44665.633      13959.816      1.7478941      3875.657     
Loop time of 156.413 on 8 procs for 3000 steps with 386 atoms

Performance: 0.829 ns/day, 28.965 hours/ns, 19.180 timesteps/s, 7.403 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 93.557     | 104.23     | 131.36     | 151.4 | 66.64
Bond    | 0.0066442  | 0.0074984  | 0.0082281  |   0.6 |  0.00
Neigh   | 8.3109     | 9.1213     | 11.436     |  42.8 |  5.83
Comm    | 1.7799     | 28.909     | 39.584     | 287.4 | 18.48
Output  | 0.0073877  | 0.0084908  | 0.0093354  |   0.6 |  0.01
Modify  | 11.738     | 14.066     | 14.878     |  34.7 |  8.99
Other   |            | 0.07154    |            |       |  0.05

Nlocal:          48.25 ave          57 max          42 min
Histogram: 1 1 2 0 2 0 0 0 0 2
Nghost:        3773.25 ave        3797 max        3746 min
Histogram: 2 1 0 0 1 0 0 0 2 2
Neighs:          33614 ave       39426 max       29300 min
Histogram: 1 1 2 0 2 0 0 0 0 2

Total # of neighbors = 268912
Ave neighs/atom = 696.66321
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4502
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 0.134502 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 142 | 144.2 | 146.7 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   340.84522     -44694.626      2805.0797      1.7478941      3875.657     
       100   307.12641     -44662.535     -1764.0105      1.7478941      3875.657     
       200   306.2565      -44691.475     -671.53545      1.7478941      3875.657     
       300   281.8649      -44681.84       3568.0905      1.7478941      3875.657     
       400   301.98686     -44692.536     -3968.0991      1.7478941      3875.657     
       500   289.77629     -44652.47       10611.496      1.7478941      3875.657     
       600   309.90765     -44652.536      2303.2906      1.7478941      3875.657     
       700   315.57323     -44670.2        3363.5337      1.7478941      3875.657     
       800   308.73723     -44687.248      3641.8049      1.7478941      3875.657     
       900   281.40452     -44665.147      12732.012      1.7478941      3875.657     
      1000   314.80943     -44682.816     -6715.3972      1.7478941      3875.657     
      1100   318.61448     -44681.609      707.54375      1.7478941      3875.657     
      1200   287.69679     -44664.222     -7028.281       1.7478941      3875.657     
      1300   284.91701     -44680.29       11237.888      1.7478941      3875.657     
      1400   269.33485     -44674.015      2339.2618      1.7478941      3875.657     
      1500   298.99599     -44680.186     -218.75125      1.7478941      3875.657     
      1600   310.7156      -44671.463      7551.7761      1.7478941      3875.657     
      1700   296.25155     -44672.105     -441.08908      1.7478941      3875.657     
      1800   287.29578     -44682.682      5051.5602      1.7478941      3875.657     
      1900   302.03623     -44695.36      -959.59731      1.7478941      3875.657     
      2000   307.75902     -44680.365     -380.6373       1.7478941      3875.657     
      2100   322.06422     -44663.022      9092.0876      1.7478941      3875.657     
      2200   301.58227     -44650.286     -190.91041      1.7478941      3875.657     
      2300   285.95419     -44662.147     -5836.3153      1.7478941      3875.657     
      2400   301.27927     -44688.157      5889.509       1.7478941      3875.657     
      2500   298.90287     -44686.7       -2289.3579      1.7478941      3875.657     
      2600   311.57401     -44702.36       1780.2859      1.7478941      3875.657     
      2700   290.73503     -44697.967      374.31985      1.7478941      3875.657     
      2800   284.48349     -44702.941     -4588.441       1.7478941      3875.657     
      2900   304.12286     -44700.1        7458.076       1.7478941      3875.657     
      3000   313.06513     -44687.609      9398.4942      1.7478941      3875.657     
Loop time of 110.529 on 8 procs for 3000 steps with 386 atoms

Performance: 1.173 ns/day, 20.468 hours/ns, 27.142 timesteps/s, 10.477 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.723     | 88.311     | 90.535     |  15.6 | 79.90
Bond    | 0.0065807  | 0.007374   | 0.0081568  |   0.6 |  0.01
Neigh   | 7.2861     | 7.3851     | 7.5844     |   4.3 |  6.68
Comm    | 2.6803     | 4.9099     | 6.4864     |  66.2 |  4.44
Output  | 0.0062453  | 0.0076306  | 0.0084998  |   0.7 |  0.01
Modify  | 9.6379     | 9.8338     | 9.9436     |   3.7 |  8.90
Other   |            | 0.07428    |            |       |  0.07

Nlocal:          48.25 ave          55 max          39 min
Histogram: 2 0 0 0 0 2 1 0 1 2
Nghost:        3513.88 ave        3530 max        3496 min
Histogram: 2 1 0 0 0 1 0 0 3 1
Neighs:        33571.8 ave       37864 max       27617 min
Histogram: 2 0 0 0 0 2 1 0 1 2

Total # of neighbors = 268574
Ave neighs/atom = 695.78756
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.3502
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--9.4505)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.3502
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.094505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.010717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -3.4e-05
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -0.173502 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 142 | 144.2 | 146.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   340.84522     -44694.626      2805.0797      1.7478941      3875.657     
       100   307.15171     -44662.478     -1782.2783      1.7478941      3875.657     
       200   306.00328     -44690.676     -646.63319      1.7478941      3875.657     
       300   279.58985     -44678.608      5954.519       1.7478941      3875.657     
       400   299.53342     -44689.17      -1577.8352      1.7478941      3875.657     
       500   292.33895     -44656.634      6986.7843      1.7478941      3875.657     
       600   317.56729     -44662.337      3656.8324      1.7478941      3875.657     
       700   304.65422     -44652.917      4202.9992      1.7478941      3875.657     
       800   299.05515     -44670.92       308.61725      1.7478941      3875.657     
       900   291.88991     -44679.426      6557.215       1.7478941      3875.657     
      1000   300.21435     -44685.138     -3888.0538      1.7478941      3875.657     
      1100   302.73922     -44679.45       6350.1925      1.7478941      3875.657     
      1200   311.15348     -44674.86       8929.4795      1.7478941      3875.657     
      1300   318.78027     -44684.009     -4828.8171      1.7478941      3875.657     
      1400   298.31454     -44689.788      1223.6572      1.7478941      3875.657     
      1500   286.02025     -44689.959      18200.989      1.7478941      3875.657     
      1600   299.85886     -44688.752      15513.377      1.7478941      3875.657     
      1700   312.54754     -44686.376      14640.968      1.7478941      3875.657     
      1800   303.67444     -44678.462      13582.611      1.7478941      3875.657     
      1900   295.06632     -44684.966      12648.19       1.7478941      3875.657     
      2000   284.62151     -44684.288      23422.331      1.7478941      3875.657     
      2100   293.89988     -44684.318      7715.7833      1.7478941      3875.657     
      2200   307.17524     -44661.106     -3321.3308      1.7478941      3875.657     
      2300   296.1648      -44650.253      2524.9979      1.7478941      3875.657     
      2400   320.43202     -44696.59       6400.3017      1.7478941      3875.657     
      2500   287.34864     -44676.272      1486.4657      1.7478941      3875.657     
      2600   289.38334     -44676.797      8340.908       1.7478941      3875.657     
      2700   292.78368     -44676.808      16173.427      1.7478941      3875.657     
      2800   289.39904     -44669.811      1081.9716      1.7478941      3875.657     
      2900   337.40397     -44706.901      5765.7627      1.7478941      3875.657     
      3000   292.25467     -44641.198      7076.5074      1.7478941      3875.657     
Loop time of 106.099 on 8 procs for 3000 steps with 386 atoms

Performance: 1.221 ns/day, 19.648 hours/ns, 28.275 timesteps/s, 10.914 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 82.277     | 84.814     | 87.325     |  18.7 | 79.94
Bond    | 0.0060153  | 0.0066526  | 0.0071175  |   0.4 |  0.01
Neigh   | 8.1321     | 8.2301     | 8.3617     |   2.9 |  7.76
Comm    | 0.74775    | 3.2535     | 5.7946     |  95.5 |  3.07
Output  | 0.0057884  | 0.0072751  | 0.0081353  |   0.8 |  0.01
Modify  | 9.5771     | 9.7147     | 9.8216     |   2.7 |  9.16
Other   |            | 0.07324    |            |       |  0.07

Nlocal:          48.25 ave          55 max          40 min
Histogram: 1 0 1 0 1 2 1 0 0 2
Nghost:        3756.75 ave        3789 max        3712 min
Histogram: 1 0 0 1 1 1 1 1 1 1
Neighs:        33615.2 ave       38130 max       27935 min
Histogram: 1 0 1 0 1 2 1 0 0 2

Total # of neighbors = 268922
Ave neighs/atom = 696.68912
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.3502
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 0.173502 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 142 | 144.2 | 146.7 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   340.84522     -44694.626      2805.0797      1.7478941      3875.657     
       100   307.08389     -44662.518     -1730.5792      1.7478941      3875.657     
       200   307.42119     -44692.761      541.7233       1.7478941      3875.657     
       300   285.54995     -44686.338      3344.4576      1.7478941      3875.657     
       400   306.11087     -44699.212     -4800.0366      1.7478941      3875.657     
       500   280.64917     -44644.323      7582.8139      1.7478941      3875.657     
       600   318.44384     -44665.26       8216.4735      1.7478941      3875.657     
       700   293.86236     -44648.262      545.56194      1.7478941      3875.657     
       800   301.58475     -44683.784      3259.8176      1.7478941      3875.657     
       900   291.88986     -44679.39       14031.902      1.7478941      3875.657     
      1000   320.10793     -44689.875      902.7903       1.7478941      3875.657     
      1100   320.71373     -44684.87      -2904.1971      1.7478941      3875.657     
      1200   291.56511     -44668.504      6600.4159      1.7478941      3875.657     
      1300   302.28686     -44691.87      -8707.1346      1.7478941      3875.657     
      1400   279.55454     -44676.972      5019.2627      1.7478941      3875.657     
      1500   305.15558     -44699.219     -7938.8568      1.7478941      3875.657     
      1600   303.03883     -44678.063      425.98576      1.7478941      3875.657     
      1700   315.35493     -44680.723      9023.6685      1.7478941      3875.657     
      1800   308.673       -44686.084      12549.438      1.7478941      3875.657     
      1900   301.35192     -44709.228      12384.169      1.7478941      3875.657     
      2000   288.56418     -44700.809     -1400.2769      1.7478941      3875.657     
      2100   283.88196     -44672.218      2143.7031      1.7478941      3875.657     
      2200   297.87644     -44674.18      -4970.7513      1.7478941      3875.657     
      2300   307.66297     -44678.852      8442.9736      1.7478941      3875.657     
      2400   304.41914     -44681.647      468.98547      1.7478941      3875.657     
      2500   288.66882     -44682.75       3966.0248      1.7478941      3875.657     
      2600   288.12772     -44712.041      14242.72       1.7478941      3875.657     
      2700   287.08824     -44716.169      9681.5269      1.7478941      3875.657     
      2800   276.01812     -44679.017      6935.6793      1.7478941      3875.657     
      2900   293.10189     -44681.035      1713.7908      1.7478941      3875.657     
      3000   307.13696     -44692.747     -4682.5035      1.7478941      3875.657     
Loop time of 90.5703 on 8 procs for 3000 steps with 386 atoms

Performance: 1.431 ns/day, 16.772 hours/ns, 33.123 timesteps/s, 12.786 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 70.044     | 71.095     | 73.305     |  14.6 | 78.50
Bond    | 0.0055171  | 0.0059805  | 0.006279   |   0.3 |  0.01
Neigh   | 7.1935     | 7.2296     | 7.2853     |   1.0 |  7.98
Comm    | 0.8064     | 3.0098     | 4.0548     |  70.8 |  3.32
Output  | 0.006412   | 0.0077783  | 0.0085552  |   0.7 |  0.01
Modify  | 9.0933     | 9.1556     | 9.1863     |   0.9 | 10.11
Other   |            | 0.06704    |            |       |  0.07

Nlocal:          48.25 ave          53 max          41 min
Histogram: 1 0 0 1 0 1 3 0 0 2
Nghost:        3501.25 ave        3524 max        3484 min
Histogram: 2 1 0 0 1 1 2 0 0 1
Neighs:        33588.6 ave       36655 max       28881 min
Histogram: 1 0 0 1 1 0 3 0 0 2

Total # of neighbors = 268709
Ave neighs/atom = 696.13731
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:32:49
