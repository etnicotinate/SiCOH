LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.1                  # the deformation magnitude 0.01

variable FF string "CHONSi.ff C H O Si"   # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si
variable structure string 333U-50C-9-vasp

# Read the initial sctructure
# box tilt large
read_data       ${structure}.data
read_data       333U-50C-9-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.007 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -0.82 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 145.4 | 147.4 | 149.4 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0             -43202.648      0             -43202.648      114735.64    
        60   0             -44592.068      0             -44592.068      8502.1779    
Loop time of 8.67323 on 16 procs for 60 steps with 386 atoms

97.2% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
     -43202.6479194478  -44592.0627460336  -44592.0676727274
  Force two-norm initial, final = 1894.1947 201.85474
  Force max component initial, final = 227.47497 106.5436
  Final line search alpha, max atom move = 0.00055050318 0.058652589
  Iterations, force evaluations = 60 159

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 6.8171     | 6.9435     | 7.1621     |   4.6 | 80.06
Bond    | 8.0052e-05 | 9.3389e-05 | 0.00010275 |   0.0 |  0.00
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.13068    | 0.34894    | 0.47679    |  20.7 |  4.02
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 1.3683     | 1.3688     | 1.3691     |   0.0 | 15.78
Other   |            | 0.01184    |            |       |  0.14

Nlocal:          48.25 ave          55 max          40 min
Histogram: 2 0 0 0 2 0 1 0 1 2
Nghost:        3730.62 ave        3778 max        3674 min
Histogram: 1 0 1 1 1 0 1 0 2 1
Neighs:        33640.4 ave       38256 max       27931 min
Histogram: 2 0 0 0 2 0 1 0 1 2

Total # of neighbors = 269123
Ave neighs/atom = 697.20984
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-9-vasp_opt.data
System init for write_data ...
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.8 | 145.8 | 147.8 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -44592.068      12562.934      1.7478941      3875.657     
       100   258.229       -44503.844      9669.7908      1.7478941      3875.657     
       200   302.62794     -44504.056      14309.318      1.7478941      3875.657     
       300   329.80717     -44507.212      11670.438      1.7478941      3875.657     
       400   320.13041     -44532.661      6662.1453      1.7478941      3875.657     
       500   304.22793     -44565.318      12415.514      1.7478941      3875.657     
       600   292.59115     -44583.064     -6754.1947      1.7478941      3875.657     
       700   295.05774     -44595.09       14947.72       1.7478941      3875.657     
       800   308.72426     -44604.487      7210.6234      1.7478941      3875.657     
       900   310.91665     -44603.179      49.284722      1.7478941      3875.657     
      1000   295.54523     -44588.702      4796.9883      1.7478941      3875.657     
      1100   312.12086     -44628.207      7280.8289      1.7478941      3875.657     
      1200   296.79763     -44636.945      1166.2252      1.7478941      3875.657     
      1300   301.39025     -44652.982      1722.2869      1.7478941      3875.657     
      1400   320.02991     -44678.866      38.181459      1.7478941      3875.657     
      1500   293.1676      -44651.178     -13127.102      1.7478941      3875.657     
      1600   298.20156     -44630.885      12668.199      1.7478941      3875.657     
      1700   320.43504     -44620.304      7691.9693      1.7478941      3875.657     
      1800   313.19241     -44627.543      12174.734      1.7478941      3875.657     
      1900   310.4499      -44664.561      523.26892      1.7478941      3875.657     
      2000   301.09684     -44678.329      1713.303       1.7478941      3875.657     
      2100   307.84265     -44694.56       1926.0372      1.7478941      3875.657     
      2200   300.39899     -44676.728     -3774.9535      1.7478941      3875.657     
      2300   289.16048     -44645.29      -6457.0186      1.7478941      3875.657     
      2400   312.78878     -44645.897      10108.114      1.7478941      3875.657     
      2500   328.07339     -44650.327      5538.9536      1.7478941      3875.657     
      2600   311.65922     -44668.164      737.95954      1.7478941      3875.657     
      2700   295.78373     -44671.836      9154.3954      1.7478941      3875.657     
      2800   296.08799     -44673.631      6039.2746      1.7478941      3875.657     
      2900   294.5949      -44658.316     -8809.9602      1.7478941      3875.657     
      3000   314.89825     -44651.234     -7636.539       1.7478941      3875.657     
      3100   326.17163     -44656.422      3652.5654      1.7478941      3875.657     
      3200   309.31162     -44677.264      8584.8195      1.7478941      3875.657     
      3300   288.00365     -44672.078      632.35763      1.7478941      3875.657     
      3400   295.29978     -44668.652      13525.538      1.7478941      3875.657     
      3500   295.62179     -44647.686     -6352.4435      1.7478941      3875.657     
      3600   291.06936     -44637.853      2268.6093      1.7478941      3875.657     
      3700   302.1271      -44675.218     -1661.4253      1.7478941      3875.657     
      3800   272.81805     -44666.72       4810.5365      1.7478941      3875.657     
      3900   300.15127     -44688.269     -5067.4538      1.7478941      3875.657     
      4000   310.80088     -44682.358     -1992.832       1.7478941      3875.657     
      4100   296.66401     -44662.318      9534.9955      1.7478941      3875.657     
      4200   298.55372     -44656.346     -7984.8566      1.7478941      3875.657     
      4300   311.79266     -44665.69       1203.3221      1.7478941      3875.657     
      4400   330.54908     -44696.171      13687.712      1.7478941      3875.657     
      4500   297.70458     -44665.587      10198.372      1.7478941      3875.657     
      4600   307.94239     -44673.785     -5690.9647      1.7478941      3875.657     
      4700   287.83779     -44662.068      5739.2463      1.7478941      3875.657     
      4800   282.55737     -44689.108      491.06005      1.7478941      3875.657     
      4900   282.7638      -44691.674      3820.9048      1.7478941      3875.657     
      5000   294.31138     -44672.01      -10358.693      1.7478941      3875.657     
Loop time of 278.525 on 16 procs for 5000 steps with 386 atoms

Performance: 0.776 ns/day, 30.947 hours/ns, 17.952 timesteps/s, 6.929 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 176.53     | 214.45     | 234.92     | 158.0 | 77.00
Bond    | 0.001372   | 0.0017173  | 0.0021796  |   0.6 |  0.00
Neigh   | 14.555     | 17.353     | 18.808     |  40.7 |  6.23
Comm    | 3.7319     | 24.222     | 62.13      | 470.2 |  8.70
Output  | 0.0030239  | 0.003193   | 0.0042652  |   0.7 |  0.00
Modify  | 20.934     | 22.37      | 25.191     |  36.0 |  8.03
Other   |            | 0.1213     |            |       |  0.04

Nlocal:          48.25 ave          55 max          42 min
Histogram: 1 0 2 1 0 1 1 0 1 1
Nghost:           3740 ave        3777 max        3701 min
Histogram: 1 1 0 1 1 1 1 0 0 2
Neighs:        33586.8 ave       38054 max       29315 min
Histogram: 1 0 2 1 0 1 1 0 1 1

Total # of neighbors = 268694
Ave neighs/atom = 696.09845
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333U-50C-9-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.6078
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.4502
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.3502

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.0034
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal -1.0717
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -9.4505

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 16.6078
variable dlen equal lx-${len0}
variable dlen equal lx-16.6078
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*16.6078
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.94505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.10717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -0.00034
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.66078 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.66078 xy delta 0.94505 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.66078 xy delta 0.94505 xz delta 0.10717 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144.7 | 146.2 | 147.7 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   294.31138     -44672.01      -10358.718      3875.657       16.6078        13.4502        17.3502      
       100   295.16297     -44659.29       3812.3682      3867.9057      16.574584      13.4502        17.3502      
       200   302.98243     -44665.255     -5271.3667      3860.1544      16.541369      13.4502        17.3502      
       300   287.68033     -44656.599      9512.3508      3852.4031      16.508153      13.4502        17.3502      
       400   293.27993     -44679          10422.292      3844.6517      16.474938      13.4502        17.3502      
       500   299.70638     -44687.263     -4455.4214      3836.9004      16.441722      13.4502        17.3502      
       600   288.58869     -44675.355     -2192.8485      3829.1491      16.408506      13.4502        17.3502      
       700   298.44242     -44675.331      2486.9291      3821.3978      16.375291      13.4502        17.3502      
       800   305.23878     -44672.8       -6642.191       3813.6465      16.342075      13.4502        17.3502      
       900   300.84521     -44677.737      11983.308      3805.8952      16.30886       13.4502        17.3502      
      1000   280.98247     -44678.179      5117.132       3798.1439      16.275644      13.4502        17.3502      
      1100   288.57301     -44678.558      13142.797      3790.3925      16.242428      13.4502        17.3502      
      1200   290.0271      -44670.897      4325.8285      3782.6412      16.209213      13.4502        17.3502      
      1300   297.99207     -44684.421      15948.609      3774.8899      16.175997      13.4502        17.3502      
      1400   275.10181     -44673.032      10943.195      3767.1386      16.142782      13.4502        17.3502      
      1500   297.1229      -44688.158      10718.509      3759.3873      16.109566      13.4502        17.3502      
      1600   313.01612     -44700.378      15596.487      3751.636       16.07635       13.4502        17.3502      
      1700   285.79432     -44683.869      14531.182      3743.8847      16.043135      13.4502        17.3502      
      1800   303.65994     -44703.643      20189.022      3736.1333      16.009919      13.4502        17.3502      
      1900   309.40775     -44699.501      17047.783      3728.382       15.976704      13.4502        17.3502      
      2000   303.74343     -44698.683      12136.931      3720.6307      15.943488      13.4502        17.3502      
      2100   275.72361     -44679.665      11863.637      3712.8794      15.910272      13.4502        17.3502      
      2200   316.80415     -44721.959      7810.2529      3705.1281      15.877057      13.4502        17.3502      
      2300   290.69453     -44686.311      20059.769      3697.3768      15.843841      13.4502        17.3502      
      2400   298.28735     -44684.041      4995.365       3689.6255      15.810626      13.4502        17.3502      
      2500   305.52759     -44684.138      15227.118      3681.8741      15.77741       13.4502        17.3502      
      2600   285.99803     -44652.06       11878.313      3674.1228      15.744194      13.4502        17.3502      
      2700   296.11584     -44683.156      27351.237      3666.3715      15.710979      13.4502        17.3502      
      2800   305.33659     -44706.656      12557.839      3658.6202      15.677763      13.4502        17.3502      
      2900   320.35141     -44718.797      17506.909      3650.8689      15.644548      13.4502        17.3502      
      3000   304.27541     -44693.596      24407.921      3643.1176      15.611332      13.4502        17.3502      
      3100   282.71348     -44688.819      14833.89       3635.3663      15.578116      13.4502        17.3502      
      3200   290.6813      -44706.153      25548.477      3627.6149      15.544901      13.4502        17.3502      
      3300   292.91594     -44694.236      27141.568      3619.8636      15.511685      13.4502        17.3502      
      3400   295.13746     -44669.037      17533.631      3612.1123      15.47847       13.4502        17.3502      
      3500   317.88146     -44670.353      28421.767      3604.361       15.445254      13.4502        17.3502      
      3600   292.25632     -44662.928      24071.645      3596.6097      15.412038      13.4502        17.3502      
      3700   280.10741     -44664.021      13817.976      3588.8584      15.378823      13.4502        17.3502      
      3800   315.556       -44692.63       28652.961      3581.1071      15.345607      13.4502        17.3502      
      3900   304.66848     -44684.618      42923.906      3573.3557      15.312392      13.4502        17.3502      
      4000   293.70957     -44683.072      7957.6503      3565.6044      15.279176      13.4502        17.3502      
      4100   325.98345     -44716.232      37732.899      3557.8531      15.24596       13.4502        17.3502      
      4200   291.04863     -44666.939      22335.461      3550.1018      15.212745      13.4502        17.3502      
      4300   309.84655     -44687.103      34032.814      3542.3505      15.179529      13.4502        17.3502      
      4400   285.81169     -44657.23       35516.286      3534.5992      15.146314      13.4502        17.3502      
      4500   289.4261      -44637.926      35037.708      3526.8479      15.113098      13.4502        17.3502      
      4600   296.93888     -44638.879      34006.264      3519.0965      15.079882      13.4502        17.3502      
      4700   309.75565     -44673.084      48421.671      3511.3452      15.046667      13.4502        17.3502      
      4800   290.67278     -44657.373      35179.221      3503.5939      15.013451      13.4502        17.3502      
      4900   283.57085     -44639.558      40786.555      3495.8426      14.980236      13.4502        17.3502      
      5000   304.17444     -44632.069      34532.945      3488.0913      14.94702       13.4502        17.3502      
Loop time of 302.998 on 16 procs for 5000 steps with 386 atoms

Performance: 0.713 ns/day, 33.666 hours/ns, 16.502 timesteps/s, 6.370 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 202.37     | 228.65     | 252.18     | 133.0 | 75.46
Bond    | 0.0014075  | 0.0018041  | 0.0023028  |   0.7 |  0.00
Neigh   | 16.021     | 17.96      | 19.617     |  32.4 |  5.93
Comm    | 7.1323     | 30.66      | 56.927     | 363.2 | 10.12
Output  | 0.016494   | 0.018384   | 0.020125   |   0.9 |  0.01
Modify  | 23.921     | 25.578     | 27.532     |  27.1 |  8.44
Other   |            | 0.1339     |            |       |  0.04

Nlocal:          48.25 ave          55 max          41 min
Histogram: 1 0 2 0 0 1 1 2 0 1
Nghost:        3995.75 ave        4061 max        3941 min
Histogram: 1 1 0 2 1 0 2 0 0 1
Neighs:        37399.9 ave       42151 max       32150 min
Histogram: 1 1 1 0 0 1 1 1 1 1

Total # of neighbors = 299199
Ave neighs/atom = 775.12694
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*16.6078
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.66078 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.66078 xy delta -0.94505 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.66078 xy delta -0.94505 xz delta -0.10717 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144.8 | 146.2 | 147.7 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   294.31138     -44672.01      -10358.718      3875.657       16.6078        13.4502        17.3502      
       100   294.56562     -44659.571      3420.159       3883.4083      16.641016      13.4502        17.3502      
       200   307.30959     -44665.097     -9064.861       3891.1596      16.674231      13.4502        17.3502      
       300   291.26622     -44664.598      6460.7463      3898.9109      16.707447      13.4502        17.3502      
       400   275.22012     -44664.176     -6867.096       3906.6622      16.740662      13.4502        17.3502      
       500   297.52948     -44678.514      938.0421       3914.4136      16.773878      13.4502        17.3502      
       600   314.45041     -44657.616     -9259.044       3922.1649      16.807094      13.4502        17.3502      
       700   334.02986     -44663.013     -5364.2101      3929.9162      16.840309      13.4502        17.3502      
       800   309.78664     -44660.382      4549.951       3937.6675      16.873525      13.4502        17.3502      
       900   297.55998     -44665.791      8481.3893      3945.4188      16.90674       13.4502        17.3502      
      1000   283.07266     -44649.373     -9134.1509      3953.1701      16.939956      13.4502        17.3502      
      1100   306.86214     -44663.016     -1439.7471      3960.9214      16.973172      13.4502        17.3502      
      1200   313.29399     -44634.372      3045.5111      3968.6728      17.006387      13.4502        17.3502      
      1300   321.73436     -44625.734     -913.76374      3976.4241      17.039603      13.4502        17.3502      
      1400   294.48329     -44633.814     -453.11321      3984.1754      17.072818      13.4502        17.3502      
      1500   305.27692     -44653.66      -387.85919      3991.9267      17.106034      13.4502        17.3502      
      1600   286.31578     -44633.79      -9493.2019      3999.678       17.13925       13.4502        17.3502      
      1700   294.06151     -44630.14      -8854.0415      4007.4293      17.172465      13.4502        17.3502      
      1800   315.80692     -44636.707     -5505.3352      4015.1806      17.205681      13.4502        17.3502      
      1900   308.62211     -44618.672     -5498.4152      4022.932       17.238896      13.4502        17.3502      
      2000   300.07782     -44633.23      -10034.836      4030.6833      17.272112      13.4502        17.3502      
      2100   316.53704     -44660.771     -3380.7361      4038.4346      17.305328      13.4502        17.3502      
      2200   294.3329      -44630.138     -11297.44       4046.1859      17.338543      13.4502        17.3502      
      2300   303.91581     -44623.722      2224.4301      4053.9372      17.371759      13.4502        17.3502      
      2400   319.31676     -44596.658     -11872.67       4061.6885      17.404974      13.4502        17.3502      
      2500   307.08967     -44578.832     -8719.1447      4069.4398      17.43819       13.4502        17.3502      
      2600   320.51607     -44621.827     -5114.6032      4077.1912      17.471406      13.4502        17.3502      
      2700   314.56914     -44621.98      -8870.314       4084.9425      17.504621      13.4502        17.3502      
      2800   306.91997     -44620.355     -13400.272      4092.6938      17.537837      13.4502        17.3502      
      2900   281.28916     -44597.929     -17136.766      4100.4451      17.571052      13.4502        17.3502      
      3000   305.53138     -44610.99      -19759.851      4108.1964      17.604268      13.4502        17.3502      
      3100   309.44711     -44571.617     -18205.844      4115.9477      17.637484      13.4502        17.3502      
      3200   334.96294     -44583.3       -12119.713      4123.699       17.670699      13.4502        17.3502      
      3300   318.55979     -44597.418     -6964.9084      4131.4504      17.703915      13.4502        17.3502      
      3400   289.65096     -44580.802     -15598.138      4139.2017      17.73713       13.4502        17.3502      
      3500   281.16636     -44581.924     -28350.428      4146.953       17.770346      13.4502        17.3502      
      3600   295.73232     -44588.196     -13515.986      4154.7043      17.803562      13.4502        17.3502      
      3700   297.08396     -44572.794     -17017.643      4162.4556      17.836777      13.4502        17.3502      
      3800   295.41693     -44571.039     -21027.659      4170.2069      17.869993      13.4502        17.3502      
      3900   303.14066     -44587.946     -11016.127      4177.9582      17.903208      13.4502        17.3502      
      4000   287.33861     -44583.759     -27406.702      4185.7096      17.936424      13.4502        17.3502      
      4100   303.64432     -44586.389     -13696.074      4193.4609      17.96964       13.4502        17.3502      
      4200   294.90625     -44548.792     -21182.84       4201.2122      18.002855      13.4502        17.3502      
      4300   299.36896     -44507.473     -23502.841      4208.9635      18.036071      13.4502        17.3502      
      4400   305.27504     -44522.389     -19622.983      4216.7148      18.069286      13.4502        17.3502      
      4500   304.39776     -44544.809     -12544.146      4224.4661      18.102502      13.4502        17.3502      
      4600   293.36444     -44536.138     -23106.589      4232.2174      18.135718      13.4502        17.3502      
      4700   302.82304     -44553.17      -17408.388      4239.9688      18.168933      13.4502        17.3502      
      4800   293.6663      -44561.876     -23059.813      4247.7201      18.202149      13.4502        17.3502      
      4900   275.43373     -44541.902     -20450.574      4255.4714      18.235364      13.4502        17.3502      
      5000   300.77794     -44579.946     -17440.22       4263.2227      18.26858       13.4502        17.3502      
Loop time of 247.595 on 16 procs for 5000 steps with 386 atoms

Performance: 0.872 ns/day, 27.511 hours/ns, 20.194 timesteps/s, 7.795 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 143.68     | 181.84     | 207.36     | 206.6 | 73.44
Bond    | 0.0014131  | 0.0017106  | 0.0020444  |   0.6 |  0.00
Neigh   | 11.439     | 14.41      | 16.499     |  56.6 |  5.82
Comm    | 3.1405     | 28.662     | 66.818     | 520.4 | 11.58
Output  | 0.01644    | 0.018392   | 0.020003   |   0.7 |  0.01
Modify  | 20.437     | 22.536     | 25.525     |  45.5 |  9.10
Other   |            | 0.1236     |            |       |  0.05

Nlocal:          48.25 ave          56 max          41 min
Histogram: 1 0 1 1 2 0 1 0 1 1
Nghost:        3352.88 ave        3374 max        3324 min
Histogram: 1 0 1 0 1 0 1 2 1 1
Neighs:        30464.5 ave       34987 max       26170 min
Histogram: 1 1 0 1 2 0 1 0 1 1

Total # of neighbors = 243716
Ave neighs/atom = 631.3886
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.4502
variable dlen equal ly-${len0}
variable dlen equal ly-13.4502
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.4502
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.94505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.10717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -0.00034
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.34502 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.34502 yz delta -0.00034 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144.7 | 146.2 | 147.7 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   294.31138     -44672.01      -10358.718      3875.657       16.6078        13.4502        17.3502      
       100   295.13011     -44659.234      3756.9571      3867.9057      16.6078        13.4233        17.3502      
       200   301.74956     -44665.06       1634.5567      3860.1544      16.6078        13.396399      17.3502      
       300   299.11226     -44670.924      5060.2148      3852.4031      16.6078        13.369499      17.3502      
       400   277.24211     -44671.889      15625.179      3844.6517      16.6078        13.342598      17.3502      
       500   295.67779     -44686.007      2961.5624      3836.9004      16.6078        13.315698      17.3502      
       600   307.06397     -44684.139     -6397.0704      3829.1491      16.6078        13.288798      17.3502      
       700   321.03061     -44657.775      2151.8441      3821.3978      16.6078        13.261897      17.3502      
       800   308.89911     -44641.784     -1873.1781      3813.6465      16.6078        13.234997      17.3502      
       900   303.16084     -44663.576      12933.423      3805.8952      16.6078        13.208096      17.3502      
      1000   303.41694     -44682.31       17728.871      3798.1439      16.6078        13.181196      17.3502      
      1100   301.44026     -44686.455      632.55455      3790.3925      16.6078        13.154296      17.3502      
      1200   297.75672     -44685.308      3505.4955      3782.6412      16.6078        13.127395      17.3502      
      1300   302.97309     -44715.772      14330.771      3774.8899      16.6078        13.100495      17.3502      
      1400   289.38289     -44706.146      12877.922      3767.1386      16.6078        13.073594      17.3502      
      1500   292.95426     -44692.933     -1334.3886      3759.3873      16.6078        13.046694      17.3502      
      1600   311.87251     -44704.963      11552.874      3751.636       16.6078        13.019794      17.3502      
      1700   317.84974     -44701.997      3065.4699      3743.8847      16.6078        12.992893      17.3502      
      1800   309.56064     -44695.712      8088.092       3736.1333      16.6078        12.965993      17.3502      
      1900   300.47504     -44710.982      6765.778       3728.382       16.6078        12.939092      17.3502      
      2000   285.50833     -44698.137      10080.26       3720.6307      16.6078        12.912192      17.3502      
      2100   304.9696      -44688.493      13751.433      3712.8794      16.6078        12.885292      17.3502      
      2200   309.92767     -44664.915      14049.64       3705.1281      16.6078        12.858391      17.3502      
      2300   302.55344     -44659.283      7342.7768      3697.3768      16.6078        12.831491      17.3502      
      2400   292.90813     -44684.302      22593.375      3689.6255      16.6078        12.80459       17.3502      
      2500   293.31711     -44688.466      8350.0992      3681.8741      16.6078        12.77769       17.3502      
      2600   290.58501     -44677.961      10253.982      3674.1228      16.6078        12.75079       17.3502      
      2700   319.15302     -44671.465      23946.262      3666.3715      16.6078        12.723889      17.3502      
      2800   308.60061     -44636.902      25129.779      3658.6202      16.6078        12.696989      17.3502      
      2900   303.86514     -44645.13       16668.504      3650.8689      16.6078        12.670088      17.3502      
      3000   295.49998     -44657.437      18662.758      3643.1176      16.6078        12.643188      17.3502      
      3100   290.65744     -44658.884      25224.376      3635.3663      16.6078        12.616288      17.3502      
      3200   288.08767     -44657.846      17916.795      3627.6149      16.6078        12.589387      17.3502      
      3300   294.39691     -44652.456      29976.844      3619.8636      16.6078        12.562487      17.3502      
      3400   307.99756     -44640.622      29761.512      3612.1123      16.6078        12.535586      17.3502      
      3500   294.19878     -44641.849      22325.413      3604.361       16.6078        12.508686      17.3502      
      3600   299.33        -44666.735      15924.337      3596.6097      16.6078        12.481786      17.3502      
      3700   304.86043     -44668.394      18008.446      3588.8584      16.6078        12.454885      17.3502      
      3800   291.32697     -44625.128      27310.297      3581.1071      16.6078        12.427985      17.3502      
      3900   315.00513     -44614.177      26897.887      3573.3557      16.6078        12.401084      17.3502      
      4000   297.71972     -44585.833      33480.871      3565.6044      16.6078        12.374184      17.3502      
      4100   291.85035     -44619.887      29931.248      3557.8531      16.6078        12.347284      17.3502      
      4200   289.45474     -44625.98       27810.928      3550.1018      16.6078        12.320383      17.3502      
      4300   274.28166     -44599.746      29788.032      3542.3505      16.6078        12.293483      17.3502      
      4400   310.32045     -44646.278      27005.814      3534.5992      16.6078        12.266582      17.3502      
      4500   281.10483     -44635.067      38383.788      3526.8479      16.6078        12.239682      17.3502      
      4600   292.71785     -44636.446      39878.074      3519.0965      16.6078        12.212782      17.3502      
      4700   291.86582     -44609.51       43782.057      3511.3452      16.6078        12.185881      17.3502      
      4800   334.13251     -44600.517      47539.459      3503.5939      16.6078        12.158981      17.3502      
      4900   324.85044     -44592.481      38060.727      3495.8426      16.6078        12.13208       17.3502      
      5000   322.09415     -44603.977      37987.102      3488.0913      16.6078        12.10518       17.3502      
Loop time of 310.244 on 16 procs for 5000 steps with 386 atoms

Performance: 0.696 ns/day, 34.472 hours/ns, 16.116 timesteps/s, 6.221 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 194.03     | 232.3      | 257.42     | 141.2 | 74.88
Bond    | 0.0014573  | 0.0018007  | 0.0022034  |   0.6 |  0.00
Neigh   | 15.291     | 18.387     | 20.36      |  39.8 |  5.93
Comm    | 8.8487     | 33.944     | 72.213     | 368.9 | 10.94
Output  | 0.019      | 0.02153    | 0.024468   |   1.2 |  0.01
Modify  | 23.387     | 25.369     | 28.454     |  33.8 |  8.18
Other   |            | 0.2197     |            |       |  0.07

Nlocal:          48.25 ave          57 max          40 min
Histogram: 1 1 2 0 0 1 0 1 1 1
Nghost:        4195.88 ave        4254 max        4131 min
Histogram: 2 0 1 1 0 0 0 1 1 2
Neighs:        37380.1 ave       43680 max       31382 min
Histogram: 1 1 1 1 0 1 0 1 1 1

Total # of neighbors = 299041
Ave neighs/atom = 774.71762
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.4502
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.34502 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.34502 yz delta 0.00034 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144.8 | 146.2 | 147.7 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   294.31138     -44672.01      -10358.718      3875.657       16.6078        13.4502        17.3502      
       100   294.59461     -44659.891      3727.9534      3883.4083      16.6078        13.4771        17.3502      
       200   305.87186     -44665.462     -7356.0259      3891.1596      16.6078        13.504001      17.3502      
       300   294.29477     -44666.79       2780.5948      3898.9109      16.6078        13.530901      17.3502      
       400   275.76014     -44670.42       2257.7691      3906.6622      16.6078        13.557802      17.3502      
       500   305.25007     -44701.168     -13123.577      3914.4136      16.6078        13.584702      17.3502      
       600   282.19409     -44658.103     -6038.0694      3922.1649      16.6078        13.611602      17.3502      
       700   297.28295     -44647.013     -7109.5634      3929.9162      16.6078        13.638503      17.3502      
       800   308.39444     -44651.138      5464.3906      3937.6675      16.6078        13.665403      17.3502      
       900   305.40708     -44668.894      17667.242      3945.4188      16.6078        13.692304      17.3502      
      1000   291.53897     -44677.555      14287.504      3953.1701      16.6078        13.719204      17.3502      
      1100   271.50084     -44662.496      3101.1623      3960.9214      16.6078        13.746104      17.3502      
      1200   299.95689     -44669.076     -4889.8069      3968.6728      16.6078        13.773005      17.3502      
      1300   315.23974     -44639.34      -15888.327      3976.4241      16.6078        13.799905      17.3502      
      1400   295.26044     -44622.978     -499.48439      3984.1754      16.6078        13.826806      17.3502      
      1500   305.15719     -44658.074     -67.337149      3991.9267      16.6078        13.853706      17.3502      
      1600   284.15001     -44652.31       17697.001      3999.678       16.6078        13.880606      17.3502      
      1700   294.19157     -44663.938      4522.0887      4007.4293      16.6078        13.907507      17.3502      
      1800   300.17978     -44660.376     -11842.85       4015.1806      16.6078        13.934407      17.3502      
      1900   302.32389     -44673.67      -5515.8506      4022.932       16.6078        13.961308      17.3502      
      2000   304.77695     -44684.954     -63.493849      4030.6833      16.6078        13.988208      17.3502      
      2100   293.79155     -44691.448     -12338.003      4038.4346      16.6078        14.015108      17.3502      
      2200   285.73774     -44674.091     -2777.5649      4046.1859      16.6078        14.042009      17.3502      
      2300   286.80128     -44637.465     -12577.505      4053.9372      16.6078        14.068909      17.3502      
      2400   318.35932     -44656.741     -16550.625      4061.6885      16.6078        14.09581       17.3502      
      2500   310.4974      -44656.631     -10304.959      4069.4398      16.6078        14.12271       17.3502      
      2600   313.07567     -44678.146     -12133.617      4077.1912      16.6078        14.14961       17.3502      
      2700   286.30414     -44654.292     -8945.471       4084.9425      16.6078        14.176511      17.3502      
      2800   300.19127     -44658.359     -18657.582      4092.6938      16.6078        14.203411      17.3502      
      2900   292.92377     -44633.873     -19407.097      4100.4451      16.6078        14.230312      17.3502      
      3000   281.62074     -44615.296      587.16645      4108.1964      16.6078        14.257212      17.3502      
      3100   300.59068     -44640.185     -20332.688      4115.9477      16.6078        14.284112      17.3502      
      3200   296.83747     -44641.479     -15676.018      4123.699       16.6078        14.311013      17.3502      
      3300   302.10577     -44660.42      -12329.694      4131.4504      16.6078        14.337913      17.3502      
      3400   265.8711      -44642.11      -14667.762      4139.2017      16.6078        14.364814      17.3502      
      3500   276.37323     -44667.782     -15935.341      4146.953       16.6078        14.391714      17.3502      
      3600   275.47493     -44636.005     -18557.136      4154.7043      16.6078        14.418614      17.3502      
      3700   296.08503     -44628.528     -15234.845      4162.4556      16.6078        14.445515      17.3502      
      3800   306.82124     -44639.318     -15207.554      4170.2069      16.6078        14.472415      17.3502      
      3900   293.89545     -44624.098     -18285.431      4177.9582      16.6078        14.499316      17.3502      
      4000   301.49179     -44643.466     -14587.453      4185.7096      16.6078        14.526216      17.3502      
      4100   271.05543     -44636.314     -22269.988      4193.4609      16.6078        14.553116      17.3502      
      4200   295.89833     -44659.767     -21366.597      4201.2122      16.6078        14.580017      17.3502      
      4300   297.69051     -44635.143     -21625.7        4208.9635      16.6078        14.606917      17.3502      
      4400   306.05637     -44624.463     -16912.903      4216.7148      16.6078        14.633818      17.3502      
      4500   300.69065     -44623.517     -14072.683      4224.4661      16.6078        14.660718      17.3502      
      4600   290.4385      -44629.805     -21748.472      4232.2174      16.6078        14.687618      17.3502      
      4700   288.4346      -44656.577     -12095.264      4239.9688      16.6078        14.714519      17.3502      
      4800   278.82991     -44633.344     -25951.647      4247.7201      16.6078        14.741419      17.3502      
      4900   298.68362     -44621.224     -18401.289      4255.4714      16.6078        14.76832       17.3502      
      5000   301.67571     -44602.882     -15092.195      4263.2227      16.6078        14.79522       17.3502      
Loop time of 245.141 on 16 procs for 5000 steps with 386 atoms

Performance: 0.881 ns/day, 27.238 hours/ns, 20.396 timesteps/s, 7.873 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 143.89     | 179.05     | 206.47     | 199.0 | 73.04
Bond    | 0.0013326  | 0.0016739  | 0.0020839  |   0.6 |  0.00
Neigh   | 11.067     | 14.06      | 16.693     |  62.9 |  5.74
Comm    | 1.8374     | 29.222     | 64.403     | 492.3 | 11.92
Output  | 0.017809   | 0.020096   | 0.0222     |   0.9 |  0.01
Modify  | 19.975     | 22.669     | 25.711     |  50.1 |  9.25
Other   |            | 0.1211     |            |       |  0.05

Nlocal:          48.25 ave          54 max          40 min
Histogram: 2 0 0 0 0 0 2 2 1 1
Nghost:           3218 ave        3248 max        3195 min
Histogram: 4 0 0 0 0 0 2 0 0 2
Neighs:        30442.6 ave       33704 max       25445 min
Histogram: 2 0 0 0 0 0 2 1 2 1

Total # of neighbors = 243541
Ave neighs/atom = 630.93523
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.3502
variable dlen equal lz-${len0}
variable dlen equal lz-17.3502
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.3502
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.94505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.10717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -0.00034
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -1.73502 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144.7 | 146.2 | 147.7 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   294.31138     -44672.01      -10358.718      3875.657       16.6078        13.4502        17.3502      
       100   294.93257     -44659.456      3708.059       3867.9057      16.6078        13.4502        17.3155      
       200   305.86473     -44666.525     -2724.6863      3860.1544      16.6078        13.4502        17.280799    
       300   291.99512     -44663.493     -1705.5643      3852.4031      16.6078        13.4502        17.246099    
       400   283.14363     -44668.152     -692.12797      3844.6517      16.6078        13.4502        17.211398    
       500   304.84892     -44689.372      6570.6234      3836.9004      16.6078        13.4502        17.176698    
       600   288.67514     -44664.168      5283.4374      3829.1491      16.6078        13.4502        17.141998    
       700   291.03509     -44666.132     -4698.2085      3821.3978      16.6078        13.4502        17.107297    
       800   294.80171     -44675.537     -848.47925      3813.6465      16.6078        13.4502        17.072597    
       900   287.66835     -44675.501      6674.102       3805.8952      16.6078        13.4502        17.037896    
      1000   290.15012     -44685.633      6691.6988      3798.1439      16.6078        13.4502        17.003196    
      1100   290.27319     -44674.081      4039.2524      3790.3925      16.6078        13.4502        16.968496    
      1200   308.73212     -44661.523      4994.4343      3782.6412      16.6078        13.4502        16.933795    
      1300   315.03546     -44648.453      9002.1051      3774.8899      16.6078        13.4502        16.899095    
      1400   305.81189     -44649.103      15384.834      3767.1386      16.6078        13.4502        16.864394    
      1500   297.61967     -44646.741      9011.8568      3759.3873      16.6078        13.4502        16.829694    
      1600   294.0882      -44650.662      15044.446      3751.636       16.6078        13.4502        16.794994    
      1700   288.16229     -44648.693      19643.749      3743.8847      16.6078        13.4502        16.760293    
      1800   283.18706     -44651.532      14232.27       3736.1333      16.6078        13.4502        16.725593    
      1900   300.18736     -44681.548      7847.429       3728.382       16.6078        13.4502        16.690892    
      2000   289.78141     -44688.162      16473.124      3720.6307      16.6078        13.4502        16.656192    
      2100   277.58118     -44676.672      18031.472      3712.8794      16.6078        13.4502        16.621492    
      2200   306.65749     -44685.268      17057.354      3705.1281      16.6078        13.4502        16.586791    
      2300   316.64128     -44643.538      14055.397      3697.3768      16.6078        13.4502        16.552091    
      2400   321.94993     -44647.152      12185.87       3689.6255      16.6078        13.4502        16.51739     
      2500   310.98428     -44657.871      14697.146      3681.8741      16.6078        13.4502        16.48269     
      2600   306.22376     -44662.373      25237.675      3674.1228      16.6078        13.4502        16.44799     
      2700   292.32996     -44643.663      13604.072      3666.3715      16.6078        13.4502        16.413289    
      2800   321.94557     -44675.474      29144.464      3658.6202      16.6078        13.4502        16.378589    
      2900   296.19648     -44653.651      9270.1114      3650.8689      16.6078        13.4502        16.343888    
      3000   282.36915     -44656.622      15847.333      3643.1176      16.6078        13.4502        16.309188    
      3100   295.21443     -44651.048      28179.478      3635.3663      16.6078        13.4502        16.274488    
      3200   291.22187     -44614.324      39226.107      3627.6149      16.6078        13.4502        16.239787    
      3300   322.0177      -44609.63       23759.549      3619.8636      16.6078        13.4502        16.205087    
      3400   332.36632     -44598.774      41775.016      3612.1123      16.6078        13.4502        16.170386    
      3500   307.02882     -44605.564      37716.873      3604.361       16.6078        13.4502        16.135686    
      3600   295.9983      -44611.749      25855.74       3596.6097      16.6078        13.4502        16.100986    
      3700   290.87225     -44620.586      23041.414      3588.8584      16.6078        13.4502        16.066285    
      3800   296.29338     -44618.981      33238.518      3581.1071      16.6078        13.4502        16.031585    
      3900   297.07559     -44614.215      38639.197      3573.3557      16.6078        13.4502        15.996884    
      4000   307.26125     -44630.952      33521.722      3565.6044      16.6078        13.4502        15.962184    
      4100   302.49915     -44639.112      15759.917      3557.8531      16.6078        13.4502        15.927484    
      4200   294.19163     -44635.394      27148.308      3550.1018      16.6078        13.4502        15.892783    
      4300   275.80549     -44603.092      18848.706      3542.3505      16.6078        13.4502        15.858083    
      4400   310.80734     -44630.89       39347.935      3534.5992      16.6078        13.4502        15.823382    
      4500   310.15542     -44602.829      23689.179      3526.8479      16.6078        13.4502        15.788682    
      4600   324.36201     -44572.961      36801.821      3519.0965      16.6078        13.4502        15.753982    
      4700   319.31281     -44554.315      17739.996      3511.3452      16.6078        13.4502        15.719281    
      4800   327.80021     -44591.773      27442.479      3503.5939      16.6078        13.4502        15.684581    
      4900   302.39624     -44581.264      26761.957      3495.8426      16.6078        13.4502        15.64988     
      5000   293.21358     -44583.419      36464.262      3488.0913      16.6078        13.4502        15.61518     
Loop time of 305.283 on 16 procs for 5000 steps with 386 atoms

Performance: 0.708 ns/day, 33.920 hours/ns, 16.378 timesteps/s, 6.322 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 179.23     | 218.74     | 258.99     | 234.5 | 71.65
Bond    | 0.0013184  | 0.0016912  | 0.002106   |   0.7 |  0.00
Neigh   | 13.905     | 17.397     | 21.023     |  73.5 |  5.70
Comm    | 1.9118     | 42.129     | 81.623     | 534.0 | 13.80
Output  | 0.016648   | 0.01846    | 0.020315   |   0.9 |  0.01
Modify  | 23.16      | 26.864     | 30.428     |  59.8 |  8.80
Other   |            | 0.1312     |            |       |  0.04

Nlocal:          48.25 ave          57 max          44 min
Histogram: 2 2 1 1 0 0 1 0 0 1
Nghost:           4019 ave        4052 max        3987 min
Histogram: 2 0 1 0 0 2 1 0 1 1
Neighs:        37354.8 ave       43771 max       34149 min
Histogram: 1 3 1 1 0 0 1 0 0 1

Total # of neighbors = 298838
Ave neighs/atom = 774.19171
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.3502
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 1.73502 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144.7 | 146.2 | 147.7 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   294.31138     -44672.01      -10358.718      3875.657       16.6078        13.4502        17.3502      
       100   294.66099     -44659.632      3739.5192      3883.4083      16.6078        13.4502        17.3849      
       200   305.60715     -44666.886     -6191.2218      3891.1596      16.6078        13.4502        17.419601    
       300   300.11601     -44668.672      555.39589      3898.9109      16.6078        13.4502        17.454301    
       400   283.56785     -44671.204     -171.64275      3906.6622      16.6078        13.4502        17.489002    
       500   305.46915     -44696.665     -3969.5608      3914.4136      16.6078        13.4502        17.523702    
       600   301.89248     -44666.892     -10247.349      3922.1649      16.6078        13.4502        17.558402    
       700   310.38677     -44643.062      408.94642      3929.9162      16.6078        13.4502        17.593103    
       800   307.37407     -44644.504      6931.8967      3937.6675      16.6078        13.4502        17.627803    
       900   292.34535     -44660.677      7979.7294      3945.4188      16.6078        13.4502        17.662504    
      1000   307.07169     -44679.015      469.86031      3953.1701      16.6078        13.4502        17.697204    
      1100   304.83834     -44662.217     -6936.3457      3960.9214      16.6078        13.4502        17.731904    
      1200   311.39887     -44660.733     -4621.0309      3968.6728      16.6078        13.4502        17.766605    
      1300   298.92714     -44662.156     -2990.2771      3976.4241      16.6078        13.4502        17.801305    
      1400   290.11394     -44672.641      6680.1132      3984.1754      16.6078        13.4502        17.836006    
      1500   292.73841     -44665.041     -2553.0266      3991.9267      16.6078        13.4502        17.870706    
      1600   318.72618     -44672.364      464.15475      3999.678       16.6078        13.4502        17.905406    
      1700   312.10258     -44637.362      9807.1736      4007.4293      16.6078        13.4502        17.940107    
      1800   332.27679     -44649.086     -11991.604      4015.1806      16.6078        13.4502        17.974807    
      1900   285.44455     -44628.769     -10065.026      4022.932       16.6078        13.4502        18.009508    
      2000   305.65771     -44662.954     -19625.514      4030.6833      16.6078        13.4502        18.044208    
      2100   305.03592     -44658.077     -7734.0058      4038.4346      16.6078        13.4502        18.078908    
      2200   310.97992     -44661.046     -8596.0005      4046.1859      16.6078        13.4502        18.113609    
      2300   288.44863     -44647.065     -15335.809      4053.9372      16.6078        13.4502        18.148309    
      2400   300.06115     -44666.44      -9805.7156      4061.6885      16.6078        13.4502        18.18301     
      2500   299.48356     -44673.268     -15373.217      4069.4398      16.6078        13.4502        18.21771     
      2600   303.21384     -44644.042     -1683.9599      4077.1912      16.6078        13.4502        18.25241     
      2700   324.17604     -44626.442     -11062.217      4084.9425      16.6078        13.4502        18.287111    
      2800   322.28412     -44627.931     -5901.6918      4092.6938      16.6078        13.4502        18.321811    
      2900   303.36553     -44624.189     -5842.2575      4100.4451      16.6078        13.4502        18.356512    
      3000   303.8078      -44625.43      -8571.9451      4108.1964      16.6078        13.4502        18.391212    
      3100   296.46535     -44613.009     -21116.82       4115.9477      16.6078        13.4502        18.425912    
      3200   307.67852     -44628.037     -9510.3566      4123.699       16.6078        13.4502        18.460613    
      3300   298.7336      -44634.983     -9880.1203      4131.4504      16.6078        13.4502        18.495313    
      3400   276.04926     -44627.262     -13949.572      4139.2017      16.6078        13.4502        18.530014    
      3500   281.95108     -44617.577     -7282.045       4146.953       16.6078        13.4502        18.564714    
      3600   312.15703     -44618.624     -9086.6764      4154.7043      16.6078        13.4502        18.599414    
      3700   305.36377     -44599.057     -17160.185      4162.4556      16.6078        13.4502        18.634115    
      3800   304.5599      -44601.077     -19177.6        4170.2069      16.6078        13.4502        18.668815    
      3900   279.10598     -44577.374     -15879.568      4177.9582      16.6078        13.4502        18.703516    
      4000   290.66142     -44594.994     -22569.412      4185.7096      16.6078        13.4502        18.738216    
      4100   311.53026     -44623.755     -13060.213      4193.4609      16.6078        13.4502        18.772916    
      4200   294.23958     -44610.042     -19426.864      4201.2122      16.6078        13.4502        18.807617    
      4300   287.99493     -44583.786     -19210.129      4208.9635      16.6078        13.4502        18.842317    
      4400   315.88376     -44581.977     -21511.744      4216.7148      16.6078        13.4502        18.877018    
      4500   332.39255     -44584.608     -15744.868      4224.4661      16.6078        13.4502        18.911718    
      4600   305.07865     -44576.257     -15485.232      4232.2174      16.6078        13.4502        18.946418    
      4700   302.07939     -44574.674     -19068.776      4239.9688      16.6078        13.4502        18.981119    
      4800   307.57142     -44574.386     -17529.583      4247.7201      16.6078        13.4502        19.015819    
      4900   314.30389     -44569.577     -17646.597      4255.4714      16.6078        13.4502        19.05052     
      5000   309.79384     -44576.226     -11895.524      4263.2227      16.6078        13.4502        19.08522     
Loop time of 265.272 on 16 procs for 5000 steps with 386 atoms

Performance: 0.814 ns/day, 29.475 hours/ns, 18.849 timesteps/s, 7.276 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 152.32     | 193.47     | 223.62     | 225.4 | 72.93
Bond    | 0.0013182  | 0.0017617  | 0.0021582  |   0.7 |  0.00
Neigh   | 11.645     | 15.163     | 17.726     |  68.3 |  5.72
Comm    | 2.2271     | 32.363     | 73.488     | 551.1 | 12.20
Output  | 0.016196   | 0.018026   | 0.01974    |   0.9 |  0.01
Modify  | 21.546     | 24.133     | 27.666     |  54.5 |  9.10
Other   |            | 0.1242     |            |       |  0.05

Nlocal:          48.25 ave          57 max          42 min
Histogram: 2 0 0 2 2 0 0 0 1 1
Nghost:        3518.38 ave        3552 max        3482 min
Histogram: 1 1 0 2 0 0 1 0 2 1
Neighs:        30473.4 ave       35736 max       26624 min
Histogram: 2 0 0 2 2 0 0 1 0 1

Total # of neighbors = 243787
Ave neighs/atom = 631.57254
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 16.6078
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.0034)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*16.6078
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.94505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.10717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -0.00034
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -1.66078 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144.7 | 146.2 | 147.7 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   294.31138     -44672.01      -10358.718      3875.657       16.6078        13.4502        17.3502      
       100   294.59921     -44659.328      3704.3061      3875.657       16.6078        13.4502        17.3502      
       200   302.00158     -44663.089     -7151.141       3875.657       16.6078        13.4502        17.3502      
       300   301.66966     -44675.495     -3902.4415      3875.657       16.6078        13.4502        17.3502      
       400   280.89344     -44677.896      6130.5877      3875.657       16.6078        13.4502        17.3502      
       500   296.1417      -44692.918     -4149.7764      3875.657       16.6078        13.4502        17.3502      
       600   292.6097      -44682.667     -4156.5416      3875.657       16.6078        13.4502        17.3502      
       700   298.29559     -44664.89       9237.0761      3875.657       16.6078        13.4502        17.3502      
       800   313.04406     -44647.982     -3029.1273      3875.657       16.6078        13.4502        17.3502      
       900   321.71466     -44663.847      6160.8234      3875.657       16.6078        13.4502        17.3502      
      1000   313.74132     -44686.277      6647.4768      3875.657       16.6078        13.4502        17.3502      
      1100   290.83301     -44672.525     -747.16297      3875.657       16.6078        13.4502        17.3502      
      1200   317.25106     -44695.577     -999.26435      3875.657       16.6078        13.4502        17.3502      
      1300   288.2352      -44677.005     -5731.7118      3875.657       16.6078        13.4502        17.3502      
      1400   295.06457     -44690.959      422.43014      3875.657       16.6078        13.4502        17.3502      
      1500   296.18477     -44680.898     -5706.0315      3875.657       16.6078        13.4502        17.3502      
      1600   294.48146     -44645.298      12332.89       3875.657       16.6078        13.4502        17.3502      
      1700   313.95807     -44650.068      7247.9434      3875.657       16.6078        13.4502        17.3502      
      1800   300.42493     -44645.182     -1578.5466      3875.657       16.6078        13.4502        17.3502      
      1900   301.11527     -44652.035      9594.7896      3875.657       16.6078        13.4502        17.3502      
      2000   309.26393     -44660.002     -2106.5927      3875.657       16.6078        13.4502        17.3502      
      2100   297.39992     -44654.425     -1028.8439      3875.657       16.6078        13.4502        17.3502      
      2200   306.47739     -44673.426     -8151.4194      3875.657       16.6078        13.4502        17.3502      
      2300   288.99991     -44664.814     -3665.5878      3875.657       16.6078        13.4502        17.3502      
      2400   269.85027     -44673.417      5680.7978      3875.657       16.6078        13.4502        17.3502      
      2500   294.35634     -44682.939     -1764.9429      3875.657       16.6078        13.4502        17.3502      
      2600   298.69709     -44662.356      4966.3426      3875.657       16.6078        13.4502        17.3502      
      2700   310.96314     -44658.566      8908.517       3875.657       16.6078        13.4502        17.3502      
      2800   301.70438     -44646.694      12375.46       3875.657       16.6078        13.4502        17.3502      
      2900   301.37198     -44664.541      11098.278      3875.657       16.6078        13.4502        17.3502      
      3000   277.54587     -44663.565     -799.69726      3875.657       16.6078        13.4502        17.3502      
      3100   294.46027     -44670.072     -6352.8774      3875.657       16.6078        13.4502        17.3502      
      3200   307.01077     -44664.528      2228.4962      3875.657       16.6078        13.4502        17.3502      
      3300   300.44538     -44649.405     -11220.898      3875.657       16.6078        13.4502        17.3502      
      3400   279.1943      -44620.682     -9970.0314      3875.657       16.6078        13.4502        17.3502      
      3500   305.77353     -44632.545     -7048.4893      3875.657       16.6078        13.4502        17.3502      
      3600   345.54752     -44649.624      3836.2995      3875.657       16.6078        13.4502        17.3502      
      3700   312.33168     -44637.281     -1709.8975      3875.657       16.6078        13.4502        17.3502      
      3800   292.8574      -44631.546     -34.275531      3875.657       16.6078        13.4502        17.3502      
      3900   305.61824     -44640.255     -12608.271      3875.657       16.6078        13.4502        17.3502      
      4000   295.24724     -44629.162      2227.4725      3875.657       16.6078        13.4502        17.3502      
      4100   309.02192     -44642.119     -209.67656      3875.657       16.6078        13.4502        17.3502      
      4200   306.32381     -44637.392     -1123.4548      3875.657       16.6078        13.4502        17.3502      
      4300   288.94069     -44629.207     -8447.2516      3875.657       16.6078        13.4502        17.3502      
      4400   272.53467     -44618.133      4042.3148      3875.657       16.6078        13.4502        17.3502      
      4500   301.78447     -44637.283     -4149.3969      3875.657       16.6078        13.4502        17.3502      
      4600   302.7103      -44596.855     -9290.2625      3875.657       16.6078        13.4502        17.3502      
      4700   291.22355     -44573.222     -10371.056      3875.657       16.6078        13.4502        17.3502      
      4800   314.46426     -44611.836      8177.6352      3875.657       16.6078        13.4502        17.3502      
      4900   302.43966     -44607.435      8678.5173      3875.657       16.6078        13.4502        17.3502      
      5000   305.81779     -44613.968     -6628.9926      3875.657       16.6078        13.4502        17.3502      
Loop time of 288.088 on 16 procs for 5000 steps with 386 atoms

Performance: 0.750 ns/day, 32.010 hours/ns, 17.356 timesteps/s, 6.699 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 160.62     | 208.89     | 242.82     | 249.4 | 72.51
Bond    | 0.0013121  | 0.0017746  | 0.0022072  |   0.7 |  0.00
Neigh   | 13.667     | 17.941     | 20.868     |  76.4 |  6.23
Comm    | 1.6905     | 35.625     | 83.873     | 603.8 | 12.37
Output  | 0.016465   | 0.018308   | 0.020081   |   0.9 |  0.01
Modify  | 22.52      | 25.483     | 29.794     |  64.5 |  8.85
Other   |            | 0.1283     |            |       |  0.04

Nlocal:          48.25 ave          57 max          40 min
Histogram: 1 0 1 0 3 0 1 1 0 1
Nghost:        3748.12 ave        3808 max        3682 min
Histogram: 1 1 0 0 2 1 1 0 1 1
Neighs:        33573.2 ave       39215 max       28059 min
Histogram: 1 0 1 0 3 0 1 1 0 1

Total # of neighbors = 268586
Ave neighs/atom = 695.81865
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*16.6078
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 1.66078 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144.8 | 146.2 | 147.7 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   294.31138     -44672.01      -10358.718      3875.657       16.6078        13.4502        17.3502      
       100   294.913       -44659.67       3791.8987      3875.657       16.6078        13.4502        17.3502      
       200   306.2125      -44669.548     -1761.4639      3875.657       16.6078        13.4502        17.3502      
       300   292.99268     -44663.304     -1797.8783      3875.657       16.6078        13.4502        17.3502      
       400   274.50395     -44669.29       7629.4596      3875.657       16.6078        13.4502        17.3502      
       500   303.2076      -44696.911      2720.8535      3875.657       16.6078        13.4502        17.3502      
       600   289.34819     -44673.596      63.157674      3875.657       16.6078        13.4502        17.3502      
       700   306.47401     -44686.387      7746.9269      3875.657       16.6078        13.4502        17.3502      
       800   290.28068     -44658.114     -10490.213      3875.657       16.6078        13.4502        17.3502      
       900   299.58228     -44659.016      11919.67       3875.657       16.6078        13.4502        17.3502      
      1000   308.76606     -44663.003      2105.1824      3875.657       16.6078        13.4502        17.3502      
      1100   287.80222     -44655.806      5507.4169      3875.657       16.6078        13.4502        17.3502      
      1200   294.9586      -44688.838      9813.4104      3875.657       16.6078        13.4502        17.3502      
      1300   298.06957     -44694.799      7606.7888      3875.657       16.6078        13.4502        17.3502      
      1400   292.31395     -44676.753     -3585.8346      3875.657       16.6078        13.4502        17.3502      
      1500   313.247       -44662.805      145.42693      3875.657       16.6078        13.4502        17.3502      
      1600   319.40105     -44668.985      13391.832      3875.657       16.6078        13.4502        17.3502      
      1700   309.47507     -44676.546      7510.4858      3875.657       16.6078        13.4502        17.3502      
      1800   291.22135     -44667.822      8895.7955      3875.657       16.6078        13.4502        17.3502      
      1900   296.71545     -44672.653      12689.139      3875.657       16.6078        13.4502        17.3502      
      2000   312.45425     -44683.699      18888.12       3875.657       16.6078        13.4502        17.3502      
      2100   318.84394     -44679.006      12555.783      3875.657       16.6078        13.4502        17.3502      
      2200   323.87371     -44684.212      19924.22       3875.657       16.6078        13.4502        17.3502      
      2300   299.69037     -44687.537     -318.70396      3875.657       16.6078        13.4502        17.3502      
      2400   278.22443     -44677.654      16503.507      3875.657       16.6078        13.4502        17.3502      
      2500   295.63728     -44694.167      7235.1986      3875.657       16.6078        13.4502        17.3502      
      2600   316.50188     -44704.837      13407.3        3875.657       16.6078        13.4502        17.3502      
      2700   298.70147     -44677.489     -9398.4195      3875.657       16.6078        13.4502        17.3502      
      2800   306.8705      -44714.197      5781.3598      3875.657       16.6078        13.4502        17.3502      
      2900   283.36718     -44706.504      4352.1016      3875.657       16.6078        13.4502        17.3502      
      3000   304.37104     -44729.382      1653.8831      3875.657       16.6078        13.4502        17.3502      
      3100   284.56403     -44694.103      1134.3318      3875.657       16.6078        13.4502        17.3502      
      3200   323.72542     -44700.884      3786.7664      3875.657       16.6078        13.4502        17.3502      
      3300   313.1201      -44682.821      11031.301      3875.657       16.6078        13.4502        17.3502      
      3400   308.48629     -44706.137     -8071.0954      3875.657       16.6078        13.4502        17.3502      
      3500   293.18565     -44704.518      2250.7688      3875.657       16.6078        13.4502        17.3502      
      3600   299.3656      -44704.207      1124.0736      3875.657       16.6078        13.4502        17.3502      
      3700   309.3445      -44698.927      6335.5443      3875.657       16.6078        13.4502        17.3502      
      3800   297.97624     -44680.798      971.85111      3875.657       16.6078        13.4502        17.3502      
      3900   280.39579     -44688.306      6360.7204      3875.657       16.6078        13.4502        17.3502      
      4000   289.41792     -44708.868      6816.6314      3875.657       16.6078        13.4502        17.3502      
      4100   293.84152     -44696.653      7765.4892      3875.657       16.6078        13.4502        17.3502      
      4200   317.11352     -44679.03       10762.467      3875.657       16.6078        13.4502        17.3502      
      4300   309.31628     -44661.908      16546.783      3875.657       16.6078        13.4502        17.3502      
      4400   311.71865     -44680.518      3408.7974      3875.657       16.6078        13.4502        17.3502      
      4500   304.2061      -44694.394      6803.7342      3875.657       16.6078        13.4502        17.3502      
      4600   286.05241     -44675.196      8595.4511      3875.657       16.6078        13.4502        17.3502      
      4700   302.19393     -44694.785      9998.9427      3875.657       16.6078        13.4502        17.3502      
      4800   316.0795      -44689.121      1003.1737      3875.657       16.6078        13.4502        17.3502      
      4900   324.94636     -44676.366      9599.1839      3875.657       16.6078        13.4502        17.3502      
      5000   339.69418     -44689.042      10299.878      3875.657       16.6078        13.4502        17.3502      
Loop time of 267.292 on 16 procs for 5000 steps with 386 atoms

Performance: 0.808 ns/day, 29.699 hours/ns, 18.706 timesteps/s, 7.221 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 152.21     | 189.45     | 224.19     | 222.5 | 70.88
Bond    | 0.0012946  | 0.0017219  | 0.0021122  |   0.6 |  0.00
Neigh   | 12.224     | 15.337     | 18.06      |  65.1 |  5.74
Comm    | 3.0749     | 37.862     | 75.071     | 497.7 | 14.16
Output  | 0.016388   | 0.0185     | 0.02011    |   0.8 |  0.01
Modify  | 21.717     | 24.494     | 27.633     |  51.7 |  9.16
Other   |            | 0.1263     |            |       |  0.05

Nlocal:          48.25 ave          56 max          43 min
Histogram: 2 0 0 2 2 1 0 0 0 1
Nghost:        3532.38 ave        3572 max        3495 min
Histogram: 2 0 0 1 1 2 0 0 0 2
Neighs:        33591.4 ave       38664 max       30246 min
Histogram: 2 0 1 1 2 1 0 0 0 1

Total # of neighbors = 268731
Ave neighs/atom = 696.1943
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.4502
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz--1.0717)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.4502
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.94505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.10717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -0.00034
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -1.34502 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144.7 | 146.2 | 147.7 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   294.31138     -44672.01      -10358.718      3875.657       16.6078        13.4502        17.3502      
       100   294.84351     -44659.603      3718.8162      3875.657       16.6078        13.4502        17.3502      
       200   302.26436     -44664.044     -4572.8067      3875.657       16.6078        13.4502        17.3502      
       300   294.22387     -44665.123      2735.1465      3875.657       16.6078        13.4502        17.3502      
       400   283.39484     -44672.312      9612.1409      3875.657       16.6078        13.4502        17.3502      
       500   295.01139     -44696.027     -2100.9399      3875.657       16.6078        13.4502        17.3502      
       600   297.11892     -44687.382     -1268.3789      3875.657       16.6078        13.4502        17.3502      
       700   307.19223     -44667.955     -3286.8533      3875.657       16.6078        13.4502        17.3502      
       800   305.25443     -44651.358     -12407.534      3875.657       16.6078        13.4502        17.3502      
       900   311.96741     -44671.382      8829.5804      3875.657       16.6078        13.4502        17.3502      
      1000   290.91455     -44681.034     -3931.5801      3875.657       16.6078        13.4502        17.3502      
      1100   299.61663     -44688.048      8656.6699      3875.657       16.6078        13.4502        17.3502      
      1200   303.7989      -44675.715     -1277.2697      3875.657       16.6078        13.4502        17.3502      
      1300   312.57538     -44683.757     -1693.0951      3875.657       16.6078        13.4502        17.3502      
      1400   275.84441     -44669.913      636.35293      3875.657       16.6078        13.4502        17.3502      
      1500   286.69375     -44699.338     -55.59983       3875.657       16.6078        13.4502        17.3502      
      1600   291.75908     -44689.778      8564.7698      3875.657       16.6078        13.4502        17.3502      
      1700   294.10033     -44664.683     -5621.417       3875.657       16.6078        13.4502        17.3502      
      1800   323.65843     -44695.391      5988.519       3875.657       16.6078        13.4502        17.3502      
      1900   307.60573     -44687.922      11730.288      3875.657       16.6078        13.4502        17.3502      
      2000   315.97846     -44708.003     -4784.199       3875.657       16.6078        13.4502        17.3502      
      2100   282.01466     -44690.18      -788.01659      3875.657       16.6078        13.4502        17.3502      
      2200   270.51648     -44694.575     -758.73643      3875.657       16.6078        13.4502        17.3502      
      2300   283.97051     -44689.302      4678.2173      3875.657       16.6078        13.4502        17.3502      
      2400   299.9449      -44671.805      5448.2325      3875.657       16.6078        13.4502        17.3502      
      2500   300.81653     -44666.404      6028.176       3875.657       16.6078        13.4502        17.3502      
      2600   301.99886     -44677.816      571.32033      3875.657       16.6078        13.4502        17.3502      
      2700   279.47964     -44677.823     -1401.0446      3875.657       16.6078        13.4502        17.3502      
      2800   297.28014     -44693.281      11964.817      3875.657       16.6078        13.4502        17.3502      
      2900   301.10482     -44692.761      1950.2047      3875.657       16.6078        13.4502        17.3502      
      3000   300.28403     -44686.105      8581.0663      3875.657       16.6078        13.4502        17.3502      
      3100   318.9637      -44682.891      8703.0865      3875.657       16.6078        13.4502        17.3502      
      3200   325.13158     -44674.581      7631.924       3875.657       16.6078        13.4502        17.3502      
      3300   311.14391     -44682.67       146.05556      3875.657       16.6078        13.4502        17.3502      
      3400   285.19548     -44664.273     -6866.0587      3875.657       16.6078        13.4502        17.3502      
      3500   297.33124     -44677.56       2700.1025      3875.657       16.6078        13.4502        17.3502      
      3600   297.13915     -44677.53       1443.7146      3875.657       16.6078        13.4502        17.3502      
      3700   298.42204     -44672.416      1266.9214      3875.657       16.6078        13.4502        17.3502      
      3800   295.0261      -44655.929      5113.1306      3875.657       16.6078        13.4502        17.3502      
      3900   293.41488     -44645.315      4734.5698      3875.657       16.6078        13.4502        17.3502      
      4000   294.06961     -44659.948      12561.041      3875.657       16.6078        13.4502        17.3502      
      4100   286.97838     -44673.155      9122.4859      3875.657       16.6078        13.4502        17.3502      
      4200   294.66793     -44684.434      8714.5524      3875.657       16.6078        13.4502        17.3502      
      4300   300.20192     -44655.855      8179.9574      3875.657       16.6078        13.4502        17.3502      
      4400   319.0479      -44649.448      5430.0467      3875.657       16.6078        13.4502        17.3502      
      4500   311.06251     -44657.576     -7727.656       3875.657       16.6078        13.4502        17.3502      
      4600   303.2521      -44673.819      4374.0979      3875.657       16.6078        13.4502        17.3502      
      4700   304.16332     -44683.883     -7492.7715      3875.657       16.6078        13.4502        17.3502      
      4800   320.2206      -44691.48       7560.3419      3875.657       16.6078        13.4502        17.3502      
      4900   331.60997     -44680.467     -7879.7352      3875.657       16.6078        13.4502        17.3502      
      5000   324.74208     -44644.018      4409.1954      3875.657       16.6078        13.4502        17.3502      
Loop time of 263.693 on 16 procs for 5000 steps with 386 atoms

Performance: 0.819 ns/day, 29.299 hours/ns, 18.961 timesteps/s, 7.319 katom-step/s
99.6% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 154.25     | 172.25     | 222.35     | 211.3 | 65.32
Bond    | 0.0010144  | 0.0014207  | 0.0020065  |   0.7 |  0.00
Neigh   | 13.247     | 14.953     | 19.16      |  62.0 |  5.67
Comm    | 1.5774     | 51.68      | 69.69      | 385.7 | 19.60
Output  | 0.013602   | 0.015453   | 0.017006   |   0.9 |  0.01
Modify  | 20.476     | 24.683     | 26.367     |  48.3 |  9.36
Other   |            | 0.1054     |            |       |  0.04

Nlocal:          48.25 ave          52 max          45 min
Histogram: 1 0 3 0 0 2 0 1 0 1
Nghost:         3764.5 ave        3801 max        3723 min
Histogram: 1 1 2 0 0 0 0 1 1 2
Neighs:        33622.5 ave       36137 max       31445 min
Histogram: 1 0 2 1 0 1 2 0 0 1

Total # of neighbors = 268980
Ave neighs/atom = 696.83938
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.4502
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 1.34502 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144.8 | 146.2 | 147.7 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   294.31138     -44672.01      -10358.718      3875.657       16.6078        13.4502        17.3502      
       100   294.81392     -44659.5        3721.8104      3875.657       16.6078        13.4502        17.3502      
       200   305.76291     -44669.917     -2621.0184      3875.657       16.6078        13.4502        17.3502      
       300   290.22643     -44662.033      2108.9542      3875.657       16.6078        13.4502        17.3502      
       400   277.64672     -44672.126      3663.5803      3875.657       16.6078        13.4502        17.3502      
       500   306.46598     -44707.438      3527.4678      3875.657       16.6078        13.4502        17.3502      
       600   293.96217     -44672.735     -1146.9001      3875.657       16.6078        13.4502        17.3502      
       700   302.97326     -44646.363      1656.6361      3875.657       16.6078        13.4502        17.3502      
       800   309.49171     -44655.521      13418.722      3875.657       16.6078        13.4502        17.3502      
       900   280.96691     -44648.404      4741.8506      3875.657       16.6078        13.4502        17.3502      
      1000   300.73493     -44676.041     -3075.972       3875.657       16.6078        13.4502        17.3502      
      1100   316.76101     -44691.139      7204.1491      3875.657       16.6078        13.4502        17.3502      
      1200   290.59784     -44661.126     -11323.447      3875.657       16.6078        13.4502        17.3502      
      1300   301.42486     -44673.165     -7131.2941      3875.657       16.6078        13.4502        17.3502      
      1400   300.62958     -44680.603     -3081.1439      3875.657       16.6078        13.4502        17.3502      
      1500   299.04685     -44677.157     -2074.0562      3875.657       16.6078        13.4502        17.3502      
      1600   309.35384     -44671.791      5038.127       3875.657       16.6078        13.4502        17.3502      
      1700   311.2343      -44652.18      -12653.151      3875.657       16.6078        13.4502        17.3502      
      1800   298.83103     -44650.223     -13663.429      3875.657       16.6078        13.4502        17.3502      
      1900   299.68671     -44685.67      -4757.5926      3875.657       16.6078        13.4502        17.3502      
      2000   301.70242     -44695.584      1060.517       3875.657       16.6078        13.4502        17.3502      
      2100   293.51399     -44675.12      -11171.96       3875.657       16.6078        13.4502        17.3502      
      2200   297.2832      -44655.312      4416.8234      3875.657       16.6078        13.4502        17.3502      
      2300   301.02612     -44648.564     -1010.7924      3875.657       16.6078        13.4502        17.3502      
      2400   302.86434     -44657.424      12094.506      3875.657       16.6078        13.4502        17.3502      
      2500   286.97816     -44646.203     -3064.5285      3875.657       16.6078        13.4502        17.3502      
      2600   300.9525      -44665.696     -1928.7084      3875.657       16.6078        13.4502        17.3502      
      2700   289.22984     -44660.913      2768.4147      3875.657       16.6078        13.4502        17.3502      
      2800   278.6767      -44671.618     -3704.136       3875.657       16.6078        13.4502        17.3502      
      2900   278.01232     -44688.26       3447.7258      3875.657       16.6078        13.4502        17.3502      
      3000   291.55514     -44681.436     -767.32177      3875.657       16.6078        13.4502        17.3502      
      3100   284.59625     -44641.387      265.96127      3875.657       16.6078        13.4502        17.3502      
      3200   308.20075     -44655.373     -3381.542       3875.657       16.6078        13.4502        17.3502      
      3300   316.41008     -44667.421      12780.72       3875.657       16.6078        13.4502        17.3502      
      3400   287.19923     -44653.331      14228.544      3875.657       16.6078        13.4502        17.3502      
      3500   295.99641     -44669.463      2578.4327      3875.657       16.6078        13.4502        17.3502      
      3600   289.29149     -44659.228      3748.3459      3875.657       16.6078        13.4502        17.3502      
      3700   285.32995     -44642.394     -10705.493      3875.657       16.6078        13.4502        17.3502      
      3800   311.10935     -44639.554      9341.3164      3875.657       16.6078        13.4502        17.3502      
      3900   328.17655     -44649.46       5640.8162      3875.657       16.6078        13.4502        17.3502      
      4000   302.90065     -44642.656      223.73676      3875.657       16.6078        13.4502        17.3502      
      4100   293.46493     -44651.923     -4467.6192      3875.657       16.6078        13.4502        17.3502      
      4200   296.62476     -44648.827     -574.3472       3875.657       16.6078        13.4502        17.3502      
      4300   286.94698     -44621.506      11975.834      3875.657       16.6078        13.4502        17.3502      
      4400   294.64732     -44616.31       2012.8953      3875.657       16.6078        13.4502        17.3502      
      4500   313.50784     -44626.188     -2459.0137      3875.657       16.6078        13.4502        17.3502      
      4600   325.76615     -44642.367      1682.1023      3875.657       16.6078        13.4502        17.3502      
      4700   295.73391     -44634.951     -3026.2524      3875.657       16.6078        13.4502        17.3502      
      4800   297.78144     -44650.901     -4394.2959      3875.657       16.6078        13.4502        17.3502      
      4900   289.75842     -44635.582      5608.3347      3875.657       16.6078        13.4502        17.3502      
      5000   299.51029     -44605.262      7375.5713      3875.657       16.6078        13.4502        17.3502      
Loop time of 197.582 on 16 procs for 5000 steps with 386 atoms

Performance: 1.093 ns/day, 21.954 hours/ns, 25.306 timesteps/s, 9.768 katom-step/s
99.6% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 145.38     | 150.29     | 164.05     |  58.1 | 76.07
Bond    | 0.0010959  | 0.0013562  | 0.0016116  |   0.4 |  0.00
Neigh   | 12.156     | 12.686     | 13.713     |  16.1 |  6.42
Comm    | 2.3751     | 16.144     | 21.052     | 177.4 |  8.17
Output  | 0.013165   | 0.01487    | 0.016084   |   0.7 |  0.01
Modify  | 17.296     | 18.326     | 18.859     |  13.4 |  9.28
Other   |            | 0.1155     |            |       |  0.06

Nlocal:          48.25 ave          55 max          37 min
Histogram: 1 0 0 0 2 0 1 2 0 2
Nghost:        3513.62 ave        3552 max        3481 min
Histogram: 1 2 0 1 1 0 0 1 1 1
Neighs:        33577.6 ave       37984 max       26262 min
Histogram: 1 0 0 0 2 1 0 2 0 2

Total # of neighbors = 268621
Ave neighs/atom = 695.90933
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.3502
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--9.4505)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.3502
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.94505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.10717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -0.00034
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -1.73502 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144.7 | 146.2 | 147.7 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   294.31138     -44672.01      -10358.718      3875.657       16.6078        13.4502        17.3502      
       100   294.72662     -44659.499      3707.2708      3875.657       16.6078        13.4502        17.3502      
       200   307.28365     -44668.946     -4846.39        3875.657       16.6078        13.4502        17.3502      
       300   299.07958     -44669.616      1854.5584      3875.657       16.6078        13.4502        17.3502      
       400   278.18576     -44669.688      4023.246       3875.657       16.6078        13.4502        17.3502      
       500   300.93992     -44689.778      10930.277      3875.657       16.6078        13.4502        17.3502      
       600   292.10784     -44670.955     -11310.686      3875.657       16.6078        13.4502        17.3502      
       700   313.19824     -44682.655      1520.1518      3875.657       16.6078        13.4502        17.3502      
       800   305.90052     -44668.173     -5459.0636      3875.657       16.6078        13.4502        17.3502      
       900   297.42319     -44666.94       3299.1306      3875.657       16.6078        13.4502        17.3502      
      1000   295.41881     -44684.518      25740.675      3875.657       16.6078        13.4502        17.3502      
      1100   274.23961     -44685.178      22293.428      3875.657       16.6078        13.4502        17.3502      
      1200   278.11383     -44667.817      8290.8821      3875.657       16.6078        13.4502        17.3502      
      1300   291.27586     -44647.622     -263.50556      3875.657       16.6078        13.4502        17.3502      
      1400   316.3097      -44658.707     -7695.716       3875.657       16.6078        13.4502        17.3502      
      1500   301.65007     -44648.801      1736.2634      3875.657       16.6078        13.4502        17.3502      
      1600   289.12151     -44644.693      3229.4001      3875.657       16.6078        13.4502        17.3502      
      1700   308.81318     -44675.662     -4101.8084      3875.657       16.6078        13.4502        17.3502      
      1800   305.38508     -44669.054     -3306.8906      3875.657       16.6078        13.4502        17.3502      
      1900   308.67651     -44668         -643.91725      3875.657       16.6078        13.4502        17.3502      
      2000   281.05267     -44654.05      -5086.265       3875.657       16.6078        13.4502        17.3502      
      2100   269.73474     -44650.651      4282.8926      3875.657       16.6078        13.4502        17.3502      
      2200   292.07182     -44662.947      3410.1409      3875.657       16.6078        13.4502        17.3502      
      2300   323.28908     -44654.778     -14725.388      3875.657       16.6078        13.4502        17.3502      
      2400   321.88822     -44652.828     -3357.6049      3875.657       16.6078        13.4502        17.3502      
      2500   298.35704     -44644.132      17367.777      3875.657       16.6078        13.4502        17.3502      
      2600   301.52073     -44654.112      372.02915      3875.657       16.6078        13.4502        17.3502      
      2700   286.98587     -44642.593      11150.018      3875.657       16.6078        13.4502        17.3502      
      2800   285.52826     -44649.856      12685.129      3875.657       16.6078        13.4502        17.3502      
      2900   312.55901     -44671.19       9717.9151      3875.657       16.6078        13.4502        17.3502      
      3000   317.05843     -44635.064      1176.0381      3875.657       16.6078        13.4502        17.3502      
      3100   324.49112     -44633.582      5830.8875      3875.657       16.6078        13.4502        17.3502      
      3200   303.25312     -44631.846      426.54806      3875.657       16.6078        13.4502        17.3502      
      3300   304.71837     -44649.812      966.34511      3875.657       16.6078        13.4502        17.3502      
      3400   286.65963     -44632.049     -2235.7934      3875.657       16.6078        13.4502        17.3502      
      3500   304.39491     -44637.28      -6908.8742      3875.657       16.6078        13.4502        17.3502      
      3600   309.53718     -44631.04       1436.4103      3875.657       16.6078        13.4502        17.3502      
      3700   301.98436     -44605.79      -1388.1296      3875.657       16.6078        13.4502        17.3502      
      3800   305.39843     -44629.138     -2820.0587      3875.657       16.6078        13.4502        17.3502      
      3900   294.47037     -44635.378     -1921.817       3875.657       16.6078        13.4502        17.3502      
      4000   305.21452     -44652.384     -1714.9906      3875.657       16.6078        13.4502        17.3502      
      4100   305.42893     -44639.755     -2010.3931      3875.657       16.6078        13.4502        17.3502      
      4200   304.07757     -44627.778      2458.5852      3875.657       16.6078        13.4502        17.3502      
      4300   317.22216     -44633.93       10785.186      3875.657       16.6078        13.4502        17.3502      
      4400   292.8025      -44603.605      13294.818      3875.657       16.6078        13.4502        17.3502      
      4500   301.30288     -44624.604     -4473.9118      3875.657       16.6078        13.4502        17.3502      
      4600   285.97921     -44621.643     -7975.4973      3875.657       16.6078        13.4502        17.3502      
      4700   293.98908     -44637.843     -10280.169      3875.657       16.6078        13.4502        17.3502      
      4800   284.25582     -44635.459      1824.3594      3875.657       16.6078        13.4502        17.3502      
      4900   293.32371     -44649.564      10605.609      3875.657       16.6078        13.4502        17.3502      
      5000   284.07286     -44618.126     -4927.5264      3875.657       16.6078        13.4502        17.3502      
Loop time of 181.423 on 16 procs for 5000 steps with 386 atoms

Performance: 1.191 ns/day, 20.158 hours/ns, 27.560 timesteps/s, 10.638 katom-step/s
99.6% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 144.5      | 146.58     | 149.36     |  12.8 | 80.79
Bond    | 0.00088273 | 0.0012179  | 0.0017583  |   0.8 |  0.00
Neigh   | 13.604     | 13.74      | 14.063     |   3.7 |  7.57
Comm    | 1.4755     | 4.2443     | 6.3398     |  75.2 |  2.34
Output  | 0.011327   | 0.012817   | 0.014134   |   0.8 |  0.01
Modify  | 16.391     | 16.727     | 16.869     |   3.5 |  9.22
Other   |            | 0.1207     |            |       |  0.07

Nlocal:          48.25 ave          54 max          41 min
Histogram: 1 0 1 2 0 0 1 0 1 2
Nghost:         3940.5 ave        3977 max        3918 min
Histogram: 3 0 0 2 1 0 0 0 1 1
Neighs:        33580.8 ave       37403 max       28702 min
Histogram: 1 0 1 2 0 0 1 0 1 2

Total # of neighbors = 268646
Ave neighs/atom = 695.97409
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.3502
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 1.73502 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * CHONSi.ff C H O Si


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144.8 | 146.2 | 147.7 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   294.31138     -44672.01      -10358.718      3875.657       16.6078        13.4502        17.3502      
       100   294.9862      -44659.583      3628.2376      3875.657       16.6078        13.4502        17.3502      
       200   301.11516     -44664.21      -1762.1559      3875.657       16.6078        13.4502        17.3502      
       300   289.75494     -44656.549     -3200.6221      3875.657       16.6078        13.4502        17.3502      
       400   279.46395     -44665.522      4294.2447      3875.657       16.6078        13.4502        17.3502      
       500   298.47066     -44699.261     -117.69733      3875.657       16.6078        13.4502        17.3502      
       600   291.49694     -44701.44      -9895.9776      3875.657       16.6078        13.4502        17.3502      
       700   278.21735     -44663.339     -1361.4783      3875.657       16.6078        13.4502        17.3502      
       800   312.94192     -44664.891     -127.81235      3875.657       16.6078        13.4502        17.3502      
       900   300.43354     -44647.354     -3294.945       3875.657       16.6078        13.4502        17.3502      
      1000   304.33963     -44667.353      19252.829      3875.657       16.6078        13.4502        17.3502      
      1100   276.4935      -44660.583      3521.5896      3875.657       16.6078        13.4502        17.3502      
      1200   316.82015     -44703.254     -851.10215      3875.657       16.6078        13.4502        17.3502      
      1300   308.61847     -44689.513     -1864.9626      3875.657       16.6078        13.4502        17.3502      
      1400   311.2374      -44681.934     -2856.4282      3875.657       16.6078        13.4502        17.3502      
      1500   305.00186     -44667.355      13698.654      3875.657       16.6078        13.4502        17.3502      
      1600   306.48901     -44664.232      12807.79       3875.657       16.6078        13.4502        17.3502      
      1700   300.22173     -44671.349      7307.0408      3875.657       16.6078        13.4502        17.3502      
      1800   278.96731     -44662.925      9228.1564      3875.657       16.6078        13.4502        17.3502      
      1900   292.62941     -44678.527      3981.2575      3875.657       16.6078        13.4502        17.3502      
      2000   304.29791     -44654.52       14841.047      3875.657       16.6078        13.4502        17.3502      
      2100   319.91892     -44642.625      6560.958       3875.657       16.6078        13.4502        17.3502      
      2200   317.18844     -44659.93       10297.709      3875.657       16.6078        13.4502        17.3502      
      2300   300.90899     -44661.883     -5344.0289      3875.657       16.6078        13.4502        17.3502      
      2400   292.96435     -44662.044      12697.291      3875.657       16.6078        13.4502        17.3502      
      2500   292.11023     -44654.773      1118.8337      3875.657       16.6078        13.4502        17.3502      
      2600   291.39085     -44644.002     -572.35417      3875.657       16.6078        13.4502        17.3502      
      2700   303.89781     -44664.002      7602.4811      3875.657       16.6078        13.4502        17.3502      
      2800   298.25946     -44668.012      15422.089      3875.657       16.6078        13.4502        17.3502      
      2900   297.19247     -44675.61       7583.3075      3875.657       16.6078        13.4502        17.3502      
      3000   314.50086     -44691.253      1874.3522      3875.657       16.6078        13.4502        17.3502      
      3100   318.57146     -44670.058     -654.5971       3875.657       16.6078        13.4502        17.3502      
      3200   322.15924     -44648.932      4185.8082      3875.657       16.6078        13.4502        17.3502      
      3300   293.48968     -44627.01       9536.2521      3875.657       16.6078        13.4502        17.3502      
      3400   293.27791     -44645.251      12942.331      3875.657       16.6078        13.4502        17.3502      
      3500   298.50829     -44656.378      10476.099      3875.657       16.6078        13.4502        17.3502      
      3600   306.58816     -44655.933     -1608.6955      3875.657       16.6078        13.4502        17.3502      
      3700   306.9781      -44658.718     -1518.1553      3875.657       16.6078        13.4502        17.3502      
      3800   291.20938     -44651.369     -7032.5616      3875.657       16.6078        13.4502        17.3502      
      3900   288.70351     -44662.424     -4490.6499      3875.657       16.6078        13.4502        17.3502      
      4000   279.98622     -44645.344      12750.089      3875.657       16.6078        13.4502        17.3502      
      4100   314.99444     -44654.354      8160.9149      3875.657       16.6078        13.4502        17.3502      
      4200   321.26109     -44642.667     -4668.225       3875.657       16.6078        13.4502        17.3502      
      4300   300.12678     -44624.324      10345.961      3875.657       16.6078        13.4502        17.3502      
      4400   295.72853     -44639.71       6066.6412      3875.657       16.6078        13.4502        17.3502      
      4500   308.09425     -44656.492      6169.3091      3875.657       16.6078        13.4502        17.3502      
      4600   292.58479     -44634.055      1141.4682      3875.657       16.6078        13.4502        17.3502      
      4700   299.18154     -44640.893      2601.9915      3875.657       16.6078        13.4502        17.3502      
      4800   304.74607     -44644.731      1695.464       3875.657       16.6078        13.4502        17.3502      
      4900   321.50581     -44658.839      5550.4167      3875.657       16.6078        13.4502        17.3502      
      5000   308.79376     -44640.23      -404.16418      3875.657       16.6078        13.4502        17.3502      
Loop time of 150.471 on 16 procs for 5000 steps with 386 atoms

Performance: 1.435 ns/day, 16.719 hours/ns, 33.229 timesteps/s, 12.826 katom-step/s
100.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 114.59     | 118.69     | 121.2      |  17.3 | 78.88
Bond    | 0.00076244 | 0.00098649 | 0.0013007  |   0.0 |  0.00
Neigh   | 11.818     | 11.959     | 12.292     |   4.2 |  7.95
Comm    | 1.5592     | 4.0645     | 8.1718     |  93.5 |  2.70
Output  | 0.013131   | 0.014989   | 0.016568   |   0.8 |  0.01
Modify  | 15.278     | 15.623     | 15.775     |   3.8 | 10.38
Other   |            | 0.1208     |            |       |  0.08

Nlocal:          48.25 ave          57 max          37 min
Histogram: 1 0 0 0 2 1 1 2 0 1
Nghost:        3585.25 ave        3609 max        3542 min
Histogram: 1 0 0 0 1 0 3 0 0 3
Neighs:        33596.4 ave       39317 max       25927 min
Histogram: 1 0 0 0 2 1 1 2 0 1

Total # of neighbors = 268771
Ave neighs/atom = 696.29793
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:55:14
