LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.1                  # the deformation magnitude 0.01

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-9-vasp
read_data       ${structure}.data
read_data       333U-50C-9-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.010 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 4.78388e-05 on 8 procs for 1 steps with 386 atoms

61.1% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.76e-07   | 1.92e-07   | 2.1e-07    |   0.0 |  0.40
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 9.74e-07   | 1.5796e-06 | 2.036e-06  |   0.0 |  3.30
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 4.607e-05  |            |       | 96.30

Nlocal:          48.25 ave          55 max          40 min
Histogram: 2 0 0 0 2 0 1 0 1 2
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-9-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 5000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -0.82 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 142.4 | 144.4 | 146.4 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -43202.648      118796.37      1.7478941      3875.657     
       100   631.0338      -43895.466     -4819.2253      1.7478941      3875.657     
       200   533.30843     -44157.498      15862.756      1.7478941      3875.657     
       300   425.22341     -44305.336      2256.7082      1.7478941      3875.657     
       400   350.71086     -44415.617      8647.0575      1.7478941      3875.657     
       500   327.82267     -44524.572      11246.901      1.7478941      3875.657     
       600   281.23069     -44560.92       9461.1727      1.7478941      3875.657     
       700   266.77522     -44585.699      10549.532      1.7478941      3875.657     
       800   303.32794     -44620.951      15593.795      1.7478941      3875.657     
       900   299.36152     -44595.018      4527.8559      1.7478941      3875.657     
      1000   319.16248     -44598.921     -1186.3394      1.7478941      3875.657     
      1100   314.01384     -44597.008      4234.2333      1.7478941      3875.657     
      1200   296.63954     -44596.234      2232.5129      1.7478941      3875.657     
      1300   297.2041      -44617.222      7165.1973      1.7478941      3875.657     
      1400   298.61517     -44631.197      11973.132      1.7478941      3875.657     
      1500   302.89362     -44634.621      14442.442      1.7478941      3875.657     
      1600   302.27445     -44633.277      10672.965      1.7478941      3875.657     
      1700   299.78312     -44632.561      3910.9904      1.7478941      3875.657     
      1800   304.25195     -44648.038     -6322.9145      1.7478941      3875.657     
      1900   301.44067     -44659.194      23690.598      1.7478941      3875.657     
      2000   289.87138     -44655.159      8378.5973      1.7478941      3875.657     
      2100   301.28218     -44667.342     -2611.4715      1.7478941      3875.657     
      2200   303.40474     -44665.078      13772.112      1.7478941      3875.657     
      2300   302.72932     -44654.236     -8117.9902      1.7478941      3875.657     
      2400   298.23291     -44646.643      14731.88       1.7478941      3875.657     
      2500   295.62437     -44648.964      3601.6509      1.7478941      3875.657     
      2600   314.28699     -44679.893      8252.674       1.7478941      3875.657     
      2700   285.32117     -44673.293     -9809.669       1.7478941      3875.657     
      2800   289.2142      -44686.236     -12047.076      1.7478941      3875.657     
      2900   285.88087     -44660.043      4061.6564      1.7478941      3875.657     
      3000   340.84522     -44694.627      2804.997       1.7478941      3875.657     
      3100   307.11083     -44662.512     -1759.3394      1.7478941      3875.657     
      3200   306.51915     -44691.976     -815.42329      1.7478941      3875.657     
      3300   281.43852     -44681.276      3529.626       1.7478941      3875.657     
      3400   300.84673     -44691.895     -3239.1399      1.7478941      3875.657     
      3500   283.97081     -44648.398      7707.9248      1.7478941      3875.657     
      3600   315.17398     -44660.376      4635.8927      1.7478941      3875.657     
      3700   315.40963     -44673.4        8054.8665      1.7478941      3875.657     
      3800   307.26321     -44687.246      8084.5464      1.7478941      3875.657     
      3900   288.11165     -44668.053      9159.368       1.7478941      3875.657     
      4000   315.00755     -44679.007      1420.9692      1.7478941      3875.657     
      4100   306.14203     -44672.725     -4232.8397      1.7478941      3875.657     
      4200   294.97714     -44682.736     -7225.2002      1.7478941      3875.657     
      4300   291.37258     -44691.719     -594.05295      1.7478941      3875.657     
      4400   299.01349     -44688.375      10429.302      1.7478941      3875.657     
      4500   324.72474     -44679.42       2820.8572      1.7478941      3875.657     
      4600   317.14534     -44662.696      3119.9744      1.7478941      3875.657     
      4700   306.3371      -44662.415     -236.49471      1.7478941      3875.657     
      4800   303.07185     -44676.317     -332.45138      1.7478941      3875.657     
      4900   295.13321     -44676.012      7694.3408      1.7478941      3875.657     
      5000   293.88258     -44672.085      13346.802      1.7478941      3875.657     
Loop time of 282.401 on 8 procs for 5000 steps with 386 atoms

Performance: 0.765 ns/day, 31.378 hours/ns, 17.705 timesteps/s, 6.834 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 169.75     | 222.93     | 237.52     | 136.2 | 78.94
Bond    | 0.0015627  | 0.0017563  | 0.002075   |   0.4 |  0.00
Neigh   | 14.107     | 18.474     | 19.392     |  38.6 |  6.54
Comm    | 3.9037     | 18.507     | 71.675     | 472.7 |  6.55
Output  | 0.0029215  | 0.0031455  | 0.004344   |   0.8 |  0.00
Modify  | 21.458     | 22.379     | 26.767     |  35.3 |  7.92
Other   |            | 0.1023     |            |       |  0.04

Nlocal:          48.25 ave          55 max          42 min
Histogram: 1 1 2 0 0 0 2 0 0 2
Nghost:         3747.5 ave        3800 max        3681 min
Histogram: 1 0 0 2 1 0 1 1 1 1
Neighs:        33591.8 ave       38204 max       29191 min
Histogram: 1 1 2 0 0 0 1 1 0 2

Total # of neighbors = 268734
Ave neighs/atom = 696.20207
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333U-50C-9-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.6078
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.4502
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.3502

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.0034
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal -1.0717
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -9.4505

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 16.6078
variable dlen equal lx-${len0}
variable dlen equal lx-16.6078
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*16.6078
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.94505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.10717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -0.00034
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.66078 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.66078 xy delta 0.94505 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.66078 xy delta 0.94505 xz delta 0.10717 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.2 | 145.2 | 147.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   293.88258     -44672.085      13346.832      3875.657       16.6078        13.4502        17.3502      
       100   300.52001     -44655.525      1339.3443      3867.9057      16.574584      13.4502        17.3502      
       200   321.87219     -44651.711      9620.1179      3860.1544      16.541369      13.4502        17.3502      
       300   295.46522     -44650.437     -9376.4295      3852.4031      16.508153      13.4502        17.3502      
       400   317.52946     -44688.448      5644.6502      3844.6517      16.474938      13.4502        17.3502      
       500   298.56986     -44680.205      14440.784      3836.9004      16.441722      13.4502        17.3502      
       600   294.46701     -44686.596     -6792.4181      3829.1491      16.408506      13.4502        17.3502      
       700   279.5154      -44659.611     -3407.9371      3821.3978      16.375291      13.4502        17.3502      
       800   310.58844     -44677.988      13556.273      3813.6465      16.342075      13.4502        17.3502      
       900   312.43322     -44687.41       17263.907      3805.8952      16.30886       13.4502        17.3502      
      1000   284.16785     -44675.233      14086.09       3798.1439      16.275644      13.4502        17.3502      
      1100   289.7009      -44682.188     -2082.324       3790.3925      16.242428      13.4502        17.3502      
      1200   306.29002     -44694.178      1139.8103      3782.6412      16.209213      13.4502        17.3502      
      1300   299.70361     -44675.193      26056.424      3774.8899      16.175997      13.4502        17.3502      
      1400   301.38503     -44652.849      27992.348      3767.1386      16.142782      13.4502        17.3502      
      1500   336.10389     -44678.428      18685.676      3759.3873      16.109566      13.4502        17.3502      
      1600   309.29824     -44679.826      6189.3399      3751.636       16.07635       13.4502        17.3502      
      1700   279.97982     -44657.48       10489.46       3743.8847      16.043135      13.4502        17.3502      
      1800   289.28917     -44664.03       35648.364      3736.1333      16.009919      13.4502        17.3502      
      1900   300.51744     -44676.437      23927.652      3728.382       15.976704      13.4502        17.3502      
      2000   296.85822     -44691.559      4808.2361      3720.6307      15.943488      13.4502        17.3502      
      2100   308.36018     -44709.757      14943.907      3712.8794      15.910272      13.4502        17.3502      
      2200   303.28195     -44681.167      11628.123      3705.1281      15.877057      13.4502        17.3502      
      2300   329.41521     -44666.674      31925.622      3697.3768      15.843841      13.4502        17.3502      
      2400   318.61099     -44648.589      22355.331      3689.6255      15.810626      13.4502        17.3502      
      2500   320.2681      -44672.936      20150.929      3681.8741      15.77741       13.4502        17.3502      
      2600   303.78135     -44659.101      32964.318      3674.1228      15.744194      13.4502        17.3502      
      2700   296.5255      -44657.133      17109.983      3666.3715      15.710979      13.4502        17.3502      
      2800   285.28935     -44651.841      14189.753      3658.6202      15.677763      13.4502        17.3502      
      2900   306.30912     -44680.076      20567.549      3650.8689      15.644548      13.4502        17.3502      
      3000   307.43661     -44670.425      23423.931      3643.1176      15.611332      13.4502        17.3502      
      3100   292.51259     -44632.533      23980.018      3635.3663      15.578116      13.4502        17.3502      
      3200   298.2013      -44631.563      21372.663      3627.6149      15.544901      13.4502        17.3502      
      3300   299.98411     -44650.41       18981.117      3619.8636      15.511685      13.4502        17.3502      
      3400   294.60229     -44652.656      32194.776      3612.1123      15.47847       13.4502        17.3502      
      3500   305.72992     -44675.145      34726.581      3604.361       15.445254      13.4502        17.3502      
      3600   297.6123      -44665.535      40236.327      3596.6097      15.412038      13.4502        17.3502      
      3700   284.26501     -44629.932      10891.153      3588.8584      15.378823      13.4502        17.3502      
      3800   325.12862     -44630.389      37412.621      3581.1071      15.345607      13.4502        17.3502      
      3900   317.60346     -44610.035      41685.908      3573.3557      15.312392      13.4502        17.3502      
      4000   326.04841     -44633.676      21849.902      3565.6044      15.279176      13.4502        17.3502      
      4100   303.45948     -44628.899      27468.006      3557.8531      15.24596       13.4502        17.3502      
      4200   287.0132      -44624.214      28361.372      3550.1018      15.212745      13.4502        17.3502      
      4300   305.50785     -44643.03       29950.117      3542.3505      15.179529      13.4502        17.3502      
      4400   295.42873     -44640.535      33455.436      3534.5992      15.146314      13.4502        17.3502      
      4500   289.74956     -44639.245      61471.518      3526.8479      15.113098      13.4502        17.3502      
      4600   290.24779     -44617.412      35850.43       3519.0965      15.079882      13.4502        17.3502      
      4700   310.75991     -44591.895      46593.093      3511.3452      15.046667      13.4502        17.3502      
      4800   318.1556      -44592.824      47590.093      3503.5939      15.013451      13.4502        17.3502      
      4900   312.48995     -44601.87       46043.551      3495.8426      14.980236      13.4502        17.3502      
      5000   303.87471     -44596.782      52412.361      3488.0913      14.94702       13.4502        17.3502      
Loop time of 316.922 on 8 procs for 5000 steps with 386 atoms

Performance: 0.682 ns/day, 35.214 hours/ns, 15.777 timesteps/s, 6.090 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 188.06     | 251.61     | 270.56     | 156.7 | 79.39
Bond    | 0.0017385  | 0.002027   | 0.002318   |   0.4 |  0.00
Neigh   | 14.015     | 19.037     | 20.327     |  46.1 |  6.01
Comm    | 2.639      | 21.62      | 85.12      | 534.3 |  6.82
Output  | 0.017199   | 0.019472   | 0.021431   |   0.9 |  0.01
Modify  | 23.195     | 24.518     | 29.599     |  41.1 |  7.74
Other   |            | 0.1156     |            |       |  0.04

Nlocal:          48.25 ave          56 max          43 min
Histogram: 2 0 2 0 1 0 2 0 0 1
Nghost:        3932.62 ave        3955 max        3903 min
Histogram: 2 0 0 0 1 1 0 0 3 1
Neighs:          37357 ave       42898 max       33321 min
Histogram: 2 0 2 0 1 0 2 0 0 1

Total # of neighbors = 298856
Ave neighs/atom = 774.23834
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*16.6078
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.66078 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.66078 xy delta -0.94505 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.66078 xy delta -0.94505 xz delta -0.10717 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.3 | 145.2 | 147.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   293.88258     -44672.085      13346.832      3875.657       16.6078        13.4502        17.3502      
       100   300.35318     -44655.247      1650.5865      3883.4083      16.641016      13.4502        17.3502      
       200   324.12393     -44658.655      7389.6757      3891.1596      16.674231      13.4502        17.3502      
       300   296.62121     -44642.679     -12087.975      3898.9109      16.707447      13.4502        17.3502      
       400   305.65024     -44675.115      7934.0083      3906.6622      16.740662      13.4502        17.3502      
       500   287.61344     -44665.555      12527.235      3914.4136      16.773878      13.4502        17.3502      
       600   303.03175     -44686.06       5324.8194      3922.1649      16.807094      13.4502        17.3502      
       700   297.10699     -44671.588     -14828.655      3929.9162      16.840309      13.4502        17.3502      
       800   323.42629     -44675.443     -7598.7987      3937.6675      16.873525      13.4502        17.3502      
       900   304.55288     -44675.161      2719.1156      3945.4188      16.90674       13.4502        17.3502      
      1000   303.10608     -44685.118     -5602.262       3953.1701      16.939956      13.4502        17.3502      
      1100   302.30677     -44675.995      3126.9269      3960.9214      16.973172      13.4502        17.3502      
      1200   313.39102     -44684.498     -4791.5782      3968.6728      17.006387      13.4502        17.3502      
      1300   311.74598     -44691.091     -1292.971       3976.4241      17.039603      13.4502        17.3502      
      1400   270.12906     -44662.776     -4758.7162      3984.1754      17.072818      13.4502        17.3502      
      1500   297.5881      -44689.165     -12642.298      3991.9267      17.106034      13.4502        17.3502      
      1600   298.22663     -44655.342     -4316.351       3999.678       17.13925       13.4502        17.3502      
      1700   303.70832     -44637.698     -8835.2299      4007.4293      17.172465      13.4502        17.3502      
      1800   299.59506     -44650.972     -12532.676      4015.1806      17.205681      13.4502        17.3502      
      1900   304.7732      -44690.14      -5749.303       4022.932       17.238896      13.4502        17.3502      
      2000   295.97961     -44681.818      3029.7976      4030.6833      17.272112      13.4502        17.3502      
      2100   311.51333     -44691.87      -6536.437       4038.4346      17.305328      13.4502        17.3502      
      2200   297.55929     -44673.483     -7708.971       4046.1859      17.338543      13.4502        17.3502      
      2300   317.92618     -44688.033     -6359.2298      4053.9372      17.371759      13.4502        17.3502      
      2400   311.03894     -44653.579     -14237.904      4061.6885      17.404974      13.4502        17.3502      
      2500   310.01935     -44644.534     -2347.5411      4069.4398      17.43819       13.4502        17.3502      
      2600   308.41452     -44673.894     -7410.1981      4077.1912      17.471406      13.4502        17.3502      
      2700   287.26298     -44651.789     -1603.4238      4084.9425      17.504621      13.4502        17.3502      
      2800   296.48272     -44658.652     -1594.389       4092.6938      17.537837      13.4502        17.3502      
      2900   289.54269     -44644.209     -16160.246      4100.4451      17.571052      13.4502        17.3502      
      3000   294.46633     -44647.387     -21366.031      4108.1964      17.604268      13.4502        17.3502      
      3100   294.7108      -44652.706     -13355.819      4115.9477      17.637484      13.4502        17.3502      
      3200   283.31445     -44645.606     -18724.244      4123.699       17.670699      13.4502        17.3502      
      3300   298.62365     -44656.957     -18328.205      4131.4504      17.703915      13.4502        17.3502      
      3400   282.92311     -44650.449     -18979.952      4139.2017      17.73713       13.4502        17.3502      
      3500   284.11973     -44663.431     -15457.804      4146.953       17.770346      13.4502        17.3502      
      3600   282.41314     -44652.586     -18055.899      4154.7043      17.803562      13.4502        17.3502      
      3700   318.64846     -44654.727     -14434.944      4162.4556      17.836777      13.4502        17.3502      
      3800   307.21876     -44616.568     -13529.787      4170.2069      17.869993      13.4502        17.3502      
      3900   316.30442     -44629.131     -31213.63       4177.9582      17.903208      13.4502        17.3502      
      4000   293.99281     -44631.426     -13957.332      4185.7096      17.936424      13.4502        17.3502      
      4100   296.23748     -44632.215     -27089.848      4193.4609      17.96964       13.4502        17.3502      
      4200   324.91633     -44647.017     -23051.213      4201.2122      18.002855      13.4502        17.3502      
      4300   302.62819     -44630.11      -28088.78       4208.9635      18.036071      13.4502        17.3502      
      4400   299.99933     -44642.278     -16050.597      4216.7148      18.069286      13.4502        17.3502      
      4500   284.73385     -44621.28      -8079.5326      4224.4661      18.102502      13.4502        17.3502      
      4600   306.75776     -44611.237     -17948.12       4232.2174      18.135718      13.4502        17.3502      
      4700   318.24442     -44583.977     -16563.722      4239.9688      18.168933      13.4502        17.3502      
      4800   311.88419     -44586.573     -18351.738      4247.7201      18.202149      13.4502        17.3502      
      4900   311.26546     -44606.69      -21665.347      4255.4714      18.235364      13.4502        17.3502      
      5000   301.47047     -44609.915     -23717.295      4263.2227      18.26858       13.4502        17.3502      
Loop time of 267.396 on 8 procs for 5000 steps with 386 atoms

Performance: 0.808 ns/day, 29.711 hours/ns, 18.699 timesteps/s, 7.218 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 157.25     | 214.01     | 227.41     | 147.4 | 80.03
Bond    | 0.0017627  | 0.0020342  | 0.0022994  |   0.4 |  0.00
Neigh   | 11.423     | 15.871     | 16.847     |  42.8 |  5.94
Comm    | 2.0303     | 15.464     | 72.184     | 547.9 |  5.78
Output  | 0.018802   | 0.021169   | 0.023104   |   0.8 |  0.01
Modify  | 20.934     | 21.92      | 26.411     |  36.9 |  8.20
Other   |            | 0.1107     |            |       |  0.04

Nlocal:          48.25 ave          55 max          37 min
Histogram: 1 0 0 1 1 1 0 1 1 2
Nghost:        3304.62 ave        3331 max        3262 min
Histogram: 1 0 0 1 0 2 0 2 0 2
Neighs:        30515.2 ave       34720 max       23740 min
Histogram: 1 0 0 1 1 1 0 1 1 2

Total # of neighbors = 244122
Ave neighs/atom = 632.44041
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.4502
variable dlen equal ly-${len0}
variable dlen equal ly-13.4502
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.4502
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.94505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.10717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -0.00034
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.34502 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.34502 yz delta -0.00034 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.2 | 145.2 | 147.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   293.88258     -44672.085      13346.832      3875.657       16.6078        13.4502        17.3502      
       100   299.57596     -44654.346      1356.6143      3867.9057      16.6078        13.4233        17.3502      
       200   319.78321     -44652.327      10305.86       3860.1544      16.6078        13.396399      17.3502      
       300   296.77171     -44648.019     -5108.4453      3852.4031      16.6078        13.369499      17.3502      
       400   304.27229     -44680.996      7803.2756      3844.6517      16.6078        13.342598      17.3502      
       500   306.39361     -44688.276      9007.3371      3836.9004      16.6078        13.315698      17.3502      
       600   292.45466     -44683.762     -3543.1918      3829.1491      16.6078        13.288798      17.3502      
       700   312.69115     -44702.505      2192.6389      3821.3978      16.6078        13.261897      17.3502      
       800   298.69659     -44688.808      17969.926      3813.6465      16.6078        13.234997      17.3502      
       900   298.55606     -44698.341     -543.18681      3805.8952      16.6078        13.208096      17.3502      
      1000   285.79753     -44691.924      11078.162      3798.1439      16.6078        13.181196      17.3502      
      1100   304.2868      -44702.042      10966.723      3790.3925      16.6078        13.154296      17.3502      
      1200   310.20853     -44675.797      20242.47       3782.6412      16.6078        13.127395      17.3502      
      1300   305.04072     -44646.396      18536.171      3774.8899      16.6078        13.100495      17.3502      
      1400   300.88434     -44656.151     -2161.1111      3767.1386      16.6078        13.073594      17.3502      
      1500   296.42437     -44676.597      9615.1789      3759.3873      16.6078        13.046694      17.3502      
      1600   314.37312     -44700.7        10869.194      3751.636       16.6078        13.019794      17.3502      
      1700   298.50319     -44690.171      7861.8037      3743.8847      16.6078        12.992893      17.3502      
      1800   286.50941     -44691.768      6952.384       3736.1333      16.6078        12.965993      17.3502      
      1900   295.66923     -44702.936      12620.945      3728.382       16.6078        12.939092      17.3502      
      2000   303.20693     -44715.001      26064.021      3720.6307      16.6078        12.912192      17.3502      
      2100   288.03727     -44707.642      8331.2981      3712.8794      16.6078        12.885292      17.3502      
      2200   287.49998     -44692.457      26674.057      3705.1281      16.6078        12.858391      17.3502      
      2300   309.20258     -44676.62       8464.1124      3697.3768      16.6078        12.831491      17.3502      
      2400   299.59519     -44660.863      22767.104      3689.6255      16.6078        12.80459       17.3502      
      2500   297.31955     -44693.794      19871.538      3681.8741      16.6078        12.77769       17.3502      
      2600   299.15897     -44697.095      30298.046      3674.1228      16.6078        12.75079       17.3502      
      2700   290.17803     -44679.53       28637.994      3666.3715      16.6078        12.723889      17.3502      
      2800   310.22268     -44688.035      11254.779      3658.6202      16.6078        12.696989      17.3502      
      2900   316.68995     -44669.14       37841.526      3650.8689      16.6078        12.670088      17.3502      
      3000   304.12879     -44654.045      29878.493      3643.1176      16.6078        12.643188      17.3502      
      3100   302.70644     -44676.785      30197.353      3635.3663      16.6078        12.616288      17.3502      
      3200   291.88835     -44656.9        10685.572      3627.6149      16.6078        12.589387      17.3502      
      3300   309.27715     -44664.585      18567.247      3619.8636      16.6078        12.562487      17.3502      
      3400   299.59427     -44672.149      28823.577      3612.1123      16.6078        12.535586      17.3502      
      3500   304.46577     -44691.491      28102.178      3604.361       16.6078        12.508686      17.3502      
      3600   285.77681     -44662.707      33104.726      3596.6097      16.6078        12.481786      17.3502      
      3700   280.62328     -44647.163      37381.982      3588.8584      16.6078        12.454885      17.3502      
      3800   286.95983     -44666.827      23180.773      3581.1071      16.6078        12.427985      17.3502      
      3900   284.20573     -44672.064      39708.616      3573.3557      16.6078        12.401084      17.3502      
      4000   301.04741     -44677.43       32250.28       3565.6044      16.6078        12.374184      17.3502      
      4100   308.27817     -44643.95       38144.802      3557.8531      16.6078        12.347284      17.3502      
      4200   325.6951      -44630.985      34378.168      3550.1018      16.6078        12.320383      17.3502      
      4300   306.46653     -44630.505      31183.032      3542.3505      16.6078        12.293483      17.3502      
      4400   306.89686     -44638.443      33679.941      3534.5992      16.6078        12.266582      17.3502      
      4500   303.32965     -44648.24       41109.395      3526.8479      16.6078        12.239682      17.3502      
      4600   290.30627     -44633.216      34273.81       3519.0965      16.6078        12.212782      17.3502      
      4700   289.85815     -44628.92       30381.424      3511.3452      16.6078        12.185881      17.3502      
      4800   316.39398     -44638.947      51813.567      3503.5939      16.6078        12.158981      17.3502      
      4900   305.53794     -44590.949      53082.126      3495.8426      16.6078        12.13208       17.3502      
      5000   319.15319     -44602.345      37804.633      3488.0913      16.6078        12.10518       17.3502      
Loop time of 336.23 on 8 procs for 5000 steps with 386 atoms

Performance: 0.642 ns/day, 37.359 hours/ns, 14.871 timesteps/s, 5.740 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 195.94     | 269.43     | 287.75     | 170.7 | 80.13
Bond    | 0.0017994  | 0.0020908  | 0.0023972  |   0.4 |  0.00
Neigh   | 14.554     | 20.252     | 21.84      |  48.6 |  6.02
Comm    | 2.6219     | 20.957     | 94.4       | 611.8 |  6.23
Output  | 0.017802   | 0.019946   | 0.022026   |   0.9 |  0.01
Modify  | 23.819     | 25.451     | 31.208     |  43.9 |  7.57
Other   |            | 0.1188     |            |       |  0.04

Nlocal:          48.25 ave          54 max          40 min
Histogram: 1 0 0 0 2 1 0 2 0 2
Nghost:        4199.88 ave        4250 max        4147 min
Histogram: 3 1 0 0 0 0 0 0 1 3
Neighs:        37368.9 ave       41606 max       31231 min
Histogram: 1 0 0 0 2 1 0 2 0 2

Total # of neighbors = 298951
Ave neighs/atom = 774.48446
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.4502
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.34502 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.34502 yz delta 0.00034 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.3 | 145.2 | 147.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   293.88258     -44672.085      13346.832      3875.657       16.6078        13.4502        17.3502      
       100   301.3075      -44656.701      2336.116       3883.4083      16.6078        13.4771        17.3502      
       200   321.81089     -44654.498      10366.767      3891.1596      16.6078        13.504001      17.3502      
       300   295.42472     -44645.718     -11729.283      3898.9109      16.6078        13.530901      17.3502      
       400   300.2031      -44672.453      11822.795      3906.6622      16.6078        13.557802      17.3502      
       500   294.41797     -44673.997      12224.596      3914.4136      16.6078        13.584702      17.3502      
       600   297.09445     -44685.845     -6047.3302      3922.1649      16.6078        13.611602      17.3502      
       700   291.63575     -44678.806     -21098.896      3929.9162      16.6078        13.638503      17.3502      
       800   310.56264     -44679.835     -5264.7769      3937.6675      16.6078        13.665403      17.3502      
       900   311.246       -44656.821     -3061.9569      3945.4188      16.6078        13.692304      17.3502      
      1000   324.41846     -44681.839      2246.8023      3953.1701      16.6078        13.719204      17.3502      
      1100   296.90932     -44674.555      2878.7723      3960.9214      16.6078        13.746104      17.3502      
      1200   293.07581     -44676.656      8388.1605      3968.6728      16.6078        13.773005      17.3502      
      1300   296.46139     -44684.4       -4550.4388      3976.4241      16.6078        13.799905      17.3502      
      1400   285.68644     -44684.868     -975.07467      3984.1754      16.6078        13.826806      17.3502      
      1500   278.37358     -44685.138     -7853.3195      3991.9267      16.6078        13.853706      17.3502      
      1600   300.35932     -44681.573     -8265.6484      3999.678       16.6078        13.880606      17.3502      
      1700   303.34497     -44655.196     -3053.5925      4007.4293      16.6078        13.907507      17.3502      
      1800   302.44262     -44651.941     -6080.1069      4015.1806      16.6078        13.934407      17.3502      
      1900   299.31444     -44668.264     -2651.5855      4022.932       16.6078        13.961308      17.3502      
      2000   282.25527     -44657.965      6312.6521      4030.6833      16.6078        13.988208      17.3502      
      2100   299.78445     -44676.459     -4567.9994      4038.4346      16.6078        14.015108      17.3502      
      2200   309.79249     -44676.164     -6759.8037      4046.1859      16.6078        14.042009      17.3502      
      2300   308.66905     -44685.12      -4079.6142      4053.9372      16.6078        14.068909      17.3502      
      2400   275.407       -44670.342     -13046.137      4061.6885      16.6078        14.09581       17.3502      
      2500   280.27787     -44687.241     -6947.3674      4069.4398      16.6078        14.12271       17.3502      
      2600   292.62199     -44705.356     -21695.945      4077.1912      16.6078        14.14961       17.3502      
      2700   288.37152     -44676.924     -7460.0614      4084.9425      16.6078        14.176511      17.3502      
      2800   319.93306     -44684.899     -9516.9281      4092.6938      16.6078        14.203411      17.3502      
      2900   311.4216      -44665.881     -14772.716      4100.4451      16.6078        14.230312      17.3502      
      3000   295.93398     -44656.093     -7747.5782      4108.1964      16.6078        14.257212      17.3502      
      3100   292.68678     -44686.254     -3647.8582      4115.9477      16.6078        14.284112      17.3502      
      3200   305.93753     -44697.715     -3244.0725      4123.699       16.6078        14.311013      17.3502      
      3300   311.95679     -44687.077     -10071.348      4131.4504      16.6078        14.337913      17.3502      
      3400   309.14126     -44666.969     -2086.6463      4139.2017      16.6078        14.364814      17.3502      
      3500   313.39874     -44646.515      1790.5283      4146.953       16.6078        14.391714      17.3502      
      3600   327.63105     -44654.087      2523.1276      4154.7043      16.6078        14.418614      17.3502      
      3700   297.23437     -44660.14      -5247.792       4162.4556      16.6078        14.445515      17.3502      
      3800   278.4895      -44649.843     -12250.974      4170.2069      16.6078        14.472415      17.3502      
      3900   303.53095     -44679.279     -7776.9665      4177.9582      16.6078        14.499316      17.3502      
      4000   289.74214     -44651.285     -4972.1208      4185.7096      16.6078        14.526216      17.3502      
      4100   316.37991     -44648.353     -13515.423      4193.4609      16.6078        14.553116      17.3502      
      4200   320.03986     -44636.635     -5092.0896      4201.2122      16.6078        14.580017      17.3502      
      4300   309.57285     -44657.289     -11127.347      4208.9635      16.6078        14.606917      17.3502      
      4400   301.07205     -44661.722     -10564.627      4216.7148      16.6078        14.633818      17.3502      
      4500   296.86358     -44647.566     -12979.278      4224.4661      16.6078        14.660718      17.3502      
      4600   301.15562     -44629.415     -18208.772      4232.2174      16.6078        14.687618      17.3502      
      4700   317.2466      -44640.988     -8572.1022      4239.9688      16.6078        14.714519      17.3502      
      4800   289.64335     -44642.63      -20820.339      4247.7201      16.6078        14.741419      17.3502      
      4900   303.77094     -44661.285     -8833.6956      4255.4714      16.6078        14.76832       17.3502      
      5000   289.50481     -44630.286     -14837.196      4263.2227      16.6078        14.79522       17.3502      
Loop time of 262.411 on 8 procs for 5000 steps with 386 atoms

Performance: 0.823 ns/day, 29.157 hours/ns, 19.054 timesteps/s, 7.355 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 155.9      | 210.72     | 222.3      | 143.5 | 80.30
Bond    | 0.0016899  | 0.0020231  | 0.0022649  |   0.4 |  0.00
Neigh   | 11.21      | 15.532     | 16.55      |  41.8 |  5.92
Comm    | 2.9421     | 14.536     | 69.33      | 546.3 |  5.54
Output  | 0.018375   | 0.020696   | 0.022629   |   0.8 |  0.01
Modify  | 20.443     | 21.483     | 25.844     |  35.9 |  8.19
Other   |            | 0.1142     |            |       |  0.04

Nlocal:          48.25 ave          57 max          43 min
Histogram: 3 0 2 0 0 1 0 1 0 1
Nghost:        3195.88 ave        3229 max        3162 min
Histogram: 1 1 1 1 1 0 0 0 1 2
Neighs:          30491 ave       35623 max       27399 min
Histogram: 3 0 2 0 0 1 0 0 1 1

Total # of neighbors = 243928
Ave neighs/atom = 631.93782
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.3502
variable dlen equal lz-${len0}
variable dlen equal lz-17.3502
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.3502
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.94505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.10717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -0.00034
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -1.73502 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.2 | 145.2 | 147.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   293.88258     -44672.085      13346.832      3875.657       16.6078        13.4502        17.3502      
       100   300.4253      -44655.403      1380.9638      3867.9057      16.6078        13.4502        17.3155      
       200   323.77973     -44655.141      11238.56       3860.1544      16.6078        13.4502        17.280799    
       300   297.94715     -44648.738     -571.11554      3852.4031      16.6078        13.4502        17.246099    
       400   309.95884     -44683.743      7784.5579      3844.6517      16.6078        13.4502        17.211398    
       500   286.22145     -44660.528      7238.176       3836.9004      16.6078        13.4502        17.176698    
       600   286.9471      -44670.2        7378.938       3829.1491      16.6078        13.4502        17.141998    
       700   282.79142     -44663.586      8171.8977      3821.3978      16.6078        13.4502        17.107297    
       800   289.45834     -44681.725      17871.73       3813.6465      16.6078        13.4502        17.072597    
       900   271.27647     -44694.353     -2904.9012      3805.8952      16.6078        13.4502        17.037896    
      1000   281.0622      -44696.405      8911.158       3798.1439      16.6078        13.4502        17.003196    
      1100   313.20322     -44695.695     -1899.6878      3790.3925      16.6078        13.4502        16.968496    
      1200   304.13407     -44669.67       10964.762      3782.6412      16.6078        13.4502        16.933795    
      1300   288.65657     -44671.809      4822.8788      3774.8899      16.6078        13.4502        16.899095    
      1400   300.82626     -44693.562      16333.739      3767.1386      16.6078        13.4502        16.864394    
      1500   308.5645      -44704.698      12335.805      3759.3873      16.6078        13.4502        16.829694    
      1600   302.08718     -44686.137      8349.991       3751.636       16.6078        13.4502        16.794994    
      1700   311.06232     -44693          9979.0077      3743.8847      16.6078        13.4502        16.760293    
      1800   304.32796     -44703.742      1087.9203      3736.1333      16.6078        13.4502        16.725593    
      1900   288.29477     -44686.538      10113.168      3728.382       16.6078        13.4502        16.690892    
      2000   290.93952     -44678.111      31251.359      3720.6307      16.6078        13.4502        16.656192    
      2100   307.07365     -44686.897      18651.779      3712.8794      16.6078        13.4502        16.621492    
      2200   282.23049     -44680.559      24951.559      3705.1281      16.6078        13.4502        16.586791    
      2300   286.14694     -44679.52       6038.9366      3697.3768      16.6078        13.4502        16.552091    
      2400   299.17296     -44684.948      21355.476      3689.6255      16.6078        13.4502        16.51739     
      2500   302.31746     -44687.725      29819.599      3681.8741      16.6078        13.4502        16.48269     
      2600   291.74024     -44686.79       25520.492      3674.1228      16.6078        13.4502        16.44799     
      2700   289.63184     -44676.833      28590.726      3666.3715      16.6078        13.4502        16.413289    
      2800   305.58451     -44676.888      20900.033      3658.6202      16.6078        13.4502        16.378589    
      2900   317.21854     -44689.463      17333.435      3650.8689      16.6078        13.4502        16.343888    
      3000   307.03657     -44680.093      37722.882      3643.1176      16.6078        13.4502        16.309188    
      3100   291.87847     -44660.034      15163.65       3635.3663      16.6078        13.4502        16.274488    
      3200   301.39225     -44666.382      29002.65       3627.6149      16.6078        13.4502        16.239787    
      3300   289.02611     -44653.753      38676.193      3619.8636      16.6078        13.4502        16.205087    
      3400   296.35039     -44658.113      33352.878      3612.1123      16.6078        13.4502        16.170386    
      3500   305.70897     -44672.864      31776.582      3604.361       16.6078        13.4502        16.135686    
      3600   285.29169     -44674.727      15932.678      3596.6097      16.6078        13.4502        16.100986    
      3700   276.57205     -44646.81       37206.025      3588.8584      16.6078        13.4502        16.066285    
      3800   301.84143     -44639.833      36935.408      3581.1071      16.6078        13.4502        16.031585    
      3900   326.40858     -44640.182      32524.922      3573.3557      16.6078        13.4502        15.996884    
      4000   292.95016     -44626.352      34344.196      3565.6044      16.6078        13.4502        15.962184    
      4100   294.13408     -44631.325      42354.518      3557.8531      16.6078        13.4502        15.927484    
      4200   311.62817     -44634.809      37157.827      3550.1018      16.6078        13.4502        15.892783    
      4300   308.37901     -44629.982      35316.234      3542.3505      16.6078        13.4502        15.858083    
      4400   275.97882     -44602.918      35557.451      3534.5992      16.6078        13.4502        15.823382    
      4500   276.68581     -44604.14       53270.913      3526.8479      16.6078        13.4502        15.788682    
      4600   313.35466     -44631.713      39831.284      3519.0965      16.6078        13.4502        15.753982    
      4700   280.47029     -44600.732      39810.216      3511.3452      16.6078        13.4502        15.719281    
      4800   290.65106     -44620.052      35854.534      3503.5939      16.6078        13.4502        15.684581    
      4900   277.68153     -44579.268      43039.458      3495.8426      16.6078        13.4502        15.64988     
      5000   321.91309     -44589.094      50127.923      3488.0913      16.6078        13.4502        15.61518     
Loop time of 327.118 on 8 procs for 5000 steps with 386 atoms

Performance: 0.660 ns/day, 36.346 hours/ns, 15.285 timesteps/s, 5.900 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 200.27     | 263.75     | 279.64     | 149.5 | 80.63
Bond    | 0.0018156  | 0.0020631  | 0.002397   |   0.4 |  0.00
Neigh   | 14.661     | 19.654     | 20.578     |  42.8 |  6.01
Comm    | 2.4767     | 18.386     | 81.828     | 565.8 |  5.62
Output  | 0.018244   | 0.020562   | 0.022501   |   0.8 |  0.01
Modify  | 24.223     | 25.18      | 30.222     |  38.2 |  7.70
Other   |            | 0.1208     |            |       |  0.04

Nlocal:          48.25 ave          56 max          42 min
Histogram: 1 1 2 0 0 1 2 0 0 1
Nghost:           4019 ave        4057 max        3988 min
Histogram: 1 1 1 1 0 2 0 1 0 1
Neighs:        37409.2 ave       43148 max       32730 min
Histogram: 1 1 1 1 0 1 2 0 0 1

Total # of neighbors = 299274
Ave neighs/atom = 775.32124
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.3502
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 1.73502 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.2 | 145.2 | 147.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   293.88258     -44672.085      13346.832      3875.657       16.6078        13.4502        17.3502      
       100   300.38173     -44655.265      1412.1626      3883.4083      16.6078        13.4502        17.3849      
       200   320.54736     -44649.99       11275.743      3891.1596      16.6078        13.4502        17.419601    
       300   299.489       -44644.267     -10721.974      3898.9109      16.6078        13.4502        17.454301    
       400   299.87322     -44663.383      3859.5728      3906.6622      16.6078        13.4502        17.489002    
       500   288.59633     -44668.224      11879.744      3914.4136      16.6078        13.4502        17.523702    
       600   296.99005     -44689.473     -7933.5358      3922.1649      16.6078        13.4502        17.558402    
       700   297.77279     -44693.819      1515.8999      3929.9162      16.6078        13.4502        17.593103    
       800   300.81766     -44708.288      306.57735      3937.6675      16.6078        13.4502        17.627803    
       900   275.67909     -44700.445      2803.5188      3945.4188      16.6078        13.4502        17.662504    
      1000   276.98447     -44692.534      10000.227      3953.1701      16.6078        13.4502        17.697204    
      1100   306.74076     -44690.056      5691.3344      3960.9214      16.6078        13.4502        17.731904    
      1200   303.02743     -44672.245     -7794.5061      3968.6728      16.6078        13.4502        17.766605    
      1300   299.06074     -44665.92       5885.884       3976.4241      16.6078        13.4502        17.801305    
      1400   314.42739     -44702.641     -2651.5583      3984.1754      16.6078        13.4502        17.836006    
      1500   281.82884     -44671.022     -750.66396      3991.9267      16.6078        13.4502        17.870706    
      1600   307.96285     -44696.932      2140.9879      3999.678       16.6078        13.4502        17.905406    
      1700   304.68403     -44688.709     -6132.6916      4007.4293      16.6078        13.4502        17.940107    
      1800   312.61237     -44683.128      1164.0369      4015.1806      16.6078        13.4502        17.974807    
      1900   293.36775     -44652.128      3776.4911      4022.932       16.6078        13.4502        18.009508    
      2000   294.9937      -44669.05      -1631.4005      4030.6833      16.6078        13.4502        18.044208    
      2100   289.88121     -44678.655     -3769.3445      4038.4346      16.6078        13.4502        18.078908    
      2200   275.18575     -44662.917     -19977.877      4046.1859      16.6078        13.4502        18.113609    
      2300   294.3452      -44686.487     -10881.807      4053.9372      16.6078        13.4502        18.148309    
      2400   278.49819     -44670.228     -15509.751      4061.6885      16.6078        13.4502        18.18301     
      2500   281.91452     -44669.481     -217.72754      4069.4398      16.6078        13.4502        18.21771     
      2600   300.02471     -44662.894     -10355.639      4077.1912      16.6078        13.4502        18.25241     
      2700   335.95494     -44683.734     -4886.8288      4084.9425      16.6078        13.4502        18.287111    
      2800   324.08931     -44660.535     -17798.039      4092.6938      16.6078        13.4502        18.321811    
      2900   299.24069     -44658.357     -7266.8442      4100.4451      16.6078        13.4502        18.356512    
      3000   295.02003     -44663.565     -16569.2        4108.1964      16.6078        13.4502        18.391212    
      3100   319.93361     -44672.048     -8369.7823      4115.9477      16.6078        13.4502        18.425912    
      3200   292.7393      -44635.165     -13856.565      4123.699       16.6078        13.4502        18.460613    
      3300   287.30631     -44648.016     -19517.46       4131.4504      16.6078        13.4502        18.495313    
      3400   277.31429     -44654.84      -4864.8882      4139.2017      16.6078        13.4502        18.530014    
      3500   283.53057     -44650.297     -16541.174      4146.953       16.6078        13.4502        18.564714    
      3600   313.72933     -44645.908     -3566.0981      4154.7043      16.6078        13.4502        18.599414    
      3700   317.19419     -44613.321     -21737.708      4162.4556      16.6078        13.4502        18.634115    
      3800   306.3187      -44610.941     -24638.129      4170.2069      16.6078        13.4502        18.668815    
      3900   324.43786     -44648.222     -13359.422      4177.9582      16.6078        13.4502        18.703516    
      4000   304.74938     -44641.719     -9547.9976      4185.7096      16.6078        13.4502        18.738216    
      4100   290.99671     -44638.754     -9026.9085      4193.4609      16.6078        13.4502        18.772916    
      4200   294.65936     -44648.214     -19934.408      4201.2122      16.6078        13.4502        18.807617    
      4300   286.53158     -44645.752     -14801.615      4208.9635      16.6078        13.4502        18.842317    
      4400   284.68111     -44658.698     -23545.888      4216.7148      16.6078        13.4502        18.877018    
      4500   274.8908      -44627.785     -16048.115      4224.4661      16.6078        13.4502        18.911718    
      4600   308.97472     -44623.052     -22458.255      4232.2174      16.6078        13.4502        18.946418    
      4700   314.01239     -44615.023     -19874.863      4239.9688      16.6078        13.4502        18.981119    
      4800   287.8328      -44593.798     -19019.652      4247.7201      16.6078        13.4502        19.015819    
      4900   307.13337     -44629.568     -32936.274      4255.4714      16.6078        13.4502        19.05052     
      5000   289.23705     -44637.713     -25342.991      4263.2227      16.6078        13.4502        19.08522     
Loop time of 285.052 on 8 procs for 5000 steps with 386 atoms

Performance: 0.758 ns/day, 31.672 hours/ns, 17.541 timesteps/s, 6.771 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 228.11     | 235.41     | 243.13     |  30.6 | 82.58
Bond    | 0.0017451  | 0.0020542  | 0.0023228  |   0.4 |  0.00
Neigh   | 16.809     | 17.14      | 17.458     |   4.7 |  6.01
Comm    | 2.4206     | 10.165     | 17.492     | 147.8 |  3.57
Output  | 0.018207   | 0.020774   | 0.022731   |   0.9 |  0.01
Modify  | 21.863     | 22.2       | 22.542     |   4.3 |  7.79
Other   |            | 0.1171     |            |       |  0.04

Nlocal:          48.25 ave          59 max          43 min
Histogram: 1 3 1 1 0 1 0 0 0 1
Nghost:           3501 ave        3543 max        3450 min
Histogram: 1 1 0 0 1 1 2 0 0 2
Neighs:        30495.1 ave       36990 max       27235 min
Histogram: 1 2 2 1 0 1 0 0 0 1

Total # of neighbors = 243961
Ave neighs/atom = 632.02332
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 16.6078
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.0034)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*16.6078
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.94505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.10717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -0.00034
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -1.66078 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.2 | 145.2 | 147.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   293.88258     -44672.085      13346.832      3875.657       16.6078        13.4502        17.3502      
       100   300.38574     -44655.301      1394.2099      3875.657       16.6078        13.4502        17.3502      
       200   318.44139     -44650.359      11792.747      3875.657       16.6078        13.4502        17.3502      
       300   289.89662     -44640.782     -8402.5302      3875.657       16.6078        13.4502        17.3502      
       400   306.43664     -44684.854      1626.0855      3875.657       16.6078        13.4502        17.3502      
       500   285.46304     -44672.497      18043.077      3875.657       16.6078        13.4502        17.3502      
       600   289.5007      -44675.674      11350.391      3875.657       16.6078        13.4502        17.3502      
       700   307.22413     -44680.1       -5617.6181      3875.657       16.6078        13.4502        17.3502      
       800   325.59016     -44670.899      2248.9923      3875.657       16.6078        13.4502        17.3502      
       900   335.25397     -44695.093     -3219.6132      3875.657       16.6078        13.4502        17.3502      
      1000   308.43727     -44697.109      1541.2053      3875.657       16.6078        13.4502        17.3502      
      1100   305.04648     -44696.428      16474.717      3875.657       16.6078        13.4502        17.3502      
      1200   296.30788     -44682.93       7286.9125      3875.657       16.6078        13.4502        17.3502      
      1300   302.76527     -44684.315      7408.4144      3875.657       16.6078        13.4502        17.3502      
      1400   292.85658     -44682.023      316.90649      3875.657       16.6078        13.4502        17.3502      
      1500   275.63712     -44684.18       202.44703      3875.657       16.6078        13.4502        17.3502      
      1600   290.39982     -44699.052      4721.7896      3875.657       16.6078        13.4502        17.3502      
      1700   297.95823     -44673.979      10300.409      3875.657       16.6078        13.4502        17.3502      
      1800   317.11975     -44676.299      10853.569      3875.657       16.6078        13.4502        17.3502      
      1900   294.75073     -44663.923     -821.71058      3875.657       16.6078        13.4502        17.3502      
      2000   294.98137     -44679.768     -2483.5033      3875.657       16.6078        13.4502        17.3502      
      2100   281.58032     -44676.244     -1576.4815      3875.657       16.6078        13.4502        17.3502      
      2200   315.29545     -44718.095      10205.781      3875.657       16.6078        13.4502        17.3502      
      2300   298.8834      -44703.731      8216.3546      3875.657       16.6078        13.4502        17.3502      
      2400   297.01511     -44701.532      11015.897      3875.657       16.6078        13.4502        17.3502      
      2500   309.66244     -44681.344      2287.499       3875.657       16.6078        13.4502        17.3502      
      2600   340.62139     -44688.111     -627.79008      3875.657       16.6078        13.4502        17.3502      
      2700   329.28061     -44707.125      999.84267      3875.657       16.6078        13.4502        17.3502      
      2800   290.32648     -44689.482      2404.4535      3875.657       16.6078        13.4502        17.3502      
      2900   304.28899     -44721.31       11197.51       3875.657       16.6078        13.4502        17.3502      
      3000   295.55074     -44711.842      8244.2275      3875.657       16.6078        13.4502        17.3502      
      3100   300.19827     -44689.891      4837.4906      3875.657       16.6078        13.4502        17.3502      
      3200   307.64813     -44667.887     -3254.3856      3875.657       16.6078        13.4502        17.3502      
      3300   313.5282      -44678.916      7675.0188      3875.657       16.6078        13.4502        17.3502      
      3400   293.84087     -44672.104     -1799.6664      3875.657       16.6078        13.4502        17.3502      
      3500   304.95334     -44709.429      15723.942      3875.657       16.6078        13.4502        17.3502      
      3600   281.87768     -44690.959      554.3916       3875.657       16.6078        13.4502        17.3502      
      3700   304.06957     -44704.501      5026.1653      3875.657       16.6078        13.4502        17.3502      
      3800   312.02428     -44704.046     -2018.4039      3875.657       16.6078        13.4502        17.3502      
      3900   300.47028     -44723.011     -3913.6906      3875.657       16.6078        13.4502        17.3502      
      4000   294.62739     -44728.04       2678.3484      3875.657       16.6078        13.4502        17.3502      
      4100   296.4211      -44716.866      6272.0875      3875.657       16.6078        13.4502        17.3502      
      4200   305.88575     -44698.329     -5158.9426      3875.657       16.6078        13.4502        17.3502      
      4300   305.21873     -44673.828     -5245.6544      3875.657       16.6078        13.4502        17.3502      
      4400   314.26522     -44690.75      -3075.9779      3875.657       16.6078        13.4502        17.3502      
      4500   300.98396     -44688.886      2589.4538      3875.657       16.6078        13.4502        17.3502      
      4600   286.98669     -44688.466     -5095.321       3875.657       16.6078        13.4502        17.3502      
      4700   289.5225      -44687.067      8728.8578      3875.657       16.6078        13.4502        17.3502      
      4800   307.86425     -44681.717     -3541.872       3875.657       16.6078        13.4502        17.3502      
      4900   308.26863     -44661.055     -10360.978      3875.657       16.6078        13.4502        17.3502      
      5000   291.35254     -44674.52      -5949.5597      3875.657       16.6078        13.4502        17.3502      
Loop time of 306.263 on 8 procs for 5000 steps with 386 atoms

Performance: 0.705 ns/day, 34.029 hours/ns, 16.326 timesteps/s, 6.302 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 246.23     | 252.69     | 259.78     |  24.6 | 82.51
Bond    | 0.0016574  | 0.0021266  | 0.0024521  |   0.5 |  0.00
Neigh   | 19.592     | 19.997     | 20.413     |   6.8 |  6.53
Comm    | 2.8147     | 9.922      | 16.407     | 124.6 |  3.24
Output  | 0.017791   | 0.020193   | 0.022306   |   1.0 |  0.01
Modify  | 23.079     | 23.51      | 23.933     |   6.6 |  7.68
Other   |            | 0.1208     |            |       |  0.04

Nlocal:          48.25 ave          60 max          40 min
Histogram: 1 1 2 0 1 1 0 1 0 1
Nghost:         3745.5 ave        3786 max        3707 min
Histogram: 2 2 0 0 0 0 0 1 2 1
Neighs:        33602.5 ave       41289 max       28091 min
Histogram: 1 1 2 0 1 1 0 1 0 1

Total # of neighbors = 268820
Ave neighs/atom = 696.42487
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*16.6078
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 1.66078 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.3 | 145.2 | 147.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   293.88258     -44672.085      13346.832      3875.657       16.6078        13.4502        17.3502      
       100   300.4302      -44655.377      1397.6637      3875.657       16.6078        13.4502        17.3502      
       200   320.72255     -44654.256      9645.3055      3875.657       16.6078        13.4502        17.3502      
       300   298.67163     -44647.851     -6899.0011      3875.657       16.6078        13.4502        17.3502      
       400   296.74076     -44671.36       335.8784       3875.657       16.6078        13.4502        17.3502      
       500   297.04226     -44679.603      7851.4426      3875.657       16.6078        13.4502        17.3502      
       600   301.42044     -44692.592      2026.9002      3875.657       16.6078        13.4502        17.3502      
       700   314.60738     -44707.327      1573.2751      3875.657       16.6078        13.4502        17.3502      
       800   290.03936     -44695.15       4048.6494      3875.657       16.6078        13.4502        17.3502      
       900   303.80308     -44726.439     -8415.8971      3875.657       16.6078        13.4502        17.3502      
      1000   296.86373     -44725.303      8697.6022      3875.657       16.6078        13.4502        17.3502      
      1100   294.1639      -44699.617      10900.267      3875.657       16.6078        13.4502        17.3502      
      1200   320.5575      -44693.785     -4552.1433      3875.657       16.6078        13.4502        17.3502      
      1300   308.00036     -44686.675      118.9979       3875.657       16.6078        13.4502        17.3502      
      1400   303.07705     -44704.854      937.64711      3875.657       16.6078        13.4502        17.3502      
      1500   293.98672     -44706.01       10880.313      3875.657       16.6078        13.4502        17.3502      
      1600   280.01412     -44683.337     -8082.0696      3875.657       16.6078        13.4502        17.3502      
      1700   306.49633     -44700.884     -5229.8035      3875.657       16.6078        13.4502        17.3502      
      1800   301.97906     -44691.024      14258.369      3875.657       16.6078        13.4502        17.3502      
      1900   312.24138     -44700.589      20592.488      3875.657       16.6078        13.4502        17.3502      
      2000   276.78619     -44668.574     -3023.0977      3875.657       16.6078        13.4502        17.3502      
      2100   276.02875     -44704.48       3383.7223      3875.657       16.6078        13.4502        17.3502      
      2200   300.93843     -44721.071      15024.143      3875.657       16.6078        13.4502        17.3502      
      2300   312.438       -44705.311      6512.4447      3875.657       16.6078        13.4502        17.3502      
      2400   299.7416      -44676.024      12079.043      3875.657       16.6078        13.4502        17.3502      
      2500   306.24611     -44671.35       8013.9642      3875.657       16.6078        13.4502        17.3502      
      2600   294.40653     -44676.056      4654.6054      3875.657       16.6078        13.4502        17.3502      
      2700   292.65221     -44695.093      13391.693      3875.657       16.6078        13.4502        17.3502      
      2800   307.35833     -44702.484      22636.659      3875.657       16.6078        13.4502        17.3502      
      2900   296.24907     -44675.548      1757.7088      3875.657       16.6078        13.4502        17.3502      
      3000   302.93083     -44671.599     -1472.2627      3875.657       16.6078        13.4502        17.3502      
      3100   288.36769     -44629.784     -2983.2877      3875.657       16.6078        13.4502        17.3502      
      3200   320.57172     -44649.468      2149.1181      3875.657       16.6078        13.4502        17.3502      
      3300   321.41557     -44676.021      20225.535      3875.657       16.6078        13.4502        17.3502      
      3400   293.44003     -44668.181     -1563.2897      3875.657       16.6078        13.4502        17.3502      
      3500   281.85378     -44664.539      8414.8542      3875.657       16.6078        13.4502        17.3502      
      3600   296.08183     -44679.652      14485.55       3875.657       16.6078        13.4502        17.3502      
      3700   297.50774     -44662.267      10642.953      3875.657       16.6078        13.4502        17.3502      
      3800   312.27108     -44648.859      5749.2494      3875.657       16.6078        13.4502        17.3502      
      3900   311.23062     -44651.607      4176.8915      3875.657       16.6078        13.4502        17.3502      
      4000   301.87158     -44662.45       9594.2762      3875.657       16.6078        13.4502        17.3502      
      4100   308.72313     -44676.9        15599.28       3875.657       16.6078        13.4502        17.3502      
      4200   298.60312     -44679.765      3029.8565      3875.657       16.6078        13.4502        17.3502      
      4300   299.5326      -44689.828      10292.009      3875.657       16.6078        13.4502        17.3502      
      4400   306.21689     -44695.171      12495.079      3875.657       16.6078        13.4502        17.3502      
      4500   285.71471     -44667.458      5221.3692      3875.657       16.6078        13.4502        17.3502      
      4600   314.31102     -44681.478      4780.4611      3875.657       16.6078        13.4502        17.3502      
      4700   311.53067     -44663.558     -2060.3502      3875.657       16.6078        13.4502        17.3502      
      4800   306.76801     -44671.114      9497.9298      3875.657       16.6078        13.4502        17.3502      
      4900   298.06066     -44678.679      7369.3365      3875.657       16.6078        13.4502        17.3502      
      5000   290.75651     -44669.454     -11662.462      3875.657       16.6078        13.4502        17.3502      
Loop time of 287.752 on 8 procs for 5000 steps with 386 atoms

Performance: 0.751 ns/day, 31.972 hours/ns, 17.376 timesteps/s, 6.707 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 236.82     | 239.82     | 243.84     |  15.3 | 83.34
Bond    | 0.0016807  | 0.0020924  | 0.0024314  |   0.5 |  0.00
Neigh   | 17.496     | 17.85      | 18.267     |   5.5 |  6.20
Comm    | 3.5976     | 7.6336     | 10.656     |  85.9 |  2.65
Output  | 0.017734   | 0.020358   | 0.022322   |   0.9 |  0.01
Modify  | 21.89      | 22.311     | 22.676     |   5.0 |  7.75
Other   |            | 0.1184     |            |       |  0.04

Nlocal:          48.25 ave          52 max          43 min
Histogram: 1 0 1 0 1 1 1 0 2 1
Nghost:        3519.62 ave        3569 max        3480 min
Histogram: 2 2 0 0 0 0 1 1 1 1
Neighs:        33594.9 ave       35929 max       30227 min
Histogram: 1 1 0 0 1 1 0 1 0 3

Total # of neighbors = 268759
Ave neighs/atom = 696.26684
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.4502
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz--1.0717)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.4502
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.94505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.10717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -0.00034
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -1.34502 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.2 | 145.2 | 147.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   293.88258     -44672.085      13346.832      3875.657       16.6078        13.4502        17.3502      
       100   300.39887     -44655.403      1391.9097      3875.657       16.6078        13.4502        17.3502      
       200   319.37198     -44651.437      12579.231      3875.657       16.6078        13.4502        17.3502      
       300   280.56458     -44629.513     -5950.6661      3875.657       16.6078        13.4502        17.3502      
       400   294.27881     -44674.132      1464.1825      3875.657       16.6078        13.4502        17.3502      
       500   287.10166     -44672.092      10576.109      3875.657       16.6078        13.4502        17.3502      
       600   299.56206     -44683.351      11444.177      3875.657       16.6078        13.4502        17.3502      
       700   313.71586     -44683.669     -4972.2092      3875.657       16.6078        13.4502        17.3502      
       800   316.57418     -44656.023      13413.128      3875.657       16.6078        13.4502        17.3502      
       900   325.55937     -44683.702      10279.856      3875.657       16.6078        13.4502        17.3502      
      1000   299.57333     -44686.106      7775.1124      3875.657       16.6078        13.4502        17.3502      
      1100   296.57461     -44685.526      3248.4286      3875.657       16.6078        13.4502        17.3502      
      1200   317.54642     -44714.424      7896.4429      3875.657       16.6078        13.4502        17.3502      
      1300   282.42213     -44687.719     -6787.893       3875.657       16.6078        13.4502        17.3502      
      1400   281.547       -44693.011      9784.3705      3875.657       16.6078        13.4502        17.3502      
      1500   303.127       -44695.836      3204.0135      3875.657       16.6078        13.4502        17.3502      
      1600   311.70376     -44677.101     -8880.0564      3875.657       16.6078        13.4502        17.3502      
      1700   314.16882     -44674.381     -9484.5387      3875.657       16.6078        13.4502        17.3502      
      1800   280.81861     -44670.289     -886.10637      3875.657       16.6078        13.4502        17.3502      
      1900   274.34323     -44680.591      12848.418      3875.657       16.6078        13.4502        17.3502      
      2000   284.10163     -44678.824      13194.733      3875.657       16.6078        13.4502        17.3502      
      2100   295.79127     -44672.943      10635.648      3875.657       16.6078        13.4502        17.3502      
      2200   313.56258     -44673.504      9974.1889      3875.657       16.6078        13.4502        17.3502      
      2300   313.49972     -44668.744      12995.174      3875.657       16.6078        13.4502        17.3502      
      2400   306.03821     -44697.583     -4254.718       3875.657       16.6078        13.4502        17.3502      
      2500   292.26871     -44702.034      7959.5003      3875.657       16.6078        13.4502        17.3502      
      2600   291.31948     -44708.531     -9378.5495      3875.657       16.6078        13.4502        17.3502      
      2700   288.84017     -44693.491      6809.7718      3875.657       16.6078        13.4502        17.3502      
      2800   301.01845     -44676.375      6810.4377      3875.657       16.6078        13.4502        17.3502      
      2900   313.8031      -44678.7       -1066.4701      3875.657       16.6078        13.4502        17.3502      
      3000   302.15367     -44691.155      22042.838      3875.657       16.6078        13.4502        17.3502      
      3100   309.27728     -44723.732      2705.3105      3875.657       16.6078        13.4502        17.3502      
      3200   305.66489     -44721.111      2053.1309      3875.657       16.6078        13.4502        17.3502      
      3300   303.49909     -44708.146      8112.3852      3875.657       16.6078        13.4502        17.3502      
      3400   297.88812     -44688.03       5908.3971      3875.657       16.6078        13.4502        17.3502      
      3500   310.75052     -44715.499      22442.254      3875.657       16.6078        13.4502        17.3502      
      3600   306.3106      -44739.238      8334.234       3875.657       16.6078        13.4502        17.3502      
      3700   298.50979     -44728.705      1713.9086      3875.657       16.6078        13.4502        17.3502      
      3800   300.27494     -44714.303     -1582.0412      3875.657       16.6078        13.4502        17.3502      
      3900   305.4611      -44701.954      4234.1985      3875.657       16.6078        13.4502        17.3502      
      4000   324.08429     -44687.937     -9151.3396      3875.657       16.6078        13.4502        17.3502      
      4100   307.3935      -44667.129      8715.5596      3875.657       16.6078        13.4502        17.3502      
      4200   306.77003     -44706.046      2716.7438      3875.657       16.6078        13.4502        17.3502      
      4300   303.66089     -44719.377      10572.336      3875.657       16.6078        13.4502        17.3502      
      4400   300.90667     -44728.862     -2720.7206      3875.657       16.6078        13.4502        17.3502      
      4500   290.96271     -44730.214     -1793.2871      3875.657       16.6078        13.4502        17.3502      
      4600   290.78868     -44731.471     -1313.6228      3875.657       16.6078        13.4502        17.3502      
      4700   293.53328     -44729.719      8719.527       3875.657       16.6078        13.4502        17.3502      
      4800   291.48714     -44697.185     -15316.52       3875.657       16.6078        13.4502        17.3502      
      4900   308.23228     -44697.295      8034.1274      3875.657       16.6078        13.4502        17.3502      
      5000   314.02466     -44718.933      5288.6211      3875.657       16.6078        13.4502        17.3502      
Loop time of 276.175 on 8 procs for 5000 steps with 386 atoms

Performance: 0.782 ns/day, 30.686 hours/ns, 18.104 timesteps/s, 6.988 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 159.2      | 199.37     | 232.99     | 216.1 | 72.19
Bond    | 0.0013284  | 0.0016236  | 0.0018205  |   0.4 |  0.00
Neigh   | 13.66      | 17.183     | 19.99      |  66.3 |  6.22
Comm    | 1.9348     | 35.563     | 75.684     | 511.2 | 12.88
Output  | 0.017053   | 0.019161   | 0.020989   |   0.8 |  0.01
Modify  | 21.078     | 23.936     | 27.519     |  56.8 |  8.67
Other   |            | 0.1023     |            |       |  0.04

Nlocal:          48.25 ave          55 max          44 min
Histogram: 3 0 1 2 0 0 0 0 0 2
Nghost:        3762.88 ave        3812 max        3722 min
Histogram: 1 1 2 0 0 0 2 1 0 1
Neighs:        33648.6 ave       38112 max       30810 min
Histogram: 3 0 1 2 0 0 0 0 1 1

Total # of neighbors = 269189
Ave neighs/atom = 697.38083
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.4502
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 1.34502 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.3 | 145.2 | 147.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   293.88258     -44672.085      13346.832      3875.657       16.6078        13.4502        17.3502      
       100   300.43721     -44655.313      1400.4719      3875.657       16.6078        13.4502        17.3502      
       200   322.73797     -44658.637      10900.857      3875.657       16.6078        13.4502        17.3502      
       300   296.47379     -44643.68      -8851.1979      3875.657       16.6078        13.4502        17.3502      
       400   304.38343     -44683.409      5101.3307      3875.657       16.6078        13.4502        17.3502      
       500   285.6489      -44670.059      16955.395      3875.657       16.6078        13.4502        17.3502      
       600   295.44494     -44685.067     -1395.8651      3875.657       16.6078        13.4502        17.3502      
       700   292.14096     -44675.716      6118.2294      3875.657       16.6078        13.4502        17.3502      
       800   297.32176     -44668.56       22963.523      3875.657       16.6078        13.4502        17.3502      
       900   306.53669     -44677.061      13474.529      3875.657       16.6078        13.4502        17.3502      
      1000   295.27599     -44686.163      1965.4995      3875.657       16.6078        13.4502        17.3502      
      1100   293.09336     -44694.943     -122.60098      3875.657       16.6078        13.4502        17.3502      
      1200   288.42584     -44685.292      6995.5834      3875.657       16.6078        13.4502        17.3502      
      1300   315.38294     -44673.05       5525.2557      3875.657       16.6078        13.4502        17.3502      
      1400   326.4177      -44677.546     -1009.3876      3875.657       16.6078        13.4502        17.3502      
      1500   301.13974     -44672.308      3094.7129      3875.657       16.6078        13.4502        17.3502      
      1600   291.25031     -44674.414      15801.165      3875.657       16.6078        13.4502        17.3502      
      1700   315.49081     -44714.054      9530.1721      3875.657       16.6078        13.4502        17.3502      
      1800   299.29253     -44703.965      825.8503       3875.657       16.6078        13.4502        17.3502      
      1900   268.25768     -44672.629      6618.699       3875.657       16.6078        13.4502        17.3502      
      2000   294.95086     -44671.306      254.27372      3875.657       16.6078        13.4502        17.3502      
      2100   309.12801     -44672.957      8794.2357      3875.657       16.6078        13.4502        17.3502      
      2200   298.09126     -44674.873      21553.113      3875.657       16.6078        13.4502        17.3502      
      2300   299.45657     -44698.094      17470.853      3875.657       16.6078        13.4502        17.3502      
      2400   282.87521     -44699.984      10701.447      3875.657       16.6078        13.4502        17.3502      
      2500   295.05752     -44697.859      8406.5803      3875.657       16.6078        13.4502        17.3502      
      2600   303.90687     -44656.595      3463.0316      3875.657       16.6078        13.4502        17.3502      
      2700   320.57926     -44676.155     -3264.0267      3875.657       16.6078        13.4502        17.3502      
      2800   291.26332     -44672.054     -1980.6445      3875.657       16.6078        13.4502        17.3502      
      2900   281.42492     -44672.931      11748.207      3875.657       16.6078        13.4502        17.3502      
      3000   304.06301     -44686.166      7421.5801      3875.657       16.6078        13.4502        17.3502      
      3100   312.26332     -44675.931      5134.6721      3875.657       16.6078        13.4502        17.3502      
      3200   307.72534     -44639.822     -3062.1088      3875.657       16.6078        13.4502        17.3502      
      3300   307.94673     -44650.216      4997.3822      3875.657       16.6078        13.4502        17.3502      
      3400   290.60018     -44670.927      6625.7333      3875.657       16.6078        13.4502        17.3502      
      3500   286.33809     -44669.08       9420.9591      3875.657       16.6078        13.4502        17.3502      
      3600   297.39373     -44681.181      19511.461      3875.657       16.6078        13.4502        17.3502      
      3700   293.50439     -44673.634      5315.6901      3875.657       16.6078        13.4502        17.3502      
      3800   309.48087     -44665.675      1644.0456      3875.657       16.6078        13.4502        17.3502      
      3900   322.81        -44666.012      1851.7405      3875.657       16.6078        13.4502        17.3502      
      4000   303.92945     -44670.621      2587.2831      3875.657       16.6078        13.4502        17.3502      
      4100   279.72826     -44671.705      7075.8327      3875.657       16.6078        13.4502        17.3502      
      4200   296.35194     -44684.855      59.167746      3875.657       16.6078        13.4502        17.3502      
      4300   290.06856     -44658.697      15713.532      3875.657       16.6078        13.4502        17.3502      
      4400   308.72489     -44653.636      4038.8488      3875.657       16.6078        13.4502        17.3502      
      4500   299.65933     -44645.211     -2351.4711      3875.657       16.6078        13.4502        17.3502      
      4600   292.89137     -44680.86       3876.2274      3875.657       16.6078        13.4502        17.3502      
      4700   284.79597     -44669.271      3920.4111      3875.657       16.6078        13.4502        17.3502      
      4800   285.59865     -44664.516      14417.794      3875.657       16.6078        13.4502        17.3502      
      4900   295.64135     -44656.507      4776.1965      3875.657       16.6078        13.4502        17.3502      
      5000   310.26585     -44646.283     -8866.369       3875.657       16.6078        13.4502        17.3502      
Loop time of 189.982 on 8 procs for 5000 steps with 386 atoms

Performance: 1.137 ns/day, 21.109 hours/ns, 26.318 timesteps/s, 10.159 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 144.39     | 150.45     | 158.07     |  41.6 | 79.19
Bond    | 0.0011462  | 0.0013405  | 0.0015957  |   0.4 |  0.00
Neigh   | 12.279     | 13.038     | 13.815     |  16.9 |  6.86
Comm    | 1.3106     | 8.9188     | 14.975     | 170.9 |  4.69
Output  | 0.011976   | 0.013887   | 0.015197   |   0.8 |  0.01
Modify  | 16.667     | 17.459     | 18.229     |  14.7 |  9.19
Other   |            | 0.09904    |            |       |  0.05

Nlocal:          48.25 ave          56 max          39 min
Histogram: 1 0 1 0 2 1 0 1 1 1
Nghost:         3523.5 ave        3542 max        3503 min
Histogram: 1 0 2 0 1 0 0 3 0 1
Neighs:        33598.2 ave       38679 max       27471 min
Histogram: 1 0 1 0 2 1 0 1 1 1

Total # of neighbors = 268786
Ave neighs/atom = 696.33679
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.3502
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--9.4505)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.3502
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.94505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.10717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -0.00034
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -1.73502 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.2 | 145.2 | 147.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   293.88258     -44672.085      13346.832      3875.657       16.6078        13.4502        17.3502      
       100   300.60246     -44655.796      1468.9409      3875.657       16.6078        13.4502        17.3502      
       200   320.43703     -44654.721      4369.718       3875.657       16.6078        13.4502        17.3502      
       300   302.82234     -44651.958     -12588.417      3875.657       16.6078        13.4502        17.3502      
       400   303.93555     -44680.552      5999.1214      3875.657       16.6078        13.4502        17.3502      
       500   297.58679     -44678.216      17143.135      3875.657       16.6078        13.4502        17.3502      
       600   302.76019     -44694.5       -494.07697      3875.657       16.6078        13.4502        17.3502      
       700   292.55392     -44692.441      6854.9988      3875.657       16.6078        13.4502        17.3502      
       800   298.66377     -44707.969      192.61132      3875.657       16.6078        13.4502        17.3502      
       900   294.15326     -44710.904      15693.492      3875.657       16.6078        13.4502        17.3502      
      1000   281.55955     -44685.725      1647.8759      3875.657       16.6078        13.4502        17.3502      
      1100   300.20213     -44668.71       4701.6925      3875.657       16.6078        13.4502        17.3502      
      1200   321.98894     -44681.806      7366.1697      3875.657       16.6078        13.4502        17.3502      
      1300   302.17661     -44679.285      4304.6851      3875.657       16.6078        13.4502        17.3502      
      1400   314.3647      -44706.736      2566.9878      3875.657       16.6078        13.4502        17.3502      
      1500   300.09685     -44692.195     -5690.0206      3875.657       16.6078        13.4502        17.3502      
      1600   297.52445     -44686.309      9764.1751      3875.657       16.6078        13.4502        17.3502      
      1700   303.53709     -44687.48       13333.644      3875.657       16.6078        13.4502        17.3502      
      1800   302.21188     -44688.912     -3920.4238      3875.657       16.6078        13.4502        17.3502      
      1900   294.05344     -44674.672      17852.891      3875.657       16.6078        13.4502        17.3502      
      2000   304.40928     -44689.304      22093.944      3875.657       16.6078        13.4502        17.3502      
      2100   289.0869      -44691.073     -589.0776       3875.657       16.6078        13.4502        17.3502      
      2200   297.98702     -44705.912      11013.46       3875.657       16.6078        13.4502        17.3502      
      2300   292.58124     -44679.57       9447.5271      3875.657       16.6078        13.4502        17.3502      
      2400   316.35384     -44664.532      6996.6342      3875.657       16.6078        13.4502        17.3502      
      2500   314.32901     -44670.229      5901.7128      3875.657       16.6078        13.4502        17.3502      
      2600   282.88961     -44654.121      9683.9595      3875.657       16.6078        13.4502        17.3502      
      2700   282.66537     -44659.053      6511.7688      3875.657       16.6078        13.4502        17.3502      
      2800   308.15823     -44696.765      3137.7265      3875.657       16.6078        13.4502        17.3502      
      2900   297.8129      -44692.53       14510.748      3875.657       16.6078        13.4502        17.3502      
      3000   297.70907     -44684.583      1097.1786      3875.657       16.6078        13.4502        17.3502      
      3100   330.89288     -44677.955      3644.41        3875.657       16.6078        13.4502        17.3502      
      3200   324.5987      -44661.851      8673.0264      3875.657       16.6078        13.4502        17.3502      
      3300   277.96676     -44634.916     -333.80301      3875.657       16.6078        13.4502        17.3502      
      3400   316.01278     -44691.897     -269.03003      3875.657       16.6078        13.4502        17.3502      
      3500   294.08739     -44670.426      6511.4187      3875.657       16.6078        13.4502        17.3502      
      3600   303.38069     -44665.591      1718.5519      3875.657       16.6078        13.4502        17.3502      
      3700   308.80309     -44659.092     -6652.5162      3875.657       16.6078        13.4502        17.3502      
      3800   324.20006     -44660.033     -4659.0193      3875.657       16.6078        13.4502        17.3502      
      3900   306.60159     -44654.53       5955.2379      3875.657       16.6078        13.4502        17.3502      
      4000   293.01281     -44665.507      1349.3938      3875.657       16.6078        13.4502        17.3502      
      4100   285.52706     -44664.659      5730.3681      3875.657       16.6078        13.4502        17.3502      
      4200   287.29514     -44673.912      18005.922      3875.657       16.6078        13.4502        17.3502      
      4300   289.77724     -44689.243      15089.674      3875.657       16.6078        13.4502        17.3502      
      4400   298.08845     -44685.465      697.80311      3875.657       16.6078        13.4502        17.3502      
      4500   314.25893     -44668.473      7789.496       3875.657       16.6078        13.4502        17.3502      
      4600   313.4851      -44666.79      -2016.1657      3875.657       16.6078        13.4502        17.3502      
      4700   283.31976     -44659.118      60.914654      3875.657       16.6078        13.4502        17.3502      
      4800   273.37362     -44652.79       17714.462      3875.657       16.6078        13.4502        17.3502      
      4900   304.79092     -44690.659      10480.079      3875.657       16.6078        13.4502        17.3502      
      5000   298.43851     -44683.544      9412.6409      3875.657       16.6078        13.4502        17.3502      
Loop time of 182.277 on 8 procs for 5000 steps with 386 atoms

Performance: 1.185 ns/day, 20.253 hours/ns, 27.431 timesteps/s, 10.588 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 140.96     | 146.14     | 149.43     |  21.4 | 80.17
Bond    | 0.00094144 | 0.0011587  | 0.0013596  |   0.4 |  0.00
Neigh   | 13.968     | 14.297     | 14.693     |   7.4 |  7.84
Comm    | 1.7406     | 5.0223     | 10.212     | 115.5 |  2.76
Output  | 0.010607   | 0.012204   | 0.013505   |   0.8 |  0.01
Modify  | 16.307     | 16.706     | 17.04      |   6.8 |  9.17
Other   |            | 0.1016     |            |       |  0.06

Nlocal:          48.25 ave          56 max          44 min
Histogram: 2 2 0 1 0 2 0 0 0 1
Nghost:           3943 ave        3967 max        3906 min
Histogram: 1 1 0 0 0 0 1 3 1 1
Neighs:        33627.4 ave       38736 max       30718 min
Histogram: 1 3 0 1 0 2 0 0 0 1

Total # of neighbors = 269019
Ave neighs/atom = 696.94041
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.3502
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 1.73502 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.3 | 145.2 | 147.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   293.88258     -44672.085      13346.832      3875.657       16.6078        13.4502        17.3502      
       100   300.49588     -44655.332      1645.1348      3875.657       16.6078        13.4502        17.3502      
       200   321.79364     -44652.3        9655.5393      3875.657       16.6078        13.4502        17.3502      
       300   285.53983     -44638.119     -9586.4339      3875.657       16.6078        13.4502        17.3502      
       400   304.31457     -44678.145      10140.653      3875.657       16.6078        13.4502        17.3502      
       500   294.52061     -44682.21       6663.046       3875.657       16.6078        13.4502        17.3502      
       600   280.61936     -44673.76      -1371.8858      3875.657       16.6078        13.4502        17.3502      
       700   302.09977     -44681.046      145.29782      3875.657       16.6078        13.4502        17.3502      
       800   327.01077     -44676.453     -2847.4471      3875.657       16.6078        13.4502        17.3502      
       900   319.12044     -44674.289      8599.2268      3875.657       16.6078        13.4502        17.3502      
      1000   299.83047     -44673.526      6794.1521      3875.657       16.6078        13.4502        17.3502      
      1100   299.26023     -44678.456      2790.0798      3875.657       16.6078        13.4502        17.3502      
      1200   309.03691     -44695.625      15654.954      3875.657       16.6078        13.4502        17.3502      
      1300   307.64378     -44709.484      10492.306      3875.657       16.6078        13.4502        17.3502      
      1400   279.64751     -44684.162      7131.71        3875.657       16.6078        13.4502        17.3502      
      1500   314.35306     -44681.66       3801.3891      3875.657       16.6078        13.4502        17.3502      
      1600   311.03835     -44654.297     -7118.34        3875.657       16.6078        13.4502        17.3502      
      1700   307.67572     -44665.754      3588.7012      3875.657       16.6078        13.4502        17.3502      
      1800   284.39221     -44656.093      3669.1517      3875.657       16.6078        13.4502        17.3502      
      1900   281.11803     -44649.318      6570.4002      3875.657       16.6078        13.4502        17.3502      
      2000   301.58124     -44673.497     -392.36718      3875.657       16.6078        13.4502        17.3502      
      2100   291.67626     -44676.043     -7449.3589      3875.657       16.6078        13.4502        17.3502      
      2200   306.19999     -44688.491     -2548.7936      3875.657       16.6078        13.4502        17.3502      
      2300   301.09543     -44656.458      1752.9375      3875.657       16.6078        13.4502        17.3502      
      2400   312.98257     -44628.304      5112.6229      3875.657       16.6078        13.4502        17.3502      
      2500   321.98428     -44665.147     -1529.5387      3875.657       16.6078        13.4502        17.3502      
      2600   301.4639      -44674.404      959.89629      3875.657       16.6078        13.4502        17.3502      
      2700   318.70783     -44722.614      1220.793       3875.657       16.6078        13.4502        17.3502      
      2800   281.75369     -44700.555     -4851.5083      3875.657       16.6078        13.4502        17.3502      
      2900   263.1708      -44680.31      -2441.3094      3875.657       16.6078        13.4502        17.3502      
      3000   312.11414     -44714.645      7858.7323      3875.657       16.6078        13.4502        17.3502      
      3100   309.27557     -44682.144      1079.5503      3875.657       16.6078        13.4502        17.3502      
      3200   306.40367     -44680.606     -752.34892      3875.657       16.6078        13.4502        17.3502      
      3300   304.16304     -44704.229      4587.7413      3875.657       16.6078        13.4502        17.3502      
      3400   311.89744     -44724.233      5391.4641      3875.657       16.6078        13.4502        17.3502      
      3500   282.30575     -44694.551      14670.578      3875.657       16.6078        13.4502        17.3502      
      3600   304.87693     -44705.602     -594.65404      3875.657       16.6078        13.4502        17.3502      
      3700   330.52751     -44709.291     -10269.047      3875.657       16.6078        13.4502        17.3502      
      3800   302.77803     -44647.727      7056.9607      3875.657       16.6078        13.4502        17.3502      
      3900   324.33248     -44677.724      6780.1124      3875.657       16.6078        13.4502        17.3502      
      4000   296.81336     -44672.26       8285.9962      3875.657       16.6078        13.4502        17.3502      
      4100   307.56248     -44688.562      7656.5026      3875.657       16.6078        13.4502        17.3502      
      4200   310.2838      -44694.197      6475.0067      3875.657       16.6078        13.4502        17.3502      
      4300   307.93794     -44707.282      2221.1247      3875.657       16.6078        13.4502        17.3502      
      4400   278.03875     -44690.451      273.72345      3875.657       16.6078        13.4502        17.3502      
      4500   301.78385     -44702.987     -1718.4048      3875.657       16.6078        13.4502        17.3502      
      4600   291.00033     -44672.462      1874.8085      3875.657       16.6078        13.4502        17.3502      
      4700   276.90611     -44649.294     -191.75676      3875.657       16.6078        13.4502        17.3502      
      4800   306.30395     -44685.061      1621.6128      3875.657       16.6078        13.4502        17.3502      
      4900   294.67648     -44684.28      -761.04019      3875.657       16.6078        13.4502        17.3502      
      5000   285.1661      -44702.561     -1581.2138      3875.657       16.6078        13.4502        17.3502      
Loop time of 151.39 on 8 procs for 5000 steps with 386 atoms

Performance: 1.427 ns/day, 16.821 hours/ns, 33.027 timesteps/s, 12.749 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 116.68     | 118.66     | 122.43     |  16.7 | 78.38
Bond    | 0.00080705 | 0.00093475 | 0.0011297  |   0.0 |  0.00
Neigh   | 11.96      | 12.268     | 12.577     |   7.4 |  8.10
Comm    | 1.0133     | 4.774      | 6.7644     |  83.3 |  3.15
Output  | 0.011502   | 0.013064   | 0.014337   |   0.7 |  0.01
Modify  | 15.285     | 15.582     | 15.881     |   6.5 | 10.29
Other   |            | 0.08996    |            |       |  0.06

Nlocal:          48.25 ave          59 max          42 min
Histogram: 2 1 2 0 0 1 0 1 0 1
Nghost:        3572.25 ave        3600 max        3550 min
Histogram: 2 0 1 1 1 1 0 0 0 2
Neighs:        33574.4 ave       40629 max       29499 min
Histogram: 2 1 2 0 0 1 0 1 0 1

Total # of neighbors = 268595
Ave neighs/atom = 695.84197
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:57:53
