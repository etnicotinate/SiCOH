LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.1                  # the deformation magnitude 0.01

# Read the initial sctructure
# box tilt large
variable structure string 333-RV-32-vasp
read_data       ${structure}.data
read_data       333-RV-32-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.007 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 5.27126e-05 on 8 procs for 1 steps with 331 atoms

51.5% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.31e-07   | 2.0638e-07 | 3.24e-07   |   0.0 |  0.39
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 9.8e-07    | 1.195e-06  | 1.67e-06   |   0.0 |  2.27
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 5.131e-05  |            |       | 97.34

Nlocal:         41.375 ave          44 max          36 min
Histogram: 1 0 0 0 0 1 1 2 2 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-RV-32-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 5000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = 27.88 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.6 | 129.1 | 130.3 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -34729.82       144799.92      1.400369       3602.6891    
       100   683.66303     -35479.052     -48952.942      1.400369       3602.6891    
       200   557.24668     -35756.544     -838.30449      1.400369       3602.6891    
       300   515.08152     -36024.756     -5808.8384      1.400369       3602.6891    
       400   395.61044     -36139.869      1395.4697      1.400369       3602.6891    
       500   318.9385      -36218.976     -2853.1074      1.400369       3602.6891    
       600   284.58968     -36279.633      5524.3292      1.400369       3602.6891    
       700   285.48872     -36328.483      6216.625       1.400369       3602.6891    
       800   288.55366     -36341.687      2559.8857      1.400369       3602.6891    
       900   322.34913     -36379.972     -4094.4895      1.400369       3602.6891    
      1000   295.99187     -36379.935     -5670.8963      1.400369       3602.6891    
      1100   282.57744     -36389.632     -7174.3333      1.400369       3602.6891    
      1200   297.28283     -36410.028      6527.6548      1.400369       3602.6891    
      1300   303.26915     -36411.976     -7382.3597      1.400369       3602.6891    
      1400   308.31364     -36403.592      116.35074      1.400369       3602.6891    
      1500   315.73557     -36410.382      329.37542      1.400369       3602.6891    
      1600   299.53601     -36415.528      1486.4851      1.400369       3602.6891    
      1700   290.05467     -36434.971      1072.1344      1.400369       3602.6891    
      1800   295.7381      -36463.807      6978.3378      1.400369       3602.6891    
      1900   285.26095     -36458.835     -12195.951      1.400369       3602.6891    
      2000   285.14666     -36441.433      6852.6924      1.400369       3602.6891    
      2100   303.76878     -36433.79      -1863.1267      1.400369       3602.6891    
      2200   295.01381     -36416.532      12889.822      1.400369       3602.6891    
      2300   321.788       -36454.543     -2963.6295      1.400369       3602.6891    
      2400   282.77026     -36453.697     -9688.1937      1.400369       3602.6891    
      2500   271.13023     -36470.617     -2297.1504      1.400369       3602.6891    
      2600   293.87403     -36495.424     -8256.1311      1.400369       3602.6891    
      2700   311.72014     -36493         -15391.179      1.400369       3602.6891    
      2800   312.48503     -36475.447      13835.569      1.400369       3602.6891    
      2900   314.4891      -36475.978     -10566.912      1.400369       3602.6891    
      3000   288.05611     -36468.165     -16904.071      1.400369       3602.6891    
      3100   296.7059      -36497.808     -11388.907      1.400369       3602.6891    
      3200   291.11334     -36508.33       4515.0434      1.400369       3602.6891    
      3300   303.02085     -36509.378     -6216.2031      1.400369       3602.6891    
      3400   301.17648     -36488.002     -6959.3366      1.400369       3602.6891    
      3500   301.99434     -36475.015      7370.0909      1.400369       3602.6891    
      3600   307.53294     -36482.069      1285.5969      1.400369       3602.6891    
      3700   307.0974      -36489.135     -2053.6214      1.400369       3602.6891    
      3800   304.40914     -36509.169     -19860.589      1.400369       3602.6891    
      3900   283.1652      -36513.246     -12408.68       1.400369       3602.6891    
      4000   291.62522     -36532.946     -9344.9913      1.400369       3602.6891    
      4100   292.20626     -36526.95       460.26733      1.400369       3602.6891    
      4200   309.68697     -36523.254      3688.3233      1.400369       3602.6891    
      4300   304.44366     -36502.296      11106.863      1.400369       3602.6891    
      4400   313.14484     -36510.24      -8652.4331      1.400369       3602.6891    
      4500   296.23558     -36521.107      9220.4699      1.400369       3602.6891    
      4600   288.69674     -36528.703     -722.30585      1.400369       3602.6891    
      4700   284.99991     -36524.589     -15401.216      1.400369       3602.6891    
      4800   319.79691     -36538.995     -2901.7047      1.400369       3602.6891    
      4900   303.90765     -36507.489     -12350.171      1.400369       3602.6891    
      5000   288.04827     -36506.702      7223.8937      1.400369       3602.6891    
Loop time of 239.266 on 8 procs for 5000 steps with 331 atoms

Performance: 0.903 ns/day, 26.585 hours/ns, 20.897 timesteps/s, 6.917 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 130.72     | 177.55     | 199.52     | 188.3 | 74.21
Bond    | 0.0016556  | 0.0019847  | 0.0022891  |   0.4 |  0.00
Neigh   | 10.694     | 14.011     | 15.295     |  50.9 |  5.86
Comm    | 3.7176     | 25.684     | 72.519     | 495.1 | 10.73
Output  | 0.002975   | 0.0032797  | 0.0049455  |   1.1 |  0.00
Modify  | 20.621     | 21.92      | 25.242     |  41.0 |  9.16
Other   |            | 0.09569    |            |       |  0.04

Nlocal:         41.375 ave          51 max          33 min
Histogram: 1 1 0 0 2 1 2 0 0 1
Nghost:        3260.62 ave        3309 max        3224 min
Histogram: 2 1 1 1 0 0 0 1 0 2
Neighs:        26626.9 ave       32522 max       21574 min
Histogram: 1 1 0 0 2 3 0 0 0 1

Total # of neighbors = 213015
Ave neighs/atom = 643.54985
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333-RV-32-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.7087
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.0868
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.5248

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal -2.0056
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal -0.1458
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -8.2042

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 15.7087
variable dlen equal lx-${len0}
variable dlen equal lx-15.7087
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*15.7087
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.2042000000000001592, deltaxy = 0.82042
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.14580000000000001292, deltaxz = 0.01458
print "yz = $(yz), deltayz = ${deltayz}"
yz = -2.0055999999999998273, deltayz = 0.20056
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.57087 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.57087 xy delta 0.82042 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -1.57087 xy delta 0.82042 xz delta 0.01458 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.1 | 126.5 | 128.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.04827     -36506.702      7223.9         3602.6891      15.7087        13.0868        17.5248      
       100   282.21284     -36525.559      254.85988      3595.4837      15.677283      13.0868        17.5248      
       200   289.42078     -36524.825     -12877.489      3588.2783      15.645865      13.0868        17.5248      
       300   295.92923     -36526.212     -7833.9272      3581.0729      15.614448      13.0868        17.5248      
       400   311.59305     -36545.669     -1140.6591      3573.8676      15.58303       13.0868        17.5248      
       500   294.9571      -36537.07      -9335.383       3566.6622      15.551613      13.0868        17.5248      
       600   283.43365     -36528.425     -9622.7098      3559.4568      15.520196      13.0868        17.5248      
       700   294.76497     -36525.122     -17736.994      3552.2514      15.488778      13.0868        17.5248      
       800   327.55372     -36527.806     -2286.5276      3545.046       15.457361      13.0868        17.5248      
       900   309.89611     -36515.29      -6188.2525      3537.8407      15.425943      13.0868        17.5248      
      1000   275.1752      -36505.553     -2895.0581      3530.6353      15.394526      13.0868        17.5248      
      1100   292.05437     -36513.151      3857.1409      3523.4299      15.363109      13.0868        17.5248      
      1200   301.32792     -36526.366     -2978.4763      3516.2245      15.331691      13.0868        17.5248      
      1300   298.87226     -36545.953      3078.0891      3509.0191      15.300274      13.0868        17.5248      
      1400   293.47571     -36550.197     -4095.4638      3501.8138      15.268856      13.0868        17.5248      
      1500   284.64818     -36536.344     -15333.753      3494.6084      15.237439      13.0868        17.5248      
      1600   294.80417     -36541          6721.5858      3487.403       15.206022      13.0868        17.5248      
      1700   290.16418     -36527.336      2950.0139      3480.1976      15.174604      13.0868        17.5248      
      1800   305.08713     -36534.74       4844.0313      3472.9923      15.143187      13.0868        17.5248      
      1900   317.78978     -36530.554      15768.39       3465.7869      15.111769      13.0868        17.5248      
      2000   330.82037     -36553.785      8487.3563      3458.5815      15.080352      13.0868        17.5248      
      2100   289.12454     -36533.367      16222.085      3451.3761      15.048935      13.0868        17.5248      
      2200   271.27995     -36522.549     -722.59329      3444.1707      15.017517      13.0868        17.5248      
      2300   301.93954     -36548.796      8162.3751      3436.9654      14.9861        13.0868        17.5248      
      2400   290.95207     -36526.897     -4617.8762      3429.76        14.954682      13.0868        17.5248      
      2500   315.25223     -36530.292      4379.6141      3422.5546      14.923265      13.0868        17.5248      
      2600   311.99925     -36505.656     -6590.1646      3415.3492      14.891848      13.0868        17.5248      
      2700   319.02615     -36521.118      6799.9996      3408.1439      14.86043       13.0868        17.5248      
      2800   295.57531     -36526.601      4686.5886      3400.9385      14.829013      13.0868        17.5248      
      2900   315.80541     -36543.566      15089.897      3393.7331      14.797595      13.0868        17.5248      
      3000   286.26351     -36521.759      5176.6708      3386.5277      14.766178      13.0868        17.5248      
      3100   283.43785     -36529.804      11897.994      3379.3223      14.734761      13.0868        17.5248      
      3200   279.99472     -36531.609      16270.799      3372.117       14.703343      13.0868        17.5248      
      3300   280.57101     -36527.053      8178.8071      3364.9116      14.671926      13.0868        17.5248      
      3400   307.71407     -36537.937      2909.3631      3357.7062      14.640508      13.0868        17.5248      
      3500   309.79835     -36539.652     -10293.792      3350.5008      14.609091      13.0868        17.5248      
      3600   292.54385     -36527.119      5314.6355      3343.2955      14.577674      13.0868        17.5248      
      3700   310.15388     -36538.101      14644.346      3336.0901      14.546256      13.0868        17.5248      
      3800   287.64431     -36526.921      15793.563      3328.8847      14.514839      13.0868        17.5248      
      3900   290.89301     -36542.742     -8060.6103      3321.6793      14.483421      13.0868        17.5248      
      4000   291.82818     -36539.19       2434.6571      3314.4739      14.452004      13.0868        17.5248      
      4100   299.39771     -36524.458      15670.556      3307.2686      14.420587      13.0868        17.5248      
      4200   328.3198      -36511.222      12993.814      3300.0632      14.389169      13.0868        17.5248      
      4300   317.49831     -36507.486      8895.119       3292.8578      14.357752      13.0868        17.5248      
      4400   302.50514     -36510.471      21137.588      3285.6524      14.326334      13.0868        17.5248      
      4500   303.00505     -36508.271      3879.5696      3278.447       14.294917      13.0868        17.5248      
      4600   301.38593     -36514.234      7283.0213      3271.2417      14.2635        13.0868        17.5248      
      4700   295.6231      -36517.917      13055.902      3264.0363      14.232082      13.0868        17.5248      
      4800   289.05434     -36521.663      13886.915      3256.8309      14.200665      13.0868        17.5248      
      4900   291.01129     -36536.293     -9666.2779      3249.6255      14.169247      13.0868        17.5248      
      5000   289.13877     -36545.981      5085.2121      3242.4202      14.13783       13.0868        17.5248      
Loop time of 265.589 on 8 procs for 5000 steps with 331 atoms

Performance: 0.813 ns/day, 29.510 hours/ns, 18.826 timesteps/s, 6.231 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 171.06     | 198.27     | 219.82     | 115.2 | 74.65
Bond    | 0.0016627  | 0.0020394  | 0.0024962  |   0.6 |  0.00
Neigh   | 15.27      | 17.256     | 18.631     |  29.6 |  6.50
Comm    | 3.7105     | 25.259     | 52.505     | 323.1 |  9.51
Output  | 0.016998   | 0.019768   | 0.021603   |   1.2 |  0.01
Modify  | 23.331     | 24.679     | 26.655     |  24.6 |  9.29
Other   |            | 0.1022     |            |       |  0.04

Nlocal:         41.375 ave          50 max          36 min
Histogram: 4 0 0 0 0 1 0 2 0 1
Nghost:        3477.38 ave        3535 max        3420 min
Histogram: 1 1 1 0 1 0 2 0 0 2
Neighs:        29646.5 ave       35417 max       25953 min
Histogram: 4 0 0 0 1 0 0 1 1 1

Total # of neighbors = 237172
Ave neighs/atom = 716.53172
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*15.7087
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.57087 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.57087 xy delta -0.82042 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 1.57087 xy delta -0.82042 xz delta -0.01458 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.1 | 126.6 | 128.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.04827     -36506.702      7223.9         3602.6891      15.7087        13.0868        17.5248      
       100   282.35547     -36526          269.84497      3609.8944      15.740117      13.0868        17.5248      
       200   291.82116     -36523.241     -9732.2155      3617.0998      15.771535      13.0868        17.5248      
       300   300.33028     -36520.663     -13070.012      3624.3052      15.802952      13.0868        17.5248      
       400   306.37344     -36532.909     -3435.2548      3631.5106      15.83437       13.0868        17.5248      
       500   292.18823     -36526.061     -3042.267       3638.716       15.865787      13.0868        17.5248      
       600   286.51572     -36524.938     -6611.9483      3645.9213      15.897204      13.0868        17.5248      
       700   315.28819     -36538.179     -8419.8864      3653.1267      15.928622      13.0868        17.5248      
       800   309.50009     -36509.52      -10653.079      3660.3321      15.960039      13.0868        17.5248      
       900   311.6064      -36488.382     -12358.885      3667.5375      15.991457      13.0868        17.5248      
      1000   328.14423     -36531.558      941.07824      3674.7428      16.022874      13.0868        17.5248      
      1100   291.00426     -36513.513     -11630.715      3681.9482      16.054291      13.0868        17.5248      
      1200   279.07921     -36505.374     -1796.7693      3689.1536      16.085709      13.0868        17.5248      
      1300   289.64444     -36514.658     -8934.7318      3696.359       16.117126      13.0868        17.5248      
      1400   293.60483     -36527.66      -6939.7822      3703.5644      16.148544      13.0868        17.5248      
      1500   300.78368     -36545.113     -12622.704      3710.7697      16.179961      13.0868        17.5248      
      1600   290.97311     -36542.661     -13210.29       3717.9751      16.211378      13.0868        17.5248      
      1700   297.7343      -36526.02      -5889.5126      3725.1805      16.242796      13.0868        17.5248      
      1800   320.48519     -36515.927      4117.2458      3732.3859      16.274213      13.0868        17.5248      
      1900   311.29329     -36510.76      -10928.918      3739.5912      16.305631      13.0868        17.5248      
      2000   286.1202      -36495.088     -10220.278      3746.7966      16.337048      13.0868        17.5248      
      2100   286.05415     -36494.188     -9861.6707      3754.002       16.368465      13.0868        17.5248      
      2200   281.24308     -36500.352      3037.1456      3761.2074      16.399883      13.0868        17.5248      
      2300   273.90703     -36528.651     -10136.265      3768.4128      16.4313        13.0868        17.5248      
      2400   266.88208     -36523.253     -9978.0574      3775.6181      16.462718      13.0868        17.5248      
      2500   300.40795     -36528.355     -10713.81       3782.8235      16.494135      13.0868        17.5248      
      2600   307.30553     -36507.703     -10349.669      3790.0289      16.525552      13.0868        17.5248      
      2700   307.57402     -36494.769     -290.73103      3797.2343      16.55697       13.0868        17.5248      
      2800   296.16355     -36502.984     -13123.739      3804.4397      16.588387      13.0868        17.5248      
      2900   291.75847     -36517.32       771.99233      3811.645       16.619805      13.0868        17.5248      
      3000   285.37964     -36500.563     -19793.443      3818.8504      16.651222      13.0868        17.5248      
      3100   317.47005     -36514.337     -8417.7553      3826.0558      16.682639      13.0868        17.5248      
      3200   283.85023     -36476.815     -17841.888      3833.2612      16.714057      13.0868        17.5248      
      3300   293.69571     -36500.612     -2750.5714      3840.4665      16.745474      13.0868        17.5248      
      3400   295.64282     -36508.783     -8898.4658      3847.6719      16.776892      13.0868        17.5248      
      3500   293.4388      -36497.406     -21088.742      3854.8773      16.808309      13.0868        17.5248      
      3600   321.81653     -36498.664     -4249.9968      3862.0827      16.839726      13.0868        17.5248      
      3700   306.4796      -36455.758     -7228.5751      3869.2881      16.871144      13.0868        17.5248      
      3800   310.73257     -36474.996     -13065.887      3876.4934      16.902561      13.0868        17.5248      
      3900   300.41511     -36491.937     -13438.627      3883.6988      16.933979      13.0868        17.5248      
      4000   290.27044     -36490.971     -18399.291      3890.9042      16.965396      13.0868        17.5248      
      4100   290.67844     -36491.553     -8336.3351      3898.1096      16.996813      13.0868        17.5248      
      4200   309.24021     -36496.891     -9573.0501      3905.3149      17.028231      13.0868        17.5248      
      4300   315.33956     -36469.495     -14075.666      3912.5203      17.059648      13.0868        17.5248      
      4400   330.6317      -36475.317     -8538.7776      3919.7257      17.091066      13.0868        17.5248      
      4500   302.33349     -36479.875     -6932.0659      3926.9311      17.122483      13.0868        17.5248      
      4600   308.269       -36498.765     -12988.319      3934.1365      17.1539        13.0868        17.5248      
      4700   319.36104     -36509.671     -7333.2118      3941.3418      17.185318      13.0868        17.5248      
      4800   288.82977     -36497.139     -12216.767      3948.5472      17.216735      13.0868        17.5248      
      4900   281.12238     -36499.223     -6258.607       3955.7526      17.248153      13.0868        17.5248      
      5000   296.1744      -36500.612     -26453.69       3962.958       17.27957       13.0868        17.5248      
Loop time of 226.247 on 8 procs for 5000 steps with 331 atoms

Performance: 0.955 ns/day, 25.139 hours/ns, 22.100 timesteps/s, 7.315 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 121.02     | 166.78     | 186.84     | 190.9 | 73.71
Bond    | 0.0016432  | 0.0019701  | 0.0024305  |   0.5 |  0.00
Neigh   | 10.244     | 13.681     | 14.876     |  52.1 |  6.05
Comm    | 3.3744     | 23.458     | 69.232     | 509.0 | 10.37
Output  | 0.017205   | 0.019797   | 0.021701   |   1.1 |  0.01
Modify  | 21.019     | 22.212     | 25.645     |  41.1 |  9.82
Other   |            | 0.09802    |            |       |  0.04

Nlocal:         41.375 ave          48 max          29 min
Histogram: 1 0 1 0 0 1 0 2 1 2
Nghost:         3026.5 ave        3061 max        2992 min
Histogram: 1 1 0 1 1 0 2 0 1 1
Neighs:        24146.8 ave       27690 max       17403 min
Histogram: 1 0 1 0 0 1 0 1 2 2

Total # of neighbors = 193174
Ave neighs/atom = 583.60725
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.0868
variable dlen equal ly-${len0}
variable dlen equal ly-13.0868
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.0868
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.2042000000000001592, deltaxy = 0.82042
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.14580000000000001292, deltaxz = 0.01458
print "yz = $(yz), deltayz = ${deltayz}"
yz = -2.0055999999999998273, deltayz = 0.20056
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.30868 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -1.30868 yz delta 0.20056 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.1 | 126.5 | 128.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.04827     -36506.702      7223.9         3602.6891      15.7087        13.0868        17.5248      
       100   282.46243     -36525.458      278.66096      3595.4837      15.7087        13.060626      17.5248      
       200   292.4213      -36526.745     -5402.2795      3588.2783      15.7087        13.034453      17.5248      
       300   290.06849     -36517.391     -5591.4993      3581.0729      15.7087        13.008279      17.5248      
       400   312.99759     -36543.232      1323.5925      3573.8676      15.7087        12.982106      17.5248      
       500   297.22581     -36535.499     -6790.1028      3566.6622      15.7087        12.955932      17.5248      
       600   291.48173     -36534.049     -4713.5222      3559.4568      15.7087        12.929758      17.5248      
       700   329.50728     -36556.894     -631.2008       3552.2514      15.7087        12.903585      17.5248      
       800   315.807       -36526.98      -14954.999      3545.046       15.7087        12.877411      17.5248      
       900   298.27174     -36504.395     -5534.6718      3537.8407      15.7087        12.851238      17.5248      
      1000   285.2743      -36520.118      873.13528      3530.6353      15.7087        12.825064      17.5248      
      1100   284.78923     -36536.989     -6701.5243      3523.4299      15.7087        12.79889       17.5248      
      1200   310.81948     -36558.137     -853.14357      3516.2245      15.7087        12.772717      17.5248      
      1300   287.98755     -36521.806      7121.5232      3509.0191      15.7087        12.746543      17.5248      
      1400   315.81915     -36511.675      5628.3844      3501.8138      15.7087        12.72037       17.5248      
      1500   319.98511     -36506.525      5823.4956      3494.6084      15.7087        12.694196      17.5248      
      1600   317.04375     -36538.977      2299.3426      3487.403       15.7087        12.668022      17.5248      
      1700   293.01247     -36529.159      341.28865      3480.1976      15.7087        12.641849      17.5248      
      1800   288.43262     -36536.36       441.05743      3472.9923      15.7087        12.615675      17.5248      
      1900   297.42662     -36543.617     -10341.11       3465.7869      15.7087        12.589502      17.5248      
      2000   290.53892     -36538.705     -156.67107      3458.5815      15.7087        12.563328      17.5248      
      2100   282.72462     -36555.337      1366.5841      3451.3761      15.7087        12.537154      17.5248      
      2200   289.46746     -36563.554     -8141.2952      3444.1707      15.7087        12.510981      17.5248      
      2300   293.74605     -36546.572      3730.0303      3436.9654      15.7087        12.484807      17.5248      
      2400   315.28217     -36527.024     -1394.9576      3429.76        15.7087        12.458634      17.5248      
      2500   314.28031     -36530.478     -5951.3841      3422.5546      15.7087        12.43246       17.5248      
      2600   320.20664     -36559.418      7712.6293      3415.3492      15.7087        12.406286      17.5248      
      2700   273.8309      -36524.125      4854.2369      3408.1439      15.7087        12.380113      17.5248      
      2800   326.50334     -36569.745     -1127.3637      3400.9385      15.7087        12.353939      17.5248      
      2900   298.53084     -36563.362      15491.304      3393.7331      15.7087        12.327766      17.5248      
      3000   296.14617     -36577.792      4199.2985      3386.5277      15.7087        12.301592      17.5248      
      3100   296.26112     -36567.775      4749.2749      3379.3223      15.7087        12.275418      17.5248      
      3200   288.76857     -36549.545     -962.72825      3372.117       15.7087        12.249245      17.5248      
      3300   306.11571     -36556.03      -7419.5125      3364.9116      15.7087        12.223071      17.5248      
      3400   316.12214     -36561.684     -7449.4191      3357.7062      15.7087        12.196898      17.5248      
      3500   284.80253     -36556.767      14803.507      3350.5008      15.7087        12.170724      17.5248      
      3600   289.09989     -36560.509      7804.8387      3343.2955      15.7087        12.14455       17.5248      
      3700   307.74671     -36568.772      3443.7818      3336.0901      15.7087        12.118377      17.5248      
      3800   307.18231     -36551.326      6887.3434      3328.8847      15.7087        12.092203      17.5248      
      3900   307.9556      -36541.443      14407.384      3321.6793      15.7087        12.06603       17.5248      
      4000   327.84941     -36571.391      8089.5415      3314.4739      15.7087        12.039856      17.5248      
      4100   289.17608     -36548.66       19286.881      3307.2686      15.7087        12.013682      17.5248      
      4200   302.61221     -36553.257      13278.638      3300.0632      15.7087        11.987509      17.5248      
      4300   312.93169     -36553.656      11822.809      3292.8578      15.7087        11.961335      17.5248      
      4400   292.64849     -36553.946      7168.5856      3285.6524      15.7087        11.935162      17.5248      
      4500   275.65783     -36549.094      16474.9        3278.447       15.7087        11.908988      17.5248      
      4600   291.65474     -36543.179      15521.449      3271.2417      15.7087        11.882814      17.5248      
      4700   326.18228     -36553.603      13220.052      3264.0363      15.7087        11.856641      17.5248      
      4800   302.51845     -36532.69       2059.0686      3256.8309      15.7087        11.830467      17.5248      
      4900   296.33097     -36557.448      6653.8063      3249.6255      15.7087        11.804294      17.5248      
      5000   307.42665     -36560.534      16521.492      3242.4202      15.7087        11.77812       17.5248      
Loop time of 262.511 on 8 procs for 5000 steps with 331 atoms

Performance: 0.823 ns/day, 29.168 hours/ns, 19.047 timesteps/s, 6.305 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 153.99     | 199.61     | 219.21     | 184.4 | 76.04
Bond    | 0.0016648  | 0.0020403  | 0.0025266  |   0.6 |  0.00
Neigh   | 11.717     | 15.35      | 16.699     |  50.6 |  5.85
Comm    | 3.9096     | 23.515     | 69.143     | 537.4 |  8.96
Output  | 0.01653    | 0.018801   | 0.020381   |   1.1 |  0.01
Modify  | 22.561     | 23.91      | 27.558     |  40.7 |  9.11
Other   |            | 0.1044     |            |       |  0.04

Nlocal:         41.375 ave          46 max          33 min
Histogram: 1 0 0 1 1 0 0 1 2 2
Nghost:        3629.62 ave        3701 max        3567 min
Histogram: 1 2 0 1 0 1 1 0 0 2
Neighs:        29596.5 ave       32823 max       23846 min
Histogram: 1 0 0 1 1 0 0 1 2 2

Total # of neighbors = 236772
Ave neighs/atom = 715.32326
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.0868
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.30868 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 1.30868 yz delta -0.20056 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.1 | 126.6 | 128.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.04827     -36506.702      7223.9         3602.6891      15.7087        13.0868        17.5248      
       100   282.06583     -36526.05       212.55939      3609.8944      15.7087        13.112974      17.5248      
       200   294.79056     -36529.148     -5148.5366      3617.0998      15.7087        13.139147      17.5248      
       300   289.67422     -36509.716     -8572.8396      3624.3052      15.7087        13.165321      17.5248      
       400   315.98463     -36539.593     -4217.242       3631.5106      15.7087        13.191494      17.5248      
       500   294.25077     -36535.547     -4219.2742      3638.716       15.7087        13.217668      17.5248      
       600   282.58214     -36529.592     -5008.1166      3645.9213      15.7087        13.243842      17.5248      
       700   297.92306     -36521.126      10523.421      3653.1267      15.7087        13.270015      17.5248      
       800   303.69007     -36493.67      -7440.7102      3660.3321      15.7087        13.296189      17.5248      
       900   318.75044     -36503.289     -1660.3763      3667.5375      15.7087        13.322362      17.5248      
      1000   302.41901     -36504.166     -16192.384      3674.7428      15.7087        13.348536      17.5248      
      1100   307.6981      -36517.435     -3456.0253      3681.9482      15.7087        13.37471       17.5248      
      1200   298.53399     -36515.255      2502.3583      3689.1536      15.7087        13.400883      17.5248      
      1300   308.11803     -36523.449     -3252.4988      3696.359       15.7087        13.427057      17.5248      
      1400   307.47772     -36542.14       2923.2279      3703.5644      15.7087        13.45323       17.5248      
      1500   281.43589     -36535.631     -7426.9379      3710.7697      15.7087        13.479404      17.5248      
      1600   303.14348     -36538.827     -12459.24       3717.9751      15.7087        13.505578      17.5248      
      1700   299.38348     -36511.551     -9706.0593      3725.1805      15.7087        13.531751      17.5248      
      1800   322.20106     -36500.12       9835.6394      3732.3859      15.7087        13.557925      17.5248      
      1900   319.90906     -36478.865     -8695.8026      3739.5912      15.7087        13.584098      17.5248      
      2000   313.83115     -36489.784     -9526.0951      3746.7966      15.7087        13.610272      17.5248      
      2100   297.13379     -36494.868     -16723.167      3754.002       15.7087        13.636446      17.5248      
      2200   279.54462     -36487.647     -4485.1834      3761.2074      15.7087        13.662619      17.5248      
      2300   306.40016     -36529.036     -6806.0974      3768.4128      15.7087        13.688793      17.5248      
      2400   271.5975      -36502.282     -3964.9776      3775.6181      15.7087        13.714966      17.5248      
      2500   299.20252     -36523.078     -13526.503      3782.8235      15.7087        13.74114       17.5248      
      2600   302.23424     -36488.657      168.20629      3790.0289      15.7087        13.767314      17.5248      
      2700   300.34806     -36464.363     -13043.823      3797.2343      15.7087        13.793487      17.5248      
      2800   304.78446     -36481.497     -9025.9564      3804.4397      15.7087        13.819661      17.5248      
      2900   285.7112      -36475.304     -2687.7365      3811.645       15.7087        13.845834      17.5248      
      3000   304.94599     -36495.973     -10627.551      3818.8504      15.7087        13.872008      17.5248      
      3100   275.06598     -36471.27      -13286.049      3826.0558      15.7087        13.898182      17.5248      
      3200   290.05384     -36496.237     -13129.509      3833.2612      15.7087        13.924355      17.5248      
      3300   274.4431      -36500.126     -14495.09       3840.4665      15.7087        13.950529      17.5248      
      3400   264.08549     -36493.069      69.072922      3847.6719      15.7087        13.976702      17.5248      
      3500   295.31781     -36481.603     -3461.2084      3854.8773      15.7087        14.002876      17.5248      
      3600   309.19827     -36478.364     -22988.44       3862.0827      15.7087        14.02905       17.5248      
      3700   308.61332     -36479.531     -9830.0875      3869.2881      15.7087        14.055223      17.5248      
      3800   292.86945     -36488.49      -8323.8478      3876.4934      15.7087        14.081397      17.5248      
      3900   266.89493     -36475.441     -12596.311      3883.6988      15.7087        14.10757       17.5248      
      4000   303.75075     -36506.043     -13207.406      3890.9042      15.7087        14.133744      17.5248      
      4100   289.3096      -36478.488     -13350.034      3898.1096      15.7087        14.159918      17.5248      
      4200   318.95364     -36469.631     -21196.657      3905.3149      15.7087        14.186091      17.5248      
      4300   313.46971     -36446.651     -11058.465      3912.5203      15.7087        14.212265      17.5248      
      4400   298.29965     -36464.739     -14717.289      3919.7257      15.7087        14.238438      17.5248      
      4500   287.42545     -36475.418     -13676.705      3926.9311      15.7087        14.264612      17.5248      
      4600   298.62803     -36481.739     -12900.833      3934.1365      15.7087        14.290786      17.5248      
      4700   299.72405     -36469.352     -11117.631      3941.3418      15.7087        14.316959      17.5248      
      4800   321.16599     -36465.714     -424.79917      3948.5472      15.7087        14.343133      17.5248      
      4900   327.99944     -36471.084     -13032.12       3955.7526      15.7087        14.369306      17.5248      
      5000   301.3891      -36474.402     -18185.586      3962.958       15.7087        14.39548       17.5248      
Loop time of 228.496 on 8 procs for 5000 steps with 331 atoms

Performance: 0.945 ns/day, 25.388 hours/ns, 21.882 timesteps/s, 7.243 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 132.18     | 173.58     | 188.68     | 127.6 | 75.97
Bond    | 0.0016614  | 0.0020235  | 0.0025503  |   0.6 |  0.00
Neigh   | 11.555     | 15.477     | 16.301     |  37.9 |  6.77
Comm    | 2.0929     | 17.216     | 58.569     | 405.1 |  7.53
Output  | 0.017895   | 0.020026   | 0.021802   |   1.0 |  0.01
Modify  | 21.298     | 22.102     | 26.065     |  32.0 |  9.67
Other   |            | 0.09834    |            |       |  0.04

Nlocal:         41.375 ave          51 max          26 min
Histogram: 1 0 0 1 0 0 3 0 1 2
Nghost:        2950.25 ave        2975 max        2932 min
Histogram: 3 0 0 1 0 2 0 0 1 1
Neighs:        24160.4 ave       29383 max       15720 min
Histogram: 1 0 0 1 0 0 3 0 1 2

Total # of neighbors = 193283
Ave neighs/atom = 583.93656
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.5248
variable dlen equal lz-${len0}
variable dlen equal lz-17.5248
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.5248
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.2042000000000001592, deltaxy = 0.82042
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.14580000000000001292, deltaxz = 0.01458
print "yz = $(yz), deltayz = ${deltayz}"
yz = -2.0055999999999998273, deltayz = 0.20056
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -1.75248 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.1 | 126.5 | 128.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.04827     -36506.702      7223.9         3602.6891      15.7087        13.0868        17.5248      
       100   282.28321     -36525.67       258.73857      3595.4837      15.7087        13.0868        17.48975     
       200   293.22975     -36526.146     -15110.059      3588.2783      15.7087        13.0868        17.454701    
       300   286.78284     -36515.14       6608.0913      3581.0729      15.7087        13.0868        17.419651    
       400   310.73255     -36539.217     -11312.432      3573.8676      15.7087        13.0868        17.384602    
       500   299.67139     -36540.003     -4576.0839      3566.6622      15.7087        13.0868        17.349552    
       600   281.59285     -36525.79       3267.3098      3559.4568      15.7087        13.0868        17.314502    
       700   301.43901     -36545.009      4806.4332      3552.2514      15.7087        13.0868        17.279453    
       800   261.8099      -36522.909     -16377.647      3545.046       15.7087        13.0868        17.244403    
       900   298.20679     -36560.165      3471.5619      3537.8407      15.7087        13.0868        17.209354    
      1000   294.51882     -36518.042     -11281.755      3530.6353      15.7087        13.0868        17.174304    
      1100   304.13368     -36507.2       -916.65993      3523.4299      15.7087        13.0868        17.139254    
      1200   298.33246     -36514.549      12960.931      3516.2245      15.7087        13.0868        17.104205    
      1300   334.80771     -36565.71       673.37876      3509.0191      15.7087        13.0868        17.069155    
      1400   303.68939     -36544.771     -6943.6512      3501.8138      15.7087        13.0868        17.034106    
      1500   285.45571     -36531.739     -1478.5508      3494.6084      15.7087        13.0868        16.999056    
      1600   295.13111     -36545.091     -3263.4406      3487.403       15.7087        13.0868        16.964006    
      1700   298.41297     -36541.192     -5848.2653      3480.1976      15.7087        13.0868        16.928957    
      1800   296.30424     -36534.959     -1674.0009      3472.9923      15.7087        13.0868        16.893907    
      1900   290.05518     -36543.406      3637.7062      3465.7869      15.7087        13.0868        16.858858    
      2000   288.79259     -36545.192     -1337.1704      3458.5815      15.7087        13.0868        16.823808    
      2100   301.29522     -36568.197      13846.182      3451.3761      15.7087        13.0868        16.788758    
      2200   282.0141      -36559.27      -3319.5321      3444.1707      15.7087        13.0868        16.753709    
      2300   277.69553     -36578.3        6283.9527      3436.9654      15.7087        13.0868        16.718659    
      2400   285.5249      -36584.171      179.68325      3429.76        15.7087        13.0868        16.68361     
      2500   310.75737     -36562.49      -7434.0808      3422.5546      15.7087        13.0868        16.64856     
      2600   311.64185     -36546.697      5761.8557      3415.3492      15.7087        13.0868        16.61351     
      2700   292.28319     -36533.684      16368.991      3408.1439      15.7087        13.0868        16.578461    
      2800   298.46895     -36555.194     -574.0464       3400.9385      15.7087        13.0868        16.543411    
      2900   300.0487      -36565.097      12578.118      3393.7331      15.7087        13.0868        16.508362    
      3000   277.27947     -36549.048     -1001.1608      3386.5277      15.7087        13.0868        16.473312    
      3100   293.28895     -36568.694      6155.6828      3379.3223      15.7087        13.0868        16.438262    
      3200   294.4482      -36569.292      8247.9447      3372.117       15.7087        13.0868        16.403213    
      3300   305.72981     -36575.537      14512.389      3364.9116      15.7087        13.0868        16.368163    
      3400   305.9928      -36576.793      4324.6644      3357.7062      15.7087        13.0868        16.333114    
      3500   279.69545     -36557.731      5687.1945      3350.5008      15.7087        13.0868        16.298064    
      3600   276.89884     -36551.393      2245.946       3343.2955      15.7087        13.0868        16.263014    
      3700   298.67492     -36557.432      5644.6114      3336.0901      15.7087        13.0868        16.227965    
      3800   319.04014     -36553.291      3685.1096      3328.8847      15.7087        13.0868        16.192915    
      3900   305.99065     -36557.584      16915.43       3321.6793      15.7087        13.0868        16.157866    
      4000   289.95081     -36554.752      20877.054      3314.4739      15.7087        13.0868        16.122816    
      4100   304.985       -36562.498      13085.033      3307.2686      15.7087        13.0868        16.087766    
      4200   300.82029     -36568.58       8181.4686      3300.0632      15.7087        13.0868        16.052717    
      4300   306.27902     -36576.518      15726.966      3292.8578      15.7087        13.0868        16.017667    
      4400   313.79012     -36563.68       11133.716      3285.6524      15.7087        13.0868        15.982618    
      4500   299.96028     -36557.192      21960.404      3278.447       15.7087        13.0868        15.947568    
      4600   300.06415     -36564.216      13572.758      3271.2417      15.7087        13.0868        15.912518    
      4700   326.87524     -36597.541      6799.5711      3264.0363      15.7087        13.0868        15.877469    
      4800   299.80828     -36575.023      12587.36       3256.8309      15.7087        13.0868        15.842419    
      4900   296.54184     -36559.925      11605.906      3249.6255      15.7087        13.0868        15.80737     
      5000   326.67403     -36535.092      6059.0296      3242.4202      15.7087        13.0868        15.77232     
Loop time of 265.852 on 8 procs for 5000 steps with 331 atoms

Performance: 0.812 ns/day, 29.539 hours/ns, 18.807 timesteps/s, 6.225 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 207.2      | 215.55     | 223.23     |  41.2 | 81.08
Bond    | 0.0015716  | 0.0020595  | 0.0026179  |   0.7 |  0.00
Neigh   | 16.064     | 16.34      | 16.555     |   4.1 |  6.15
Comm    | 2.9186     | 10.639     | 19.025     | 186.1 |  4.00
Output  | 0.015733   | 0.01785    | 0.019361   |   1.0 |  0.01
Modify  | 23.011     | 23.196     | 23.45      |   3.3 |  8.73
Other   |            | 0.1037     |            |       |  0.04

Nlocal:         41.375 ave          48 max          34 min
Histogram: 1 0 0 0 1 4 1 0 0 1
Nghost:        3549.88 ave        3603 max        3507 min
Histogram: 2 0 0 1 3 0 0 0 1 1
Neighs:        29623.2 ave       34206 max       24715 min
Histogram: 1 0 0 0 3 2 1 0 0 1

Total # of neighbors = 236986
Ave neighs/atom = 715.96979
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.5248
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 1.75248 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.1 | 126.5 | 128.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.04827     -36506.702      7223.9         3602.6891      15.7087        13.0868        17.5248      
       100   282.21579     -36525.809      234.48425      3609.8944      15.7087        13.0868        17.55985     
       200   290.68756     -36523.377     -4190.5951      3617.0998      15.7087        13.0868        17.594899    
       300   303.81161     -36525.389     -2210.0439      3624.3052      15.7087        13.0868        17.629949    
       400   318.02305     -36540.48      -658.34402      3631.5106      15.7087        13.0868        17.664998    
       500   286.33489     -36521.164     -3618.1483      3638.716       15.7087        13.0868        17.700048    
       600   294.85536     -36533.908     -698.11035      3645.9213      15.7087        13.0868        17.735098    
       700   299.05011     -36523.935     -11415.624      3653.1267      15.7087        13.0868        17.770147    
       800   309.31538     -36506.919     -15325.379      3660.3321      15.7087        13.0868        17.805197    
       900   314.94572     -36495.632      4447.4533      3667.5375      15.7087        13.0868        17.840246    
      1000   296.09395     -36500.461     -5495.2685      3674.7428      15.7087        13.0868        17.875296    
      1100   308.06971     -36532.792     -2764.6408      3681.9482      15.7087        13.0868        17.910346    
      1200   303.31955     -36526.014     -18588.243      3689.1536      15.7087        13.0868        17.945395    
      1300   300.1574      -36509.191     -5589.1384      3696.359       15.7087        13.0868        17.980445    
      1400   303.88315     -36502.437      3592.1269      3703.5644      15.7087        13.0868        18.015494    
      1500   280.92748     -36507.244     -10724.866      3710.7697      15.7087        13.0868        18.050544    
      1600   293.23173     -36527.556     -11193.959      3717.9751      15.7087        13.0868        18.085594    
      1700   270.47331     -36502.205     -15859.002      3725.1805      15.7087        13.0868        18.120643    
      1800   312.30306     -36506.262      4470.3257      3732.3859      15.7087        13.0868        18.155693    
      1900   317.46866     -36496.352     -18299.045      3739.5912      15.7087        13.0868        18.190742    
      2000   315.43051     -36493.148      2462.2993      3746.7966      15.7087        13.0868        18.225792    
      2100   294.04948     -36489.515     -15733.933      3754.002       15.7087        13.0868        18.260842    
      2200   289.57409     -36478.99      -18337.381      3761.2074      15.7087        13.0868        18.295891    
      2300   301.65766     -36483.967     -5292.9158      3768.4128      15.7087        13.0868        18.330941    
      2400   279.26364     -36468.452     -11843.564      3775.6181      15.7087        13.0868        18.36599     
      2500   284.90972     -36492.13      -6372.073       3782.8235      15.7087        13.0868        18.40104     
      2600   268.24839     -36493.36       2923.3128      3790.0289      15.7087        13.0868        18.43609     
      2700   296.72176     -36496.361     -9481.7418      3797.2343      15.7087        13.0868        18.471139    
      2800   282.08366     -36464.473     -10152.812      3804.4397      15.7087        13.0868        18.506189    
      2900   316.58864     -36482.306     -11720.923      3811.645       15.7087        13.0868        18.541238    
      3000   314.80574     -36471.883     -11087.058      3818.8504      15.7087        13.0868        18.576288    
      3100   311.92928     -36479.2       -6540.7783      3826.0558      15.7087        13.0868        18.611338    
      3200   294.97035     -36479.08      -12885.336      3833.2612      15.7087        13.0868        18.646387    
      3300   283.09425     -36487.394     -26555.523      3840.4665      15.7087        13.0868        18.681437    
      3400   301.69628     -36487.02      -12280.992      3847.6719      15.7087        13.0868        18.716486    
      3500   298.77368     -36461.391     -11885.729      3854.8773      15.7087        13.0868        18.751536    
      3600   297.44282     -36443.914     -5918.9695      3862.0827      15.7087        13.0868        18.786586    
      3700   316.84832     -36455.676     -14846.785      3869.2881      15.7087        13.0868        18.821635    
      3800   317.98974     -36452.195     -18245.274      3876.4934      15.7087        13.0868        18.856685    
      3900   292.75253     -36441.547     -12279.985      3883.6988      15.7087        13.0868        18.891734    
      4000   291.55159     -36456.765     -17958.421      3890.9042      15.7087        13.0868        18.926784    
      4100   293.19442     -36468.284     -22895.148      3898.1096      15.7087        13.0868        18.961834    
      4200   298.02449     -36467.595     -20169.122      3905.3149      15.7087        13.0868        18.996883    
      4300   307.49635     -36470.93      -12899.86       3912.5203      15.7087        13.0868        19.031933    
      4400   311.95151     -36460.787     -13514.092      3919.7257      15.7087        13.0868        19.066982    
      4500   327.67063     -36462.874     -13972.753      3926.9311      15.7087        13.0868        19.102032    
      4600   318.42868     -36468.884     -10544.183      3934.1365      15.7087        13.0868        19.137082    
      4700   288.88125     -36453.443     -17424.531      3941.3418      15.7087        13.0868        19.172131    
      4800   291.98765     -36449.27      -14360.829      3948.5472      15.7087        13.0868        19.207181    
      4900   293.02032     -36437.043     -12887.573      3955.7526      15.7087        13.0868        19.24223     
      5000   309.3368      -36442.708     -7441.3152      3962.958       15.7087        13.0868        19.27728     
Loop time of 232.215 on 8 procs for 5000 steps with 331 atoms

Performance: 0.930 ns/day, 25.802 hours/ns, 21.532 timesteps/s, 7.127 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 174.72     | 185.15     | 192.18     |  49.4 | 79.73
Bond    | 0.0016808  | 0.0020538  | 0.0024228  |   0.5 |  0.00
Neigh   | 13.133     | 13.47      | 13.772     |   4.9 |  5.80
Comm    | 4.3143     | 11.338     | 21.803     | 200.3 |  4.88
Output  | 0.017259   | 0.019332   | 0.020942   |   1.0 |  0.01
Modify  | 21.863     | 22.136     | 22.439     |   3.6 |  9.53
Other   |            | 0.1018     |            |       |  0.04

Nlocal:         41.375 ave          50 max          34 min
Histogram: 1 2 0 1 0 2 0 0 0 2
Nghost:        3055.38 ave        3131 max        2982 min
Histogram: 1 0 1 1 2 1 0 0 0 2
Neighs:        24147.1 ave       28987 max       20364 min
Histogram: 2 1 0 1 0 2 0 0 0 2

Total # of neighbors = 193177
Ave neighs/atom = 583.61631
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 15.7087
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz--2.0056)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*15.7087
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.2042000000000001592, deltaxy = 0.82042
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.14580000000000001292, deltaxz = 0.01458
print "yz = $(yz), deltayz = ${deltayz}"
yz = -2.0055999999999998273, deltayz = 0.20056
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -1.57087 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.1 | 126.5 | 128.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.04827     -36506.702      7223.9         3602.6891      15.7087        13.0868        17.5248      
       100   282.25001     -36525.826      310.69163      3602.6891      15.7087        13.0868        17.5248      
       200   292.10949     -36530.361     -11895.078      3602.6891      15.7087        13.0868        17.5248      
       300   294.2869      -36522.897     -10216.042      3602.6891      15.7087        13.0868        17.5248      
       400   325.07223     -36552.288     -6971.3136      3602.6891      15.7087        13.0868        17.5248      
       500   277.89052     -36514.413     -2496.5148      3602.6891      15.7087        13.0868        17.5248      
       600   303.63944     -36543.68       4085.7241      3602.6891      15.7087        13.0868        17.5248      
       700   296.78399     -36522.857     -7577.7872      3602.6891      15.7087        13.0868        17.5248      
       800   305.04597     -36497.909     -8532.929       3602.6891      15.7087        13.0868        17.5248      
       900   329.06709     -36511.141      219.67162      3602.6891      15.7087        13.0868        17.5248      
      1000   304.43866     -36506.309     -3855.13        3602.6891      15.7087        13.0868        17.5248      
      1100   284.34925     -36512.375      1570.9889      3602.6891      15.7087        13.0868        17.5248      
      1200   279.14364     -36500.147      7091.9419      3602.6891      15.7087        13.0868        17.5248      
      1300   297.42916     -36499.229      3667.847       3602.6891      15.7087        13.0868        17.5248      
      1400   311.84793     -36498.284     -1202.7095      3602.6891      15.7087        13.0868        17.5248      
      1500   285.89566     -36494.648     -3920.2135      3602.6891      15.7087        13.0868        17.5248      
      1600   299.01662     -36527.691     -9945.7872      3602.6891      15.7087        13.0868        17.5248      
      1700   299.62364     -36524.915      1249.5898      3602.6891      15.7087        13.0868        17.5248      
      1800   306.75248     -36506.67       5331.059       3602.6891      15.7087        13.0868        17.5248      
      1900   334.10252     -36502.377     -9251.4735      3602.6891      15.7087        13.0868        17.5248      
      2000   304.74872     -36496.908      3350.1469      3602.6891      15.7087        13.0868        17.5248      
      2100   310.88743     -36530.999     -6679.1558      3602.6891      15.7087        13.0868        17.5248      
      2200   285.83315     -36519.865      2009.4042      3602.6891      15.7087        13.0868        17.5248      
      2300   277.5684      -36514.366     -9141.5015      3602.6891      15.7087        13.0868        17.5248      
      2400   294.57992     -36518.226     -1914.288       3602.6891      15.7087        13.0868        17.5248      
      2500   311.52411     -36509.464     -5888.9476      3602.6891      15.7087        13.0868        17.5248      
      2600   302.93471     -36495.903     -4734.7689      3602.6891      15.7087        13.0868        17.5248      
      2700   298.70973     -36527.845     -4083.2716      3602.6891      15.7087        13.0868        17.5248      
      2800   302.32927     -36544.819     -5683.828       3602.6891      15.7087        13.0868        17.5248      
      2900   289.04371     -36531.851     -6520.7703      3602.6891      15.7087        13.0868        17.5248      
      3000   286.10486     -36526.989     -15539.324      3602.6891      15.7087        13.0868        17.5248      
      3100   286.86318     -36507.012      997.9574       3602.6891      15.7087        13.0868        17.5248      
      3200   314.54634     -36508.615     -7432.8235      3602.6891      15.7087        13.0868        17.5248      
      3300   316.40868     -36526.826     -293.60196      3602.6891      15.7087        13.0868        17.5248      
      3400   301.9734      -36529.264     -8711.1497      3602.6891      15.7087        13.0868        17.5248      
      3500   301.44877     -36526.459      1851.7944      3602.6891      15.7087        13.0868        17.5248      
      3600   301.0543      -36529.922      4960.3156      3602.6891      15.7087        13.0868        17.5248      
      3700   301.12783     -36554.128     -3980.4366      3602.6891      15.7087        13.0868        17.5248      
      3800   268.32916     -36540.481     -3486.9137      3602.6891      15.7087        13.0868        17.5248      
      3900   275.56153     -36530.533     -916.45263      3602.6891      15.7087        13.0868        17.5248      
      4000   298.78511     -36538.436     -8827.049       3602.6891      15.7087        13.0868        17.5248      
      4100   307.70831     -36539.693     -9083.9456      3602.6891      15.7087        13.0868        17.5248      
      4200   296.49707     -36527.161      4231.4495      3602.6891      15.7087        13.0868        17.5248      
      4300   290.94828     -36522.284     -2855.8404      3602.6891      15.7087        13.0868        17.5248      
      4400   310.78496     -36547.947      6485.3984      3602.6891      15.7087        13.0868        17.5248      
      4500   273.65623     -36522.862     -8237.7871      3602.6891      15.7087        13.0868        17.5248      
      4600   290.03375     -36561.503      10614.015      3602.6891      15.7087        13.0868        17.5248      
      4700   293.85047     -36588.738     -2508.762       3602.6891      15.7087        13.0868        17.5248      
      4800   274.80661     -36563.148     -3563.1447      3602.6891      15.7087        13.0868        17.5248      
      4900   308.20916     -36553.383     -11475.84       3602.6891      15.7087        13.0868        17.5248      
      5000   302.09373     -36529.841      15579.167      3602.6891      15.7087        13.0868        17.5248      
Loop time of 245.431 on 8 procs for 5000 steps with 331 atoms

Performance: 0.880 ns/day, 27.270 hours/ns, 20.372 timesteps/s, 6.743 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 187.72     | 197.48     | 203.71     |  44.9 | 80.46
Bond    | 0.0017006  | 0.0021103  | 0.0024515  |   0.5 |  0.00
Neigh   | 15.224     | 15.683     | 16.363     |   8.0 |  6.39
Comm    | 3.8281     | 10.11      | 19.9       | 199.0 |  4.12
Output  | 0.016565   | 0.018694   | 0.020259   |   1.0 |  0.01
Modify  | 21.351     | 22.028     | 22.463     |   6.6 |  8.98
Other   |            | 0.107      |            |       |  0.04

Nlocal:         41.375 ave          51 max          34 min
Histogram: 1 1 1 0 2 2 0 0 0 1
Nghost:           3311 ave        3369 max        3269 min
Histogram: 3 0 0 1 0 0 2 0 1 1
Neighs:        26632.5 ave       32383 max       22082 min
Histogram: 1 1 0 1 2 2 0 0 0 1

Total # of neighbors = 213060
Ave neighs/atom = 643.6858
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*15.7087
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 1.57087 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.1 | 126.6 | 128.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.04827     -36506.702      7223.9         3602.6891      15.7087        13.0868        17.5248      
       100   282.28411     -36525.718      127.56181      3602.6891      15.7087        13.0868        17.5248      
       200   292.94253     -36526.662     -9571.5932      3602.6891      15.7087        13.0868        17.5248      
       300   291.68494     -36517.373     -5007.6143      3602.6891      15.7087        13.0868        17.5248      
       400   324.38532     -36549.72      -3656.3732      3602.6891      15.7087        13.0868        17.5248      
       500   281.03262     -36522.837     -3824.8621      3602.6891      15.7087        13.0868        17.5248      
       600   293.63631     -36538.188     -7293.2266      3602.6891      15.7087        13.0868        17.5248      
       700   307.4829      -36534.773     -9664.9821      3602.6891      15.7087        13.0868        17.5248      
       800   321.81608     -36519.666     -1908.9138      3602.6891      15.7087        13.0868        17.5248      
       900   326.58283     -36517.118     -782.85907      3602.6891      15.7087        13.0868        17.5248      
      1000   315.11255     -36537.839      5288.0588      3602.6891      15.7087        13.0868        17.5248      
      1100   294.49209     -36526.21       1750.3774      3602.6891      15.7087        13.0868        17.5248      
      1200   303.21097     -36538.254     -12422.647      3602.6891      15.7087        13.0868        17.5248      
      1300   286.26369     -36531.4        1180.1127      3602.6891      15.7087        13.0868        17.5248      
      1400   286.09726     -36557.207     -3231.5912      3602.6891      15.7087        13.0868        17.5248      
      1500   294.93653     -36574.84      -6099.358       3602.6891      15.7087        13.0868        17.5248      
      1600   285.75058     -36554.167      590.81987      3602.6891      15.7087        13.0868        17.5248      
      1700   294.8556      -36543.423     -4963.3008      3602.6891      15.7087        13.0868        17.5248      
      1800   300.67112     -36540.432     -716.71759      3602.6891      15.7087        13.0868        17.5248      
      1900   302.12071     -36538.689      3473.7799      3602.6891      15.7087        13.0868        17.5248      
      2000   296.73319     -36547.059      5857.9865      3602.6891      15.7087        13.0868        17.5248      
      2100   283.21666     -36559.81      -3009.0453      3602.6891      15.7087        13.0868        17.5248      
      2200   303.59808     -36575.039     -6890.9824      3602.6891      15.7087        13.0868        17.5248      
      2300   305.9797      -36550.386     -12341.401      3602.6891      15.7087        13.0868        17.5248      
      2400   313.45589     -36538.931     -2745.2235      3602.6891      15.7087        13.0868        17.5248      
      2500   317.54918     -36551.202      302.30965      3602.6891      15.7087        13.0868        17.5248      
      2600   293.83605     -36554.488      749.81784      3602.6891      15.7087        13.0868        17.5248      
      2700   295.4924      -36565.075     -5529.9519      3602.6891      15.7087        13.0868        17.5248      
      2800   294.35929     -36561.793     -2715.5343      3602.6891      15.7087        13.0868        17.5248      
      2900   304.77363     -36566.68      -14127.824      3602.6891      15.7087        13.0868        17.5248      
      3000   301.30004     -36583.835     -1250.6724      3602.6891      15.7087        13.0868        17.5248      
      3100   281.9248      -36571.035      41.646971      3602.6891      15.7087        13.0868        17.5248      
      3200   319.86978     -36586.769     -2211.4356      3602.6891      15.7087        13.0868        17.5248      
      3300   332.91766     -36572.67      -5327.8229      3602.6891      15.7087        13.0868        17.5248      
      3400   295.75392     -36534.722     -9651.5549      3602.6891      15.7087        13.0868        17.5248      
      3500   328.5394      -36570.704     -70.287442      3602.6891      15.7087        13.0868        17.5248      
      3600   296.81605     -36545.524     -2992.5392      3602.6891      15.7087        13.0868        17.5248      
      3700   290.43634     -36542.514      3372.2637      3602.6891      15.7087        13.0868        17.5248      
      3800   301.77663     -36565.016      455.57155      3602.6891      15.7087        13.0868        17.5248      
      3900   271.72637     -36557.501     -6733.6386      3602.6891      15.7087        13.0868        17.5248      
      4000   297.5199      -36570.167     -2358.359       3602.6891      15.7087        13.0868        17.5248      
      4100   301.14777     -36559.105      1219.9544      3602.6891      15.7087        13.0868        17.5248      
      4200   322.77083     -36578.339      715.48889      3602.6891      15.7087        13.0868        17.5248      
      4300   307.31619     -36564.063      6128.1509      3602.6891      15.7087        13.0868        17.5248      
      4400   291.86063     -36560.03       1766.9525      3602.6891      15.7087        13.0868        17.5248      
      4500   301.60772     -36584.332     -6870.4206      3602.6891      15.7087        13.0868        17.5248      
      4600   300.23236     -36573.204     -7004.0441      3602.6891      15.7087        13.0868        17.5248      
      4700   313.63582     -36547.579     -11887.757      3602.6891      15.7087        13.0868        17.5248      
      4800   308.2587      -36536.309     -798.78456      3602.6891      15.7087        13.0868        17.5248      
      4900   309.3624      -36557.945     -3130.9881      3602.6891      15.7087        13.0868        17.5248      
      5000   302.72472     -36561.851     -1960.3054      3602.6891      15.7087        13.0868        17.5248      
Loop time of 243.65 on 8 procs for 5000 steps with 331 atoms

Performance: 0.887 ns/day, 27.072 hours/ns, 20.521 timesteps/s, 6.793 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 181.57     | 194.24     | 201.04     |  51.4 | 79.72
Bond    | 0.0017381  | 0.0020877  | 0.0024399  |   0.5 |  0.00
Neigh   | 16.502     | 16.709     | 16.932     |   3.6 |  6.86
Comm    | 3.4673     | 10.264     | 22.975     | 224.3 |  4.21
Output  | 0.017934   | 0.020517   | 0.0224     |   1.1 |  0.01
Modify  | 22.07      | 22.309     | 22.485     |   3.0 |  9.16
Other   |            | 0.1079     |            |       |  0.04

Nlocal:         41.375 ave          50 max          28 min
Histogram: 1 0 0 1 1 0 1 2 0 2
Nghost:        3205.38 ave        3253 max        3164 min
Histogram: 2 1 0 0 1 1 0 2 0 1
Neighs:        26604.4 ave       31704 max       18535 min
Histogram: 1 0 0 1 1 0 0 3 0 2

Total # of neighbors = 212835
Ave neighs/atom = 643.00604
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.0868
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz--0.1458)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*13.0868
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.2042000000000001592, deltaxy = 0.82042
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.14580000000000001292, deltaxz = 0.01458
print "yz = $(yz), deltayz = ${deltayz}"
yz = -2.0055999999999998273, deltayz = 0.20056
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -1.30868 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.1 | 126.5 | 128.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.04827     -36506.702      7223.9         3602.6891      15.7087        13.0868        17.5248      
       100   282.24933     -36525.71       226.96795      3602.6891      15.7087        13.0868        17.5248      
       200   287.77856     -36525.593     -7586.5905      3602.6891      15.7087        13.0868        17.5248      
       300   290.38249     -36521.469     -7054.2769      3602.6891      15.7087        13.0868        17.5248      
       400   313.03498     -36543.728     -5945.5711      3602.6891      15.7087        13.0868        17.5248      
       500   287.4681      -36526.096     -7389.0165      3602.6891      15.7087        13.0868        17.5248      
       600   286.30995     -36526.666     -7968.1076      3602.6891      15.7087        13.0868        17.5248      
       700   305.95233     -36522.713     -13309.656      3602.6891      15.7087        13.0868        17.5248      
       800   312.60879     -36504.771     -10750.8        3602.6891      15.7087        13.0868        17.5248      
       900   301.72913     -36504.449     -590.91235      3602.6891      15.7087        13.0868        17.5248      
      1000   296.07478     -36524.1       -17101.235      3602.6891      15.7087        13.0868        17.5248      
      1100   302.0263      -36535.217     -5142.5288      3602.6891      15.7087        13.0868        17.5248      
      1200   299.19231     -36531.403     -12693.676      3602.6891      15.7087        13.0868        17.5248      
      1300   294.10095     -36526.265      3423.0306      3602.6891      15.7087        13.0868        17.5248      
      1400   309.79346     -36546.886      10683.611      3602.6891      15.7087        13.0868        17.5248      
      1500   281.53618     -36539.913     -1703.8986      3602.6891      15.7087        13.0868        17.5248      
      1600   278.65039     -36546.552     -12040.877      3602.6891      15.7087        13.0868        17.5248      
      1700   307.45833     -36553.485     -12298.912      3602.6891      15.7087        13.0868        17.5248      
      1800   303.51095     -36520.894      2279.105       3602.6891      15.7087        13.0868        17.5248      
      1900   299.01013     -36517.005     -6560.3831      3602.6891      15.7087        13.0868        17.5248      
      2000   288.12342     -36523.419      10836.861      3602.6891      15.7087        13.0868        17.5248      
      2100   293.96909     -36547.432     -8890.8369      3602.6891      15.7087        13.0868        17.5248      
      2200   313.53055     -36571.532      1496.0929      3602.6891      15.7087        13.0868        17.5248      
      2300   304.10889     -36538.177      2334.2048      3602.6891      15.7087        13.0868        17.5248      
      2400   333.42265     -36526.219     -532.461        3602.6891      15.7087        13.0868        17.5248      
      2500   326.2803      -36533.638     -12326.363      3602.6891      15.7087        13.0868        17.5248      
      2600   297.46284     -36534.88      -3316.978       3602.6891      15.7087        13.0868        17.5248      
      2700   289.02494     -36536.162      40.75164       3602.6891      15.7087        13.0868        17.5248      
      2800   324.13715     -36568.221     -19479.361      3602.6891      15.7087        13.0868        17.5248      
      2900   284.38855     -36523.315      7437.861       3602.6891      15.7087        13.0868        17.5248      
      3000   337.16142     -36551.242     -6786.263       3602.6891      15.7087        13.0868        17.5248      
      3100   319.47633     -36524.766     -8175.9598      3602.6891      15.7087        13.0868        17.5248      
      3200   308.2881      -36541.53       7017.2789      3602.6891      15.7087        13.0868        17.5248      
      3300   294.55598     -36541.785     -554.95001      3602.6891      15.7087        13.0868        17.5248      
      3400   297.80763     -36544.699      3637.6889      3602.6891      15.7087        13.0868        17.5248      
      3500   304.14118     -36551.421      3769.4408      3602.6891      15.7087        13.0868        17.5248      
      3600   294.29842     -36551.345     -12132.952      3602.6891      15.7087        13.0868        17.5248      
      3700   291.57433     -36551.101      4008.7891      3602.6891      15.7087        13.0868        17.5248      
      3800   298.50702     -36541.121      6390.7131      3602.6891      15.7087        13.0868        17.5248      
      3900   312.68016     -36535.377     -11861.768      3602.6891      15.7087        13.0868        17.5248      
      4000   297.36003     -36508.493     -3999.2469      3602.6891      15.7087        13.0868        17.5248      
      4100   292.72255     -36517.677      2451.9265      3602.6891      15.7087        13.0868        17.5248      
      4200   278.1561      -36534.477     -8802.1398      3602.6891      15.7087        13.0868        17.5248      
      4300   281.30861     -36532.899     -693.79665      3602.6891      15.7087        13.0868        17.5248      
      4400   311.71282     -36537.906      5425.218       3602.6891      15.7087        13.0868        17.5248      
      4500   304.60971     -36523.832      1742.5054      3602.6891      15.7087        13.0868        17.5248      
      4600   311.76174     -36544.076      5589.5221      3602.6891      15.7087        13.0868        17.5248      
      4700   265.5062      -36539.419     -7507.602       3602.6891      15.7087        13.0868        17.5248      
      4800   278.74989     -36544.519      192.91326      3602.6891      15.7087        13.0868        17.5248      
      4900   316.57191     -36553.413     -5824.9665      3602.6891      15.7087        13.0868        17.5248      
      5000   306.57498     -36537.425      2511.3949      3602.6891      15.7087        13.0868        17.5248      
Loop time of 245.097 on 8 procs for 5000 steps with 331 atoms

Performance: 0.881 ns/day, 27.233 hours/ns, 20.400 timesteps/s, 6.752 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 185.77     | 196.15     | 203.58     |  50.0 | 80.03
Bond    | 0.0016756  | 0.0020384  | 0.0023839  |   0.6 |  0.00
Neigh   | 15.253     | 15.52      | 15.845     |   4.4 |  6.33
Comm    | 3.4446     | 10.868     | 21.285     | 213.0 |  4.43
Output  | 0.016372   | 0.018487   | 0.020043   |   1.0 |  0.01
Modify  | 22.103     | 22.434     | 22.673     |   3.6 |  9.15
Other   |            | 0.1061     |            |       |  0.04

Nlocal:         41.375 ave          50 max          33 min
Histogram: 1 2 0 1 0 0 0 3 0 1
Nghost:         3275.5 ave        3351 max        3206 min
Histogram: 1 1 1 0 1 1 2 0 0 1
Neighs:        26606.9 ave       31849 max       21571 min
Histogram: 1 2 0 1 0 0 0 3 0 1

Total # of neighbors = 212855
Ave neighs/atom = 643.06647
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*13.0868
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 1.30868 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.1 | 126.6 | 128.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.04827     -36506.702      7223.9         3602.6891      15.7087        13.0868        17.5248      
       100   282.26391     -36525.777      222.00741      3602.6891      15.7087        13.0868        17.5248      
       200   293.41909     -36531.583     -9608.2433      3602.6891      15.7087        13.0868        17.5248      
       300   290.81103     -36521.557     -3906.1692      3602.6891      15.7087        13.0868        17.5248      
       400   322.7256      -36554.294     -14289.03       3602.6891      15.7087        13.0868        17.5248      
       500   301.95704     -36542.822     -10361.889      3602.6891      15.7087        13.0868        17.5248      
       600   298.06984     -36537.307      5517.683       3602.6891      15.7087        13.0868        17.5248      
       700   306.70669     -36526.301     -2551.9548      3602.6891      15.7087        13.0868        17.5248      
       800   323.56033     -36528.643     -7100.2316      3602.6891      15.7087        13.0868        17.5248      
       900   308.72681     -36533.699      9463.7512      3602.6891      15.7087        13.0868        17.5248      
      1000   294.18911     -36541.481      930.34506      3602.6891      15.7087        13.0868        17.5248      
      1100   294.16888     -36542.258     -7333.5384      3602.6891      15.7087        13.0868        17.5248      
      1200   284.74927     -36523.525     -5603.6552      3602.6891      15.7087        13.0868        17.5248      
      1300   308.15223     -36505.356     -10242.707      3602.6891      15.7087        13.0868        17.5248      
      1400   310.48806     -36503.29      -8109.649       3602.6891      15.7087        13.0868        17.5248      
      1500   288.80848     -36500.686      3628.1291      3602.6891      15.7087        13.0868        17.5248      
      1600   312.01127     -36531.672     -8766.0519      3602.6891      15.7087        13.0868        17.5248      
      1700   285.22565     -36526.912     -7815.3488      3602.6891      15.7087        13.0868        17.5248      
      1800   300.8791      -36545.58      -5790.8016      3602.6891      15.7087        13.0868        17.5248      
      1900   301.85065     -36543.011     -7342.3783      3602.6891      15.7087        13.0868        17.5248      
      2000   311.29117     -36548.906     -5350.0692      3602.6891      15.7087        13.0868        17.5248      
      2100   300.62355     -36534.734     -16519.023      3602.6891      15.7087        13.0868        17.5248      
      2200   294.92843     -36534.736      1174.7986      3602.6891      15.7087        13.0868        17.5248      
      2300   295.97559     -36567.245      1144.719       3602.6891      15.7087        13.0868        17.5248      
      2400   274.90597     -36544.38       2588.9812      3602.6891      15.7087        13.0868        17.5248      
      2500   292.72566     -36533.771      6029.1284      3602.6891      15.7087        13.0868        17.5248      
      2600   309.47968     -36540.39       3268.2761      3602.6891      15.7087        13.0868        17.5248      
      2700   307.42117     -36542.416     -8180.077       3602.6891      15.7087        13.0868        17.5248      
      2800   298.99619     -36554.466     -3933.8927      3602.6891      15.7087        13.0868        17.5248      
      2900   280.15924     -36551.884     -8915.807       3602.6891      15.7087        13.0868        17.5248      
      3000   299.14625     -36567.696      448.73236      3602.6891      15.7087        13.0868        17.5248      
      3100   305.86228     -36544.974      16923.069      3602.6891      15.7087        13.0868        17.5248      
      3200   297.92654     -36520.378     -8585.0266      3602.6891      15.7087        13.0868        17.5248      
      3300   313.14136     -36537.977     -1029.5738      3602.6891      15.7087        13.0868        17.5248      
      3400   303.02262     -36545.556      2277.314       3602.6891      15.7087        13.0868        17.5248      
      3500   283.73203     -36545.415      4750.9791      3602.6891      15.7087        13.0868        17.5248      
      3600   295.80388     -36558.287     -7251.0397      3602.6891      15.7087        13.0868        17.5248      
      3700   325.18109     -36547.679     -4615.7711      3602.6891      15.7087        13.0868        17.5248      
      3800   303.96314     -36515.887      10011.294      3602.6891      15.7087        13.0868        17.5248      
      3900   303.82792     -36524.112     -9291.6514      3602.6891      15.7087        13.0868        17.5248      
      4000   307.68682     -36555.996     -13902.093      3602.6891      15.7087        13.0868        17.5248      
      4100   270.20257     -36529.344     -4652.0604      3602.6891      15.7087        13.0868        17.5248      
      4200   310.42455     -36570.146     -8486.9966      3602.6891      15.7087        13.0868        17.5248      
      4300   283.84338     -36556.233      8229.9945      3602.6891      15.7087        13.0868        17.5248      
      4400   275.09726     -36562.508      236.60544      3602.6891      15.7087        13.0868        17.5248      
      4500   302.28201     -36575.693      2935.0173      3602.6891      15.7087        13.0868        17.5248      
      4600   319.8401      -36557.068     -7177.1059      3602.6891      15.7087        13.0868        17.5248      
      4700   310.47732     -36547.324      1353.4022      3602.6891      15.7087        13.0868        17.5248      
      4800   307.695       -36556.198     -8774.1364      3602.6891      15.7087        13.0868        17.5248      
      4900   290.72688     -36560.846     -620.186        3602.6891      15.7087        13.0868        17.5248      
      5000   302.35449     -36574.018      5584.4907      3602.6891      15.7087        13.0868        17.5248      
Loop time of 244.654 on 8 procs for 5000 steps with 331 atoms

Performance: 0.883 ns/day, 27.184 hours/ns, 20.437 timesteps/s, 6.765 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 185.68     | 195.44     | 202.22     |  46.9 | 79.89
Bond    | 0.0017105  | 0.0020429  | 0.002418   |   0.6 |  0.00
Neigh   | 16.492     | 16.712     | 17.028     |   4.2 |  6.83
Comm    | 3.4254     | 10.201     | 20.001     | 206.0 |  4.17
Output  | 0.017802   | 0.020314   | 0.022094   |   1.1 |  0.01
Modify  | 21.864     | 22.17      | 22.355     |   3.5 |  9.06
Other   |            | 0.106      |            |       |  0.04

Nlocal:         41.375 ave          53 max          32 min
Histogram: 1 0 1 2 2 0 1 0 0 1
Nghost:        3217.12 ave        3247 max        3189 min
Histogram: 1 1 0 1 1 1 1 0 1 1
Neighs:          26633 ave       33695 max       20935 min
Histogram: 1 0 1 2 2 0 1 0 0 1

Total # of neighbors = 213064
Ave neighs/atom = 643.69789
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.5248
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--8.2042)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.1*${len0}
variable delta equal -0.1*17.5248
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.1*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.1*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.1*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.2042000000000001592, deltaxy = 0.82042
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.14580000000000001292, deltaxz = 0.01458
print "yz = $(yz), deltayz = ${deltayz}"
yz = -2.0055999999999998273, deltayz = 0.20056
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -1.75248 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.1 | 126.5 | 128.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.04827     -36506.702      7223.9         3602.6891      15.7087        13.0868        17.5248      
       100   282.32117     -36525.966      258.33865      3602.6891      15.7087        13.0868        17.5248      
       200   288.59279     -36522.678     -4705.3826      3602.6891      15.7087        13.0868        17.5248      
       300   302.78425     -36526.392     -13015.036      3602.6891      15.7087        13.0868        17.5248      
       400   300.61548     -36528.665     -11171.853      3602.6891      15.7087        13.0868        17.5248      
       500   274.41008     -36513.229     -6185.3424      3602.6891      15.7087        13.0868        17.5248      
       600   290.86783     -36534.768      1857.9504      3602.6891      15.7087        13.0868        17.5248      
       700   289.87548     -36533.108     -10793.753      3602.6891      15.7087        13.0868        17.5248      
       800   307.53697     -36521.938     -8409.3567      3602.6891      15.7087        13.0868        17.5248      
       900   324.57244     -36518.16       965.19506      3602.6891      15.7087        13.0868        17.5248      
      1000   318.96687     -36519.29       730.02437      3602.6891      15.7087        13.0868        17.5248      
      1100   307.2997      -36538.38      -1824.5431      3602.6891      15.7087        13.0868        17.5248      
      1200   314.33234     -36553.929      5342.4498      3602.6891      15.7087        13.0868        17.5248      
      1300   303.48502     -36542.276      3638.0038      3602.6891      15.7087        13.0868        17.5248      
      1400   298.14        -36534.861      1855.8949      3602.6891      15.7087        13.0868        17.5248      
      1500   299.4736      -36515.683     -2359.5424      3602.6891      15.7087        13.0868        17.5248      
      1600   320.05267     -36512.285     -12478.673      3602.6891      15.7087        13.0868        17.5248      
      1700   313.73492     -36520.957      8316.2846      3602.6891      15.7087        13.0868        17.5248      
      1800   299.54982     -36538.618      887.6154       3602.6891      15.7087        13.0868        17.5248      
      1900   293.87727     -36542.906      11689.276      3602.6891      15.7087        13.0868        17.5248      
      2000   281.27885     -36526.445      3321.7951      3602.6891      15.7087        13.0868        17.5248      
      2100   293.43277     -36521.78       8978.2434      3602.6891      15.7087        13.0868        17.5248      
      2200   312.40714     -36510.755     -10754.489      3602.6891      15.7087        13.0868        17.5248      
      2300   314.43112     -36512.266     -11127.359      3602.6891      15.7087        13.0868        17.5248      
      2400   309.13379     -36530.757     -8610.4651      3602.6891      15.7087        13.0868        17.5248      
      2500   304.98965     -36532.295     -1466.0026      3602.6891      15.7087        13.0868        17.5248      
      2600   310.49115     -36541.413     -3180.8248      3602.6891      15.7087        13.0868        17.5248      
      2700   304.77388     -36542.09       951.32107      3602.6891      15.7087        13.0868        17.5248      
      2800   298.28593     -36558.494     -668.35635      3602.6891      15.7087        13.0868        17.5248      
      2900   284.62383     -36558.435     -2578.4918      3602.6891      15.7087        13.0868        17.5248      
      3000   281.46545     -36536.537     -2224.0366      3602.6891      15.7087        13.0868        17.5248      
      3100   324.51018     -36535.243     -3923.8541      3602.6891      15.7087        13.0868        17.5248      
      3200   331.75874     -36550.017     -9717.7428      3602.6891      15.7087        13.0868        17.5248      
      3300   315.02388     -36556.484     -3295.5318      3602.6891      15.7087        13.0868        17.5248      
      3400   299.46902     -36554.426     -6933.3176      3602.6891      15.7087        13.0868        17.5248      
      3500   304.41604     -36565.298     -6800.1215      3602.6891      15.7087        13.0868        17.5248      
      3600   288.49881     -36547.979     -6215.0799      3602.6891      15.7087        13.0868        17.5248      
      3700   292.78821     -36538.204      8858.7877      3602.6891      15.7087        13.0868        17.5248      
      3800   318.76468     -36541.068      8431.6698      3602.6891      15.7087        13.0868        17.5248      
      3900   319.97434     -36549.295     -2553.2297      3602.6891      15.7087        13.0868        17.5248      
      4000   282.60199     -36540.086      3666.9796      3602.6891      15.7087        13.0868        17.5248      
      4100   298.15753     -36551.991     -10948.688      3602.6891      15.7087        13.0868        17.5248      
      4200   306.33034     -36552.59       1254.024       3602.6891      15.7087        13.0868        17.5248      
      4300   301.12422     -36545.847      1790.1534      3602.6891      15.7087        13.0868        17.5248      
      4400   312.4289      -36574.688      10357.058      3602.6891      15.7087        13.0868        17.5248      
      4500   290.75418     -36570.23      -958.29958      3602.6891      15.7087        13.0868        17.5248      
      4600   286.88072     -36565.566     -167.87941      3602.6891      15.7087        13.0868        17.5248      
      4700   312.83199     -36560.181     -13238.817      3602.6891      15.7087        13.0868        17.5248      
      4800   306.79002     -36545.945      1529.2641      3602.6891      15.7087        13.0868        17.5248      
      4900   301.56983     -36544.49      -3615.8371      3602.6891      15.7087        13.0868        17.5248      
      5000   313.16612     -36562.144     -9359.2753      3602.6891      15.7087        13.0868        17.5248      
Loop time of 250.503 on 8 procs for 5000 steps with 331 atoms

Performance: 0.862 ns/day, 27.834 hours/ns, 19.960 timesteps/s, 6.607 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 190.9      | 201.32     | 209        |  48.8 | 80.37
Bond    | 0.0016714  | 0.0020622  | 0.0024168  |   0.6 |  0.00
Neigh   | 15.723     | 16.008     | 16.299     |   4.9 |  6.39
Comm    | 3.0077     | 10.72      | 21.171     | 212.1 |  4.28
Output  | 0.016571   | 0.018882   | 0.020642   |   1.1 |  0.01
Modify  | 22.054     | 22.325     | 22.595     |   4.0 |  8.91
Other   |            | 0.106      |            |       |  0.04

Nlocal:         41.375 ave          49 max          33 min
Histogram: 1 2 0 0 0 1 1 0 2 1
Nghost:           3416 ave        3456 max        3372 min
Histogram: 1 0 1 2 0 0 1 1 0 2
Neighs:        26616.2 ave       31148 max       21575 min
Histogram: 1 2 0 0 0 1 1 0 2 1

Total # of neighbors = 212930
Ave neighs/atom = 643.29305
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.1*${len0}
variable delta equal 0.1*17.5248
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 1.75248 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.1 | 126.6 | 128.9 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   288.04827     -36506.702      7223.9         3602.6891      15.7087        13.0868        17.5248      
       100   282.17539     -36525.517      282.66676      3602.6891      15.7087        13.0868        17.5248      
       200   290.03085     -36528.751     -11752.453      3602.6891      15.7087        13.0868        17.5248      
       300   290.09281     -36521.568     -16.460105      3602.6891      15.7087        13.0868        17.5248      
       400   318.32739     -36550.086     -6484.5335      3602.6891      15.7087        13.0868        17.5248      
       500   284.95475     -36525.922     -11977.257      3602.6891      15.7087        13.0868        17.5248      
       600   285.27151     -36538.795      5705.4158      3602.6891      15.7087        13.0868        17.5248      
       700   305.20924     -36539.985     -16850.445      3602.6891      15.7087        13.0868        17.5248      
       800   299.78119     -36503.431      4425.0738      3602.6891      15.7087        13.0868        17.5248      
       900   322.47853     -36505.177     -9122.4365      3602.6891      15.7087        13.0868        17.5248      
      1000   307.60572     -36502.988     -3821.9346      3602.6891      15.7087        13.0868        17.5248      
      1100   308.53205     -36519.217     -1411.0295      3602.6891      15.7087        13.0868        17.5248      
      1200   295.33268     -36511.842     -2133.8711      3602.6891      15.7087        13.0868        17.5248      
      1300   301.68852     -36524.173     -3342.0122      3602.6891      15.7087        13.0868        17.5248      
      1400   292.71161     -36532.472     -3072.1045      3602.6891      15.7087        13.0868        17.5248      
      1500   283.67873     -36546.444     -8704.8233      3602.6891      15.7087        13.0868        17.5248      
      1600   301.59838     -36556.886      4374.176       3602.6891      15.7087        13.0868        17.5248      
      1700   297.53512     -36540.127     -2738.795       3602.6891      15.7087        13.0868        17.5248      
      1800   304.58932     -36531.508      4071.9451      3602.6891      15.7087        13.0868        17.5248      
      1900   300.84456     -36514.184     -11705.748      3602.6891      15.7087        13.0868        17.5248      
      2000   322.07726     -36527.563     -8395.6567      3602.6891      15.7087        13.0868        17.5248      
      2100   289.85848     -36506.98      -7288.3548      3602.6891      15.7087        13.0868        17.5248      
      2200   284.89457     -36508.68      -2333.9102      3602.6891      15.7087        13.0868        17.5248      
      2300   297.26603     -36537.479      3866.1518      3602.6891      15.7087        13.0868        17.5248      
      2400   281.23302     -36533.36       790.66317      3602.6891      15.7087        13.0868        17.5248      
      2500   294.91391     -36532.638     -5285.3063      3602.6891      15.7087        13.0868        17.5248      
      2600   294.47572     -36495.339     -13097.14       3602.6891      15.7087        13.0868        17.5248      
      2700   308.92678     -36501.879     -4027.5482      3602.6891      15.7087        13.0868        17.5248      
      2800   301.28859     -36506.932      1086.474       3602.6891      15.7087        13.0868        17.5248      
      2900   296.2095      -36525.568     -15983.594      3602.6891      15.7087        13.0868        17.5248      
      3000   283.86574     -36523.738     -2249.7021      3602.6891      15.7087        13.0868        17.5248      
      3100   270.70098     -36522.569     -1554.1109      3602.6891      15.7087        13.0868        17.5248      
      3200   292.57544     -36524.67       3381.1126      3602.6891      15.7087        13.0868        17.5248      
      3300   305.27208     -36508.116      328.75328      3602.6891      15.7087        13.0868        17.5248      
      3400   304.36443     -36498.682      2191.2858      3602.6891      15.7087        13.0868        17.5248      
      3500   296.99255     -36498.16      -12100.149      3602.6891      15.7087        13.0868        17.5248      
      3600   285.66186     -36515.651     -3704.809       3602.6891      15.7087        13.0868        17.5248      
      3700   306.49633     -36533.867     -3490.9781      3602.6891      15.7087        13.0868        17.5248      
      3800   289.29491     -36508.038      7262.3868      3602.6891      15.7087        13.0868        17.5248      
      3900   302.67792     -36503.048     -3852.7606      3602.6891      15.7087        13.0868        17.5248      
      4000   313.30211     -36479.092     -23171.619      3602.6891      15.7087        13.0868        17.5248      
      4100   317.4467      -36491.73       5207.284       3602.6891      15.7087        13.0868        17.5248      
      4200   300.33079     -36498.598     -1840.4063      3602.6891      15.7087        13.0868        17.5248      
      4300   297.11234     -36499.087     -6801.9379      3602.6891      15.7087        13.0868        17.5248      
      4400   281.68668     -36486.591     -6323.7623      3602.6891      15.7087        13.0868        17.5248      
      4500   301.28564     -36504.906     -10168.729      3602.6891      15.7087        13.0868        17.5248      
      4600   288.2845      -36521.775     -5669.726       3602.6891      15.7087        13.0868        17.5248      
      4700   300.51595     -36541.099      1418.4435      3602.6891      15.7087        13.0868        17.5248      
      4800   320.93196     -36542.527     -16247.233      3602.6891      15.7087        13.0868        17.5248      
      4900   311.70869     -36510.177     -4747.0335      3602.6891      15.7087        13.0868        17.5248      
      5000   317.73833     -36487.762     -6973.6733      3602.6891      15.7087        13.0868        17.5248      
Loop time of 224.981 on 8 procs for 5000 steps with 331 atoms

Performance: 0.960 ns/day, 24.998 hours/ns, 22.224 timesteps/s, 7.356 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 134.09     | 163.82     | 182.54     | 120.2 | 72.81
Bond    | 0.0013865  | 0.0016835  | 0.0020031  |   0.5 |  0.00
Neigh   | 12.478     | 15.497     | 16.817     |  41.9 |  6.89
Comm    | 4.9155     | 23.686     | 53.376     | 315.9 | 10.53
Output  | 0.014971   | 0.01674    | 0.01797    |   0.9 |  0.01
Modify  | 20.536     | 21.87      | 24.928     |  35.5 |  9.72
Other   |            | 0.09331    |            |       |  0.04

Nlocal:         41.375 ave          56 max          32 min
Histogram: 2 1 0 1 2 0 0 1 0 1
Nghost:        3127.88 ave        3157 max        3080 min
Histogram: 1 0 0 2 0 1 0 1 0 3
Neighs:        26551.4 ave       35527 max       20823 min
Histogram: 2 1 0 1 2 0 1 0 0 1

Total # of neighbors = 212411
Ave neighs/atom = 641.72508
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:52:56
