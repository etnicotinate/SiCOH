LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-EXP-11-vasp
read_data       ${structure}.data
read_data       333-EXP-11-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.007 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.364 | 6.364 | 6.364 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 7.59087e-05 on 8 procs for 1 steps with 274 atoms

48.7% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.047e-06  | 2.1564e-06 | 2.375e-06  |   0.0 |  2.84
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 4.818e-06  | 5.3074e-06 | 6.495e-06  |   0.0 |  6.99
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 6.845e-05  |            |       | 90.17

Nlocal:          34.25 ave          40 max          23 min
Histogram: 1 0 0 0 0 0 2 3 1 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-EXP-11-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
run ${nequil}
run 5000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -8.2 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109.8 | 110.8 | 111.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -29524.072      53373.102      1.4594291      3472.1201    
       100   940.83325     -30895.433     -22221.566      1.4594291      3472.1201    
       200   655.32859     -31410.555     -8415.0945      1.4594291      3472.1201    
       300   492.44705     -31703.584     -1794.1004      1.4594291      3472.1201    
       400   382.80684     -31863.571     -399.08344      1.4594291      3472.1201    
       500   340.51122     -31988.881     -4396.9622      1.4594291      3472.1201    
       600   278.76054     -32030.093     -12030.124      1.4594291      3472.1201    
       700   252.54387     -32039.073     -16008.085      1.4594291      3472.1201    
       800   303.17696     -32059.227     -7196.0812      1.4594291      3472.1201    
       900   316.31868     -32035.623      1880.9547      1.4594291      3472.1201    
      1000   302.25251     -32011.681      399.58501      1.4594291      3472.1201    
      1100   315.72134     -32030.621     -1937.705       1.4594291      3472.1201    
      1200   304.92451     -32062.996     -4858.2292      1.4594291      3472.1201    
      1300   271.27974     -32068.968     -12188.651      1.4594291      3472.1201    
      1400   282.30555     -32083.975     -5263.1535      1.4594291      3472.1201    
      1500   284.15138     -32063.957     -2027.0405      1.4594291      3472.1201    
      1600   304.84901     -32054.903     -8468.5027      1.4594291      3472.1201    
      1700   320.05144     -32056.724     -12833.076      1.4594291      3472.1201    
      1800   304.8515      -32060.022     -6647.9777      1.4594291      3472.1201    
      1900   292.71773     -32083.757     -1193.4113      1.4594291      3472.1201    
      2000   272.13786     -32083.142      6047.8677      1.4594291      3472.1201    
      2100   289.96718     -32084.631      9390.5456      1.4594291      3472.1201    
      2200   287.75492     -32058.426     -9151.3398      1.4594291      3472.1201    
      2300   335.25197     -32079.165     -16200.698      1.4594291      3472.1201    
      2400   310.32653     -32067.983      2160.6232      1.4594291      3472.1201    
      2500   290.62987     -32076.478     -2874.5909      1.4594291      3472.1201    
      2600   291.63604     -32096.204      1291.0485      1.4594291      3472.1201    
      2700   278.45821     -32085.212      2152.4342      1.4594291      3472.1201    
      2800   295.16014     -32075.293      11384.18       1.4594291      3472.1201    
      2900   321.3704      -32074.659      4968.7777      1.4594291      3472.1201    
      3000   317.98161     -32069.827      4987.1493      1.4594291      3472.1201    
      3100   315.69129     -32093.196     -2919.9481      1.4594291      3472.1201    
      3200   272.69984     -32080.299     -10479.085      1.4594291      3472.1201    
      3300   295.4357      -32094.378     -2307.7923      1.4594291      3472.1201    
      3400   306.68136     -32082.661      166.83382      1.4594291      3472.1201    
      3500   303.62197     -32071.67      -7119.6858      1.4594291      3472.1201    
      3600   295.73041     -32073.133     -3795.8248      1.4594291      3472.1201    
      3700   277.22679     -32074.502     -11588.427      1.4594291      3472.1201    
      3800   297.79238     -32096.778     -7570.1459      1.4594291      3472.1201    
      3900   281.6086      -32077.626     -6662.3657      1.4594291      3472.1201    
      4000   300.60001     -32070.467      2359.5495      1.4594291      3472.1201    
      4100   294.06074     -32057.62       5645.1046      1.4594291      3472.1201    
      4200   301.27329     -32073.305     -18150.364      1.4594291      3472.1201    
      4300   303.9283      -32079.447      7855.4458      1.4594291      3472.1201    
      4400   305.65864     -32079.704      2286.7804      1.4594291      3472.1201    
      4500   322.922       -32092.465     -3549.397       1.4594291      3472.1201    
      4600   285.80906     -32064.212     -12844.728      1.4594291      3472.1201    
      4700   314.3524      -32094.977     -4345.0284      1.4594291      3472.1201    
      4800   296.7886      -32095.23      -3105.819       1.4594291      3472.1201    
      4900   274.49523     -32085.05       4288.4756      1.4594291      3472.1201    
      5000   303.35124     -32096.072      7339.555       1.4594291      3472.1201    
Loop time of 104.22 on 8 procs for 5000 steps with 274 atoms

Performance: 2.073 ns/day, 11.580 hours/ns, 47.975 timesteps/s, 13.145 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 74.183     | 79.43      | 83.181     |  36.4 | 76.21
Bond    | 0.0099299  | 0.010593   | 0.011778   |   0.6 |  0.01
Neigh   | 7.865      | 7.9545     | 8.3037     |   4.8 |  7.63
Comm    | 1.2299     | 4.9881     | 10.246     | 145.8 |  4.79
Output  | 0.0016758  | 0.0018005  | 0.0026394  |   0.7 |  0.00
Modify  | 11.403     | 11.745     | 11.823     |   3.9 | 11.27
Other   |            | 0.08977    |            |       |  0.09

Nlocal:          34.25 ave          44 max          20 min
Histogram: 1 0 1 1 0 0 0 3 0 2
Nghost:           2809 ave        2829 max        2792 min
Histogram: 1 0 2 1 1 1 0 1 0 1
Neighs:        18899.4 ave       24093 max       11321 min
Histogram: 1 0 1 1 0 0 0 3 0 2

Total # of neighbors = 151195
Ave neighs/atom = 551.80657
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333-EXP-11-vasp_eq.data
System init for write_data ...

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.8189
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 12.842
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 16.0755

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.4312
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 1.195
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -8.3798

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 16.8189
variable dlen equal lx-${len0}
variable dlen equal lx-16.8189
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.8189
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.168189 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.168189 xy delta 0.083798 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.168189 xy delta 0.083798 xz delta -0.01195 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.7 | 110.5 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   303.35124     -32096.072      7339.5595      1.4594291      3472.1201    
       100   312.85449     -32085.277     -9198.4381      1.459721       3471.4257    
       200   315.49121     -32079.705      1352.2116      1.4600131      3470.7313    
       300   295.77508     -32064.545     -7950.4195      1.4603053      3470.0369    
       400   301.37634     -32076.543     -7007.6844      1.4605976      3469.3424    
       500   299.22144     -32082.232     -9043.7792      1.46089        3468.648     
       600   295.05378     -32085.567     -8550.174       1.4611825      3467.9536    
       700   287.17466     -32086.565     -8116.5591      1.4614752      3467.2592    
       800   311.26583     -32103.83      -833.27137      1.4617679      3466.5647    
       900   289.31699     -32077.442      5164.6049      1.4620608      3465.8703    
      1000   306.68666     -32075.045     -1489.7285      1.4623538      3465.1759    
      1100   296.73373     -32062.58      -3298.4469      1.4626469      3464.4815    
      1200   312.43742     -32084.416     -7604.454       1.4629402      3463.7871    
      1300   271.4989      -32071.217      8134.7406      1.4632335      3463.0926    
      1400   290.41427     -32096.128     -7011.8422      1.463527       3462.3982    
      1500   267.05014     -32067.772     -3189.5962      1.4638206      3461.7038    
      1600   284.12511     -32062.714     -7658.8025      1.4641143      3461.0094    
      1700   317.31531     -32078.259     -10070.782      1.4644081      3460.3149    
      1800   318.53724     -32094.92      -8252.7024      1.464702       3459.6205    
      1900   308.49107     -32110.95      -6715.6369      1.4649961      3458.9261    
      2000   279.89508     -32107.454     -3592.0658      1.4652903      3458.2317    
      2100   291.9069      -32111.589     -909.3098       1.4655846      3457.5372    
      2200   276.40061     -32076.121     -7420.7203      1.465879       3456.8428    
      2300   321.56853     -32101.644     -2499.8196      1.4661735      3456.1484    
      2400   310.66747     -32102.356     -6209.809       1.4664681      3455.454     
      2500   311.06477     -32114.572      1017.2471      1.4667629      3454.7595    
      2600   296.64655     -32105.396      1459.7591      1.4670578      3454.0651    
      2700   310.83815     -32107.743     -2275.9599      1.4673528      3453.3707    
      2800   314.64208     -32096.768     -1458.5296      1.4676479      3452.6763    
      2900   321.39793     -32073.796     -530.00744      1.4679432      3451.9818    
      3000   322.31742     -32064.16      -11826.576      1.4682385      3451.2874    
      3100   307.10441     -32085.089     -10329.064      1.468534       3450.593     
      3200   299.47045     -32099.154      1244.7121      1.4688296      3449.8986    
      3300   294.26622     -32112.553     -4088.1393      1.4691253      3449.2041    
      3400   300.45459     -32122.349     -4173.3923      1.4694212      3448.5097    
      3500   306.94251     -32124.754     -22907.882      1.4697171      3447.8153    
      3600   302.80624     -32095.741     -3259.0627      1.4700132      3447.1209    
      3700   329.04646     -32103.513     -2474.2869      1.4703094      3446.4264    
      3800   318.35141     -32110.389     -6722.6974      1.4706057      3445.732     
      3900   291.20971     -32099.792     -2176.2029      1.4709021      3445.0376    
      4000   303.26522     -32108.869     -18622.948      1.4711987      3444.3432    
      4100   293.4299      -32097.232     -6857.8207      1.4714954      3443.6488    
      4200   298.11986     -32092.685      2540.331       1.4717922      3442.9543    
      4300   339.0855      -32112.945      5172.2266      1.4720891      3442.2599    
      4400   300.14397     -32066.109     -8287.3806      1.4723861      3441.5655    
      4500   321.25393     -32102.728     -9885.8845      1.4726832      3440.8711    
      4600   287.29878     -32099.853      2237.756       1.4729805      3440.1766    
      4700   294.66926     -32116.725     -48.87261       1.4732779      3439.4822    
      4800   290.34985     -32120.149     -1642.4783      1.4735754      3438.7878    
      4900   287.89021     -32114.563      4617.6586      1.4738731      3438.0934    
      5000   311.40761     -32104.967      747.43391      1.4741708      3437.3989    
Loop time of 105.285 on 8 procs for 5000 steps with 274 atoms

Performance: 2.052 ns/day, 11.698 hours/ns, 47.490 timesteps/s, 13.012 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 75.316     | 80.636     | 84.344     |  37.9 | 76.59
Bond    | 0.0096903  | 0.010622   | 0.011272   |   0.5 |  0.01
Neigh   | 7.8956     | 7.9265     | 7.9582     |   0.8 |  7.53
Comm    | 1.2494     | 4.9679     | 10.295     | 153.1 |  4.72
Output  | 0.0099951  | 0.011359   | 0.012502   |   0.8 |  0.01
Modify  | 11.596     | 11.635     | 11.656     |   0.6 | 11.05
Other   |            | 0.09797    |            |       |  0.09

Nlocal:          34.25 ave          42 max          21 min
Histogram: 1 1 0 0 1 0 0 0 3 2
Nghost:        2838.75 ave        2872 max        2806 min
Histogram: 1 1 0 1 0 2 1 0 1 1
Neighs:        19103.4 ave       23217 max       11926 min
Histogram: 1 1 0 0 1 0 0 0 3 2

Total # of neighbors = 152827
Ave neighs/atom = 557.76277
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.8189
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.168189 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.168189 xy delta -0.083798 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.168189 xy delta -0.083798 xz delta 0.01195 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.7 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   303.35124     -32096.072      7339.5595      1.4594291      3472.1201    
       100   312.76877     -32085.298     -9218.3806      1.4591373      3472.8146    
       200   315.75272     -32080.271      2175.8307      1.4588456      3473.509     
       300   296.16499     -32064.495     -9456.518       1.458554       3474.2034    
       400   295.40909     -32071.522     -10939.43       1.4582625      3474.8978    
       500   297.36224     -32080.081     -7000.9727      1.4579711      3475.5923    
       600   298.30237     -32090.074     -2469.4059      1.4576799      3476.2867    
       700   277.13958     -32076.599     -8229.4417      1.4573888      3476.9811    
       800   298.14886     -32090.184     -8007.6964      1.4570977      3477.6755    
       900   286.02322     -32073.131     -1263.1345      1.4568068      3478.37      
      1000   313.27531     -32083.386     -7933.3366      1.4565161      3479.0644    
      1100   278.12843     -32060.971     -919.03719      1.4562254      3479.7588    
      1200   306.7044      -32098.559     -5015.3715      1.4559349      3480.4532    
      1300   298.98442     -32101.174     -3319.3092      1.4556444      3481.1477    
      1400   307.29503     -32110.033     -695.94305      1.4553541      3481.8421    
      1500   288.62742     -32085.757     -4773.1076      1.4550639      3482.5365    
      1600   302.70974     -32077.179      4347.6496      1.4547738      3483.2309    
      1700   312.54118     -32068.42      -13627.304      1.4544839      3483.9253    
      1800   310.90001     -32069.861     -10897.848      1.454194       3484.6198    
      1900   303.67419     -32091.87      -6470.7818      1.4539043      3485.3142    
      2000   275.15119     -32085.226      5280.6194      1.4536146      3486.0086    
      2100   308.40991     -32108.209     -2223.5625      1.4533251      3486.703     
      2200   299.54111     -32084.605      914.67427      1.4530357      3487.3975    
      2300   328.44356     -32098.102     -3157.6338      1.4527465      3488.0919    
      2400   289.66906     -32094.661     -4203.3781      1.4524573      3488.7863    
      2500   302.9457      -32124.411     -8877.8696      1.4521683      3489.4807    
      2600   293.6366      -32110.475     -7777.186       1.4518793      3490.1752    
      2700   289.06222     -32091.069     -7609.3679      1.4515905      3490.8696    
      2800   333.3012      -32101.87      -5017.9225      1.4513018      3491.564     
      2900   319.84251     -32092.899      167.89956      1.4510132      3492.2584    
      3000   306.23925     -32089.228     -10134.946      1.4507247      3492.9529    
      3100   295.15617     -32092.93      -4682.842       1.4504364      3493.6473    
      3200   280.02103     -32096.711     -93.809549      1.4501481      3494.3417    
      3300   288.10543     -32107.065      4016.01        1.44986        3495.0361    
      3400   298.01146     -32113.053     -6290.857       1.449572       3495.7306    
      3500   279.00535     -32093.398      7294.5912      1.4492841      3496.425     
      3600   299.04876     -32102.179     -9617.4477      1.4489963      3497.1194    
      3700   306.55511     -32094.315     -1452.6772      1.4487087      3497.8138    
      3800   317.08391     -32086.359     -7052.0567      1.4484211      3498.5083    
      3900   324.9503      -32076.983     -20224.21       1.4481337      3499.2027    
      4000   341.51182     -32093.628     -3885.3735      1.4478463      3499.8971    
      4100   309.14201     -32105.075     -8847.7471      1.4475591      3500.5915    
      4200   285.54461     -32102.74       10840.988      1.447272       3501.2859    
      4300   313.65102     -32130.505     -1553.1881      1.446985       3501.9804    
      4400   283.72005     -32098.014      7281.2082      1.4466982      3502.6748    
      4500   327.24635     -32110.681     -549.64469      1.4464114      3503.3692    
      4600   342.11551     -32120.306     -3020.7516      1.4461247      3504.0636    
      4700   299.98362     -32119.951     -4920.1866      1.4458382      3504.7581    
      4800   300.80951     -32130.574      14050.424      1.4455518      3505.4525    
      4900   294.27667     -32122.806     -4835.7772      1.4452655      3506.1469    
      5000   328.32368     -32146.599     -8238.283       1.4449793      3506.8413    
Loop time of 103.725 on 8 procs for 5000 steps with 274 atoms

Performance: 2.082 ns/day, 11.525 hours/ns, 48.204 timesteps/s, 13.208 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 74.864     | 79.433     | 83.056     |  34.0 | 76.58
Bond    | 0.010061   | 0.01106    | 0.011759   |   0.6 |  0.01
Neigh   | 7.7653     | 7.8249     | 7.8862     |   1.4 |  7.54
Comm    | 1.1046     | 4.7366     | 9.3149     | 139.6 |  4.57
Output  | 0.0097743  | 0.011118   | 0.012235   |   0.8 |  0.01
Modify  | 11.537     | 11.607     | 11.669     |   1.1 | 11.19
Other   |            | 0.1006     |            |       |  0.10

Nlocal:          34.25 ave          42 max          26 min
Histogram: 2 1 0 0 0 0 1 2 1 1
Nghost:        2802.38 ave        2836 max        2782 min
Histogram: 2 0 1 2 1 0 1 0 0 1
Neighs:        18782.6 ave       22645 max       14550 min
Histogram: 3 0 0 0 0 0 1 2 1 1

Total # of neighbors = 150261
Ave neighs/atom = 548.39781
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 12.842
variable dlen equal ly-${len0}
variable dlen equal ly-12.842
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.842
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.12842 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.12842 yz delta -0.004312 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.7 | 110.5 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   303.35124     -32096.072      7339.5595      1.4594291      3472.1201    
       100   312.82383     -32085.271     -9217.2675      1.459721       3471.4257    
       200   317.55948     -32081.726      2016.7217      1.4600131      3470.7313    
       300   294.40023     -32062.924     -4458.4891      1.4603053      3470.0369    
       400   296.58424     -32073.195     -5572.826       1.4605976      3469.3424    
       500   296.60942     -32079.517     -1450.2488      1.46089        3468.648     
       600   292.42335     -32084.535     -7570.1978      1.4611825      3467.9536    
       700   281.58601     -32081.062     -10015.45       1.4614752      3467.2592    
       800   294.82428     -32090.373     -11251.118      1.4617679      3466.5647    
       900   291.90746     -32083.777     -178.59569      1.4620608      3465.8703    
      1000   315.35562     -32090.597     -6327.0604      1.4623538      3465.1759    
      1100   293.23083     -32074.002     -8760.7141      1.4626469      3464.4815    
      1200   309.83728     -32097.526     -16539.202      1.4629402      3463.7871    
      1300   287.05545     -32090.958     -311.08013      1.4632335      3463.0926    
      1400   299.45088     -32101.718      471.64486      1.463527       3462.3982    
      1500   310.88889     -32106.356      884.24976      1.4638206      3461.7038    
      1600   306.34173     -32096.026     -527.00627      1.4641143      3461.0094    
      1700   311.06821     -32093.141      3856.6952      1.4644081      3460.3149    
      1800   315.19632     -32107.237     -6632.6201      1.464702       3459.6205    
      1900   286.85505     -32107.933     -9938.2339      1.4649961      3458.9261    
      2000   303.24147     -32129.73      -3847.9466      1.4652903      3458.2317    
      2100   299.8837      -32121.737     -4283.0421      1.4655846      3457.5372    
      2200   318.9595      -32121.526     -16982.138      1.465879       3456.8428    
      2300   315.0448      -32092.45      -18388.65       1.4661735      3456.1484    
      2400   311.32283     -32097.072     -15065.204      1.4664681      3455.454     
      2500   294.22127     -32096.015      1603.7177      1.4667629      3454.7595    
      2600   304.40521     -32114.279     -6146.1115      1.4670578      3454.0651    
      2700   288.92563     -32099.257      8814.6691      1.4673528      3453.3707    
      2800   305.31732     -32116.281      2984.5541      1.4676479      3452.6763    
      2900   282.98599     -32097.057     -3205.6472      1.4679432      3451.9818    
      3000   303.39713     -32105.3       -3994.6128      1.4682385      3451.2874    
      3100   328.31756     -32094.882     -6446.736       1.468534       3450.593     
      3200   335.47744     -32081.287      3102.2948      1.4688296      3449.8986    
      3300   316.42225     -32092.766     -6430.6757      1.4691253      3449.2041    
      3400   296.89068     -32100.348     -7783.5457      1.4694212      3448.5097    
      3500   288.97714     -32109.343     -10719.302      1.4697171      3447.8153    
      3600   296.57874     -32118.789     -9679.316       1.4700132      3447.1209    
      3700   291.20419     -32105.044     -2424.0285      1.4703094      3446.4264    
      3800   314.75208     -32096.326     -2873.667       1.4706057      3445.732     
      3900   330.01635     -32105.049     -8474.4308      1.4709021      3445.0376    
      4000   280.48789     -32091.823     -1686.2932      1.4711987      3444.3432    
      4100   291.51787     -32115.193      3885.5952      1.4714954      3443.6488    
      4200   309.48812     -32126.366     -4076.6451      1.4717922      3442.9543    
      4300   297.58267     -32107.46      -7478.5166      1.4720891      3442.2599    
      4400   320.38451     -32110.006      7927.9995      1.4723861      3441.5655    
      4500   331.91727     -32093.002     -1873.8625      1.4726832      3440.8711    
      4600   320.82656     -32097.792     -1648.7568      1.4729805      3440.1766    
      4700   313.29659     -32124.39      -3073.4677      1.4732779      3439.4822    
      4800   286.65541     -32108.996     -824.61038      1.4735754      3438.7878    
      4900   310.76908     -32127.981     -4554.0759      1.4738731      3438.0934    
      5000   300.5256      -32116.206     -13541.113      1.4741708      3437.3989    
Loop time of 105.605 on 8 procs for 5000 steps with 274 atoms

Performance: 2.045 ns/day, 11.734 hours/ns, 47.346 timesteps/s, 12.973 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 75.736     | 80.773     | 84.566     |  37.1 | 76.49
Bond    | 0.01003    | 0.011076   | 0.01205    |   0.6 |  0.01
Neigh   | 7.8944     | 7.9275     | 7.9672     |   0.8 |  7.51
Comm    | 1.2695     | 5.0644     | 10.111     | 148.6 |  4.80
Output  | 0.0098067  | 0.011466   | 0.012669   |   1.0 |  0.01
Modify  | 11.671     | 11.72      | 11.75      |   0.7 | 11.10
Other   |            | 0.09788    |            |       |  0.09

Nlocal:          34.25 ave          43 max          21 min
Histogram: 1 0 2 0 0 0 0 2 1 2
Nghost:        2855.62 ave        2875 max        2837 min
Histogram: 1 0 0 3 1 1 0 0 0 2
Neighs:        19143.8 ave       23758 max       12035 min
Histogram: 1 0 2 0 0 0 0 2 1 2

Total # of neighbors = 153150
Ave neighs/atom = 558.94161
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.842
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.12842 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.12842 yz delta 0.004312 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.7 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   303.35124     -32096.072      7339.5595      1.4594291      3472.1201    
       100   312.79903     -32085.303     -9199.2032      1.4591373      3472.8146    
       200   318.4233      -32082.109      1412.4316      1.4588456      3473.509     
       300   291.23779     -32060.664     -8283.525       1.458554       3474.2034    
       400   295.30231     -32070.309     -10792.609      1.4582625      3474.8978    
       500   303.579       -32082.906     -13104.115      1.4579711      3475.5923    
       600   289.13291     -32078.704     -9803.8866      1.4576799      3476.2867    
       700   277.32902     -32071.938     -7511.2132      1.4573888      3476.9811    
       800   308.59691     -32090.984     -12416.762      1.4570977      3477.6755    
       900   285.8133      -32064.597      5654.0884      1.4568068      3478.37      
      1000   321.11924     -32085.493      12.384267      1.4565161      3479.0644    
      1100   295.33178     -32079.356     -3504.5764      1.4562254      3479.7588    
      1200   298.89564     -32099.049     -9376.5051      1.4559349      3480.4532    
      1300   283.22731     -32086.601     -1992.2547      1.4556444      3481.1477    
      1400   298.16517     -32085.571     -10930.485      1.4553541      3481.8421    
      1500   300.93045     -32077.435     -12652.158      1.4550639      3482.5365    
      1600   323.37551     -32084.983     -753.55131      1.4547738      3483.2309    
      1700   311.6423      -32079.407     -17297.606      1.4544839      3483.9253    
      1800   292.85169     -32076.809     -6612.2585      1.454194       3484.6198    
      1900   282.46643     -32079.489     -8876.3864      1.4539043      3485.3142    
      2000   295.79506     -32093.497     -12598.81       1.4536146      3486.0086    
      2100   297.19204     -32083.576      10822.303      1.4533251      3486.703     
      2200   311.39066     -32073.341     -2323.4122      1.4530357      3487.3975    
      2300   297.26756     -32053.766     -4133.5919      1.4527465      3488.0919    
      2400   300.40611     -32079.301      3554.4448      1.4524573      3488.7863    
      2500   295.0377      -32098.05      -5597.7087      1.4521683      3489.4807    
      2600   312.75163     -32107.861     -13555.607      1.4518793      3490.1752    
      2700   280.29657     -32068.948     -5098.7468      1.4515905      3490.8696    
      2800   288.98217     -32051.363     -8802.2763      1.4513018      3491.564     
      2900   312.94149     -32067.93      -8312.9846      1.4510132      3492.2584    
      3000   286.17616     -32052.299     -8493.0714      1.4507247      3492.9529    
      3100   290.75173     -32064.381     -687.38778      1.4504364      3493.6473    
      3200   293.14946     -32085.41       12331.695      1.4501481      3494.3417    
      3300   291.38631     -32093.749      586.48053      1.44986        3495.0361    
      3400   302.59696     -32095.427     -1966.0462      1.449572       3495.7306    
      3500   304.12313     -32090.655     -2360.4303      1.4492841      3496.425     
      3600   278.70228     -32068.656     -2278.8404      1.4489963      3497.1194    
      3700   313.33049     -32093.764     -4724.5747      1.4487087      3497.8138    
      3800   316.70203     -32094.035     -11362.758      1.4484211      3498.5083    
      3900   313.61719     -32099.29       6310.4877      1.4481337      3499.2027    
      4000   293.95834     -32089.837     -2030.3464      1.4478463      3499.8971    
      4100   296.83465     -32093.421     -7699.3492      1.4475591      3500.5915    
      4200   316.55449     -32113.615     -15285.518      1.447272       3501.2859    
      4300   297.3585      -32094.697     -12357.327      1.446985       3501.9804    
      4400   299.50513     -32075.294     -7275.0679      1.4466982      3502.6748    
      4500   299.2551      -32057.787     -2908.8149      1.4464114      3503.3692    
      4600   306.87122     -32073.153     -462.24325      1.4461247      3504.0636    
      4700   276.87383     -32080.081     -8189.778       1.4458382      3504.7581    
      4800   296.34338     -32094.047     -660.6079       1.4455518      3505.4525    
      4900   284.9473      -32070.254     -2870.2123      1.4452655      3506.1469    
      5000   321.97529     -32085.594      3285.521       1.4449793      3506.8413    
Loop time of 103.849 on 8 procs for 5000 steps with 274 atoms

Performance: 2.080 ns/day, 11.539 hours/ns, 48.147 timesteps/s, 13.192 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 74.537     | 79.481     | 83.322     |  37.2 | 76.54
Bond    | 0.010239   | 0.011198   | 0.012256   |   0.6 |  0.01
Neigh   | 7.7829     | 7.844      | 7.949      |   1.9 |  7.55
Comm    | 1.0623     | 4.9012     | 9.8471     | 149.9 |  4.72
Output  | 0.0099613  | 0.011348   | 0.012502   |   0.8 |  0.01
Modify  | 11.391     | 11.499     | 11.556     |   1.5 | 11.07
Other   |            | 0.1005     |            |       |  0.10

Nlocal:          34.25 ave          43 max          23 min
Histogram: 1 1 1 0 0 0 1 1 1 2
Nghost:        2786.62 ave        2812 max        2769 min
Histogram: 1 3 0 1 0 0 1 0 1 1
Neighs:        18724.2 ave       23241 max       12753 min
Histogram: 1 1 1 0 0 0 1 1 1 2

Total # of neighbors = 149794
Ave neighs/atom = 546.69343
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 16.0755
variable dlen equal lz-${len0}
variable dlen equal lz-16.0755
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.0755
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -0.160755 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.7 | 110.5 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   303.35124     -32096.072      7339.5595      1.4594291      3472.1201    
       100   312.83518     -32085.286     -9206.0332      1.459721       3471.4257    
       200   315.27851     -32079.65       1723.834       1.4600131      3470.7313    
       300   296.13676     -32063.901     -7141.7684      1.4603053      3470.0369    
       400   305.23888     -32080.029     -6165.7984      1.4605976      3469.3424    
       500   305.61889     -32088.08      -10530.878      1.46089        3468.648     
       600   298.3919      -32092.663     -6900.5737      1.4611825      3467.9536    
       700   290.96456     -32092.821     -3164.3068      1.4614752      3467.2592    
       800   303.06034     -32095.38      -6927.4545      1.4617679      3466.5647    
       900   296.57011     -32079.835      5552.3465      1.4620608      3465.8703    
      1000   332.9287      -32099.688     -13299.428      1.4623538      3465.1759    
      1100   298.12683     -32079.781     -7867.8893      1.4626469      3464.4815    
      1200   297.01579     -32092.88       745.66225      1.4629402      3463.7871    
      1300   303.70695     -32098.716     -2820.398       1.4632335      3463.0926    
      1400   308.01977     -32098.532     -9228.766       1.463527       3462.3982    
      1500   302.89581     -32096.429     -2215.2003      1.4638206      3461.7038    
      1600   298.88236     -32095.357      2481.2356      1.4641143      3461.0094    
      1700   310.59749     -32104.576     -15762.218      1.4644081      3460.3149    
      1800   289.90342     -32090.304     -3960.2837      1.464702       3459.6205    
      1900   286.87213     -32088.614     -2928.4813      1.4649961      3458.9261    
      2000   313.63545     -32105.637     -16770.549      1.4652903      3458.2317    
      2100   282.61377     -32096.753     -12423.289      1.4655846      3457.5372    
      2200   279.75735     -32103.474     -8636.4278      1.465879       3456.8428    
      2300   296.71858     -32097.606     -3603.6036      1.4661735      3456.1484    
      2400   305.11097     -32080.24      -2542.7195      1.4664681      3455.454     
      2500   309.52934     -32084.418     -504.81207      1.4667629      3454.7595    
      2600   292.22273     -32088.216      2135.2487      1.4670578      3454.0651    
      2700   280.00379     -32088.143     -2789.4945      1.4673528      3453.3707    
      2800   306.34672     -32103.466     -11444.79       1.4676479      3452.6763    
      2900   289.9792      -32080.867      8787.0381      1.4679432      3451.9818    
      3000   309.87562     -32094.179      2247.1107      1.4682385      3451.2874    
      3100   294.92856     -32087.817      1223.0685      1.468534       3450.593     
      3200   290.24381     -32085.295     -6323.0993      1.4688296      3449.8986    
      3300   304.36824     -32094.662     -9095.1944      1.4691253      3449.2041    
      3400   300.55491     -32095.693     -2924.5916      1.4694212      3448.5097    
      3500   294.79073     -32098.12      -8556.0837      1.4697171      3447.8153    
      3600   282.15598     -32102.102     -13613.557      1.4700132      3447.1209    
      3700   287.55047     -32133.149     -9584.106       1.4703094      3446.4264    
      3800   305.38999     -32133.919     -15208.344      1.4706057      3445.732     
      3900   285.19319     -32094.454     -9927.7961      1.4709021      3445.0376    
      4000   311.81063     -32104.662     -3217.1646      1.4711987      3444.3432    
      4100   309.59972     -32104.018     -2042.9598      1.4714954      3443.6488    
      4200   271.66876     -32100.165     -7711.3929      1.4717922      3442.9543    
      4300   288.08854     -32129.599     -6755.9061      1.4720891      3442.2599    
      4400   305.96923     -32131.175     -10525.549      1.4723861      3441.5655    
      4500   293.09198     -32109.245     -7414.4477      1.4726832      3440.8711    
      4600   303.38746     -32111.503      551.42709      1.4729805      3440.1766    
      4700   300.5018      -32112.08      -10781.77       1.4732779      3439.4822    
      4800   295.89197     -32109.965     -7087.9912      1.4735754      3438.7878    
      4900   316.07153     -32131.983     -4109.5975      1.4738731      3438.0934    
      5000   291.39822     -32120.149      3738.5595      1.4741708      3437.3989    
Loop time of 105.162 on 8 procs for 5000 steps with 274 atoms

Performance: 2.054 ns/day, 11.685 hours/ns, 47.546 timesteps/s, 13.028 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 75.782     | 80.551     | 84.408     |  35.7 | 76.60
Bond    | 0.0098021  | 0.010703   | 0.01187    |   0.5 |  0.01
Neigh   | 7.9079     | 7.9597     | 8.0052     |   0.9 |  7.57
Comm    | 1.1487     | 5.0124     | 9.79       | 143.2 |  4.77
Output  | 0.0098848  | 0.011233   | 0.012392   |   0.8 |  0.01
Modify  | 11.466     | 11.518     | 11.573     |   0.8 | 10.95
Other   |            | 0.09833    |            |       |  0.09

Nlocal:          34.25 ave          43 max          23 min
Histogram: 1 1 0 1 0 0 2 1 0 2
Nghost:         2845.5 ave        2853 max        2825 min
Histogram: 1 0 0 0 0 1 1 0 1 4
Neighs:        19140.6 ave       23866 max       12967 min
Histogram: 1 1 0 1 0 0 2 1 0 2

Total # of neighbors = 153125
Ave neighs/atom = 558.85036
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.0755
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 0.160755 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.7 | 110.5 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   303.35124     -32096.072      7339.5595      1.4594291      3472.1201    
       100   312.79523     -32085.297     -9198.5501      1.4591373      3472.8146    
       200   316.69622     -32080.609      2209.9207      1.4588456      3473.509     
       300   294.27699     -32063.108     -6742.0754      1.458554       3474.2034    
       400   300.82719     -32075.642     -6950.3218      1.4582625      3474.8978    
       500   304.33434     -32084.872     -19245.429      1.4579711      3475.5923    
       600   290.27723     -32082.911     -10379.106      1.4576799      3476.2867    
       700   280.91035     -32080.61      -18524.966      1.4573888      3476.9811    
       800   293.92338     -32086.494     -6014.894       1.4570977      3477.6755    
       900   277.80982     -32063.666     -9328.7957      1.4568068      3478.37      
      1000   314.42559     -32082.951     -2533.0784      1.4565161      3479.0644    
      1100   294.94215     -32068.918     -7313.028       1.4562254      3479.7588    
      1200   299.30726     -32081.923     -8075.159       1.4559349      3480.4532    
      1300   308.68646     -32094.851     -2120.3983      1.4556444      3481.1477    
      1400   293.80527     -32089.373      519.12409      1.4553541      3481.8421    
      1500   309.11593     -32101.996     -8966.6575      1.4550639      3482.5365    
      1600   305.58845     -32102.358     -11818.702      1.4547738      3483.2309    
      1700   302.84906     -32107.528     -2584.2525      1.4544839      3483.9253    
      1800   289.07152     -32104.485      3249.1107      1.454194       3484.6198    
      1900   292.79597     -32108.325     -8695.3609      1.4539043      3485.3142    
      2000   301.33977     -32103.821      1079.4432      1.4536146      3486.0086    
      2100   313.85977     -32093.707     -5578.0093      1.4533251      3486.703     
      2200   299.92289     -32075.476     -8484.9961      1.4530357      3487.3975    
      2300   293.18343     -32081.808     -3443.7637      1.4527465      3488.0919    
      2400   275.28433     -32094.593     -1447.0426      1.4524573      3488.7863    
      2500   284.8022      -32100.557     -8232.886       1.4521683      3489.4807    
      2600   305.3012      -32100.228     -7535.642       1.4518793      3490.1752    
      2700   301.60813     -32087.437     -9862.0446      1.4515905      3490.8696    
      2800   307.70221     -32094.479     -14767.217      1.4513018      3491.564     
      2900   293.6107      -32087.63      -12331.185      1.4510132      3492.2584    
      3000   309.66295     -32099.753     -8236.6399      1.4507247      3492.9529    
      3100   294.81762     -32103.185      2122.6336      1.4504364      3493.6473    
      3200   276.60347     -32108.772     -647.45639      1.4501481      3494.3417    
      3300   265.63588     -32101.526     -8565.0608      1.44986        3495.0361    
      3400   301.87889     -32100.764     -8990.728       1.449572       3495.7306    
      3500   323.54632     -32109.873     -13316.579      1.4492841      3496.425     
      3600   292.62241     -32091.465     -1813.3257      1.4489963      3497.1194    
      3700   300.57961     -32112.729     -1779.3795      1.4487087      3497.8138    
      3800   281.95933     -32108.445     -5048.3454      1.4484211      3498.5083    
      3900   296.43421     -32108.675      2709.4773      1.4481337      3499.2027    
      4000   286.56937     -32070.896     -14366.81       1.4478463      3499.8971    
      4100   317.46525     -32086.061     -1161.4436      1.4475591      3500.5915    
      4200   295.73148     -32088.634     -4571.988       1.447272       3501.2859    
      4300   283.73684     -32090.62      -18342.25       1.446985       3501.9804    
      4400   292.02618     -32092.424     -5708.2782      1.4466982      3502.6748    
      4500   306.49481     -32098.991     -1455.5219      1.4464114      3503.3692    
      4600   311.32884     -32103.306     -6287.4366      1.4461247      3504.0636    
      4700   298.85629     -32093.167     -8458.9486      1.4458382      3504.7581    
      4800   299.80112     -32096.736     -5863.4326      1.4455518      3505.4525    
      4900   285.33113     -32105.629     -3931.3178      1.4452655      3506.1469    
      5000   263.78354     -32109.661      8383.7719      1.4449793      3506.8413    
Loop time of 92.691 on 8 procs for 5000 steps with 274 atoms

Performance: 2.330 ns/day, 10.299 hours/ns, 53.943 timesteps/s, 14.780 katom-step/s
98.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 64.501     | 69.003     | 72.454     |  31.6 | 74.44
Bond    | 0.0085556  | 0.0089445  | 0.0095991  |   0.3 |  0.01
Neigh   | 7.6317     | 7.7726     | 7.9113     |   4.1 |  8.39
Comm    | 1.002      | 4.4603     | 8.9665     | 124.6 |  4.81
Output  | 0.010908   | 0.012229   | 0.013337   |   0.8 |  0.01
Modify  | 11.199     | 11.343     | 11.469     |   3.2 | 12.24
Other   |            | 0.09133    |            |       |  0.10

Nlocal:          34.25 ave          44 max          23 min
Histogram: 1 0 2 0 1 0 1 1 1 1
Nghost:        2803.25 ave        2830 max        2782 min
Histogram: 1 1 1 0 3 0 0 0 1 1
Neighs:        18745.5 ave       23721 max       12847 min
Histogram: 1 0 2 0 1 0 1 1 1 1

Total # of neighbors = 149964
Ave neighs/atom = 547.31387
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 16.8189
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.4312)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.8189
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -0.168189 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.7 | 110.5 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   303.35124     -32096.072      7339.5595      1.4594291      3472.1201    
       100   312.78829     -32085.284     -9200.7756      1.4594291      3472.1201    
       200   315.34824     -32079.791      1925.3365      1.4594291      3472.1201    
       300   296.29816     -32064.976     -8377.804       1.4594291      3472.1201    
       400   294.53706     -32070.948     -5063.1879      1.4594291      3472.1201    
       500   308.76166     -32089.282     -13717.755      1.4594291      3472.1201    
       600   310.30565     -32099.863     -5364.2916      1.4594291      3472.1201    
       700   278.11935     -32078.699     -11979.45       1.4594291      3472.1201    
       800   307.99207     -32098.515     -626.05175      1.4594291      3472.1201    
       900   282.24542     -32068.166     -3333.0768      1.4594291      3472.1201    
      1000   327.89798     -32086.842     -206.65606      1.4594291      3472.1201    
      1100   287.1035      -32054.374      1503.7186      1.4594291      3472.1201    
      1200   287.91499     -32072.408     -3928.7193      1.4594291      3472.1201    
      1300   285.75152     -32083.118     -1833.6071      1.4594291      3472.1201    
      1400   294.86409     -32090.696     -751.36288      1.4594291      3472.1201    
      1500   287.98284     -32070.692     -9812.981       1.4594291      3472.1201    
      1600   323.22434     -32082.14       791.27874      1.4594291      3472.1201    
      1700   320.59535     -32077.263     -14157.505      1.4594291      3472.1201    
      1800   298.79085     -32077.384     -2684.8293      1.4594291      3472.1201    
      1900   315.96455     -32115.575     -712.51843      1.4594291      3472.1201    
      2000   281.6567      -32101.238     -1089.63        1.4594291      3472.1201    
      2100   287.14814     -32098.038      2918.0391      1.4594291      3472.1201    
      2200   295.98462     -32085.567     -13037.979      1.4594291      3472.1201    
      2300   330.4499      -32094.519      6199.4057      1.4594291      3472.1201    
      2400   291.4443      -32067.818      5649.7971      1.4594291      3472.1201    
      2500   301.05896     -32102.974     -6072.462       1.4594291      3472.1201    
      2600   277.66767     -32103.446     -6205.9184      1.4594291      3472.1201    
      2700   307.81685     -32110.226     -5806.8916      1.4594291      3472.1201    
      2800   302.36477     -32085.898      353.87638      1.4594291      3472.1201    
      2900   288.07344     -32068.667     -1329.1111      1.4594291      3472.1201    
      3000   320.64266     -32104.519     -2124.015       1.4594291      3472.1201    
      3100   285.12621     -32107.272     -8935.3055      1.4594291      3472.1201    
      3200   267.1522      -32097.391      7408.4137      1.4594291      3472.1201    
      3300   279.01122     -32091.54       1293.9855      1.4594291      3472.1201    
      3400   311.20513     -32099.408      6960.0056      1.4594291      3472.1201    
      3500   308.88255     -32101.929     -7049.734       1.4594291      3472.1201    
      3600   294.41449     -32111.148      2838.5735      1.4594291      3472.1201    
      3700   274.49741     -32117.24      -2273.1507      1.4594291      3472.1201    
      3800   305.32097     -32133.655      1584.4257      1.4594291      3472.1201    
      3900   295.41191     -32114.784      10116.519      1.4594291      3472.1201    
      4000   291.85779     -32103.098     -5251.1609      1.4594291      3472.1201    
      4100   303.09893     -32109.655     -11038.668      1.4594291      3472.1201    
      4200   319.98104     -32125.273     -2614.3959      1.4594291      3472.1201    
      4300   296.96189     -32124.913     -2674.349       1.4594291      3472.1201    
      4400   305.40331     -32143.341     -4051.3498      1.4594291      3472.1201    
      4500   285.88727     -32118.684     -1085.6102      1.4594291      3472.1201    
      4600   308.23209     -32112.952     -5741.8558      1.4594291      3472.1201    
      4700   293.65586     -32102.682     -13848.281      1.4594291      3472.1201    
      4800   294.51023     -32114.886     -9548.0057      1.4594291      3472.1201    
      4900   279.84527     -32137.281      1380.5034      1.4594291      3472.1201    
      5000   291.73951     -32151.654     -4124.6636      1.4594291      3472.1201    
Loop time of 91.5015 on 8 procs for 5000 steps with 274 atoms

Performance: 2.361 ns/day, 10.167 hours/ns, 54.644 timesteps/s, 14.972 katom-step/s
98.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 64.393     | 68.151     | 71.141     |  28.4 | 74.48
Bond    | 0.0082274  | 0.0087318  | 0.0093697  |   0.3 |  0.01
Neigh   | 7.6358     | 7.7918     | 7.9441     |   4.4 |  8.52
Comm    | 1.1453     | 4.1369     | 7.9034     | 115.7 |  4.52
Output  | 0.011091   | 0.012414   | 0.013483   |   0.8 |  0.01
Modify  | 11.166     | 11.31      | 11.455     |   3.6 | 12.36
Other   |            | 0.09059    |            |       |  0.10

Nlocal:          34.25 ave          44 max          21 min
Histogram: 1 0 1 1 0 0 2 1 0 2
Nghost:        2812.62 ave        2855 max        2774 min
Histogram: 1 2 1 0 0 0 1 1 0 2
Neighs:        18922.9 ave       23847 max       11835 min
Histogram: 1 0 1 1 0 0 0 3 0 2

Total # of neighbors = 151383
Ave neighs/atom = 552.4927
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.8189
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 0.168189 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.7 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   303.35124     -32096.072      7339.5595      1.4594291      3472.1201    
       100   312.80979     -32085.288     -9209.3246      1.4594291      3472.1201    
       200   316.3442      -32080.453      1923.7556      1.4594291      3472.1201    
       300   295.05328     -32063.605     -5710.6321      1.4594291      3472.1201    
       400   302.0036      -32075.912     -6562.5127      1.4594291      3472.1201    
       500   302.31589     -32083.343     -11035.157      1.4594291      3472.1201    
       600   293.51498     -32086.582     -8359.562       1.4594291      3472.1201    
       700   280.19589     -32083.646     -13643.008      1.4594291      3472.1201    
       800   297.92045     -32093.363     -10673.862      1.4594291      3472.1201    
       900   292.31017     -32078.916      2148.9529      1.4594291      3472.1201    
      1000   333.14012     -32090.001      9140.388       1.4594291      3472.1201    
      1100   291.48349     -32062.929      12597.149      1.4594291      3472.1201    
      1200   290.45328     -32081.301     -2769.729       1.4594291      3472.1201    
      1300   274.68819     -32079.397      2338.3249      1.4594291      3472.1201    
      1400   298.53057     -32099.599      833.44526      1.4594291      3472.1201    
      1500   313.74496     -32105.854     -16496.946      1.4594291      3472.1201    
      1600   307.04951     -32088.148      6869.5435      1.4594291      3472.1201    
      1700   319.15361     -32077.877     -1685.9176      1.4594291      3472.1201    
      1800   323.94276     -32087.353     -3220.0883      1.4594291      3472.1201    
      1900   291.93955     -32082.223     -3853.8116      1.4594291      3472.1201    
      2000   303.1208      -32108.033     -6552.3227      1.4594291      3472.1201    
      2100   278.60425     -32085.834     -8361.2715      1.4594291      3472.1201    
      2200   285.20234     -32067.258     -10442.859      1.4594291      3472.1201    
      2300   305.3825      -32067.127     -5249.7391      1.4594291      3472.1201    
      2400   309.42914     -32073.854      675.16911      1.4594291      3472.1201    
      2500   289.5664      -32066.39      -7269.5059      1.4594291      3472.1201    
      2600   320.35309     -32105.3       -6261.3408      1.4594291      3472.1201    
      2700   298.92331     -32100.411     -7982.3103      1.4594291      3472.1201    
      2800   304.37251     -32084.479     -4649.0551      1.4594291      3472.1201    
      2900   324.53886     -32069.364     -1946.2724      1.4594291      3472.1201    
      3000   320.51481     -32073.676     -4179.3868      1.4594291      3472.1201    
      3100   314.21077     -32099.212     -10178.803      1.4594291      3472.1201    
      3200   282.02267     -32090.414     -9060.3729      1.4594291      3472.1201    
      3300   289.71442     -32098.281     -8378.4149      1.4594291      3472.1201    
      3400   295.28679     -32096.42       833.45889      1.4594291      3472.1201    
      3500   314.16373     -32088.685     -8136.7475      1.4594291      3472.1201    
      3600   298.41206     -32057.895     -6536.1959      1.4594291      3472.1201    
      3700   299.00561     -32062.018      7170.0486      1.4594291      3472.1201    
      3800   300.64215     -32097.576     -4509.9103      1.4594291      3472.1201    
      3900   282.00233     -32086.529     -11965.081      1.4594291      3472.1201    
      4000   300.43683     -32083.56      -4418.1942      1.4594291      3472.1201    
      4100   301.34367     -32074.01      -8769.1145      1.4594291      3472.1201    
      4200   319.13202     -32091.116     -16545.503      1.4594291      3472.1201    
      4300   296.89738     -32096.996     -4456.6029      1.4594291      3472.1201    
      4400   267.87791     -32085.004     -13455.487      1.4594291      3472.1201    
      4500   285.08639     -32079.251      3033.6538      1.4594291      3472.1201    
      4600   313.88762     -32079.677     -2091.662       1.4594291      3472.1201    
      4700   336.78022     -32099.522      1007.1745      1.4594291      3472.1201    
      4800   312.44991     -32096.072     -12369.766      1.4594291      3472.1201    
      4900   283.0529      -32087.992      4217.5087      1.4594291      3472.1201    
      5000   293.32726     -32083.815     -6455.1483      1.4594291      3472.1201    
Loop time of 91.5757 on 8 procs for 5000 steps with 274 atoms

Performance: 2.359 ns/day, 10.175 hours/ns, 54.600 timesteps/s, 14.960 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.987     | 68.058     | 71.28      |  29.9 | 74.32
Bond    | 0.0082794  | 0.0087087  | 0.0091294  |   0.3 |  0.01
Neigh   | 7.7216     | 7.8304     | 7.9448     |   3.6 |  8.55
Comm    | 1.022      | 4.2442     | 8.3188     | 119.9 |  4.63
Output  | 0.010977   | 0.012456   | 0.013648   |   0.8 |  0.01
Modify  | 11.21      | 11.329     | 11.439     |   3.0 | 12.37
Other   |            | 0.09306    |            |       |  0.10

Nlocal:          34.25 ave          43 max          22 min
Histogram: 1 1 1 0 0 0 0 2 1 2
Nghost:        2802.38 ave        2836 max        2779 min
Histogram: 2 1 0 1 2 0 0 0 0 2
Neighs:        18902.1 ave       23511 max       12333 min
Histogram: 1 1 1 0 0 0 0 2 1 2

Total # of neighbors = 151217
Ave neighs/atom = 551.88686
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 12.842
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-1.195)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.842
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -0.12842 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.7 | 110.5 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   303.35124     -32096.072      7339.5595      1.4594291      3472.1201    
       100   312.80073     -32085.279     -9197.7602      1.4594291      3472.1201    
       200   315.60437     -32080.039      1928.6794      1.4594291      3472.1201    
       300   294.11464     -32062.915     -7839.3191      1.4594291      3472.1201    
       400   295.73053     -32071.317     -9544.6161      1.4594291      3472.1201    
       500   303.60464     -32085.279     -8433.6876      1.4594291      3472.1201    
       600   291.41223     -32084.558     -8932.5524      1.4594291      3472.1201    
       700   271.71948     -32076.152     -5528.5387      1.4594291      3472.1201    
       800   298.46813     -32095.821     -11479.456      1.4594291      3472.1201    
       900   284.86173     -32072.815      5088.1016      1.4594291      3472.1201    
      1000   307.69065     -32067.135      8620.0706      1.4594291      3472.1201    
      1100   291.65982     -32055.194      1810.3894      1.4594291      3472.1201    
      1200   297.33122     -32076.714     -8265.1528      1.4594291      3472.1201    
      1300   300.53745     -32097.643     -6583.8788      1.4594291      3472.1201    
      1400   270.52868     -32084.937     -4370.0524      1.4594291      3472.1201    
      1500   297.5873      -32094.616     -9649.2269      1.4594291      3472.1201    
      1600   311.55767     -32089.302     -7640.8942      1.4594291      3472.1201    
      1700   308.53006     -32073.276     -5562.3354      1.4594291      3472.1201    
      1800   304.71528     -32065.729     -15774.092      1.4594291      3472.1201    
      1900   309.92226     -32081.057      1723.5347      1.4594291      3472.1201    
      2000   284.23979     -32083.372     -900.09882      1.4594291      3472.1201    
      2100   303.22863     -32107.31       8348.3297      1.4594291      3472.1201    
      2200   285.09661     -32090.663     -5495.4923      1.4594291      3472.1201    
      2300   286.99418     -32062.449     -7962.3995      1.4594291      3472.1201    
      2400   317.95238     -32074.494     -5703.1359      1.4594291      3472.1201    
      2500   308.92379     -32085.474     -18932.595      1.4594291      3472.1201    
      2600   304.52383     -32096.288     -2030.5845      1.4594291      3472.1201    
      2700   302.03843     -32094.096     -4439.8758      1.4594291      3472.1201    
      2800   294.27717     -32081.87      -5724.1036      1.4594291      3472.1201    
      2900   311.76297     -32073.828      10885.483      1.4594291      3472.1201    
      3000   336.44375     -32072.914     -10993.554      1.4594291      3472.1201    
      3100   320.34653     -32087.589      2326.0256      1.4594291      3472.1201    
      3200   317.82733     -32102.421      10367.945      1.4594291      3472.1201    
      3300   277.5443      -32078.349     -19475.783      1.4594291      3472.1201    
      3400   304.23591     -32093.858      8564.0535      1.4594291      3472.1201    
      3500   321.52604     -32090.523     -9245.9424      1.4594291      3472.1201    
      3600   314.52174     -32078.797     -5906.3914      1.4594291      3472.1201    
      3700   321.85184     -32110.607     -3274.3677      1.4594291      3472.1201    
      3800   283.70326     -32099.019     -14316.384      1.4594291      3472.1201    
      3900   281.73685     -32092.335      1049.7387      1.4594291      3472.1201    
      4000   307.40588     -32098.539     -11151.954      1.4594291      3472.1201    
      4100   280.10717     -32073.187      5426.0417      1.4594291      3472.1201    
      4200   295.02853     -32108.475     -2258.0317      1.4594291      3472.1201    
      4300   285.331       -32116.209     -11243.152      1.4594291      3472.1201    
      4400   281.50766     -32103.868     -4902.2447      1.4594291      3472.1201    
      4500   305.20659     -32097.058     -13107.08       1.4594291      3472.1201    
      4600   298.26724     -32084.554     -10833.151      1.4594291      3472.1201    
      4700   292.9566      -32091.198      114.3206       1.4594291      3472.1201    
      4800   303.3572      -32102.074     -6289.0978      1.4594291      3472.1201    
      4900   281.10698     -32082.083     -9272.3746      1.4594291      3472.1201    
      5000   301.02001     -32085.279     -11353.252      1.4594291      3472.1201    
Loop time of 91.6922 on 8 procs for 5000 steps with 274 atoms

Performance: 2.356 ns/day, 10.188 hours/ns, 54.530 timesteps/s, 14.941 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.834     | 68.058     | 71.453     |  30.7 | 74.22
Bond    | 0.0083788  | 0.0088757  | 0.0096016  |   0.4 |  0.01
Neigh   | 7.6509     | 7.7678     | 7.9004     |   3.5 |  8.47
Comm    | 1.0995     | 4.498      | 8.7275     | 119.9 |  4.91
Output  | 0.010983   | 0.012334   | 0.013441   |   0.8 |  0.01
Modify  | 11.13      | 11.256     | 11.365     |   2.9 | 12.28
Other   |            | 0.09188    |            |       |  0.10

Nlocal:          34.25 ave          45 max          20 min
Histogram: 1 0 1 1 0 0 2 1 0 2
Nghost:        2805.88 ave        2837 max        2785 min
Histogram: 2 0 2 1 0 1 0 0 1 1
Neighs:        18906.4 ave       24496 max       11307 min
Histogram: 1 0 1 1 0 0 2 1 0 2

Total # of neighbors = 151251
Ave neighs/atom = 552.01095
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.842
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 0.12842 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.7 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   303.35124     -32096.072      7339.5595      1.4594291      3472.1201    
       100   312.79861     -32085.295     -9210.9808      1.4594291      3472.1201    
       200   316.07739     -32080.313      1860.8954      1.4594291      3472.1201    
       300   296.01843     -32064.539     -6789.22        1.4594291      3472.1201    
       400   297.8142      -32072.935     -5816.2414      1.4594291      3472.1201    
       500   304.20303     -32085.592     -16071.04       1.4594291      3472.1201    
       600   293.1056      -32086.274     -1311.9855      1.4594291      3472.1201    
       700   286.84857     -32088.829     -9327.8479      1.4594291      3472.1201    
       800   299.04654     -32093.581     -3706.4867      1.4594291      3472.1201    
       900   289.26259     -32076.674      7981.8882      1.4594291      3472.1201    
      1000   306.89907     -32079.53      -4193.9854      1.4594291      3472.1201    
      1100   290.65026     -32066.705     -6940.4733      1.4594291      3472.1201    
      1200   288.38032     -32068.179     -11422.303      1.4594291      3472.1201    
      1300   301.79191     -32088.5       -6181.7011      1.4594291      3472.1201    
      1400   287.5975      -32088.534      8283.973       1.4594291      3472.1201    
      1500   283.82619     -32094.311      4284.7591      1.4594291      3472.1201    
      1600   297.65132     -32096.136     -5430.7382      1.4594291      3472.1201    
      1700   307.26769     -32081.655     -8833.9139      1.4594291      3472.1201    
      1800   315.41293     -32084.91      -4280.5063      1.4594291      3472.1201    
      1900   290.52309     -32085.2       -7180.9152      1.4594291      3472.1201    
      2000   323.9109      -32129.873      679.53159      1.4594291      3472.1201    
      2100   284.54019     -32106.974     -6633.198       1.4594291      3472.1201    
      2200   275.08129     -32078.184     -3735.3501      1.4594291      3472.1201    
      2300   315.51528     -32089.332     -11618.877      1.4594291      3472.1201    
      2400   310.40325     -32086.075     -4657.1119      1.4594291      3472.1201    
      2500   294.80144     -32084.672     -5275.3463      1.4594291      3472.1201    
      2600   304.12817     -32112.441     -2818.3609      1.4594291      3472.1201    
      2700   285.33227     -32120.32      -13687.417      1.4594291      3472.1201    
      2800   286.97519     -32115.55      -8594.7234      1.4594291      3472.1201    
      2900   283.35162     -32101.306     -4462.3069      1.4594291      3472.1201    
      3000   283.9811      -32092.288     -12447.084      1.4594291      3472.1201    
      3100   327.52774     -32111.475      3146.3115      1.4594291      3472.1201    
      3200   303.95244     -32083.61       133.65472      1.4594291      3472.1201    
      3300   302.29051     -32094.09      -1413.1259      1.4594291      3472.1201    
      3400   284.03864     -32109.705      1595.1357      1.4594291      3472.1201    
      3500   278.36079     -32099.62      -2153.7159      1.4594291      3472.1201    
      3600   277.5808      -32079.477     -13805.797      1.4594291      3472.1201    
      3700   329.16069     -32112.194      60.547601      1.4594291      3472.1201    
      3800   304.53565     -32096.028     -9001.2621      1.4594291      3472.1201    
      3900   293.72666     -32093.188     -680.37427      1.4594291      3472.1201    
      4000   309.39013     -32126.035     -7267.0068      1.4594291      3472.1201    
      4100   275.12027     -32126.862     -63.170795      1.4594291      3472.1201    
      4200   265.79731     -32111.358     -12070.495      1.4594291      3472.1201    
      4300   299.67733     -32116.919     -3494.5292      1.4594291      3472.1201    
      4400   289.15882     -32093.035     -9140.6714      1.4594291      3472.1201    
      4500   334.18336     -32115.432     -12130.057      1.4594291      3472.1201    
      4600   313.91954     -32102.065     -4807.1158      1.4594291      3472.1201    
      4700   289.06638     -32111.265     -3187.436       1.4594291      3472.1201    
      4800   298.2423      -32129.289      4361.6735      1.4594291      3472.1201    
      4900   276.18738     -32096.74      -5468.0548      1.4594291      3472.1201    
      5000   286.58252     -32084.811     -6398.0969      1.4594291      3472.1201    
Loop time of 91.4943 on 8 procs for 5000 steps with 274 atoms

Performance: 2.361 ns/day, 10.166 hours/ns, 54.648 timesteps/s, 14.974 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 64.404     | 68.086     | 71.361     |  27.7 | 74.42
Bond    | 0.0084087  | 0.0087763  | 0.0092494  |   0.3 |  0.01
Neigh   | 7.6882     | 7.8007     | 7.93       |   3.6 |  8.53
Comm    | 0.93007    | 4.1989     | 7.8819     | 111.5 |  4.59
Output  | 0.011091   | 0.01239    | 0.013466   |   0.8 |  0.01
Modify  | 11.163     | 11.294     | 11.414     |   2.9 | 12.34
Other   |            | 0.09325    |            |       |  0.10

Nlocal:          34.25 ave          43 max          25 min
Histogram: 1 1 1 0 0 1 1 2 0 1
Nghost:        2826.25 ave        2836 max        2807 min
Histogram: 1 1 0 0 0 0 1 1 2 2
Neighs:        18962.5 ave       23624 max       14077 min
Histogram: 1 1 1 0 1 0 1 2 0 1

Total # of neighbors = 151700
Ave neighs/atom = 553.64964
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# # Find which reference length to use
# if "${dir} == 1" then #    "variable len0 equal ${lx0}"
# if "${dir} == 2" then #    "variable len0 equal ${ly0}"
# if "${dir} == 3" then #    "variable len0 equal ${lz0}"
# if "${dir} == 4" then #    "variable len0 equal ${lz0}"
# if "${dir} == 5" then #    "variable len0 equal ${lz0}"
# if "${dir} == 6" then #    "variable len0 equal ${ly0}"

# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 16.0755
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--8.3798)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.0755
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -0.160755 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type q x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.7 | 110.5 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   303.35124     -32096.072      7339.5595      1.4594291      3472.1201    
       100   312.81276     -32085.291     -9212.3278      1.4594291      3472.1201    
       200   316.3751      -32080.577      1646.945       1.4594291      3472.1201    
       300   292.23058     -32061.103     -8992.5929      1.4594291      3472.1201    
       400   297.31296     -32073.607     -9195.2085      1.4594291      3472.1201    
       500   299.04304     -32082.463     -12746.583      1.4594291      3472.1201    
       600   286.88065     -32083.669     -4490.5779      1.4594291      3472.1201    
       700   282.64963     -32082.119     -13959.303      1.4594291      3472.1201    
       800   304.18378     -32092.397      2638.4287      1.4594291      3472.1201    
       900   300.38936     -32086.125      1867.3669      1.4594291      3472.1201    
      1000   290.19293     -32067.321     -3045.5188      1.4594291      3472.1201    
      1100   312.1334      -32091.335     -894.45981      1.4594291      3472.1201    
      1200   299.20137     -32090.47      -20987.467      1.4594291      3472.1201    
      1300   305.27479     -32099.408     -188.38087      1.4594291      3472.1201    
      1400   320.00299     -32114.854     -10912.878      1.4594291      3472.1201    
      1500   301.02521     -32104.75      -5044.7001      1.4594291      3472.1201    
      1600   288.6255      -32093.721      3031.7939      1.4594291      3472.1201    
      1700   324.86101     -32101.782     -6501.3785      1.4594291      3472.1201    
      1800   322.27808     -32089.874     -6411.9851      1.4594291      3472.1201    
      1900   291.5059      -32081.098     -17277.651      1.4594291      3472.1201    
      2000   275.10342     -32091.846     -701.27678      1.4594291      3472.1201    
      2100   288.0755      -32100.526     -10812.777      1.4594291      3472.1201    
      2200   296.43746     -32085.259      3584.132       1.4594291      3472.1201    
      2300   316.17799     -32089.1       -9715.6637      1.4594291      3472.1201    
      2400   300.39615     -32084.916     -5517.7978      1.4594291      3472.1201    
      2500   309.94796     -32103.858     -9599.0131      1.4594291      3472.1201    
      2600   305.31289     -32102.263     -12960.104      1.4594291      3472.1201    
      2700   314.84495     -32102.771     -10159.696      1.4594291      3472.1201    
      2800   320.52502     -32096.873      3513.5398      1.4594291      3472.1201    
      2900   315.85871     -32085.026     -130.18549      1.4594291      3472.1201    
      3000   311.43147     -32085.653     -2793.6438      1.4594291      3472.1201    
      3100   283.87363     -32080.472      243.76324      1.4594291      3472.1201    
      3200   293.28685     -32105.692      146.4527       1.4594291      3472.1201    
      3300   290.35944     -32103.695     -674.46987      1.4594291      3472.1201    
      3400   309.72435     -32091.603     -7590.0318      1.4594291      3472.1201    
      3500   323.2023      -32084.571     -10690.442      1.4594291      3472.1201    
      3600   298.11832     -32077.628     -866.84104      1.4594291      3472.1201    
      3700   268.93954     -32063.965     -4052.1537      1.4594291      3472.1201    
      3800   300.91642     -32098.292      4244.8501      1.4594291      3472.1201    
      3900   268.12682     -32100.914     -7317.0235      1.4594291      3472.1201    
      4000   278.9437      -32110.861     -3323.3219      1.4594291      3472.1201    
      4100   293.83934     -32097.86       5950.2146      1.4594291      3472.1201    
      4200   311.16659     -32099.401      451.33336      1.4594291      3472.1201    
      4300   296.9393      -32087.109     -2426.7655      1.4594291      3472.1201    
      4400   324.71669     -32112.486     -10440.421      1.4594291      3472.1201    
      4500   276.94475     -32095.315     -10264.05       1.4594291      3472.1201    
      4600   275.65085     -32099.896      413.64167      1.4594291      3472.1201    
      4700   292.22258     -32092.179     -6132.3744      1.4594291      3472.1201    
      4800   306.20391     -32091.193     -1063.1907      1.4594291      3472.1201    
      4900   293.85827     -32080.493     -3349.8645      1.4594291      3472.1201    
      5000   302.36131     -32100.836     -1777.1698      1.4594291      3472.1201    
Loop time of 92.1252 on 8 procs for 5000 steps with 274 atoms

Performance: 2.345 ns/day, 10.236 hours/ns, 54.274 timesteps/s, 14.871 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.97      | 68.205     | 71.75      |  30.7 | 74.03
Bond    | 0.0083828  | 0.0088297  | 0.0094328  |   0.4 |  0.01
Neigh   | 7.7083     | 7.8275     | 7.9414     |   3.4 |  8.50
Comm    | 0.93736    | 4.4783     | 8.7175     | 119.9 |  4.86
Output  | 0.010946   | 0.012419   | 0.013497   |   0.8 |  0.01
Modify  | 11.387     | 11.502     | 11.613     |   2.7 | 12.49
Other   |            | 0.09091    |            |       |  0.10

Nlocal:          34.25 ave          45 max          23 min
Histogram: 1 0 1 1 0 2 0 2 0 1
Nghost:        2823.88 ave        2856 max        2794 min
Histogram: 1 2 0 0 1 1 0 1 1 1
Neighs:        18926.1 ave       24494 max       13003 min
Histogram: 1 0 1 1 0 2 0 2 0 1

Total # of neighbors = 151409
Ave neighs/atom = 552.58759
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(v_delta/v_len0] defined in input script
# variable C1neg equal ${d1}
# variable C2neg equal ${d2}
# variable C3neg equal ${d3}
# variable C4neg equal ${d4}
# variable C5neg equal ${d5}
# variable C6neg equal ${d6}

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.0755
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 0.160755 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press density vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type q x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type q x y z
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 108.6 | 109.7 | 110.6 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   303.35124     -32096.072      7339.5595      1.4594291      3472.1201    
       100   312.81243     -32085.282     -9204.5425      1.4594291      3472.1201    
       200   315.46947     -32079.93       2042.4753      1.4594291      3472.1201    
       300   296.5216      -32064.794     -6540.7392      1.4594291      3472.1201    
       400   298.27278     -32073.198     -4419.6304      1.4594291      3472.1201    
       500   299.41444     -32081.435     -7137.8257      1.4594291      3472.1201    
       600   294.25922     -32085.481     -3914.6054      1.4594291      3472.1201    
       700   277.15505     -32075.813     -8157.546       1.4594291      3472.1201    
       800   317.2488      -32102.792     -8053.3052      1.4594291      3472.1201    
       900   307.25304     -32086.639     -2681.0703      1.4594291      3472.1201    
      1000   315.60001     -32084.612     -231.38721      1.4594291      3472.1201    
      1100   280.68486     -32065.509     -3026.97        1.4594291      3472.1201    
      1200   281.7761      -32077.17      -5948.0211      1.4594291      3472.1201    
      1300   294.72663     -32091.769      1612.1367      1.4594291      3472.1201    
      1400   308.74379     -32100.856     -2378.6763      1.4594291      3472.1201    
      1500   302.82025     -32105.287      1950.646       1.4594291      3472.1201    
      1600   283.39591     -32098.16      -12562.424      1.4594291      3472.1201    
      1700   299.41336     -32111.133      1013.1713      1.4594291      3472.1201    
      1800   311.14183     -32117.009     -5428.7822      1.4594291      3472.1201    
      1900   292.37067     -32101.019      3264.8356      1.4594291      3472.1201    
      2000   285.8352      -32094.062     -10217.725      1.4594291      3472.1201    
      2100   306.54594     -32113.578     -7817.8689      1.4594291      3472.1201    
      2200   299.95166     -32121.959     -847.03851      1.4594291      3472.1201    
      2300   291.75788     -32133.156     -5043.2467      1.4594291      3472.1201    
      2400   302.29969     -32142.061     -13902.107      1.4594291      3472.1201    
      2500   314.69301     -32128.152     -8398.0472      1.4594291      3472.1201    
      2600   323.88465     -32114.37      -2143.1929      1.4594291      3472.1201    
      2700   284.14288     -32095.058     -10085.155      1.4594291      3472.1201    
      2800   277.55898     -32106.149     -4162.825       1.4594291      3472.1201    
      2900   305.86848     -32129.513     -19325.766      1.4594291      3472.1201    
      3000   279.95977     -32096.327     -2493.2044      1.4594291      3472.1201    
      3100   316.71925     -32099.892     -9756.1143      1.4594291      3472.1201    
      3200   313.8148      -32112.812     -5226.8323      1.4594291      3472.1201    
      3300   284.41111     -32112.499     -5647.8991      1.4594291      3472.1201    
      3400   302.26588     -32130.871     -8494.1216      1.4594291      3472.1201    
      3500   316.30012     -32125.181     -7049.6627      1.4594291      3472.1201    
      3600   335.94134     -32122.726     -4601.8517      1.4594291      3472.1201    
      3700   302.32827     -32109.415     -6710.628       1.4594291      3472.1201    
      3800   293.50821     -32136.582     -13402.566      1.4594291      3472.1201    
      3900   298.98455     -32132.994     -4449.9094      1.4594291      3472.1201    
      4000   295.5198      -32107.576     -7427.5359      1.4594291      3472.1201    
      4100   305.53131     -32099.381     -565.98428      1.4594291      3472.1201    
      4200   328.21838     -32120.336     -9193.5116      1.4594291      3472.1201    
      4300   277.76551     -32100.233     -1332.5677      1.4594291      3472.1201    
      4400   283.52694     -32124.199     -16347.213      1.4594291      3472.1201    
      4500   278.75378     -32155.07      -4546.3364      1.4594291      3472.1201    
      4600   269.74728     -32143.297     -6756.1996      1.4594291      3472.1201    
      4700   305.12089     -32149         -10625.571      1.4594291      3472.1201    
      4800   290.8064      -32116.399     -14832.852      1.4594291      3472.1201    
      4900   293.67398     -32100.144     -11476.981      1.4594291      3472.1201    
      5000   316.34941     -32111.005     -15691.043      1.4594291      3472.1201    
Loop time of 91.9783 on 8 procs for 5000 steps with 274 atoms

Performance: 2.348 ns/day, 10.220 hours/ns, 54.361 timesteps/s, 14.895 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 64.529     | 68.275     | 71.748     |  27.7 | 74.23
Bond    | 0.0084894  | 0.0088263  | 0.0091721  |   0.3 |  0.01
Neigh   | 7.6529     | 7.7805     | 7.9366     |   3.8 |  8.46
Comm    | 0.94502    | 4.4178     | 8.1707     | 109.1 |  4.80
Output  | 0.011113   | 0.012527   | 0.013661   |   0.8 |  0.01
Modify  | 11.247     | 11.391     | 11.504     |   3.0 | 12.38
Other   |            | 0.09316    |            |       |  0.10

Nlocal:          34.25 ave          43 max          25 min
Histogram: 2 0 1 0 0 2 0 0 1 2
Nghost:        2795.62 ave        2839 max        2759 min
Histogram: 3 0 0 1 0 0 0 3 0 1
Neighs:        18948.9 ave       23631 max       14074 min
Histogram: 2 0 1 0 0 2 0 0 1 2

Total # of neighbors = 151591
Ave neighs/atom = 553.25182
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# # Combine positive and negative
# variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
# variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
# variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
# variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
# variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
# variable C6${dir} equal 0.5*(${C6neg}+${C6pos})

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:21:11
