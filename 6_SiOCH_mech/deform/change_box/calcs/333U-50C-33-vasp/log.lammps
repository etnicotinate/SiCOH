LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-33-vasp
read_data       ${structure}.data
read_data       333U-50C-33-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.008 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.865 | 6.865 | 6.865 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              325.50446      3829.1207    
         1   300            0              0              325.50446      3829.1207    
Loop time of 6.71624e-05 on 16 procs for 1 steps with 365 atoms

57.9% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.22e-07   | 2.4837e-07 | 3.41e-07   |   0.0 |  0.37
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 8.13e-07   | 1.3386e-06 | 1.693e-06  |   0.0 |  1.99
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 6.558e-05  |            |       | 97.64

Nlocal:         45.625 ave          49 max          40 min
Histogram: 1 0 0 1 0 1 1 2 1 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -6.56 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.4 | 129.2 | 130.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -40992.445      106056.12      0              1.701333       3885.8921    
       100   730.39325     -41829.673     -11738.092      6484.9508      1.701333       3885.8921    
       200   561.72467     -42061.933     -14955.541     -2746.059       1.701333       3885.8921    
       300   429.03922     -42223.358      2763.8074     -2658.0657      1.701333       3885.8921    
       400   359.4547      -42361.768      1600.9963      2434.4571      1.701333       3885.8921    
       500   343.07771     -42481.787      10895.987      2321.2304      1.701333       3885.8921    
       600   293.69259     -42515.503     -4863.9136     -2476.7893      1.701333       3885.8921    
       700   263.21451     -42520.399      1912.1215     -5092.0305      1.701333       3885.8921    
       800   283.66691     -42536.97       3859.1217     -1086.0218      1.701333       3885.8921    
       900   317.85542     -42538.759      312.94207     -3849.5848      1.701333       3885.8921    
      1000   317.93725     -42517.622     -10403.552     -7795.0465      1.701333       3885.8921    
      1100   328.84459     -42531.149     -1897.5272     -9528.3707      1.701333       3885.8921    
      1200   304.21833     -42539.433     -3992.1591     -2448.5491      1.701333       3885.8921    
      1300   278.04415     -42546.887     -3007.7291     -2722.4032      1.701333       3885.8921    
      1400   291.15934     -42568.652     -1934.5982     -9765.0881      1.701333       3885.8921    
      1500   290.21774     -42547.519     -8501.6556     -6250.9434      1.701333       3885.8921    
      1600   312.84664     -42542.604      6584.928      -7467.7197      1.701333       3885.8921    
      1700   311.11195     -42531.999      12697.154     -4297.365       1.701333       3885.8921    
      1800   310.19744     -42552.599     -8839.9016     -6189.281       1.701333       3885.8921    
      1900   270.00049     -42544.736     -14671.596     -1631.338       1.701333       3885.8921    
      2000   291.2817      -42578.594     -4215.8018     -8742.0498      1.701333       3885.8921    
Loop time of 93.2767 on 16 procs for 2000 steps with 365 atoms

Performance: 0.926 ns/day, 25.910 hours/ns, 21.442 timesteps/s, 7.826 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 52.756     | 67.954     | 78.072     | 134.5 | 72.85
Bond    | 0.00068528 | 0.00083971 | 0.0010938  |   0.0 |  0.00
Neigh   | 4.3166     | 5.444      | 6.1723     |  36.5 |  5.84
Comm    | 0.84745    | 10.964     | 26.16      | 334.8 | 11.75
Output  | 0.001124   | 0.0012558  | 0.001944   |   0.7 |  0.00
Modify  | 8.1394     | 8.8715     | 10.011     |  28.7 |  9.51
Other   |            | 0.0418     |            |       |  0.04

Nlocal:         45.625 ave          49 max          43 min
Histogram: 3 0 0 0 0 2 1 0 1 1
Nghost:        3272.25 ave        3304 max        3239 min
Histogram: 2 1 1 0 0 0 0 1 1 2
Neighs:        29976.4 ave       31924 max       28248 min
Histogram: 3 0 0 0 0 1 2 0 1 1

Total # of neighbors = 239811
Ave neighs/atom = 657.01644
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-33-vasp_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.3172
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.8463
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 18.3222

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--8742.04984277696)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--8742.04984277696)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--5118.68065886489)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--5118.68065886489)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--992.279525140219)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--992.279525140219)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--4225.84509069967)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--4225.84509069967)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-1421.5218997189)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-1421.5218997189)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--1007.23124407572)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--1007.23124407572)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 15.3172
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.3172
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.153172 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.153172 xy delta 0.077318 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.153172 xy delta 0.077318 xz delta -0.002463 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.164028 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.164028 13.8463 18.3222) with tilt (-7.654482 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.164028 13.8463 18.3222) with tilt (-7.654482 0.243837 -0.1382)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.3 | 129.5 | 130.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.2817      -42567.16       54519.202      0              3847.0332    
       100   314.39196     -42590.936     -8225.4153      1234.7513      3847.0332    
       200   297.14862     -42570.659      8424.7234     -2016.4515      3847.0332    
       300   309.66599     -42576.199     -11786.832     -6545.4504      3847.0332    
       400   293.04803     -42548.646     -12529.778     -10649.814      3847.0332    
       500   294.82691     -42542.233     -1018.1558     -4102.2241      3847.0332    
       600   294.14661     -42542.648     -13374.544     -6262.8351      3847.0332    
       700   290.28435     -42538.681     -10145.5       -8645.2423      3847.0332    
       800   309.90429     -42560.73      -15066.391     -8628.1325      3847.0332    
       900   281.30448     -42551.445     -12076.326     -3371.3193      3847.0332    
      1000   292.50632     -42584.382     -6857.5474      2445.081       3847.0332    
      1100   285.1459      -42584.542      12171.683     -3460.5064      3847.0332    
      1200   301.18155     -42586.75       6805.8462     -1439.4687      3847.0332    
      1300   311.51945     -42568.503     -1212.9879      709.42797      3847.0332    
      1400   312.50376     -42556.045      8347.3665      324.73596      3847.0332    
      1500   311.39642     -42575.697     -3757.878      -7169.0195      3847.0332    
      1600   293.47312     -42584.087     -9337.0608     -6466.2948      3847.0332    
      1700   292.31544     -42588.077      9174.5505     -3675.5187      3847.0332    
      1800   295.21864     -42571.487     -4379.3579     -3155.3031      3847.0332    
      1900   317.88322     -42571.513      497.97907      1691.4125      3847.0332    
      2000   301.926       -42552.975     -5453.5283     -1187.4259      3847.0332    
Loop time of 95.3596 on 16 procs for 2000 steps with 365 atoms

Performance: 0.906 ns/day, 26.489 hours/ns, 20.973 timesteps/s, 7.655 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 53.775     | 69.792     | 79.632     | 137.2 | 73.19
Bond    | 0.00057199 | 0.00075799 | 0.00097454 |   0.0 |  0.00
Neigh   | 4.3635     | 5.5756     | 6.5131     |  39.5 |  5.85
Comm    | 1.1206     | 10.963     | 26.98      | 345.9 | 11.50
Output  | 0.0044092  | 0.0063562  | 0.0075163  |   1.4 |  0.01
Modify  | 8.0177     | 8.9702     | 10.203     |  31.6 |  9.41
Other   |            | 0.05092    |            |       |  0.05

Nlocal:         45.625 ave          49 max          41 min
Histogram: 1 0 0 1 0 0 4 1 0 1
Nghost:           3280 ave        3312 max        3236 min
Histogram: 1 0 1 1 1 0 0 0 2 2
Neighs:        30294.4 ave       32379 max       27361 min
Histogram: 1 0 0 1 0 0 4 1 0 1

Total # of neighbors = 242355
Ave neighs/atom = 663.9863
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.4 | 129.5 | 130.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   301.926       -42552.975     -5453.507       0              3847.0332    
       100   300.82635     -42570.351      4985.6748      3059.0502      3847.0332    
       200   292.73621     -42581.752      2471.0815      5389.8288      3847.0332    
       300   285.03743     -42571.371      3655.841      -1419.0446      3847.0332    
       400   318.8204      -42603.586      9343.7021      13.351373      3847.0332    
       500   302.13905     -42583.878      801.50212     -388.56457      3847.0332    
       600   308.60288     -42581.37       3165.0747      465.05037      3847.0332    
       700   314.51232     -42551.835     -4108.0174     -7904.073       3847.0332    
       800   321.83691     -42554.86       3250.5452     -1574.7398      3847.0332    
       900   307.58224     -42570.421      4157.6232     -8451.7001      3847.0332    
      1000   296.23354     -42572.174     -11932.175     -2447.1724      3847.0332    
      1100   309.10094     -42593.222      3841.6607     -1351.0456      3847.0332    
      1200   310.35936     -42592.423      7034.3558     -217.27426      3847.0332    
      1300   311.99571     -42582.988      41.965607     -2215.1304      3847.0332    
      1400   305.78026     -42555.732      10523.515      929.95457      3847.0332    
      1500   307.52936     -42569.105     -2496.8302     -1555.8292      3847.0332    
      1600   293.74359     -42584.614      4514.1641      293.22685      3847.0332    
      1700   292.49817     -42593.624     -4449.2158     -3231.8258      3847.0332    
      1800   296.48455     -42592.869      4744.5408     -802.89077      3847.0332    
      1900   288.45964     -42565.533     -3228.9948      3512.516       3847.0332    
      2000   331.7658      -42576.312      1370.6481     -3137.7986      3847.0332    
Loop time of 95.6624 on 16 procs for 2000 steps with 365 atoms

Performance: 0.903 ns/day, 26.573 hours/ns, 20.907 timesteps/s, 7.631 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 53.717     | 70.088     | 79.976     | 139.6 | 73.27
Bond    | 0.00055388 | 0.00075629 | 0.00099383 |   0.0 |  0.00
Neigh   | 4.393      | 5.6401     | 6.6783     |  40.8 |  5.90
Comm    | 1.0262     | 10.904     | 27.264     | 353.6 | 11.40
Output  | 0.00086869 | 0.00096379 | 0.0013933  |   0.0 |  0.00
Modify  | 7.922      | 8.9821     | 10.25      |  32.9 |  9.39
Other   |            | 0.04594    |            |       |  0.05

Nlocal:         45.625 ave          49 max          41 min
Histogram: 1 0 1 0 0 2 1 1 0 2
Nghost:        3300.38 ave        3342 max        3256 min
Histogram: 1 1 0 0 2 1 1 0 0 2
Neighs:        30293.1 ave       32483 max       27379 min
Histogram: 1 0 1 0 1 2 0 1 0 2

Total # of neighbors = 242345
Ave neighs/atom = 663.9589
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 56.7850753860063
variable C2neg equal ${d2}
variable C2neg equal 6.03658926766544
variable C3neg equal ${d3}
variable C3neg equal 30.1566610543534
variable C4neg equal ${d4}
variable C4neg equal 19.6226206036567
variable C5neg equal ${d5}
variable C5neg equal -0.255469225808818
variable C6neg equal ${d6}
variable C6neg equal -2.48381905514851

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.3172
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.153172 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.153172 xy delta -0.077318 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.153172 xy delta -0.077318 xz delta 0.002463 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.470372 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.470372 13.8463 18.3222) with tilt (-7.809118 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.470372 13.8463 18.3222) with tilt (-7.809118 0.248763 -0.1382)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126 | 127.7 | 129.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.2817      -42547.362     -49638.352      0              3924.751     
       100   308.6807      -42568.769     -8208.4487     -13555.474      3924.751     
       200   273.38998     -42532.808     -11514.065     -10162.669      3924.751     
       300   310.90685     -42563.941     -8562.6584     -13836.545      3924.751     
       400   298.72042     -42547.706     -9831.0935     -16564.847      3924.751     
       500   293.45017     -42548.335     -5053.7704     -10904.898      3924.751     
       600   288.167       -42546.974     -6836.9825     -11769.618      3924.751     
       700   286.52372     -42546.871     -3085.4145     -13088.198      3924.751     
       800   314.54552     -42578.408     -9983.1869     -10342.169      3924.751     
       900   284.95053     -42551.297     -248.40078     -10589.05       3924.751     
      1000   298.39848     -42560.512      1228.3691     -9390.1561      3924.751     
      1100   292.20924     -42551.216     -10265.004     -10558.116      3924.751     
      1200   291.67395     -42542.921     -10255.148     -7579.5424      3924.751     
      1300   298.57759     -42536.534     -5070.6562     -11220.338      3924.751     
      1400   304.54709     -42530.563     -2962.6939     -6195.7103      3924.751     
      1500   303.16061     -42539.888     -30425.579     -12791.701      3924.751     
      1600   285.79065     -42548.333     -15551.991     -15859.475      3924.751     
      1700   297.00971     -42579.429     -1404.6296     -9422.616       3924.751     
      1800   288.79792     -42570.885     -13984.214     -12419.156      3924.751     
      1900   311.26045     -42564.769     -15128.081     -14645.672      3924.751     
      2000   314.88101     -42545.046     -9853.4867     -13818.573      3924.751     
Loop time of 93.2491 on 16 procs for 2000 steps with 365 atoms

Performance: 0.927 ns/day, 25.903 hours/ns, 21.448 timesteps/s, 7.828 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 52.365     | 68.074     | 77.776     | 137.9 | 73.00
Bond    | 0.0006195  | 0.00076743 | 0.0010025  |   0.0 |  0.00
Neigh   | 4.223      | 5.4939     | 6.491      |  40.9 |  5.89
Comm    | 1.0484     | 10.753     | 26.455     | 346.7 | 11.53
Output  | 0.0043111  | 0.0059005  | 0.0068989  |   1.2 |  0.01
Modify  | 7.8547     | 8.8751     | 10.166     |  32.8 |  9.52
Other   |            | 0.04635    |            |       |  0.05

Nlocal:         45.625 ave          49 max          41 min
Histogram: 1 1 0 0 0 1 2 1 0 2
Nghost:        3243.38 ave        3273 max        3207 min
Histogram: 1 1 0 1 1 0 0 2 0 2
Neighs:        29673.6 ave       31740 max       26815 min
Histogram: 1 1 0 0 1 0 2 1 0 2

Total # of neighbors = 237389
Ave neighs/atom = 650.38082
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126 | 127.8 | 129.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   314.88101     -42545.046     -9853.5243      0              3924.751     
       100   315.7774      -42559.424     -7433.7634     -7261.022       3924.751     
       200   305.91347     -42577.482     -10962.142     -15265.703      3924.751     
       300   299.41105     -42574.073     -9672.5374     -8884.5382      3924.751     
       400   296.9305      -42571.737     -1233.4353     -8078.7781      3924.751     
       500   289.65398     -42556.804     -10680.052     -9616.2036      3924.751     
       600   301.72425     -42544.801     -11549.029     -10198.145      3924.751     
       700   299.11311     -42538.753     -21087.762     -14005.269      3924.751     
       800   301.16732     -42547.273     -4032.3917     -6270.0454      3924.751     
       900   300.57059     -42556.976      12608.68      -8706.242       3924.751     
      1000   288.25486     -42566.615     -13687.551     -13534.816      3924.751     
      1100   272.42648     -42559.24      -4776.5893     -13596.781      3924.751     
      1200   305.58181     -42576.412     -8916.2192     -15792.8        3924.751     
      1300   282.17649     -42537.548     -1018.188      -10608.459      3924.751     
      1400   314.04003     -42568.601     -12437.784     -13638.4        3924.751     
      1500   296.84791     -42561.272     -4557.9999     -13753.438      3924.751     
      1600   297.25379     -42569.741     -13020.706     -11311.834      3924.751     
      1700   300.68629     -42576.412      2651.3038     -1866.7049      3924.751     
      1800   276.42801     -42538.317     -240.44021     -10965.777      3924.751     
      1900   301.37181     -42536.881     -12427.623     -11322.4        3924.751     
      2000   312.27845     -42544.535     -5992.4698     -8678.0265      3924.751     
Loop time of 93.5654 on 16 procs for 2000 steps with 365 atoms

Performance: 0.923 ns/day, 25.990 hours/ns, 21.375 timesteps/s, 7.802 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 52.365     | 68.294     | 78.094     | 138.8 | 72.99
Bond    | 0.00063531 | 0.00077022 | 0.0010149  |   0.0 |  0.00
Neigh   | 4.3299     | 5.5643     | 6.5205     |  39.2 |  5.95
Comm    | 1.0391     | 10.841     | 26.762     | 348.2 | 11.59
Output  | 0.0008843  | 0.00098904 | 0.0014395  |   0.0 |  0.00
Modify  | 7.8391     | 8.8185     | 10.072     |  31.7 |  9.42
Other   |            | 0.04544    |            |       |  0.05

Nlocal:         45.625 ave          50 max          42 min
Histogram: 2 0 0 3 0 0 0 2 0 1
Nghost:        3244.62 ave        3262 max        3231 min
Histogram: 2 0 1 1 0 2 0 0 1 1
Neighs:        29662.1 ave       32165 max       27425 min
Histogram: 2 0 0 2 1 0 0 2 0 1

Total # of neighbors = 237297
Ave neighs/atom = 650.12877
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -0.648716743842592
variable C2pos equal ${d2}
variable C2pos equal 7.28380337351811
variable C3pos equal ${d3}
variable C3pos equal 24.0578016116485
variable C4pos equal ${d4}
variable C4pos equal -26.4112918798002
variable C5pos equal ${d5}
variable C5pos equal 19.7486397880691
variable C6pos equal ${d6}
variable C6pos equal 1.18714223461882

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(56.7850753860063+${C1pos})
variable C11 equal 0.5*(56.7850753860063+-0.648716743842592)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(6.03658926766544+${C2pos})
variable C21 equal 0.5*(6.03658926766544+7.28380337351811)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(30.1566610543534+${C3pos})
variable C31 equal 0.5*(30.1566610543534+24.0578016116485)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(19.6226206036567+${C4pos})
variable C41 equal 0.5*(19.6226206036567+-26.4112918798002)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(-0.255469225808818+${C5pos})
variable C51 equal 0.5*(-0.255469225808818+19.7486397880691)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-2.48381905514851+${C6pos})
variable C61 equal 0.5*(-2.48381905514851+1.18714223461882)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.8463
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.8463
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.138463 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.138463 yz delta 0.001382 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.3172 13.707837 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.3172 13.707837 18.3222) with tilt (-7.7318 0.2463 -0.136818)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.2 | 130.4 | 131.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.2817      -42565.733      44441.526      0              3847.0332    
       100   312.19075     -42587.865     -4774.1793     -5531.6926      3847.0332    
       200   294.40137     -42566.759     -4351.3598     -5501.3239      3847.0332    
       300   298.64253     -42561.83      -588.07427     -6180.0892      3847.0332    
       400   305.9766      -42565.809     -371.77058     -8745.7617      3847.0332    
       500   299.82814     -42563.785      1028.8539      750.37991      3847.0332    
       600   305.84568     -42575.834     -5303.8942     -2644.6473      3847.0332    
       700   307.97097     -42578.298     -2439.8542     -5191.4808      3847.0332    
       800   312.01411     -42583.449     -10779.371     -9115.8064      3847.0332    
       900   290.0023      -42561.459     -1420.4619     -812.42287      3847.0332    
      1000   288.75494     -42560.544     -3892.2851     -2638.8342      3847.0332    
      1100   285.47591     -42557.946     -15374.854     -6052.9168      3847.0332    
      1200   287.70355     -42556.184      5864.3666     -6059.9234      3847.0332    
      1300   299.67109     -42557.539      513.17878     -2079.7915      3847.0332    
      1400   331.64618     -42587.163      2175.7104     -357.31023      3847.0332    
      1500   300.78327     -42569.314      2519.715      -6668.8573      3847.0332    
      1600   300.79936     -42587.726      8049.5883     -9348.0325      3847.0332    
      1700   292.5081      -42585.674     -7730.943      -5584.6397      3847.0332    
      1800   292.9504      -42572.2       -10535.808     -10670.228      3847.0332    
      1900   318.17492     -42578.137     -14107.545     -8858.9322      3847.0332    
      2000   306.91929     -42569.928     -30.084396     -7327.2619      3847.0332    
Loop time of 95.9554 on 16 procs for 2000 steps with 365 atoms

Performance: 0.900 ns/day, 26.654 hours/ns, 20.843 timesteps/s, 7.608 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 53.781     | 70.17      | 79.98      | 139.9 | 73.13
Bond    | 0.00068072 | 0.0008191  | 0.0011734  |   0.0 |  0.00
Neigh   | 4.4235     | 5.6763     | 6.6869     |  40.4 |  5.92
Comm    | 1.1934     | 11.027     | 27.415     | 352.9 | 11.49
Output  | 0.0046151  | 0.0074462  | 0.0088952  |   1.9 |  0.01
Modify  | 7.9947     | 9.0245     | 10.295     |  32.5 |  9.40
Other   |            | 0.04912    |            |       |  0.05

Nlocal:         45.625 ave          50 max          43 min
Histogram: 1 1 4 0 0 0 0 1 0 1
Nghost:        3288.62 ave        3334 max        3240 min
Histogram: 1 1 1 0 0 1 1 1 1 1
Neighs:        30289.5 ave       33059 max       28705 min
Histogram: 1 1 4 0 0 0 0 1 0 1

Total # of neighbors = 242316
Ave neighs/atom = 663.87945
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.2 | 130.4 | 131.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   306.91929     -42569.928     -30.070645      0              3847.0332    
       100   306.45216     -42584.212     -8061.1331     -7561.4638      3847.0332    
       200   293.9387      -42593.874     -5066.7058     -8668.3984      3847.0332    
       300   302.60456     -42596.317      1860.3608     -4111.1404      3847.0332    
       400   292.25424     -42580.135      15290.679     -7162.8489      3847.0332    
       500   318.41476     -42605.269     -2520.775      -5066.3213      3847.0332    
       600   311.46665     -42608.911      6277.8741     -2297.3813      3847.0332    
       700   279.27294     -42606.285     -4080.6475      21.044059      3847.0332    
       800   283.34514     -42607.58       1253.2448     -3584.089       3847.0332    
       900   304.84109     -42611.393     -8018.535      -13999.382      3847.0332    
      1000   307.10508     -42606.338      1497.1505     -7275.4803      3847.0332    
      1100   303.53513     -42597.55      -11319.184     -6281.9535      3847.0332    
      1200   286.25355     -42579.124      1674.2        -1210.6236      3847.0332    
      1300   309.1357      -42616.439     -2609.473      -1946.7527      3847.0332    
      1400   307.05715     -42631.216     -1437.8544     -6737.8462      3847.0332    
      1500   286.40598     -42601.808      3326.666      -7879.6975      3847.0332    
      1600   302.88466     -42588.479     -6859.5843     -4041.5952      3847.0332    
      1700   323.4272      -42607.641     -8741.5983     -5656.0518      3847.0332    
      1800   308.14119     -42607.41      -3657.5919     -7680.4556      3847.0332    
      1900   318.0706      -42624.645     -5239.2367     -3134.2739      3847.0332    
      2000   286.14511     -42594.935      1817.5098     -1561.6714      3847.0332    
Loop time of 96.3691 on 16 procs for 2000 steps with 365 atoms

Performance: 0.897 ns/day, 26.769 hours/ns, 20.754 timesteps/s, 7.575 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 53.981     | 70.504     | 80.792     | 139.1 | 73.16
Bond    | 0.00067971 | 0.00082865 | 0.0012313  |   0.0 |  0.00
Neigh   | 4.3168     | 5.6196     | 6.6377     |  40.7 |  5.83
Comm    | 0.87791    | 11.162     | 27.677     | 349.4 | 11.58
Output  | 0.00084289 | 0.00094783 | 0.0013429  |   0.0 |  0.00
Modify  | 8.0005     | 9.0368     | 10.357     |  32.5 |  9.38
Other   |            | 0.04489    |            |       |  0.05

Nlocal:         45.625 ave          49 max          42 min
Histogram: 1 1 1 0 0 1 0 3 0 1
Nghost:           3313 ave        3352 max        3263 min
Histogram: 1 1 2 0 0 0 0 0 0 4
Neighs:        30306.1 ave       32414 max       28092 min
Histogram: 1 1 1 0 0 0 2 2 0 1

Total # of neighbors = 242449
Ave neighs/atom = 664.24384
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 72.7551849908551
variable C2neg equal ${d2}
variable C2neg equal 71.3511242887371
variable C3neg equal ${d3}
variable C3neg equal 46.7254086595398
variable C4neg equal ${d4}
variable C4neg equal 9.3348647391909
variable C5neg equal ${d5}
variable C5neg equal -3.68758408049662
variable C6neg equal ${d6}
variable C6neg equal 4.07642362842978

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.8463
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.138463 yz delta ${deltayz} remap units box
change_box all y delta 0 0.138463 yz delta -0.001382 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.3172 13.984763 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.3172 13.984763 18.3222) with tilt (-7.7318 0.2463 -0.139582)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.3 | 127.9 | 129.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.2817      -42555.262     -51808.577      0              3924.751     
       100   304.41342     -42566.916     -11573.796     -8115.136       3924.751     
       200   281.78685     -42536.206     -5542.2094     -9013.8827      3924.751     
       300   307.07528     -42549.536     -9136.5077     -9218.5468      3924.751     
       400   288.86121     -42527.522     -938.83154     -10737.91       3924.751     
       500   298.54405     -42547.76       5267.9326     -6712.0175      3924.751     
       600   293.32621     -42549.065     -10967.855     -9104.3818      3924.751     
       700   299.39733     -42558.887     -11079.279     -7896.1181      3924.751     
       800   298.13551     -42561.412     -9585.3744     -6174.9952      3924.751     
       900   305.47378     -42567.532     -14549.527     -12074.097      3924.751     
      1000   310.88378     -42568.613      3650.2722     -5678.3592      3924.751     
      1100   286.50332     -42538.805      1249.0882     -3644.3397      3924.751     
      1200   304.46855     -42555.187     -17514.522     -6025.6683      3924.751     
      1300   296.28857     -42552.4       -13049.659     -6618.2723      3924.751     
      1400   299.65746     -42560.176     -13303.022     -7395.5045      3924.751     
      1500   299.32022     -42562.942     -3863.3498     -9878.8289      3924.751     
      1600   318.85803     -42585.826     -8080.7756     -3261.05        3924.751     
      1700   286.82296     -42565.824     -327.54572     -5284.1331      3924.751     
      1800   290.33301     -42565.046      801.34242     -6932.3054      3924.751     
      1900   292.04981     -42554.55      -17009.826     -5040.1375      3924.751     
      2000   303.27027     -42561.222     -7489.3393     -7018.6016      3924.751     
Loop time of 93.0488 on 16 procs for 2000 steps with 365 atoms

Performance: 0.929 ns/day, 25.847 hours/ns, 21.494 timesteps/s, 7.845 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.884     | 67.986     | 77.625     | 139.0 | 73.07
Bond    | 0.00060118 | 0.00078734 | 0.00090642 |   0.0 |  0.00
Neigh   | 4.2658     | 5.4812     | 6.4754     |  39.7 |  5.89
Comm    | 1.0988     | 10.739     | 26.839     | 349.5 | 11.54
Output  | 0.004399   | 0.0062003  | 0.0072801  |   1.3 |  0.01
Modify  | 7.77       | 8.7855     | 10.023     |  31.8 |  9.44
Other   |            | 0.05026    |            |       |  0.05

Nlocal:         45.625 ave          49 max          41 min
Histogram: 1 0 1 0 0 2 0 2 1 1
Nghost:        3242.88 ave        3271 max        3214 min
Histogram: 2 0 1 0 0 0 3 1 0 1
Neighs:        29647.9 ave       31604 max       26868 min
Histogram: 1 0 1 0 2 0 0 1 2 1

Total # of neighbors = 237183
Ave neighs/atom = 649.81644
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.3 | 127.9 | 129.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   303.27027     -42561.222     -7489.3701      0              3924.751     
       100   302.49033     -42565.462     -4298.0601     -7023.3767      3924.751     
       200   283.24064     -42565.619     -1188.3521     -6975.6578      3924.751     
       300   292.34397     -42594.057     -2696.2437     -2489.7034      3924.751     
       400   285.54529     -42580.459     -7103.0328     -10201.769      3924.751     
       500   318.86904     -42579.905      3851.8605     -3728.7567      3924.751     
       600   302.57546     -42552.821     -12947.783     -7844.1686      3924.751     
       700   303.16114     -42543.584     -6893.2285     -9119.0827      3924.751     
       800   304.68589     -42547.89      -11516.427     -3870.5781      3924.751     
       900   292.40991     -42569.097     -10634.263     -12367.913      3924.751     
      1000   273.60101     -42558.749     -16091.97      -5024.417       3924.751     
      1100   297.45855     -42563.137      1317.3797     -10932.767      3924.751     
      1200   305.32392     -42553.016     -16199.863     -5414.1033      3924.751     
      1300   302.02011     -42553.981     -4001.5047     -7860.483       3924.751     
      1400   290.78172     -42543.612     -8566.3438     -4007.3023      3924.751     
      1500   305.6644      -42561.771     -13479.086     -4743.5118      3924.751     
      1600   302.15992     -42559.871     -3450.8448     -6332.5465      3924.751     
      1700   313.67849     -42550.494      6896.2593     -5509.7322      3924.751     
      1800   335.10378     -42546.376      10862.695     -2927.2669      3924.751     
      1900   311.99785     -42535.568      2289.2456     -7497.3779      3924.751     
      2000   289.44439     -42542.245      3583.3878     -8586.7426      3924.751     
Loop time of 93.2771 on 16 procs for 2000 steps with 365 atoms

Performance: 0.926 ns/day, 25.910 hours/ns, 21.441 timesteps/s, 7.826 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 52.029     | 68.21      | 77.824     | 139.9 | 73.13
Bond    | 0.00060423 | 0.00078464 | 0.00090076 |   0.0 |  0.00
Neigh   | 4.2751     | 5.5136     | 6.4937     |  39.4 |  5.91
Comm    | 1.1305     | 10.755     | 26.931     | 352.1 | 11.53
Output  | 0.00091049 | 0.0010254  | 0.0014279  |   0.5 |  0.00
Modify  | 7.7501     | 8.7512     | 10.012     |  31.8 |  9.38
Other   |            | 0.04579    |            |       |  0.05

Nlocal:         45.625 ave          51 max          40 min
Histogram: 1 0 1 2 0 0 1 2 0 1
Nghost:        3239.25 ave        3280 max        3195 min
Histogram: 2 0 0 0 1 2 1 0 0 2
Neighs:        29649.8 ave       32849 max       26223 min
Histogram: 1 0 1 1 1 0 1 2 0 1

Total # of neighbors = 237198
Ave neighs/atom = 649.85753
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -1.57365050957451
variable C2pos equal ${d2}
variable C2pos equal -2.42258647946019
variable C3pos equal ${d3}
variable C3pos equal -2.45357666103239
variable C4pos equal ${d4}
variable C4pos equal -8.23990806141581
variable C5pos equal ${d5}
variable C5pos equal -12.8111710545247
variable C6pos equal ${d6}
variable C6pos equal -10.3650016408493

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(72.7551849908551+${C1pos})
variable C12 equal 0.5*(72.7551849908551+-1.57365050957451)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(71.3511242887371+${C2pos})
variable C22 equal 0.5*(71.3511242887371+-2.42258647946019)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(46.7254086595398+${C3pos})
variable C32 equal 0.5*(46.7254086595398+-2.45357666103239)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(9.3348647391909+${C4pos})
variable C42 equal 0.5*(9.3348647391909+-8.23990806141581)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(-3.68758408049662+${C5pos})
variable C52 equal 0.5*(-3.68758408049662+-12.8111710545247)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(4.07642362842978+${C6pos})
variable C62 equal 0.5*(4.07642362842978+-10.3650016408493)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 18.3222
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*18.3222
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.183222 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.3172 13.8463 18.138978) with tilt (-7.7318 0.2463 -0.1382)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.3 | 129.5 | 130.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.2817      -42555.881      52770.66       0              3847.0332    
       100   312.78343     -42581.886     -10157.295     -3919.2484      3847.0332    
       200   299.82529     -42572.464      7598.3348     -5012.9491      3847.0332    
       300   303.93746     -42572.351     -6945.7489     -3604.1006      3847.0332    
       400   301.36203     -42559.369     -6978.3895     -7537.4329      3847.0332    
       500   299.90161     -42543.397      9696.3162     -2586.5027      3847.0332    
       600   293.41871     -42543.094     -7016.6329     -5347.4073      3847.0332    
       700   303.41878     -42572.807     -5478.0173     -6837.7954      3847.0332    
       800   306.78653     -42592.143     -5462.1148     -8379.2801      3847.0332    
       900   297.66252     -42588.324      1721.3906     -4465.7028      3847.0332    
      1000   278.6563      -42557.579      10869.139     -2157.7069      3847.0332    
      1100   307.85427     -42569.362     -10388.991     -1748.9186      3847.0332    
      1200   305.20236     -42551.651      6929.0337     -3384.4924      3847.0332    
      1300   302.76187     -42547.863      7431.5897     -1315.4841      3847.0332    
      1400   304.52709     -42561.521     -4321.4057     -2205.1385      3847.0332    
      1500   275.06442     -42554.578     -3535.4392     -7793.5375      3847.0332    
      1600   274.86289     -42572.669     -7000.1269     -9140.472       3847.0332    
      1700   291.74158     -42583.326     -62.079522     -6114.9485      3847.0332    
      1800   311.1801      -42577.591     -11108.684     -8723.9958      3847.0332    
      1900   304.16231     -42550.748     -14669.417     -10818.292      3847.0332    
      2000   315.78968     -42572.622      1334.3657     -2784.2284      3847.0332    
Loop time of 96.0247 on 16 procs for 2000 steps with 365 atoms

Performance: 0.900 ns/day, 26.674 hours/ns, 20.828 timesteps/s, 7.602 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.261     | 70.39      | 80.414     | 141.3 | 73.30
Bond    | 0.00065817 | 0.00081143 | 0.0010452  |   0.0 |  0.00
Neigh   | 4.37       | 5.5986     | 6.5642     |  39.4 |  5.83
Comm    | 1.0784     | 11.103     | 27.231     | 355.6 | 11.56
Output  | 0.0045427  | 0.0072553  | 0.0086426  |   1.8 |  0.01
Modify  | 7.8868     | 8.8744     | 10.118     |  31.7 |  9.24
Other   |            | 0.05031    |            |       |  0.05

Nlocal:         45.625 ave          51 max          41 min
Histogram: 1 1 1 0 1 2 0 0 0 2
Nghost:        3290.62 ave        3316 max        3274 min
Histogram: 1 1 1 2 1 0 1 0 0 1
Neighs:        30303.1 ave       33608 max       27419 min
Histogram: 1 1 1 1 2 0 0 0 0 2

Total # of neighbors = 242425
Ave neighs/atom = 664.17808
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.3 | 129.5 | 130.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   315.78968     -42572.622      1334.3483      0              3847.0332    
       100   290.76996     -42561.843     -13660.441     -582.22543      3847.0332    
       200   278.89763     -42573.318     -3945.2819     -1469.7786      3847.0332    
       300   297.52367     -42596.035      4298.4879     -6798.0507      3847.0332    
       400   298.06604     -42593.023      7378.6947     -1530.3837      3847.0332    
       500   317.65361     -42601.877      3087.2513     -704.58926      3847.0332    
       600   300.28909     -42573.009     -10589.182     -4069.2668      3847.0332    
       700   310.25079     -42550.744     -15365.055     -3878.218       3847.0332    
       800   332.16253     -42557.308     -3939.3196     -5441.2766      3847.0332    
       900   310.78345     -42565.291      2776.9055     -6653.497       3847.0332    
      1000   301.70612     -42571.918     -4650.7368     -9268.9556      3847.0332    
      1100   307.23872     -42585.66      -4478.8665     -2825.6937      3847.0332    
      1200   292.91662     -42587.822     -3739.0369     -7641.5571      3847.0332    
      1300   295.58858     -42619.394     -1966.052      -4175.293       3847.0332    
      1400   288.86812     -42611.995     -5379.0408     -3666.0476      3847.0332    
      1500   298.48659     -42606.565     -18728.772     -1638.3806      3847.0332    
      1600   303.25765     -42599.991      8914.4257     -6124.3052      3847.0332    
      1700   293.55707     -42588.8       -2312.535      -2839.5564      3847.0332    
      1800   303.88468     -42598.831      1969.2728     -7953.2154      3847.0332    
      1900   288.14429     -42603.236      3064.2602     -1532.0555      3847.0332    
      2000   298.42825     -42638.014     -223.0138      -5730.784       3847.0332    
Loop time of 95.5826 on 16 procs for 2000 steps with 365 atoms

Performance: 0.904 ns/day, 26.551 hours/ns, 20.924 timesteps/s, 7.637 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 53.996     | 67.666     | 79.903     | 140.6 | 70.79
Bond    | 0.00070759 | 0.00082558 | 0.0010007  |   0.0 |  0.00
Neigh   | 4.3883     | 5.3408     | 6.3386     |  39.0 |  5.59
Comm    | 1.3686     | 13.606     | 27.288     | 313.7 | 14.24
Output  | 0.00089121 | 0.0010024  | 0.0014342  |   0.5 |  0.00
Modify  | 7.919      | 8.9209     | 9.8735     |  30.3 |  9.33
Other   |            | 0.04649    |            |       |  0.05

Nlocal:         45.625 ave          51 max          42 min
Histogram: 1 1 1 1 1 2 0 0 0 1
Nghost:        3307.25 ave        3353 max        3268 min
Histogram: 1 1 1 1 0 1 2 0 0 1
Neighs:        30277.5 ave       33524 max       28079 min
Histogram: 2 0 1 1 1 2 0 0 0 1

Total # of neighbors = 242220
Ave neighs/atom = 663.61644
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 30.5116511232761
variable C2neg equal ${d2}
variable C2neg equal 24.6260487386965
variable C3neg equal ${d3}
variable C3neg equal 34.3351825912015
variable C4neg equal ${d4}
variable C4neg equal -3.6891382494528
variable C5neg equal ${d5}
variable C5neg equal -0.358677406261676
variable C6neg equal ${d6}
variable C6neg equal -8.80707778489784

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*18.3222
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.183222 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.3172 13.8463 18.505422) with tilt (-7.7318 0.2463 -0.1382)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.3 | 127.7 | 129.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.2817      -42562.589     -50692.926      0              3924.751     
       100   314.42883     -42585.264     -17168.132     -9134.7929      3924.751     
       200   275.56705     -42536.3       -7908.2345     -7787.7418      3924.751     
       300   317.88102     -42568.316     -4628.2001     -13324.064      3924.751     
       400   298.48061     -42542.796     -10161.228     -10484.521      3924.751     
       500   298.41681     -42546.873      2371.2191     -8235.8814      3924.751     
       600   300.28226     -42557.885      1390.2396     -10789.94       3924.751     
       700   291.71647     -42558.269     -14700.826     -8364.9011      3924.751     
       800   294.18047     -42568.086     -12681.928     -14868.665      3924.751     
       900   295.69879     -42571.984     -5461.4677     -11721.278      3924.751     
      1000   291.51245     -42562.456     -52.681363     -6661.6012      3924.751     
      1100   297.51942     -42556.292      9615.8805     -9857.1743      3924.751     
      1200   293.9518      -42535.559      310.82846     -5984.1975      3924.751     
      1300   322.88119     -42555.771      9851.8335     -4847.4076      3924.751     
      1400   312.52526     -42563.209     -689.1783       529.07454      3924.751     
      1500   281.61056     -42557.215      4948.2984     -2528.2266      3924.751     
      1600   279.20556     -42569.729      4870.3829     -9053.7282      3924.751     
      1700   295.62807     -42568.383     -19718.286     -8681.2793      3924.751     
      1800   292.68276     -42531.835     -13010.498     -9997.8243      3924.751     
      1900   303.17527     -42530.28      -7910.2842     -10989.763      3924.751     
      2000   294.8918      -42529.326      5445.7165     -6550.7862      3924.751     
Loop time of 91.0722 on 16 procs for 2000 steps with 365 atoms

Performance: 0.949 ns/day, 25.298 hours/ns, 21.961 timesteps/s, 8.016 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 52.485     | 63.103     | 76.417     | 129.0 | 69.29
Bond    | 0.00068403 | 0.00081791 | 0.0009908  |   0.0 |  0.00
Neigh   | 4.265      | 5.068      | 6.1943     |  37.6 |  5.56
Comm    | 1.1079     | 14.424     | 25.047     | 269.9 | 15.84
Output  | 0.0039504  | 0.0059957  | 0.0070273  |   1.5 |  0.01
Modify  | 7.3034     | 8.4286     | 9.2291     |  29.1 |  9.25
Other   |            | 0.0426     |            |       |  0.05

Nlocal:         45.625 ave          51 max          43 min
Histogram: 3 0 2 1 0 0 0 1 0 1
Nghost:        3263.25 ave        3333 max        3197 min
Histogram: 2 0 0 2 0 1 1 0 1 1
Neighs:          29619 ave       32790 max       28053 min
Histogram: 3 0 2 1 0 0 0 1 0 1

Total # of neighbors = 236952
Ave neighs/atom = 649.18356
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.2 | 127.8 | 129.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.8918      -42529.326      5445.6657      0              3924.751     
       100   316.18349     -42558.908     -7085.4267     -10344.225      3924.751     
       200   288.37552     -42566.9       -15903.74      -12134.536      3924.751     
       300   296.44173     -42581.61      -13027.299     -4732.7338      3924.751     
       400   302.9488      -42590.574      2704.8454     -2855.5383      3924.751     
       500   286.27017     -42574.384     -4387.9382     -9271.628       3924.751     
       600   324.47623     -42602.505     -12055.284     -10721.005      3924.751     
       700   325.67797     -42579.235     -5522.5815     -12078.459      3924.751     
       800   307.02516     -42559.537     -9911.5195     -7883.6842      3924.751     
       900   298.84725     -42589.424     -11621.524     -11521.342      3924.751     
      1000   294.5933      -42597.669     -10062.523     -9263.2787      3924.751     
      1100   291.48161     -42600.22      -7958.924      -8128.9939      3924.751     
      1200   305.09736     -42602.947     -3859.4062     -10001.532      3924.751     
      1300   325.53767     -42596.079     -12462.027     -11217.853      3924.751     
      1400   299.45146     -42572.334     -8176.6908     -8432.1517      3924.751     
      1500   324.33564     -42606.621     -3154.1622     -8754.7246      3924.751     
      1600   285.43078     -42588.266     -14104.892     -10680.72       3924.751     
      1700   315.17478     -42621.441     -9603.5159     -9697.9318      3924.751     
      1800   294.23494     -42598.403     -17413.547     -12729.865      3924.751     
      1900   285.98927     -42591.591     -9102.7223     -7121.3446      3924.751     
      2000   286.06649     -42606.084     -7893.9563     -9036.3712      3924.751     
Loop time of 92.8799 on 16 procs for 2000 steps with 365 atoms

Performance: 0.930 ns/day, 25.800 hours/ns, 21.533 timesteps/s, 7.860 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 52.933     | 65.43      | 77.734     | 147.1 | 70.45
Bond    | 0.00067732 | 0.00080644 | 0.0010096  |   0.0 |  0.00
Neigh   | 4.3406     | 5.3325     | 6.3767     |  41.3 |  5.74
Comm    | 1.1347     | 13.436     | 25.936     | 324.6 | 14.47
Output  | 0.00080712 | 0.00090735 | 0.0012468  |   0.0 |  0.00
Modify  | 7.5886     | 8.6393     | 9.6398     |  32.6 |  9.30
Other   |            | 0.04075    |            |       |  0.04

Nlocal:         45.625 ave          52 max          43 min
Histogram: 1 3 1 1 1 0 0 0 0 1
Nghost:        3251.12 ave        3287 max        3216 min
Histogram: 2 0 1 1 0 0 1 1 1 1
Neighs:        29630.5 ave       33529 max       27878 min
Histogram: 1 3 1 1 1 0 0 0 0 1

Total # of neighbors = 237044
Ave neighs/atom = 649.43562
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 2.98221128524789
variable C2pos equal ${d2}
variable C2pos equal 53.223091322288
variable C3pos equal ${d3}
variable C3pos equal -10.132489826307
variable C4pos equal ${d4}
variable C4pos equal 2.39439870348545
variable C5pos equal ${d5}
variable C5pos equal -0.973553333390687
variable C6pos equal ${d6}
variable C6pos equal -5.79555191748616

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(30.5116511232761+${C1pos})
variable C13 equal 0.5*(30.5116511232761+2.98221128524789)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(24.6260487386965+${C2pos})
variable C23 equal 0.5*(24.6260487386965+53.223091322288)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(34.3351825912015+${C3pos})
variable C33 equal 0.5*(34.3351825912015+-10.132489826307)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-3.6891382494528+${C4pos})
variable C43 equal 0.5*(-3.6891382494528+2.39439870348545)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-0.358677406261676+${C5pos})
variable C53 equal 0.5*(-0.358677406261676+-0.973553333390687)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-8.80707778489784+${C6pos})
variable C63 equal 0.5*(-8.80707778489784+-5.79555191748616)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 18.3222
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*18.3222
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.183222 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.321422)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.9 | 129.1 | 130.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.2817      -42574.991     -4061.1713      0              3885.8921    
       100   309.20943     -42587.44      -10512.025     -7678.0186      3885.8921    
       200   286.24931     -42547.744      3014.693      -9453.1537      3885.8921    
       300   313.62527     -42559.51      -12153.879     -10115.214      3885.8921    
       400   307.68039     -42552.711     -3984.6801     -10766.045      3885.8921    
       500   297.97837     -42550.431     -15270.243     -6719.1095      3885.8921    
       600   300.21691     -42555.407      396.03483     -5802.3071      3885.8921    
       700   302.26495     -42562.4       -5235.8753     -5236.0643      3885.8921    
       800   317.02263     -42586.34      -193.91522     -7913.3109      3885.8921    
       900   309.02771     -42578.807      1715.6467     -9709.1693      3885.8921    
      1000   316.6279      -42582.274     -6251.27       -5363.6142      3885.8921    
      1100   293.62499     -42546.107     -6960.27       -5911.5887      3885.8921    
      1200   301.4522      -42542.816     -834.72321     -1341.974       3885.8921    
      1300   291.95738     -42542.437     -3833.2944     -5612.2256      3885.8921    
      1400   287.29045     -42549.135     -6269.0454     -3434.7928      3885.8921    
      1500   298.36331     -42565.627     -4952.1447     -6157.0533      3885.8921    
      1600   306.68905     -42577.729     -8152.6189     -8802.3133      3885.8921    
      1700   313.38875     -42583.94       4246.8306     -6241.5308      3885.8921    
      1800   281.5787      -42545.853     -8881.9341     -1593.8454      3885.8921    
      1900   305.71297     -42562.761     -13274.951     -7489.5409      3885.8921    
      2000   307.52576     -42562.598     -7159.111      -1044.3607      3885.8921    
Loop time of 92.905 on 16 procs for 2000 steps with 365 atoms

Performance: 0.930 ns/day, 25.807 hours/ns, 21.527 timesteps/s, 7.857 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 53.693     | 65.695     | 78.147     | 141.5 | 70.71
Bond    | 0.00064831 | 0.00081338 | 0.00097779 |   0.0 |  0.00
Neigh   | 4.4056     | 5.3521     | 6.3364     |  39.4 |  5.76
Comm    | 0.8414     | 13.3       | 25.302     | 314.5 | 14.32
Output  | 0.0039688  | 0.006303   | 0.0074119  |   1.7 |  0.01
Modify  | 7.5161     | 8.5099     | 9.4577     |  31.5 |  9.16
Other   |            | 0.04069    |            |       |  0.04

Nlocal:         45.625 ave          49 max          39 min
Histogram: 1 0 0 0 0 1 1 0 4 1
Nghost:         3296.5 ave        3338 max        3255 min
Histogram: 1 1 1 0 1 1 0 1 1 1
Neighs:        29994.2 ave       32065 max       25860 min
Histogram: 1 0 0 0 0 1 1 3 1 1

Total # of neighbors = 239954
Ave neighs/atom = 657.40822
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.9 | 129.1 | 130.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.52576     -42562.598     -7159.0856      0              3885.8921    
       100   307.28601     -42570.244      698.65463     -8012.0636      3885.8921    
       200   286.53559     -42577.638      7759.6118     -2819.7715      3885.8921    
       300   263.70274     -42566.918     -5705.8939     -6498.1318      3885.8921    
       400   278.85325     -42567.609      8518.8219     -10106.861      3885.8921    
       500   304.14662     -42576.041     -10097.08      -2744.4716      3885.8921    
       600   292.17901     -42551.881      7597.9983     -6877.5424      3885.8921    
       700   300.35173     -42551.446     -6103.7695      716.31708      3885.8921    
       800   298.88303     -42564.764     -7170.9873     -2144.1421      3885.8921    
       900   273.58303     -42569.348     -12996.324     -4505.4727      3885.8921    
      1000   300.86741     -42588.271      6120.1205     -1841.258       3885.8921    
      1100   299.18095     -42570.192      3686.7108     -6039.2661      3885.8921    
      1200   292.78296     -42552.388     -8084.1831     -8991.6606      3885.8921    
      1300   301.47621     -42553.602     -14616.295     -10287.838      3885.8921    
      1400   304.58553     -42554.923     -5626.8413     -4961.2045      3885.8921    
      1500   300.0185      -42568.05      -951.73501     -5942.3159      3885.8921    
      1600   282.5457      -42567.603      9948.8755     -3231.2733      3885.8921    
      1700   301.07686     -42586.047     -3709.3989     -3585.6526      3885.8921    
      1800   308.87026     -42571.753      2149.5788     -4506.0688      3885.8921    
      1900   298.48333     -42547.453     -5524.5029     -5247.9241      3885.8921    
      2000   303.44089     -42568.655      3649.4801     -6415.4731      3885.8921    
Loop time of 92.9625 on 16 procs for 2000 steps with 365 atoms

Performance: 0.929 ns/day, 25.823 hours/ns, 21.514 timesteps/s, 7.853 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.21      | 65.041     | 78.514     | 123.5 | 69.96
Bond    | 0.00060831 | 0.00079186 | 0.0009644  |   0.0 |  0.00
Neigh   | 4.319      | 5.2398     | 6.3161     |  36.1 |  5.64
Comm    | 0.65728    | 14.136     | 24.975     | 264.9 | 15.21
Output  | 0.00079782 | 0.00092024 | 0.001311   |   0.0 |  0.00
Modify  | 7.4196     | 8.5024     | 9.4379     |  28.5 |  9.15
Other   |            | 0.04218    |            |       |  0.05

Nlocal:         45.625 ave          51 max          42 min
Histogram: 1 0 0 4 2 0 0 0 0 1
Nghost:        3266.75 ave        3303 max        3229 min
Histogram: 2 0 0 1 0 2 1 0 0 2
Neighs:        29972.5 ave       33206 max       27727 min
Histogram: 1 0 0 4 2 0 0 0 0 1

Total # of neighbors = 239780
Ave neighs/atom = 656.93151
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 23.5740389545854
variable C2neg equal ${d2}
variable C2neg equal -22.0028277474034
variable C3neg equal ${d3}
variable C3neg equal 18.4845201385752
variable C4neg equal ${d4}
variable C4neg equal 25.9270701383719
variable C5neg equal ${d5}
variable C5neg equal -2.72189725018274
variable C6neg equal ${d6}
variable C6neg equal 10.1787675735011

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*18.3222
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.183222 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 0.045022)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.9 | 129 | 130.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.2817      -42573.834     -3910.4479      0              3885.8921    
       100   309.89693     -42587.472     -9620.9172     -7810.6539      3885.8921    
       200   291.44545     -42553.589     -26.475882     -7695.0891      3885.8921    
       300   303.94892     -42546.639     -9160.4674     -11629.589      3885.8921    
       400   301.28897     -42534.612     -11235.432     -10941.938      3885.8921    
       500   321.65233     -42560.735     -1641.8001     -3438.6393      3885.8921    
       600   303.19708     -42560.417     -1532.7432     -10003.361      3885.8921    
       700   285.78048     -42561.677     -5325.7681     -8616.7517      3885.8921    
       800   291.24653     -42573.649     -8960.0986     -9158.8307      3885.8921    
       900   289.82785     -42576.205      4416.798      -2936.558       3885.8921    
      1000   295.81423     -42570.489     -7314.7863     -7385.1091      3885.8921    
      1100   300.81745     -42560.235      313.68405     -4395.2662      3885.8921    
      1200   294.91284     -42538.472     -3617.5705     -6814.313       3885.8921    
      1300   309.31166     -42541.998     -12494.947     -3444.3655      3885.8921    
      1400   309.10242     -42553.732      2290.6946      5351.232       3885.8921    
      1500   286.63696     -42554.953     -3976.3087     -8407.1104      3885.8921    
      1600   294.61522     -42578.482     -1161.615      -10490.831      3885.8921    
      1700   287.36076     -42562.229     -5597.4273     -3693.8378      3885.8921    
      1800   304.65582     -42558.45      -5130.6802     -11194.39       3885.8921    
      1900   310.7433      -42549.989      9139.8238     -5165.0231      3885.8921    
      2000   292.30658     -42544.26      -1985.0019     -9968.9528      3885.8921    
Loop time of 92.541 on 16 procs for 2000 steps with 365 atoms

Performance: 0.934 ns/day, 25.706 hours/ns, 21.612 timesteps/s, 7.888 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.116     | 65.655     | 78.131     | 133.6 | 70.95
Bond    | 0.00062103 | 0.00079776 | 0.00099006 |   0.0 |  0.00
Neigh   | 4.277      | 5.2024     | 6.1755     |  36.8 |  5.62
Comm    | 0.67416    | 13.157     | 24.693     | 298.5 | 14.22
Output  | 0.0038145  | 0.0053595  | 0.00619    |   1.2 |  0.01
Modify  | 7.4999     | 8.4771     | 9.4087     |  29.1 |  9.16
Other   |            | 0.04335    |            |       |  0.05

Nlocal:         45.625 ave          51 max          43 min
Histogram: 1 2 1 3 0 0 0 0 0 1
Nghost:        3273.62 ave        3310 max        3246 min
Histogram: 2 2 0 0 0 1 0 1 1 1
Neighs:        29964.1 ave       33096 max       28417 min
Histogram: 2 1 0 4 0 0 0 0 0 1

Total # of neighbors = 239713
Ave neighs/atom = 656.74795
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.9 | 129 | 130.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   292.30658     -42544.26      -1985.015       0              3885.8921    
       100   313.15587     -42572.204      1041.6741      1610.0432      3885.8921    
       200   293.94713     -42580.746     -3454.116      -6277.3639      3885.8921    
       300   275.70659     -42582.13       5774.3733     -274.15603      3885.8921    
       400   286.28994     -42589.276     -9225.9115     -4770.7384      3885.8921    
       500   298.03383     -42592.821     -10545.299     -3570.1757      3885.8921    
       600   305.21032     -42598.264      7520.0663     -8818.8447      3885.8921    
       700   295.82419     -42581.661      1002.1677     -9421.9353      3885.8921    
       800   306.47416     -42573.364     -9180.8988     -11116.859      3885.8921    
       900   316.43989     -42555.529     -8371.6641     -8843.4849      3885.8921    
      1000   317.76742     -42542.904     -3448.5719     -10602.347      3885.8921    
      1100   310.40143     -42578.982      1739.0338     -10727.755      3885.8921    
      1200   319.70088     -42608.896      259.08419     -4539.906       3885.8921    
      1300   296.99002     -42600.129      1.6269621     -4014.1615      3885.8921    
      1400   293.92454     -42598.445      6130.3265     -5097.0944      3885.8921    
      1500   303.04659     -42583.37      -5813.4429     -11785.799      3885.8921    
      1600   317.95179     -42574.875     -11430.51      -9452.1912      3885.8921    
      1700   302.80166     -42563.932      8685.9989     -635.84334      3885.8921    
      1800   308.29153     -42579.395     -9235.5357     -3784.6744      3885.8921    
      1900   283.28944     -42569.217      3525.3974     -4785.2253      3885.8921    
      2000   313.18227     -42606.016     -8380.7264     -3980.769       3885.8921    
Loop time of 93.2398 on 16 procs for 2000 steps with 365 atoms

Performance: 0.927 ns/day, 25.900 hours/ns, 21.450 timesteps/s, 7.829 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 53.431     | 65.761     | 78.71      | 143.0 | 70.53
Bond    | 0.00061765 | 0.00081286 | 0.00097058 |   0.0 |  0.00
Neigh   | 4.2988     | 5.2281     | 6.2445     |  39.3 |  5.61
Comm    | 0.6681     | 13.609     | 25.94      | 314.3 | 14.60
Output  | 0.00075085 | 0.00084813 | 0.0011315  |   0.0 |  0.00
Modify  | 7.5723     | 8.5944     | 9.5314     |  30.9 |  9.22
Other   |            | 0.04557    |            |       |  0.05

Nlocal:         45.625 ave          48 max          42 min
Histogram: 1 1 0 0 0 1 2 0 1 2
Nghost:        3275.75 ave        3321 max        3222 min
Histogram: 1 1 0 0 1 2 1 0 0 2
Neighs:        29947.4 ave       31296 max       27944 min
Histogram: 1 1 0 0 1 0 1 1 1 2

Total # of neighbors = 239579
Ave neighs/atom = 656.38082
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -48.2436784567132
variable C2pos equal ${d2}
variable C2pos equal -39.8279182121519
variable C3pos equal ${d3}
variable C3pos equal -22.368559819324
variable C4pos equal ${d4}
variable C4pos equal -20.9277355502438
variable C5pos equal ${d5}
variable C5pos equal -5.66690283436182
variable C6pos equal ${d6}
variable C6pos equal 10.3674569562856

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(23.5740389545854+${C1pos})
variable C14 equal 0.5*(23.5740389545854+-48.2436784567132)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(-22.0028277474034+${C2pos})
variable C24 equal 0.5*(-22.0028277474034+-39.8279182121519)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(18.4845201385752+${C3pos})
variable C34 equal 0.5*(18.4845201385752+-22.368559819324)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(25.9270701383719+${C4pos})
variable C44 equal 0.5*(25.9270701383719+-20.9277355502438)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-2.72189725018274+${C5pos})
variable C54 equal 0.5*(-2.72189725018274+-5.66690283436182)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(10.1787675735011+${C6pos})
variable C64 equal 0.5*(10.1787675735011+10.3674569562856)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 18.3222
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*18.3222
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.183222 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.063078 -0.1382)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.9 | 129 | 130.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.2817      -42575.452     -4887.9973      0              3885.8921    
       100   309.36929     -42588.049     -8760.8925     -6784.1326      3885.8921    
       200   285.86004     -42546.07       4221.9348     -6557.6524      3885.8921    
       300   307.31601     -42550.444     -13129.254     -10757.086      3885.8921    
       400   297.28896     -42539.361      226.85087     -11442.471      3885.8921    
       500   300.76847     -42559.545     -6425.0364     -6215.5798      3885.8921    
       600   286.3748      -42559.879      5633.3446     -4994.4856      3885.8921    
       700   293.66023     -42562.536     -15956.414     -8656.3732      3885.8921    
       800   299.88059     -42558.154     -8270.2782     -8351.1278      3885.8921    
       900   303.22676     -42548.542      5530.2477     -6862.7964      3885.8921    
      1000   305.98802     -42539.137      721.38492     -3836.2481      3885.8921    
      1100   298.86824     -42544.192      734.28604      274.42077      3885.8921    
      1200   300.66677     -42560.892      8167.5695     -2878.2558      3885.8921    
      1300   292.3292      -42560.662     -1776.294      -575.33556      3885.8921    
      1400   292.39895     -42553.916     -2765.8191     -2845.8606      3885.8921    
      1500   294.04566     -42543.164     -6073.6892     -7791.8831      3885.8921    
      1600   300.14154     -42543.695     -10125.568     -1819.8367      3885.8921    
      1700   287.311       -42531.131      879.80371     -3429.0645      3885.8921    
      1800   295.55953     -42536.221     -12545.78      -9883.0578      3885.8921    
      1900   305.96926     -42550.871     -7255.0763     -10148.699      3885.8921    
      2000   290.41529     -42552.715     -10001.511     -9312.665       3885.8921    
Loop time of 91.964 on 16 procs for 2000 steps with 365 atoms

Performance: 0.939 ns/day, 25.546 hours/ns, 21.748 timesteps/s, 7.938 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 53.291     | 65.299     | 77.659     | 140.2 | 71.00
Bond    | 0.0006168  | 0.0007992  | 0.00093305 |   0.0 |  0.00
Neigh   | 4.2517     | 5.1901     | 6.2017     |  38.9 |  5.64
Comm    | 0.65862    | 13.018     | 25.023     | 313.9 | 14.16
Output  | 0.0038317  | 0.0055414  | 0.006461   |   1.3 |  0.01
Modify  | 7.3921     | 8.4088     | 9.3538     |  30.7 |  9.14
Other   |            | 0.04188    |            |       |  0.05

Nlocal:         45.625 ave          51 max          43 min
Histogram: 1 2 2 1 0 1 0 0 0 1
Nghost:           3272 ave        3302 max        3230 min
Histogram: 1 0 1 0 0 2 1 0 2 1
Neighs:        29970.2 ave       33210 max       28433 min
Histogram: 1 2 2 1 1 0 0 0 0 1

Total # of neighbors = 239762
Ave neighs/atom = 656.88219
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.9 | 129 | 130.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.41529     -42552.715     -10001.496      0              3885.8921    
       100   307.1421      -42567.812     -15497.713     -8958.2694      3885.8921    
       200   288.33622     -42541.146     -12292.394     -7126.0323      3885.8921    
       300   312.49342     -42544.966     -5810.125      -5496.442       3885.8921    
       400   313.32742     -42541.959      228.15241     -8162.1559      3885.8921    
       500   309.62958     -42569.617      2572.8014     -1374.4313      3885.8921    
       600   319.25382     -42596.198     -12725.372     -9684.7746      3885.8921    
       700   288.81785     -42565.433     -9023.8518     -8096.22        3885.8921    
       800   304.04865     -42577.076      10967.196     -5406.8529      3885.8921    
       900   312.66503     -42567.373     -9133.6557     -1485.1544      3885.8921    
      1000   296.44175     -42523.15      -4241.3623     -4052.6529      3885.8921    
      1100   319.13913     -42559.42      -16755.638     -2724.5542      3885.8921    
      1200   305.82825     -42571.826     -3497.9166     -6471.8844      3885.8921    
      1300   301.6344      -42580.112     -6180.3115     -2409.0952      3885.8921    
      1400   304.66218     -42592.554     -19879.629     -1318.4243      3885.8921    
      1500   291.08364     -42588.628      10261.702      635.66831      3885.8921    
      1600   305.9053      -42577.986     -11030.776     -5731.1226      3885.8921    
      1700   300.87206     -42548.218      1118.5028     -5375.8645      3885.8921    
      1800   308.16448     -42559.361     -8798.6215     -11507.339      3885.8921    
      1900   290.90537     -42570.988      26592.495     -6646.7519      3885.8921    
      2000   284.34645     -42574.062      3008.3404     -8849.1739      3885.8921    
Loop time of 92.2451 on 16 procs for 2000 steps with 365 atoms

Performance: 0.937 ns/day, 25.624 hours/ns, 21.681 timesteps/s, 7.914 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.067     | 65.789     | 77.64      | 139.2 | 71.32
Bond    | 0.00063931 | 0.00079828 | 0.0009457  |   0.0 |  0.00
Neigh   | 4.3049     | 5.2309     | 6.2596     |  39.3 |  5.67
Comm    | 0.94088    | 12.786     | 24.506     | 315.7 | 13.86
Output  | 0.00076398 | 0.00084811 | 0.0011792  |   0.0 |  0.00
Modify  | 7.3607     | 8.3945     | 9.3288     |  31.2 |  9.10
Other   |            | 0.04252    |            |       |  0.05

Nlocal:         45.625 ave          50 max          40 min
Histogram: 1 0 0 1 0 1 2 1 1 1
Nghost:        3297.12 ave        3321 max        3271 min
Histogram: 2 1 0 1 0 0 0 0 2 2
Neighs:        29964.2 ave       32584 max       26521 min
Histogram: 1 0 0 1 0 2 2 0 1 1

Total # of neighbors = 239714
Ave neighs/atom = 656.75068
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -1.08543408708921
variable C2neg equal ${d2}
variable C2neg equal -32.1949096835596
variable C3neg equal ${d3}
variable C3neg equal -4.92697372069738
variable C4neg equal ${d4}
variable C4neg equal 3.86960718390579
variable C5neg equal ${d5}
variable C5neg equal 6.67527478418674
variable C6neg equal ${d6}
variable C6neg equal 2.99856582713732

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*18.3222
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.183222 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.429522 -0.1382)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.9 | 129 | 130.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.2817      -42573.402     -3020.0261      0              3885.8921    
       100   310.59839     -42588.805     -3003.7476     -7054.4397      3885.8921    
       200   293.28161     -42557.074     -6840.5937     -7985.5052      3885.8921    
       300   308.38799     -42554.59      -6918.811      -11199.836      3885.8921    
       400   297.20856     -42545.956     -1540.399      -10251.761      3885.8921    
       500   300.06646     -42565.287     -20319.812     -2959.6938      3885.8921    
       600   294.53857     -42574.454     -11174.287     -6812.849       3885.8921    
       700   291.2142      -42570.248     -9935.2405     -9010.6565      3885.8921    
       800   304.20071     -42569.788     -1480.4556     -8496.7522      3885.8921    
       900   303.10413     -42554.693     -2181.9294     -1907.7151      3885.8921    
      1000   306.84428     -42551.721     -4986.0788     -2749.8663      3885.8921    
      1100   293.25552     -42555.125      7137.0049     -128.46592      3885.8921    
      1200   320.86602     -42598.308      9093.0111     -1774.658       3885.8921    
      1300   295.02471     -42581.976      8675.0158     -5676.8422      3885.8921    
      1400   300.55743     -42591.614      1434.7707     -2439.8386      3885.8921    
      1500   284.32696     -42573.297      4052.5731     -5162.1086      3885.8921    
      1600   314.85191     -42591.613     -14426.425     -9275.4609      3885.8921    
      1700   306.81863     -42566.72      -11567.825     -12425.259      3885.8921    
      1800   316.61898     -42565.13       3156.9439     -14141.965      3885.8921    
      1900   316.13486     -42573.723     -3325.149      -9852.4933      3885.8921    
      2000   302.00418     -42573.197     -1100.565      -4348.4247      3885.8921    
Loop time of 92.9222 on 16 procs for 2000 steps with 365 atoms

Performance: 0.930 ns/day, 25.812 hours/ns, 21.523 timesteps/s, 7.856 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 53.47      | 67.873     | 78.029     | 132.5 | 73.04
Bond    | 0.00061385 | 0.0008362  | 0.001396   |   0.0 |  0.00
Neigh   | 4.2734     | 5.4581     | 6.2716     |  37.0 |  5.87
Comm    | 0.90323    | 11.049     | 25.439     | 328.4 | 11.89
Output  | 0.0040313  | 0.0060676  | 0.0070789  |   1.5 |  0.01
Modify  | 7.6562     | 8.4924     | 9.6977     |  30.0 |  9.14
Other   |            | 0.04281    |            |       |  0.05

Nlocal:         45.625 ave          49 max          43 min
Histogram: 2 1 0 1 0 1 1 0 1 1
Nghost:        3264.25 ave        3311 max        3210 min
Histogram: 1 0 2 0 0 1 1 1 1 1
Neighs:        29984.4 ave       31987 max       28429 min
Histogram: 2 1 0 1 1 0 1 0 1 1

Total # of neighbors = 239875
Ave neighs/atom = 657.19178
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.8 | 129 | 130.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.00418     -42573.197     -1100.5789      0              3885.8921    
       100   303.69637     -42585.961      3064.7666     -2602.6971      3885.8921    
       200   284.41611     -42579.401     -3691.8831     -4260.2198      3885.8921    
       300   292.84112     -42582.816     -6432.8045     -3768.4458      3885.8921    
       400   316.95511     -42573.926      184.12957     -6558.568       3885.8921    
       500   305.83452     -42563.768     -3557.1051     -8413.2085      3885.8921    
       600   308.04729     -42588.228     -7751.1853     -2447.5211      3885.8921    
       700   295.22961     -42587.911     -18061.078     -7520.7391      3885.8921    
       800   295.72598     -42580.317      5395.8866     -8985.9861      3885.8921    
       900   293.17539     -42570.498     -4545.6586     -6489.5292      3885.8921    
      1000   287.18908     -42561.615     -10527.854     -7476.8982      3885.8921    
      1100   316.34606     -42587.694     -11861.101     -1302.1551      3885.8921    
      1200   308.19445     -42579.057     -5119.5367     -5906.567       3885.8921    
      1300   293.41422     -42569.714      10247.945     -358.90518      3885.8921    
      1400   298.15749     -42591.447      14725.832     -4240.1883      3885.8921    
      1500   284.80539     -42589.405     -11264.292     -2668.3745      3885.8921    
      1600   307.81398     -42596.948     -6630.3014     -3215.8665      3885.8921    
      1700   307.57152     -42564.675     -21113.804     -6706.6043      3885.8921    
      1800   313.95087     -42572.835      5117.9709     -5404.7818      3885.8921    
      1900   283.57771     -42559.626     -2177.1005     -4436.8234      3885.8921    
      2000   295.47778     -42578.91      -901.0157      -7596.4065      3885.8921    
Loop time of 89.9164 on 16 procs for 2000 steps with 365 atoms

Performance: 0.961 ns/day, 24.977 hours/ns, 22.243 timesteps/s, 8.119 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.48      | 61.549     | 75.131     | 108.7 | 68.45
Bond    | 0.00059942 | 0.00079282 | 0.0012984  |   0.0 |  0.00
Neigh   | 4.338      | 5.1889     | 6.4621     |  34.4 |  5.77
Comm    | 0.79242    | 14.356     | 24.412     | 224.8 | 15.97
Output  | 0.00082945 | 0.00097316 | 0.0012654  |   0.0 |  0.00
Modify  | 7.4706     | 8.7727     | 9.6462     |  27.0 |  9.76
Other   |            | 0.0483     |            |       |  0.05

Nlocal:         45.625 ave          50 max          41 min
Histogram: 1 0 1 1 0 2 1 1 0 1
Nghost:        3258.62 ave        3304 max        3204 min
Histogram: 1 0 1 0 1 2 0 1 1 1
Neighs:        29934.4 ave       32556 max       27123 min
Histogram: 1 0 1 1 0 2 1 1 0 1

Total # of neighbors = 239475
Ave neighs/atom = 656.09589
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -11.6082311383769
variable C2pos equal ${d2}
variable C2pos equal -28.8969591357781
variable C3pos equal ${d3}
variable C3pos equal 2.7051382825792
variable C4pos equal ${d4}
variable C4pos equal -16.4668259075123
variable C5pos equal ${d5}
variable C5pos equal -4.81797113561331
variable C6pos equal ${d6}
variable C6pos equal -3.51678437402244

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-1.08543408708921+${C1pos})
variable C15 equal 0.5*(-1.08543408708921+-11.6082311383769)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-32.1949096835596+${C2pos})
variable C25 equal 0.5*(-32.1949096835596+-28.8969591357781)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-4.92697372069738+${C3pos})
variable C35 equal 0.5*(-4.92697372069738+2.7051382825792)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(3.86960718390579+${C4pos})
variable C45 equal 0.5*(3.86960718390579+-16.4668259075123)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(6.67527478418674+${C5pos})
variable C55 equal 0.5*(6.67527478418674+-4.81797113561331)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(2.99856582713732+${C6pos})
variable C65 equal 0.5*(2.99856582713732+-3.51678437402244)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.8463

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.8463
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.138463 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.870263 0.2463 -0.1382)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.3 | 129.3 | 130.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.2817      -42572.956     -2139.5673      0              3885.8921    
       100   309.86578     -42586.676     -9993.8242     -6954.1772      3885.8921    
       200   289.30217     -42553.386      7560.8011     -7501.2468      3885.8921    
       300   307.13529     -42559.131     -6544.0924     -11815.78       3885.8921    
       400   307.04785     -42559.741     -16081.297     -10981.212      3885.8921    
       500   291.81138     -42558.572     -15359.212     -5318.5228      3885.8921    
       600   282.3596      -42554.216     -7286.4786     -9564.0463      3885.8921    
       700   299.60896     -42568.282     -2884.897      -5052.8767      3885.8921    
       800   300.53946     -42562.984     -6637.3291     -8211.7491      3885.8921    
       900   315.14868     -42574.888     -10184.263     -7031.1488      3885.8921    
      1000   290.23559     -42550.434     -4447.1709     -8650.9555      3885.8921    
      1100   295.35822     -42562.353     -5336.8667     -4866.2854      3885.8921    
      1200   293.19153     -42557.141     -15169.119     -5583.5253      3885.8921    
      1300   298.1147      -42548.727      16544.417     -6553.6005      3885.8921    
      1400   302.87396     -42540.844     -10172.111     -7402.9999      3885.8921    
      1500   324.61891     -42572.597     -4933.8075     -8551.9468      3885.8921    
      1600   294.2172      -42568.357     -8986.076      -9850.3873      3885.8921    
      1700   291.90601     -42587.031      3879.396      -4298.0341      3885.8921    
      1800   279.13348     -42569.104     -21901.045     -11837.502      3885.8921    
      1900   309.88593     -42571.32      -7816.6822     -9261.891       3885.8921    
      2000   316.9482      -42566.865     -5698.282      -6409.7584      3885.8921    
Loop time of 87.6091 on 16 procs for 2000 steps with 365 atoms

Performance: 0.986 ns/day, 24.336 hours/ns, 22.829 timesteps/s, 8.332 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 50.327     | 56.999     | 73.126     | 120.0 | 65.06
Bond    | 0.00059638 | 0.00070271 | 0.00085014 |   0.0 |  0.00
Neigh   | 4.3736     | 4.9281     | 6.4753     |  39.7 |  5.63
Comm    | 0.57069    | 16.682     | 23.344     | 221.5 | 19.04
Output  | 0.0038386  | 0.0062164  | 0.0072982  |   1.7 |  0.01
Modify  | 7.3767     | 8.9536     | 9.5296     |  30.0 | 10.22
Other   |            | 0.03978    |            |       |  0.05

Nlocal:         45.625 ave          52 max          40 min
Histogram: 1 1 0 1 1 2 1 0 0 1
Nghost:        3314.38 ave        3328 max        3297 min
Histogram: 2 0 0 0 1 1 0 1 2 1
Neighs:          29962 ave       33905 max       26476 min
Histogram: 1 1 0 1 1 1 2 0 0 1

Total # of neighbors = 239696
Ave neighs/atom = 656.70137
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.3 | 129.3 | 130.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   316.9482      -42566.865     -5698.3137      0              3885.8921    
       100   290.11829     -42552.86      -5573.2908     -7965.454       3885.8921    
       200   298.33494     -42588.409     -13835.134     -10023.437      3885.8921    
       300   301.28628     -42599.314     -1401.1073     -9025.6053      3885.8921    
       400   304.39552     -42597.871      4781.4399     -8563.5015      3885.8921    
       500   307.94023     -42594.671     -2828.5127     -8375.5903      3885.8921    
       600   293.51088     -42581.902     -283.6711      -8796.6302      3885.8921    
       700   316.76123     -42623.531     -3170.7404     -9775.7673      3885.8921    
       800   298.08348     -42620.702     -2904.6691     -11254.155      3885.8921    
       900   294.38975     -42607.257     -2870.744      -8478.8994      3885.8921    
      1000   319.41233     -42605.426     -5617.9656     -13557.678      3885.8921    
      1100   317.94149     -42597.29      -12814.03      -10554.626      3885.8921    
      1200   308.59234     -42613.76      -15628.021     -11472.83       3885.8921    
      1300   304.50881     -42625.34      -1016.4609     -11794.007      3885.8921    
      1400   281.23635     -42617.205     -13860.817     -8964.6929      3885.8921    
      1500   275.31376     -42620.429     -11811.634     -7488.8711      3885.8921    
      1600   290.11956     -42624.603     -5037.6886     -10790.297      3885.8921    
      1700   333.03616     -42637.596     -5807.8713     -8046.6931      3885.8921    
      1800   299.5925      -42608.643     -1671.5228     -10462.849      3885.8921    
      1900   313.6657      -42640.552     -7641.2942     -11256.229      3885.8921    
      2000   285.47277     -42615.282     -12100.403     -14140.314      3885.8921    
Loop time of 88.0167 on 16 procs for 2000 steps with 365 atoms

Performance: 0.982 ns/day, 24.449 hours/ns, 22.723 timesteps/s, 8.294 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.071     | 57.415     | 73.627     | 121.3 | 65.23
Bond    | 0.00064757 | 0.00072466 | 0.0008271  |   0.0 |  0.00
Neigh   | 4.319      | 4.8784     | 6.4139     |  39.9 |  5.54
Comm    | 0.61417    | 16.815     | 23.147     | 223.9 | 19.10
Output  | 0.00082205 | 0.0009367  | 0.0012031  |   0.0 |  0.00
Modify  | 7.3004     | 8.8664     | 9.4457     |  30.2 | 10.07
Other   |            | 0.04042    |            |       |  0.05

Nlocal:         45.625 ave          53 max          41 min
Histogram: 2 0 2 1 1 0 0 0 1 1
Nghost:        3275.25 ave        3325 max        3228 min
Histogram: 2 0 2 0 0 0 1 1 0 2
Neighs:        29964.8 ave       34407 max       27143 min
Histogram: 2 0 2 1 1 0 0 0 1 1

Total # of neighbors = 239718
Ave neighs/atom = 656.76164
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -54.69791427072
variable C2neg equal ${d2}
variable C2neg equal 13.5811851917581
variable C3neg equal ${d3}
variable C3neg equal -98.565554544076
variable C4neg equal ${d4}
variable C4neg equal 16.4995137164754
variable C5neg equal ${d5}
variable C5neg equal 1.49714624149085
variable C6neg equal ${d6}
variable C6neg equal 2.64289954668952

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.8463
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.138463 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.593337 0.2463 -0.1382)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.9 | 128.2 | 129.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.2817      -42575.85      -6955.5328      0              3885.8921    
       100   312.56962     -42591.92      -10582.958     -8253.1561      3885.8921    
       200   290.18654     -42550.597      296.54708     -7114.7924      3885.8921    
       300   320.82698     -42556.938     -13467.533     -8648.2841      3885.8921    
       400   302.6898      -42527.04       6029.6801     -10957.072      3885.8921    
       500   295.11421     -42540.101     -2574.8928     -5660.4846      3885.8921    
       600   291.79196     -42571.814     -9319.6845     -7958.8398      3885.8921    
       700   292.3999      -42588.032      4054.2406     -3292.4188      3885.8921    
       800   308.25315     -42601.467      1722.8903     -9458.4134      3885.8921    
       900   298.25333     -42573.643     -11844.589     -10642.756      3885.8921    
      1000   306.88708     -42564.912      1875.1154     -5279.6931      3885.8921    
      1100   310.33641     -42563.693      11177.531     -1909.7486      3885.8921    
      1200   310.79286     -42574.24       2553.8365      2203.6479      3885.8921    
      1300   293.17427     -42575.491      11189.921     -3718.9195      3885.8921    
      1400   285.98628     -42576.651     -1781.7524     -3722.2999      3885.8921    
      1500   286.12587     -42578.136     -6325.0266     -7719.1308      3885.8921    
      1600   289.16073     -42569.147     -4219.302      -12691.571      3885.8921    
      1700   299.6904      -42559.083     -3452.8304     -10413.338      3885.8921    
      1800   302.52216     -42547.966      3424.8834     -2525.1207      3885.8921    
      1900   297.91211     -42543.909     -4978.524      -7058.8023      3885.8921    
      2000   303.40978     -42577.467     -7672.5689     -8069.6726      3885.8921    
Loop time of 69.8255 on 16 procs for 2000 steps with 365 atoms

Performance: 1.237 ns/day, 19.396 hours/ns, 28.643 timesteps/s, 10.455 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 50.448     | 52.039     | 55.064     |  18.6 | 74.53
Bond    | 0.00056652 | 0.00072517 | 0.00083666 |   0.0 |  0.00
Neigh   | 4.2616     | 4.3739     | 4.5328     |   5.1 |  6.26
Comm    | 3.3905     | 6.4167     | 8.0041     |  53.0 |  9.19
Output  | 0.0032583  | 0.0048954  | 0.005788   |   1.4 |  0.01
Modify  | 6.792      | 6.9488     | 7.0623     |   4.1 |  9.95
Other   |            | 0.04143    |            |       |  0.06

Nlocal:         45.625 ave          48 max          44 min
Histogram: 2 0 2 0 0 2 0 1 0 1
Nghost:         3256.5 ave        3283 max        3226 min
Histogram: 2 0 1 0 0 1 1 1 0 2
Neighs:        29952.9 ave       31377 max       29025 min
Histogram: 2 0 2 0 2 0 0 1 0 1

Total # of neighbors = 239623
Ave neighs/atom = 656.50137
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.9 | 128.2 | 129.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   303.40978     -42577.467     -7672.6001      0              3885.8921    
       100   305.18269     -42584.008     -9617.3225     -2180.5298      3885.8921    
       200   308.76752     -42587.295     -797.69818     -5608.0229      3885.8921    
       300   306.40037     -42566.431      11058.246     -4870.6332      3885.8921    
       400   311.05255     -42557.923     -7348.9666     -5299.8927      3885.8921    
       500   289.08106     -42536.282     -405.28518     -1438.2112      3885.8921    
       600   280.65255     -42550.924     -6178.8638     -9081.3341      3885.8921    
       700   288.76156     -42579.944     -6355.0667     -9430.6309      3885.8921    
       800   286.05255     -42574.313     -9786.2234     -12504.093      3885.8921    
       900   312.68417     -42561.263     -10551.605     -10052.827      3885.8921    
      1000   311.47096     -42556.586     -15234.393     -9472.2348      3885.8921    
      1100   302.37488     -42571.385     -13858.009     -7074.9609      3885.8921    
      1200   309.52545     -42598.41      -2316.1234     -5574.4728      3885.8921    
      1300   301.88844     -42590.79      -9055.3152     -4141.1376      3885.8921    
      1400   284.97565     -42562.173     -15400.464     -11254.927      3885.8921    
      1500   303.08274     -42543.728      318.02189     -1753.2777      3885.8921    
      1600   314.84832     -42558.352     -2994.4172     -8535.2565      3885.8921    
      1700   294.3503      -42561.106     -4776.5552     -8367.4398      3885.8921    
      1800   290.27291     -42564.832     -7174.3958     -9814.8284      3885.8921    
      1900   315.8175      -42597.129     -7223.1168     -1860.9837      3885.8921    
      2000   289.16893     -42586.161     -323.97109     -5051.7449      3885.8921    
Loop time of 62.9256 on 16 procs for 2000 steps with 365 atoms

Performance: 1.373 ns/day, 17.479 hours/ns, 31.784 timesteps/s, 11.601 katom-step/s
99.6% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 50.142     | 51.005     | 52.08      |   9.0 | 81.06
Bond    | 0.00053035 | 0.00073071 | 0.00086791 |   0.0 |  0.00
Neigh   | 4.1946     | 4.2696     | 4.3298     |   2.1 |  6.79
Comm    | 0.49406    | 1.5672     | 2.4261     |  51.3 |  2.49
Output  | 0.0009327  | 0.0010163  | 0.0012861  |   0.3 |  0.00
Modify  | 5.9786     | 6.0393     | 6.1133     |   1.7 |  9.60
Other   |            | 0.04267    |            |       |  0.07

Nlocal:         45.625 ave          50 max          40 min
Histogram: 1 0 0 1 1 0 2 1 0 2
Nghost:           3279 ave        3337 max        3224 min
Histogram: 1 1 1 0 1 0 2 1 0 1
Neighs:        29982.6 ave       32690 max       26458 min
Histogram: 1 0 1 0 1 1 2 0 1 1

Total # of neighbors = 239861
Ave neighs/atom = 657.15342
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -37.3920152646257
variable C2pos equal ${d2}
variable C2pos equal -30.6541979945856
variable C3pos equal ${d3}
variable C3pos equal -58.841233790598
variable C4pos equal ${d4}
variable C4pos equal -20.0149516096805
variable C5pos equal ${d5}
variable C5pos equal -15.5036428033613
variable C6pos equal ${d6}
variable C6pos equal 8.9558654384816

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-54.69791427072+${C1pos})
variable C16 equal 0.5*(-54.69791427072+-37.3920152646257)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(13.5811851917581+${C2pos})
variable C26 equal 0.5*(13.5811851917581+-30.6541979945856)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-98.565554544076+${C3pos})
variable C36 equal 0.5*(-98.565554544076+-58.841233790598)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(16.4995137164754+${C4pos})
variable C46 equal 0.5*(16.4995137164754+-20.0149516096805)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(1.49714624149085+${C5pos})
variable C56 equal 0.5*(1.49714624149085+-15.5036428033613)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(2.64289954668952+${C6pos})
variable C66 equal 0.5*(2.64289954668952+8.9558654384816)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 28.0681793210819
variable C22all equal ${C22}
variable C22all equal 34.4642689046385
variable C33all equal ${C33}
variable C33all equal 12.1013463824473

variable C44all equal ${C44}
variable C44all equal 2.49966729406405
variable C55all equal ${C55}
variable C55all equal 0.928651824286715
variable C66all equal ${C66}
variable C66all equal 5.79938249258556

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(35.5907672406403+${C21})
variable C12all equal 0.5*(35.5907672406403+6.66019632059177)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(16.746931204262+${C31})
variable C13all equal 0.5*(16.746931204262+27.107231333001)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(38.9245700304922+${C32})
variable C23all equal 0.5*(38.9245700304922+22.1359159992537)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-12.3348197510639+${C41})
variable C14all equal 0.5*(-12.3348197510639+-3.39433563807175)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-6.34683261273305+${C51})
variable C15all equal 0.5*(-6.34683261273305+9.74658528113014)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-46.0449647676729+${C61})
variable C16all equal 0.5*(-46.0449647676729+-0.648338410264845)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-30.9153729797777+${C42})
variable C24all equal 0.5*(-30.9153729797777+0.547478338887545)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-30.5459344096689+${C52})
variable C25all equal 0.5*(-30.5459344096689+-8.24937756751066)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-8.53650640141375+${C62})
variable C26all equal 0.5*(-8.53650640141375+-3.14428900620976)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(-1.9420198403744+${C43})
variable C34all equal 0.5*(-1.9420198403744+-0.647369772983675)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-1.11091771905909+${C53})
variable C35all equal 0.5*(-1.11091771905909+-0.666115369826181)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-78.703394167337+${C63})
variable C36all equal 0.5*(-78.703394167337+-7.301314851192)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-6.29860936180325+${C54})
variable C45all equal 0.5*(-6.29860936180325+-4.19440004227228)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-1.75771894660255+${C64})
variable C46all equal 0.5*(-1.75771894660255+10.2731122648933)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-7.00324828093523+${C65})
variable C56all equal 0.5*(-7.00324828093523+-0.25910927344256)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:37:55
