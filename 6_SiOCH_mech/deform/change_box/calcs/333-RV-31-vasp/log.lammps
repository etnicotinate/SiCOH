LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 30*${nthermo}       # steps of equilibration run 20
variable nequil equal 30*100       
variable nrun equal 30*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 30*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-RV-31-vasp
read_data       ${structure}.data
read_data       333-RV-31-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.007 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 7.08711e-05 on 8 procs for 1 steps with 310 atoms

52.9% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.397e-06  | 1.9385e-06 | 2.165e-06  |   0.0 |  2.74
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 3.352e-06  | 4.7835e-06 | 5.656e-06  |   0.0 |  6.75
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 6.415e-05  |            |       | 90.52

Nlocal:          38.75 ave          46 max          34 min
Histogram: 1 2 0 1 2 0 1 0 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-RV-31-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 3000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = 22.14 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121 | 121.6 | 122.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -32388.564      119735.25      0              1.4204665      3436.9359    
       100   826.21848     -33370.206     -34153.459      448.70616      1.4204665      3436.9359    
       200   604.64313     -33652.984     -23357.291     -5001.2167      1.4204665      3436.9359    
       300   465.54625     -33876.865      44.965454     -2084.9334      1.4204665      3436.9359    
       400   399.37626     -34043.579     -1989.4513      3745.059       1.4204665      3436.9359    
       500   311.7999      -34116.163      20211.59      -1103.6108      1.4204665      3436.9359    
       600   286.41955     -34190.476      6298.2812     -2313.3177      1.4204665      3436.9359    
       700   293.04756     -34250.499     -5385.4937      2197.0842      1.4204665      3436.9359    
       800   315.2187      -34288.078     -13872.111      724.47901      1.4204665      3436.9359    
       900   296.85319     -34277.216     -293.91465     -418.2502       1.4204665      3436.9359    
      1000   325.84368     -34312.491     -388.81292      4302.0036      1.4204665      3436.9359    
      1100   296.98178     -34298.167      4917.4619      1564.16        1.4204665      3436.9359    
      1200   313.94806     -34333.653      5759.7625      8245.3788      1.4204665      3436.9359    
      1300   286.29838     -34332.402      1147.5279      4980.525       1.4204665      3436.9359    
      1400   299.88672     -34345.993      8313.5888      1799.4627      1.4204665      3436.9359    
      1500   314.0539      -34352.758      12676.746      6309.5915      1.4204665      3436.9359    
      1600   308.7959      -34341.532     -5185.8517      5028.355       1.4204665      3436.9359    
      1700   315.75942     -34336.158     -8060.5058      2627.6871      1.4204665      3436.9359    
      1800   301.26072     -34326.253     -3628.4647      5160.5372      1.4204665      3436.9359    
      1900   306.14107     -34346.982     -3949.8385      3701.4035      1.4204665      3436.9359    
      2000   297.28055     -34358.755      15824.21       7087.0779      1.4204665      3436.9359    
      2100   289.0004      -34361.916      10993.438     -144.80974      1.4204665      3436.9359    
      2200   289.76911     -34351.469      795.36954      8561.2193      1.4204665      3436.9359    
      2300   318.4501      -34360.164     -9424.3303      4835.0714      1.4204665      3436.9359    
      2400   301.58268     -34327.7        4574.119       626.41771      1.4204665      3436.9359    
      2500   315.91539     -34344.135     -662.15945      5717.2715      1.4204665      3436.9359    
      2600   309.40156     -34363.754     -10319.725     -1572.6901      1.4204665      3436.9359    
      2700   287.04496     -34372.336      8138.1091      867.17179      1.4204665      3436.9359    
      2800   284.98128     -34377.549     -9135.8395      3022.4681      1.4204665      3436.9359    
      2900   285.91652     -34367.357      3113.9802      3384.3841      1.4204665      3436.9359    
      3000   293.7744      -34353.4        12024.799      4879.8162      1.4204665      3436.9359    
Loop time of 131.368 on 8 procs for 3000 steps with 310 atoms

Performance: 0.987 ns/day, 24.327 hours/ns, 22.837 timesteps/s, 7.079 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 76.219     | 99.793     | 108.6      | 101.5 | 75.96
Bond    | 0.0084286  | 0.0090135  | 0.0094119  |   0.4 |  0.01
Neigh   | 5.8067     | 7.5709     | 8.1444     |  27.5 |  5.76
Comm    | 3.2715     | 12.076     | 35.662     | 291.9 |  9.19
Output  | 0.0016528  | 0.0018439  | 0.0028471  |   0.9 |  0.00
Modify  | 11.268     | 11.847     | 13.608     |  22.0 |  9.02
Other   |            | 0.06988    |            |       |  0.05

Nlocal:          38.75 ave          45 max          35 min
Histogram: 1 2 0 0 2 2 0 0 0 1
Nghost:        3088.25 ave        3120 max        3049 min
Histogram: 2 0 0 0 0 2 2 0 0 2
Neighs:        24493.2 ave       28198 max       22345 min
Histogram: 3 0 0 1 2 1 0 0 0 1

Total # of neighbors = 195946
Ave neighs/atom = 632.08387
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-RV-31-vasp_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.4114
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 12.7411
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.5034

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-4879.81618462464)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-4879.81618462464)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-78.8060071315636)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-78.8060071315636)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--1709.87281182333)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--1709.87281182333)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--797.710136813866)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--797.710136813866)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-885.14251244761)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-885.14251244761)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-3417.12386903903)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-3417.12386903903)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 15.4114
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.4114
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.154114 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.154114 xy delta 0.072027 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.154114 xy delta 0.072027 xz delta 0.018261 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.257286 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.257286 12.7411 17.5034) with tilt (-7.130673 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.257286 12.7411 17.5034) with tilt (-7.130673 -1.807839 0.3384)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.3 | 121 | 122.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   293.7744      -34325.5        71877.551      0              3402.5666    
       100   329.78311     -34356.076      3806.8229      10879.026      3402.5666    
       200   295.94323     -34360.918     -19370.211     -1670.7642      3402.5666    
       300   291.89273     -34388.022     -453.12544      475.81454      3402.5666    
       400   312.93842     -34420.506      8485.706       4898.4808      3402.5666    
       500   283.09221     -34391.285     -4955.5192      5316.7742      3402.5666    
       600   283.40233     -34367.797     -11626.425      5819.0988      3402.5666    
       700   308.23589     -34359.793     -5956.1029      4025.8387      3402.5666    
       800   334.05764     -34365.624     -3927.6534     -1612.7836      3402.5666    
       900   304.97707     -34352.102     -6061.0221      4305.8477      3402.5666    
      1000   319.83912     -34406.958     -2710.08        4211.7588      3402.5666    
      1100   280.90557     -34401.162     -7795.7279      5188.2137      3402.5666    
      1200   287.53758     -34409.278      388.75231      2366.8696      3402.5666    
      1300   292.22652     -34387.196     -8012.7802      7721.8638      3402.5666    
      1400   309.60297     -34372.705     -13483.875      1419.8783      3402.5666    
      1500   326.96468     -34382.211     -5459.8175      3657.0561      3402.5666    
      1600   296.70199     -34387.044      4225.6498      4237.343       3402.5666    
      1700   276.3505      -34402.675      3414.3933      2127.0836      3402.5666    
      1800   280.32362     -34416.874      4638.7442      3816.0029      3402.5666    
      1900   290.63883     -34417.226     -10530.847      908.13995      3402.5666    
      2000   295.12061     -34402.585     -17162.257      2838.6069      3402.5666    
      2100   284.21031     -34383.259      3373.3241      5028.4866      3402.5666    
      2200   292.32837     -34385.236     -8149.5         2099.2605      3402.5666    
      2300   298.05927     -34401.333      176.87279      2710.6813      3402.5666    
      2400   298.1758      -34424.494     -14027.068      513.12854      3402.5666    
      2500   283.19653     -34422.024     -4159.1813      2683.1221      3402.5666    
      2600   286.54718     -34405.056      6406.0561     -3231.1804      3402.5666    
      2700   299.74079     -34399.218     -11333.176      3495.4184      3402.5666    
      2800   327.98014     -34426.524     -4760.8917      5170.9782      3402.5666    
      2900   281.36444     -34398.1        1589.5624      4017.2003      3402.5666    
      3000   288.03483     -34416.698     -557.78586      377.42897      3402.5666    
Loop time of 135.781 on 8 procs for 3000 steps with 310 atoms

Performance: 0.954 ns/day, 25.145 hours/ns, 22.094 timesteps/s, 6.849 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 98.938     | 107.49     | 114.29     |  56.7 | 79.16
Bond    | 0.0084451  | 0.0091848  | 0.009966   |   0.5 |  0.01
Neigh   | 7.4481     | 8.0201     | 8.4638     |  12.9 |  5.91
Comm    | 1.4023     | 8.2234     | 16.789     | 205.5 |  6.06
Output  | 0.0063116  | 0.0079667  | 0.0094849  |   1.4 |  0.01
Modify  | 11.491     | 11.956     | 12.523     |  10.4 |  8.81
Other   |            | 0.07407    |            |       |  0.05

Nlocal:          38.75 ave          46 max          28 min
Histogram: 1 0 0 0 1 2 1 1 1 1
Nghost:        3099.12 ave        3123 max        3068 min
Histogram: 1 0 0 1 0 2 1 1 1 1
Neighs:          24745 ave       29072 max       18257 min
Histogram: 1 0 0 0 1 2 1 1 1 1

Total # of neighbors = 197960
Ave neighs/atom = 638.58065
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.3 | 121 | 122.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.03483     -34416.698     -557.78298      0              3402.5666    
       100   298.15031     -34425.544     -10778.877      1487.1467      3402.5666    
       200   311.03841     -34417.24      -7455.8188      4607.6418      3402.5666    
       300   328.67504     -34411.804     -1347.9555      5784.7711      3402.5666    
       400   299.82887     -34406.789      2155.0259      1339.9531      3402.5666    
       500   307.77125     -34430.264     -5439.3721      4134.1977      3402.5666    
       600   308.14409     -34427.995      11075.56       5860.5455      3402.5666    
       700   293.31354     -34400.294     -12631.723      946.59594      3402.5666    
       800   321.23106     -34403.837      1219.1344     -91.620891      3402.5666    
       900   336.89012     -34394.962      265.14489     -493.22491      3402.5666    
      1000   328.95161     -34399.829     -155.31919      1489.1359      3402.5666    
      1100   286.54409     -34396.964     -4717.0052      5024.7983      3402.5666    
      1200   303.45369     -34417.825      7490.451       6901.7142      3402.5666    
      1300   293.66909     -34396.969      791.24307      2834.2895      3402.5666    
      1400   311.09329     -34412.027     -23220.42       951.6351       3402.5666    
      1500   295.14244     -34420.871     -10807.77      -2837.5132      3402.5666    
      1600   281.28118     -34424.056     -2702.3205      1742.1943      3402.5666    
      1700   303.52333     -34435.286     -8719.8236      3833.2064      3402.5666    
      1800   312.5001      -34404.012     -15.695859      49.189892      3402.5666    
      1900   307.26268     -34395.893     -8243.2936      8770.5563      3402.5666    
      2000   301.77368     -34411.711     -19363.068      468.01409      3402.5666    
      2100   301.11166     -34426.015     -5547.5843     -1300.5302      3402.5666    
      2200   311.53333     -34439.398     -10750.145      1503.2277      3402.5666    
      2300   276.04827     -34415.544      232.31454     -2664.5902      3402.5666    
      2400   293.36374     -34432.164      6460.1304     -28.900394      3402.5666    
      2500   282.05443     -34401.681      10296.225      7615.3199      3402.5666    
      2600   312.7121      -34410.175     -7811.9306      2095.3434      3402.5666    
      2700   326.33652     -34421.873      7430.3641      1729.6944      3402.5666    
      2800   292.66687     -34417.446     -16494.19       5655.6233      3402.5666    
      2900   291.43893     -34435.659     -8172.2947      5455.4089      3402.5666    
      3000   276.50926     -34415.343     -9925.6337      1675.75        3402.5666    
Loop time of 137.192 on 8 procs for 3000 steps with 310 atoms

Performance: 0.945 ns/day, 25.406 hours/ns, 21.867 timesteps/s, 6.779 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 90.13      | 108.11     | 115.61     |  86.5 | 78.80
Bond    | 0.0083258  | 0.0091147  | 0.0097544  |   0.5 |  0.01
Neigh   | 6.9768     | 8.0297     | 8.5433     |  20.7 |  5.85
Comm    | 1.2951     | 8.8211     | 26.822     | 303.3 |  6.43
Output  | 0.0013536  | 0.001665   | 0.00361    |   1.8 |  0.00
Modify  | 11.6       | 12.144     | 13.186     |  16.8 |  8.85
Other   |            | 0.0746     |            |       |  0.05

Nlocal:          38.75 ave          44 max          33 min
Histogram: 2 0 0 1 1 1 0 0 0 3
Nghost:        3113.75 ave        3146 max        3076 min
Histogram: 1 0 1 1 1 1 0 0 1 2
Neighs:        24751.6 ave       27990 max       21316 min
Histogram: 2 0 0 1 1 1 0 0 2 1

Total # of neighbors = 198013
Ave neighs/atom = 638.75161
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -32.4652006067262
variable C2neg equal ${d2}
variable C2neg equal -78.4676388717401
variable C3neg equal ${d3}
variable C3neg equal -105.010851490713
variable C4neg equal ${d4}
variable C4neg equal -23.7832642699697
variable C5neg equal ${d5}
variable C5neg equal 14.6500863426017
variable C6neg equal ${d6}
variable C6neg equal 0.776595763070091

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.4114
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.154114 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.154114 xy delta -0.072027 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.154114 xy delta -0.072027 xz delta -0.018261 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.565514 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.565514 12.7411 17.5034) with tilt (-7.274727 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.565514 12.7411 17.5034) with tilt (-7.274727 -1.844361 0.3384)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 117.7 | 119.4 | 120.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   293.7744      -34342.437     -36404.14       0              3471.3053    
       100   326.30907     -34363.107      4625.316       7482.4369      3471.3053    
       200   311.43851     -34369.396     -13109.784     -6748.2864      3471.3053    
       300   291.52681     -34375.542     -11193.127     -3170.5198      3471.3053    
       400   290.2923      -34386.472     -5787.1313     -3754.6328      3471.3053    
       500   280.54982     -34382.951      10426.642      3108.2009      3471.3053    
       600   291.74903     -34377.743     -10455.785     -234.77146      3471.3053    
       700   303.60221     -34361.585      3278.4677      669.30231      3471.3053    
       800   338.04703     -34383.017     -3676.9481     -2604.7423      3471.3053    
       900   293.092       -34361.862     -13855.926      992.84141      3471.3053    
      1000   300.88717     -34398.756     -6341.4279     -1244.1478      3471.3053    
      1100   286.75527     -34401.118     -19374.737     -4882.6778      3471.3053    
      1200   305.40971     -34410.617     -5746.7808     -2016.1186      3471.3053    
      1300   296.76694     -34387.08      -17107.126     -6632.5367      3471.3053    
      1400   316.86417     -34395.823     -8228.9376      1099.7214      3471.3053    
      1500   313.70855     -34400.741      857.07216      3718.4836      3471.3053    
      1600   312.20184     -34408.964      1937.3249     -2109.7173      3471.3053    
      1700   299.08818     -34413.714      9.623326      -441.67728      3471.3053    
      1800   291.26602     -34412.624     -17948.581      3012.094       3471.3053    
      1900   308.75145     -34419.285     -9563.6399     -5190.4961      3471.3053    
      2000   298.40048     -34392.205     -3544.2081     -197.9924       3471.3053    
      2100   297.02489     -34387.709     -6006.7739     -3187.051       3471.3053    
      2200   307.48385     -34411.46      -655.11499      4435.7842      3471.3053    
      2300   299.6792      -34420.015     -6627.7958     -3981.9002      3471.3053    
      2400   309.09351     -34433.361      7550.0713     -6773.0145      3471.3053    
      2500   276.01143     -34393.54      -16224.541      2085.5893      3471.3053    
      2600   298.12219     -34382.051     -4622.1257      1549.4812      3471.3053    
      2700   308.68186     -34387.08      -13601.645     -4975.5747      3471.3053    
      2800   289.49034     -34384.152     -9574.2052     -4762.1509      3471.3053    
      2900   305.7048      -34407.328     -5366.0937      210.10098      3471.3053    
      3000   261.76067     -34384.234      17992.374      7.7970184      3471.3053    
Loop time of 134.327 on 8 procs for 3000 steps with 310 atoms

Performance: 0.965 ns/day, 24.875 hours/ns, 22.334 timesteps/s, 6.923 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 97.838     | 108.43     | 113.09     |  41.6 | 80.72
Bond    | 0.0084266  | 0.0093453  | 0.010126   |   0.6 |  0.01
Neigh   | 7.6862     | 8.1978     | 8.439      |   8.2 |  6.10
Comm    | 1.2254     | 5.9025     | 16.523     | 178.7 |  4.39
Output  | 0.0066643  | 0.0082582  | 0.0097086  |   1.3 |  0.01
Modify  | 11.441     | 11.701     | 12.188     |   6.9 |  8.71
Other   |            | 0.07497    |            |       |  0.06

Nlocal:          38.75 ave          44 max          34 min
Histogram: 1 0 1 2 0 2 0 0 0 2
Nghost:        3083.62 ave        3101 max        3044 min
Histogram: 1 0 0 0 1 1 0 1 1 3
Neighs:        24230.8 ave       27504 max       21378 min
Histogram: 1 0 3 0 1 1 0 0 0 2

Total # of neighbors = 193846
Ave neighs/atom = 625.30968
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 117.8 | 119.4 | 120.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   261.76067     -34384.234      17992.368      0              3471.3053    
       100   306.88165     -34415.039     -2310.0965      4510.0972      3471.3053    
       200   308.77699     -34403.897     -292.60802      2829.1597      3471.3053    
       300   317.54725     -34405.838     -126.80584     -3204.7417      3471.3053    
       400   306.89604     -34410.912     -7637.2025      4615.5389      3471.3053    
       500   292.50661     -34423.342     -8897.8645     -3391.0273      3471.3053    
       600   295.9942      -34427.474     -3556.7385      1578.7106      3471.3053    
       700   287.59335     -34409.803     -11766.654      983.30823      3471.3053    
       800   318.64082     -34400.328      1733.4906      1686.0002      3471.3053    
       900   316.96151     -34400.94      -1647.3778     -1408.8233      3471.3053    
      1000   292.67246     -34402.199     -2706.3137     -3447.3836      3471.3053    
      1100   297.5187      -34424.781     -3895.4691      863.05594      3471.3053    
      1200   267.76281     -34404.893      7258.5924     -785.05033      3471.3053    
      1300   304.68028     -34436.572     -826.20789     -1937.4829      3471.3053    
      1400   307.98056     -34423.651     -564.49536     -214.60872      3471.3053    
      1500   297.62057     -34389.165     -1845.1197     -341.33954      3471.3053    
      1600   329.16473     -34421.827      5416.0744     -383.82806      3471.3053    
      1700   300.30086     -34423.174     -12298.517     -1075.4438      3471.3053    
      1800   287.30842     -34424.539      6092.0884     -1236.4229      3471.3053    
      1900   306.48939     -34445.145      7806.5391     -5760.5824      3471.3053    
      2000   300.01726     -34424.183      8295.9398      3944.0191      3471.3053    
      2100   306.64691     -34410.81      -7066.6553     -1328.3658      3471.3053    
      2200   310.19747     -34426.869     -10734.135      2407.4915      3471.3053    
      2300   287.45167     -34441.613      4493.8838      1574.9511      3471.3053    
      2400   292.27064     -34443.472     -1071.0133     -867.89871      3471.3053    
      2500   319.9754      -34446.016      5145.5742      3351.1491      3471.3053    
      2600   311.93094     -34424.102     -4649.3768     -2559.2466      3471.3053    
      2700   311.7693      -34424.024     -4634.0137      2750.9333      3471.3053    
      2800   266.14972     -34406.789     -957.05768     -2590.7248      3471.3053    
      2900   290.5193      -34452.914      466.21681      852.08432      3471.3053    
      3000   284.26676     -34432.777     -16015.702     -5849.5332      3471.3053    
Loop time of 135.782 on 8 procs for 3000 steps with 310 atoms

Performance: 0.954 ns/day, 25.145 hours/ns, 22.094 timesteps/s, 6.849 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 75.529     | 101.23     | 114.34     | 138.9 | 74.56
Bond    | 0.0080625  | 0.0091168  | 0.0097194  |   0.6 |  0.01
Neigh   | 5.8694     | 7.6718     | 8.7051     |  36.8 |  5.65
Comm    | 1.0171     | 14.132     | 39.816     | 371.9 | 10.41
Output  | 0.0013491  | 0.001571   | 0.0028235  |   1.2 |  0.00
Modify  | 11.623     | 12.663     | 14.495     |  28.7 |  9.33
Other   |            | 0.07043    |            |       |  0.05

Nlocal:          38.75 ave          42 max          36 min
Histogram: 1 3 0 1 0 0 0 0 1 2
Nghost:         3066.5 ave        3120 max        3005 min
Histogram: 1 1 0 1 0 0 2 1 1 1
Neighs:        24274.6 ave       26192 max       22727 min
Histogram: 1 2 1 1 0 0 0 0 1 2

Total # of neighbors = 194197
Ave neighs/atom = 626.44194
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 108.715132926324
variable C2pos equal ${d2}
variable C2pos equal 90.6118787467871
variable C3pos equal ${d3}
variable C3pos equal 122.136645275922
variable C4pos equal ${d4}
variable C4pos equal 29.2182997638987
variable C5pos equal ${d5}
variable C5pos equal -14.7597153376145
variable C6pos equal ${d6}
variable C6pos equal -7.3365240110791

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(-32.4652006067262+${C1pos})
variable C11 equal 0.5*(-32.4652006067262+108.715132926324)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(-78.4676388717401+${C2pos})
variable C21 equal 0.5*(-78.4676388717401+90.6118787467871)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(-105.010851490713+${C3pos})
variable C31 equal 0.5*(-105.010851490713+122.136645275922)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-23.7832642699697+${C4pos})
variable C41 equal 0.5*(-23.7832642699697+29.2182997638987)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(14.6500863426017+${C5pos})
variable C51 equal 0.5*(14.6500863426017+-14.7597153376145)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(0.776595763070091+${C6pos})
variable C61 equal 0.5*(0.776595763070091+-7.3365240110791)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 12.7411
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.7411
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.127411 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.127411 yz delta -0.003384 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.613689 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.613689 17.5034) with tilt (-7.2027 -1.8261 0.335016)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.4 | 121.6 | 122.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   293.7744      -34332.672      66378.029      0              3402.5666    
       100   326.83534     -34358.913      9347.8287      8150.4703      3402.5666    
       200   304.29088     -34369.724     -7650.5899     -1960.6274      3402.5666    
       300   301.92049     -34402.808      10545.553      4380.4403      3402.5666    
       400   290.11484     -34415.39       5475.2882      3958.2052      3402.5666    
       500   273.44432     -34403.981     -432.96106      4658.9853      3402.5666    
       600   301.28754     -34406.179      2739.0347      2396.2624      3402.5666    
       700   298.45129     -34373.048     -6661.5867     -588.89949      3402.5666    
       800   325.07592     -34381.432     -595.45295      1686.849       3402.5666    
       900   302.34106     -34376.439      6725.4839      4980.5039      3402.5666    
      1000   292.19818     -34400.93       5967.6242      3330.4849      3402.5666    
      1100   287.05602     -34420.76      -3006.7091      3737.1117      3402.5666    
      1200   303.20149     -34450.287     -1205.9782      3556.9463      3402.5666    
      1300   299.07004     -34440.651      1145.0034      2915.3407      3402.5666    
      1400   289.92092     -34405.73       6487.4223      678.67166      3402.5666    
      1500   316.60979     -34401.322      1245.8423      3410.4538      3402.5666    
      1600   320.92766     -34402.749     -8153.8995      6175.7297      3402.5666    
      1700   312.96295     -34422.321      2699.0669      7735.0446      3402.5666    
      1800   279.37517     -34418.27      -220.12249     -2031.067       3402.5666    
      1900   277.88438     -34422.653     -3265.7669      3814.6582      3402.5666    
      2000   307.48103     -34432.684     -10839.539      1271.5         3402.5666    
      2100   298.5663      -34402.667      1176.7361      5648.8651      3402.5666    
      2200   320.79786     -34407.121      468.09416      2964.2186      3402.5666    
      2300   299.78327     -34396.715      5623.3128      11437.643      3402.5666    
      2400   282.62318     -34409.99      -2998.8695      2307.9061      3402.5666    
      2500   288.10354     -34425.674     -4010.286       2859.2694      3402.5666    
      2600   301.92266     -34434.071     -918.59668      5376.3465      3402.5666    
      2700   326.71022     -34427.484      7789.8459      5976.5202      3402.5666    
      2800   314.70166     -34404.721     -3955.5937      3960.8869      3402.5666    
      2900   306.22507     -34406.597      338.54365      4600.2444      3402.5666    
      3000   301.44375     -34410.542      5817.2218      1216.8381      3402.5666    
Loop time of 137.988 on 8 procs for 3000 steps with 310 atoms

Performance: 0.939 ns/day, 25.553 hours/ns, 21.741 timesteps/s, 6.740 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 78.122     | 102.13     | 116.38     | 142.0 | 74.01
Bond    | 0.0079983  | 0.0090425  | 0.0097842  |   0.6 |  0.01
Neigh   | 5.9147     | 7.656      | 8.7629     |  39.7 |  5.55
Comm    | 1.1176     | 15.385     | 39.368     | 366.0 | 11.15
Output  | 0.0067201  | 0.0083589  | 0.0099379  |   1.4 |  0.01
Modify  | 11.628     | 12.735     | 14.502     |  30.8 |  9.23
Other   |            | 0.06997    |            |       |  0.05

Nlocal:          38.75 ave          47 max          34 min
Histogram: 1 0 2 3 1 0 0 0 0 1
Nghost:        3109.25 ave        3155 max        3084 min
Histogram: 2 1 0 2 1 1 0 0 0 1
Neighs:        24753.1 ave       29826 max       21933 min
Histogram: 1 0 4 1 1 0 0 0 0 1

Total # of neighbors = 198025
Ave neighs/atom = 638.79032
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.3 | 121.6 | 122.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   301.44375     -34410.542      5817.2388      0              3402.5666    
       100   293.1692      -34410.464     -3990.4005      2118.9091      3402.5666    
       200   285.42109     -34428.308     -5550.5378      67.854008      3402.5666    
       300   273.46829     -34433.969     -8696.2877     -412.66027      3402.5666    
       400   293.80204     -34422.409     -7268.7252     -1757.4618      3402.5666    
       500   303.9797      -34410.755     -6852.6891      1311.7631      3402.5666    
       600   299.94648     -34412.473     -9718.2687      4230.1954      3402.5666    
       700   277.86207     -34408.544     -11747.653      4545.8547      3402.5666    
       800   291.68766     -34425.243     -1228.6247      5350.7781      3402.5666    
       900   308.66276     -34439.765      6893.6673      3385.3172      3402.5666    
      1000   307.1222      -34429.992      4083.6508      9995.2096      3402.5666    
      1100   291.82608     -34411.186      10056.979      8505.8947      3402.5666    
      1200   317.33895     -34419.28      -5871.0193      2863.463       3402.5666    
      1300   308.2949      -34408.387      684.6579       3942.9171      3402.5666    
      1400   277.343       -34400.072     -7950.5274      2298.6814      3402.5666    
      1500   286.33465     -34430.616      7236.2726      1229.5444      3402.5666    
      1600   285.26688     -34436.364      4600.7237      10050.16       3402.5666    
      1700   298.25056     -34416.434      130.80668      443.23121      3402.5666    
      1800   313.8241      -34411.19       6455.8202      5765.0233      3402.5666    
      1900   307.8218      -34413.502      1347.0097      911.73644      3402.5666    
      2000   314.46195     -34438.582      1415.1129      1873.7216      3402.5666    
      2100   301.1612      -34438.994     -1846.5074      1429.0437      3402.5666    
      2200   305.96042     -34450.736     -2137.6253      3302.1472      3402.5666    
      2300   308.17511     -34461.32       6871.4176      4523.7795      3402.5666    
      2400   283.15297     -34437.504     -13796.227      1443.3757      3402.5666    
      2500   290.72353     -34420.924      6499.8437      532.01654      3402.5666    
      2600   300.89864     -34415.01      -20403.942      166.56899      3402.5666    
      2700   291.76185     -34405.82      -11606.805      2189.7935      3402.5666    
      2800   284.70349     -34425.584     -24934.675      2080.8868      3402.5666    
      2900   274.9363      -34435.189     -5984.9459     -1114.0905      3402.5666    
      3000   309.63517     -34454.275     -6911.5729      1894.6594      3402.5666    
Loop time of 139.146 on 8 procs for 3000 steps with 310 atoms

Performance: 0.931 ns/day, 25.768 hours/ns, 21.560 timesteps/s, 6.684 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 80.699     | 102.33     | 114.68     | 112.7 | 73.54
Bond    | 0.0082027  | 0.0090996  | 0.0096653  |   0.5 |  0.01
Neigh   | 5.9625     | 7.6246     | 8.3465     |  29.4 |  5.48
Comm    | 3.6221     | 15.923     | 37.66      | 286.8 | 11.44
Output  | 0.0013141  | 0.0015225  | 0.0025697  |   1.0 |  0.00
Modify  | 12.422     | 13.19      | 14.753     |  20.9 |  9.48
Other   |            | 0.06944    |            |       |  0.05

Nlocal:          38.75 ave          48 max          33 min
Histogram: 2 0 0 1 3 1 0 0 0 1
Nghost:        3114.25 ave        3158 max        3067 min
Histogram: 1 1 1 0 0 1 1 1 1 1
Neighs:        24755.9 ave       30256 max       21186 min
Histogram: 2 0 0 2 2 1 0 0 0 1

Total # of neighbors = 198047
Ave neighs/atom = 638.86129
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -30.2471011076472
variable C2neg equal ${d2}
variable C2neg equal -30.4102881711318
variable C3neg equal ${d3}
variable C3neg equal -10.2500524010067
variable C4neg equal ${d4}
variable C4neg equal -24.30278474801
variable C5neg equal ${d5}
variable C5neg equal 12.0090270537106
variable C6neg equal ${d6}
variable C6neg equal -10.2081280161415

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.7411
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.127411 yz delta ${deltayz} remap units box
change_box all y delta 0 0.127411 yz delta 0.003384 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.868511 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.868511 17.5034) with tilt (-7.2027 -1.8261 0.341784)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 117.6 | 118.8 | 119.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   293.7744      -34341.74      -33276.511      0              3471.3053    
       100   326.55698     -34361.078      4974.7039      7760.9292      3471.3053    
       200   311.69419     -34367.477     -21690.695     -4082.5301      3471.3053    
       300   298.6784      -34375.4       -2078.7133     -2836.7819      3471.3053    
       400   313.78705     -34398.303     -1221.9502     -1604.0691      3471.3053    
       500   279.42874     -34371.837      1670.2516     -1273.2549      3471.3053    
       600   297.00209     -34374.945     -15649.44       4886.4634      3471.3053    
       700   304.44692     -34369.06      -344.01911      1445.9237      3471.3053    
       800   312.11237     -34365.202     -5269.8773     -4211.8197      3471.3053    
       900   325.73788     -34375.423     -6249.9404      169.49019      3471.3053    
      1000   298.98091     -34357.159      10957.473     -4847.7274      3471.3053    
      1100   297.28048     -34374.046     -5189.577       582.01475      3471.3053    
      1200   305.87348     -34396.367      5953.545       3023.6608      3471.3053    
      1300   295.00486     -34387.692      8990.2086      2265.5899      3471.3053    
      1400   308.52935     -34381.977      427.85573     -3793.9295      3471.3053    
      1500   315.71607     -34369.478      2360.9629      752.30781      3471.3053    
      1600   301.45487     -34356.666     -17715.314     -4302.116       3471.3053    
      1700   304.20112     -34380.617     -11777.529     -2314.9354      3471.3053    
      1800   294.82396     -34385.901     -6690.1801     -1499.1765      3471.3053    
      1900   290.72623     -34379.215     -1536.8346      782.41619      3471.3053    
      2000   319.46491     -34388.746     -14155.823     -6185.3112      3471.3053    
      2100   322.15694     -34379.999     -221.29827     -823.04931      3471.3053    
      2200   314.02313     -34379.743     -4964.9097     -4501.1048      3471.3053    
      2300   296.27817     -34385.219     -9325.0681     -5184.6134      3471.3053    
      2400   290.82982     -34386.58       3817.3811     -553.41216      3471.3053    
      2500   295.30318     -34376.545     -4128.5117      1414.3435      3471.3053    
      2600   305.96631     -34357.78       10427.075      306.80251      3471.3053    
      2700   306.77428     -34356.14       22.967673      2873.2292      3471.3053    
      2800   313.60851     -34374.142     -2699.5887      1614.3608      3471.3053    
      2900   300.78098     -34372.743     -8689.4343      5457.7267      3471.3053    
      3000   281.82381     -34360.191      10458.981      1194.321       3471.3053    
Loop time of 133.932 on 8 procs for 3000 steps with 310 atoms

Performance: 0.968 ns/day, 24.802 hours/ns, 22.399 timesteps/s, 6.944 katom-step/s
98.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 94.833     | 106.15     | 110.94     |  45.9 | 79.26
Bond    | 0.0086579  | 0.0092061  | 0.010293   |   0.6 |  0.01
Neigh   | 7.0277     | 7.9918     | 8.5183     |  14.9 |  5.97
Comm    | 2.6139     | 7.4183     | 18.738     | 173.9 |  5.54
Output  | 0.0069094  | 0.0088457  | 0.010884   |   1.6 |  0.01
Modify  | 11.74      | 12.274     | 13.245     |  12.5 |  9.16
Other   |            | 0.07663    |            |       |  0.06

Nlocal:          38.75 ave          45 max          34 min
Histogram: 3 1 0 0 0 0 1 2 0 1
Nghost:        3069.25 ave        3128 max        3005 min
Histogram: 1 0 0 2 1 1 1 0 1 1
Neighs:        24263.1 ave       27906 max       21462 min
Histogram: 3 0 1 0 0 0 1 2 0 1

Total # of neighbors = 194105
Ave neighs/atom = 626.14516
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 117.7 | 118.8 | 119.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   281.82381     -34360.191      10459.006      0              3471.3053    
       100   310.7645      -34381.381     -7674.5986     -7873.9271      3471.3053    
       200   332.403       -34379.842     -3079.0634      1767.0515      3471.3053    
       300   301.05108     -34342.797     -10800.235     -2681.188       3471.3053    
       400   306.27701     -34370.049     -10932.188     -5541.7373      3471.3053    
       500   288.38118     -34376.775     -2857.426      -3326.8998      3471.3053    
       600   287.87758     -34383.858      8267.1261      5921.3371      3471.3053    
       700   294.46152     -34383.275     -7506.0182     -946.92663      3471.3053    
       800   299.22643     -34376.184      2438.0097      1808.5796      3471.3053    
       900   308.66646     -34379.313      3265.9685      774.32712      3471.3053    
      1000   304.86883     -34377.37      -17310.519      3606.0388      3471.3053    
      1100   305.00031     -34387.057     -6521.2677      5374.3514      3471.3053    
      1200   287.20235     -34387.184     -8047.7811      833.14166      3471.3053    
      1300   292.97342     -34407.11      -7002.4058      5585.9312      3471.3053    
      1400   286.96627     -34406.636     -5528.8588      2212.3767      3471.3053    
      1500   309.12751     -34406.532      2139.4966     -4841.2333      3471.3053    
      1600   332.80765     -34403.695      561.00218     -1354.9242      3471.3053    
      1700   318.16964     -34390.845     -3668.2893     -493.33576      3471.3053    
      1800   294.18864     -34398.46       7086.3664      1517.8876      3471.3053    
      1900   298.16925     -34416.4        536.22562      1430.2364      3471.3053    
      2000   301.40047     -34428.108     -1410.3985     -4358.5455      3471.3053    
      2100   307.61101     -34441.333     -8836.7837      1872.5608      3471.3053    
      2200   293.90212     -34435.768     -7205.8718     -74.756272      3471.3053    
      2300   297.35167     -34440.067      3700.8582      2441.8652      3471.3053    
      2400   302.05887     -34433.127     -7943.1824      7716.9945      3471.3053    
      2500   312.1796      -34420.29      -12508.82       606.95102      3471.3053    
      2600   339.56237     -34438.473      4937.9283     -3001.6674      3471.3053    
      2700   308.88764     -34439.07      -12747.231     -3865.1363      3471.3053    
      2800   292.52905     -34444.409     -18527.05      -11422.466      3471.3053    
      2900   298.12859     -34444.878     -9735.8759     -962.29516      3471.3053    
      3000   297.91746     -34424.883     -1257.7419     -2348.3278      3471.3053    
Loop time of 132.726 on 8 procs for 3000 steps with 310 atoms

Performance: 0.976 ns/day, 24.579 hours/ns, 22.603 timesteps/s, 7.007 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 78.76      | 104.88     | 111.34     |  98.4 | 79.02
Bond    | 0.0086312  | 0.0092052  | 0.010456   |   0.6 |  0.01
Neigh   | 5.8787     | 7.8381     | 8.5249     |  27.3 |  5.91
Comm    | 1.6088     | 8.0684     | 34.164     | 354.6 |  6.08
Output  | 0.0013169  | 0.0016277  | 0.0034349  |   1.7 |  0.00
Modify  | 11.146     | 11.849     | 13.848     |  22.6 |  8.93
Other   |            | 0.07626    |            |       |  0.06

Nlocal:          38.75 ave          46 max          35 min
Histogram: 1 3 1 1 0 1 0 0 0 1
Nghost:        3062.75 ave        3115 max        3015 min
Histogram: 1 1 0 1 1 1 1 1 0 1
Neighs:        24246.2 ave       28427 max       21892 min
Histogram: 1 2 2 0 1 1 0 0 0 1

Total # of neighbors = 193970
Ave neighs/atom = 625.70968
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 73.2391687652144
variable C2pos equal ${d2}
variable C2pos equal 70.5827163765979
variable C3pos equal ${d3}
variable C3pos equal 48.3987228047101
variable C4pos equal ${d4}
variable C4pos equal -5.09669332845051
variable C5pos equal ${d5}
variable C5pos equal -32.9489243195864
variable C6pos equal ${d6}
variable C6pos equal -12.2953806630492

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(-30.2471011076472+${C1pos})
variable C12 equal 0.5*(-30.2471011076472+73.2391687652144)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(-30.4102881711318+${C2pos})
variable C22 equal 0.5*(-30.4102881711318+70.5827163765979)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(-10.2500524010067+${C3pos})
variable C32 equal 0.5*(-10.2500524010067+48.3987228047101)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-24.30278474801+${C4pos})
variable C42 equal 0.5*(-24.30278474801+-5.09669332845051)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(12.0090270537106+${C5pos})
variable C52 equal 0.5*(12.0090270537106+-32.9489243195864)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(-10.2081280161415+${C6pos})
variable C62 equal 0.5*(-10.2081280161415+-12.2953806630492)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.5034
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.5034
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.175034 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.7411 17.328366) with tilt (-7.2027 -1.8261 0.3384)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.9 | 121.3 | 122.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   293.7744      -34330.635      75441.277      0              3402.5666    
       100   313.18949     -34344.564      6864.5698      8043.5944      3402.5666    
       200   292.18873     -34359.374     -18311.264     -497.85097      3402.5666    
       300   285.40581     -34388.973     -6017.4726      1816.7955      3402.5666    
       400   277.7706      -34404.858     -2282.0002     -974.74762      3402.5666    
       500   277.32461     -34410.078     -7400.4145      8894.7706      3402.5666    
       600   284.86596     -34397.175      763.68282      5399.216       3402.5666    
       700   301.37376     -34379.761     -7148.4968      5568.2277      3402.5666    
       800   301.80273     -34363.022     -520.10846      1411.1625      3402.5666    
       900   323.49812     -34390.742      2594.0012      4856.8334      3402.5666    
      1000   296.6971      -34395.404      12205.082      4216.7815      3402.5666    
      1100   294.33943     -34418.473     -868.75006      6222.7384      3402.5666    
      1200   283.85089     -34413.333      14788.519      7826.2323      3402.5666    
      1300   299.2246      -34412.495     -19842.971      2402.2232      3402.5666    
      1400   296.31655     -34385.986      4487.0055      2248.3287      3402.5666    
      1500   327.15745     -34403.588     -17071.42      -3803.7346      3402.5666    
      1600   309.53851     -34400.88       7794.0588      429.99722      3402.5666    
      1700   294.40761     -34415.958     -5973.6978      2263.0622      3402.5666    
      1800   306.20937     -34438.088     -7314.3272      1165.5306      3402.5666    
      1900   296.20187     -34424.784     -615.56959      10516.487      3402.5666    
      2000   297.38089     -34410.507     -7391.6546      2417.582       3402.5666    
      2100   301.78949     -34396.884     -3732.473       2763.7382      3402.5666    
      2200   315.02365     -34410.547     -66.448795      1843.4914      3402.5666    
      2300   298.38048     -34411.677     -4831.0966     -3572.7466      3402.5666    
      2400   301.34144     -34423.683     -2812.0017      3631.1312      3402.5666    
      2500   289.45604     -34413.144      949.53697      2526.0475      3402.5666    
      2600   284.87973     -34415.422     -2108.2867      5920.935       3402.5666    
      2700   300.11351     -34427.09      -818.12966      973.75658      3402.5666    
      2800   305.75541     -34408.458     -9947.2239     -3507.111       3402.5666    
      2900   331.90209     -34424.195      2082.691       1001.1196      3402.5666    
      3000   307.44892     -34417.152     -712.60922      5577.5738      3402.5666    
Loop time of 136.851 on 8 procs for 3000 steps with 310 atoms

Performance: 0.947 ns/day, 25.343 hours/ns, 21.922 timesteps/s, 6.796 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 104.5      | 110.4      | 115.02     |  30.8 | 80.67
Bond    | 0.0084244  | 0.0091179  | 0.0099634  |   0.5 |  0.01
Neigh   | 7.6435     | 8.2801     | 8.8328     |  11.1 |  6.05
Comm    | 1.5139     | 6.1344     | 12.002     | 130.6 |  4.48
Output  | 0.0063556  | 0.0082903  | 0.009948   |   1.6 |  0.01
Modify  | 11.375     | 11.944     | 12.614     |   9.7 |  8.73
Other   |            | 0.07763    |            |       |  0.06

Nlocal:          38.75 ave          43 max          34 min
Histogram: 1 1 0 1 1 1 0 1 0 2
Nghost:        3103.75 ave        3150 max        3067 min
Histogram: 2 2 0 0 0 0 1 2 0 1
Neighs:        24777.6 ave       27358 max       22034 min
Histogram: 1 1 0 1 1 1 0 1 0 2

Total # of neighbors = 198221
Ave neighs/atom = 639.42258
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.8 | 121.3 | 122.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.44892     -34417.152     -712.63572      0              3402.5666    
       100   308.57039     -34418.573     -7229.7768     -1896.2895      3402.5666    
       200   292.13891     -34403.502     -7047.0017      8378.7803      3402.5666    
       300   297.39743     -34409.742     -2856.8484     -3711.6718      3402.5666    
       400   316.5954      -34426.001     -5251.0672      2251.0563      3402.5666    
       500   314.76482     -34427.742      6326.6127      3609.4247      3402.5666    
       600   298.5346      -34435.437      2673.6652      3172.7771      3402.5666    
       700   292.64695     -34445.484      2394.6325      7497.2678      3402.5666    
       800   298.29185     -34436.517     -3622.0048      5419.5762      3402.5666    
       900   312.50812     -34416.748     -4556.9838      4245.5178      3402.5666    
      1000   317.06118     -34424.549      6390.7415      6979.193       3402.5666    
      1100   297.63924     -34427.068     -5999.3639     -339.5947       3402.5666    
      1200   290.95421     -34435.501     -4535.7131     -3871.4617      3402.5666    
      1300   296.5412      -34444.258      6114.4758      4495.3701      3402.5666    
      1400   292.67288     -34443.023     -12014.876     -4064.4883      3402.5666    
      1500   298.00998     -34428.759     -19609.051     -1634.2726      3402.5666    
      1600   323.91409     -34433.855      5068.5768      5439.7775      3402.5666    
      1700   310.72561     -34430.924     -13121.784      2486.8252      3402.5666    
      1800   287.96049     -34436.508     -20923.449      438.30746      3402.5666    
      1900   282.63009     -34439.527     -11406.896     -2424.1286      3402.5666    
      2000   320.70099     -34464.591     -1273.701       2404.2987      3402.5666    
      2100   302.91327     -34442.967     -10033.17       3300.9453      3402.5666    
      2200   296.07915     -34427.22       8227.2377     -748.19617      3402.5666    
      2300   313.75591     -34419.642     -17471.837     -3738.4325      3402.5666    
      2400   332.47749     -34414.674     -2970.3423     -3265.2279      3402.5666    
      2500   328.86234     -34431.034      3166.4517      3028.7249      3402.5666    
      2600   301.26721     -34435.968     -4900.8228      3613.0566      3402.5666    
      2700   284.11992     -34430.048     -4601.3399      958.9819       3402.5666    
      2800   277.6989      -34424.863      7215.5137      818.66734      3402.5666    
      2900   297.73169     -34429.386     -211.25384     -11520.593      3402.5666    
      3000   299.45907     -34406.876      5825.7806     -4040.8874      3402.5666    
Loop time of 137.366 on 8 procs for 3000 steps with 310 atoms

Performance: 0.943 ns/day, 25.438 hours/ns, 21.839 timesteps/s, 6.770 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 106.25     | 111.14     | 115.4      |  28.8 | 80.91
Bond    | 0.0087008  | 0.0092677  | 0.010045   |   0.5 |  0.01
Neigh   | 8.0777     | 8.3263     | 8.8162     |   7.9 |  6.06
Comm    | 1.4209     | 5.681      | 10.57      | 127.7 |  4.14
Output  | 0.001332   | 0.0015115  | 0.0025836  |   1.0 |  0.00
Modify  | 11.623     | 12.129     | 12.403     |   6.9 |  8.83
Other   |            | 0.07613    |            |       |  0.06

Nlocal:          38.75 ave          44 max          33 min
Histogram: 2 1 0 0 0 1 1 0 1 2
Nghost:        3091.25 ave        3130 max        3040 min
Histogram: 1 1 0 1 0 1 0 1 0 3
Neighs:        24753.1 ave       27859 max       21372 min
Histogram: 2 1 0 0 0 1 1 0 1 2

Total # of neighbors = 198025
Ave neighs/atom = 638.79032
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -90.3890289008093
variable C2neg equal ${d2}
variable C2neg equal -41.6593796965235
variable C3neg equal ${d3}
variable C3neg equal -19.2204529689767
variable C4neg equal ${d4}
variable C4neg equal -4.18509097851453
variable C5neg equal ${d5}
variable C5neg equal 30.9591304084404
variable C6neg equal ${d6}
variable C6neg equal -8.85301961300072

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.5034
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.175034 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.7411 17.678434) with tilt (-7.2027 -1.8261 0.3384)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 118.6 | 119.6 | 120.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   293.7744      -34335.351     -39564.824      0              3471.3053    
       100   333.04694     -34363.281      1563.4587      7851.5214      3471.3053    
       200   299.0082      -34354.225     -4722.7003     -2716.2436      3471.3053    
       300   306.64734     -34385.605      112.19004     -1474.6645      3471.3053    
       400   290.7019      -34385.016     -4694.1333      343.57381      3471.3053    
       500   288.4283      -34382.123     -2673.7568      3807.1093      3471.3053    
       600   315.32382     -34393.185     -7395.8226      3745.9485      3471.3053    
       700   303.82569     -34360.993      2552.6875     -3142.1631      3471.3053    
       800   302.38286     -34347.884     -6717.228      -4265.7788      3471.3053    
       900   302.74121     -34351.337     -9653.7429      2774.1287      3471.3053    
      1000   311.44361     -34377.245     -22729.607     -2909.1327      3471.3053    
      1100   289.83003     -34380.228     -919.96428      5456.2231      3471.3053    
      1200   281.18547     -34377.67      -2313.1313      635.73527      3471.3053    
      1300   303.83343     -34379.68      -6263.0598     -2487.736       3471.3053    
      1400   327.46747     -34379.696      7167.7603      217.86299      3471.3053    
      1500   326.37697     -34386.915     -8232.6453      6610.3046      3471.3053    
      1600   291.18537     -34383.293     -6762.411       1004.1351      3471.3053    
      1700   304.15217     -34411.717     -2509.9888     -982.6485       3471.3053    
      1800   303.41421     -34403.688     -1295.7538      3854.5237      3471.3053    
      1900   308.25995     -34389.664      15153.428      8235.6802      3471.3053    
      2000   312.37597     -34385.258      1849.9603      6805.9203      3471.3053    
      2100   295.26535     -34381.926      3027.7163      2149.2153      3471.3053    
      2200   292.74794     -34391.118     -4524.892      -368.81957      3471.3053    
      2300   325.64192     -34429.759     -2586.6783      4926.7919      3471.3053    
      2400   281.08797     -34398.745      4706.0363      3609.3091      3471.3053    
      2500   295.7121      -34414.901      7941.8115      2286.3075      3471.3053    
      2600   299.08791     -34401.56      -5327.3151      2075.5191      3471.3053    
      2700   317.57414     -34388.979     -446.16519      5256.1614      3471.3053    
      2800   305.70975     -34383.24       1034.925       4882.4702      3471.3053    
      2900   301.41692     -34397.837     -5333.8066     -515.06787      3471.3053    
      3000   308.84725     -34409.244      6704.056       3246.5614      3471.3053    
Loop time of 133.85 on 8 procs for 3000 steps with 310 atoms

Performance: 0.968 ns/day, 24.787 hours/ns, 22.413 timesteps/s, 6.948 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 104.32     | 108.89     | 112.26     |  24.2 | 81.36
Bond    | 0.0086244  | 0.0093258  | 0.010228   |   0.5 |  0.01
Neigh   | 7.9405     | 8.1799     | 8.6593     |   8.2 |  6.11
Comm    | 1.6371     | 5.0288     | 9.5961     | 112.9 |  3.76
Output  | 0.0064188  | 0.0081911  | 0.0097843  |   1.5 |  0.01
Modify  | 11.153     | 11.652     | 11.894     |   7.2 |  8.71
Other   |            | 0.07742    |            |       |  0.06

Nlocal:          38.75 ave          46 max          34 min
Histogram: 1 1 1 1 2 1 0 0 0 1
Nghost:        3062.88 ave        3092 max        3032 min
Histogram: 1 0 1 2 0 1 1 0 0 2
Neighs:        24262.8 ave       28511 max       21500 min
Histogram: 1 1 1 1 2 1 0 0 0 1

Total # of neighbors = 194102
Ave neighs/atom = 626.13548
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 118.6 | 119.6 | 120.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   308.84725     -34409.244      6704.0631      0              3471.3053    
       100   309.02459     -34411.348     -3415.2061     -1674.4043      3471.3053    
       200   297.10546     -34406.14      -13668.078     -1963.4909      3471.3053    
       300   288.52927     -34402.623     -11695.927     -4153.7437      3471.3053    
       400   303.69472     -34414.555     -3506.4237      2092.8646      3471.3053    
       500   290.31216     -34392.397      4107.6012      5975.5714      3471.3053    
       600   307.40992     -34391.445      9995.3545      1522.3886      3471.3053    
       700   317.31062     -34383.669     -4780.6829      3056.1092      3471.3053    
       800   292.67551     -34380.416      862.18892      2469.5296      3471.3053    
       900   295.87017     -34410.361     -6971.6897     -317.06452      3471.3053    
      1000   305.36375     -34417.795      9823.2566      2906.0045      3471.3053    
      1100   315.03032     -34427.587     -9087.5479      3414.5137      3471.3053    
      1200   283.22667     -34423.336      345.14226     -1454.6851      3471.3053    
      1300   287.48632     -34446.504     -3347.8859     -5036.4944      3471.3053    
      1400   285.98842     -34439.472     -6570.7883      508.11878      3471.3053    
      1500   282.45292     -34416.459      3651.3602     -5180.26        3471.3053    
      1600   316.43119     -34443.928     -7459.2727     -4782.814       3471.3053    
      1700   285.14231     -34418.385      5814.1797      273.455        3471.3053    
      1800   300.38879     -34433.164     -1504.4819     -2239.7793      3471.3053    
      1900   296.36747     -34410.752     -11013.85       928.66531      3471.3053    
      2000   322.35791     -34412.812     -7317.6329      2816.7495      3471.3053    
      2100   307.00733     -34400.034     -2733.5253      1538.4084      3471.3053    
      2200   309.93195     -34441.744     -10678.463     -476.84976      3471.3053    
      2300   278.56055     -34421.302     -6097.1821      1933.1656      3471.3053    
      2400   303.42043     -34429.714      5225.681      -1615.4201      3471.3053    
      2500   299.1534      -34409.772     -9031.2809     -272.12221      3471.3053    
      2600   285.3716      -34384.005     -10589.381      38.594586      3471.3053    
      2700   310.87382     -34390.69      -755.07623     -2252.9118      3471.3053    
      2800   333.88375     -34413.644      5536.491       1360.083       3471.3053    
      2900   298.37649     -34416.849      6549.5763      4330.2114      3471.3053    
      3000   296.44994     -34427.964     -16200.917      2488.6113      3471.3053    
Loop time of 135.721 on 8 procs for 3000 steps with 310 atoms

Performance: 0.955 ns/day, 25.134 hours/ns, 22.104 timesteps/s, 6.852 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 104.93     | 109.95     | 114.46     |  28.1 | 81.01
Bond    | 0.0084424  | 0.0092252  | 0.0099586  |   0.5 |  0.01
Neigh   | 7.9419     | 8.2118     | 8.7183     |   8.7 |  6.05
Comm    | 1.1217     | 5.6645     | 10.672     | 124.2 |  4.17
Output  | 0.0013243  | 0.0016152  | 0.0030606  |   1.4 |  0.00
Modify  | 11.283     | 11.812     | 12.066     |   7.6 |  8.70
Other   |            | 0.07685    |            |       |  0.06

Nlocal:          38.75 ave          42 max          34 min
Histogram: 1 0 2 0 0 0 1 1 1 2
Nghost:        3086.75 ave        3122 max        3043 min
Histogram: 1 1 0 1 1 0 0 1 2 1
Neighs:        24226.9 ave       26100 max       21364 min
Histogram: 1 0 1 1 0 0 1 1 1 2

Total # of neighbors = 193815
Ave neighs/atom = 625.20968
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 24.2288837937178
variable C2pos equal ${d2}
variable C2pos equal 13.6226463396391
variable C3pos equal ${d3}
variable C3pos equal 51.7136917017693
variable C4pos equal ${d4}
variable C4pos equal 12.6699906694347
variable C5pos equal ${d5}
variable C5pos equal -2.11196253272902
variable C6pos equal ${d6}
variable C6pos equal 11.0590990840691

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(-90.3890289008093+${C1pos})
variable C13 equal 0.5*(-90.3890289008093+24.2288837937178)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(-41.6593796965235+${C2pos})
variable C23 equal 0.5*(-41.6593796965235+13.6226463396391)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(-19.2204529689767+${C3pos})
variable C33 equal 0.5*(-19.2204529689767+51.7136917017693)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-4.18509097851453+${C4pos})
variable C43 equal 0.5*(-4.18509097851453+12.6699906694347)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(30.9591304084404+${C5pos})
variable C53 equal 0.5*(30.9591304084404+-2.11196253272902)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-8.85301961300072+${C6pos})
variable C63 equal 0.5*(-8.85301961300072+11.0590990840691)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.5034
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.5034
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.175034 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.163366)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119 | 120.3 | 121.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   293.7744      -34351.023      11878.834      0              3436.9359    
       100   318.45641     -34360.368      12429.389      8457.7011      3436.9359    
       200   306.95165     -34365.188     -12800.937     -1983.4292      3436.9359    
       300   301.50062     -34383.664     -2324.0163      1919.8491      3436.9359    
       400   307.63028     -34404.825      9815.1801      2987.9197      3436.9359    
       500   285.7201      -34391.32      -5386.4726     -1025.1103      3436.9359    
       600   300.67484     -34391.207      5712.9094      3626.4096      3436.9359    
       700   294.03254     -34368.437     -6881.7266     -823.06572      3436.9359    
       800   299.35624     -34362.946     -2031.4415      1182.1989      3436.9359    
       900   315.28688     -34384.836     -26168.452      1374.5963      3436.9359    
      1000   292.72433     -34390.51      -10456.963     -374.56765      3436.9359    
      1100   285.28544     -34396.458     -6247.6651      1451.4743      3436.9359    
      1200   287.79596     -34399.778      1214.963       8082.0402      3436.9359    
      1300   287.55328     -34388.974     -12865.656      7477.7154      3436.9359    
      1400   325.92256     -34406.429      4192.3872      814.92405      3436.9359    
      1500   296.77679     -34367.127     -7023.0001      3992.2823      3436.9359    
      1600   294.56558     -34370.085     -3103.8869      4784.8154      3436.9359    
      1700   295.18105     -34395.268      1033.5768      6066.7221      3436.9359    
      1800   296.69466     -34410.885     -6502.1837      1003.9059      3436.9359    
      1900   285.05587     -34397.936     -69.513768      5770.8543      3436.9359    
      2000   300.29863     -34388.106     -17351.51       1912.9428      3436.9359    
      2100   306.04067     -34377.859     -7614.3337      4531.8893      3436.9359    
      2200   323.21262     -34402.119      1865.652       3894.4463      3436.9359    
      2300   285.91468     -34393.591     -8204.0042      4020.008       3436.9359    
      2400   292.76535     -34405.173      1322.5249      3720.7029      3436.9359    
      2500   303.3855      -34407.477     -17722.831      869.24516      3436.9359    
      2600   304.19226     -34384.844     -1598.332       5130.5085      3436.9359    
      2700   317.38679     -34387.093     -15718.047     -1786.1441      3436.9359    
      2800   292.11415     -34396.274     -12452.153      5126.3131      3436.9359    
      2900   292.8249      -34412.493      12301.819     -1443.7351      3436.9359    
      3000   281.05219     -34395.704      10015.54       10341.411      3436.9359    
Loop time of 135.686 on 8 procs for 3000 steps with 310 atoms

Performance: 0.955 ns/day, 25.127 hours/ns, 22.110 timesteps/s, 6.854 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 106.56     | 110.94     | 114.34     |  21.6 | 81.76
Bond    | 0.0084628  | 0.0091328  | 0.0099173  |   0.5 |  0.01
Neigh   | 7.9426     | 8.2111     | 8.645      |   8.1 |  6.05
Comm    | 1.3387     | 4.775      | 9.1504     | 104.6 |  3.52
Output  | 0.0065946  | 0.0082209  | 0.0097153  |   1.3 |  0.01
Modify  | 11.216     | 11.666     | 11.924     |   7.0 |  8.60
Other   |            | 0.07721    |            |       |  0.06

Nlocal:          38.75 ave          46 max          34 min
Histogram: 2 0 2 0 0 3 0 0 0 1
Nghost:        3083.62 ave        3141 max        3034 min
Histogram: 2 0 0 0 2 2 0 1 0 1
Neighs:        24521.4 ave       28845 max       21764 min
Histogram: 2 0 2 0 2 1 0 0 0 1

Total # of neighbors = 196171
Ave neighs/atom = 632.80968
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 118.9 | 120.3 | 121.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   281.05219     -34395.704      10015.505      0              3436.9359    
       100   300.80063     -34408.675      9533.7866     -1056.9124      3436.9359    
       200   303.58472     -34397.183     -20823.421      417.92067      3436.9359    
       300   315.48632     -34382.161      2079.0961      2591.6744      3436.9359    
       400   302.89168     -34378.518      8742.2013     -543.74476      3436.9359    
       500   305.19167     -34413.341     -1761.8453      3652.9723      3436.9359    
       600   305.90466     -34423.382     -1658.6596      2301.5868      3436.9359    
       700   292.35365     -34411.83      -12300.069      1844.1288      3436.9359    
       800   297.15292     -34400.67       2398.8061      7988.712       3436.9359    
       900   356.82773     -34443.803     -5959.5661      8762.5696      3436.9359    
      1000   305.38316     -34438.105     -4654.9428     -8909.5121      3436.9359    
      1100   286.094       -34439.697     -6834.9515      334.7848       3436.9359    
      1200   269.53382     -34425.867     -4059.3609      1597.2289      3436.9359    
      1300   306.82233     -34448.478      1801.7984     -592.68806      3436.9359    
      1400   300.69013     -34428.129     -11808.903     -1014.1191      3436.9359    
      1500   308.22948     -34434.412      9375.7716     -1957.3818      3436.9359    
      1600   287.34969     -34438.978     -13472.56       4722.696       3436.9359    
      1700   280.35159     -34450.16      -12574         -4162.0384      3436.9359    
      1800   283.83173     -34452.066     -3475.173       3464.9769      3436.9359    
      1900   298.70448     -34431.083     -3527.4986      2628.8319      3436.9359    
      2000   331.47146     -34450.077     -2519.9109     -426.68507      3436.9359    
      2100   298.41865     -34436.418     -313.26517     -1249.2502      3436.9359    
      2200   286.64608     -34438.653     -6459.8255     -3115.2137      3436.9359    
      2300   281.00688     -34440.486     -13628.896      3341.2484      3436.9359    
      2400   294.24439     -34453.8       -4351.6473     -1191.125       3436.9359    
      2500   304.62675     -34446.414     -10849.783      2391.0962      3436.9359    
      2600   312.32374     -34439.003     -12925.692     -3097.4725      3436.9359    
      2700   315.38106     -34447.566     -7057.2142     -5075.3055      3436.9359    
      2800   304.63882     -34465.856      4365.2098      449.14513      3436.9359    
      2900   274.61474     -34453.794      3296.0465     -804.22714      3436.9359    
      3000   285.06786     -34453.225      8742.4286      7308.1169      3436.9359    
Loop time of 136.508 on 8 procs for 3000 steps with 310 atoms

Performance: 0.949 ns/day, 25.279 hours/ns, 21.977 timesteps/s, 6.813 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 101.76     | 109.7      | 114.82     |  39.3 | 80.36
Bond    | 0.0085793  | 0.0091438  | 0.0099324  |   0.5 |  0.01
Neigh   | 7.4838     | 8.1329     | 8.66       |  11.7 |  5.96
Comm    | 1.434      | 6.5888     | 14.497     | 160.2 |  4.83
Output  | 0.0013557  | 0.0015432  | 0.0025565  |   1.0 |  0.00
Modify  | 11.459     | 12.003     | 12.686     |  10.0 |  8.79
Other   |            | 0.07564    |            |       |  0.06

Nlocal:          38.75 ave          48 max          32 min
Histogram: 2 0 0 1 1 3 0 0 0 1
Nghost:        3097.12 ave        3146 max        3034 min
Histogram: 1 1 0 0 2 0 0 2 1 1
Neighs:        24474.5 ave       29833 max       20313 min
Histogram: 2 0 0 1 1 2 1 0 0 1

Total # of neighbors = 195796
Ave neighs/atom = 631.6
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 24.6047574609947
variable C2neg equal ${d2}
variable C2neg equal 28.2864331429624
variable C3neg equal ${d3}
variable C3neg equal 12.479978113758
variable C4neg equal ${d4}
variable C4neg equal -5.03562147265996
variable C5neg equal ${d5}
variable C5neg equal 9.80706695427648
variable C6neg equal ${d6}
variable C6neg equal 5.90485129689439

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.5034
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.175034 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.513434)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119 | 120.3 | 121.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   293.7744      -34348.361      12490.308      0              3436.9359    
       100   320.43503     -34360.884      5838.4503      6677.5029      3436.9359    
       200   294.63006     -34351.716     -9721.2789     -2468.5093      3436.9359    
       300   303.244       -34378.612     -1118.952      -1687.7403      3436.9359    
       400   318.99988     -34407.936     -11768.678      799.41485      3436.9359    
       500   285.94353     -34385.896     -1075.4626      5602.5191      3436.9359    
       600   270.12821     -34360.46       8583.5442      5013.4127      3436.9359    
       700   301.46635     -34367.686     -5119.3767      5207.2307      3436.9359    
       800   306.92787     -34360.802     -8420.25       -1551.2456      3436.9359    
       900   306.26233     -34378.331     -7056.2041      2963.2475      3436.9359    
      1000   314.85021     -34415.553      17426.083      1897.0219      3436.9359    
      1100   277.66686     -34394.627     -9181.9297      3411.2133      3436.9359    
      1200   287.27715     -34389.806      1554.359       4898.8745      3436.9359    
      1300   324.7021      -34408.555     -4329.9418      7131.0214      3436.9359    
      1400   290.5287      -34378.422     -19725.161     -1811.7832      3436.9359    
      1500   305.95954     -34400.073      4672.4204     -229.92574      3436.9359    
      1600   317.82825     -34423.726      6772.1343     -790.38898      3436.9359    
      1700   287.81921     -34407.936     -1101.5575      6168.7652      3436.9359    
      1800   284.43009     -34401.942      279.60522      1848.84        3436.9359    
      1900   291.46807     -34384.669     -5906.2173      2825.0531      3436.9359    
      2000   321.47415     -34396.159      9222.4207      738.63949      3436.9359    
      2100   301.95586     -34392.822     -2930.7494     -2282.95        3436.9359    
      2200   290.29242     -34408.492     -859.02289      3469.2951      3436.9359    
      2300   282.46331     -34402.232     -1810.9462      2992.5581      3436.9359    
      2400   319.50699     -34413.277      1500.7095      3889.4725      3436.9359    
      2500   293.75482     -34377.015      4110.7257      8066.0045      3436.9359    
      2600   310.877       -34397.55      -3841.93       -2149.9236      3436.9359    
      2700   304.16633     -34427.203     -9613.9442     -252.49129      3436.9359    
      2800   300.06743     -34431.6        3776.5175      524.60846      3436.9359    
      2900   289.30467     -34413.639     -1116.0198     -245.98343      3436.9359    
      3000   302.77737     -34408.145      3851.9759      7398.2243      3436.9359    
Loop time of 135.065 on 8 procs for 3000 steps with 310 atoms

Performance: 0.960 ns/day, 25.012 hours/ns, 22.211 timesteps/s, 6.886 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 107.41     | 110.77     | 113.38     |  17.8 | 82.02
Bond    | 0.0087632  | 0.0092017  | 0.0098673  |   0.4 |  0.01
Neigh   | 8.0697     | 8.3331     | 8.7854     |   8.3 |  6.17
Comm    | 1.5706     | 4.1672     | 7.5253     |  91.8 |  3.09
Output  | 0.0062097  | 0.007854   | 0.0093826  |   1.4 |  0.01
Modify  | 11.222     | 11.695     | 11.944     |   7.4 |  8.66
Other   |            | 0.07909    |            |       |  0.06

Nlocal:          38.75 ave          44 max          33 min
Histogram: 2 0 0 0 1 2 0 1 1 1
Nghost:        3117.62 ave        3149 max        3081 min
Histogram: 1 1 0 0 2 1 0 1 0 2
Neighs:        24528.6 ave       27705 max       20971 min
Histogram: 2 0 0 0 1 2 0 1 1 1

Total # of neighbors = 196229
Ave neighs/atom = 632.99677
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.1 | 120.3 | 121.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.77737     -34408.145      3851.9907      0              3436.9359    
       100   305.08275     -34412.609     -8284.1374     -1449.4347      3436.9359    
       200   292.59763     -34420.542      6636.9225      2361.1036      3436.9359    
       300   269.23793     -34420.886     -7154.9828      4207.3913      3436.9359    
       400   290.24541     -34425.118     -1160.6325      7042.7721      3436.9359    
       500   302.98668     -34418.984     -2955.5289      4750.0125      3436.9359    
       600   303.30236     -34413.029     -4840.9291      144.27486      3436.9359    
       700   304.84077     -34418.319     -13584.49      -6136.5944      3436.9359    
       800   291.31224     -34413.754     -11162.473     -2189.8058      3436.9359    
       900   274.33642     -34422.059     -3764.7975     -54.297575      3436.9359    
      1000   268.25802     -34429.332     -7295.4886      2792.4745      3436.9359    
      1100   298.95169     -34429.86      -5612.7183      3177.2362      3436.9359    
      1200   276.58906     -34393.982      7849.5007      3375.8971      3436.9359    
      1300   285.93095     -34389.097     -3897.2961     -3019.909       3436.9359    
      1400   312.17715     -34399.998     -7751.5589     -61.576516      3436.9359    
      1500   315.07798     -34395.926     -20764.23       450.45897      3436.9359    
      1600   309.22591     -34400.762      2508.4207      3998.1573      3436.9359    
      1700   282.2097      -34405.011      1058.5311     -881.52483      3436.9359    
      1800   290.0935      -34419.983     -8125.8654      683.07568      3436.9359    
      1900   293.99864     -34407.764     -5502.8225     -484.36144      3436.9359    
      2000   320.20008     -34407.869     -4860.473      -5704.8984      3436.9359    
      2100   300.35624     -34399.25      -11014.613      4434.5738      3436.9359    
      2200   294.38911     -34403.698     -48.089388      2364.0468      3436.9359    
      2300   307.17005     -34422.568     -718.21091      3525.0303      3436.9359    
      2400   284.06552     -34413.158     -10147.749     -1061.352       3436.9359    
      2500   290.16195     -34436.531      4083.9657      1104.4116      3436.9359    
      2600   274.96129     -34432.877     -12676.992      3152.8515      3436.9359    
      2700   287.4442      -34422.05      -8530.0182      366.48175      3436.9359    
      2800   319.32409     -34426.52      -12772.732      4742.7217      3436.9359    
      2900   311.70346     -34416.85      -15738.159      162.63807      3436.9359    
      3000   284.94427     -34405.808     -22119.14      -2239.6726      3436.9359    
Loop time of 135.449 on 8 procs for 3000 steps with 310 atoms

Performance: 0.957 ns/day, 25.083 hours/ns, 22.149 timesteps/s, 6.866 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 107.96     | 110.82     | 114.03     |  19.8 | 81.82
Bond    | 0.0089357  | 0.0093268  | 0.0099719  |   0.4 |  0.01
Neigh   | 8.0209     | 8.2744     | 8.77       |   8.3 |  6.11
Comm    | 1.2861     | 4.4979     | 7.3528     |  98.6 |  3.32
Output  | 0.0012838  | 0.0014813  | 0.0024588  |   1.0 |  0.00
Modify  | 11.26      | 11.768     | 12.046     |   7.3 |  8.69
Other   |            | 0.07916    |            |       |  0.06

Nlocal:          38.75 ave          45 max          36 min
Histogram: 2 1 2 1 0 1 0 0 0 1
Nghost:        3090.12 ave        3108 max        3064 min
Histogram: 2 0 0 0 0 2 0 1 0 3
Neighs:        24515.6 ave       28251 max       22814 min
Histogram: 2 1 2 1 0 1 0 0 0 1

Total # of neighbors = 196125
Ave neighs/atom = 632.66129
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 72.1382201720682
variable C2pos equal ${d2}
variable C2pos equal 74.0985009733042
variable C3pos equal ${d3}
variable C3pos equal 99.3504396711786
variable C4pos equal ${d4}
variable C4pos equal 4.59082674299734
variable C5pos equal ${d5}
variable C5pos equal -9.23279550358857
variable C6pos equal ${d6}
variable C6pos equal -11.9391868170746

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(24.6047574609947+${C1pos})
variable C14 equal 0.5*(24.6047574609947+72.1382201720682)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(28.2864331429624+${C2pos})
variable C24 equal 0.5*(28.2864331429624+74.0985009733042)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(12.479978113758+${C3pos})
variable C34 equal 0.5*(12.479978113758+99.3504396711786)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(-5.03562147265996+${C4pos})
variable C44 equal 0.5*(-5.03562147265996+4.59082674299734)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(9.80706695427648+${C5pos})
variable C54 equal 0.5*(9.80706695427648+-9.23279550358857)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(5.90485129689439+${C6pos})
variable C64 equal 0.5*(5.90485129689439+-11.9391868170746)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.5034
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.5034
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.175034 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -2.001134 0.3384)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.2 | 120.4 | 121.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   293.7744      -34350.028      15325.779      0              3436.9359    
       100   317.68278     -34358.944      11891.568      8095.6601      3436.9359    
       200   311.17023     -34365.977     -11724.909     -5466.5412      3436.9359    
       300   302.64712     -34382.91       5811.5918     -1970.9551      3436.9359    
       400   294.97552     -34390.975     -4464.4721     -767.34205      3436.9359    
       500   280.3628      -34382.937     -14513.47       3152.3501      3436.9359    
       600   289.07962     -34374.682     -14071.769      874.82473      3436.9359    
       700   317.96805     -34375.479     -15966.431      506.80827      3436.9359    
       800   308.59658     -34356.03      -8580.8117     -2290.3519      3436.9359    
       900   321.75181     -34375.178     -6061.304       687.73173      3436.9359    
      1000   301.70956     -34384.778      4196.5666      2751.0994      3436.9359    
      1100   292.92772     -34392.412      2794.4982     -204.97026      3436.9359    
      1200   302.24898     -34396.49      -8373.5235      1584.9671      3436.9359    
      1300   303.44888     -34385.575      2067.7535      2511.7658      3436.9359    
      1400   308.94459     -34389.822     -4960.8433     -5742.1785      3436.9359    
      1500   308.32005     -34396.134      6836.8487      7092.2541      3436.9359    
      1600   305.56737     -34393.64      -1266.0273      6242.9695      3436.9359    
      1700   295.76916     -34383.187     -7401.7071     -361.25         3436.9359    
      1800   304.5153      -34394.066     -5034.3246      4488.4851      3436.9359    
      1900   295.27005     -34400.025      1033.3942     -3326.6058      3436.9359    
      2000   288.58544     -34407.946     -4584.0598      1923.268       3436.9359    
      2100   311.87263     -34437.605      4240.0629      5582.0415      3436.9359    
      2200   290.37967     -34421.785     -6106.7707     -3940.0367      3436.9359    
      2300   293.5009      -34423.52       6024.8926     -3330.0847      3436.9359    
      2400   281.26238     -34404.597     -12551.386      1793.9863      3436.9359    
      2500   321.73757     -34419.359     -2789.143       3267.1733      3436.9359    
      2600   317.14602     -34414.17      -5183.7418      3251.3621      3436.9359    
      2700   290.95258     -34414.305      1815.6827      5385.2622      3436.9359    
      2800   293.37367     -34443.252     -14614.069      3266.9407      3436.9359    
      2900   274.08345     -34423.384     -12116.899     -2636.9846      3436.9359    
      3000   312.18848     -34436.595     -5877.7803      6814.4594      3436.9359    
Loop time of 134.826 on 8 procs for 3000 steps with 310 atoms

Performance: 0.961 ns/day, 24.968 hours/ns, 22.251 timesteps/s, 6.898 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 77.691     | 105.81     | 112.55     | 105.3 | 78.48
Bond    | 0.0087609  | 0.0091589  | 0.0097878  |   0.3 |  0.01
Neigh   | 5.9034     | 7.9369     | 8.7358     |  28.9 |  5.89
Comm    | 2.2186     | 8.9665     | 37.052     | 361.4 |  6.65
Output  | 0.0075587  | 0.0093531  | 0.010994   |   1.4 |  0.01
Modify  | 11.212     | 12.022     | 14.099     |  24.0 |  8.92
Other   |            | 0.07586    |            |       |  0.06

Nlocal:          38.75 ave          41 max          38 min
Histogram: 5 0 0 1 0 0 1 0 0 1
Nghost:        3081.12 ave        3117 max        3052 min
Histogram: 2 1 0 0 1 2 0 1 0 1
Neighs:        24506.2 ave       25781 max       23957 min
Histogram: 3 2 0 1 0 0 1 0 0 1

Total # of neighbors = 196050
Ave neighs/atom = 632.41935
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.2 | 120.4 | 121.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.18848     -34436.595     -5877.7355      0              3436.9359    
       100   305.22463     -34423.353      4693.7412      4205.4079      3436.9359    
       200   299.11704     -34394.689     -14135.148     -145.03178      3436.9359    
       300   330.85896     -34407.842      4621.3082      2524.8858      3436.9359    
       400   317.62036     -34416.887     -9325.8194      75.284904      3436.9359    
       500   302.24807     -34436.487      47.810337      4709.5745      3436.9359    
       600   288.68345     -34432.776     -8764.6356      8072.8882      3436.9359    
       700   303.95754     -34437.04       2278.5882      4248.3801      3436.9359    
       800   345.83106     -34459.211      9709.3479      9528.3289      3436.9359    
       900   285.91064     -34416.785     -86.320754      8945.2705      3436.9359    
      1000   293.29471     -34451.219     -11883.852      7055.597       3436.9359    
      1100   287.89584     -34453.961     -5498.2577      240.54074      3436.9359    
      1200   297.60789     -34447.932     -3631.9456      3162.9608      3436.9359    
      1300   301.78246     -34415.781     -9580.3103      3247.6369      3436.9359    
      1400   322.43273     -34438.641      6899.1215      3854.5823      3436.9359    
      1500   307.8031      -34445.489      1409.2073      1596.0795      3436.9359    
      1600   301.93915     -34456.328      2347.5832      4788.3241      3436.9359    
      1700   278.24575     -34447.95      -10105.265      5739.747       3436.9359    
      1800   314.19959     -34472.629     -3860.9209      11474.319      3436.9359    
      1900   304.14365     -34420.697      12362.472      3674.7942      3436.9359    
      2000   297.94334     -34402.671     -3811.8295      4168.6602      3436.9359    
      2100   311.06136     -34435.906      5408.827       6229.3509      3436.9359    
      2200   281.00807     -34435.973      4223.2072      4192.6178      3436.9359    
      2300   309.13284     -34461.03      -1644.7002      5954.844       3436.9359    
      2400   298.70768     -34432.848     -4819.4982      7715.5284      3436.9359    
      2500   306.02487     -34422.23       1002.5091      10383.893      3436.9359    
      2600   304.84692     -34436.893      8812.1534      2364.2845      3436.9359    
      2700   302.32997     -34466.914      6085.3753      238.92356      3436.9359    
      2800   292.98566     -34458.735      775.83991      6921.6673      3436.9359    
      2900   283.24924     -34433.435     -1050.3789      1486.8021      3436.9359    
      3000   313.39204     -34444.209     -7340.0065      476.20545      3436.9359    
Loop time of 135.8 on 8 procs for 3000 steps with 310 atoms

Performance: 0.954 ns/day, 25.148 hours/ns, 22.091 timesteps/s, 6.848 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 76.933     | 106.81     | 113.83     | 111.3 | 78.66
Bond    | 0.0086449  | 0.0091568  | 0.0098651  |   0.4 |  0.01
Neigh   | 5.8497     | 8.0186     | 8.7776     |  29.9 |  5.90
Comm    | 1.5798     | 8.6299     | 38.486     | 391.1 |  6.35
Output  | 0.0012355  | 0.0014839  | 0.0025572  |   1.1 |  0.00
Modify  | 11.481     | 12.252     | 14.46      |  24.6 |  9.02
Other   |            | 0.07543    |            |       |  0.06

Nlocal:          38.75 ave          41 max          37 min
Histogram: 1 0 3 0 0 2 0 1 0 1
Nghost:        3086.12 ave        3103 max        3058 min
Histogram: 1 0 0 0 2 0 1 0 3 1
Neighs:          24497 ave       25837 max       23346 min
Histogram: 1 0 1 2 2 0 0 0 1 1

Total # of neighbors = 195976
Ave neighs/atom = 632.18065
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -44.619585736754
variable C2neg equal ${d2}
variable C2neg equal 12.4082484501106
variable C3neg equal ${d3}
variable C3neg equal -96.7556850837514
variable C4neg equal ${d4}
variable C4neg equal -9.26998211689742
variable C5neg equal ${d5}
variable C5neg equal 25.4236847879785
variable C6neg equal ${d6}
variable C6neg equal 16.7166595316522

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.5034
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.175034 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.651066 0.3384)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119 | 120.3 | 121.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   293.7744      -34348.1        9633.7414      0              3436.9359    
       100   331.55513     -34371.238      3790.0936      7061.6336      3436.9359    
       200   293.28817     -34354.986     -21121.224     -1014.0029      3436.9359    
       300   312.48877     -34394.69      -4643.486      -341.61413      3436.9359    
       400   295.54312     -34390.313      4514.5603      5122.913       3436.9359    
       500   273.93714     -34377.403     -5038.5276      3709.3273      3436.9359    
       600   285.53839     -34376.417     -2974.3354      7471.5054      3436.9359    
       700   320.51629     -34393.335      5408.0225      2989.398       3436.9359    
       800   312.43273     -34374.455     -4161.8517     -3788.6011      3436.9359    
       900   317.6798      -34380.764     -9357.6016      818.33801      3436.9359    
      1000   302.04504     -34390.79      -8050.1814      1594.8271      3436.9359    
      1100   298.95197     -34406.09      -6644.6116      6484.4095      3436.9359    
      1200   288.63424     -34401.383      11785.206      8348.7135      3436.9359    
      1300   281.20013     -34388.949     -7404.3651      5975.8289      3436.9359    
      1400   300.05872     -34386.831     -7851.047      -1031.5255      3436.9359    
      1500   320.35047     -34388.84      -14050.087      616.57068      3436.9359    
      1600   314.2685      -34387.902      9026.5189      8088.5064      3436.9359    
      1700   306.02888     -34401.799      8200.8399      6709.207       3436.9359    
      1800   294.46709     -34404.942      11564.178      2913.8235      3436.9359    
      1900   292.82981     -34402.856      4343.6893      3721.1717      3436.9359    
      2000   303.23736     -34397.773      6945.3898      2646.4302      3436.9359    
      2100   308.37871     -34387.998      9951.0806      5445.1161      3436.9359    
      2200   316.7735      -34403.364     -3669.0184      6220.2718      3436.9359    
      2300   291.19999     -34405.256     -8566.3242      9507.5445      3436.9359    
      2400   273.3637      -34401.653     -1492.5798      7305.4662      3436.9359    
      2500   283.23244     -34404.923     -7297.184       2315.9888      3436.9359    
      2600   318.25082     -34408.717      10474.019      107.83712      3436.9359    
      2700   310.35345     -34391.665     -4388.0902      5307.0044      3436.9359    
      2800   320.29237     -34416.288     -7892.405       1741.0188      3436.9359    
      2900   283.49584     -34418.822      6176.7824      2777.1214      3436.9359    
      3000   290.67853     -34422.987     -3973.4029      2717.9874      3436.9359    
Loop time of 135.386 on 8 procs for 3000 steps with 310 atoms

Performance: 0.957 ns/day, 25.072 hours/ns, 22.159 timesteps/s, 6.869 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 77.901     | 106.67     | 113.31     | 107.2 | 78.79
Bond    | 0.0087161  | 0.0091394  | 0.0099289  |   0.4 |  0.01
Neigh   | 5.8369     | 8.0063     | 8.7528     |  30.1 |  5.91
Comm    | 1.8635     | 8.5142     | 37.253     | 379.2 |  6.29
Output  | 0.006621   | 0.0082099  | 0.0096561  |   1.3 |  0.01
Modify  | 11.347     | 12.106     | 14.315     |  24.9 |  8.94
Other   |            | 0.0761     |            |       |  0.06

Nlocal:          38.75 ave          51 max          35 min
Histogram: 3 3 1 0 0 0 0 0 0 1
Nghost:         3080.5 ave        3114 max        3043 min
Histogram: 1 1 0 0 1 2 0 2 0 1
Neighs:        24517.9 ave       31737 max       22212 min
Histogram: 3 2 2 0 0 0 0 0 0 1

Total # of neighbors = 196143
Ave neighs/atom = 632.71935
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119 | 120.3 | 121.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.67853     -34422.987     -3973.4042      0              3436.9359    
       100   307.95012     -34428.136      4787.3992      4511.3471      3436.9359    
       200   307.85126     -34400.616     -685.25049     -1125.5554      3436.9359    
       300   294.43511     -34370.685      8265.742       3881.6718      3436.9359    
       400   293.00262     -34372.419      5025.8238      4533.7697      3436.9359    
       500   330.25558     -34414.278     -4169.3446      3334.7677      3436.9359    
       600   305.07542     -34416.652      2135.5794      1226.3782      3436.9359    
       700   278.06215     -34402.396      893.72606      878.64351      3436.9359    
       800   296.719       -34415.751      5929.7931      6366.3169      3436.9359    
       900   321.08295     -34421.961     -18714.64       2657.2032      3436.9359    
      1000   314.02983     -34387.922     -14873.971      3572.7112      3436.9359    
      1100   333.44438     -34393.782     -1548.0522      1063.971       3436.9359    
      1200   288.22327     -34389.132     -4943.5891      5358.6577      3436.9359    
      1300   279.98523     -34398.512      434.4342       2189.6875      3436.9359    
      1400   303.68112     -34422.745     -2048.0552      569.41895      3436.9359    
      1500   299.99934     -34421.437     -3097.0169      6821.433       3436.9359    
      1600   298.74917     -34442.122     -4417.9314      4467.0172      3436.9359    
      1700   272.05764     -34441.366     -4966.446       154.26552      3436.9359    
      1800   291.93359     -34454.628     -18571.798      969.17497      3436.9359    
      1900   306.69396     -34449.546     -16015.045      1156.9942      3436.9359    
      2000   317.5585      -34434.812     -10911.49       91.826491      3436.9359    
      2100   316.53268     -34440.465     -364.93907     -2216.3389      3436.9359    
      2200   314.09018     -34452.971     -17531.081      4127.6173      3436.9359    
      2300   298.0964      -34453.322      7788.947       5638.9907      3436.9359    
      2400   293.12507     -34447.744      1354.8851      4639.4523      3436.9359    
      2500   302.46142     -34426.356      2930.3561     -2091.6704      3436.9359    
      2600   308.67531     -34417.618     -6877.6366      1746.6995      3436.9359    
      2700   332.72053     -34453.789     -2970.7142     -1536.4692      3436.9359    
      2800   283.34803     -34429.172     -8937.2797     -3919.6889      3436.9359    
      2900   316.54623     -34463.816     -4863.9621     -156.08926      3436.9359    
      3000   297.29067     -34459.236     -12158.473     -1517.757       3436.9359    
Loop time of 136.092 on 8 procs for 3000 steps with 310 atoms

Performance: 0.952 ns/day, 25.202 hours/ns, 22.044 timesteps/s, 6.834 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 102.77     | 109.05     | 114.1      |  40.6 | 80.13
Bond    | 0.0087879  | 0.0091719  | 0.0098734  |   0.4 |  0.01
Neigh   | 7.5033     | 8.1843     | 8.7486     |  14.5 |  6.01
Comm    | 1.6271     | 6.6995     | 12.962     | 164.1 |  4.92
Output  | 0.0013291  | 0.0015011  | 0.0025081  |   1.0 |  0.00
Modify  | 11.487     | 12.069     | 12.734     |  12.1 |  8.87
Other   |            | 0.07653    |            |       |  0.06

Nlocal:          38.75 ave          47 max          32 min
Histogram: 1 0 2 0 2 0 2 0 0 1
Nghost:        3064.12 ave        3112 max        3005 min
Histogram: 2 0 2 0 0 0 0 0 1 3
Neighs:        24489.6 ave       29328 max       20569 min
Histogram: 1 1 1 0 2 1 1 0 0 1

Total # of neighbors = 195917
Ave neighs/atom = 631.99032
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 64.8234107937008
variable C2pos equal ${d2}
variable C2pos equal 96.5532482355058
variable C3pos equal ${d3}
variable C3pos equal 68.7695121097825
variable C4pos equal ${d4}
variable C4pos equal 2.53755241248274
variable C5pos equal ${d5}
variable C5pos equal 3.49944219721973
variable C6pos equal ${d6}
variable C6pos equal 6.22916331510715

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-44.619585736754+${C1pos})
variable C15 equal 0.5*(-44.619585736754+64.8234107937008)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(12.4082484501106+${C2pos})
variable C25 equal 0.5*(12.4082484501106+96.5532482355058)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-96.7556850837514+${C3pos})
variable C35 equal 0.5*(-96.7556850837514+68.7695121097825)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-9.26998211689742+${C4pos})
variable C45 equal 0.5*(-9.26998211689742+2.53755241248274)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(25.4236847879785+${C5pos})
variable C55 equal 0.5*(25.4236847879785+3.49944219721973)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(16.7166595316522+${C6pos})
variable C65 equal 0.5*(16.7166595316522+6.22916331510715)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 12.7411

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.7411
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.127411 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.330111 -1.8261 0.3384)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.3 | 120.6 | 121.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   293.7744      -34348.957      14300.048      0              3436.9359    
       100   318.76784     -34358.212      5340.6773      7273.2804      3436.9359    
       200   306.38567     -34359.812     -23142.783     -1679.7808      3436.9359    
       300   289.82959     -34365.145      9279.099       1287.9479      3436.9359    
       400   285.39278     -34377.285     -4856.1328     -3638.6611      3436.9359    
       500   278.24672     -34379.989     -11178.338      517.44106      3436.9359    
       600   278.38337     -34372.16      -19779.964      2520.3038      3436.9359    
       700   298.25597     -34365.6       -1200.15        3260.1782      3436.9359    
       800   319.49044     -34368.354      5470.1325      800.18896      3436.9359    
       900   308.29477     -34366.386     -10530.007     -1127.766       3436.9359    
      1000   281.14347     -34361.471     -10410.82      -799.85183      3436.9359    
      1100   304.40009     -34398.403     -4638.6224      2663.434       3436.9359    
      1200   292.66693     -34397.403      10739.598     -105.99625      3436.9359    
      1300   284.69734     -34392.551      785.29621      2281.5119      3436.9359    
      1400   314.5664      -34406.338     -14336.763     -1024.6481      3436.9359    
      1500   299.71964     -34377.991      928.30398     -743.36962      3436.9359    
      1600   314.79398     -34389.483     -6986.9733     -308.12947      3436.9359    
      1700   310.33883     -34398.749     -2858.0434      2441.1856      3436.9359    
      1800   305.32047     -34422.186      937.36275      5545.7976      3436.9359    
      1900   293.18749     -34422.17      -4409.9459      4710.5273      3436.9359    
      2000   282.74849     -34391.751     -3635.346       1532.6613      3436.9359    
      2100   316.56109     -34393.897      3113.2564      48.616505      3436.9359    
      2200   340.26668     -34418.247     -8896.2744     -3680.8821      3436.9359    
      2300   304.60819     -34417.597     -10029.652     -2982.1485      3436.9359    
      2400   306.35697     -34438.387     -4548.4483     -4191.8558      3436.9359    
      2500   284.02205     -34425.822     -5179.2501     -2824.7215      3436.9359    
      2600   304.94791     -34426.942     -11184.122     -3262.5936      3436.9359    
      2700   320.12281     -34415.625     -4013.7036      544.62556      3436.9359    
      2800   325.87062     -34423.504     -332.74779      4975.4347      3436.9359    
      2900   281.16399     -34400.581      7752.6893      1583.7696      3436.9359    
      3000   292.66091     -34412.5       -1371.8893      1309.8469      3436.9359    
Loop time of 135.869 on 8 procs for 3000 steps with 310 atoms

Performance: 0.954 ns/day, 25.161 hours/ns, 22.080 timesteps/s, 6.845 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 76.673     | 106.82     | 114.34     | 112.5 | 78.62
Bond    | 0.0087814  | 0.0091929  | 0.0096357  |   0.3 |  0.01
Neigh   | 5.812      | 8.0698     | 8.7962     |  30.7 |  5.94
Comm    | 1.2725     | 8.813      | 38.99      | 392.0 |  6.49
Output  | 0.0063537  | 0.0079547  | 0.0095201  |   1.3 |  0.01
Modify  | 11.321     | 12.07      | 14.317     |  25.1 |  8.88
Other   |            | 0.07616    |            |       |  0.06

Nlocal:          38.75 ave          45 max          32 min
Histogram: 2 0 0 2 1 0 0 0 1 2
Nghost:        3105.38 ave        3149 max        3065 min
Histogram: 3 0 0 1 0 0 0 2 0 2
Neighs:        24480.4 ave       28433 max       20342 min
Histogram: 2 0 0 2 1 0 0 0 1 2

Total # of neighbors = 195843
Ave neighs/atom = 631.75161
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.2 | 120.6 | 121.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   292.66091     -34412.5       -1371.947       0              3436.9359    
       100   286.73665     -34404.612     -4749.28       -1156.5347      3436.9359    
       200   287.71021     -34417.269     -10518.426     -1077.768       3436.9359    
       300   305.21841     -34446.748      1828.1432      144.53489      3436.9359    
       400   296.604       -34430.412      85.753115      361.87917      3436.9359    
       500   309.92434     -34411.853     -853.19603      2896.8116      3436.9359    
       600   304.87072     -34402.246      7570.021       7475.738       3436.9359    
       700   303.45982     -34417.273     -11922.321     -4261.2081      3436.9359    
       800   286.35474     -34420.138      9695.8929      490.94263      3436.9359    
       900   286.9976      -34416.637      616.31769      2060.1999      3436.9359    
      1000   307.32021     -34424.287     -655.76675     -4069.4082      3436.9359    
      1100   299.88151     -34408.504     -12514.898      2101.8764      3436.9359    
      1200   297.53568     -34394.46      -2544.4817     -3102.5331      3436.9359    
      1300   314.62476     -34396.911     -5992.9947     -131.52312      3436.9359    
      1400   310.22417     -34396.409     -5959.576       4417.3484      3436.9359    
      1500   295.29377     -34415.012      94.003382      4730.3144      3436.9359    
      1600   314.44108     -34448.308      2700.6593      390.35013      3436.9359    
      1700   286.81574     -34425.979     -1939.1922      5193.7164      3436.9359    
      1800   322.5003      -34437.404     -2906.5556      4022.4784      3436.9359    
      1900   313.34025     -34402.715     -11003.88      -1537.7806      3436.9359    
      2000   328.3178      -34413.793     -5274.077       3493.4047      3436.9359    
      2100   302.17462     -34402.341     -9589.974       1858.0973      3436.9359    
      2200   297.93144     -34415.065      2005.1471      6529.5586      3436.9359    
      2300   295.67903     -34419.535     -6984.0266      4909.3204      3436.9359    
      2400   289.00934     -34409.442     -1350.3778      5629.4056      3436.9359    
      2500   314.61544     -34418.579     -4940.4499      4157.5109      3436.9359    
      2600   325.94744     -34396.3        3358.3763      6111.1341      3436.9359    
      2700   327.09944     -34399.977     -1851.4595      2392.1805      3436.9359    
      2800   326.97101     -34428.852     -6977.1782      7753.2182      3436.9359    
      2900   313.06405     -34432.305      6165.043       3170.7873      3436.9359    
      3000   303.75742     -34441.496      3657.2697      4016.292       3436.9359    
Loop time of 136.505 on 8 procs for 3000 steps with 310 atoms

Performance: 0.949 ns/day, 25.279 hours/ns, 21.977 timesteps/s, 6.813 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 77.783     | 104.98     | 114.86     | 114.4 | 76.91
Bond    | 0.0086348  | 0.0091094  | 0.0094405  |   0.3 |  0.01
Neigh   | 5.8046     | 7.9547     | 8.8639     |  33.3 |  5.83
Comm    | 1.2669     | 11.182     | 38.407     | 350.6 |  8.19
Output  | 0.0013083  | 0.0016003  | 0.0033293  |   1.6 |  0.00
Modify  | 11.367     | 12.303     | 14.44      |  26.9 |  9.01
Other   |            | 0.07455    |            |       |  0.05

Nlocal:          38.75 ave          42 max          34 min
Histogram: 1 0 1 0 0 2 0 2 0 2
Nghost:        3099.75 ave        3126 max        3062 min
Histogram: 1 0 0 2 0 0 0 4 0 1
Neighs:        24508.2 ave       26666 max       21811 min
Histogram: 1 0 1 0 2 0 1 1 0 2

Total # of neighbors = 196066
Ave neighs/atom = 632.47097
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -8.7496588770378
variable C2neg equal ${d2}
variable C2neg equal -11.1621243071353
variable C3neg equal ${d3}
variable C3neg equal -35.570611828069
variable C4neg equal ${d4}
variable C4neg equal 1.98786203157014
variable C5neg equal ${d5}
variable C5neg equal -0.502064837890138
variable C6neg equal ${d6}
variable C6neg equal 4.77601954750154

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.7411
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.127411 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.075289 -1.8261 0.3384)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 118.5 | 119.8 | 120.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   293.7744      -34350.153      10393.165      0              3436.9359    
       100   322.60256     -34364.931      13077.322      9659.2983      3436.9359    
       200   298.49435     -34359.495     -19364.474     -5532.7796      3436.9359    
       300   299.84944     -34383.366      9323.2996      3221.4251      3436.9359    
       400   310.42995     -34407.632      9535.7314      568.39029      3436.9359    
       500   297.92095     -34403.21      -13781.957      5873.0115      3436.9359    
       600   269.2621      -34361.659      6515.8653      6192.5988      3436.9359    
       700   304.33559     -34369.08      -1590.9931      3719.9905      3436.9359    
       800   294.69179     -34348.582      1621.1817     -1085.324       3436.9359    
       900   317.23832     -34379.287     -4384.8705     -284.81567      3436.9359    
      1000   312.01957     -34401.988      842.23127     -1049.9909      3436.9359    
      1100   286.42736     -34401.776     -9920.92        1021.6221      3436.9359    
      1200   297.112       -34409.279      10117.817      7802.3388      3436.9359    
      1300   302.72261     -34393.501     -6170.6042      6457.0181      3436.9359    
      1400   305.95143     -34376.846     -98.349799      1862.5498      3436.9359    
      1500   312.55751     -34387.001     -5042.0084     -3105.6098      3436.9359    
      1600   300.19078     -34389.333     -1236.4543      2683.9287      3436.9359    
      1700   292.7285      -34397.019      3605.1094      8609.5025      3436.9359    
      1800   294.16779     -34403.083     -4841.9511      10430.398      3436.9359    
      1900   296.37092     -34393.09      -12724.146      432.06929      3436.9359    
      2000   315.01021     -34391.008      11076.1       -1998.5871      3436.9359    
      2100   292.281       -34367.257     -12897.963      8791.8825      3436.9359    
      2200   300.0009      -34384.645     -2950.3865      855.36192      3436.9359    
      2300   292.59799     -34397.665     -17316.926     -3017.4862      3436.9359    
      2400   289.11645     -34397.584     -4135.6791      1326.1907      3436.9359    
      2500   305.55561     -34386.859     -3095.2731      1575.5213      3436.9359    
      2600   312.54423     -34379.284     -6994.9019      1725.5794      3436.9359    
      2700   310.30086     -34383.674      526.80555     -1058.4352      3436.9359    
      2800   305.60541     -34391.887     -18266.255     -4757.5478      3436.9359    
      2900   292.70166     -34386.525     -193.58028     -2092.602       3436.9359    
      3000   311.96618     -34409.186     -3707.3308      2439.8592      3436.9359    
Loop time of 135.115 on 8 procs for 3000 steps with 310 atoms

Performance: 0.959 ns/day, 25.021 hours/ns, 22.203 timesteps/s, 6.883 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 75.552     | 106.11     | 113.97     | 114.5 | 78.53
Bond    | 0.0085737  | 0.0091464  | 0.0096198  |   0.3 |  0.01
Neigh   | 5.7083     | 7.968      | 8.6096     |  30.7 |  5.90
Comm    | 1.2328     | 9.118      | 39.702     | 391.0 |  6.75
Output  | 0.0066913  | 0.0082664  | 0.0097445  |   1.3 |  0.01
Modify  | 11.164     | 11.826     | 14.077     |  25.2 |  8.75
Other   |            | 0.07576    |            |       |  0.06

Nlocal:          38.75 ave          47 max          32 min
Histogram: 1 0 2 0 1 2 1 0 0 1
Nghost:        3079.62 ave        3105 max        3044 min
Histogram: 1 1 0 0 0 2 0 2 1 1
Neighs:        24523.6 ave       29440 max       20448 min
Histogram: 1 0 2 0 1 2 1 0 0 1

Total # of neighbors = 196189
Ave neighs/atom = 632.86774
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 118.5 | 119.8 | 120.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.96618     -34409.186     -3707.3221      0              3436.9359    
       100   294.34823     -34386.262     -6434.0523      1843.1454      3436.9359    
       200   337.63732     -34398.843     -2147.1696      2550.3589      3436.9359    
       300   317.76221     -34366.271     -1889.5717     -1585.3776      3436.9359    
       400   295.57657     -34379.242     -7281.8449      3103.1123      3436.9359    
       500   308.80773     -34407.761      608.76062      6735.5106      3436.9359    
       600   288.30358     -34387.81      -6306.3754     -460.7648       3436.9359    
       700   269.69588     -34361.722      6005.0303      1868.1632      3436.9359    
       800   305.78874     -34375.126     -18738.915      1976.0099      3436.9359    
       900   310.72582     -34376.145     -5669.4586      822.89828      3436.9359    
      1000   288.1392      -34382.336      708.59326      2807.912       3436.9359    
      1100   284.13468     -34400.446     -8998.347      -1076.1754      3436.9359    
      1200   271.95104     -34389.894     -1612.3737      286.58901      3436.9359    
      1300   299.59071     -34397.867     -1057.0273     -1360.1854      3436.9359    
      1400   319.67923     -34387.958      12646.304      6152.7319      3436.9359    
      1500   331.92093     -34401.543     -160.56695      7593.9663      3436.9359    
      1600   287.50577     -34377.188     -3011.6232     -1433.9653      3436.9359    
      1700   296.08366     -34402.229     -3623.2991      4504.9693      3436.9359    
      1800   304.58864     -34419.033     -14338.924      924.1548       3436.9359    
      1900   291.55413     -34411.271     -2399.6159      247.43886      3436.9359    
      2000   298.28253     -34397.999     -6160.3757      4954.0703      3436.9359    
      2100   319.57975     -34392.05      -314.47907      494.52064      3436.9359    
      2200   304.30059     -34378.014      5052.6689      2096.1514      3436.9359    
      2300   295.4355      -34397.233      2377.7571      734.3252       3436.9359    
      2400   284.31336     -34397.914     -5591.9725      275.3906       3436.9359    
      2500   301.93296     -34415.338     -4996.4428     -1702.2669      3436.9359    
      2600   294.45821     -34407.457     -18983.03      -2119.959       3436.9359    
      2700   302.81636     -34388.255     -1386.196       4053.2853      3436.9359    
      2800   313.01885     -34374.454      7415.5893     -4577.0372      3436.9359    
      2900   310.51666     -34389.643     -10394.436     -3301.6526      3436.9359    
      3000   312.66588     -34413.79       12670.839      3306.6963      3436.9359    
Loop time of 135.443 on 8 procs for 3000 steps with 310 atoms

Performance: 0.957 ns/day, 25.082 hours/ns, 22.150 timesteps/s, 6.866 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 75.852     | 106.37     | 113.9      | 114.3 | 78.53
Bond    | 0.0088664  | 0.0093185  | 0.0098065  |   0.3 |  0.01
Neigh   | 5.6811     | 7.9503     | 8.6111     |  30.9 |  5.87
Comm    | 1.5518     | 9.1076     | 39.645     | 391.1 |  6.72
Output  | 0.0013315  | 0.0015267  | 0.0024357  |   0.9 |  0.00
Modify  | 11.255     | 11.933     | 14.193     |  25.2 |  8.81
Other   |            | 0.07619    |            |       |  0.06

Nlocal:          38.75 ave          44 max          32 min
Histogram: 1 0 0 2 0 2 1 0 0 2
Nghost:           3091 ave        3136 max        3037 min
Histogram: 1 2 1 0 0 0 0 0 1 3
Neighs:        24492.4 ave       27920 max       20304 min
Histogram: 1 0 0 2 0 2 1 0 0 2

Total # of neighbors = 195939
Ave neighs/atom = 632.06129
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 15.939636730154
variable C2pos equal ${d2}
variable C2pos equal 75.6785373947929
variable C3pos equal ${d3}
variable C3pos equal 106.372066239228
variable C4pos equal ${d4}
variable C4pos equal 26.0963928350682
variable C5pos equal ${d5}
variable C5pos equal -10.454279566338
variable C6pos equal ${d6}
variable C6pos equal -1.27611250697766

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-8.7496588770378+${C1pos})
variable C16 equal 0.5*(-8.7496588770378+15.939636730154)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-11.1621243071353+${C2pos})
variable C26 equal 0.5*(-11.1621243071353+75.6785373947929)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-35.570611828069+${C3pos})
variable C36 equal 0.5*(-35.570611828069+106.372066239228)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(1.98786203157014+${C4pos})
variable C46 equal 0.5*(1.98786203157014+26.0963928350682)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(-0.502064837890138+${C5pos})
variable C56 equal 0.5*(-0.502064837890138+-10.454279566338)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(4.77601954750154+${C6pos})
variable C66 equal 0.5*(4.77601954750154+-1.27611250697766)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 38.1249661597989
variable C22all equal ${C22}
variable C22all equal 20.0862141027331
variable C33all equal ${C33}
variable C33all equal 16.2466193663963

variable C44all equal ${C44}
variable C44all equal -0.22239736483131
variable C55all equal ${C55}
variable C55all equal 14.4615634925991
variable C66all equal ${C66}
variable C66all equal 1.74995352026194

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(21.4960338287836+${C21})
variable C12all equal 0.5*(21.4960338287836+6.0721199375235)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(-33.0800725535457+${C31})
variable C13all equal 0.5*(-33.0800725535457+8.56289689260451)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(-14.0183666784422+${C32})
variable C23all equal 0.5*(-14.0183666784422+19.0743352018517)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(48.3714888165315+${C41})
variable C14all equal 0.5*(48.3714888165315+2.7175177469645)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(10.1019125284734+${C51})
variable C15all equal 0.5*(10.1019125284734+-0.0548144975064)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(3.5949889265581+${C61})
variable C16all equal 0.5*(3.5949889265581+-3.2799641240045)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(51.1924670581333+${C42})
variable C24all equal 0.5*(51.1924670581333+-14.6997390382303)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(54.4807483428082+${C52})
variable C25all equal 0.5*(54.4807483428082+-10.4699486329379)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(32.2582065438288+${C62})
variable C26all equal 0.5*(32.2582065438288+-11.2517543395953)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(55.9152088924683+${C43})
variable C34all equal 0.5*(55.9152088924683+4.24244984546008)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-13.9930864869845+${C53})
variable C35all equal 0.5*(-13.9930864869845+14.4235839378557)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(35.4007272055795+${C63})
variable C36all equal 0.5*(35.4007272055795+1.10303973553419)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-3.36621485220734+${C54})
variable C45all equal 0.5*(-3.36621485220734+0.287135725343956)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(14.0421274333192+${C64})
variable C46all equal 0.5*(14.0421274333192+-3.0171677600901)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-5.47817220211407+${C65})
variable C56all equal 0.5*(-5.47817220211407+11.4729114233797)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:56:32
