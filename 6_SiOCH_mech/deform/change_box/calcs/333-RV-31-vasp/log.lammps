LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-RV-31-vasp
read_data       ${structure}.data
read_data       333-RV-31-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.007 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.865 | 6.865 | 6.865 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              276.32109      3675.1532    
         1   300            0              0              276.32109      3675.1532    
Loop time of 5.16729e-05 on 16 procs for 1 steps with 310 atoms

52.3% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.41e-07   | 2.0762e-07 | 3.24e-07   |   0.0 |  0.40
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 9.1e-07    | 1.2801e-06 | 1.658e-06  |   0.0 |  2.48
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 5.019e-05  |            |       | 97.12

Nlocal:          38.75 ave          46 max          34 min
Histogram: 1 2 0 1 2 0 1 0 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = 22.14 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.2 | 122.9 | 123.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -32388.564      119735.25      0              1.4204665      3436.9359    
       100   849.29137     -33390.337     -46164.523     -1641.9369      1.4204665      3436.9359    
       200   534.23252     -33580.891     -25959.083     -3368.8097      1.4204665      3436.9359    
       300   474.31138     -33877.223     -15143.897     -1712.6738      1.4204665      3436.9359    
       400   387.98543     -34033.954      5895.7849      2168.9567      1.4204665      3436.9359    
       500   344.31803     -34150.585     -17677.916     -2229.2829      1.4204665      3436.9359    
       600   286.88949     -34202.34      -2547.3575      178.1383       1.4204665      3436.9359    
       700   267.13209     -34237.77      -12018.017      1572.7442      1.4204665      3436.9359    
       800   283.19755     -34262.031     -5861.2384      1339.4537      1.4204665      3436.9359    
       900   308.65961     -34252.187      973.94073     -3709.9012      1.4204665      3436.9359    
      1000   341.83722     -34245.925     -2095.7246     -5109.5969      1.4204665      3436.9359    
      1100   322.44439     -34235.418     -6835.3503     -3228.0449      1.4204665      3436.9359    
      1200   298.6585      -34258.281     -126.00827     -4780.2849      1.4204665      3436.9359    
      1300   280.38733     -34281.188     -13533.118     -1106.3554      1.4204665      3436.9359    
      1400   288.12292     -34310.928      296.09457     -6263.8731      1.4204665      3436.9359    
      1500   294.99755     -34316.417     -301.49391     -8179.596       1.4204665      3436.9359    
      1600   303.67883     -34302.143      5360.478      -3123.6787      1.4204665      3436.9359    
      1700   317.61355     -34296.849     -628.85659     -485.2133       1.4204665      3436.9359    
      1800   293.87469     -34284.091     -3309.8174     -1310.2419      1.4204665      3436.9359    
      1900   299.87906     -34321.508      6200.421      -5126.2316      1.4204665      3436.9359    
      2000   296.29629     -34351.229      9518.1815     -4519.6134      1.4204665      3436.9359    
Loop time of 90.2718 on 16 procs for 2000 steps with 310 atoms

Performance: 0.957 ns/day, 25.076 hours/ns, 22.155 timesteps/s, 6.868 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 64.295     | 67.353     | 69.146     |  18.4 | 74.61
Bond    | 0.00070613 | 0.00081513 | 0.00098183 |   0.0 |  0.00
Neigh   | 5.0851     | 5.217      | 5.3005     |   2.6 |  5.78
Comm    | 6.9592     | 8.7225     | 11.817     |  51.9 |  9.66
Output  | 0.001129   | 0.0013925  | 0.0029572  |   1.6 |  0.00
Modify  | 8.4607     | 8.6001     | 8.8006     |   3.6 |  9.53
Other   |            | 0.3773     |            |       |  0.42

Nlocal:          38.75 ave          45 max          33 min
Histogram: 1 2 0 0 1 0 2 1 0 1
Nghost:        3146.12 ave        3190 max        3094 min
Histogram: 1 0 1 1 0 1 1 2 0 1
Neighs:        24493.2 ave       28123 max       21225 min
Histogram: 1 2 0 0 1 0 2 1 0 1

Total # of neighbors = 195946
Ave neighs/atom = 632.08387
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-RV-31-vasp_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.4114
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 12.7411
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.5034

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--4519.61343017142)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--4519.61343017142)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--2006.7511540296)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--2006.7511540296)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-2606.54040756167)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-2606.54040756167)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--2163.13567813083)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--2163.13567813083)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-2941.40719733321)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-2941.40719733321)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--1695.7911983048)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--1695.7911983048)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 15.4114
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.4114
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.154114 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.154114 xy delta 0.072027 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.154114 xy delta 0.072027 xz delta 0.018261 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.257286 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.257286 12.7411 17.5034) with tilt (-7.130673 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.257286 12.7411 17.5034) with tilt (-7.130673 -1.807839 0.3384)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122 | 124.1 | 125.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.29629     -34329.24       83286.728      0              3402.5666    
       100   275.7581      -34329.093      83.816548     -2604.9472      3402.5666    
       200   291.3173      -34335.532     -1748.2046     -4956.2236      3402.5666    
       300   323.88888     -34339.572     -13121.797     -3671.4782      3402.5666    
       400   307.41286     -34311.025     -2125.3605      9.2285377      3402.5666    
       500   304.10614     -34310.006      794.24973     -270.44403      3402.5666    
       600   307.22275     -34330.014     -9728.515      -1182.9559      3402.5666    
       700   292.9492      -34333.895      2872.9648      513.50304      3402.5666    
       800   300.13968     -34344.769     -8370.1028      1336.3459      3402.5666    
       900   299.76362     -34334.69       11155.324     -2263.9044      3402.5666    
      1000   297.09092     -34330.453      7295.5459      1859.6538      3402.5666    
      1100   301.71112     -34341.174      5249.8297     -4610.9408      3402.5666    
      1200   278.74811     -34330.921      911.69191      377.41537      3402.5666    
      1300   301.09788     -34365.332      4019.2583     -2979.0579      3402.5666    
      1400   299.92756     -34374.244      11536.628      9657.7518      3402.5666    
      1500   297.73012     -34364.542      3202.8438      2799.9         3402.5666    
      1600   295.27246     -34359.024     -9704.0701      687.88609      3402.5666    
      1700   312.44999     -34380.865     -7892.3312      3082.7433      3402.5666    
      1800   311.22335     -34392.104      4781.4694     -645.59859      3402.5666    
      1900   284.72579     -34369.5       -4117.5797      28.13917       3402.5666    
      2000   301.46473     -34366.714      2593.0144      5409.8998      3402.5666    
Loop time of 93.9102 on 16 procs for 2000 steps with 310 atoms

Performance: 0.920 ns/day, 26.086 hours/ns, 21.297 timesteps/s, 6.602 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 69.19      | 71.42      | 74.565     |  19.9 | 76.05
Bond    | 0.00069375 | 0.00083346 | 0.0010061  |   0.0 |  0.00
Neigh   | 5.214      | 5.3711     | 5.5018     |   4.5 |  5.72
Comm    | 5.0319     | 8.1958     | 10.466     |  59.2 |  8.73
Output  | 0.0063219  | 0.011125   | 0.01443    |   3.5 |  0.01
Modify  | 8.4121     | 8.5575     | 8.7832     |   4.4 |  9.11
Other   |            | 0.3534     |            |       |  0.38

Nlocal:          38.75 ave          45 max          36 min
Histogram: 2 3 0 0 0 2 0 0 0 1
Nghost:        3157.25 ave        3193 max        3108 min
Histogram: 1 0 1 2 0 0 0 0 1 3
Neighs:        24730.4 ave       28315 max       23021 min
Histogram: 2 3 0 0 0 2 0 0 0 1

Total # of neighbors = 197843
Ave neighs/atom = 638.20323
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.1 | 124.1 | 125.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   301.46473     -34366.714      2593.0398      0              3402.5666    
       100   320.16627     -34390.845      3937.5477      1589.8431      3402.5666    
       200   279.74233     -34381.003      14.753669      2702.0438      3402.5666    
       300   278.59791     -34392.873      5358.5075     -3123.6271      3402.5666    
       400   301.0353      -34383.675     -8428.6526      1350.7         3402.5666    
       500   312.40105     -34371.235     -5038.378       1097.8377      3402.5666    
       600   334.27515     -34395.981      7833.206      -737.68002      3402.5666    
       700   299.76524     -34385.852     -4592.3991     -720.21367      3402.5666    
       800   284.88472     -34388.193     -28274.289     -3719.1882      3402.5666    
       900   309.33516     -34409.901      7773.6665     -1736.5625      3402.5666    
      1000   284.3385      -34398.252      2025.9283      2195.2389      3402.5666    
      1100   287.2396      -34422.756      1342.4816     -1385.3121      3402.5666    
      1200   280.40074     -34414.832     -479.55434      848.53384      3402.5666    
      1300   312.7877      -34412.302     -16314.438     -2279.3639      3402.5666    
      1400   307.10085     -34393.82       5321.3348      802.51996      3402.5666    
      1500   308.74283     -34394.729      8366.11        2641.35        3402.5666    
      1600   297.14938     -34396.931     -6337.4634     -1419.3791      3402.5666    
      1700   283.18004     -34408.045     -8806.6887     -3200.241       3402.5666    
      1800   283.04129     -34414.103     -8931.6396     -5307.586       3402.5666    
      1900   305.32046     -34406.648     -15777.32      -4552.6773      3402.5666    
      2000   310.2667      -34395.693      10007.914     -3360.3551      3402.5666    
Loop time of 93.0875 on 16 procs for 2000 steps with 310 atoms

Performance: 0.928 ns/day, 25.858 hours/ns, 21.485 timesteps/s, 6.660 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 69.192     | 70.682     | 72.918     |  13.4 | 75.93
Bond    | 0.00068763 | 0.00084054 | 0.00098512 |   0.0 |  0.00
Neigh   | 5.2302     | 5.3331     | 5.5259     |   3.7 |  5.73
Comm    | 5.9437     | 8.1928     | 9.6326     |  39.6 |  8.80
Output  | 0.00095501 | 0.0011862  | 0.0025887  |   1.5 |  0.00
Modify  | 8.2734     | 8.5058     | 8.64       |   4.1 |  9.14
Other   |            | 0.3716     |            |       |  0.40

Nlocal:          38.75 ave          46 max          35 min
Histogram: 2 1 1 2 1 0 0 0 0 1
Nghost:        3137.88 ave        3200 max        3073 min
Histogram: 1 1 0 1 1 1 1 1 0 1
Neighs:        24742.8 ave       29012 max       22599 min
Histogram: 2 1 1 2 1 0 0 0 0 1

Total # of neighbors = 197942
Ave neighs/atom = 638.52258
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 11.7461848862114
variable C2neg equal ${d2}
variable C2neg equal -97.6477594077562
variable C3neg equal ${d3}
variable C3neg equal -53.1242844737114
variable C4neg equal ${d4}
variable C4neg equal -9.74144244951826
variable C5neg equal ${d5}
variable C5neg equal -4.23964936196494
variable C6neg equal ${d6}
variable C6neg equal 16.1298220822785

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.4114
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.154114 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.154114 xy delta -0.072027 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.154114 xy delta -0.072027 xz delta -0.018261 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.565514 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.565514 12.7411 17.5034) with tilt (-7.274727 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.565514 12.7411 17.5034) with tilt (-7.274727 -1.844361 0.3384)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121 | 122.9 | 124.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.29629     -34333.127     -36763.701      0              3471.3053    
       100   275.21877     -34328.019     -6959.7839     -9928.1018      3471.3053    
       200   285.46203     -34319.313      16508.829     -4737.5729      3471.3053    
       300   316.13968     -34317.056     -2980.5107     -2077.6728      3471.3053    
       400   303.70791     -34291.225      8707.7426     -4058.2548      3471.3053    
       500   321.31853     -34321.371     -6360.6732     -776.1648       3471.3053    
       600   296.88914     -34326.233     -10460.843     -6582.3144      3471.3053    
       700   293.53855     -34335.19      -6899.1152     -2814.2316      3471.3053    
       800   306.00697     -34344.739      5721.5343     -550.08877      3471.3053    
       900   285.00112     -34321.567     -235.97755      222.96109      3471.3053    
      1000   298.07104     -34328.667     -377.69975     -8766.0621      3471.3053    
      1100   287.11779     -34305.113     -6770.5997      1273.7533      3471.3053    
      1200   311.4117      -34323.831     -7574.6685      1758.5172      3471.3053    
      1300   307.32997     -34342.372     -15364.51      -3703.5005      3471.3053    
      1400   276.61454     -34346.199     -5010.4699     -8510.378       3471.3053    
      1500   288.92869     -34366.718     -1733.1714     -7306.8167      3471.3053    
      1600   309.87773     -34373.116     -11269.822     -5093.195       3471.3053    
      1700   318.5977      -34357.202     -11435.058     -3563.0221      3471.3053    
      1800   306.94413     -34333.777     -5574.7225     -4238.2352      3471.3053    
      1900   295.34116     -34338.473      3308.3146     -9833.5717      3471.3053    
      2000   306.45602     -34369.517     -7565.5463     -8236.0745      3471.3053    
Loop time of 91.6443 on 16 procs for 2000 steps with 310 atoms

Performance: 0.943 ns/day, 25.457 hours/ns, 21.824 timesteps/s, 6.765 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 65.714     | 68.787     | 71.738     |  20.1 | 75.06
Bond    | 0.00069107 | 0.00081314 | 0.0010097  |   0.0 |  0.00
Neigh   | 5.0623     | 5.2453     | 5.3845     |   4.0 |  5.72
Comm    | 5.8314     | 8.7553     | 11.861     |  56.4 |  9.55
Output  | 0.0057703  | 0.0085411  | 0.010634   |   2.3 |  0.01
Modify  | 8.3031     | 8.4621     | 8.7246     |   4.4 |  9.23
Other   |            | 0.3857     |            |       |  0.42

Nlocal:          38.75 ave          46 max          31 min
Histogram: 1 0 0 3 0 1 1 0 0 2
Nghost:        3123.62 ave        3163 max        3087 min
Histogram: 2 0 0 1 1 1 0 2 0 1
Neighs:        24258.1 ave       28531 max       19701 min
Histogram: 1 0 0 3 0 1 1 0 0 2

Total # of neighbors = 194065
Ave neighs/atom = 626.01613
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121 | 122.9 | 124.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   306.45602     -34369.517     -7565.5565      0              3471.3053    
       100   290.35609     -34356.788     -13372.762     -8962.3177      3471.3053    
       200   296.67801     -34361.009      3218.7445      3300.6261      3471.3053    
       300   303.12428     -34355.601      10027.101     -3186.1381      3471.3053    
       400   312.31155     -34357.062     -2183.393      -11105.316      3471.3053    
       500   295.65129     -34362.547      3359.7809     -9966.2668      3471.3053    
       600   309.237       -34390.464     -9531.0675     -2085.9299      3471.3053    
       700   297.81176     -34384.609     -2521.3762     -6339.6982      3471.3053    
       800   294.45312     -34380.78      -4635.5324     -12413.318      3471.3053    
       900   287.06315     -34361.868      3019.8027     -3650.5574      3471.3053    
      1000   308.18422     -34364.109     -7905.8145     -4133.4813      3471.3053    
      1100   317.75293     -34385.579     -15296.409      234.28549      3471.3053    
      1200   281.05219     -34379.813     -15425.149     -10804.15       3471.3053    
      1300   298.57707     -34398.845     -18802.082     -9705.8085      3471.3053    
      1400   307.28921     -34403.876     -9129.4009     -8402.0149      3471.3053    
      1500   302.22898     -34389.71       12376.404     -7454.5222      3471.3053    
      1600   327.30321     -34386.508     -14286.25      -5065.6354      3471.3053    
      1700   334.45075     -34397.701     -3821.332      -10038.871      3471.3053    
      1800   309.98182     -34407.402     -2070.3329     -1710.7788      3471.3053    
      1900   303.3467      -34406.367      2756.5321      747.99176      3471.3053    
      2000   301.25898     -34409.2       -12650.742     -8249.2886      3471.3053    
Loop time of 91.591 on 16 procs for 2000 steps with 310 atoms

Performance: 0.943 ns/day, 25.442 hours/ns, 21.836 timesteps/s, 6.769 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 64.984     | 68.772     | 71.135     |  22.8 | 75.09
Bond    | 0.00069668 | 0.00081457 | 0.0010165  |   0.0 |  0.00
Neigh   | 5.1123     | 5.2845     | 5.3966     |   3.6 |  5.77
Comm    | 6.2944     | 8.725      | 12.563     |  64.7 |  9.53
Output  | 0.00089298 | 0.0011599  | 0.0028737  |   1.9 |  0.00
Modify  | 8.2069     | 8.3836     | 8.5673     |   3.8 |  9.15
Other   |            | 0.4243     |            |       |  0.46

Nlocal:          38.75 ave          47 max          29 min
Histogram: 1 0 1 2 0 0 1 1 1 1
Nghost:        3085.62 ave        3135 max        3040 min
Histogram: 2 1 0 1 0 0 1 0 2 1
Neighs:        24207.1 ave       28886 max       18455 min
Histogram: 1 0 1 1 1 0 1 1 0 2

Total # of neighbors = 193657
Ave neighs/atom = 624.7
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 37.7909340490834
variable C2pos equal ${d2}
variable C2pos equal 38.4565675633483
variable C3pos equal ${d3}
variable C3pos equal 34.9451144160547
variable C4pos equal ${d4}
variable C4pos equal 9.76276210490952
variable C5pos equal ${d5}
variable C5pos equal 7.94326382489226
variable C6pos equal ${d6}
variable C6pos equal -31.2084427762295

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(11.7461848862114+${C1pos})
variable C11 equal 0.5*(11.7461848862114+37.7909340490834)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(-97.6477594077562+${C2pos})
variable C21 equal 0.5*(-97.6477594077562+38.4565675633483)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(-53.1242844737114+${C3pos})
variable C31 equal 0.5*(-53.1242844737114+34.9451144160547)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-9.74144244951826+${C4pos})
variable C41 equal 0.5*(-9.74144244951826+9.76276210490952)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(-4.23964936196494+${C5pos})
variable C51 equal 0.5*(-4.23964936196494+7.94326382489226)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(16.1298220822785+${C6pos})
variable C61 equal 0.5*(16.1298220822785+-31.2084427762295)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 12.7411
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.7411
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.127411 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.127411 yz delta -0.003384 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.613689 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.613689 17.5034) with tilt (-7.2027 -1.8261 0.335016)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.6 | 124.6 | 126.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.29629     -34322.14       85182.378      0              3402.5666    
       100   284.79306     -34333.831      5849.9631     -4621.0617      3402.5666    
       200   282.27978     -34329.064      3012.1044     -2030.588       3402.5666    
       300   308.88109     -34335.617     -9421.5822     -3169.5362      3402.5666    
       400   331.03843     -34337.038      9642.9633      4068.1273      3402.5666    
       500   309.69443     -34310.259      5533.0935      551.39945      3402.5666    
       600   316.65483     -34328.261      4252.2121     -4174.521       3402.5666    
       700   302.07602     -34333.281     -400.03768     -5611.0616      3402.5666    
       800   297.00068     -34339.825      67.585756     -3930.1726      3402.5666    
       900   298.37776     -34347.601     -7413.0448      535.38047      3402.5666    
      1000   293.55304     -34334.341      9644.844      -2960.0993      3402.5666    
      1100   327.14301     -34342.576      4567.809      -4682.5855      3402.5666    
      1200   315.04888     -34308.972     -2526.214      -370.57743      3402.5666    
      1300   308.70774     -34311.197     -11756.997     -5627.2999      3402.5666    
      1400   282.47577     -34320.096     -2593.3078     -5300.0174      3402.5666    
      1500   286.53021     -34344.929      4629.6735     -3995.341       3402.5666    
      1600   290.43288     -34343.304     -4859.1894     -6191.1632      3402.5666    
      1700   313.41993     -34349.371     -244.52899     -5426.814       3402.5666    
      1800   296.46889     -34331.773     -2572.3516      1502.4626      3402.5666    
      1900   305.90105     -34342.899      18.679877      2080.1497      3402.5666    
      2000   287.06397     -34343.145     -5581.0644     -3328.012       3402.5666    
Loop time of 93.824 on 16 procs for 2000 steps with 310 atoms

Performance: 0.921 ns/day, 26.062 hours/ns, 21.317 timesteps/s, 6.608 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 67.136     | 70.591     | 72.693     |  19.6 | 75.24
Bond    | 0.0006809  | 0.00082092 | 0.0010519  |   0.0 |  0.00
Neigh   | 5.1287     | 5.3582     | 5.5265     |   5.2 |  5.71
Comm    | 6.8145     | 8.8876     | 12.376     |  55.5 |  9.47
Output  | 0.0066869  | 0.010009   | 0.012396   |   2.5 |  0.01
Modify  | 8.428      | 8.6326     | 8.8979     |   5.1 |  9.20
Other   |            | 0.3436     |            |       |  0.37

Nlocal:          38.75 ave          43 max          36 min
Histogram: 1 2 2 0 0 1 0 1 0 1
Nghost:        3149.38 ave        3203 max        3088 min
Histogram: 1 1 0 1 1 0 2 0 0 2
Neighs:        24765.9 ave       27280 max       23303 min
Histogram: 2 1 2 0 0 1 0 1 0 1

Total # of neighbors = 198127
Ave neighs/atom = 639.11935
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.6 | 124.6 | 126.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.06397     -34343.145     -5581.0757      0              3402.5666    
       100   296.38317     -34346.295     -2200.7147     -3651.2182      3402.5666    
       200   297.6388      -34329.642     -2941.4292     -2146.9529      3402.5666    
       300   301.22141     -34316.273      10028.61       194.79688      3402.5666    
       400   318.37673     -34346.633     -1251.3875     -7094.7161      3402.5666    
       500   307.62907     -34373.42      -10278.444     -4560.7432      3402.5666    
       600   297.68523     -34377.113     -7441.4028     -9244.1271      3402.5666    
       700   291.04905     -34374.626      3871.7433     -2997.9813      3402.5666    
       800   290.91117     -34365.743     -7858.0162     -5571.3612      3402.5666    
       900   297.46996     -34372.85      -11170.935     -4181.8169      3402.5666    
      1000   280.98926     -34384.189     -7737.1919     -3671.471       3402.5666    
      1100   291.34731     -34405.324      1720.4853     -5892.7549      3402.5666    
      1200   293.99477     -34402.974     -11128.412     -9933.7336      3402.5666    
      1300   317.47703     -34387.197     -7197.8185     -10196.296      3402.5666    
      1400   326.6548      -34390.85      -4628.2269     -6054.2424      3402.5666    
      1500   305.80025     -34396.763     -5174.2808     -4790.6373      3402.5666    
      1600   291.57543     -34405.252     -2235.0304     -4454.8226      3402.5666    
      1700   303.86091     -34421.899     -2361.7305     -2918.3437      3402.5666    
      1800   303.92764     -34418.481     -9703.0835     -4216.5644      3402.5666    
      1900   307.34752     -34399.246     -21418.098     -9853.1703      3402.5666    
      2000   323.87654     -34394.84      -11283.116     -4252.4604      3402.5666    
Loop time of 93.1402 on 16 procs for 2000 steps with 310 atoms

Performance: 0.928 ns/day, 25.872 hours/ns, 21.473 timesteps/s, 6.657 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 67.658     | 70.482     | 71.877     |  15.4 | 75.67
Bond    | 0.00066223 | 0.00083025 | 0.0011142  |   0.0 |  0.00
Neigh   | 5.2726     | 5.3494     | 5.4314     |   2.4 |  5.74
Comm    | 7.0227     | 8.4053     | 11.233     |  44.4 |  9.02
Output  | 0.00091175 | 0.0011869  | 0.0026094  |   1.6 |  0.00
Modify  | 8.3263     | 8.4614     | 8.5685     |   3.0 |  9.08
Other   |            | 0.44       |            |       |  0.47

Nlocal:          38.75 ave          41 max          37 min
Histogram: 2 0 2 0 0 2 0 0 0 2
Nghost:           3142 ave        3183 max        3103 min
Histogram: 2 0 0 0 3 0 0 1 1 1
Neighs:        24759.9 ave       26298 max       23772 min
Histogram: 2 2 0 1 1 0 0 0 1 1

Total # of neighbors = 198079
Ave neighs/atom = 638.96452
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 2.70692772537384
variable C2neg equal ${d2}
variable C2neg equal -49.6983393645139
variable C3neg equal ${d3}
variable C3neg equal -34.4300668426635
variable C4neg equal ${d4}
variable C4neg equal -3.06866173671008
variable C5neg equal ${d5}
variable C5neg equal -10.2146456722413
variable C6neg equal ${d6}
variable C6neg equal 22.8922879784153

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.7411
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.127411 yz delta ${deltayz} remap units box
change_box all y delta 0 0.127411 yz delta 0.003384 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.868511 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.868511 17.5034) with tilt (-7.2027 -1.8261 0.341784)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.7 | 122.6 | 124.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.29629     -34340.838     -34270.863      0              3471.3053    
       100   280.1621      -34336.391     -4259.9599     -5583.0244      3471.3053    
       200   294.20783     -34321.436      265.8633      -5088.5867      3471.3053    
       300   327.79765     -34316.508     -3197.5823     -3650.297       3471.3053    
       400   304.96386     -34289.653     -1651.6904     -1332.5061      3471.3053    
       500   305.9311      -34312.044     -4779.927      -1118.1696      3471.3053    
       600   292.91852     -34325.604     -1265.8574     -7921.4854      3471.3053    
       700   306.69918     -34351.975     -12641.306     -3127.825       3471.3053    
       800   305.20818     -34351.869     -7446.6004     -3232.4664      3471.3053    
       900   300.17505     -34346.236      1754.501       1457.5204      3471.3053    
      1000   303.68686     -34340.232      1653.4745     -6866.2679      3471.3053    
      1100   305.32447     -34329.433     -9815.1864     -3965.852       3471.3053    
      1200   295.9881      -34313.634     -14808.16       3035.1873      3471.3053    
      1300   291.12736     -34325.686      3813.9804     -3794.2863      3471.3053    
      1400   284.69823     -34335.87       11516.038      1323.4869      3471.3053    
      1500   296.92846     -34346.936     -9164.4133     -1157.5257      3471.3053    
      1600   302.92745     -34340.869     -2410.0856     -59.234535      3471.3053    
      1700   307.49606     -34332.402     -11374.832     -7980.774       3471.3053    
      1800   310.16314     -34333.372      483.86708     -3707.7106      3471.3053    
      1900   296.51677     -34325.152     -9620.6695     -5998.992       3471.3053    
      2000   284.88637     -34323.577      3666.2737     -4431.3552      3471.3053    
Loop time of 91.3928 on 16 procs for 2000 steps with 310 atoms

Performance: 0.945 ns/day, 25.387 hours/ns, 21.884 timesteps/s, 6.784 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 64.975     | 68.901     | 71.297     |  24.7 | 75.39
Bond    | 0.00066917 | 0.00081078 | 0.00099764 |   0.0 |  0.00
Neigh   | 5.1132     | 5.2467     | 5.3953     |   4.1 |  5.74
Comm    | 5.9485     | 8.3403     | 12.326     |  71.2 |  9.13
Output  | 0.0055443  | 0.010928   | 0.014604   |   3.9 |  0.01
Modify  | 8.2789     | 8.478      | 8.5978     |   3.9 |  9.28
Other   |            | 0.4151     |            |       |  0.45

Nlocal:          38.75 ave          47 max          32 min
Histogram: 1 0 1 1 3 0 0 0 1 1
Nghost:        3075.38 ave        3128 max        3008 min
Histogram: 1 0 1 0 1 0 3 0 0 2
Neighs:        24232.2 ave       28994 max       20413 min
Histogram: 1 1 0 2 2 0 0 1 0 1

Total # of neighbors = 193858
Ave neighs/atom = 625.34839
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.7 | 122.6 | 124.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   284.88637     -34323.577      3666.2571      0              3471.3053    
       100   310.38538     -34340.806     -753.73112     -3558.2861      3471.3053    
       200   337.90189     -34351.921     -308.48356     -2802.4275      3471.3053    
       300   287.28125     -34335.675      195.39857     -2931.0251      3471.3053    
       400   301.89799     -34368.934     -8055.4866     -8194.6606      3471.3053    
       500   291.98864     -34360.302     -7698.6282     -7785.0265      3471.3053    
       600   286.31316     -34337.644      2454.8804      1672.2865      3471.3053    
       700   323.72913     -34346.588     -7287.4705     -1507.5853      3471.3053    
       800   310.50382     -34335.286      9415.2863     -1754.1925      3471.3053    
       900   310.20132     -34344.654     -3363.6749     -174.90464      3471.3053    
      1000   316.04379     -34357.353      9971.702      -801.67151      3471.3053    
      1100   301.22263     -34353.934     -1820.6818     -4529.2321      3471.3053    
      1200   287.31412     -34351.218      1947.5774      573.2804       3471.3053    
      1300   305.88497     -34377.674      5080.5041      779.82339      3471.3053    
      1400   291.27985     -34370.275     -4610.7809     -9444.4356      3471.3053    
      1500   308.05849     -34379.835     -10274.56      -7623.6003      3471.3053    
      1600   286.54211     -34352.779      264.41217     -4441.2484      3471.3053    
      1700   303.64055     -34360.223     -4952.0343      5230.7902      3471.3053    
      1800   298.03389     -34352.709     -14974.312      1969.3998      3471.3053    
      1900   287.91807     -34349.599     -538.42715     -3902.7977      3471.3053    
      2000   286.76384     -34361.329      410.59122      554.74669      3471.3053    
Loop time of 91.5987 on 16 procs for 2000 steps with 310 atoms

Performance: 0.943 ns/day, 25.444 hours/ns, 21.834 timesteps/s, 6.769 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 66.24      | 68.938     | 71.661     |  21.4 | 75.26
Bond    | 0.00067373 | 0.00082192 | 0.0010381  |   0.0 |  0.00
Neigh   | 5.1317     | 5.243      | 5.3296     |   2.9 |  5.72
Comm    | 5.8399     | 8.5212     | 11.283     |  60.6 |  9.30
Output  | 0.00097765 | 0.0011894  | 0.002435   |   1.4 |  0.00
Modify  | 8.3389     | 8.4968     | 8.6969     |   3.7 |  9.28
Other   |            | 0.3979     |            |       |  0.43

Nlocal:          38.75 ave          48 max          31 min
Histogram: 1 0 2 0 3 0 0 0 1 1
Nghost:        3109.75 ave        3177 max        3019 min
Histogram: 1 0 1 1 0 0 2 1 1 1
Neighs:        24219.9 ave       29576 max       19725 min
Histogram: 1 0 2 0 3 0 0 0 1 1

Total # of neighbors = 193759
Ave neighs/atom = 625.02903
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -51.4159539491747
variable C2pos equal ${d2}
variable C2pos equal 12.5113100570682
variable C3pos equal ${d3}
variable C3pos equal 6.45842593962931
variable C4pos equal ${d4}
variable C4pos equal -2.86301378378179
variable C5pos equal ${d5}
variable C5pos equal 7.35689052601611
variable C6pos equal ${d6}
variable C6pos equal -14.0766149096683

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(2.70692772537384+${C1pos})
variable C12 equal 0.5*(2.70692772537384+-51.4159539491747)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(-49.6983393645139+${C2pos})
variable C22 equal 0.5*(-49.6983393645139+12.5113100570682)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(-34.4300668426635+${C3pos})
variable C32 equal 0.5*(-34.4300668426635+6.45842593962931)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-3.06866173671008+${C4pos})
variable C42 equal 0.5*(-3.06866173671008+-2.86301378378179)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(-10.2146456722413+${C5pos})
variable C52 equal 0.5*(-10.2146456722413+7.35689052601611)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(22.8922879784153+${C6pos})
variable C62 equal 0.5*(22.8922879784153+-14.0766149096683)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.5034
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.5034
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.175034 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.7411 17.328366) with tilt (-7.2027 -1.8261 0.3384)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.2 | 124.2 | 125.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.29629     -34324.603      88583.205      0              3402.5666    
       100   283.26746     -34333.202     -13415.653     -3775.1871      3402.5666    
       200   287.67141     -34329.643      11367.085     -4326.0686      3402.5666    
       300   305.00772     -34329.647     -3328.8214      754.49605      3402.5666    
       400   324.15062     -34335.862      9739.3612     -1743.4261      3402.5666    
       500   314.45478     -34325.718     -8371.2558     -83.110695      3402.5666    
       600   286.02385     -34307.707     -2552.0592     -5717.012       3402.5666    
       700   295.41797     -34323.583     -14488.51      -7542.4277      3402.5666    
       800   313.14317     -34345.237      8142.3584     -1964.2875      3402.5666    
       900   307.40841     -34343.126     -1712.7911      503.41148      3402.5666    
      1000   269.44831     -34305.552      7950.4904     -546.05672      3402.5666    
      1100   308.06257     -34335.273      1618.6067     -3474.3827      3402.5666    
      1200   313.64681     -34334.757     -15115.495     -4420.3444      3402.5666    
      1300   300.74458     -34330.236     -2179.1228     -3338.847       3402.5666    
      1400   287.79663     -34329.506     -4831.8288     -1427.596       3402.5666    
      1500   308.80931     -34364.201      3787.9647     -698.25854      3402.5666    
      1600   274.62958     -34339.604     -1368.3518     -1065.8527      3402.5666    
      1700   299.18032     -34352.002     -7096.4235      1400.8232      3402.5666    
      1800   295.0358      -34336.391      4909.6661      2842.963       3402.5666    
      1900   302.03497     -34333.229      17931.202      6130.7977      3402.5666    
      2000   303.04182     -34329.693     -2213.0841     -4706.0463      3402.5666    
Loop time of 93.7522 on 16 procs for 2000 steps with 310 atoms

Performance: 0.922 ns/day, 26.042 hours/ns, 21.333 timesteps/s, 6.613 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 67.453     | 70.741     | 72.597     |  20.0 | 75.46
Bond    | 0.00066372 | 0.00083195 | 0.0010014  |   0.0 |  0.00
Neigh   | 5.1813     | 5.34       | 5.4923     |   4.6 |  5.70
Comm    | 6.9398     | 8.7477     | 12.093     |  56.7 |  9.33
Output  | 0.0050277  | 0.0073623  | 0.0091696  |   2.1 |  0.01
Modify  | 8.3113     | 8.5307     | 8.7441     |   4.8 |  9.10
Other   |            | 0.3847     |            |       |  0.41

Nlocal:          38.75 ave          46 max          33 min
Histogram: 1 0 2 1 1 1 1 0 0 1
Nghost:        3162.88 ave        3203 max        3107 min
Histogram: 1 0 0 0 3 0 1 1 1 1
Neighs:          24735 ave       29032 max       21366 min
Histogram: 1 0 2 1 1 1 1 0 0 1

Total # of neighbors = 197880
Ave neighs/atom = 638.32258
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.3 | 124.2 | 125.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   303.04182     -34329.693     -2213.1027      0              3402.5666    
       100   294.4487      -34334.42       3046.2065     -3145.266       3402.5666    
       200   290.94985     -34354.727      519.84482     -3408.905       3402.5666    
       300   294.74        -34375.578      1719.3931      3440.5443      3402.5666    
       400   298.65696     -34383.327     -5512.2776     -1452.9387      3402.5666    
       500   309.07912     -34366.02       11.279993      1062.1686      3402.5666    
       600   321.70849     -34363.572      2305.6801     -1682.2794      3402.5666    
       700   312.82652     -34358.722     -1594.7231     -8442.9035      3402.5666    
       800   280.9067      -34352.134     -4487.6038     -4885.4228      3402.5666    
       900   280.16444     -34368.354      1346.452       554.10803      3402.5666    
      1000   295.44161     -34377.203      7424.4701      1068.8928      3402.5666    
      1100   301.14108     -34374.75      -5465.5181      1806.132       3402.5666    
      1200   295.87462     -34364.496      3327.8096     -2841.7751      3402.5666    
      1300   292.51777     -34361.417     -1239.8547      2289.7193      3402.5666    
      1400   322.29391     -34403.938     -4772.4259     -972.35924      3402.5666    
      1500   285.35498     -34391.751      6213.8523     -4750.2214      3402.5666    
      1600   281.88899     -34388.938     -18033.801     -10304.482      3402.5666    
      1700   296.11333     -34376.168      2328.0745     -3676.2362      3402.5666    
      1800   294.30357     -34371.759     -10675.282      1247.0513      3402.5666    
      1900   306.95998     -34395.497     -13190.483     -1661.1733      3402.5666    
      2000   291.1623      -34384.311     -21376.154     -12007.566      3402.5666    
Loop time of 93.5627 on 16 procs for 2000 steps with 310 atoms

Performance: 0.923 ns/day, 25.990 hours/ns, 21.376 timesteps/s, 6.627 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 66.878     | 70.416     | 71.714     |  17.7 | 75.26
Bond    | 0.00068263 | 0.00083112 | 0.0010319  |   0.0 |  0.00
Neigh   | 5.2126     | 5.2995     | 5.4447     |   2.7 |  5.66
Comm    | 7.7934     | 9.0809     | 12.625     |  49.4 |  9.71
Output  | 0.00087884 | 0.0010989  | 0.0022862  |   1.4 |  0.00
Modify  | 8.1963     | 8.4403     | 8.5679     |   3.5 |  9.02
Other   |            | 0.3241     |            |       |  0.35

Nlocal:          38.75 ave          45 max          33 min
Histogram: 1 1 0 2 0 1 1 0 1 1
Nghost:        3142.75 ave        3171 max        3112 min
Histogram: 1 1 0 1 1 0 1 1 1 1
Neighs:        24742.5 ave       28468 max       21370 min
Histogram: 1 1 1 1 1 0 0 1 1 1

Total # of neighbors = 197940
Ave neighs/atom = 638.51613
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -75.8716819556301
variable C2neg equal ${d2}
variable C2neg equal -39.1958700390705
variable C3neg equal ${d3}
variable C3neg equal -105.038666566003
variable C4neg equal ${d4}
variable C4neg equal 2.53366810782254
variable C5neg equal ${d5}
variable C5neg equal 6.30062163106212
variable C6neg equal ${d6}
variable C6neg equal 12.7210805312127

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.5034
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.175034 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.7411 17.678434) with tilt (-7.2027 -1.8261 0.3384)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.8 | 122.7 | 124.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.29629     -34338.835     -33624.543      0              3471.3053    
       100   277.79777     -34334.362     -4294.2814     -6602.1807      3471.3053    
       200   305.41685     -34338.642      8106.2405     -4274.0133      3471.3053    
       300   312.07417     -34311.821      3098.4813     -3458.893       3471.3053    
       400   316.71416     -34305.73       9172.4808      3612.2831      3471.3053    
       500   315.66036     -34322.485     -802.3192      -3707.6445      3471.3053    
       600   286.39967     -34319.129     -11582.4       -7336.7817      3471.3053    
       700   308.33054     -34357.938      4307.2794      2326.3989      3471.3053    
       800   291.21879     -34345.684      13582.212      2520.2678      3471.3053    
       900   293.28566     -34336.403     -6776.2477     -4046.4818      3471.3053    
      1000   312.7161      -34337.069     -11943.379     -1456.4159      3471.3053    
      1100   304.60853     -34319.294     -8991.8573     -6673.6894      3471.3053    
      1200   305.59597     -34326.488     -15154.614     -8094.6956      3471.3053    
      1300   317.6815      -34355.442     -16115.768     -6660.2428      3471.3053    
      1400   278.63587     -34345.888     -1433.8493     -913.2766       3471.3053    
      1500   268.09968     -34354.432      11728.881      3489.088       3471.3053    
      1600   274.95566     -34347.792     -994.95184     -4476.0582      3471.3053    
      1700   285.67492     -34325.947      14302.869      2138.8873      3471.3053    
      1800   325.91612     -34336.06       497.52088     -1315.7907      3471.3053    
      1900   315.79118     -34327.942     -1196.9938     -20.519625      3471.3053    
      2000   294.65287     -34352.601     -4441.6948     -4459.4994      3471.3053    
Loop time of 90.2736 on 16 procs for 2000 steps with 310 atoms

Performance: 0.957 ns/day, 25.076 hours/ns, 22.155 timesteps/s, 6.868 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 65.5       | 68.284     | 70.805     |  21.9 | 75.64
Bond    | 0.00067188 | 0.00080349 | 0.00097103 |   0.0 |  0.00
Neigh   | 5.0126     | 5.1766     | 5.3572     |   5.2 |  5.73
Comm    | 5.6464     | 8.0991     | 10.811     |  63.3 |  8.97
Output  | 0.0052185  | 0.0087978  | 0.011379   |   2.9 |  0.01
Modify  | 8.2614     | 8.4057     | 8.5564     |   3.4 |  9.31
Other   |            | 0.2987     |            |       |  0.33

Nlocal:          38.75 ave          47 max          33 min
Histogram: 2 1 0 1 1 1 0 1 0 1
Nghost:        3084.38 ave        3131 max        3052 min
Histogram: 2 1 0 0 2 2 0 0 0 1
Neighs:        24216.4 ave       29003 max       20927 min
Histogram: 2 1 0 1 2 0 0 1 0 1

Total # of neighbors = 193731
Ave neighs/atom = 624.93871
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.8 | 122.7 | 124.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.65287     -34352.601     -4441.7114      0              3471.3053    
       100   308.62364     -34366.95      -16326.618     -6312.6571      3471.3053    
       200   289.67048     -34371.685     -13520.742     -6816.3622      3471.3053    
       300   278.51983     -34384.247      8485.8221     -1838.8583      3471.3053    
       400   293.79964     -34383.535     -13281.021     -1501.3901      3471.3053    
       500   291.34942     -34365.283      4288.8744     -5005.2845      3471.3053    
       600   286.64084     -34350.153     -11729.346     -4048.3574      3471.3053    
       700   315.02359     -34381.334     -2436.9917     -7591.5792      3471.3053    
       800   306.19895     -34394.312     -6336.206      -6239.4585      3471.3053    
       900   293.90864     -34399.966     -7062.9068     -8296.6097      3471.3053    
      1000   290.87132     -34395.86      -11822.347     -11202.547      3471.3053    
      1100   310.29059     -34378.799     -5361.4004     -8040.2486      3471.3053    
      1200   311.35149     -34364.754     -5037.6389     -2138.3309      3471.3053    
      1300   300.11451     -34362.959      1041.8566     -1109.3193      3471.3053    
      1400   315.36974     -34403.82       875.60762     -2854.1673      3471.3053    
      1500   298.27747     -34399.361     -10400.293     -8976.643       3471.3053    
      1600   306.99544     -34401.5       -8940.7764     -3015.9363      3471.3053    
      1700   318.38334     -34404.687     -13915.92      -5009.1776      3471.3053    
      1800   298.80623     -34356.034      1770.3462     -4805.5382      3471.3053    
      1900   338.91107     -34374.663     -11405.477     -3567.6276      3471.3053    
      2000   296.50607     -34356.993     -4120.4939     -5156.3397      3471.3053    
Loop time of 90.4762 on 16 procs for 2000 steps with 310 atoms

Performance: 0.955 ns/day, 25.132 hours/ns, 22.105 timesteps/s, 6.853 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 66.914     | 68.435     | 72.138     |  18.4 | 75.64
Bond    | 0.00063893 | 0.00080031 | 0.00093779 |   0.0 |  0.00
Neigh   | 5.1865     | 5.2695     | 5.4439     |   3.4 |  5.82
Comm    | 4.4078     | 8.1146     | 9.6704     |  53.3 |  8.97
Output  | 0.00089669 | 0.0011167  | 0.0024152  |   1.5 |  0.00
Modify  | 8.1713     | 8.3099     | 8.4859     |   3.4 |  9.18
Other   |            | 0.3455     |            |       |  0.38

Nlocal:          38.75 ave          48 max          33 min
Histogram: 1 2 2 0 1 0 0 0 0 2
Nghost:         3115.5 ave        3156 max        3076 min
Histogram: 1 1 0 2 0 0 2 0 1 1
Neighs:        24231.4 ave       29572 max       20972 min
Histogram: 1 3 1 0 1 0 0 0 0 2

Total # of neighbors = 193851
Ave neighs/atom = 625.32581
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 6.45162903385201
variable C2pos equal ${d2}
variable C2pos equal 22.2101011032757
variable C3pos equal ${d3}
variable C3pos equal 104.753505623218
variable C4pos equal ${d4}
variable C4pos equal 1.64439168497447
variable C5pos equal ${d5}
variable C5pos equal 27.3479342892788
variable C6pos equal ${d6}
variable C6pos equal -7.44465877559125

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(-75.8716819556301+${C1pos})
variable C13 equal 0.5*(-75.8716819556301+6.45162903385201)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(-39.1958700390705+${C2pos})
variable C23 equal 0.5*(-39.1958700390705+22.2101011032757)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(-105.038666566003+${C3pos})
variable C33 equal 0.5*(-105.038666566003+104.753505623218)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(2.53366810782254+${C4pos})
variable C43 equal 0.5*(2.53366810782254+1.64439168497447)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(6.30062163106212+${C5pos})
variable C53 equal 0.5*(6.30062163106212+27.3479342892788)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(12.7210805312127+${C6pos})
variable C63 equal 0.5*(12.7210805312127+-7.44465877559125)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.5034
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.5034
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.175034 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.163366)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.6 | 123.6 | 125.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.29629     -34349.271      10690.318      0              3436.9359    
       100   274.30877     -34339.314     -1785.5793     -6613.5747      3436.9359    
       200   297.69313     -34332.273      5426.2417     -4282.835       3436.9359    
       300   331.51467     -34328.806     -9329.0919     -2318.3541      3436.9359    
       400   303.59369     -34296.302      11418.018     -779.85066      3436.9359    
       500   313.68289     -34325.667      5275.4675     -1513.124       3436.9359    
       600   315.01653     -34357.564     -2249.6567     -2773.4861      3436.9359    
       700   299.85778     -34358.156      1223.9118     -2387.5068      3436.9359    
       800   307.59243     -34359.123      10447.977      1751.7999      3436.9359    
       900   306.40662     -34356.937     -1273.9913     -4357.7911      3436.9359    
      1000   326.58599     -34370.677     -9492.3065     -450.0537       3436.9359    
      1100   284.34066     -34327.697      2426.7294      456.46036      3436.9359    
      1200   298.00474     -34337.5       -6118.5988     -6549.3488      3436.9359    
      1300   315.82343     -34360.881     -12264.198      1112.5159      3436.9359    
      1400   303.17589     -34373.097     -1450.1374      754.93438      3436.9359    
      1500   280.02124     -34373.248      2081.2529     -1585.8165      3436.9359    
      1600   295.12881     -34390.115      4721.671      -1446.2459      3436.9359    
      1700   308.36396     -34388.04       4996.6656      1385.2942      3436.9359    
      1800   301.84581     -34363.799     -7783.2603     -3664.7016      3436.9359    
      1900   311.66597     -34360.127     -11006.456     -3323.826       3436.9359    
      2000   310.09502     -34360.332      1808.4451     -4195.9246      3436.9359    
Loop time of 92.2429 on 16 procs for 2000 steps with 310 atoms

Performance: 0.937 ns/day, 25.623 hours/ns, 21.682 timesteps/s, 6.721 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 67.688     | 70.145     | 72.131     |  16.6 | 76.04
Bond    | 0.00071888 | 0.00085103 | 0.0010227  |   0.0 |  0.00
Neigh   | 5.0781     | 5.2914     | 5.4056     |   4.1 |  5.74
Comm    | 6.1174     | 8.0721     | 10.544     |  49.0 |  8.75
Output  | 0.005622   | 0.013001   | 0.017905   |   5.0 |  0.01
Modify  | 8.2495     | 8.3595     | 8.5492     |   3.7 |  9.06
Other   |            | 0.3609     |            |       |  0.39

Nlocal:          38.75 ave          45 max          34 min
Histogram: 2 0 0 3 0 1 0 0 1 1
Nghost:        3137.62 ave        3162 max        3105 min
Histogram: 1 0 1 1 0 1 0 1 2 1
Neighs:        24501.2 ave       28119 max       21596 min
Histogram: 2 0 0 2 1 1 0 0 1 1

Total # of neighbors = 196010
Ave neighs/atom = 632.29032
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.7 | 123.6 | 125.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   310.09502     -34360.332      1808.4434      0              3436.9359    
       100   289.13136     -34348.092     -5719.9673     -2528.5074      3436.9359    
       200   294.98631     -34380.207      2645.4441     -1713.3696      3436.9359    
       300   303.39892     -34408.865      423.56499     -2227.8434      3436.9359    
       400   308.4701      -34409.573     -9098.5997      95.959988      3436.9359    
       500   301.39163     -34399.41       12662.705      644.26991      3436.9359    
       600   318.63464     -34417.761      1969.1252     -978.88933      3436.9359    
       700   297.50709     -34409.78      -11815.389     -4365.6378      3436.9359    
       800   278.45869     -34424.985     -9363.3268     -4391.7995      3436.9359    
       900   275.01946     -34421.505     -1779.3977     -9786.1089      3436.9359    
      1000   301.06083     -34419.732      589.23464     -6073.9375      3436.9359    
      1100   285.03695     -34395.884      614.66648      2697.1533      3436.9359    
      1200   300.67664     -34406.992      11816.171     -4751.9691      3436.9359    
      1300   320.7706      -34427.585     -8167.5132     -7191.3971      3436.9359    
      1400   281.18479     -34416.04      -19310.103     -10443.881      3436.9359    
      1500   285.19182     -34424.864     -20530.506     -13293.516      3436.9359    
      1600   300.18694     -34418.317     -7081.9715     -6400.0708      3436.9359    
      1700   323.01169     -34420.77      -8150.6623     -8449.0614      3436.9359    
      1800   320.05826     -34419.488      1979.8734     -5874.0434      3436.9359    
      1900   272.15266     -34414.936     -13326.476     -5876.7089      3436.9359    
      2000   269.59243     -34415.785      4389.0204     -5930.048       3436.9359    
Loop time of 92.1374 on 16 procs for 2000 steps with 310 atoms

Performance: 0.938 ns/day, 25.594 hours/ns, 21.707 timesteps/s, 6.729 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 67.165     | 69.515     | 72.22      |  18.5 | 75.45
Bond    | 0.00071767 | 0.00085557 | 0.0010386  |   0.0 |  0.00
Neigh   | 5.0308     | 5.2221     | 5.3381     |   4.4 |  5.67
Comm    | 6.0177     | 8.7062     | 10.963     |  51.8 |  9.45
Output  | 0.00095317 | 0.0011374  | 0.0022951  |   1.3 |  0.00
Modify  | 8.1768     | 8.3328     | 8.5424     |   4.3 |  9.04
Other   |            | 0.3597     |            |       |  0.39

Nlocal:          38.75 ave          47 max          35 min
Histogram: 3 0 1 1 2 0 0 0 0 1
Nghost:        3160.88 ave        3196 max        3121 min
Histogram: 2 0 1 1 0 0 0 1 1 2
Neighs:        24506.1 ave       29299 max       22216 min
Histogram: 3 0 1 1 2 0 0 0 0 1

Total # of neighbors = 196049
Ave neighs/atom = 632.41613
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -14.2912285370912
variable C2neg equal ${d2}
variable C2neg equal -79.2864672284798
variable C3neg equal ${d3}
variable C3neg equal -51.205952838342
variable C4neg equal ${d4}
variable C4neg equal 5.25131054426722
variable C5neg equal ${d5}
variable C5neg equal -15.0364112941454
variable C6neg equal ${d6}
variable C6neg equal 15.5074888146372

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.5034
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.175034 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.513434)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.6 | 123.6 | 125.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.29629     -34344.534      11675.622      0              3436.9359    
       100   275.80021     -34336.019     -5451.3936     -5375.5879      3436.9359    
       200   280.28532     -34312.711      4747.525      -4721.2372      3436.9359    
       300   317.42901     -34310.92      -481.46801     -3349.1283      3436.9359    
       400   316.97836     -34298.41       13563.544      3682.1328      3436.9359    
       500   323.4428      -34317.209      4370.1304     -1643.8903      3436.9359    
       600   319.96784     -34334.188      18240.741     -1097.1141      3436.9359    
       700   296.17725     -34326.757      4385.5416     -2678.6485      3436.9359    
       800   302.27888     -34334.191      6431.562      -915.02075      3436.9359    
       900   286.83159     -34316.331     -1524.5237     -1568.6681      3436.9359    
      1000   311.09719     -34342.714      4646.9845     -2947.3469      3436.9359    
      1100   302.2801      -34329.308     -3489.6369     -466.25442      3436.9359    
      1200   303.76862     -34321.787     -4661.832       433.64434      3436.9359    
      1300   304.70047     -34325.823     -18072.002     -3012.4001      3436.9359    
      1400   301.20297     -34337.35      -11790.852     -11291.662      3436.9359    
      1500   312.13086     -34348.561      9696.9871     -1732.6532      3436.9359    
      1600   302.46458     -34328.876      7560.6996     -876.8207       3436.9359    
      1700   308.90261     -34319.33       3102.9436     -1118.3785      3436.9359    
      1800   321.20611     -34328.418     -7783.6112     -1680.3961      3436.9359    
      1900   298.96837     -34330.075     -15526.649      5803.6768      3436.9359    
      2000   296.82817     -34348.621     -11694.927     -3973.8564      3436.9359    
Loop time of 92.9142 on 16 procs for 2000 steps with 310 atoms

Performance: 0.930 ns/day, 25.810 hours/ns, 21.525 timesteps/s, 6.673 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 67.378     | 69.863     | 71.587     |  15.8 | 75.19
Bond    | 0.00070908 | 0.00087518 | 0.0010022  |   0.0 |  0.00
Neigh   | 5.2916     | 5.3752     | 5.5284     |   3.3 |  5.79
Comm    | 6.8686     | 8.6567     | 11.16      |  46.0 |  9.32
Output  | 0.0077056  | 0.011264   | 0.013794   |   2.5 |  0.01
Modify  | 8.4307     | 8.6272     | 8.7571     |   3.5 |  9.29
Other   |            | 0.3804     |            |       |  0.41

Nlocal:          38.75 ave          46 max          28 min
Histogram: 1 0 0 1 1 0 1 2 1 1
Nghost:        3142.88 ave        3166 max        3106 min
Histogram: 1 0 1 0 0 1 1 1 1 2
Neighs:        24489.1 ave       28716 max       17953 min
Histogram: 1 0 0 0 2 0 1 2 1 1

Total # of neighbors = 195913
Ave neighs/atom = 631.97742
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.7 | 123.6 | 125.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.82817     -34348.621     -11694.955      0              3436.9359    
       100   292.05453     -34349.484      3730.953       3385.8364      3436.9359    
       200   299.13719     -34363.323      4901.2056      4731.6481      3436.9359    
       300   298.11904     -34361.826     -17995.609     -1132.3111      3436.9359    
       400   311.97946     -34373.449     -7587.5468     -4603.4231      3436.9359    
       500   281.68175     -34357.465     -6918.9681     -5593.9977      3436.9359    
       600   293.69443     -34395.809      4011.9812      1056.3866      3436.9359    
       700   288.70554     -34400.944      16721.383      8209.9947      3436.9359    
       800   292.84152     -34392.348     -4104.1839     -2718.1366      3436.9359    
       900   337.04339     -34412.821     -12176.7       -2796.7444      3436.9359    
      1000   314.90826     -34396.934     -9435.4048     -10303.32       3436.9359    
      1100   304.72979     -34413.696     -1448.0987     -6818.4791      3436.9359    
      1200   282.94794     -34409.829     -3892.4984     -4131.8087      3436.9359    
      1300   293.51375     -34423.951      4416.3382      1321.1781      3436.9359    
      1400   287.45149     -34406.17       4388.2536     -1508.008       3436.9359    
      1500   314.98695     -34398.706     -5765.2247     -5286.7077      3436.9359    
      1600   305.98172     -34393.422     -9015.2454     -6616.3262      3436.9359    
      1700   299.12804     -34408.507     -13592.301     -4731.0719      3436.9359    
      1800   297.00358     -34423.632     -13301.967     -4156.4385      3436.9359    
      1900   309.51359     -34439.679     -3558.3602     -5631.1254      3436.9359    
      2000   318.21626     -34447.419     -7780.6048     -4697.2575      3436.9359    
Loop time of 93.0224 on 16 procs for 2000 steps with 310 atoms

Performance: 0.929 ns/day, 25.840 hours/ns, 21.500 timesteps/s, 6.665 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 68.169     | 70.267     | 73.321     |  18.1 | 75.54
Bond    | 0.0006686  | 0.00085433 | 0.00097462 |   0.0 |  0.00
Neigh   | 5.2465     | 5.3352     | 5.5021     |   3.4 |  5.74
Comm    | 5.6353     | 8.6168     | 10.796     |  51.4 |  9.26
Output  | 0.0009375  | 0.0011682  | 0.002579   |   1.6 |  0.00
Modify  | 8.1777     | 8.4257     | 8.5107     |   3.7 |  9.06
Other   |            | 0.3756     |            |       |  0.40

Nlocal:          38.75 ave          47 max          34 min
Histogram: 1 3 0 2 0 0 0 1 0 1
Nghost:        3135.12 ave        3197 max        3067 min
Histogram: 1 1 0 0 3 0 1 0 0 2
Neighs:          24473 ave       29346 max       21798 min
Histogram: 1 3 1 1 0 0 0 1 0 1

Total # of neighbors = 195784
Ave neighs/atom = 631.56129
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 1.79997847380973
variable C2pos equal ${d2}
variable C2pos equal 76.2276858094614
variable C3pos equal ${d3}
variable C3pos equal 115.513118547062
variable C4pos equal ${d4}
variable C4pos equal -1.69941811870164
variable C5pos equal ${d5}
variable C5pos equal 1.32272702255842
variable C6pos equal ${d6}
variable C6pos equal -17.5066346645674

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-14.2912285370912+${C1pos})
variable C14 equal 0.5*(-14.2912285370912+1.79997847380973)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(-79.2864672284798+${C2pos})
variable C24 equal 0.5*(-79.2864672284798+76.2276858094614)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-51.205952838342+${C3pos})
variable C34 equal 0.5*(-51.205952838342+115.513118547062)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(5.25131054426722+${C4pos})
variable C44 equal 0.5*(5.25131054426722+-1.69941811870164)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-15.0364112941454+${C5pos})
variable C54 equal 0.5*(-15.0364112941454+1.32272702255842)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(15.5074888146372+${C6pos})
variable C64 equal 0.5*(15.5074888146372+-17.5066346645674)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.5034
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.5034
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.175034 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -2.001134 0.3384)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.7 | 123.7 | 125.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.29629     -34344.829      14753.892      0              3436.9359    
       100   275.0732      -34336.478     -8245.5083     -6769.7347      3436.9359    
       200   295.45348     -34328.635      4309.5137     -5073.0025      3436.9359    
       300   323.10652     -34322.443      1810.1098     -2718.5824      3436.9359    
       400   312.70324     -34300.362      21378.827      563.66113      3436.9359    
       500   314.93366     -34313.082      3772.6612     -1018.7985      3436.9359    
       600   292.91045     -34319.16       4381.724      -3786.2022      3436.9359    
       700   281.06629     -34329.798     -12304.722     -4501.4156      3436.9359    
       800   300.46323     -34352.722     -11873.244      639.61483      3436.9359    
       900   314.0226      -34356.539      9933.4977     -1250.075       3436.9359    
      1000   295.25041     -34325.24      -5877.2768     -1705.1719      3436.9359    
      1100   312.76694     -34334.572     -1108.2898     -324.18081      3436.9359    
      1200   305.38472     -34339.55       6402.5194     -223.20136      3436.9359    
      1300   292.39837     -34349.227     -5430.1609     -3349.1681      3436.9359    
      1400   296.68651     -34358.773      2425.977      -2760.6021      3436.9359    
      1500   297.69408     -34346.013     -935.83996      2185.1822      3436.9359    
      1600   302.99066     -34336.18      -10908.254      1361.4633      3436.9359    
      1700   293.68967     -34322.331     -6162.8271      1877.7298      3436.9359    
      1800   288.42562     -34317.127      10455.856     -3530.5729      3436.9359    
      1900   293.31509     -34325.308     -2598.1897      2129.0786      3436.9359    
      2000   313.88751     -34356.083     -15124.902     -2039.2038      3436.9359    
Loop time of 92.117 on 16 procs for 2000 steps with 310 atoms

Performance: 0.938 ns/day, 25.588 hours/ns, 21.712 timesteps/s, 6.731 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 66.485     | 69.693     | 71.947     |  17.1 | 75.66
Bond    | 0.00068043 | 0.00083362 | 0.0010523  |   0.0 |  0.00
Neigh   | 5.1714     | 5.3303     | 5.4118     |   3.1 |  5.79
Comm    | 5.9633     | 8.2466     | 11.504     |  50.3 |  8.95
Output  | 0.0055516  | 0.0084246  | 0.010539   |   2.4 |  0.01
Modify  | 8.3206     | 8.4724     | 8.6469     |   3.3 |  9.20
Other   |            | 0.3655     |            |       |  0.40

Nlocal:          38.75 ave          47 max          33 min
Histogram: 1 1 3 0 0 1 0 1 0 1
Nghost:        3136.38 ave        3176 max        3089 min
Histogram: 2 0 0 0 1 1 0 3 0 1
Neighs:        24509.2 ave       29405 max       21147 min
Histogram: 1 1 2 1 0 1 1 0 0 1

Total # of neighbors = 196074
Ave neighs/atom = 632.49677
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.8 | 123.7 | 125.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   313.88751     -34356.083     -15124.858      0              3436.9359    
       100   306.20836     -34347.079      2797.9425     -2662.4177      3436.9359    
       200   311.93108     -34336.972     -20763.576      1587.1258      3436.9359    
       300   332.51739     -34336.905      7970.7279     -1630.0198      3436.9359    
       400   299.51283     -34314.122      4870.2137      1706.5278      3436.9359    
       500   294.26844     -34341.954     -8445.6363     -5140.4386      3436.9359    
       600   287.91844     -34347.062      146.60766      1796.0216      3436.9359    
       700   309.88682     -34364.239      9402.3073     -1176.1984      3436.9359    
       800   288.53476     -34330.571      1180.4296     -2350.8049      3436.9359    
       900   316.34477     -34321.007      587.6857       271.08631      3436.9359    
      1000   329.68279     -34334.286     -12822.962     -2248.3332      3436.9359    
      1100   310.55538     -34338.392     -9483.717      -982.95784      3436.9359    
      1200   301.68106     -34346.303     -6112.4929     -7970.0484      3436.9359    
      1300   297.60442     -34350.954     -4132.1906      157.28584      3436.9359    
      1400   294.1586      -34361.627      8203.4565     -3637.127       3436.9359    
      1500   282.44795     -34379.463      5708.2161     -3601.8797      3436.9359    
      1600   284.67961     -34393.414     -4234.922      -371.74468      3436.9359    
      1700   284.87474     -34378.722      1073.0226      1867.0036      3436.9359    
      1800   293.9849      -34381.363     -433.75418      1752.7886      3436.9359    
      1900   302.58935     -34389.79      -10362.424     -4339.5556      3436.9359    
      2000   294.87311     -34388.898     -16624.451     -5991.3416      3436.9359    
Loop time of 92.1377 on 16 procs for 2000 steps with 310 atoms

Performance: 0.938 ns/day, 25.594 hours/ns, 21.707 timesteps/s, 6.729 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 66.872     | 69.624     | 72.62      |  18.9 | 75.57
Bond    | 0.00066572 | 0.00082788 | 0.0010445  |   0.0 |  0.00
Neigh   | 5.1867     | 5.317      | 5.4248     |   3.5 |  5.77
Comm    | 5.4935     | 8.4454     | 11.219     |  53.9 |  9.17
Output  | 0.0008872  | 0.0011147  | 0.0023446  |   1.4 |  0.00
Modify  | 8.2936     | 8.3848     | 8.5448     |   2.7 |  9.10
Other   |            | 0.3646     |            |       |  0.40

Nlocal:          38.75 ave          45 max          35 min
Histogram: 2 1 0 1 2 0 0 0 1 1
Nghost:        3095.38 ave        3134 max        3058 min
Histogram: 2 0 0 1 1 1 1 1 0 1
Neighs:        24500.1 ave       28249 max       22109 min
Histogram: 2 1 0 1 2 0 0 1 0 1

Total # of neighbors = 196001
Ave neighs/atom = 632.26129
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -14.9122853327084
variable C2neg equal ${d2}
variable C2neg equal -51.3690372393637
variable C3neg equal ${d3}
variable C3neg equal -94.6153403760336
variable C4neg equal ${d4}
variable C4neg equal -3.47863493783736
variable C5neg equal ${d5}
variable C5neg equal 10.5949996124817
variable C6neg equal ${d6}
variable C6neg equal -1.533783196271

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.004 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.5034
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.175034 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.651066 0.3384)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.6 | 123.6 | 125.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.29629     -34349.752      6120.5045      0              3436.9359    
       100   274.67346     -34339.526     -1003.911      -3162.1154      3436.9359    
       200   280.35594     -34316.362     -671.78922     -4445.0726      3436.9359    
       300   334.88693     -34328.591     -6777.5789     -3815.1927      3436.9359    
       400   316.55489     -34299.463      2433.0091      1874.5429      3436.9359    
       500   304.13088     -34305.285      8159.8257      268.0568       3436.9359    
       600   282.7601      -34314.254     -3205.7154     -5118.0704      3436.9359    
       700   290.93262     -34339.858     -4528.2749     -1297.5442      3436.9359    
       800   291.1549      -34337.52       3125.9049     -2146.185       3436.9359    
       900   292.34724     -34325.654     -8924.0845     -4367.9755      3436.9359    
      1000   299.54856     -34323.487     -3122.0308     -2415.3647      3436.9359    
      1100   314.21224     -34335.03       7171.4522     -3140.7595      3436.9359    
      1200   309.95846     -34351.089     -11629.648     -288.00129      3436.9359    
      1300   294.30565     -34360.4       -15613.27      -4654.0302      3436.9359    
      1400   292.45915     -34362.822     -10934.392     -1768.3679      3436.9359    
      1500   300.30744     -34362.441      7902.2403      1601.855       3436.9359    
      1600   314.59429     -34375.731     -18336.953     -2233.5059      3436.9359    
      1700   278.93933     -34351.563      7493.947       900.0101       3436.9359    
      1800   275.53556     -34348.31      -7096.4842     -1937.0555      3436.9359    
      1900   298.99955     -34364.39       1699.3772     -3831.9692      3436.9359    
      2000   311.81174     -34368.652      613.06853     -1315.8701      3436.9359    
Loop time of 93.0069 on 16 procs for 2000 steps with 310 atoms

Performance: 0.929 ns/day, 25.835 hours/ns, 21.504 timesteps/s, 6.666 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 67.23      | 70.039     | 73.685     |  21.5 | 75.31
Bond    | 0.00066697 | 0.00083079 | 0.00098332 |   0.0 |  0.00
Neigh   | 5.1324     | 5.2766     | 5.4042     |   4.3 |  5.67
Comm    | 5.1053     | 8.6369     | 11.408     |  60.7 |  9.29
Output  | 0.0061598  | 0.0083886  | 0.01011    |   1.8 |  0.01
Modify  | 8.4125     | 8.6092     | 8.8024     |   4.1 |  9.26
Other   |            | 0.4361     |            |       |  0.47

Nlocal:          38.75 ave          47 max          35 min
Histogram: 3 1 1 1 0 0 1 0 0 1
Nghost:        3133.88 ave        3169 max        3102 min
Histogram: 1 0 1 3 0 1 0 0 0 2
Neighs:        24508.5 ave       29314 max       22338 min
Histogram: 3 1 1 1 0 0 1 0 0 1

Total # of neighbors = 196068
Ave neighs/atom = 632.47742
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.6 | 123.6 | 125.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.81174     -34368.652      613.09628      0              3436.9359    
       100   307.63855     -34379.065     -2698.461       397.59821      3436.9359    
       200   284.04556     -34381.156     -4096.184      -7250.5893      3436.9359    
       300   288.34353     -34387.6       -4137.3147     -3765.1328      3436.9359    
       400   303.38598     -34393.981     -1411.6819     -510.46086      3436.9359    
       500   296.00572     -34386.156     -8063.6313      2942.8642      3436.9359    
       600   303.57622     -34396.809     -3598.7793     -6345.4796      3436.9359    
       700   287.08607     -34398.84      -7644.2929     -9985.962       3436.9359    
       800   287.35207     -34409.708     -1493.4497     -5356.5041      3436.9359    
       900   293.23551     -34396.033     -9386.0454     -4295.2395      3436.9359    
      1000   320.76542     -34393.394      945.41588     -9904.843       3436.9359    
      1100   298.81592     -34370.052     -11816.405     -6476.4994      3436.9359    
      1200   300.38741     -34375.849      1454.6305     -4759.5749      3436.9359    
      1300   307.26956     -34402.861     -5325.5757     -6475.3504      3436.9359    
      1400   298.55533     -34415.365     -9351.1585     -3143.4584      3436.9359    
      1500   327.67373     -34436.042     -10231.608     -4079.3945      3436.9359    
      1600   309.99894     -34391.473     -11084.795     -2702.5925      3436.9359    
      1700   319.11068     -34378.418     -6155.5043     -7462.8461      3436.9359    
      1800   325.9201      -34392.691     -13065.772     -11873.035      3436.9359    
      1900   298.57154     -34385.097      2371.4658     -5429.9244      3436.9359    
      2000   290.55327     -34402.312     -5264.8978      3255.95        3436.9359    
Loop time of 92.1828 on 16 procs for 2000 steps with 310 atoms

Performance: 0.937 ns/day, 25.606 hours/ns, 21.696 timesteps/s, 6.726 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 66.758     | 69.807     | 71.835     |  21.2 | 75.73
Bond    | 0.00070139 | 0.00082848 | 0.0010318  |   0.0 |  0.00
Neigh   | 5.1212     | 5.2521     | 5.3757     |   3.5 |  5.70
Comm    | 6.4682     | 8.4685     | 11.463     |  60.1 |  9.19
Output  | 0.00092016 | 0.0010997  | 0.0021511  |   1.2 |  0.00
Modify  | 8.1677     | 8.3153     | 8.442      |   2.5 |  9.02
Other   |            | 0.3384     |            |       |  0.37

Nlocal:          38.75 ave          50 max          31 min
Histogram: 2 0 1 0 2 2 0 0 0 1
Nghost:        3125.75 ave        3154 max        3097 min
Histogram: 1 2 0 0 0 1 2 0 1 1
Neighs:        24503.2 ave       31153 max       19685 min
Histogram: 2 0 1 0 1 3 0 0 0 1

Total # of neighbors = 196026
Ave neighs/atom = 632.34194
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -78.7858967003422
variable C2pos equal ${d2}
variable C2pos equal 4.93574846214056
variable C3pos equal ${d3}
variable C3pos equal 56.9762345171038
variable C4pos equal ${d4}
variable C4pos equal 0.604743986481057
variable C5pos equal ${d5}
variable C5pos equal 11.9471955365417
variable C6pos equal ${d6}
variable C6pos equal -41.3701076991566

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-14.9122853327084+${C1pos})
variable C15 equal 0.5*(-14.9122853327084+-78.7858967003422)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-51.3690372393637+${C2pos})
variable C25 equal 0.5*(-51.3690372393637+4.93574846214056)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-94.6153403760336+${C3pos})
variable C35 equal 0.5*(-94.6153403760336+56.9762345171038)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-3.47863493783736+${C4pos})
variable C45 equal 0.5*(-3.47863493783736+0.604743986481057)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(10.5949996124817+${C5pos})
variable C55 equal 0.5*(10.5949996124817+11.9471955365417)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-1.533783196271+${C6pos})
variable C65 equal 0.5*(-1.533783196271+-41.3701076991566)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 12.7411

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.7411
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.127411 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.330111 -1.8261 0.3384)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122 | 124 | 125.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.29629     -34347.976      9859.2774      0              3436.9359    
       100   277.06954     -34339.551     -3085.5933     -6390.0552      3436.9359    
       200   292.62101     -34326.114      5058.0409     -3787.2424      3436.9359    
       300   323.78956     -34318.316      2870.4869     -1521.4345      3436.9359    
       400   330.1453      -34315.513      3986.887      -1662.8966      3436.9359    
       500   295.73015     -34311.716     -4279.3845     -3963.9648      3436.9359    
       600   303.56229     -34354.946     -4401.161      -10126.414      3436.9359    
       700   274.7706      -34347.513     -14454.771     -917.20077      3436.9359    
       800   282.53658     -34350.256      11760.417      3046.8041      3436.9359    
       900   298.96314     -34345.863     -12156.094     -4116.886       3436.9359    
      1000   315.45009     -34339.621      10213.255     -6196.5212      3436.9359    
      1100   301.75981     -34317.455     -6687.8282      546.6586       3436.9359    
      1200   307.26007     -34337.553     -12715.007     -2885.1807      3436.9359    
      1300   299.80809     -34365.641     -3847.1303     -7375.6714      3436.9359    
      1400   279.34365     -34371.727     -273.81246     -9249.3761      3436.9359    
      1500   287.79908     -34372.435     -857.32294     -2097.7354      3436.9359    
      1600   290.38738     -34345.685     -3719.6235     -3067.499       3436.9359    
      1700   310.50167     -34332.422      2173.685      -5790.2716      3436.9359    
      1800   326.89321     -34341.827     -7133.6537     -11534.24       3436.9359    
      1900   294.43773     -34345.066     -15667.462     -13508.738      3436.9359    
      2000   302.37657     -34385.155     -6091.8039     -1406.7574      3436.9359    
Loop time of 92.8717 on 16 procs for 2000 steps with 310 atoms

Performance: 0.930 ns/day, 25.798 hours/ns, 21.535 timesteps/s, 6.676 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 66.215     | 70.064     | 72.508     |  22.6 | 75.44
Bond    | 0.00067981 | 0.00082042 | 0.00097288 |   0.0 |  0.00
Neigh   | 5.2345     | 5.3718     | 5.4665     |   3.5 |  5.78
Comm    | 6.1383     | 8.5361     | 12.398     |  64.7 |  9.19
Output  | 0.0059777  | 0.0091478  | 0.011424   |   2.5 |  0.01
Modify  | 8.3752     | 8.5091     | 8.7061     |   3.6 |  9.16
Other   |            | 0.3806     |            |       |  0.41

Nlocal:          38.75 ave          45 max          32 min
Histogram: 1 1 0 1 0 1 2 0 1 1
Nghost:        3153.25 ave        3197 max        3093 min
Histogram: 1 0 1 0 1 0 0 3 1 1
Neighs:          24483 ave       28163 max       20524 min
Histogram: 1 1 1 0 0 1 2 0 1 1

Total # of neighbors = 195864
Ave neighs/atom = 631.81935
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122 | 124 | 125.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.37657     -34385.155     -6091.8219      0              3436.9359    
       100   277.78882     -34356.767     -2050.7086     -9547.8077      3436.9359    
       200   320.18241     -34366.111     -7570.919      -4096.5225      3436.9359    
       300   314.99006     -34344.612     -1874.7521     -10830.379      3436.9359    
       400   303.02359     -34346.389     -11685.658     -6235.8006      3436.9359    
       500   317.28367     -34369.878     -7855.0231     -3531.8286      3436.9359    
       600   296.7962      -34363.173      12316.739      97.621891      3436.9359    
       700   273.63702     -34350.934      8672.3699     -7679.6886      3436.9359    
       800   303.42195     -34370.782     -6637.0925     -8013.7815      3436.9359    
       900   299.47049     -34325.415     -6194.904      -2171.2338      3436.9359    
      1000   315.75309     -34343.649     -4464.0156     -8939.0704      3436.9359    
      1100   308.86453     -34362.216     -2485.4852     -15297.744      3436.9359    
      1200   310.2941      -34381.415     -2810.4994     -11219.927      3436.9359    
      1300   293.09154     -34367.537      552.12664     -4065.9354      3436.9359    
      1400   311.88503     -34371.962      11527.851      439.48023      3436.9359    
      1500   314.24811     -34343.697     -6669.8378     -9393.2332      3436.9359    
      1600   335.68747     -34351.237     -2167.3851     -7492.4994      3436.9359    
      1700   326.58894     -34380.406     -384.86365     -6856.3485      3436.9359    
      1800   310.45554     -34387.332      1298.5439     -4012.7094      3436.9359    
      1900   293.44305     -34392.3       -11461.744     -7924.2803      3436.9359    
      2000   282.31724     -34397.331      2685.5978     -7091.6732      3436.9359    
Loop time of 92.1306 on 16 procs for 2000 steps with 310 atoms

Performance: 0.938 ns/day, 25.592 hours/ns, 21.708 timesteps/s, 6.730 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 65.5       | 69.415     | 71.531     |  20.4 | 75.34
Bond    | 0.00069858 | 0.00081612 | 0.00096494 |   0.0 |  0.00
Neigh   | 5.1284     | 5.3164     | 5.5164     |   5.1 |  5.77
Comm    | 6.3657     | 8.5685     | 12.543     |  58.9 |  9.30
Output  | 0.00087893 | 0.0012164  | 0.0033689  |   2.3 |  0.00
Modify  | 8.258      | 8.4434     | 8.6716     |   4.7 |  9.16
Other   |            | 0.385      |            |       |  0.42

Nlocal:          38.75 ave          46 max          36 min
Histogram: 2 0 3 2 0 0 0 0 0 1
Nghost:        3116.75 ave        3165 max        3064 min
Histogram: 2 0 0 1 1 0 1 1 0 2
Neighs:        24523.8 ave       28744 max       22731 min
Histogram: 2 0 4 1 0 0 0 0 0 1

Total # of neighbors = 196190
Ave neighs/atom = 632.87097
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -26.0613953774879
variable C2neg equal ${d2}
variable C2neg equal -2.01477877258797
variable C3neg equal ${d3}
variable C3neg equal -15.1465465188013
variable C4neg equal ${d4}
variable C4neg equal 3.61853910406483
variable C5neg equal ${d5}
variable C5neg equal 5.63310514470273
variable C6neg equal ${d6}
variable C6neg equal 15.6948553285984

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.7411
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.127411 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.075289 -1.8261 0.3384)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.5 | 123.4 | 124.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.29629     -34347.27       12430.969      0              3436.9359    
       100   272.68059     -34335.964     -7190.3449     -5286.2189      3436.9359    
       200   288.54298     -34322.594     -6182.8897     -4236.1961      3436.9359    
       300   329.49133     -34326.557      1122.1026     -2127.9142      3436.9359    
       400   316.28468     -34305.077      4539.2098      1953.0507      3436.9359    
       500   306.0709      -34318.382      7544.4327     -4914.4971      3436.9359    
       600   298.58223     -34344.418     -9755.8225     -7260.4827      3436.9359    
       700   269.65962     -34336.644      9420.3475     -715.87871      3436.9359    
       800   295.37423     -34351.634     -9138.9127     -1084.8596      3436.9359    
       900   314.9478      -34355.758      5753.0396      1354.821       3436.9359    
      1000   286.2134      -34318.081      5790.9137     -3160.348       3436.9359    
      1100   313.82477     -34335.022      8944.3033      784.64506      3436.9359    
      1200   309.67433     -34329.916     -7782.0463     -2374.5682      3436.9359    
      1300   313.24037     -34347.39       3704.7671     -1307.2781      3436.9359    
      1400   323.1585      -34378.485     -11538.438     -710.08928      3436.9359    
      1500   287.70041     -34368.567     -13564.25      -1423.897       3436.9359    
      1600   279.89912     -34364.89      -4192.647      -7661.0685      3436.9359    
      1700   293.44657     -34361.029     -13605.264     -12737.584      3436.9359    
      1800   304.5471      -34351.594      2966.5261     -9596.4453      3436.9359    
      1900   309.5333      -34351.467     -15283.099     -1889.03        3436.9359    
      2000   304.56266     -34362.942     -24782.24      -1242.6494      3436.9359    
Loop time of 92.2476 on 16 procs for 2000 steps with 310 atoms

Performance: 0.937 ns/day, 25.624 hours/ns, 21.681 timesteps/s, 6.721 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 66.556     | 69.071     | 71.772     |  19.3 | 74.88
Bond    | 0.00068234 | 0.00083043 | 0.00097576 |   0.0 |  0.00
Neigh   | 5.153      | 5.2294     | 5.326      |   2.8 |  5.67
Comm    | 6.3376     | 9.0274     | 11.563     |  53.1 |  9.79
Output  | 0.0064582  | 0.00933    | 0.01142    |   2.3 |  0.01
Modify  | 8.4113     | 8.5379     | 8.5927     |   2.3 |  9.26
Other   |            | 0.3715     |            |       |  0.40

Nlocal:          38.75 ave          43 max          35 min
Histogram: 3 0 0 0 0 2 0 1 0 2
Nghost:        3117.12 ave        3182 max        3049 min
Histogram: 2 0 0 0 2 1 1 0 0 2
Neighs:        24507.4 ave       26933 max       22218 min
Histogram: 3 0 0 0 0 2 0 1 0 2

Total # of neighbors = 196059
Ave neighs/atom = 632.44839
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.5 | 123.4 | 124.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   304.56266     -34362.942     -24782.266      0              3436.9359    
       100   318.20764     -34369.988     -15177.314     -12232.611      3436.9359    
       200   310.81076     -34352.232     -4277.4284     -7046.3611      3436.9359    
       300   320.85332     -34345.909     -14374.491     -8507.0263      3436.9359    
       400   291.88666     -34341.694      1681.6983     -5310.9831      3436.9359    
       500   297.82764     -34368.397     -15075.191     -5779.9097      3436.9359    
       600   297.42579     -34372.597      10932.833      2190.2557      3436.9359    
       700   312.3576      -34382.78      -4781.1683     -1508.5726      3436.9359    
       800   318.29511     -34369.802      528.77974     -2157.6847      3436.9359    
       900   308.24532     -34335.607     -1007.3567     -2262.8927      3436.9359    
      1000   322.72814     -34359.944     -2629.071       2557.5582      3436.9359    
      1100   292.45891     -34358.714     -2838.0919     -6412.7659      3436.9359    
      1200   312.36093     -34385.228     -348.57393     -8982.9961      3436.9359    
      1300   309.63568     -34383.129      2672.3119     -4261.5339      3436.9359    
      1400   296.06903     -34394.011      8415.624       988.41457      3436.9359    
      1500   285.39156     -34402.17      -7294.4983     -4737.9488      3436.9359    
      1600   294.81932     -34395.227     -1084.2757     -7311.4023      3436.9359    
      1700   296.53807     -34385.458      940.53833     -5650.004       3436.9359    
      1800   308.53696     -34387.261     -7418.3607      275.56984      3436.9359    
      1900   295.39242     -34372.409      3719.6301     -1905.0254      3436.9359    
      2000   319.93911     -34369.555      4866.3234     -7400.5645      3436.9359    
Loop time of 92.3237 on 16 procs for 2000 steps with 310 atoms

Performance: 0.936 ns/day, 25.645 hours/ns, 21.663 timesteps/s, 6.716 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 65.407     | 69.769     | 72.028     |  22.3 | 75.57
Bond    | 0.00068218 | 0.00083284 | 0.00096613 |   0.0 |  0.00
Neigh   | 5.0735     | 5.2836     | 5.44       |   5.1 |  5.72
Comm    | 6.0669     | 8.3482     | 12.716     |  64.2 |  9.04
Output  | 0.00092003 | 0.0011184  | 0.0022251  |   1.3 |  0.00
Modify  | 8.2643     | 8.494      | 8.7612     |   5.6 |  9.20
Other   |            | 0.4268     |            |       |  0.46

Nlocal:          38.75 ave          46 max          31 min
Histogram: 1 0 0 1 2 1 1 0 1 1
Nghost:        3121.12 ave        3158 max        3076 min
Histogram: 2 1 0 0 1 0 0 1 0 3
Neighs:        24491.2 ave       28692 max       19892 min
Histogram: 1 0 0 1 2 1 1 0 1 1

Total # of neighbors = 195930
Ave neighs/atom = 632.03226
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 29.1912371975829
variable C2pos equal ${d2}
variable C2pos equal 59.7322354644666
variable C3pos equal ${d3}
variable C3pos equal 79.1651517902881
variable C4pos equal ${d4}
variable C4pos equal 1.78830612332489
variable C5pos equal ${d5}
variable C5pos equal 6.8793950991614
variable C6pos equal ${d6}
variable C6pos equal 1.42862568734511

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-26.0613953774879+${C1pos})
variable C16 equal 0.5*(-26.0613953774879+29.1912371975829)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-2.01477877258797+${C2pos})
variable C26 equal 0.5*(-2.01477877258797+59.7322354644666)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-15.1465465188013+${C3pos})
variable C36 equal 0.5*(-15.1465465188013+79.1651517902881)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(3.61853910406483+${C4pos})
variable C46 equal 0.5*(3.61853910406483+1.78830612332489)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(5.63310514470273+${C5pos})
variable C56 equal 0.5*(5.63310514470273+6.8793950991614)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(15.6948553285984+${C6pos})
variable C66 equal 0.5*(15.6948553285984+1.42862568734511)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 24.7685594676474
variable C22all equal ${C22}
variable C22all equal -18.5935146537228
variable C33all equal ${C33}
variable C33all equal -0.142580471392499

variable C44all equal ${C44}
variable C44all equal 1.77594621278279
variable C55all equal ${C55}
variable C55all equal 11.2710975745117
variable C66all equal ${C66}
variable C66all equal 8.56174050797176

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(-24.3545131119004+${C21})
variable C12all equal 0.5*(-24.3545131119004+-29.5955959222039)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(-34.710026460889+${C31})
variable C13all equal 0.5*(-34.710026460889+-9.08958502882835)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(-8.4928844678974+${C32})
variable C23all equal 0.5*(-8.4928844678974+-13.9858204515171)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-6.24562503164073+${C41})
variable C14all equal 0.5*(-6.24562503164073+0.0106598276956298)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-46.8490910165253+${C51})
variable C15all equal 0.5*(-46.8490910165253+1.85180723146366)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(1.5649209100475+${C61})
variable C16all equal 0.5*(1.5649209100475+-7.5393103469755)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-1.52939070950919+${C42})
variable C24all equal 0.5*(-1.52939070950919+-2.96583776024594)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-23.2166443886116+${C52})
variable C25all equal 0.5*(-23.2166443886116+-1.4288775731126)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(28.8587283459393+${C62})
variable C26all equal 0.5*(28.8587283459393+4.4078365343735)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(32.15358285436+${C43})
variable C34all equal 0.5*(32.15358285436+2.0890298963985)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-18.8195529294649+${C53})
variable C35all equal 0.5*(-18.8195529294649+16.8242779601705)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(32.0093026357434+${C63})
variable C36all equal 0.5*(32.0093026357434+2.63821087781072)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-1.43694547567815+${C54})
variable C45all equal 0.5*(-1.43694547567815+-6.85684213579349)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(2.70342261369486+${C64})
variable C46all equal 0.5*(2.70342261369486+-0.9995729249651)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(6.25625012193206+${C65})
variable C56all equal 0.5*(6.25625012193206+-21.4519454477138)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:38:30
