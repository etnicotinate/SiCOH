LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-20-vasp
read_data       ${structure}.data
read_data       333U-50C-20-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.007 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.865 | 6.865 | 6.865 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              312.09081      3795.4414    
         1   300            0              0              312.09081      3795.4414    
Loop time of 8.82769e-05 on 16 procs for 1 steps with 350 atoms

56.1% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.31e-07   | 2.1875e-07 | 3.46e-07   |   0.0 |  0.25
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 1.075e-06  | 1.212e-06  | 1.378e-06  |   0.0 |  1.37
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 8.685e-05  |            |       | 98.38

Nlocal:          43.75 ave          50 max          39 min
Histogram: 2 0 1 0 2 0 2 0 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -10.66 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.4 | 124.6 | 126 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -39436.432      138394.29      0              1.7278661      3758.8201    
       100   785.54424     -40346.998     -20530.034      6194.3944      1.7278661      3758.8201    
       200   570.41845     -40556.046      2201.3003     -1580.8805      1.7278661      3758.8201    
       300   475.40802     -40782.339     -1526.9816     -2376.7408      1.7278661      3758.8201    
       400   390.62837     -40932.445      14728.866      3245.9813      1.7278661      3758.8201    
       500   321.87335     -41015.969      9588.9357      2348.53        1.7278661      3758.8201    
       600   294.20667     -41078.198     -6460.0982     -2851.6985      1.7278661      3758.8201    
       700   279.33045     -41104.205     -18535.539     -3495.4055      1.7278661      3758.8201    
       800   296.81045     -41128.312      815.31536     -4074.0602      1.7278661      3758.8201    
       900   303.92418     -41124.824     -2176.3628     -5498.0565      1.7278661      3758.8201    
      1000   307.56849     -41110.409     -13604.704     -1297.0536      1.7278661      3758.8201    
      1100   309.41027     -41107.35      -3247.0032     -7301.7976      1.7278661      3758.8201    
      1200   287.36508     -41100.922     -7469.183      -4732.7594      1.7278661      3758.8201    
      1300   307.17668     -41139.729      2563.1919      261.5597       1.7278661      3758.8201    
      1400   286.30762     -41134.436      1709.1101     -1115.202       1.7278661      3758.8201    
      1500   287.96149     -41139.782     -3692.1113     -2216.6859      1.7278661      3758.8201    
      1600   309.17813     -41149.842     -3844.8441     -4828.5466      1.7278661      3758.8201    
      1700   295.74119     -41129.202     -10639.25      -2272.353       1.7278661      3758.8201    
      1800   309.26314     -41137.486      1429.4765     -3280.9143      1.7278661      3758.8201    
      1900   295.6876      -41126.586     -12690.301     -6722.0175      1.7278661      3758.8201    
      2000   307.18527     -41146.225     -8694.8259     -6767.0872      1.7278661      3758.8201    
Loop time of 98.7202 on 16 procs for 2000 steps with 350 atoms

Performance: 0.875 ns/day, 27.422 hours/ns, 20.259 timesteps/s, 7.091 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 72.482     | 74.051     | 75.53      |  13.3 | 75.01
Bond    | 0.00066004 | 0.00080795 | 0.00098729 |   0.0 |  0.00
Neigh   | 6.0358     | 6.1861     | 6.3522     |   4.4 |  6.27
Comm    | 7.6742     | 9.1096     | 10.544     |  37.3 |  9.23
Output  | 0.001149   | 0.0014844  | 0.00349    |   2.0 |  0.00
Modify  | 8.7742     | 8.9611     | 9.1507     |   4.0 |  9.08
Other   |            | 0.4103     |            |       |  0.42

Nlocal:          43.75 ave          53 max          33 min
Histogram: 1 0 1 0 2 0 1 1 1 1
Nghost:        3165.12 ave        3217 max        3093 min
Histogram: 1 0 0 3 0 0 0 1 1 2
Neighs:        28515.8 ave       34028 max       21993 min
Histogram: 1 0 1 0 2 0 1 1 1 1

Total # of neighbors = 228126
Ave neighs/atom = 651.78857
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-20-vasp_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.2382
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 14.5028
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.0085

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--6767.0872090041)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--6767.0872090041)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--7471.08390855294)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--7471.08390855294)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--7878.56365707018)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--7878.56365707018)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--2286.79684845709)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--2286.79684845709)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--3022.11177300216)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--3022.11177300216)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--1523.1796245039)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--1523.1796245039)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 15.2382
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.2382
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.152382 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.152382 xy delta 0.062627 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.152382 xy delta 0.062627 xz delta 0.004482 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.085818 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  triclinic box = (0 0 0) to (15.085818 14.5028 17.0085) with tilt (-6.200073 -0.4482 -0.642)
  triclinic box = (0 0 0) to (15.085818 14.5028 17.0085) with tilt (-6.200073 -0.443718 -0.642)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.4 | 125.5 | 127.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.18527     -41134.587      46594.669      0              3721.2319    
       100   287.79047     -41139.666      7108.8433      2350.071       3721.2319    
       200   282.35899     -41158.131      15529.058      4596.8945      3721.2319    
       300   294.54666     -41176.879      6533.4001      7688.3799      3721.2319    
       400   292.68195     -41159.106     -2359.976       3100.857       3721.2319    
       500   312.31643     -41153.599     -7553.1968      971.54839      3721.2319    
       600   325.38192     -41166.548      1794.1351      2806.6274      3721.2319    
       700   309.26878     -41178.839      5547.0939      6985.7109      3721.2319    
       800   287.60758     -41183.584      1899.4085      1068.3789      3721.2319    
       900   286.3842      -41185.856     -523.58202     -2579.5101      3721.2319    
      1000   321.53099     -41200.001      11274.424      7107.9239      3721.2319    
      1100   292.77829     -41149.81      -2742.1661      404.67073      3721.2319    
      1200   293.25036     -41148.921      14645.969     -2575.9503      3721.2319    
      1300   323.78189     -41198.83       8750.2793     -2022.9652      3721.2319    
      1400   280.64256     -41180.61       15905.385      1880.7791      3721.2319    
      1500   289.22801     -41188.431     -730.5693      -1948.1059      3721.2319    
      1600   311.0875      -41192.054      8345.7788     -4014.2463      3721.2319    
      1700   296.14733     -41174.019     -3815.8016     -5108.3433      3721.2319    
      1800   321.53098     -41206.269      902.58684     -2555.4364      3721.2319    
      1900   300.10847     -41200.592      10081.196     -3693.0942      3721.2319    
      2000   290.39849     -41204.908      474.49562     -4937.9552      3721.2319    
Loop time of 101.196 on 16 procs for 2000 steps with 350 atoms

Performance: 0.854 ns/day, 28.110 hours/ns, 19.764 timesteps/s, 6.917 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 74.84      | 76.919     | 77.873     |  10.3 | 76.01
Bond    | 0.00067665 | 0.00081642 | 0.0010443  |   0.0 |  0.00
Neigh   | 6.1174     | 6.3145     | 6.5535     |   5.4 |  6.24
Comm    | 7.7063     | 8.6155     | 10.646     |  29.8 |  8.51
Output  | 0.0068295  | 0.010285   | 0.012011   |   2.0 |  0.01
Modify  | 8.7194     | 9.0028     | 9.2054     |   4.9 |  8.90
Other   |            | 0.3329     |            |       |  0.33

Nlocal:          43.75 ave          52 max          36 min
Histogram: 1 1 1 0 0 2 2 0 0 1
Nghost:         3180.5 ave        3213 max        3127 min
Histogram: 1 0 0 0 2 1 1 0 1 2
Neighs:        28821.4 ave       33833 max       24080 min
Histogram: 1 1 1 0 1 1 0 2 0 1

Total # of neighbors = 230571
Ave neighs/atom = 658.77429
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.4 | 125.4 | 127.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.39849     -41204.908      474.5255       0              3721.2319    
       100   298.01206     -41198.642      11194.079     -10322.631      3721.2319    
       200   313.16265     -41186.44      -1624.3988      2895.6242      3721.2319    
       300   323.97984     -41189.696     -3824.2509      394.4198       3721.2319    
       400   315.03303     -41190.144      2160.6388     -1533.6997      3721.2319    
       500   294.17198     -41182.95      -8668.8033     -3654.6134      3721.2319    
       600   295.54539     -41194.771      2892.6692      2888.8304      3721.2319    
       700   267.07081     -41184.034     -12555.422      1718.4864      3721.2319    
       800   305.59921     -41240.868     -12683.224     -5974.1061      3721.2319    
       900   294.37354     -41216.354     -3966.1959     -10669.927      3721.2319    
      1000   313.39078     -41205.209     -5028.5794     -5944.2174      3721.2319    
      1100   302.11333     -41178.692      3702.3831     -2771.6774      3721.2319    
      1200   323.28888     -41203.124      837.46755     -1311.3531      3721.2319    
      1300   297.70712     -41198.31      -1990.7007     -677.39463      3721.2319    
      1400   289.65243     -41216.78       4180.5486      1781.8668      3721.2319    
      1500   293.66967     -41244.163     -8968.0477     -1951.6821      3721.2319    
      1600   288.66773     -41224.241      6888.4353     -5347.5279      3721.2319    
      1700   285.92832     -41205.04      -9667.9791     -5018.2949      3721.2319    
      1800   305.96619     -41204.562     -5996.9587      2400.7424      3721.2319    
      1900   308.37625     -41186.042     -15059.393     -7136.1476      3721.2319    
      2000   306.50371     -41175.503     -1514.1111     -5615.8024      3721.2319    
Loop time of 101.674 on 16 procs for 2000 steps with 350 atoms

Performance: 0.850 ns/day, 28.243 hours/ns, 19.671 timesteps/s, 6.885 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 75.103     | 77.345     | 80.23      |  17.9 | 76.07
Bond    | 0.0006406  | 0.00080633 | 0.00098911 |   0.0 |  0.00
Neigh   | 6.1838     | 6.3157     | 6.4279     |   3.2 |  6.21
Comm    | 5.6538     | 8.5694     | 10.801     |  54.4 |  8.43
Output  | 0.00093761 | 0.0011765  | 0.0026685  |   1.6 |  0.00
Modify  | 8.8835     | 9.0493     | 9.155      |   3.1 |  8.90
Other   |            | 0.392      |            |       |  0.39

Nlocal:          43.75 ave          50 max          31 min
Histogram: 1 0 0 1 0 0 2 0 2 2
Nghost:        3173.12 ave        3214 max        3118 min
Histogram: 1 0 0 1 1 1 2 0 1 1
Neighs:        28851.2 ave       32599 max       20889 min
Histogram: 1 0 0 1 0 0 2 0 1 3

Total # of neighbors = 230810
Ave neighs/atom = 659.45714
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 11.6653936560696
variable C2neg equal ${d2}
variable C2neg equal 71.2246242706452
variable C3neg equal ${d3}
variable C3neg equal 83.9679066595552
variable C4neg equal ${d4}
variable C4neg equal -6.8887315672418
variable C5neg equal ${d5}
variable C5neg equal 24.5377512155649
variable C6neg equal ${d6}
variable C6neg equal 13.265134095658

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.2382
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.152382 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.152382 xy delta -0.062627 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.152382 xy delta -0.062627 xz delta -0.004482 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.390582 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  triclinic box = (0 0 0) to (15.390582 14.5028 17.0085) with tilt (-6.325327 -0.4482 -0.642)
  triclinic box = (0 0 0) to (15.390582 14.5028 17.0085) with tilt (-6.325327 -0.452682 -0.642)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.5 | 123.6 | 125.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.18527     -41121.269     -54026.338      0              3796.4083    
       100   307.97602     -41148.28       55.245382     -10416.756      3796.4083    
       200   286.95206     -41155.176      5403.6978     -4793.0282      3796.4083    
       300   268.49665     -41144.301     -1882.6153     -3916.5671      3796.4083    
       400   306.87864     -41167.062      2415.8865     -8080.3402      3796.4083    
       500   308.17495     -41140.476      3193.1066     -3849.1311      3796.4083    
       600   309.15327     -41128.346     -506.80659     -2980.8299      3796.4083    
       700   304.72209     -41138.419     -8160.07       -3495.3301      3796.4083    
       800   298.02558     -41154.765     -6614.1952     -9498.25        3796.4083    
       900   290.51039     -41160.394     -11816.301     -15901.354      3796.4083    
      1000   298.5335      -41170.47      -10610.876     -6681.0913      3796.4083    
      1100   296.51877     -41151.221     -3428.5308     -10347.176      3796.4083    
      1200   310.42244     -41145.666     -611.70554     -6598.0534      3796.4083    
      1300   312.72868     -41146.464     -7769.8531     -3404.5632      3796.4083    
      1400   294.23906     -41136.037     -4511.8053     -7788.2804      3796.4083    
      1500   281.05252     -41140.051     -12452.335     -7371.1363      3796.4083    
      1600   289.51947     -41154.212     -27365.985     -11893.065      3796.4083    
      1700   298.12401     -41158.662     -4278.8805     -6761.2992      3796.4083    
      1800   288.77626     -41137.698     -8259.5735     -4922.597       3796.4083    
      1900   309.31313     -41145.191     -8763.9712     -10745.81       3796.4083    
      2000   315.8256      -41144.403     -3272.9727     -6784.5297      3796.4083    
Loop time of 98.435 on 16 procs for 2000 steps with 350 atoms

Performance: 0.878 ns/day, 27.343 hours/ns, 20.318 timesteps/s, 7.111 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 72.771     | 74.424     | 76.143     |  15.8 | 75.61
Bond    | 0.00066814 | 0.00082675 | 0.0010281  |   0.0 |  0.00
Neigh   | 6.0491     | 6.2273     | 6.379      |   4.1 |  6.33
Comm    | 6.8186     | 8.4998     | 10.234     |  47.2 |  8.63
Output  | 0.0053967  | 0.0092247  | 0.011037   |   2.3 |  0.01
Modify  | 8.6626     | 8.8594     | 9.1007     |   4.7 |  9.00
Other   |            | 0.4141     |            |       |  0.42

Nlocal:          43.75 ave          51 max          37 min
Histogram: 1 0 3 1 0 0 0 0 1 2
Nghost:        3168.25 ave        3204 max        3111 min
Histogram: 1 0 0 0 0 2 2 1 1 1
Neighs:        28205.4 ave       32442 max       24256 min
Histogram: 1 1 2 1 0 0 0 0 1 2

Total # of neighbors = 225643
Ave neighs/atom = 644.69429
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.5 | 123.6 | 125.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   315.8256      -41144.403     -3272.8741      0              3796.4083    
       100   311.26181     -41144.663     -12179.321     -4769.8511      3796.4083    
       200   301.98401     -41158.789     -10982.04      -2320.9631      3796.4083    
       300   289.14392     -41170.658     -14165.837     -7003.913       3796.4083    
       400   294.19828     -41161.893     -5909.0235     -1884.5049      3796.4083    
       500   306.98264     -41157.558     -3195.0652     -6333.8348      3796.4083    
       600   309.41471     -41146.716     -12013.352     -8636.1101      3796.4083    
       700   295.34008     -41134.462     -10822.439     -3559.5613      3796.4083    
       800   305.82165     -41151.14      -11767.882     -5215.3549      3796.4083    
       900   283.73365     -41155.681     -2494.8038     -1857.2088      3796.4083    
      1000   281.84111     -41163.93       5445.3366     -5330.3044      3796.4083    
      1100   286.09088     -41143.394      18.931576     -6017.0569      3796.4083    
      1200   296.42947     -41132.076     -11136.5       -6403.2797      3796.4083    
      1300   299.60398     -41136.627     -20280.043     -3232.3074      3796.4083    
      1400   296.60849     -41148.666      381.19844     -6786.721       3796.4083    
      1500   296.12605     -41165.563     -7758.8968     -7082.6939      3796.4083    
      1600   301.45484     -41187.883     -11774.509     -5593.1501      3796.4083    
      1700   273.92835     -41179.29       997.64648     -3402.5216      3796.4083    
      1800   292.46343     -41180.637      466.62885     -4021.8826      3796.4083    
      1900   303.08859     -41162.499     -3818.5525     -2847.4411      3796.4083    
      2000   305.59707     -41146.744     -3575.959      -7106.7124      3796.4083    
Loop time of 98.2761 on 16 procs for 2000 steps with 350 atoms

Performance: 0.879 ns/day, 27.299 hours/ns, 20.351 timesteps/s, 7.123 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 72.675     | 74.233     | 75.428     |  10.7 | 75.53
Bond    | 0.00064936 | 0.00081741 | 0.0010032  |   0.0 |  0.00
Neigh   | 5.9919     | 6.255      | 6.4597     |   5.8 |  6.36
Comm    | 7.4924     | 8.6843     | 10.195     |  30.6 |  8.84
Output  | 0.00086823 | 0.0011939  | 0.0031232  |   2.1 |  0.00
Modify  | 8.5007     | 8.7252     | 9.031      |   6.0 |  8.88
Other   |            | 0.377      |            |       |  0.38

Nlocal:          43.75 ave          52 max          35 min
Histogram: 1 1 1 0 1 0 1 0 2 1
Nghost:        3139.88 ave        3198 max        3090 min
Histogram: 2 1 1 0 0 0 1 1 0 2
Neighs:        28228.8 ave       33093 max       22979 min
Histogram: 1 1 1 0 1 0 1 0 2 1

Total # of neighbors = 225830
Ave neighs/atom = 645.22857
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 3.44125211959935
variable C2pos equal ${d2}
variable C2pos equal -28.4603483746377
variable C3pos equal ${d3}
variable C3pos equal -8.77964973976078
variable C4pos equal ${d4}
variable C4pos equal 15.2572165031817
variable C5pos equal ${d5}
variable C5pos equal -19.6780136804858
variable C6pos equal ${d6}
variable C6pos equal 5.9143154260862

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(11.6653936560696+${C1pos})
variable C11 equal 0.5*(11.6653936560696+3.44125211959935)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(71.2246242706452+${C2pos})
variable C21 equal 0.5*(71.2246242706452+-28.4603483746377)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(83.9679066595552+${C3pos})
variable C31 equal 0.5*(83.9679066595552+-8.77964973976078)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-6.8887315672418+${C4pos})
variable C41 equal 0.5*(-6.8887315672418+15.2572165031817)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(24.5377512155649+${C5pos})
variable C51 equal 0.5*(24.5377512155649+-19.6780136804858)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(13.265134095658+${C6pos})
variable C61 equal 0.5*(13.265134095658+5.9143154260862)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 14.5028
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.5028
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.145028 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.145028 yz delta 0.00642 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.2382 14.357772 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  triclinic box = (0 0 0) to (15.2382 14.357772 17.0085) with tilt (-6.2627 -0.4482 -0.63558)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.7 | 125.2 | 127.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.18527     -41128.708      49708.085      0              3721.2319    
       100   293.77901     -41142.648      1734.6588     -2856.9478      3721.2319    
       200   279.91233     -41156.669      4851.3262      66.380473      3721.2319    
       300   266.4639      -41150.025      7611.8551      3028.9524      3721.2319    
       400   302.44003     -41167.69       1496.9976     -1752.3709      3721.2319    
       500   312.00019     -41148.942      1127.9632      3847.7195      3721.2319    
       600   302.51697     -41128.817      8246.1828     -160.14678      3721.2319    
       700   294.56147     -41137.551      3745.679       2668.2092      3721.2319    
       800   291.49288     -41153.505     -11472.92      -206.01196      3721.2319    
       900   274.89929     -41141.078     -12104.014     -2918.4955      3721.2319    
      1000   294.81172     -41151.55       175.62501      6081.672       3721.2319    
      1100   289.57569     -41127.744      6071.5214     -2345.2355      3721.2319    
      1200   304.76994     -41126.019      11857.776     -3899.4737      3721.2319    
      1300   299.09992     -41125.421      7825.6973     -138.14316      3721.2319    
      1400   276.33872     -41132.313     -3726.4152      3383.9527      3721.2319    
      1500   292.72662     -41168.162      4503.6001     -6585.8658      3721.2319    
      1600   292.94799     -41164.564      1538.7628      4530.6363      3721.2319    
      1700   311.23017     -41176.579      6804.6842      2002.5817      3721.2319    
      1800   285.16625     -41142.436     -8426.6333     -370.03104      3721.2319    
      1900   292.80845     -41136.382      8728.0075      2991.2005      3721.2319    
      2000   319.86783     -41152.6        3478.2484      467.36237      3721.2319    
Loop time of 100.664 on 16 procs for 2000 steps with 350 atoms

Performance: 0.858 ns/day, 27.962 hours/ns, 19.868 timesteps/s, 6.954 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 74.357     | 76.178     | 78.095     |  12.8 | 75.68
Bond    | 0.00071034 | 0.00082106 | 0.0010308  |   0.0 |  0.00
Neigh   | 6.2506     | 6.3473     | 6.4608     |   2.8 |  6.31
Comm    | 6.8623     | 8.7819     | 10.644     |  37.7 |  8.72
Output  | 0.0062742  | 0.0097083  | 0.012425   |   2.2 |  0.01
Modify  | 8.8283     | 8.9753     | 9.1205     |   3.0 |  8.92
Other   |            | 0.3706     |            |       |  0.37

Nlocal:          43.75 ave          51 max          37 min
Histogram: 2 0 1 1 0 1 0 1 0 2
Nghost:        3190.62 ave        3221 max        3151 min
Histogram: 1 0 1 1 1 0 0 1 1 2
Neighs:        28821.9 ave       33162 max       24807 min
Histogram: 2 1 0 1 0 1 0 1 0 2

Total # of neighbors = 230575
Ave neighs/atom = 658.78571
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.7 | 125.2 | 127.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   319.86783     -41152.6        3478.2225      0              3721.2319    
       100   298.07886     -41146.949      5164.6592      895.80572      3721.2319    
       200   288.8031      -41159.888     -10275.58       546.85304      3721.2319    
       300   295.63849     -41178.831      3370.8396      1668.9533      3721.2319    
       400   279.25128     -41160.033     -10969.651      7746.1478      3721.2319    
       500   300.75918     -41170.356     -12564.601      4293.2337      3721.2319    
       600   303.02748     -41155.652      130.41755     -4.4889556      3721.2319    
       700   303.69079     -41142.307      10881.345     -1177.3339      3721.2319    
       800   298.1404      -41137.269      41.26829      -2775.6581      3721.2319    
       900   300.41829     -41162.721     -368.81926     -3697.6843      3721.2319    
      1000   284.06986     -41170.786      11690.832      2591.6911      3721.2319    
      1100   289.71113     -41166.662      4099.0375      1475.1177      3721.2319    
      1200   310.8844      -41166.883      3633.94        5302.4015      3721.2319    
      1300   305.50485     -41147.624      10332.291      278.16044      3721.2319    
      1400   310.81667     -41155.025      4615.6546      278.26766      3721.2319    
      1500   316.7031      -41169.507     -1248.599       2958.1279      3721.2319    
      1600   303.1464      -41164.724      9934.2041     -1952.0083      3721.2319    
      1700   322.55523     -41187.529     -3079.7229     -7990.9858      3721.2319    
      1800   293.6136      -41173.473     -2432.8426      2320.8184      3721.2319    
      1900   293.74357     -41190.867     -2724.809      -3455.3945      3721.2319    
      2000   287.14681     -41167.083      1384.3834      138.05652      3721.2319    
Loop time of 101.266 on 16 procs for 2000 steps with 350 atoms

Performance: 0.853 ns/day, 28.129 hours/ns, 19.750 timesteps/s, 6.912 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 74.088     | 76.969     | 79.455     |  16.3 | 76.01
Bond    | 0.00071705 | 0.00081721 | 0.0010106  |   0.0 |  0.00
Neigh   | 6.174      | 6.3241     | 6.49       |   3.9 |  6.25
Comm    | 6.3466     | 8.7298     | 11.632     |  47.9 |  8.62
Output  | 0.00089964 | 0.0011585  | 0.0027424  |   1.8 |  0.00
Modify  | 8.5486     | 8.8468     | 9.0416     |   5.2 |  8.74
Other   |            | 0.3943     |            |       |  0.39

Nlocal:          43.75 ave          51 max          34 min
Histogram: 1 0 1 1 1 0 0 2 0 2
Nghost:        3211.12 ave        3268 max        3158 min
Histogram: 1 0 2 1 0 0 2 1 0 1
Neighs:        28794.4 ave       33293 max       22860 min
Histogram: 1 0 1 2 0 0 0 2 0 2

Total # of neighbors = 230355
Ave neighs/atom = 658.15714
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 69.9663688026142
variable C2neg equal ${d2}
variable C2neg equal 167.5919148195
variable C3neg equal ${d3}
variable C3neg equal 96.192999353535
variable C4neg equal ${d4}
variable C4neg equal -12.7358107160203
variable C5neg equal ${d5}
variable C5neg equal -2.59858887858606
variable C6neg equal ${d6}
variable C6neg equal -14.3776705399988

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.5028
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.145028 yz delta ${deltayz} remap units box
change_box all y delta 0 0.145028 yz delta -0.00642 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.2382 14.647828 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  triclinic box = (0 0 0) to (15.2382 14.647828 17.0085) with tilt (-6.2627 -0.4482 -0.64842)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.2 | 123.4 | 125.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.18527     -41122.693     -57560.885      0              3796.4083    
       100   304.91584     -41146.028     -6858.3926     -7551.9439      3796.4083    
       200   290.39492     -41157.885     -494.35204     -5585.8937      3796.4083    
       300   272.24594     -41149.43      -495.79311     -2296.1792      3796.4083    
       400   311.66493     -41170.925     -5536.9        -2039.1754      3796.4083    
       500   320.36182     -41142.907     -12109.471     -1599.2516      3796.4083    
       600   311.97536     -41122.446      1490.0294     -3884.412       3796.4083    
       700   286.11017     -41117.737     -5264.7964     -2493.2697      3796.4083    
       800   301.15943     -41158.92      -13725.947     -5809.2759      3796.4083    
       900   293.33629     -41165.931     -18920.984     -12381.7        3796.4083    
      1000   291.6806      -41154.124     -2652.3281     -2608.8986      3796.4083    
      1100   306.93131     -41150.382     -13005.759     -4774.7245      3796.4083    
      1200   325.27694     -41158.745     -13312.469     -7167.0892      3796.4083    
      1300   310.106       -41146.141      1631.0584     -4690.7236      3796.4083    
      1400   289.82858     -41140.386     -20611.904     -5244.1465      3796.4083    
      1500   293.04381     -41158.101     -12063.276     -4051.3251      3796.4083    
      1600   301.40917     -41174.421     -8006.2221     -6196.501       3796.4083    
      1700   295.33451     -41162.282     -17533.873     -6737.9973      3796.4083    
      1800   308.57141     -41162.163      279.71665     -6335.0815      3796.4083    
      1900   318.95942     -41164.598     -8989.857      -7271.8136      3796.4083    
      2000   302.10978     -41157.644     -6855.7979     -8195.4121      3796.4083    
Loop time of 97.807 on 16 procs for 2000 steps with 350 atoms

Performance: 0.883 ns/day, 27.169 hours/ns, 20.448 timesteps/s, 7.157 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 71.756     | 73.992     | 76.222     |  16.3 | 75.65
Bond    | 0.00074524 | 0.00083279 | 0.0010072  |   0.0 |  0.00
Neigh   | 5.9672     | 6.1549     | 6.4244     |   5.4 |  6.29
Comm    | 6.2685     | 8.4685     | 10.7       |  48.1 |  8.66
Output  | 0.0079378  | 0.015779   | 0.018861   |   3.6 |  0.02
Modify  | 8.5286     | 8.8209     | 9.0294     |   5.1 |  9.02
Other   |            | 0.3537     |            |       |  0.36

Nlocal:          43.75 ave          50 max          37 min
Histogram: 2 0 0 1 1 1 0 0 1 2
Nghost:           3131 ave        3194 max        3049 min
Histogram: 1 0 0 1 1 2 0 0 2 1
Neighs:        28232.5 ave       31974 max       24124 min
Histogram: 2 0 0 1 1 1 0 0 1 2

Total # of neighbors = 225860
Ave neighs/atom = 645.31429
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.2 | 123.4 | 125.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.10978     -41157.644     -6855.8151      0              3796.4083    
       100   298.98734     -41167.278     -13189.478     -8624.0823      3796.4083    
       200   271.09376     -41161.76      -14358.479     -8217.7425      3796.4083    
       300   257.62157     -41159.866     -7834.0021     -6262.3882      3796.4083    
       400   298.58559     -41179.042     -11398.992     -9968.628       3796.4083    
       500   304.82323     -41159.298     -6034.6786     -4346.2577      3796.4083    
       600   317.08239     -41163.349     -208.44608     -4188.1404      3796.4083    
       700   307.2122      -41169.708     -7540.14       -4253.9746      3796.4083    
       800   292.02381     -41179.878      47.01772       462.71521      3796.4083    
       900   277.8274      -41166.516     -2876.435      -2568.9259      3796.4083    
      1000   298.4828      -41176.443     -13727.113     -9696.8636      3796.4083    
      1100   300.43359     -41169.434     -11039.41      -11110.394      3796.4083    
      1200   289.20881     -41156.068      1445.8519     -4996.6749      3796.4083    
      1300   297.2489      -41157.042     -6158.8165     -6127.5711      3796.4083    
      1400   306.98146     -41155.669      3141.0707     -3686.212       3796.4083    
      1500   333.26582     -41144.395      8057.7905      1597.7583      3796.4083    
      1600   312.95993     -41118.948      8797.294      -1301.5118      3796.4083    
      1700   312.46363     -41150.599      361.60574     -1351.841       3796.4083    
      1800   295.42565     -41156.616      756.13052     -7639.6061      3796.4083    
      1900   294.2011      -41167.444     -11383.322     -2727.939       3796.4083    
      2000   295.12915     -41164.471      1843.8335     -2302.5638      3796.4083    
Loop time of 98.1657 on 16 procs for 2000 steps with 350 atoms

Performance: 0.880 ns/day, 27.268 hours/ns, 20.374 timesteps/s, 7.131 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 72.67      | 74.533     | 78.334     |  20.4 | 75.93
Bond    | 0.00070219 | 0.00082808 | 0.0010276  |   0.0 |  0.00
Neigh   | 6.0554     | 6.1502     | 6.3333     |   4.1 |  6.27
Comm    | 4.5605     | 8.3095     | 10.121     |  60.4 |  8.46
Output  | 0.00096444 | 0.0013081  | 0.0034684  |   2.3 |  0.00
Modify  | 8.5789     | 8.8509     | 8.9958     |   4.2 |  9.02
Other   |            | 0.3203     |            |       |  0.33

Nlocal:          43.75 ave          52 max          36 min
Histogram: 1 2 0 0 1 1 0 1 0 2
Nghost:        3138.38 ave        3188 max        3070 min
Histogram: 1 0 1 2 0 0 0 0 2 2
Neighs:        28223.4 ave       33290 max       23577 min
Histogram: 2 1 0 0 2 0 0 1 0 2

Total # of neighbors = 225787
Ave neighs/atom = 645.10571
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -45.2367833518445
variable C2pos equal ${d2}
variable C2pos equal 38.4945041365405
variable C3pos equal ${d3}
variable C3pos equal -66.8367076236424
variable C4pos equal ${d4}
variable C4pos equal 18.9625523119264
variable C5pos equal ${d5}
variable C5pos equal -19.2512479018829
variable C6pos equal ${d6}
variable C6pos equal 9.93981715522062

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(69.9663688026142+${C1pos})
variable C12 equal 0.5*(69.9663688026142+-45.2367833518445)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(167.5919148195+${C2pos})
variable C22 equal 0.5*(167.5919148195+38.4945041365405)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(96.192999353535+${C3pos})
variable C32 equal 0.5*(96.192999353535+-66.8367076236424)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-12.7358107160203+${C4pos})
variable C42 equal 0.5*(-12.7358107160203+18.9625523119264)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(-2.59858887858606+${C5pos})
variable C52 equal 0.5*(-2.59858887858606+-19.2512479018829)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(-14.3776705399988+${C6pos})
variable C62 equal 0.5*(-14.3776705399988+9.93981715522062)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.0085
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.0085
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.170085 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.2382 14.5028 16.838415) with tilt (-6.2627 -0.4482 -0.642)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.2 | 125.9 | 128.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.18527     -41138.607      44530.764      0              3721.2319    
       100   292.58127     -41146.756      3170.55       -2794.0827      3721.2319    
       200   283.71059     -41160.365      3861.0172     -80.924723      3721.2319    
       300   283.81971     -41166.933      2151.0324      1863.0861      3721.2319    
       400   286.59857     -41151.208     -11340.423      1567.3066      3721.2319    
       500   317.88661     -41156.863     -8337.9992     -154.27142      3721.2319    
       600   324.83052     -41157.871      402.54147     -5136.588       3721.2319    
       700   283.48585     -41136.229     -4246.0008      5118.4546      3721.2319    
       800   301.18878     -41179.961     -786.95294      843.11974      3721.2319    
       900   280.28972     -41170.963     -3881.5611     -4107.1444      3721.2319    
      1000   298.93979     -41179.211      10621.881      6023.1671      3721.2319    
      1100   310.18925     -41163.473      4887.03        2030.1677      3721.2319    
      1200   316.47402     -41155.821      5325.4641     -997.9227       3721.2319    
      1300   335.77402     -41184.76      -3667.2719     -711.48046      3721.2319    
      1400   319.70865     -41198.396      11263.704      2610.1472      3721.2319    
      1500   285.42749     -41184.37      -6403.1        -4790.7482      3721.2319    
      1600   288.07903     -41187.564     -4433.4212     -31.205934      3721.2319    
      1700   311.68276     -41192.32       9311.2053     -4060.8821      3721.2319    
      1800   308.97448     -41161.507      2378.9834     -3401.4376      3721.2319    
      1900   321.14336     -41158.933      4858.0439     -6537.7975      3721.2319    
      2000   302.04957     -41151.609     -2129.2383      1018.1978      3721.2319    
Loop time of 100.851 on 16 procs for 2000 steps with 350 atoms

Performance: 0.857 ns/day, 28.014 hours/ns, 19.831 timesteps/s, 6.941 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 74.848     | 76.628     | 78.794     |  14.2 | 75.98
Bond    | 0.00066637 | 0.00083223 | 0.0010721  |   0.0 |  0.00
Neigh   | 6.1856     | 6.3362     | 6.508      |   3.9 |  6.28
Comm    | 6.3839     | 8.4714     | 10.306     |  43.0 |  8.40
Output  | 0.0059977  | 0.0090982  | 0.010645   |   1.9 |  0.01
Modify  | 8.8843     | 9.0573     | 9.1803     |   3.4 |  8.98
Other   |            | 0.3488     |            |       |  0.35

Nlocal:          43.75 ave          51 max          31 min
Histogram: 1 0 0 0 1 1 1 1 0 3
Nghost:        3183.38 ave        3241 max        3103 min
Histogram: 1 0 1 0 2 0 1 0 1 2
Neighs:        28827.9 ave       33181 max       20876 min
Histogram: 1 0 0 0 1 1 1 1 0 3

Total # of neighbors = 230623
Ave neighs/atom = 658.92286
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.2 | 125.9 | 128.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.04957     -41151.609     -2129.3679      0              3721.2319    
       100   316.97045     -41173.304     -10967.187     -6106.0107      3721.2319    
       200   293.59426     -41179.924     -24501.268     -1388.4962      3721.2319    
       300   291.34121     -41192.851      1248.9453      259.9793       3721.2319    
       400   290.65291     -41182.512     -2299.2342     -185.47171      3721.2319    
       500   299.48153     -41175.335      2342.7005     -2660.5503      3721.2319    
       600   319.86192     -41189.315     -3786.2715     -975.26666      3721.2319    
       700   307.65161     -41182.694      2306.8419     -1162.8289      3721.2319    
       800   274.78456     -41164.033      15069.035      910.23922      3721.2319    
       900   276.94697     -41183.506     -4584.4125     -5595.6394      3721.2319    
      1000   294.11407     -41202.143     -789.32239     -6226.863       3721.2319    
      1100   294.11385     -41168.195     -11474.679     -3768.8724      3721.2319    
      1200   315.55254     -41179.685     -16282.607     -3375.6434      3721.2319    
      1300   281.93775     -41155.786     -6396.1681     -6046.2283      3721.2319    
      1400   299.58738     -41173.782      7009.4805     -3485.8617      3721.2319    
      1500   287.17909     -41150.782      424.98737     -4438.7857      3721.2319    
      1600   330.98725     -41191.212     -6672.4481     -4693.981       3721.2319    
      1700   302.6582      -41183.636     -8217.3647     -2808.8228      3721.2319    
      1800   278.26866     -41178.239     -6911.4149     -929.07963      3721.2319    
      1900   290.28172     -41184.898      80.219996     -9634.123       3721.2319    
      2000   293.1688      -41159.732     -5509.9013     -2609.9996      3721.2319    
Loop time of 100.782 on 16 procs for 2000 steps with 350 atoms

Performance: 0.857 ns/day, 27.995 hours/ns, 19.845 timesteps/s, 6.946 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 74.478     | 76.911     | 78.133     |  13.8 | 76.31
Bond    | 0.00069365 | 0.00081659 | 0.0010266  |   0.0 |  0.00
Neigh   | 6.2147     | 6.3139     | 6.3774     |   2.4 |  6.26
Comm    | 7.0039     | 8.235      | 10.658     |  42.0 |  8.17
Output  | 0.00088551 | 0.0012562  | 0.0036176  |   2.5 |  0.00
Modify  | 8.8029     | 8.9525     | 9.077      |   2.9 |  8.88
Other   |            | 0.3672     |            |       |  0.36

Nlocal:          43.75 ave          53 max          33 min
Histogram: 1 0 0 2 0 1 1 1 1 1
Nghost:           3187 ave        3230 max        3136 min
Histogram: 1 0 0 1 1 2 1 1 0 1
Neighs:        28815.2 ave       34407 max       22219 min
Histogram: 1 0 0 2 0 1 1 1 1 1

Total # of neighbors = 230522
Ave neighs/atom = 658.63429
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 42.1216906115434
variable C2neg equal ${d2}
variable C2neg equal 40.8419848399738
variable C3neg equal ${d3}
variable C3neg equal 93.9996789773584
variable C4neg equal ${d4}
variable C4neg equal -2.85913627896398
variable C5neg equal ${d5}
variable C5neg equal 3.3269584210509
variable C6neg equal ${d6}
variable C6neg equal -10.4859671059347

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.0085
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.170085 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.2382 14.5028 17.178585) with tilt (-6.2627 -0.4482 -0.642)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.8 | 123.7 | 125.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.18527     -41120.635     -53197.501      0              3796.4083    
       100   310.10439     -41151.352      1268.1449     -6943.103       3796.4083    
       200   282.2176      -41151.86       5754.4273     -3454.7416      3796.4083    
       300   287.22212     -41163.876      2712.9384     -1722.1443      3796.4083    
       400   306.07786     -41164.379     -6912.2064     -5842.8611      3796.4083    
       500   300.73856     -41133.939      845.21594     -5388.2909      3796.4083    
       600   318.21403     -41146.116     -2079.7569     -4246.8582      3796.4083    
       700   313.97603     -41168.75      -20282.222     -6642.9159      3796.4083    
       800   300.68625     -41182.454     -14317.454     -6256.5835      3796.4083    
       900   290.1454      -41173.743     -16506.878     -11283.482      3796.4083    
      1000   313.15195     -41175.301     -911.00338     -7819.348       3796.4083    
      1100   332.60334     -41169.747     -11896.806     -10297.204      3796.4083    
      1200   302.04288     -41134.414     -5418.0023     -8828.8898      3796.4083    
      1300   307.08739     -41161.161     -6795.1438     -8765.6837      3796.4083    
      1400   276.68745     -41156.763      479.7698      -5179.1053      3796.4083    
      1500   285.21218     -41163.125     -9664.3615     -10370.341      3796.4083    
      1600   296.94655     -41157.896     -238.65201     -6907.3545      3796.4083    
      1700   299.66082     -41147.73      -1290.5821     -4395.9973      3796.4083    
      1800   309.64059     -41161.999     -445.7614      -4131.5332      3796.4083    
      1900   308.45324     -41165.182     -4216.8495     -9137.2335      3796.4083    
      2000   307.96778     -41168.373     -358.76075     -1786.6026      3796.4083    
Loop time of 98.237 on 16 procs for 2000 steps with 350 atoms

Performance: 0.880 ns/day, 27.288 hours/ns, 20.359 timesteps/s, 7.126 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 73.054     | 74.381     | 76.142     |  11.4 | 75.72
Bond    | 0.00073108 | 0.00084163 | 0.0010404  |   0.0 |  0.00
Neigh   | 6.0466     | 6.1996     | 6.3613     |   3.6 |  6.31
Comm    | 6.7443     | 8.4862     | 9.7201     |  33.3 |  8.64
Output  | 0.005835   | 0.010214   | 0.012221   |   2.5 |  0.01
Modify  | 8.6599     | 8.7627     | 8.8863     |   2.7 |  8.92
Other   |            | 0.3961     |            |       |  0.40

Nlocal:          43.75 ave          53 max          35 min
Histogram: 1 1 1 1 0 1 0 1 1 1
Nghost:        3143.75 ave        3199 max        3060 min
Histogram: 1 0 0 0 2 1 1 1 0 2
Neighs:        28221.6 ave       33676 max       23069 min
Histogram: 1 1 1 1 0 1 0 1 1 1

Total # of neighbors = 225773
Ave neighs/atom = 645.06571
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.8 | 123.7 | 125.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.96778     -41168.373     -358.77323      0              3796.4083    
       100   302.00816     -41164.221     -10796.558     -10500.292      3796.4083    
       200   288.6364      -41163.069     -17655.162     -7841.8363      3796.4083    
       300   283.46467     -41170.97      -8843.8934     -6672.2923      3796.4083    
       400   286.40016     -41162.509     -13617.434     -6868.9294      3796.4083    
       500   297.46956     -41143.822     -5344.7384     -9615.3773      3796.4083    
       600   322.00163     -41165.524     -7025.0599     -6242.0072      3796.4083    
       700   294.5524      -41153.505      7082.5841     -12357.617      3796.4083    
       800   296.32628     -41168.875     -5437.5577     -13767.55       3796.4083    
       900   281.68321     -41180.847     -6584.0988     -11422.279      3796.4083    
      1000   278.02041     -41185.78      -1520.1164     -5343.0949      3796.4083    
      1100   295.33737     -41175.179     -15250.048     -9472.9582      3796.4083    
      1200   305.90367     -41165.935     -19292.808     -7423.3427      3796.4083    
      1300   312.12857     -41167.693     -1682.2157     -6295.8622      3796.4083    
      1400   291.03804     -41144.421      1842.8152     -7579.0737      3796.4083    
      1500   295.17964     -41167.266     -4977.1302     -7539.7344      3796.4083    
      1600   290.29307     -41191.365     -3142.3807     -8705.3698      3796.4083    
      1700   269.75997     -41165.66      -2069.6986     -6064.105       3796.4083    
      1800   309.02026     -41183.942     -7383.0422     -5914.0927      3796.4083    
      1900   288.0424      -41154.067      3366.9325     -1430.2103      3796.4083    
      2000   294.72623     -41155.738     -3708.6293     -4856.1928      3796.4083    
Loop time of 98.2343 on 16 procs for 2000 steps with 350 atoms

Performance: 0.880 ns/day, 27.287 hours/ns, 20.359 timesteps/s, 7.126 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 70.605     | 73.777     | 75.634     |  18.6 | 75.10
Bond    | 0.00070646 | 0.00083454 | 0.0010488  |   0.0 |  0.00
Neigh   | 6.0091     | 6.17       | 6.3501     |   4.8 |  6.28
Comm    | 7.2595     | 9.113      | 12.259     |  52.7 |  9.28
Output  | 0.00091428 | 0.0011337  | 0.0024311  |   1.5 |  0.00
Modify  | 8.5544     | 8.7747     | 8.9733     |   4.7 |  8.93
Other   |            | 0.3979     |            |       |  0.41

Nlocal:          43.75 ave          51 max          35 min
Histogram: 1 1 0 0 0 2 1 1 1 1
Nghost:        3113.12 ave        3149 max        3061 min
Histogram: 1 0 1 1 1 0 0 0 2 2
Neighs:        28219.5 ave       32440 max       23064 min
Histogram: 1 1 0 0 1 1 1 1 1 1

Total # of neighbors = 225756
Ave neighs/atom = 645.01714
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -19.3621377606262
variable C2pos equal ${d2}
variable C2pos equal 28.3257059561448
variable C3pos equal ${d3}
variable C3pos equal -6.47250745371039
variable C4pos equal ${d4}
variable C4pos equal 4.47158606918994
variable C5pos equal ${d5}
variable C5pos equal -24.7287041795241
variable C6pos equal ${d6}
variable C6pos equal 10.2693709192525

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(42.1216906115434+${C1pos})
variable C13 equal 0.5*(42.1216906115434+-19.3621377606262)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(40.8419848399738+${C2pos})
variable C23 equal 0.5*(40.8419848399738+28.3257059561448)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(93.9996789773584+${C3pos})
variable C33 equal 0.5*(93.9996789773584+-6.47250745371039)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-2.85913627896398+${C4pos})
variable C43 equal 0.5*(-2.85913627896398+4.47158606918994)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(3.3269584210509+${C5pos})
variable C53 equal 0.5*(3.3269584210509+-24.7287041795241)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-10.4859671059347+${C6pos})
variable C63 equal 0.5*(-10.4859671059347+10.2693709192525)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.0085
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.0085
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.170085 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.812085)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.4 | 124.7 | 126.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.18527     -41142.854     -8392.9292      0              3758.8201    
       100   298.08055     -41154.026      2304.8021     -4629.3444      3758.8201    
       200   279.7453      -41153.233      10559.048     -858.61143      3758.8201    
       300   291.02644     -41166.967      14505.077      2346.7726      3758.8201    
       400   288.56562     -41148.213     -1051.0296     -2915.5897      3758.8201    
       500   315.84146     -41151.854     -12503.038     -3309.3122      3758.8201    
       600   315.15345     -41144.38      -9233.5778     -1294.0107      3758.8201    
       700   303.85294     -41155.384     -11834.663      2997.7489      3758.8201    
       800   284.43859     -41157.374     -9855.9283     -5367.7804      3758.8201    
       900   300.0819      -41179.435      562.95493     -5979.4468      3758.8201    
      1000   279.71598     -41144.449      14748.045      4200.6879      3758.8201    
      1100   314.41265     -41147.758      3110.5605      109.82737      3758.8201    
      1200   313.21847     -41134.006      7213.2853     -1148.8522      3758.8201    
      1300   306.64825     -41147.609     -1354.172      -970.30011      3758.8201    
      1400   282.8807      -41144.658      4332.6338      519.94753      3758.8201    
      1500   289.84401     -41160.977      3165.91       -2169.0983      3758.8201    
      1600   281.38221     -41139.895     -2401.9568      4472.421       3758.8201    
      1700   322.96354     -41169.783      1429.2087      4785.1619      3758.8201    
      1800   294.70754     -41149.902      9218.9311     -238.50046      3758.8201    
      1900   296.34194     -41161.71       4659.5828      1344.3399      3758.8201    
      2000   290.95567     -41158.673     -3320.7244     -2392.725       3758.8201    
Loop time of 99.9197 on 16 procs for 2000 steps with 350 atoms

Performance: 0.865 ns/day, 27.755 hours/ns, 20.016 timesteps/s, 7.006 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 74.231     | 76.112     | 77.585     |  13.8 | 76.17
Bond    | 0.00067533 | 0.00083336 | 0.0010631  |   0.0 |  0.00
Neigh   | 6.2445     | 6.3709     | 6.5808     |   4.3 |  6.38
Comm    | 6.8083     | 8.2532     | 10.177     |  41.2 |  8.26
Output  | 0.0059951  | 0.0094033  | 0.011107   |   2.0 |  0.01
Modify  | 8.6147     | 8.7865     | 8.9311     |   3.4 |  8.79
Other   |            | 0.3866     |            |       |  0.39

Nlocal:          43.75 ave          51 max          35 min
Histogram: 1 1 1 0 0 0 3 0 0 2
Nghost:        3176.75 ave        3223 max        3143 min
Histogram: 1 1 1 0 3 0 1 0 0 1
Neighs:        28494.2 ave       32947 max       23268 min
Histogram: 1 1 1 0 0 0 3 0 0 2

Total # of neighbors = 227954
Ave neighs/atom = 651.29714
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.4 | 124.7 | 126.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.95567     -41158.673     -3320.8145      0              3758.8201    
       100   304.92624     -41166.893      1869.7381     -6365.7459      3758.8201    
       200   324.5763      -41163.292     -2883.4144     -3500.436       3758.8201    
       300   331.67365     -41150.598      7208.1029     -1451.2705      3758.8201    
       400   301.34959     -41144.642      11600.69       4680.3137      3758.8201    
       500   308.52569     -41182.748     -10065.444      1826.7933      3758.8201    
       600   290.6827      -41174.631      7784.4217     -1562.3405      3758.8201    
       700   300.98052     -41179.431     -7700.5591     -712.25829      3758.8201    
       800   307.37229     -41159.08       7105.4835     -1193.6718      3758.8201    
       900   333.06837     -41175.291     -7759.2037     -2379.672       3758.8201    
      1000   307.39083     -41167.95      -9812.7643      1101.3365      3758.8201    
      1100   301.39728     -41172.685      805.48498      1508.5719      3758.8201    
      1200   306.71626     -41179.086     -993.89185      7.2920843      3758.8201    
      1300   297.53084     -41166.675      4868.898      -4015.0155      3758.8201    
      1400   299.4127      -41165.702     -7380.065      -1396.2814      3758.8201    
      1500   297.53566     -41154.769     -18785.485     -452.4397       3758.8201    
      1600   280.08229     -41139.525     -13312.42      -1193.0825      3758.8201    
      1700   297.443       -41184.049     -2010.5423      3304.181       3758.8201    
      1800   268.53991     -41163.72      -722.25411      7035.8511      3758.8201    
      1900   303.66021     -41183.032     -1054.197       2274.3473      3758.8201    
      2000   311.67474     -41171.955     -6061.9287      316.12046      3758.8201    
Loop time of 99.3606 on 16 procs for 2000 steps with 350 atoms

Performance: 0.870 ns/day, 27.600 hours/ns, 20.129 timesteps/s, 7.045 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 73.31      | 74.925     | 76.589     |  13.9 | 75.41
Bond    | 0.00069556 | 0.00083623 | 0.0010523  |   0.0 |  0.00
Neigh   | 6.1289     | 6.2583     | 6.425      |   4.5 |  6.30
Comm    | 7.2847     | 8.9566     | 10.589     |  40.8 |  9.01
Output  | 0.00087726 | 0.001364   | 0.0041298  |   2.8 |  0.00
Modify  | 8.6963     | 8.8679     | 9.0248     |   4.3 |  8.92
Other   |            | 0.3508     |            |       |  0.35

Nlocal:          43.75 ave          52 max          32 min
Histogram: 1 0 0 1 1 0 2 0 1 2
Nghost:        3169.75 ave        3216 max        3130 min
Histogram: 1 2 0 0 0 3 0 1 0 1
Neighs:        28522.4 ave       33612 max       21314 min
Histogram: 1 0 0 1 1 0 2 0 2 1

Total # of neighbors = 228179
Ave neighs/atom = 651.94
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 71.7706016863646
variable C2neg equal ${d2}
variable C2neg equal 50.5117354480398
variable C3neg equal ${d3}
variable C3neg equal 8.454420930553
variable C4neg equal ${d4}
variable C4neg equal 21.6686234765267
variable C5neg equal ${d5}
variable C5neg equal 8.03252228445597
variable C6neg equal ${d6}
variable C6neg equal 2.87639049983807

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.0085
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.170085 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.471915)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.3 | 124.6 | 126.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.18527     -41141.58      -7462.5818      0              3758.8201    
       100   296.83916     -41150.217      602.1845      -6747.037       3758.8201    
       200   275.26681     -41142.495      2853.0455     -2735.1254      3758.8201    
       300   283.33975     -41149.14       1242.9827     -289.65206      3758.8201    
       400   311.38352     -41158.694     -5010.6338     -3621.8608      3758.8201    
       500   307.41215     -41138.967     -2878.4536     -1904.5237      3758.8201    
       600   303.43382     -41134.972      3626.3987     -771.14534      3758.8201    
       700   296.94595     -41144.805     -11149.138      481.68841      3758.8201    
       800   286.28915     -41147.823     -7002.4522     -5998.6517      3758.8201    
       900   322.47613     -41188.609     -1292.51       -3948.3509      3758.8201    
      1000   286.79355     -41154.165      11250.437      751.99708      3758.8201    
      1100   282.98802     -41137.614      10106.037     -3702.046       3758.8201    
      1200   308.17066     -41149.227     -2463.5527     -4119.8126      3758.8201    
      1300   303.45259     -41158.969      1446.4532     -1694.0545      3758.8201    
      1400   305.0556      -41181.183     -3755.329      -221.91228      3758.8201    
      1500   283.22535     -41169.483     -19517.16      -6545.4047      3758.8201    
      1600   281.30328     -41162.636      688.79939     -7088.76        3758.8201    
      1700   311.89258     -41180.616      3595.8993     -2109.9186      3758.8201    
      1800   297.81268     -41169.228     -9434.7274     -6229.1817      3758.8201    
      1900   302.01348     -41199.252     -5581.6661     -6441.673       3758.8201    
      2000   300.82264     -41218.071      2160.216      -3653.8341      3758.8201    
Loop time of 99.2235 on 16 procs for 2000 steps with 350 atoms

Performance: 0.871 ns/day, 27.562 hours/ns, 20.157 timesteps/s, 7.055 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 74.053     | 75.276     | 76.416     |   8.9 | 75.86
Bond    | 0.00072972 | 0.00084336 | 0.0010107  |   0.0 |  0.00
Neigh   | 6.0158     | 6.1901     | 6.3511     |   4.3 |  6.24
Comm    | 7.4585     | 8.5458     | 9.7222     |  26.0 |  8.61
Output  | 0.0055098  | 0.0084805  | 0.0099575  |   1.9 |  0.01
Modify  | 8.6722     | 8.8101     | 8.9915     |   3.3 |  8.88
Other   |            | 0.3923     |            |       |  0.40

Nlocal:          43.75 ave          54 max          34 min
Histogram: 1 0 1 1 1 0 2 1 0 1
Nghost:           3171 ave        3223 max        3119 min
Histogram: 1 0 2 0 1 0 2 1 0 1
Neighs:        28503.5 ave       34610 max       22605 min
Histogram: 1 0 1 1 1 0 2 1 0 1

Total # of neighbors = 228028
Ave neighs/atom = 651.50857
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.3 | 124.6 | 126.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   300.82264     -41218.071      2160.1621      0              3758.8201    
       100   284.10938     -41195.443     -13388.774     -5895.115       3758.8201    
       200   299.26069     -41176.432     -3508.0853     -1799.2296      3758.8201    
       300   306.47845     -41173.798     -11150.663     -5239.2501      3758.8201    
       400   315.60372     -41194.003     -15201.282     -16254.62       3758.8201    
       500   300.39786     -41200.627     -12294.55      -6043.4409      3758.8201    
       600   298.89263     -41204.685     -5749.7143     -14104.513      3758.8201    
       700   294.74385     -41201.427     -7904.2965     -7475.2809      3758.8201    
       800   306.54195     -41210.754      1086.1033     -3767.1642      3758.8201    
       900   295.91903     -41194.476     -8821.6598     -3232.8863      3758.8201    
      1000   296.23667     -41189.9       -10713.835     -3924.7118      3758.8201    
      1100   306.03589     -41198.319     -11635.378     -8996.4132      3758.8201    
      1200   311.44238     -41207.67      -6855.7683     -12052.215      3758.8201    
      1300   285.79057     -41202.108     -349.83269     -8884.3562      3758.8201    
      1400   288.64257     -41222.694     -31.767183     -5193.3445      3758.8201    
      1500   297.90104     -41209.558     -6136.6254     -5468.9755      3758.8201    
      1600   282.80491     -41166.342     -9364.3732     -5138.9377      3758.8201    
      1700   304.01519     -41184.266     -14471.929     -8284.095       3758.8201    
      1800   295.57771     -41178.875      574.27614     -6412.1787      3758.8201    
      1900   286.94237     -41189.23      -1080.4906     -7929.2525      3758.8201    
      2000   295.14039     -41214.634     -4219.748      -6317.9529      3758.8201    
Loop time of 99.3945 on 16 procs for 2000 steps with 350 atoms

Performance: 0.869 ns/day, 27.610 hours/ns, 20.122 timesteps/s, 7.043 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 73.766     | 75.29      | 77.121     |  13.0 | 75.75
Bond    | 0.00072298 | 0.00084969 | 0.0009919  |   0.0 |  0.00
Neigh   | 6.0935     | 6.1676     | 6.2784     |   2.6 |  6.21
Comm    | 6.9245     | 8.768      | 10.224     |  37.9 |  8.82
Output  | 0.00091568 | 0.0012341  | 0.0032837  |   2.2 |  0.00
Modify  | 8.668      | 8.7924     | 8.8909     |   2.5 |  8.85
Other   |            | 0.3742     |            |       |  0.38

Nlocal:          43.75 ave          53 max          34 min
Histogram: 1 1 0 2 0 0 1 2 0 1
Nghost:        3153.12 ave        3211 max        3106 min
Histogram: 2 1 0 1 0 1 1 0 1 1
Neighs:        28526.4 ave       34075 max       22632 min
Histogram: 1 1 0 2 0 0 1 1 1 1

Total # of neighbors = 228211
Ave neighs/atom = 652.03143
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -4.55085324361401
variable C2pos equal ${d2}
variable C2pos equal -11.1520320172452
variable C3pos equal ${d3}
variable C3pos equal -60.5517496205502
variable C4pos equal ${d4}
variable C4pos equal 20.1740948888526
variable C5pos equal ${d5}
variable C5pos equal -3.89786088011541
variable C6pos equal ${d6}
variable C6pos equal 7.54815613129605

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(71.7706016863646+${C1pos})
variable C14 equal 0.5*(71.7706016863646+-4.55085324361401)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(50.5117354480398+${C2pos})
variable C24 equal 0.5*(50.5117354480398+-11.1520320172452)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(8.454420930553+${C3pos})
variable C34 equal 0.5*(8.454420930553+-60.5517496205502)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(21.6686234765267+${C4pos})
variable C44 equal 0.5*(21.6686234765267+20.1740948888526)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(8.03252228445597+${C5pos})
variable C54 equal 0.5*(8.03252228445597+-3.89786088011541)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(2.87639049983807+${C6pos})
variable C64 equal 0.5*(2.87639049983807+7.54815613129605)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.0085
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.0085
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.170085 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.618285 -0.642)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.4 | 124.7 | 126.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.18527     -41144.779     -6801.1969      0              3758.8201    
       100   288.58239     -41144.427      7381.887      -4547.4955      3758.8201    
       200   277.39944     -41146.119      7890.4636     -1747.8192      3758.8201    
       300   264.54173     -41132.041      9706.174       3473.0802      3758.8201    
       400   300.16249     -41153.791     -5500.8408     -2296.5251      3758.8201    
       500   328.75856     -41164.228     -25.200844      947.22242      3758.8201    
       600   307.97966     -41149.189      12355.034     -5262.4666      3758.8201    
       700   298.78646     -41163.917      1962.958      -892.65157      3758.8201    
       800   286.43622     -41172.543     -816.46432     -3169.3604      3758.8201    
       900   286.22295     -41173.576     -5177.7581     -6943.8901      3758.8201    
      1000   301.01303     -41164.02       669.1178       38.322805      3758.8201    
      1100   323.42059     -41168.783     -7732.7221     -1966.4665      3758.8201    
      1200   304.7905      -41158.294     -5302.1221     -6979.9944      3758.8201    
      1300   307.78261     -41183.558     -11207.319     -13533.563      3758.8201    
      1400   278.14519     -41170.36      -3692.9719     -2874.7687      3758.8201    
      1500   291.03268     -41170.836     -5324.4109     -2386.5446      3758.8201    
      1600   311.95625     -41172.172     -12069.257     -14694.258      3758.8201    
      1700   317.85518     -41166.038      3812.4102     -2872.729       3758.8201    
      1800   304.81727     -41151.98      -14005.87      -10438.728      3758.8201    
      1900   316.22138     -41172.294      229.48815     -8819.1817      3758.8201    
      2000   290.88058     -41164.94      -20067.335     -9295.4771      3758.8201    
Loop time of 99.026 on 16 procs for 2000 steps with 350 atoms

Performance: 0.872 ns/day, 27.507 hours/ns, 20.197 timesteps/s, 7.069 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 74.096     | 75.237     | 76.746     |  11.1 | 75.98
Bond    | 0.00072044 | 0.0008344  | 0.0010109  |   0.0 |  0.00
Neigh   | 5.962      | 6.2483     | 6.3998     |   5.6 |  6.31
Comm    | 6.8884     | 8.4061     | 9.4653     |  33.0 |  8.49
Output  | 0.0065013  | 0.0095934  | 0.011173   |   1.8 |  0.01
Modify  | 8.5865     | 8.7911     | 9.1046     |   5.3 |  8.88
Other   |            | 0.3327     |            |       |  0.34

Nlocal:          43.75 ave          52 max          35 min
Histogram: 1 1 1 0 1 0 2 0 0 2
Nghost:        3149.38 ave        3189 max        3095 min
Histogram: 1 0 0 0 3 0 0 3 0 1
Neighs:        28521.5 ave       33478 max       23270 min
Histogram: 1 1 1 0 1 0 2 0 0 2

Total # of neighbors = 228172
Ave neighs/atom = 651.92
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.5 | 124.6 | 126.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.88058     -41164.94      -20067.399      0              3758.8201    
       100   288.3232      -41157.43      -12539.124     -9563.8891      3758.8201    
       200   313.66843     -41168.841      12473.556     -645.46117      3758.8201    
       300   307.9445      -41143.839     -5971.6486     -5742.1719      3758.8201    
       400   303.61168     -41132.028     -4.3244954     -4823.536       3758.8201    
       500   291.85851     -41150.266     -1379.7888     -5245.8383      3758.8201    
       600   283.85934     -41164.91      -13557.675     -14313.254      3758.8201    
       700   299.92683     -41183.002      6183.9145     -12021.546      3758.8201    
       800   294.79467     -41160.823     -18071.408     -10021.877      3758.8201    
       900   306.37753     -41148.101      70.237385     -8708.2216      3758.8201    
      1000   306.80314     -41141.001     -12850.363     -11445.582      3758.8201    
      1100   307.68781     -41157.355     -14227.881     -9111.7551      3758.8201    
      1200   302.05831     -41162.069     -6860.0228     -3127.7425      3758.8201    
      1300   292.56513     -41172.895     -10668.38      -6585.8828      3758.8201    
      1400   285.11305     -41173.414     -12341.958     -3753.1663      3758.8201    
      1500   313.58657     -41179.36       17613.408     -1347.4318      3758.8201    
      1600   296.10851     -41141.646      2211.4071     -8261.3179      3758.8201    
      1700   281.51927     -41130.165      8169.2932     -294.85063      3758.8201    
      1800   319.32395     -41182.33      -4389.623      -3659.6836      3758.8201    
      1900   293.85664     -41167.759     -9193.4796     -10789.389      3758.8201    
      2000   284.92523     -41155.191     -8518.2348     -6736.86        3758.8201    
Loop time of 99.5235 on 16 procs for 2000 steps with 350 atoms

Performance: 0.868 ns/day, 27.645 hours/ns, 20.096 timesteps/s, 7.034 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 73.329     | 74.882     | 76.632     |  13.3 | 75.24
Bond    | 0.0006986  | 0.00083841 | 0.0010111  |   0.0 |  0.00
Neigh   | 6.0352     | 6.2261     | 6.3108     |   3.2 |  6.26
Comm    | 7.4909     | 9.248      | 10.848     |  38.6 |  9.29
Output  | 0.00087992 | 0.0011031  | 0.0024396  |   1.5 |  0.00
Modify  | 8.6439     | 8.7879     | 8.9986     |   3.1 |  8.83
Other   |            | 0.377      |            |       |  0.38

Nlocal:          43.75 ave          50 max          37 min
Histogram: 2 0 0 1 0 1 1 1 1 1
Nghost:           3170 ave        3226 max        3086 min
Histogram: 1 0 0 0 2 1 1 0 0 3
Neighs:        28520.5 ave       32136 max       24576 min
Histogram: 2 0 0 1 0 1 1 1 1 1

Total # of neighbors = 228164
Ave neighs/atom = 651.89714
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 0.306276963205875
variable C2neg equal ${d2}
variable C2neg equal -0.561796536851376
variable C3neg equal ${d3}
variable C3neg equal 14.3346519076937
variable C4neg equal ${d4}
variable C4neg equal -17.2830410631128
variable C5neg equal ${d5}
variable C5neg equal 42.7206871270045
variable C6neg equal ${d6}
variable C6neg equal 7.85976772375726

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.0085
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.170085 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.278115 -0.642)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.3 | 124.6 | 126.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.18527     -41139.024     -9501.6989      0              3758.8201    
       100   304.67743     -41158.634      999.20777     -5649.0116      3758.8201    
       200   279.0602      -41151.655      5233.4293     -2132.6043      3758.8201    
       300   262.33119     -41136.49      -1848.9915     -754.37048      3758.8201    
       400   307.35437     -41162.782     -907.2829      -3184.6858      3758.8201    
       500   326.72101     -41155.018      7660.1601      404.20556      3758.8201    
       600   315.71873     -41145.018      13495.002     -3740.2808      3758.8201    
       700   289.01543     -41147.851     -8762.3906      2563.9007      3758.8201    
       800   290.23078     -41176.483     -717.70558     -4041.726       3758.8201    
       900   286.39415     -41177.712     -6832.0688     -1296.1083      3758.8201    
      1000   286.16581     -41159.151      6131.452       1719.9738      3758.8201    
      1100   323.94567     -41162.111     -6275.9089     -4238.9384      3758.8201    
      1200   308.13544     -41134.379     -1466.6718     -8736.407       3758.8201    
      1300   328.61029     -41176.291      20272.112     -437.44974      3758.8201    
      1400   303.31629     -41181.221      5796.1352      1685.6458      3758.8201    
      1500   285.26115     -41177.155      2665.38       -781.63826      3758.8201    
      1600   304.81974     -41184.823     -1570.6043     -807.98636      3758.8201    
      1700   307.95355     -41157.72       3186.9726      626.23917      3758.8201    
      1800   292.78204     -41124.824     -2539.3272     -1582.1437      3758.8201    
      1900   305.37986     -41141.028      5912.9456     -3756.9348      3758.8201    
      2000   303.42866     -41161.769      205.87174     -2875.9404      3758.8201    
Loop time of 99.2386 on 16 procs for 2000 steps with 350 atoms

Performance: 0.871 ns/day, 27.566 hours/ns, 20.153 timesteps/s, 7.054 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 72.192     | 75.736     | 77.626     |  17.6 | 76.32
Bond    | 0.00070202 | 0.0008215  | 0.0010044  |   0.0 |  0.00
Neigh   | 6.0817     | 6.2521     | 6.4039     |   4.4 |  6.30
Comm    | 6.2404     | 8.1183     | 11.632     |  53.6 |  8.18
Output  | 0.0058824  | 0.0087531  | 0.010236   |   1.8 |  0.01
Modify  | 8.6618     | 8.8007     | 8.9409     |   3.5 |  8.87
Other   |            | 0.3224     |            |       |  0.32

Nlocal:          43.75 ave          54 max          30 min
Histogram: 1 0 0 0 3 0 0 3 0 1
Nghost:        3172.75 ave        3197 max        3136 min
Histogram: 1 1 0 1 0 0 0 1 3 1
Neighs:        28480.2 ave       34766 max       20009 min
Histogram: 1 0 0 0 3 0 0 2 1 1

Total # of neighbors = 227842
Ave neighs/atom = 650.97714
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.3 | 124.5 | 126.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   303.42866     -41161.769      205.8834       0              3758.8201    
       100   289.68136     -41150.598     -2316.8811     -3358.9475      3758.8201    
       200   303.83283     -41157.292     -5624.3852     -1382.1854      3758.8201    
       300   306.09444     -41137.65       6793.4512      162.85731      3758.8201    
       400   324.22652     -41151.855      58.688928     -2061.8666      3758.8201    
       500   300.96243     -41155.64       8174.198      -370.36207      3758.8201    
       600   292.22054     -41165.342     -563.71933     -6074.4491      3758.8201    
       700   292.51545     -41165.589      5517.1912     -38.250142      3758.8201    
       800   300.31098     -41169.385      7568.3819     -5515.6564      3758.8201    
       900   300.9884      -41156.216      6944.8864     -843.91128      3758.8201    
      1000   308.32404     -41140.237      3832.5099      1275.9903      3758.8201    
      1100   315.67367     -41167.05       1162.4816     -4998.7658      3758.8201    
      1200   281.73126     -41152.497     -12369.876     -8320.6605      3758.8201    
      1300   296.79252     -41174.254     -2297.276      -2361.8481      3758.8201    
      1400   303.92714     -41174.17       7319.9408     -370.76621      3758.8201    
      1500   316.34716     -41157.66       5897.6171     -6363.4697      3758.8201    
      1600   301.21755     -41128.864      8995.5356     -1988.793       3758.8201    
      1700   331.9346      -41178.908     -7754.8658     -2462.5118      3758.8201    
      1800   307.81494     -41184.498     -5916.1292     -1773.9055      3758.8201    
      1900   306.2381      -41187.946     -6968.5919      927.41593      3758.8201    
      2000   291.8478      -41173.762     -3769.6324     -1530.7549      3758.8201    
Loop time of 99.9664 on 16 procs for 2000 steps with 350 atoms

Performance: 0.864 ns/day, 27.768 hours/ns, 20.007 timesteps/s, 7.002 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 73.553     | 75.868     | 78.031     |  17.1 | 75.89
Bond    | 0.00071032 | 0.00082295 | 0.0010106  |   0.0 |  0.00
Neigh   | 6.1638     | 6.3418     | 6.498      |   4.3 |  6.34
Comm    | 6.481      | 8.5774     | 10.918     |  51.2 |  8.58
Output  | 0.00094276 | 0.0012995  | 0.0035751  |   2.4 |  0.00
Modify  | 8.5925     | 8.7819     | 9.0538     |   4.9 |  8.78
Other   |            | 0.3948     |            |       |  0.39

Nlocal:          43.75 ave          51 max          37 min
Histogram: 2 1 0 0 0 1 2 0 1 1
Nghost:         3179.5 ave        3218 max        3152 min
Histogram: 2 1 0 0 2 1 0 1 0 1
Neighs:        28529.1 ave       32897 max       24518 min
Histogram: 2 1 0 0 1 0 2 0 1 1

Total # of neighbors = 228233
Ave neighs/atom = 652.09429
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -53.0571371796291
variable C2pos equal ${d2}
variable C2pos equal -34.0631684088375
variable C3pos equal ${d3}
variable C3pos equal -51.4519831160851
variable C4pos equal ${d4}
variable C4pos equal 4.20682955650364
variable C5pos equal ${d5}
variable C5pos equal 9.8114744838153
variable C6pos equal ${d6}
variable C6pos equal -10.4753173775788

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(0.306276963205875+${C1pos})
variable C15 equal 0.5*(0.306276963205875+-53.0571371796291)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-0.561796536851376+${C2pos})
variable C25 equal 0.5*(-0.561796536851376+-34.0631684088375)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(14.3346519076937+${C3pos})
variable C35 equal 0.5*(14.3346519076937+-51.4519831160851)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-17.2830410631128+${C4pos})
variable C45 equal 0.5*(-17.2830410631128+4.20682955650364)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(42.7206871270045+${C5pos})
variable C55 equal 0.5*(42.7206871270045+9.8114744838153)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(7.85976772375726+${C6pos})
variable C65 equal 0.5*(7.85976772375726+-10.4753173775788)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 14.5028

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.5028
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.145028 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.407728 -0.4482 -0.642)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.8 | 124.8 | 126.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.18527     -41142.925     -6940.133       0              3758.8201    
       100   297.83163     -41153.433      3409.1824     -5140.0557      3758.8201    
       200   278.96149     -41148.439      3765.5295     -1170.3881      3758.8201    
       300   299.0784      -41171.981     -3985.5185     -915.45745      3758.8201    
       400   297.14935     -41157.552     -1391.2369     -995.76893      3758.8201    
       500   310.2079      -41151.797      1140.5292      2365.3884      3758.8201    
       600   307.52169     -41144.716     -865.48454     -3175.3298      3758.8201    
       700   294.88035     -41145.202     -422.43274      2130.6721      3758.8201    
       800   291.05025     -41156.765     -5630.8153     -6193.3177      3758.8201    
       900   296.30547     -41169.613     -1846.0091     -8600.7857      3758.8201    
      1000   275.1209      -41141.841      5446.8033      3402.6788      3758.8201    
      1100   292.80293     -41137.839     -13370.876     -2156.6972      3758.8201    
      1200   314.10288     -41148.868     -66.258382     -5131.8357      3758.8201    
      1300   283.66483     -41125.778     -2443.2056     -5904.9876      3758.8201    
      1400   303.75089     -41160.336     -8418.4069     -1896.0983      3758.8201    
      1500   311.56352     -41182.493      6924.7725     -2068.5328      3758.8201    
      1600   293.52669     -41164.824     -1194.6915      5613.7411      3758.8201    
      1700   292.65076     -41150.481     -4814.8069     -2946.4476      3758.8201    
      1800   310.66893     -41155.549      1899.3741      1209.8266      3758.8201    
      1900   289.40891     -41128.586      6554.3576     -3404.6868      3758.8201    
      2000   293.75244     -41143.498      2321.9217     -3606.2503      3758.8201    
Loop time of 99.8984 on 16 procs for 2000 steps with 350 atoms

Performance: 0.865 ns/day, 27.750 hours/ns, 20.020 timesteps/s, 7.007 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 73.593     | 75.747     | 77.05      |  14.7 | 75.82
Bond    | 0.00067673 | 0.00080782 | 0.0010541  |   0.0 |  0.00
Neigh   | 6.1188     | 6.3446     | 6.5107     |   4.7 |  6.35
Comm    | 7.2772     | 8.5453     | 10.72      |  43.2 |  8.55
Output  | 0.0062676  | 0.010097   | 0.011917   |   2.2 |  0.01
Modify  | 8.7447     | 8.8829     | 9.1684     |   4.6 |  8.89
Other   |            | 0.3679     |            |       |  0.37

Nlocal:          43.75 ave          51 max          36 min
Histogram: 2 0 0 1 1 0 1 1 1 1
Nghost:        3187.75 ave        3233 max        3122 min
Histogram: 1 0 0 1 1 1 1 0 1 2
Neighs:        28510.5 ave       32822 max       23814 min
Histogram: 2 0 0 1 1 0 1 1 1 1

Total # of neighbors = 228084
Ave neighs/atom = 651.66857
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.8 | 124.9 | 127.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   293.75244     -41143.498      2321.9279      0              3758.8201    
       100   307.13211     -41162.78       1468.8649     -7491.367       3758.8201    
       200   287.52086     -41166.35       4027.758      -5640.7051      3758.8201    
       300   277.88704     -41182.861      1070.0399     -4553.6186      3758.8201    
       400   287.66635     -41186.024     -9883.2508     -804.32384      3758.8201    
       500   309.56509     -41189.234      8424.5771     -7844.9239      3758.8201    
       600   275.74561     -41149.691     -2325.4046     -3287.3767      3758.8201    
       700   306.41864     -41170.293     -4326.8288     -5715.6243      3758.8201    
       800   302.58898     -41174.752      13173.714     -1494.6608      3758.8201    
       900   282.19413     -41185.004     -15042.552     -1116.0108      3758.8201    
      1000   290.80996     -41198.859     -2606.4504     -2492.1997      3758.8201    
      1100   282.95357     -41172.566      1081.2168     -6791.065       3758.8201    
      1200   298.95333     -41174.923      21418.984      6348.1334      3758.8201    
      1300   305.27346     -41178.287      18732.36       1886.6355      3758.8201    
      1400   311.76277     -41186.072      2667.2521     -403.76153      3758.8201    
      1500   308.78189     -41179.272      5158.4518     -1061.5473      3758.8201    
      1600   304.46735     -41165.609     -10283.913     -6490.0603      3758.8201    
      1700   294.76196     -41140.492     -4203.9559     -6253.5137      3758.8201    
      1800   304.135       -41147.135      7733.8687     -7258.7655      3758.8201    
      1900   304.88504     -41174.25      -841.71261     -6690.3477      3758.8201    
      2000   288.98058     -41182.744      721.79623     -6255.7669      3758.8201    
Loop time of 100.61 on 16 procs for 2000 steps with 350 atoms

Performance: 0.859 ns/day, 27.947 hours/ns, 19.879 timesteps/s, 6.958 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 73.972     | 76.409     | 79.593     |  16.7 | 75.95
Bond    | 0.00069347 | 0.00081583 | 0.0010064  |   0.0 |  0.00
Neigh   | 6.1788     | 6.3295     | 6.4766     |   4.4 |  6.29
Comm    | 5.4238     | 8.608      | 10.971     |  49.4 |  8.56
Output  | 0.00094969 | 0.0011906  | 0.0024367  |   1.4 |  0.00
Modify  | 8.7408     | 8.903      | 9.0165     |   3.3 |  8.85
Other   |            | 0.3589     |            |       |  0.36

Nlocal:          43.75 ave          53 max          35 min
Histogram: 1 0 2 0 1 2 0 0 1 1
Nghost:           3196 ave        3237 max        3151 min
Histogram: 1 2 0 1 0 0 0 1 1 2
Neighs:        28521.9 ave       34078 max       23227 min
Histogram: 1 0 2 0 1 2 0 0 1 1

Total # of neighbors = 228175
Ave neighs/atom = 651.92857
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 5.18095259524055
variable C2neg equal ${d2}
variable C2neg equal 42.4689714689317
variable C3neg equal ${d3}
variable C3neg equal 53.3215188218769
variable C4neg equal ${d4}
variable C4neg equal -1.3783741035326
variable C5neg equal ${d5}
variable C5neg equal 3.70847498047628
variable C6neg equal ${d6}
variable C6neg equal -2.63470717760895

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.5028
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.145028 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.117672 -0.4482 -0.642)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.3 | 124.5 | 126.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.18527     -41142.113     -9172.9426      0              3758.8201    
       100   298.08612     -41152.411      1803.6254     -6035.0994      3758.8201    
       200   282.67467     -41152.778      4104.166      -1142.7993      3758.8201    
       300   278.39828     -41147.709     -3091.9161     -76.607401      3758.8201    
       400   297.60224     -41147.666      7801.0111     -4442.5139      3758.8201    
       500   335.98228     -41165.446     -6923.1149     -3293.2182      3758.8201    
       600   320.24167     -41157.246      1149.1289     -3627.8909      3758.8201    
       700   291.31241     -41160.96       4.4838695     -3530.7766      3758.8201    
       800   284.57028     -41179.219     -10978.447     -6098.2646      3758.8201    
       900   289.55919     -41186.85      -12304.67      -5735.7074      3758.8201    
      1000   288.26491     -41156.97      -12196.184     -3395.4877      3758.8201    
      1100   308.14468     -41145.972     -9340.4995     -6852.6675      3758.8201    
      1200   315.94419     -41149.834     -15873.267     -8828.282       3758.8201    
      1300   295.79393     -41152.5       -15686.089     -5572.5799      3758.8201    
      1400   283.46817     -41157.816     -1040.5897     -5856.7817      3758.8201    
      1500   288.38509     -41169.768      2708.6671     -4916.8692      3758.8201    
      1600   286.10456     -41165.67       2668.1684     -4872.0882      3758.8201    
      1700   295.08822     -41158.363      9613.4007     -2625.536       3758.8201    
      1800   311.26446     -41156.195     -4891.0064     -3818.3116      3758.8201    
      1900   305.59727     -41151.512      565.60147     -5093.193       3758.8201    
      2000   294.14244     -41154.483     -8263.578      -4868.421       3758.8201    
Loop time of 92.6341 on 16 procs for 2000 steps with 350 atoms

Performance: 0.933 ns/day, 25.732 hours/ns, 21.590 timesteps/s, 7.557 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.147     | 64.959     | 76.343     | 124.1 | 70.12
Bond    | 0.00058632 | 0.0007472  | 0.00092599 |   0.0 |  0.00
Neigh   | 4.8609     | 5.6591     | 6.4986     |  31.7 |  6.11
Comm    | 1.5552     | 12.951     | 23.737     | 278.4 | 13.98
Output  | 0.0039024  | 0.0058726  | 0.0069168  |   1.5 |  0.01
Modify  | 8.0963     | 8.9332     | 9.7396     |  25.5 |  9.64
Other   |            | 0.1247     |            |       |  0.13

Nlocal:          43.75 ave          51 max          37 min
Histogram: 1 1 2 0 1 0 0 1 0 2
Nghost:        3160.62 ave        3205 max        3094 min
Histogram: 1 0 0 2 1 0 0 1 0 3
Neighs:        28488.4 ave       32984 max       24535 min
Histogram: 1 1 2 0 1 0 0 1 0 2

Total # of neighbors = 227907
Ave neighs/atom = 651.16286
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.4 | 124.4 | 126.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.14244     -41154.483     -8263.5982      0              3758.8201    
       100   312.31286     -41171.654     -4188.8899     -3809.9717      3758.8201    
       200   298.73651     -41147.918     -13649.957     -5789.0932      3758.8201    
       300   322.08577     -41144.827      12460.001     -3597.2772      3758.8201    
       400   314.39052     -41146.711      12289.293     -397.29245      3758.8201    
       500   301.13073     -41166.482      11169.926     -5444.3941      3758.8201    
       600   301.02977     -41175.803     -4594.6591     -6454.1138      3758.8201    
       700   283.17627     -41154.251     -10677.679      1426.018       3758.8201    
       800   301.35837     -41150.044     -13739.67      -11223.575      3758.8201    
       900   288.86996     -41125.748     -13667.943     -6686.8211      3758.8201    
      1000   303.37796     -41158.451     -5794.0163     -4270.466       3758.8201    
      1100   306.35145     -41188.856     -6231.1435     -5968.9657      3758.8201    
      1200   281.6242      -41206.952     -8605.4928     -1370.2755      3758.8201    
      1300   257.6122      -41189.477     -17647.706     -12618.107      3758.8201    
      1400   289.03653     -41190.416      3920.003      -4908.2538      3758.8201    
      1500   305.57122     -41181.466     -4448.7667     -2402.3929      3758.8201    
      1600   301.99179     -41160.047     -13335.906     -7366.2927      3758.8201    
      1700   311.97721     -41161.879     -3015.6211     -6021.3389      3758.8201    
      1800   293.67779     -41164.304     -12304.09      -6297.4579      3758.8201    
      1900   296.01859     -41183.679     -6338.4613     -3986.6053      3758.8201    
      2000   292.69972     -41173.16      -4322.3531     -2020.3679      3758.8201    
Loop time of 91.5883 on 16 procs for 2000 steps with 350 atoms

Performance: 0.943 ns/day, 25.441 hours/ns, 21.837 timesteps/s, 7.643 katom-step/s
99.6% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 50.397     | 64.34      | 75.932     | 135.3 | 70.25
Bond    | 0.00056294 | 0.00073025 | 0.00092142 |   0.0 |  0.00
Neigh   | 4.6536     | 5.6684     | 6.5403     |  33.0 |  6.19
Comm    | 1.2951     | 12.891     | 26.844     | 302.2 | 14.08
Output  | 0.00077619 | 0.00091062 | 0.001238   |   0.0 |  0.00
Modify  | 7.7685     | 8.6458     | 9.6564     |  26.8 |  9.44
Other   |            | 0.04131    |            |       |  0.05

Nlocal:          43.75 ave          52 max          36 min
Histogram: 1 1 1 0 1 1 1 0 0 2
Nghost:        3155.88 ave        3208 max        3104 min
Histogram: 1 0 1 1 1 0 2 1 0 1
Neighs:        28505.8 ave       33430 max       23939 min
Histogram: 1 1 1 0 2 0 1 0 0 2

Total # of neighbors = 228046
Ave neighs/atom = 651.56
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -48.096133143661
variable C2pos equal ${d2}
variable C2pos equal -0.423317443699822
variable C3pos equal ${d3}
variable C3pos equal -81.7756658401075
variable C4pos equal ${d4}
variable C4pos equal -0.691044777212095
variable C5pos equal ${d5}
variable C5pos equal -3.9128344821562
variable C6pos equal ${d6}
variable C6pos equal 29.7137438237466

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(5.18095259524055+${C1pos})
variable C16 equal 0.5*(5.18095259524055+-48.096133143661)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(42.4689714689317+${C2pos})
variable C26 equal 0.5*(42.4689714689317+-0.423317443699822)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(53.3215188218769+${C3pos})
variable C36 equal 0.5*(53.3215188218769+-81.7756658401075)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-1.3783741035326+${C4pos})
variable C46 equal 0.5*(-1.3783741035326+-0.691044777212095)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(3.70847498047628+${C5pos})
variable C56 equal 0.5*(3.70847498047628+-3.9128344821562)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(-2.63470717760895+${C6pos})
variable C66 equal 0.5*(-2.63470717760895+29.7137438237466)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 7.55332288783447
variable C22all equal ${C22}
variable C22all equal 103.04320947802
variable C33all equal ${C33}
variable C33all equal 43.763585761824

variable C44all equal ${C44}
variable C44all equal 20.9213591826896
variable C55all equal ${C55}
variable C55all equal 26.2660808054099
variable C66all equal ${C66}
variable C66all equal 13.5395183230688

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(12.3647927253848+${C21})
variable C12all equal 0.5*(12.3647927253848+21.3821379480037)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(11.3797764254586+${C31})
variable C13all equal 0.5*(11.3797764254586+37.5941284598972)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(34.5838453980593+${C32})
variable C23all equal 0.5*(34.5838453980593+14.6781458649463)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(33.6098742213753+${C41})
variable C14all equal 0.5*(33.6098742213753+4.18424246796995)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-26.3754301082116+${C51})
variable C15all equal 0.5*(-26.3754301082116+2.42986876753955)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-21.4575902742102+${C61})
variable C16all equal 0.5*(-21.4575902742102+9.5897247608721)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(19.6798517153973+${C42})
variable C24all equal 0.5*(19.6798517153973+3.11337079795305)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-17.3124824728444+${C52})
variable C25all equal 0.5*(-17.3124824728444+-10.9249183902345)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(21.0228270126159+${C62})
variable C26all equal 0.5*(21.0228270126159+-2.21892669238909)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(-26.0486643449986+${C43})
variable C34all equal 0.5*(-26.0486643449986+0.80622489511298)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-18.5586656041957+${C53})
variable C35all equal 0.5*(-18.5586656041957+-10.7008728792366)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-14.2270735091153+${C63})
variable C36all equal 0.5*(-14.2270735091153+-0.1082980933411)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-6.53810575330458+${C54})
variable C45all equal 0.5*(-6.53810575330458+2.06733070217028)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-1.03470944037235+${C64})
variable C46all equal 0.5*(-1.03470944037235+5.21227331556706)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-0.10217975083996+${C65})
variable C56all equal 0.5*(-0.10217975083996+-1.30777482691077)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:41:18
