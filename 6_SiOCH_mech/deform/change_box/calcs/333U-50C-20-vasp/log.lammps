LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 30*${nthermo}       # steps of equilibration run 20
variable nequil equal 30*100       
variable nrun equal 30*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 30*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-20-vasp
read_data       ${structure}.data
read_data       333U-50C-20-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.007 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 5.69557e-05 on 8 procs for 1 steps with 350 atoms

43.7% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.816e-06  | 1.816e-06  | 1.816e-06  |   0.0 |  3.19
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 3.98e-06   | 4.7141e-06 | 4.819e-06  |   0.0 |  8.28
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 5.043e-05  |            |       | 88.53

Nlocal:          43.75 ave          50 max          39 min
Histogram: 2 0 1 0 2 0 2 0 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-20-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 3000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -10.66 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.2 | 123.4 | 124.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -39436.432      138394.29      0              1.7278661      3758.8201    
       100   727.72694     -40293.204     -25486.886      6532.2367      1.7278661      3758.8201    
       200   598.70825     -40608.063     -20042.47       1920.7482      1.7278661      3758.8201    
       300   448.08153     -40775.317     -8719.4702      5194.0619      1.7278661      3758.8201    
       400   368.07576     -40916.064      12042.815      816.38633      1.7278661      3758.8201    
       500   323.74279     -41017.02       5264.1982      4572.6571      1.7278661      3758.8201    
       600   292.42643     -41079.333     -9613.6408     -200.92689      1.7278661      3758.8201    
       700   280.08727     -41117.333     -3802.0268     -656.1761       1.7278661      3758.8201    
       800   268.90731     -41110.232     -13437.613     -7560.4078      1.7278661      3758.8201    
       900   319.17604     -41127.933     -3878.1757     -1704.5318      1.7278661      3758.8201    
      1000   313.85132     -41097.112     -12021.215     -7683.7002      1.7278661      3758.8201    
      1100   297.80969     -41081.579      591.86918     -3268.2056      1.7278661      3758.8201    
      1200   306.37949     -41113.974     -11363.523     -5414.8684      1.7278661      3758.8201    
      1300   289.63524     -41124.704     -20535.279     -7326.7216      1.7278661      3758.8201    
      1400   304.07464     -41146.229     -7746.2702     -7346.3146      1.7278661      3758.8201    
      1500   306.29072     -41133.388     -2623.9505     -1977.5646      1.7278661      3758.8201    
      1600   311.25329     -41114.363     -13340.379     -4875.9457      1.7278661      3758.8201    
      1700   332.68075     -41130.152     -10184.373     -6521.5712      1.7278661      3758.8201    
      1800   314.58786     -41139.559     -8919.2577     -4903.7089      1.7278661      3758.8201    
      1900   279.07015     -41133.25      -1530.5775     -5532.4089      1.7278661      3758.8201    
      2000   280.41135     -41139.933     -9024.6146     -4936.2673      1.7278661      3758.8201    
      2100   303.63133     -41142.077     -4542.2177     -7465.9252      1.7278661      3758.8201    
      2200   317.77941     -41133.579     -10072.475     -9741.1357      1.7278661      3758.8201    
      2300   306.53749     -41119.342      2072.9476     -7018.2357      1.7278661      3758.8201    
      2400   305.02057     -41135.935     -1116.6651     -5815.9149      1.7278661      3758.8201    
      2500   300.58531     -41152.233     -6429.0853     -11002.143      1.7278661      3758.8201    
      2600   286.38545     -41144.478      1213.3547     -5905.156       1.7278661      3758.8201    
      2700   288.34425     -41134.461     -7970.2447     -8362.7887      1.7278661      3758.8201    
      2800   314.78606     -41141.832      107.37236     -7530.585       1.7278661      3758.8201    
      2900   303.64746     -41134.267     -2626.4138     -6162.3391      1.7278661      3758.8201    
      3000   289.07373     -41130.871     -12463.225     -5362.2492      1.7278661      3758.8201    
Loop time of 146.891 on 8 procs for 3000 steps with 350 atoms

Performance: 0.882 ns/day, 27.202 hours/ns, 20.423 timesteps/s, 7.148 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 92.42      | 117.6      | 122.9      |  88.8 | 80.06
Bond    | 0.0084154  | 0.0093646  | 0.010752   |   0.7 |  0.01
Neigh   | 7.6423     | 9.4853     | 9.9367     |  23.0 |  6.46
Comm    | 2.222      | 7.522      | 32.698     | 351.1 |  5.12
Output  | 0.0016534  | 0.0017823  | 0.002518   |   0.7 |  0.00
Modify  | 11.735     | 12.193     | 14.048     |  20.4 |  8.30
Other   |            | 0.07643    |            |       |  0.05

Nlocal:          43.75 ave          55 max          34 min
Histogram: 1 1 0 1 1 2 1 0 0 1
Nghost:        3165.38 ave        3218 max        3114 min
Histogram: 2 1 0 1 0 0 0 2 1 1
Neighs:        28504.1 ave       35381 max       22460 min
Histogram: 1 0 1 1 1 2 1 0 0 1

Total # of neighbors = 228033
Ave neighs/atom = 651.52286
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-20-vasp_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.2382
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 14.5028
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.0085

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--5362.24919068485)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--5362.24919068485)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--3877.23136323408)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--3877.23136323408)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--13240.0898857392)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--13240.0898857392)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-234.3252762861)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-234.3252762861)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--185.71152865627)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--185.71152865627)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-782.27568288015)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-782.27568288015)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 15.2382
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.2382
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.152382 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.152382 xy delta 0.062627 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.152382 xy delta 0.062627 xz delta 0.004482 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.085818 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  triclinic box = (0 0 0) to (15.085818 14.5028 17.0085) with tilt (-6.200073 -0.4482 -0.642)
  triclinic box = (0 0 0) to (15.085818 14.5028 17.0085) with tilt (-6.200073 -0.443718 -0.642)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.4 | 124.3 | 126.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.07373     -41116.281      44369.14       0              3721.2319    
       100   296.33196     -41124.068     -388.8373       1149.687       3721.2319    
       200   305.11355     -41134.19      -573.54973      3608.3339      3721.2319    
       300   284.83142     -41128.293     -7173.8943      1817.8431      3721.2319    
       400   285.38218     -41150.515     -14521.011     -1534.1165      3721.2319    
       500   299.72737     -41161.54      -6992.2624     -1561.0968      3721.2319    
       600   285.81061     -41133.808      8432.8456      8835.5031      3721.2319    
       700   305.21058     -41135.431      1379.1726      172.74963      3721.2319    
       800   325.32464     -41145.064     -468.47138      220.3034       3721.2319    
       900   300.05196     -41134.678     -5435.9955     -442.18245      3721.2319    
      1000   281.96062     -41134.759     -658.91443      1551.4009      3721.2319    
      1100   305.47791     -41161.08      -4121.5011     -2911.9322      3721.2319    
      1200   307.41388     -41149.732     -9376.1371     -3603.8913      3721.2319    
      1300   325.24719     -41153.081     -1099.4367      1383.6648      3721.2319    
      1400   322.45481     -41162.206     -1749.1399     -5246.9378      3721.2319    
      1500   293.09843     -41157.09       8676.9345      146.6281       3721.2319    
      1600   313.37072     -41188.684     -4008.262      -7228.7362      3721.2319    
      1700   281.04791     -41153.016      6250.4384     -92.808437      3721.2319    
      1800   301.61468     -41164.723     -12223.129     -1295.3326      3721.2319    
      1900   296.97886     -41154.291     -14096.194     -1288.5245      3721.2319    
      2000   315.8648      -41173.687     -14312.229     -6155.0636      3721.2319    
      2100   299.97475     -41160.205     -2750.6194     -6750.5266      3721.2319    
      2200   299.10623     -41168.261     -11104.302     -6864.0541      3721.2319    
      2300   285.01992     -41171.029     -12115.02      -5605.5442      3721.2319    
      2400   295.67513     -41192.731     -13992.873     -7408.8952      3721.2319    
      2500   294.03151     -41185.283     -5276.3438     -5701.8139      3721.2319    
      2600   327.94449     -41192.602      5499.9879     -3869.0905      3721.2319    
      2700   310.98053     -41157.329      2470.2504     -3812.2426      3721.2319    
      2800   286.97617     -41137.136     -6311.743      -3111.5405      3721.2319    
      2900   299.64742     -41181.294     -14550.568      799.99665      3721.2319    
      3000   282.39938     -41180.183     -24762.754     -7418.4424      3721.2319    
Loop time of 150.544 on 8 procs for 3000 steps with 350 atoms

Performance: 0.861 ns/day, 27.879 hours/ns, 19.928 timesteps/s, 6.975 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 84.269     | 117.15     | 126.98     | 121.2 | 77.82
Bond    | 0.0086451  | 0.0092496  | 0.010277   |   0.5 |  0.01
Neigh   | 6.9726     | 9.3648     | 10.081     |  32.1 |  6.22
Comm    | 1.6037     | 11.429     | 44.3       | 387.7 |  7.59
Output  | 0.0074187  | 0.0091477  | 0.010511   |   1.1 |  0.01
Modify  | 11.78      | 12.505     | 14.917     |  28.1 |  8.31
Other   |            | 0.07299    |            |       |  0.05

Nlocal:          43.75 ave          54 max          35 min
Histogram: 1 0 1 1 2 0 2 0 0 1
Nghost:        3201.25 ave        3268 max        3152 min
Histogram: 2 0 1 1 0 1 2 0 0 1
Neighs:          28795 ave       35077 max       23420 min
Histogram: 1 0 2 0 2 0 2 0 0 1

Total # of neighbors = 230360
Ave neighs/atom = 658.17143
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.4 | 124.5 | 126.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   282.39938     -41180.183     -24762.679      0              3721.2319    
       100   302.39056     -41193.158     -4216.9546      862.10823      3721.2319    
       200   325.5672      -41181.029     -9887.4302     -3226.0829      3721.2319    
       300   297.01505     -41144.756      1320.4154     -4967.0652      3721.2319    
       400   312.96885     -41167.757     -13339.344     -6983.9898      3721.2319    
       500   289.77738     -41169.648     -3828.448       2667.3955      3721.2319    
       600   275.07453     -41153.94      -14853.98      -3571.9808      3721.2319    
       700   293.04712     -41148.377     -315.76259      1883.5165      3721.2319    
       800   302.97939     -41154.076     -5760.1798     -6792.6798      3721.2319    
       900   306.05906     -41163.896     -22904.807     -7311.2887      3721.2319    
      1000   295.64255     -41169.062      6116.7932     -2276.6791      3721.2319    
      1100   309.19118     -41192.36       3627.5877     -6327.3126      3721.2319    
      1200   298.37571     -41182.8       -2524.454      -4205.2484      3721.2319    
      1300   297.2301      -41157.154     -20867.021     -4825.1106      3721.2319    
      1400   290.15258     -41127.253     -7759.1686     -252.31488      3721.2319    
      1500   296.93113     -41129.79      -5459.0406     -3787.8369      3721.2319    
      1600   301.91726     -41167.628      2884.8476      553.35797      3721.2319    
      1700   293.9956      -41172.819      7042.9258     -7271.3948      3721.2319    
      1800   298.99686     -41170.529     -2677.5052     -5462.2526      3721.2319    
      1900   311.96173     -41174.154     -8528.6122     -15579.036      3721.2319    
      2000   312.32726     -41170.61       682.15305     -9725.6491      3721.2319    
      2100   300.77826     -41149.927     -13588.545     -8824.3113      3721.2319    
      2200   300.77328     -41145.621      1549.1309     -11275.804      3721.2319    
      2300   297.11216     -41159.169     -9571.7516     -8690.6687      3721.2319    
      2400   295.03409     -41184.7       -4853.5016     -11773.99       3721.2319    
      2500   280.62063     -41174.854     -11092.957      263.82504      3721.2319    
      2600   308.77346     -41188.002     -5806.1881     -3210.7532      3721.2319    
      2700   297.86161     -41169.352     -18741.806     -3067.5189      3721.2319    
      2800   292.39056     -41158.067     -5089.4117      446.47238      3721.2319    
      2900   308.87732     -41167.581      489.85906     -12020.965      3721.2319    
      3000   312.16055     -41182.212     -6761.3502     -2456.9311      3721.2319    
Loop time of 151.152 on 8 procs for 3000 steps with 350 atoms

Performance: 0.857 ns/day, 27.991 hours/ns, 19.848 timesteps/s, 6.947 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 102.69     | 121.02     | 127.12     |  68.3 | 80.06
Bond    | 0.0087036  | 0.0093591  | 0.010312   |   0.6 |  0.01
Neigh   | 8.3524     | 9.6635     | 10.122     |  18.7 |  6.39
Comm    | 1.9955     | 8.0981     | 26.414     | 263.9 |  5.36
Output  | 0.0013873  | 0.0017439  | 0.0035699  |   1.7 |  0.00
Modify  | 11.825     | 12.29      | 13.615     |  16.8 |  8.13
Other   |            | 0.07415    |            |       |  0.05

Nlocal:          43.75 ave          55 max          34 min
Histogram: 1 1 1 1 0 1 1 0 1 1
Nghost:        3213.25 ave        3276 max        3163 min
Histogram: 2 1 0 1 0 1 1 0 1 1
Neighs:        28779.4 ave       35715 max       22670 min
Histogram: 1 1 1 1 0 1 1 0 1 1

Total # of neighbors = 230235
Ave neighs/atom = 657.81429
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 29.438135274689
variable C2neg equal ${d2}
variable C2neg equal -4.98070066904417
variable C3neg equal ${d3}
variable C3neg equal 79.3675863545983
variable C4neg equal ${d4}
variable C4neg equal -11.2646029695456
variable C5neg equal ${d5}
variable C5neg equal 4.77266480325764
variable C6neg equal ${d6}
variable C6neg equal 8.29077712234899

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.2382
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.152382 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.152382 xy delta -0.062627 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.152382 xy delta -0.062627 xz delta -0.004482 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.390582 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  triclinic box = (0 0 0) to (15.390582 14.5028 17.0085) with tilt (-6.325327 -0.4482 -0.642)
  triclinic box = (0 0 0) to (15.390582 14.5028 17.0085) with tilt (-6.325327 -0.452682 -0.642)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121 | 122.6 | 124.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.07373     -41106.207     -58884.242      0              3796.4083    
       100   305.97557     -41120.889     -10682.085     -15348.061      3796.4083    
       200   300.13076     -41111.965     -3283.6518     -7899.3851      3796.4083    
       300   283.09329     -41113.713     -8880.6275     -7493.7529      3796.4083    
       400   289.6404      -41144.91      -5485.8834     -12094.544      3796.4083    
       500   274.79056     -41128.368     -16797.121     -17541.502      3796.4083    
       600   298.03404     -41131.468     -3368.9519     -4847.274       3796.4083    
       700   297.56252     -41107.875     -22298.004     -8742.3971      3796.4083    
       800   312.34242     -41116.038     -12317.422     -9390.9884      3796.4083    
       900   306.52422     -41127.395     -7644.9369     -9087.857       3796.4083    
      1000   289.5949      -41140.143     -9284.6779     -13863.75       3796.4083    
      1100   294.22602     -41159.159     -14515.889     -14303.885      3796.4083    
      1200   297.3043      -41159.743     -22245.332     -14074.2        3796.4083    
      1300   293.33389     -41140.852     -11801.705     -9701.9842      3796.4083    
      1400   323.31156     -41144.311     -16735.141     -12887          3796.4083    
      1500   314.28845     -41128.547     -8810.3193     -15165.567      3796.4083    
      1600   291.21788     -41116.53      -16439.362     -11121.712      3796.4083    
      1700   289.51416     -41135.548     -8210.3666     -9637.9079      3796.4083    
      1800   282.31302     -41141.83       1950.4329     -9196.6199      3796.4083    
      1900   289.1506      -41144.814      2781.9161     -12908.218      3796.4083    
      2000   308.26893     -41142.252     -3118.6775     -8933.8955      3796.4083    
      2100   304.16629     -41115.988     -6404.7338     -6181.7944      3796.4083    
      2200   311.90865     -41121.778     -7994.7014     -16811.787      3796.4083    
      2300   304.47488     -41156.784     -13542.726     -11326.109      3796.4083    
      2400   301.45123     -41155.526     -12039.023     -14611.987      3796.4083    
      2500   296.52474     -41132.576     -12315.208     -14250.95       3796.4083    
      2600   308.83325     -41120.823     -13714.541     -13408.719      3796.4083    
      2700   317.25528     -41117.376     -16864.459     -12418.196      3796.4083    
      2800   323.54372     -41137.728      4941.8744     -10236.758      3796.4083    
      2900   299.22623     -41146.892     -56.560029     -12742.3        3796.4083    
      3000   301.97981     -41147.417     -13550.535     -10767.193      3796.4083    
Loop time of 146.025 on 8 procs for 3000 steps with 350 atoms

Performance: 0.888 ns/day, 27.042 hours/ns, 20.544 timesteps/s, 7.191 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 85.977     | 114.48     | 122.83     | 108.6 | 78.40
Bond    | 0.008594   | 0.0093074  | 0.010396   |   0.5 |  0.01
Neigh   | 7.1921     | 9.3012     | 9.8941     |  27.2 |  6.37
Comm    | 1.6043     | 9.9645     | 38.455     | 368.1 |  6.82
Output  | 0.0069523  | 0.0091443  | 0.010565   |   1.4 |  0.01
Modify  | 11.581     | 12.185     | 14.315     |  24.0 |  8.34
Other   |            | 0.07467    |            |       |  0.05

Nlocal:          43.75 ave          55 max          38 min
Histogram: 3 1 0 1 1 0 0 1 0 1
Nghost:        3148.75 ave        3217 max        3087 min
Histogram: 1 1 0 2 0 0 3 0 0 1
Neighs:        28223.9 ave       35028 max       24943 min
Histogram: 3 1 0 2 0 0 1 0 0 1

Total # of neighbors = 225791
Ave neighs/atom = 645.11714
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.1 | 122.6 | 124.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   301.97981     -41147.417     -13550.565      0              3796.4083    
       100   319.865       -41156.237     -8585.1281     -9837.4447      3796.4083    
       200   300.57409     -41134.694     -3652.323      -14811.446      3796.4083    
       300   286.38514     -41138.58      -12038.212     -12614.276      3796.4083    
       400   291.17997     -41154.165     -5628.179      -12799.85       3796.4083    
       500   289.75949     -41130.952     -3912.0659     -14179.912      3796.4083    
       600   311.52619     -41132.034     -19399.344     -15288.909      3796.4083    
       700   299.57041     -41121.192     -5950.1142     -11922.918      3796.4083    
       800   291.47824     -41115.048     -5465.5524     -11303.164      3796.4083    
       900   290.89073     -41113.325     -14911.037     -11905.921      3796.4083    
      1000   301.6968      -41129.372     -12267.067     -4277.3569      3796.4083    
      1100   282.82241     -41123.004     -2780.5719     -3600.0987      3796.4083    
      1200   291.26123     -41137.245      3139.2933     -9541.5916      3796.4083    
      1300   301.12885     -41139.174     -2705.4413     -14248.995      3796.4083    
      1400   297.04097     -41118.187     -11004.561     -7433.3546      3796.4083    
      1500   314.41853     -41131.041     -5829.7771     -7002.7248      3796.4083    
      1600   291.88921     -41133.146     -12017.475     -9482.8659      3796.4083    
      1700   309.58329     -41171.489     -1677.4883     -10649.025      3796.4083    
      1800   314.5855      -41174.759     -6902.86       -8092.1767      3796.4083    
      1900   295.21549     -41144.849     -10744.022     -11505.272      3796.4083    
      2000   294.85843     -41114.036     -14453.731     -10731.761      3796.4083    
      2100   323.84267     -41121.896     -2822.9877     -10900.917      3796.4083    
      2200   305.20571     -41129.868     -7718.9641     -8115.7383      3796.4083    
      2300   306.53269     -41147.054     -23454.035     -9661.7286      3796.4083    
      2400   287.10788     -41137.19      -3772.632      -10683.258      3796.4083    
      2500   292.44184     -41145.469     -5176.0179     -8551.1917      3796.4083    
      2600   299.9029      -41149.851     -12639.678     -11405.998      3796.4083    
      2700   311.43581     -41153.951     -13678.176     -18036.289      3796.4083    
      2800   296.84206     -41158.343      5218.6799     -7034.2884      3796.4083    
      2900   286.54789     -41168.61      -814.71402     -6867.4957      3796.4083    
      3000   297.15276     -41169.667      2235.3991     -4329.6663      3796.4083    
Loop time of 147.152 on 8 procs for 3000 steps with 350 atoms

Performance: 0.881 ns/day, 27.250 hours/ns, 20.387 timesteps/s, 7.135 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 85.333     | 112.85     | 124.13     | 141.1 | 76.69
Bond    | 0.0084865  | 0.0092434  | 0.0098388  |   0.4 |  0.01
Neigh   | 7.0458     | 9.1433     | 9.9691     |  37.2 |  6.21
Comm    | 1.3944     | 12.679     | 40.194     | 420.8 |  8.62
Output  | 0.0013619  | 0.0015801  | 0.0027082  |   1.1 |  0.00
Modify  | 11.565     | 12.392     | 14.498     |  32.1 |  8.42
Other   |            | 0.07341    |            |       |  0.05

Nlocal:          43.75 ave          55 max          36 min
Histogram: 1 2 0 1 1 1 0 1 0 1
Nghost:        3155.25 ave        3224 max        3095 min
Histogram: 2 0 1 0 2 0 1 0 1 1
Neighs:        28209.2 ave       35014 max       23552 min
Histogram: 2 1 0 1 1 1 0 1 0 1

Total # of neighbors = 225674
Ave neighs/atom = 644.78286
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -10.4626465583758
variable C2pos equal ${d2}
variable C2pos equal 2.14195131219111
variable C3pos equal ${d3}
variable C3pos equal -85.466937119532
variable C4pos equal ${d4}
variable C4pos equal -13.1147157787717
variable C5pos equal ${d5}
variable C5pos equal -19.1498703155335
variable C6pos equal ${d6}
variable C6pos equal -1.67579919051124

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(29.438135274689+${C1pos})
variable C11 equal 0.5*(29.438135274689+-10.4626465583758)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(-4.98070066904417+${C2pos})
variable C21 equal 0.5*(-4.98070066904417+2.14195131219111)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(79.3675863545983+${C3pos})
variable C31 equal 0.5*(79.3675863545983+-85.466937119532)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-11.2646029695456+${C4pos})
variable C41 equal 0.5*(-11.2646029695456+-13.1147157787717)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(4.77266480325764+${C5pos})
variable C51 equal 0.5*(4.77266480325764+-19.1498703155335)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(8.29077712234899+${C6pos})
variable C61 equal 0.5*(8.29077712234899+-1.67579919051124)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 14.5028
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.5028
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.145028 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.145028 yz delta 0.00642 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.2382 14.357772 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  triclinic box = (0 0 0) to (15.2382 14.357772 17.0085) with tilt (-6.2627 -0.4482 -0.63558)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.3 | 124.7 | 126.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.07373     -41118.216      42383.847      0              3721.2319    
       100   304.78045     -41132.903     -2197.4958     -5057.9761      3721.2319    
       200   308.07624     -41137.616     -3999.4811     -2253.1755      3721.2319    
       300   292.67896     -41138.712     -19393.227     -3282.6293      3721.2319    
       400   274.85447     -41139.721     -6466.7544     -2141.1819      3721.2319    
       500   282.55691     -41140.872      1058.7458     -2716.42        3721.2319    
       600   300.90976     -41143.302      9759.1632      385.48098      3721.2319    
       700   297.08338     -41128.504     -8807.4946     -1528.2912      3721.2319    
       800   296.64373     -41118.865     -3481.3534     -6820.28        3721.2319    
       900   317.92066     -41148.509      481.82304     -3300.4796      3721.2319    
      1000   305.33386     -41153.965      10537.14      -136.47787      3721.2319    
      1100   279.06246     -41138.404     -13426.648     -5284.0016      3721.2319    
      1200   310.63868     -41165.429     -12284.646     -7447.4761      3721.2319    
      1300   289.60765     -41135.742     -4330.4089     -8455.044       3721.2319    
      1400   305.09784     -41146.887      1300.4018     -1747.1209      3721.2319    
      1500   292.96008     -41147.101      3169.6133     -7894.6299      3721.2319    
      1600   282.01032     -41153.003     -19629.837     -14030.01       3721.2319    
      1700   280.91065     -41158.82       2061.5609     -8876.2651      3721.2319    
      1800   286.17051     -41160.625     -9144.6385     -8294.9072      3721.2319    
      1900   291.17021     -41158.214     -11177.58      -12473.809      3721.2319    
      2000   304.20815     -41153.965      8108.8309     -7041.4883      3721.2319    
      2100   315.11311     -41149.29      -19789.184     -7694.2188      3721.2319    
      2200   302.50139     -41142.003     -5347.8775     -4568.8428      3721.2319    
      2300   278.86258     -41154.262     -8447.3739     -7786.5935      3721.2319    
      2400   294.5584      -41170.719     -3528.3677     -6758.2174      3721.2319    
      2500   296.52722     -41171.292      7007.0604     -5816.4558      3721.2319    
      2600   294.69134     -41169.025     -1771.5399     -5806.7295      3721.2319    
      2700   298.82052     -41146.923     -8924.1986     -9897.3436      3721.2319    
      2800   306.53388     -41136.419     -2386.687      -10936.75       3721.2319    
      2900   310.84421     -41159.74      -6190.1062     -4208.2745      3721.2319    
      3000   304.40225     -41175.92      -8417.8636     -9249.1045      3721.2319    
Loop time of 150.902 on 8 procs for 3000 steps with 350 atoms

Performance: 0.859 ns/day, 27.945 hours/ns, 19.880 timesteps/s, 6.958 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 97.293     | 120.32     | 127.29     |  81.7 | 79.74
Bond    | 0.0084049  | 0.0093554  | 0.01024    |   0.5 |  0.01
Neigh   | 8.0751     | 9.6844     | 10.194     |  21.6 |  6.42
Comm    | 1.5902     | 8.5539     | 31.58      | 306.4 |  5.67
Output  | 0.007875   | 0.0095238  | 0.010833   |   1.1 |  0.01
Modify  | 11.739     | 12.246     | 13.86      |  19.3 |  8.11
Other   |            | 0.07496    |            |       |  0.05

Nlocal:          43.75 ave          55 max          36 min
Histogram: 1 0 2 1 2 1 0 0 0 1
Nghost:        3193.38 ave        3241 max        3149 min
Histogram: 1 1 0 2 1 0 1 0 1 1
Neighs:          28813 ave       35723 max       24060 min
Histogram: 1 1 1 1 2 1 0 0 0 1

Total # of neighbors = 230504
Ave neighs/atom = 658.58286
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.4 | 124.8 | 126.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   304.40225     -41175.92      -8417.9296      0              3721.2319    
       100   295.19244     -41159.286     -19028.706     -10672.048      3721.2319    
       200   325.12206     -41177.239     -8355.7348     -17379.757      3721.2319    
       300   302.65996     -41144.026     -1711.0342     -7117.873       3721.2319    
       400   299.23248     -41159.469     -15078.347     -12572.092      3721.2319    
       500   285.5702      -41168.174     -7082.6043     -2315.0463      3721.2319    
       600   319.48382     -41202.487     -4487.5357     -7898.1819      3721.2319    
       700   298.15635     -41163.616      2562.7697     -4624.8117      3721.2319    
       800   326.03087     -41153.962     -8783.2741     -8623.1372      3721.2319    
       900   316.04311     -41150.808     -12978.397     -16330.572      3721.2319    
      1000   298.93608     -41159.687     -9165.5083     -10136.011      3721.2319    
      1100   282.21938     -41155.117     -7361.9965     -5716.0699      3721.2319    
      1200   290.85304     -41164.4       -16244.575     -7746.1811      3721.2319    
      1300   298.74625     -41175.227      2552.8673     -9842.759       3721.2319    
      1400   290.58784     -41179.213     -3379.4634     -4567.1729      3721.2319    
      1500   285.62956     -41184.309     -14567.3       -2301.1386      3721.2319    
      1600   295.49423     -41192.228     -9166.0279     -2583.8106      3721.2319    
      1700   310.68698     -41189.93      -16534.342     -6692.0861      3721.2319    
      1800   287.24238     -41143.876      7688.3327     -3268.9682      3721.2319    
      1900   320.41797     -41166.68       8641.3126     -1382.9248      3721.2319    
      2000   293.95061     -41171.162     -7517.3575     -6001.0617      3721.2319    
      2100   294.52688     -41194.155      1928.1649     -11221.934      3721.2319    
      2200   295.65356     -41186.677     -6072.084      -8048.67        3721.2319    
      2300   301.31014     -41169.424     -9108.9863     -942.85523      3721.2319    
      2400   300.85789     -41150.64      -13215.596     -5867.5131      3721.2319    
      2500   304.4486      -41160.442     -16700.713     -9488.6776      3721.2319    
      2600   309.50426     -41177.995     -11484.795     -5758.953       3721.2319    
      2700   298.98266     -41175.47      -9202.7116     -2130.6757      3721.2319    
      2800   299.6349      -41177.805      4385.2603     -801.59147      3721.2319    
      2900   281.36888     -41170.327     -10954.685     -5576.6513      3721.2319    
      3000   285.84778     -41199.167     -2712.8073     -7341.4558      3721.2319    
Loop time of 153.39 on 8 procs for 3000 steps with 350 atoms

Performance: 0.845 ns/day, 28.406 hours/ns, 19.558 timesteps/s, 6.845 katom-step/s
98.3% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 101.73     | 114.84     | 125.17     |  86.2 | 74.87
Bond    | 0.0086365  | 0.009345   | 0.010046   |   0.5 |  0.01
Neigh   | 8.343      | 9.355      | 10.391     |  24.5 |  6.10
Comm    | 5.1665     | 15.351     | 28.367     | 235.7 | 10.01
Output  | 0.0013867  | 0.0015723  | 0.0025851  |   1.0 |  0.00
Modify  | 12.57      | 13.758     | 14.682     |  20.6 |  8.97
Other   |            | 0.07611    |            |       |  0.05

Nlocal:          43.75 ave          57 max          38 min
Histogram: 3 1 1 0 1 1 0 0 0 1
Nghost:        3206.38 ave        3269 max        3155 min
Histogram: 1 1 1 0 1 1 2 0 0 1
Neighs:        28808.2 ave       36991 max       25321 min
Histogram: 3 2 0 0 1 1 0 0 0 1

Total # of neighbors = 230466
Ave neighs/atom = 658.47429
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -20.0543111010412
variable C2neg equal ${d2}
variable C2neg equal 27.1269516342485
variable C3neg equal ${d3}
variable C3neg equal 42.7597533399064
variable C4neg equal ${d4}
variable C4neg equal 4.0076038989625
variable C5neg equal ${d5}
variable C5neg equal 3.54091196478402
variable C6neg equal ${d6}
variable C6neg equal 20.0826936078175

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.5028
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.145028 yz delta ${deltayz} remap units box
change_box all y delta 0 0.145028 yz delta -0.00642 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.2382 14.647828 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  triclinic box = (0 0 0) to (15.2382 14.647828 17.0085) with tilt (-6.2627 -0.4482 -0.64842)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.7 | 122.7 | 124.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.07373     -41105.025     -59087.424      0              3796.4083    
       100   305.16295     -41121.359     -9385.402      -9665.5325      3796.4083    
       200   304.66844     -41119.511     -6049.0145     -3147.9469      3796.4083    
       300   297.98767     -41125.703     -5051.4694     -3479.0853      3796.4083    
       400   283.58772     -41135.948     -8655.8501     -8230.8893      3796.4083    
       500   284.32449     -41142.668     -14994.035     -13481.176      3796.4083    
       600   296.77928     -41145.014     -3861.334       955.49574      3796.4083    
       700   297.64853     -41120.564     -18037.271     -7641.333       3796.4083    
       800   320.27053     -41130.322     -9359.5825     -5813.9513      3796.4083    
       900   298.00416     -41112.643      1979.3293     -5424.5446      3796.4083    
      1000   282.10592     -41113.3       -17029.134     -9658.6267      3796.4083    
      1100   294.36737     -41142.541     -2491.9649     -8843.5167      3796.4083    
      1200   304.5999      -41154.96      -14490.043     -9425.2175      3796.4083    
      1300   285.99476     -41117.577      3954.4274     -9472.9051      3796.4083    
      1400   313.75868     -41125.837     -6010.9283     -11723.259      3796.4083    
      1500   308.26034     -41115.428     -6281.0412     -7170.638       3796.4083    
      1600   297.20764     -41120.973     -23992.519     -15233.323      3796.4083    
      1700   281.82238     -41123.062     -18030.374     -9735.7359      3796.4083    
      1800   297.63229     -41143.261     -6399.5221     -6706.5006      3796.4083    
      1900   297.4936      -41141.821     -10447.533     -2515.5863      3796.4083    
      2000   298.17036     -41131.518     -14151.016     -11075.582      3796.4083    
      2100   320.4635      -41135.984     -7143.5064     -13304.548      3796.4083    
      2200   326.44986     -41148.182     -6151.341      -8873.5804      3796.4083    
      2300   288.03049     -41146.761     -7556.7422     -13247.33       3796.4083    
      2400   298.40218     -41161.342     -23183.086     -12840.972      3796.4083    
      2500   310.77545     -41166.037     -3364.1694     -15333.822      3796.4083    
      2600   301.77736     -41135.359     -22292.176     -12497.937      3796.4083    
      2700   316.15222     -41121.813     -10801.005     -13919.4        3796.4083    
      2800   333.50165     -41131.298     -9615.2495     -12403.666      3796.4083    
      2900   299.84805     -41142.588     -12074.858     -15073.679      3796.4083    
      3000   297.18367     -41158.1       -4274.0262     -10497.8        3796.4083    
Loop time of 146.039 on 8 procs for 3000 steps with 350 atoms

Performance: 0.887 ns/day, 27.044 hours/ns, 20.542 timesteps/s, 7.190 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 84.732     | 111.58     | 123.44     | 131.8 | 76.41
Bond    | 0.0078924  | 0.0091535  | 0.010039   |   0.7 |  0.01
Neigh   | 6.8314     | 9.2188     | 10.162     |  39.8 |  6.31
Comm    | 1.0376     | 12.891     | 39.716     | 387.5 |  8.83
Output  | 0.0072798  | 0.0090572  | 0.010482   |   1.2 |  0.01
Modify  | 11.267     | 12.253     | 14.683     |  35.3 |  8.39
Other   |            | 0.07366    |            |       |  0.05

Nlocal:          43.75 ave          50 max          36 min
Histogram: 1 1 0 1 0 1 0 2 1 1
Nghost:        3133.25 ave        3197 max        3080 min
Histogram: 1 2 0 0 2 0 1 1 0 1
Neighs:        28221.8 ave       31902 max       23601 min
Histogram: 1 1 0 1 0 1 0 1 2 1

Total # of neighbors = 225774
Ave neighs/atom = 645.06857
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.7 | 122.7 | 124.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   297.18367     -41158.1       -4274.0219      0              3796.4083    
       100   294.7796      -41150.253     -14663.938     -10317.739      3796.4083    
       200   302.20545     -41125.761     -17049.806     -11530.544      3796.4083    
       300   330.36505     -41143.973     -10906.639     -8861.5502      3796.4083    
       400   311.37955     -41142.257     -12611.441     -8830.3651      3796.4083    
       500   299.28026     -41153.543     -14471.912     -13389.95       3796.4083    
       600   299.51565     -41160.05      -3832.7587     -8155.6542      3796.4083    
       700   284.08647     -41146.441     -8740.9616     -2990.86        3796.4083    
       800   283.50881     -41126.587     -18474.993     -8709.5867      3796.4083    
       900   306.55075     -41121.156      260.21693     -8485.4497      3796.4083    
      1000   318.17343     -41142.721     -16416.707     -8305.2612      3796.4083    
      1100   300.59876     -41147.507     -6961.6255     -11294.187      3796.4083    
      1200   299.47017     -41156.419     -4484.4469     -10415.51       3796.4083    
      1300   301.50695     -41166.646     -12804.406     -12062.213      3796.4083    
      1400   318.56123     -41186.659     -7188.6433     -14978.153      3796.4083    
      1500   287.41597     -41175.189     -16918.117     -13029.275      3796.4083    
      1600   300.43439     -41204.956     -4236.2219     -9244.9678      3796.4083    
      1700   297.31745     -41180.293     -18910.603     -12335.851      3796.4083    
      1800   302.55774     -41159.933     -8680.3256     -12496.877      3796.4083    
      1900   296.72912     -41149.534     -11561.12      -8547.6861      3796.4083    
      2000   307.57846     -41172.999     -5092.7379     -10807.962      3796.4083    
      2100   304.48906     -41193.951     -14177.243     -5596.7818      3796.4083    
      2200   290.66477     -41193.284     -8505.3011     -8457.3695      3796.4083    
      2300   286.93231     -41182.084     -9430.5142     -11381.67       3796.4083    
      2400   285.94338     -41171.096     -11284.545     -13682.555      3796.4083    
      2500   325.71826     -41193.712     -10717.948     -16512.586      3796.4083    
      2600   306.31533     -41170.743     -17545.792     -4467.4247      3796.4083    
      2700   295.19768     -41190.406     -28457.748     -13143.037      3796.4083    
      2800   281.93142     -41199.293     -3337.968      -14373.183      3796.4083    
      2900   293.8133      -41197.366     -1549.983      -8174.8101      3796.4083    
      3000   288.39056     -41172.932     -6359.8036     -13038.511      3796.4083    
Loop time of 146.024 on 8 procs for 3000 steps with 350 atoms

Performance: 0.888 ns/day, 27.042 hours/ns, 20.545 timesteps/s, 7.191 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 94.458     | 113.17     | 123.35     |  97.2 | 77.50
Bond    | 0.0079843  | 0.0091989  | 0.010381   |   0.7 |  0.01
Neigh   | 7.4824     | 9.2752     | 10.174     |  30.0 |  6.35
Comm    | 0.99651    | 11.169     | 29.866     | 309.1 |  7.65
Output  | 0.0014496  | 0.0016619  | 0.0027263  |   1.0 |  0.00
Modify  | 11.375     | 12.322     | 14.143     |  26.6 |  8.44
Other   |            | 0.07388    |            |       |  0.05

Nlocal:          43.75 ave          49 max          38 min
Histogram: 2 0 1 0 0 0 3 0 0 2
Nghost:        3154.62 ave        3200 max        3115 min
Histogram: 2 1 1 0 0 0 1 0 2 1
Neighs:        28237.9 ave       31291 max       24821 min
Histogram: 2 0 1 0 0 0 3 0 0 2

Total # of neighbors = 225903
Ave neighs/atom = 645.43714
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 77.7797243712575
variable C2pos equal ${d2}
variable C2pos equal 97.2069514416299
variable C3pos equal ${d3}
variable C3pos equal -39.0218235507167
variable C4pos equal ${d4}
variable C4pos equal 1.99962692427512
variable C5pos equal ${d5}
variable C5pos equal 1.82260536155873
variable C6pos equal ${d6}
variable C6pos equal 2.62412570645701

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(-20.0543111010412+${C1pos})
variable C12 equal 0.5*(-20.0543111010412+77.7797243712575)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(27.1269516342485+${C2pos})
variable C22 equal 0.5*(27.1269516342485+97.2069514416299)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(42.7597533399064+${C3pos})
variable C32 equal 0.5*(42.7597533399064+-39.0218235507167)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(4.0076038989625+${C4pos})
variable C42 equal 0.5*(4.0076038989625+1.99962692427512)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(3.54091196478402+${C5pos})
variable C52 equal 0.5*(3.54091196478402+1.82260536155873)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(20.0826936078175+${C6pos})
variable C62 equal 0.5*(20.0826936078175+2.62412570645701)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.0085
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.0085
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.170085 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.2382 14.5028 16.838415) with tilt (-6.2627 -0.4482 -0.642)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.8 | 124.7 | 127.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.07373     -41127.335      37887.698      0              3721.2319    
       100   299.95493     -41134.43      -740.54866     -4719.8374      3721.2319    
       200   313.89137     -41141.997     -7050.0522     -2526.1917      3721.2319    
       300   294.47578     -41133.881     -11068.276     -1694.6565      3721.2319    
       400   276.0428      -41138.044     -9130.5375     -1992.8702      3721.2319    
       500   284.83671     -41150.797      857.97675     -8158.4894      3721.2319    
       600   283.19209     -41138.707     -4722.9455      2829.586       3721.2319    
       700   316.13793     -41149.779     -8824.7248     -1976.7574      3721.2319    
       800   317.37971     -41135.599     -6210.6215     -1175.0877      3721.2319    
       900   310.67705     -41148.894     -11927.719     -3413.1486      3721.2319    
      1000   275.69435     -41140.726      3531.1499     -3065.9256      3721.2319    
      1100   300.11402     -41177.029     -9288.5915     -4552.7274      3721.2319    
      1200   283.14508     -41160.754     -9520.5288     -11420.404      3721.2319    
      1300   295.80885     -41160.008      4477.5209     -7433.4344      3721.2319    
      1400   298.81484     -41143.173      5830.3088     -8297.5518      3721.2319    
      1500   316.8739      -41160.686     -6608.7386     -11061.763      3721.2319    
      1600   292.67332     -41150.305      2852.0663     -9626.0057      3721.2319    
      1700   294.17506     -41169.577     -6494.2108     -5307.273       3721.2319    
      1800   283.21909     -41164.427      2961.3104     -4678.2158      3721.2319    
      1900   296.08436     -41163.158     -16007.817     -5612.2706      3721.2319    
      2000   311.38269     -41158.309     -7936.8917     -10109.178      3721.2319    
      2100   304.46133     -41139.167      2887.2582     -6097.7486      3721.2319    
      2200   296.98743     -41157.482     -13537.252     -9195.7988      3721.2319    
      2300   288.92159     -41178.781     -10166.77      -5505.4683      3721.2319    
      2400   287.13912     -41171.055      7765.6068     -7238.2792      3721.2319    
      2500   300.77042     -41162.152      5905.142      -11742.453      3721.2319    
      2600   319.48281     -41167.05      -4917.6646     -5179.0881      3721.2319    
      2700   304.23107     -41161.416     -23008.616     -7181.4501      3721.2319    
      2800   286.99528     -41164.264      6498.391      -1983.0343      3721.2319    
      2900   281.64984     -41160.419     -1569.5304     -7238.8034      3721.2319    
      3000   322.52574     -41200.776     -1605.4495     -10710.214      3721.2319    
Loop time of 150.464 on 8 procs for 3000 steps with 350 atoms

Performance: 0.861 ns/day, 27.864 hours/ns, 19.938 timesteps/s, 6.978 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 87.023     | 116.94     | 127.42     | 115.0 | 77.72
Bond    | 0.0082157  | 0.0093253  | 0.0099964  |   0.6 |  0.01
Neigh   | 6.9664     | 9.4629     | 10.346     |  33.7 |  6.29
Comm    | 0.97813    | 11.446     | 41.347     | 367.3 |  7.61
Output  | 0.0077925  | 0.0095269  | 0.010943   |   1.1 |  0.01
Modify  | 11.584     | 12.517     | 15.048     |  29.8 |  8.32
Other   |            | 0.07464    |            |       |  0.05

Nlocal:          43.75 ave          51 max          35 min
Histogram: 1 1 0 0 0 2 2 0 1 1
Nghost:        3190.62 ave        3254 max        3132 min
Histogram: 2 0 1 0 1 1 0 2 0 1
Neighs:        28808.9 ave       33165 max       23384 min
Histogram: 1 0 1 0 1 1 2 0 1 1

Total # of neighbors = 230471
Ave neighs/atom = 658.48857
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.8 | 124.7 | 127.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   322.52574     -41200.776     -1605.414       0              3721.2319    
       100   306.27126     -41181.386     -6709.9545     -5804.3147      3721.2319    
       200   295.822       -41153.384     -7984.0195     -6466.5616      3721.2319    
       300   316.74226     -41145.024     -13605.808     -5700.8271      3721.2319    
       400   312.71574     -41142.395     -7528.3243     -3465.9768      3721.2319    
       500   297.79855     -41157.181      3604.0786     -7163.8203      3721.2319    
       600   303.41094     -41177.674     -7338.9218     -9973.4232      3721.2319    
       700   282.94361     -41160.591     -2355.0929     -7212.5178      3721.2319    
       800   305.94696     -41185.438      1841.2238     -6964.1783      3721.2319    
       900   304.42386     -41180.264     -19315.003     -5614.356       3721.2319    
      1000   293.54987     -41176.901     -1737.0765     -8838.7793      3721.2319    
      1100   298.94401     -41184.874     -12860.449     -5812.9899      3721.2319    
      1200   283.67994     -41153.073     -5237.8168     -7297.6597      3721.2319    
      1300   302.31533     -41147.712     -3134.8082     -8974.0008      3721.2319    
      1400   298.91377     -41142.35      -8515.2508     -12137.669      3721.2319    
      1500   294.98998     -41164.235     -8002.1857     -4474.5147      3721.2319    
      1600   291.67092     -41189.484     -5803.6137     -7904.6973      3721.2319    
      1700   291.6881      -41180.906      4059.881      -8723.85        3721.2319    
      1800   310.15907     -41177.894     -2563.3365      1790.9444      3721.2319    
      1900   302.19933     -41156.427     -4631.5408     -1329.9455      3721.2319    
      2000   299.26561     -41154.198     -10448.161     -218.14361      3721.2319    
      2100   303.83295     -41169.939     -8511.9216     -7770.1888      3721.2319    
      2200   271.37977     -41179.58       2155.8419     -4504.5624      3721.2319    
      2300   276.79311     -41188.256     -10737.675     -11068.167      3721.2319    
      2400   290.74459     -41177.52      -2863.8608     -9888.7497      3721.2319    
      2500   282.79138     -41148.279      6747.9107     -3066.332       3721.2319    
      2600   292.90373     -41148.632     -14928.557     -12204.156      3721.2319    
      2700   293.88318     -41146.616     -4252.9552     -12093.492      3721.2319    
      2800   317.58502     -41167.75      -14801.827     -5983.9472      3721.2319    
      2900   317.36684     -41182.192     -8326.395      -7237.5259      3721.2319    
      3000   298.11391     -41185.071     -15402.626     -4195.9855      3721.2319    
Loop time of 150.184 on 8 procs for 3000 steps with 350 atoms

Performance: 0.863 ns/day, 27.812 hours/ns, 19.975 timesteps/s, 6.991 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 87.16      | 118.08     | 126.91     | 109.6 | 78.62
Bond    | 0.0082446  | 0.0092827  | 0.010227   |   0.6 |  0.01
Neigh   | 7.0778     | 9.5663     | 10.385     |  32.0 |  6.37
Comm    | 1.116      | 9.9488     | 40.854     | 377.3 |  6.62
Output  | 0.0013532  | 0.0015585  | 0.002501   |   0.9 |  0.00
Modify  | 11.643     | 12.508     | 15.018     |  28.4 |  8.33
Other   |            | 0.07496    |            |       |  0.05

Nlocal:          43.75 ave          56 max          37 min
Histogram: 2 0 2 1 0 2 0 0 0 1
Nghost:           3181 ave        3244 max        3125 min
Histogram: 2 0 1 0 1 1 1 1 0 1
Neighs:          28774 ave       36222 max       24671 min
Histogram: 2 1 1 1 0 2 0 0 0 1

Total # of neighbors = 230192
Ave neighs/atom = 657.69143
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 11.8171671023104
variable C2neg equal ${d2}
variable C2neg equal -48.1670347646963
variable C3neg equal ${d3}
variable C3neg equal 72.4875194863293
variable C4neg equal ${d4}
variable C4neg equal -22.0273137406794
variable C5neg equal ${d5}
variable C5neg equal 7.69523847463072
variable C6neg equal ${d6}
variable C6neg equal 2.56149858650787

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.0085
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.170085 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.2382 14.5028 17.178585) with tilt (-6.2627 -0.4482 -0.642)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.3 | 122.4 | 124.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.07373     -41101.174     -56498.291      0              3796.4083    
       100   306.95496     -41119.47      -10820.716     -9582.3231      3796.4083    
       200   309.04845     -41123.812      3270.1135     -3140.8344      3796.4083    
       300   290.14898     -41124.032     -3529.8154     -7371.545       3796.4083    
       400   286.23677     -41144.606     -9627.3547     -9358.6872      3796.4083    
       500   290.72596     -41149.521     -21093.336     -14694.992      3796.4083    
       600   304.92767     -41140.93      -18765.506     -3308.9639      3796.4083    
       700   298.68939     -41109.64      -13909.273     -4800.4931      3796.4083    
       800   316.40523     -41108.095      2320.6906     -5093.4344      3796.4083    
       900   322.29154     -41126.947     -2859.0666     -2914.3864      3796.4083    
      1000   292.55087     -41131.763     -10742.69      -9154.3038      3796.4083    
      1100   301.92776     -41159.564     -15781.7       -7730.0403      3796.4083    
      1200   289.44345     -41140.794     -23565.481     -12169.575      3796.4083    
      1300   297.39147     -41124.305     -1336.7702     -6163.8125      3796.4083    
      1400   320.75284     -41129.568     -16482.07      -2710.8293      3796.4083    
      1500   300.52776     -41124.046     -10467.384     -9390.2623      3796.4083    
      1600   305.72106     -41153.396     -19511.893     -5129.869       3796.4083    
      1700   286.73213     -41150.177     -1950.556      -8882.6368      3796.4083    
      1800   307.28021     -41157.115     -1384.635      -4458.0803      3796.4083    
      1900   315.02656     -41141.226     -10466.627     -11916.979      3796.4083    
      2000   318.83217     -41133.03      -4486.0998     -4793.3029      3796.4083    
      2100   314.86356     -41140.994     -9104.9004     -5759.3936      3796.4083    
      2200   293.83085     -41158.766     -7714.6128     -3877.023       3796.4083    
      2300   273.14935     -41140.002     -11342.098     -8188.1991      3796.4083    
      2400   306.37592     -41153.2       -13495.716     -3999.8823      3796.4083    
      2500   313.13858     -41146.244     -16955.534     -6554.3993      3796.4083    
      2600   298.18508     -41148.373     -11891.097     -11960.176      3796.4083    
      2700   301.66789     -41172.382     -22765.458     -9292.5996      3796.4083    
      2800   307.83951     -41177.497     -10941.987     -12866.534      3796.4083    
      2900   281.53059     -41143.311     -6454.6289     -13238.132      3796.4083    
      3000   291.336       -41138.289     -4889.3402     -10931.614      3796.4083    
Loop time of 146.143 on 8 procs for 3000 steps with 350 atoms

Performance: 0.887 ns/day, 27.063 hours/ns, 20.528 timesteps/s, 7.185 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 84.188     | 115.5      | 123.23     | 111.2 | 79.03
Bond    | 0.0079792  | 0.0091931  | 0.010417   |   0.7 |  0.01
Neigh   | 6.941      | 9.4397     | 10.173     |  31.5 |  6.46
Comm    | 1.0661     | 8.7906     | 40.091     | 402.8 |  6.02
Output  | 0.0075773  | 0.0093489  | 0.010754   |   1.2 |  0.01
Modify  | 11.538     | 12.318     | 14.84      |  27.9 |  8.43
Other   |            | 0.07544    |            |       |  0.05

Nlocal:          43.75 ave          55 max          38 min
Histogram: 2 1 2 0 2 0 0 0 0 1
Nghost:        3136.75 ave        3204 max        3081 min
Histogram: 2 1 0 1 0 0 2 0 1 1
Neighs:        28223.9 ave       35005 max       24822 min
Histogram: 2 1 1 1 2 0 0 0 0 1

Total # of neighbors = 225791
Ave neighs/atom = 645.11714
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.4 | 122.4 | 124.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.336       -41138.289     -4889.3836      0              3796.4083    
       100   291.65278     -41139.904     -7184.86       -13538.087      3796.4083    
       200   301.43897     -41169.576     -27838.375     -11059.527      3796.4083    
       300   283.40785     -41174.451     -22413.877     -10475.858      3796.4083    
       400   287.98316     -41178.692     -10046.455     -19429.931      3796.4083    
       500   329.15495     -41186.176     -7868.1318     -11109.829      3796.4083    
       600   318.33733     -41165.642     -23029.042     -11911.987      3796.4083    
       700   317.76713     -41152.87      -14404.61      -7446.8008      3796.4083    
       800   314.11377     -41143.052     -4702.8836     -13484.261      3796.4083    
       900   302.29843     -41134.969     -11248.104     -14291.458      3796.4083    
      1000   305.89806     -41169.214     -22083.368     -9516.2865      3796.4083    
      1100   289.24115     -41165.549     -15896.282     -13113.613      3796.4083    
      1200   292.21112     -41164.8       -11028.283     -7982.6775      3796.4083    
      1300   293.36749     -41129.65      -5109.5185     -11970.022      3796.4083    
      1400   321.1406      -41145.142     -5308.5201     -10877.219      3796.4083    
      1500   284.01114     -41121.658     -8928.5958     -10984.487      3796.4083    
      1600   278.5508      -41133.452     -19887.522     -9450.5001      3796.4083    
      1700   299.44368     -41158.383     -2895.4732     -8015.0976      3796.4083    
      1800   304.2958      -41139.49      -8328.4238     -8618.5705      3796.4083    
      1900   299.93383     -41103.055     -9000.1021     -5818.296       3796.4083    
      2000   308.57426     -41126.428     -9940.8996     -8517.3682      3796.4083    
      2100   306.34682     -41147.319     -10412.826     -9285.9697      3796.4083    
      2200   286.12848     -41141.305     -8936.4729     -7970.4201      3796.4083    
      2300   291.04286     -41143.787     -10203.506     -5641.4872      3796.4083    
      2400   324.03135     -41144.253     -12513.114     -9725.4173      3796.4083    
      2500   316.77418     -41127.023      4805.3279     -4105.8459      3796.4083    
      2600   301.99103     -41126.858     -7085.6344     -9683.1213      3796.4083    
      2700   287.68341     -41132.972     -3628.3219     -2732.8684      3796.4083    
      2800   296.96869     -41153.49      -9961.4706     -6491.408       3796.4083    
      2900   292.88077     -41150.389     -6090.2604     -5862.7917      3796.4083    
      3000   324.5593      -41152.769     -8158.1014     -6479.3702      3796.4083    
Loop time of 146.467 on 8 procs for 3000 steps with 350 atoms

Performance: 0.885 ns/day, 27.124 hours/ns, 20.482 timesteps/s, 7.169 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 83.973     | 115.52     | 123.28     | 112.1 | 78.87
Bond    | 0.0080885  | 0.0092437  | 0.010387   |   0.7 |  0.01
Neigh   | 6.9214     | 9.4712     | 10.175     |  32.0 |  6.47
Comm    | 1.263      | 9.027      | 40.564     | 400.9 |  6.16
Output  | 0.0013321  | 0.0015975  | 0.0028099  |   1.2 |  0.00
Modify  | 11.611     | 12.363     | 14.934     |  28.3 |  8.44
Other   |            | 0.07438    |            |       |  0.05

Nlocal:          43.75 ave          56 max          35 min
Histogram: 1 1 1 2 0 1 1 0 0 1
Nghost:        3157.12 ave        3197 max        3122 min
Histogram: 2 0 1 1 0 1 1 0 0 2
Neighs:          28217 ave       35565 max       22972 min
Histogram: 1 1 1 2 0 1 1 0 0 1

Total # of neighbors = 225736
Ave neighs/atom = 644.96
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 11.3192288559015
variable C2pos equal ${d2}
variable C2pos equal 49.8704504214354
variable C3pos equal ${d3}
variable C3pos equal -40.4994001195664
variable C4pos equal ${d4}
variable C4pos equal 9.35799138342074
variable C5pos equal ${d5}
variable C5pos equal -10.7857005600077
variable C6pos equal ${d6}
variable C6pos equal 15.2735429344895

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(11.8171671023104+${C1pos})
variable C13 equal 0.5*(11.8171671023104+11.3192288559015)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(-48.1670347646963+${C2pos})
variable C23 equal 0.5*(-48.1670347646963+49.8704504214354)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(72.4875194863293+${C3pos})
variable C33 equal 0.5*(72.4875194863293+-40.4994001195664)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-22.0273137406794+${C4pos})
variable C43 equal 0.5*(-22.0273137406794+9.35799138342074)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(7.69523847463072+${C5pos})
variable C53 equal 0.5*(7.69523847463072+-10.7857005600077)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(2.56149858650787+${C6pos})
variable C63 equal 0.5*(2.56149858650787+15.2735429344895)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.0085
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.0085
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.170085 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.812085)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 123.3 | 125.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.07373     -41127.154     -12016.558      0              3758.8201    
       100   302.27723     -41133.578     -4037.9659     -7423.6193      3758.8201    
       200   307.88665     -41125.188     -503.15407     -1398.8249      3758.8201    
       300   285.85471     -41114.827     -7612.8457     -3599.5765      3758.8201    
       400   299.09191     -41156.872     -7304.5792     -4700.1867      3758.8201    
       500   283.38309     -41148.813     -12275.828     -11904.433      3758.8201    
       600   294.04193     -41146.799     -4026.8812     -1.1786739      3758.8201    
       700   303.67024     -41134.065     -408.06743     -5264.0057      3758.8201    
       800   320.32933     -41129.695     -307.83315     -5868.437       3758.8201    
       900   319.29169     -41132.417      3998.7175     -699.46065      3758.8201    
      1000   306.79247     -41155.803     -1444.0846     -3691.7447      3758.8201    
      1100   293.50644     -41166.202     -14776.299     -4113.7592      3758.8201    
      1200   281.97733     -41158.582     -11341.766     -10180.13       3758.8201    
      1300   290.22161     -41143.129      1519.7231     -1391.1433      3758.8201    
      1400   304.81551     -41131.29      -21967.672     -10488.227      3758.8201    
      1500   312.8746      -41128.531     -10768.121     -11823.814      3758.8201    
      1600   299.12431     -41132.049     -14578.736     -6023.7492      3758.8201    
      1700   308.05429     -41160.034     -9497.6109     -5606.5126      3758.8201    
      1800   297.21918     -41161.845     -2574.8201     -6946.2491      3758.8201    
      1900   293.8183      -41157.039     -6254.6784     -6333.067       3758.8201    
      2000   313.4096      -41159.93      -13823.374     -11778.814      3758.8201    
      2100   313.19832     -41141.856     -6343.2131     -4338.4479      3758.8201    
      2200   291.13311     -41119.645     -55.78743      -10899.28       3758.8201    
      2300   297.32889     -41147.077      4281.1394     -7629.5529      3758.8201    
      2400   273.80497     -41146.151     -5043.9528     -4441.6594      3758.8201    
      2500   281.53159     -41146.754     -14293.362     -7875.9789      3758.8201    
      2600   300.3209      -41138.141     -7214.5933     -5238.9814      3758.8201    
      2700   320.19511     -41151.669     -5308.5077     -7214.7255      3758.8201    
      2800   282.11746     -41121.508      5779.2415     -4481.8904      3758.8201    
      2900   275.38172     -41120.929     -373.81693     -8411.0922      3758.8201    
      3000   309.62723     -41141.586     -4229.333      -10285.262      3758.8201    
Loop time of 147.871 on 8 procs for 3000 steps with 350 atoms

Performance: 0.876 ns/day, 27.384 hours/ns, 20.288 timesteps/s, 7.101 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.811     | 114.49     | 124.36     | 108.1 | 77.43
Bond    | 0.0080374  | 0.0091711  | 0.010361   |   0.6 |  0.01
Neigh   | 7.116      | 9.3639     | 10.126     |  29.7 |  6.33
Comm    | 1.5848     | 11.448     | 39.118     | 341.8 |  7.74
Output  | 0.006887   | 0.0087918  | 0.010643   |   1.4 |  0.01
Modify  | 11.697     | 12.475     | 14.743     |  25.9 |  8.44
Other   |            | 0.07405    |            |       |  0.05

Nlocal:          43.75 ave          56 max          38 min
Histogram: 1 3 1 1 0 1 0 0 0 1
Nghost:        3191.38 ave        3265 max        3123 min
Histogram: 1 1 0 1 1 1 1 1 0 1
Neighs:          28480 ave       35898 max       24993 min
Histogram: 2 2 1 1 0 1 0 0 0 1

Total # of neighbors = 227840
Ave neighs/atom = 650.97143
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.5 | 123.5 | 125.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.62723     -41141.586     -4229.3806      0              3758.8201    
       100   307.24377     -41151.791      1878.5797     -9676.9199      3758.8201    
       200   284.48379     -41158.531      1660.8092     -9642.866       3758.8201    
       300   292.74249     -41168.377     -781.78652     -15576.531      3758.8201    
       400   283.84491     -41150.685     -10578.041     -1957.6059      3758.8201    
       500   297.31159     -41152.715     -13140.526     -14736.359      3758.8201    
       600   339.87686     -41177.073     -1191.2905     -6827.1275      3758.8201    
       700   312.86018     -41139.109      3636.4964     -3823.3751      3758.8201    
       800   306.19262     -41152.905     -16890.254     -7295.4202      3758.8201    
       900   301.01352     -41171.315     -17191.211     -16929.408      3758.8201    
      1000   301.28889     -41177.201     -1057.9999     -11521.936      3758.8201    
      1100   294.37446     -41153.48      -11711.429     -9177.9804      3758.8201    
      1200   312.17248     -41136.95      -1516.4065     -12268.901      3758.8201    
      1300   323.45902     -41148.008      573.8469      -11034.119      3758.8201    
      1400   307.85022     -41151.681     -1044.6693     -10118.632      3758.8201    
      1500   293.80974     -41152.389     -15889.12      -5399.3078      3758.8201    
      1600   306.63574     -41177.46      -5726.8261     -6582.3111      3758.8201    
      1700   282.54946     -41170.728     -6756.6685     -3076.6585      3758.8201    
      1800   293.2136      -41174.172     -11679.516     -6450.9654      3758.8201    
      1900   340.52546     -41179.696     -6849.3944     -10580.631      3758.8201    
      2000   320.79951     -41166.802     -15130.409     -7648.1593      3758.8201    
      2100   301.07594     -41171.465     -9115.5826     -11609.046      3758.8201    
      2200   295.29313     -41175.313     -12507.268     -12382.026      3758.8201    
      2300   300.09012     -41197.593     -7519.9517     -8192.1154      3758.8201    
      2400   297.76891     -41205.971     -8692.6328     -13915.797      3758.8201    
      2500   294.9308      -41198.045     -6875.0689     -11758.289      3758.8201    
      2600   303.09663     -41178.058     -12082.117     -11191.514      3758.8201    
      2700   323.81637     -41184.081     -12751.03      -12354.103      3758.8201    
      2800   314.60418     -41193.141     -23638.723     -13148.023      3758.8201    
      2900   282.44134     -41186.678     -13149.846     -9003.8489      3758.8201    
      3000   290.85553     -41193.677     -2681.0543     -5466.1051      3758.8201    
Loop time of 146.279 on 8 procs for 3000 steps with 350 atoms

Performance: 0.886 ns/day, 27.089 hours/ns, 20.509 timesteps/s, 7.178 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 84.766     | 112.07     | 122.82     | 144.3 | 76.61
Bond    | 0.0085307  | 0.0093171  | 0.010715   |   0.7 |  0.01
Neigh   | 7.0672     | 9.167      | 10.044     |  39.9 |  6.27
Comm    | 1.7403     | 12.494     | 39.805     | 432.2 |  8.54
Output  | 0.0013502  | 0.0015288  | 0.0025673  |   1.0 |  0.00
Modify  | 11.588     | 12.467     | 14.571     |  34.2 |  8.52
Other   |            | 0.07278    |            |       |  0.05

Nlocal:          43.75 ave          53 max          36 min
Histogram: 1 0 1 1 2 2 0 0 0 1
Nghost:        3150.25 ave        3217 max        3095 min
Histogram: 2 0 1 0 1 1 1 1 0 1
Neighs:        28530.1 ave       34087 max       23818 min
Histogram: 1 0 1 1 2 1 1 0 0 1

Total # of neighbors = 228241
Ave neighs/atom = 652.11714
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -1.05232040999358
variable C2neg equal ${d2}
variable C2neg equal -4.58548997886329
variable C3neg equal ${d3}
variable C3neg equal 94.5626888417713
variable C4neg equal ${d4}
variable C4neg equal -3.24711406952154
variable C5neg equal ${d5}
variable C5neg equal -13.9059958669241
variable C6neg equal ${d6}
variable C6neg equal 0.864381302619886

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.0085
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.170085 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.471915)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.2 | 123.3 | 125.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.07373     -41126.174     -12165.035      0              3758.8201    
       100   302.32288     -41133.017     -6641.0264     -7044.4651      3758.8201    
       200   317.16136     -41135.606     -9194.1319     -3581.6657      3758.8201    
       300   288.93228     -41117.312     -8125.2299     -3935.822       3758.8201    
       400   283.99472     -41138.935     -20533.062     -6290.0462      3758.8201    
       500   285.82105     -41147.851      6971.6667     -7259.7587      3758.8201    
       600   303.55649     -41153.962      1481.5054      3919.0665      3758.8201    
       700   299.86113     -41133.93      -21322.756     -7243.5758      3758.8201    
       800   319.05008     -41142.139     -8618.6891     -5445.0202      3758.8201    
       900   319.64413     -41151.289     -11301.494     -4606.1638      3758.8201    
      1000   305.02802     -41166.337     -11550.707     -4777.5386      3758.8201    
      1100   271.47587     -41148.194     -12982.463     -14936.957      3758.8201    
      1200   277.82432     -41151.018     -7187.396      -7997.9569      3758.8201    
      1300   286.98277     -41139.926     -7630.0352     -280.346        3758.8201    
      1400   292.35927     -41124.091     -19233.781     -14935.831      3758.8201    
      1500   295.55574     -41118.404     -7618.2902     -9459.3861      3758.8201    
      1600   305.05197     -41144.447      1786.4695     -738.80454      3758.8201    
      1700   289.40849     -41156.79      -4203.6813     -4422.3813      3758.8201    
      1800   279.30739     -41157.289     -14302.415     -3206.7086      3758.8201    
      1900   293.38915     -41160.902      6757.7136     -6555.7295      3758.8201    
      2000   307.79418     -41148.915     -12431.572     -5097.2756      3758.8201    
      2100   307.50736     -41139.087     -14666.612     -11278.582      3758.8201    
      2200   303.42883     -41147.499      10414.017      3024.5885      3758.8201    
      2300   279.45274     -41158.404     -3401.5748     -5578.9691      3758.8201    
      2400   285.17205     -41165.54      -4542.1456     -8205.0561      3758.8201    
      2500   296.91596     -41163.067     -21631.801     -3486.6502      3758.8201    
      2600   309.98262     -41158.238      10013.304     -879.26485      3758.8201    
      2700   294.28568     -41125.879     -14273.373     -6146.1736      3758.8201    
      2800   316.21271     -41145.459     -3243.6342     -4109.7865      3758.8201    
      2900   304.69382     -41141.929      2937.4367     -2662.0555      3758.8201    
      3000   307.62003     -41175.851     -3389.4868     -7991.1764      3758.8201    
Loop time of 146.868 on 8 procs for 3000 steps with 350 atoms

Performance: 0.882 ns/day, 27.198 hours/ns, 20.426 timesteps/s, 7.149 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.522     | 112.7      | 123.54     | 138.1 | 76.74
Bond    | 0.0083426  | 0.0092438  | 0.010586   |   0.7 |  0.01
Neigh   | 7.0122     | 9.065      | 10.042     |  39.5 |  6.17
Comm    | 1.812      | 12.655     | 38.843     | 412.3 |  8.62
Output  | 0.0063048  | 0.0081749  | 0.0096674  |   1.3 |  0.01
Modify  | 11.379     | 12.355     | 14.409     |  33.8 |  8.41
Other   |            | 0.07344    |            |       |  0.05

Nlocal:          43.75 ave          55 max          36 min
Histogram: 2 0 0 2 1 1 1 0 0 1
Nghost:        3171.38 ave        3216 max        3132 min
Histogram: 1 1 1 0 1 2 0 0 1 1
Neighs:        28482.4 ave       35256 max       23848 min
Histogram: 2 0 1 1 1 1 1 0 0 1

Total # of neighbors = 227859
Ave neighs/atom = 651.02571
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.3 | 123.3 | 125.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.62003     -41175.851     -3389.483       0              3758.8201    
       100   293.47216     -41152.309     -12070.266     -8094.1336      3758.8201    
       200   305.28011     -41133.428     -5465.2944     -1720.8826      3758.8201    
       300   308.6921      -41131.26      -14153.597     -4615.6638      3758.8201    
       400   328.72771     -41166.728     -6713.5313     -3628.1931      3758.8201    
       500   290.81603     -41143.154     -6125.1658     -6263.9072      3758.8201    
       600   282.9907      -41140.279      4410.6916     -9624.8402      3758.8201    
       700   269.00243     -41130.86      -14856.385     -5820.177       3758.8201    
       800   306.50691     -41171.135     -13492.209     -1962.3962      3758.8201    
       900   301.27689     -41158.398     -15677.268     -10032.367      3758.8201    
      1000   298.17759     -41149.644     -2103.2646     -6679.524       3758.8201    
      1100   309.5967      -41160.282     -13579.744     -15031.76       3758.8201    
      1200   308.19679     -41164.696     -9577.507      -9562.4627      3758.8201    
      1300   291.28677     -41156.213     -11691.876     -5918.3224      3758.8201    
      1400   292.49877     -41159.621     -18836.075     -7813.2172      3758.8201    
      1500   314.07505     -41161.112     -16172.534     -8141.4081      3758.8201    
      1600   312.52542     -41144.861     -3194.2078     -7000.06        3758.8201    
      1700   328.34954     -41174.385     -8539.2801     -11904.424      3758.8201    
      1800   288.56041     -41168.604     -6588.8887     -7426.3294      3758.8201    
      1900   291.98669     -41170.547     -18259.729     -6869.2227      3758.8201    
      2000   315.40353     -41175.743     -9793.9268     -7603.1009      3758.8201    
      2100   298.25846     -41150.27      -7433.2843     -6790.7652      3758.8201    
      2200   289.93099     -41133.384      2086.3004     -7277.4786      3758.8201    
      2300   308.14341     -41145.543     -8409.8754     -8264.2261      3758.8201    
      2400   316.56435     -41141.422     -13376.747     -4456.2458      3758.8201    
      2500   320.04638     -41152.468     -8481.2996     -16794.102      3758.8201    
      2600   295.49653     -41156.527     -3792.4259     -10436.309      3758.8201    
      2700   292.24346     -41162.323     -24591.125     -16500.876      3758.8201    
      2800   295.41327     -41150.219     -20890.544     -11513.982      3758.8201    
      2900   320.65028     -41154.367     -6767.5336     -9803.0633      3758.8201    
      3000   301.00965     -41151.426     -10390.886     -11566.645      3758.8201    
Loop time of 146.829 on 8 procs for 3000 steps with 350 atoms

Performance: 0.883 ns/day, 27.191 hours/ns, 20.432 timesteps/s, 7.151 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.411     | 113.15     | 123.5      | 140.3 | 77.06
Bond    | 0.0082827  | 0.0091488  | 0.010475   |   0.7 |  0.01
Neigh   | 7.0366     | 9.0762     | 9.959      |  38.9 |  6.18
Comm    | 1.8547     | 12.208     | 38.953     | 427.2 |  8.31
Output  | 0.0012578  | 0.0015974  | 0.0033767  |   1.7 |  0.00
Modify  | 11.423     | 12.311     | 14.354     |  33.4 |  8.38
Other   |            | 0.07265    |            |       |  0.05

Nlocal:          43.75 ave          55 max          39 min
Histogram: 2 2 0 2 1 0 0 0 0 1
Nghost:         3167.5 ave        3227 max        3117 min
Histogram: 2 1 0 1 0 1 1 0 0 2
Neighs:        28487.4 ave       35277 max       25672 min
Histogram: 3 1 0 2 1 0 0 0 0 1

Total # of neighbors = 227899
Ave neighs/atom = 651.14
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 62.8660410204866
variable C2pos equal ${d2}
variable C2pos equal 64.9384779476011
variable C3pos equal ${d3}
variable C3pos equal -16.677058633603
variable C4pos equal ${d4}
variable C4pos equal 3.90310196182411
variable C5pos equal ${d5}
variable C5pos equal 3.18672962625375
variable C6pos equal ${d6}
variable C6pos equal 3.19961159898463

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-1.05232040999358+${C1pos})
variable C14 equal 0.5*(-1.05232040999358+62.8660410204866)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(-4.58548997886329+${C2pos})
variable C24 equal 0.5*(-4.58548997886329+64.9384779476011)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(94.5626888417713+${C3pos})
variable C34 equal 0.5*(94.5626888417713+-16.677058633603)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(-3.24711406952154+${C4pos})
variable C44 equal 0.5*(-3.24711406952154+3.90310196182411)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-13.9059958669241+${C5pos})
variable C54 equal 0.5*(-13.9059958669241+3.18672962625375)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(0.864381302619886+${C6pos})
variable C64 equal 0.5*(0.864381302619886+3.19961159898463)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.0085
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.0085
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.170085 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.618285 -0.642)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 123.3 | 125.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.07373     -41124.961     -9621.7662      0              3758.8201    
       100   304.68311     -41135.186     -4667.9297     -7120.3983      3758.8201    
       200   306.24112     -41123.609     -1215.8121     -1853.5143      3758.8201    
       300   287.78306     -41115.223      2275.5677     -2306.9344      3758.8201    
       400   283.41358     -41138.872     -5734.3992     -9366.5499      3758.8201    
       500   288.50891     -41151.048     -2069.9118     -10766.626      3758.8201    
       600   295.66971     -41151.291     -1807.1103      1103.0564      3758.8201    
       700   288.33097     -41128.368     -10542.216     -5922.1406      3758.8201    
       800   327.94047     -41146.814     -4287.9851     -4173.8404      3758.8201    
       900   306.26002     -41133.843     -5798.222      -3680.5579      3758.8201    
      1000   303.03695     -41152.947     -7684.3027     -3656.9355      3758.8201    
      1100   302.08811     -41166.828     -10471.735     -7466.6769      3758.8201    
      1200   286.38785     -41155.841      214.11346     -10950.786      3758.8201    
      1300   292.91028     -41146.489      7541.6544     -4822.1738      3758.8201    
      1400   294.20009     -41122.219     -4952.9263     -6381.136       3758.8201    
      1500   330.53759     -41137.344      3849.6327     -10995.092      3758.8201    
      1600   310.4398      -41136.797     -2424.7945     -7900.3144      3758.8201    
      1700   300.48539     -41151.072     -16069.573     -14808.462      3758.8201    
      1800   306.13519     -41178.253     -11941.798     -10935.786      3758.8201    
      1900   295.87753     -41173.708     -3997.3424     -5271.0927      3758.8201    
      2000   296.56089     -41156.089     -3599.7102     -6162.8518      3758.8201    
      2100   316.87918     -41151.539      2144.8862     -9992.7686      3758.8201    
      2200   309.10957     -41145.522     -2612.6905     -2076.483       3758.8201    
      2300   303.19237     -41150.884     -9143.3666     -6027.4493      3758.8201    
      2400   308.19127     -41157.951     -7982.4947     -4780.9445      3758.8201    
      2500   299.67526     -41153.796     -1282.0577     -4668.8072      3758.8201    
      2600   292.77359     -41155.263      1943.3093     -2515.0883      3758.8201    
      2700   287.3379      -41159.514     -11435.268     -9429.513       3758.8201    
      2800   303.03023     -41168.587     -11583.911     -14825.096      3758.8201    
      2900   313.1707      -41156.931     -6373.2366     -7125.8838      3758.8201    
      3000   319.1154      -41155.923     -10464.265     -9711.7483      3758.8201    
Loop time of 147.044 on 8 procs for 3000 steps with 350 atoms

Performance: 0.881 ns/day, 27.230 hours/ns, 20.402 timesteps/s, 7.141 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.109     | 116.95     | 123.8      | 108.6 | 79.53
Bond    | 0.0085212  | 0.0091601  | 0.010441   |   0.6 |  0.01
Neigh   | 7.0566     | 9.4818     | 10.119     |  30.2 |  6.45
Comm    | 1.6049     | 8.464      | 39.308     | 403.8 |  5.76
Output  | 0.0068046  | 0.0084958  | 0.0098638  |   1.2 |  0.01
Modify  | 11.409     | 12.056     | 14.485     |  26.8 |  8.20
Other   |            | 0.07559    |            |       |  0.05

Nlocal:          43.75 ave          54 max          36 min
Histogram: 1 1 0 2 1 1 1 0 0 1
Nghost:        3164.88 ave        3223 max        3115 min
Histogram: 1 1 1 0 1 0 3 0 0 1
Neighs:        28516.4 ave       34726 max       23796 min
Histogram: 1 1 0 2 1 1 1 0 0 1

Total # of neighbors = 228131
Ave neighs/atom = 651.80286
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 123.3 | 125.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   319.1154      -41155.923     -10464.274      0              3758.8201    
       100   313.24581     -41158.632     -11983.979     -14045.486      3758.8201    
       200   294.89526     -41178.332     -5401.0261     -8641.5056      3758.8201    
       300   270.53516     -41153.927     -15229.209     -5661.7199      3758.8201    
       400   303.71447     -41165.035     -11662.054     -14023.309      3758.8201    
       500   308.39567     -41157.654     -8160.8771     -4386.1473      3758.8201    
       600   291.4085      -41142.917     -22927.334     -5953.8278      3758.8201    
       700   302.61328     -41152.505     -7943.1427     -7242.7058      3758.8201    
       800   289.44316     -41127.788     -11800.319     -9619.6231      3758.8201    
       900   313.78289     -41165.602     -11505.093     -7526.3888      3758.8201    
      1000   298.49082     -41173.435      354.57258     -8289.0937      3758.8201    
      1100   281.38779     -41164.953     -6614.928      -2429.0349      3758.8201    
      1200   286.80866     -41153.38      -4521.6875     -6281.9204      3758.8201    
      1300   300.11927     -41130.875     -2359.743      -7034.8136      3758.8201    
      1400   312.10694     -41149.878     -2393.4273     -9286.0011      3758.8201    
      1500   281.40205     -41136.456     -4662.7232     -7523.2564      3758.8201    
      1600   292.6839      -41155.744      577.59805     -6886.8029      3758.8201    
      1700   277.53723     -41147.091     -24925.928     -10945.204      3758.8201    
      1800   285.60367     -41157.118     -8385.4528     -10958.319      3758.8201    
      1900   291.96162     -41146.595     -14509.416     -11267.824      3758.8201    
      2000   313.70018     -41149.603     -11494.849     -12161.645      3758.8201    
      2100   325.88479     -41167.52      -8898.5913     -7058.4241      3758.8201    
      2200   296.83561     -41171.582     -5052.4809     -5338.767       3758.8201    
      2300   286.56031     -41164.378     -1219.6364     -10998.064      3758.8201    
      2400   313.02285     -41179.715     -13578.683     -11554.204      3758.8201    
      2500   276.36669     -41126.064     -6821.1874     -8636.5471      3758.8201    
      2600   285.7095      -41120.156     -12567.675     -75.648824      3758.8201    
      2700   308.93663     -41142.091     -7883.934      -12289.963      3758.8201    
      2800   325.20213     -41172.424     -583.82283     -5120.24        3758.8201    
      2900   308.20136     -41169.802     -11308.466     -11062.013      3758.8201    
      3000   300.00607     -41169.532     -15254.776     -16464.193      3758.8201    
Loop time of 147.078 on 8 procs for 3000 steps with 350 atoms

Performance: 0.881 ns/day, 27.237 hours/ns, 20.397 timesteps/s, 7.139 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 104.63     | 117.17     | 123.9      |  57.2 | 79.67
Bond    | 0.0084612  | 0.0091219  | 0.010194   |   0.5 |  0.01
Neigh   | 8.3876     | 9.4709     | 9.9937     |  17.3 |  6.44
Comm    | 1.7024     | 8.4373     | 20.98      | 213.0 |  5.74
Output  | 0.001448   | 0.0016001  | 0.0024664  |   0.8 |  0.00
Modify  | 11.385     | 11.912     | 12.996     |  15.5 |  8.10
Other   |            | 0.07633    |            |       |  0.05

Nlocal:          43.75 ave          50 max          37 min
Histogram: 2 0 1 0 0 0 3 1 0 1
Nghost:        3175.75 ave        3248 max        3104 min
Histogram: 2 0 0 1 0 2 1 0 1 1
Neighs:        28486.5 ave       32125 max       24480 min
Histogram: 2 1 0 0 0 0 0 4 0 1

Total # of neighbors = 227892
Ave neighs/atom = 651.12
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -112.490442547832
variable C2neg equal ${d2}
variable C2neg equal -75.9460265325905
variable C3neg equal ${d3}
variable C3neg equal 32.481637879169
variable C4neg equal ${d4}
variable C4neg equal -14.4744954543106
variable C5neg equal ${d5}
variable C5neg equal 16.9258136796952
variable C6neg equal ${d6}
variable C6neg equal 13.892345374291

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.0085
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.170085 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.278115 -0.642)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 123.3 | 125.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.07373     -41128.126     -13629.212      0              3758.8201    
       100   300.16151     -41130.993     -5154.3051     -7409.8124      3758.8201    
       200   317.588       -41135.749      782.0041      -3319.9073      3758.8201    
       300   295.80493     -41126.974     -3476.8362     -4212.6897      3758.8201    
       400   291.13541     -41148.318     -11189.58      -6536.135       3758.8201    
       500   295.39828     -41160.278     -13041.29      -7277.4851      3758.8201    
       600   274.73733     -41127.312     -9964.2643      1071.8007      3758.8201    
       700   307.57026     -41139.093     -11598.383     -2818.6348      3758.8201    
       800   319.28461     -41131.187     -5554.7291     -5028.3546      3758.8201    
       900   314.8208      -41133.255     -6976.6525     -4805.5354      3758.8201    
      1000   308.33323     -41155.018     -3293.8936     -3178.111       3758.8201    
      1100   291.46937     -41159.978     -17066.814     -7940.9647      3758.8201    
      1200   294.43777     -41165.642     -7384.1109     -9492.6086      3758.8201    
      1300   319.6026      -41168.663     -8634.932      -4554.0548      3758.8201    
      1400   312.5135      -41147.093     -7347.4478     -6390.0268      3758.8201    
      1500   303.57856     -41141.778      6009.5428     -3234.3342      3758.8201    
      1600   287.69446     -41135.018     -17805.806     -6855.7854      3758.8201    
      1700   290.25182     -41137.225     -7125.2635     -7354.9702      3758.8201    
      1800   299.82691     -41136.512      9611.7627     -5738.1334      3758.8201    
      1900   306.51729     -41140.846     -7280.3308     -9611.0928      3758.8201    
      2000   302.07309     -41146.613     -14953.219     -15560.483      3758.8201    
      2100   298.59556     -41153.089     -8955.6938     -11014.68       3758.8201    
      2200   290.83834     -41150.524     -18857.401     -10871.042      3758.8201    
      2300   297.55699     -41148.538     -378.97688     -9204.5101      3758.8201    
      2400   317.57724     -41142.8       -8240.55       -14961.532      3758.8201    
      2500   288.42541     -41106.362     -18354.725     -12105.159      3758.8201    
      2600   312.49374     -41152.274     -7113.1853     -8402.3414      3758.8201    
      2700   295.98808     -41169.361     -3073.7707     -12503.268      3758.8201    
      2800   288.32898     -41156.385     -13253.313     -15042.468      3758.8201    
      2900   308.04897     -41163.133     -13851.82      -9889.2526      3758.8201    
      3000   304.77758     -41148.863     -3869.4571     -9392.6808      3758.8201    
Loop time of 146.577 on 8 procs for 3000 steps with 350 atoms

Performance: 0.884 ns/day, 27.144 hours/ns, 20.467 timesteps/s, 7.163 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 84.489     | 112.28     | 123.63     | 148.5 | 76.60
Bond    | 0.0085194  | 0.0090895  | 0.0095048  |   0.3 |  0.01
Neigh   | 6.9216     | 9.0511     | 9.9589     |  39.8 |  6.17
Comm    | 1.7775     | 13.125     | 40.921     | 434.5 |  8.95
Output  | 0.0071225  | 0.0086325  | 0.010016   |   1.1 |  0.01
Modify  | 11.119     | 12.03      | 14.167     |  34.6 |  8.21
Other   |            | 0.07255    |            |       |  0.05

Nlocal:          43.75 ave          56 max          36 min
Histogram: 1 1 1 1 2 1 0 0 0 1
Nghost:         3170.5 ave        3230 max        3118 min
Histogram: 3 0 1 0 0 0 1 1 1 1
Neighs:        28470.2 ave       35859 max       23783 min
Histogram: 1 1 1 2 2 0 0 0 0 1

Total # of neighbors = 227762
Ave neighs/atom = 650.74857
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 123.4 | 125.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   304.77758     -41148.863     -3869.4865      0              3758.8201    
       100   310.10115     -41148.419     -1006.1204     -8522.7508      3758.8201    
       200   301.64402     -41153.482     -7739.5125     -14123.895      3758.8201    
       300   302.78544     -41185.859     -16776.435     -8974.4169      3758.8201    
       400   291.45726     -41184.728     -4470.6616     -15339.854      3758.8201    
       500   289.653       -41162.296     -17159.641     -11079.011      3758.8201    
       600   293.76932     -41148.956     -4218.1901     -8010.7664      3758.8201    
       700   297.43749     -41144.561     -13191.978     -9498.6362      3758.8201    
       800   320.6241      -41166.748     -6493.8281     -14529.559      3758.8201    
       900   290.00932     -41164.926     -13907.439     -12018.198      3758.8201    
      1000   298.59364     -41185.788     -17162.683     -18834.09       3758.8201    
      1100   285.35541     -41162.283     -15811.428     -9416.1824      3758.8201    
      1200   281.73643     -41139.539     -2500.7044     -14039.838      3758.8201    
      1300   300.02198     -41151.455     -1145.7587     -6411.1538      3758.8201    
      1400   293.07755     -41151.488     -7099.329      -11170.411      3758.8201    
      1500   305.35475     -41171.43      -7118.708      -11162.502      3758.8201    
      1600   282.09287     -41169.021     -8471.5791     -5129.3591      3758.8201    
      1700   286.81204     -41185.588     -10619.614     -8045.5053      3758.8201    
      1800   286.17303     -41164.013     -2553.2248     -7303.3633      3758.8201    
      1900   295.89106     -41147.909     -6675.0741     -11957.683      3758.8201    
      2000   306.77186     -41155.24      -3196.6753     -16880.351      3758.8201    
      2100   295.35965     -41151.283     -8959.577      -10098.156      3758.8201    
      2200   284.43268     -41162.95      -13663.577     -10932.641      3758.8201    
      2300   292.76949     -41194.963     -24637.453     -8304.959       3758.8201    
      2400   282.06201     -41176.932     -3656.4435     -6663.1429      3758.8201    
      2500   296.365       -41154.427     -15204.439     -8945.0695      3758.8201    
      2600   297.82052     -41147.725     -6367.2079     -11261.227      3758.8201    
      2700   313.87131     -41159.648     -4771.7038     -9213.4883      3758.8201    
      2800   302.57886     -41150.972     -12653.841     -10911.55       3758.8201    
      2900   296.52709     -41161.215     -3007.6075     -1427.9227      3758.8201    
      3000   277.38151     -41161.629     -14244.311     -12422.753      3758.8201    
Loop time of 146.795 on 8 procs for 3000 steps with 350 atoms

Performance: 0.883 ns/day, 27.184 hours/ns, 20.437 timesteps/s, 7.153 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 101.15     | 117.59     | 123.11     |  61.6 | 80.10
Bond    | 0.008569   | 0.0091658  | 0.0096167  |   0.3 |  0.01
Neigh   | 8.1628     | 9.5255     | 9.9748     |  17.2 |  6.49
Comm    | 2.1401     | 7.6631     | 24.1       | 241.3 |  5.22
Output  | 0.0013834  | 0.0016569  | 0.003097   |   1.3 |  0.00
Modify  | 11.481     | 11.93      | 13.3       |  15.5 |  8.13
Other   |            | 0.07589    |            |       |  0.05

Nlocal:          43.75 ave          56 max          39 min
Histogram: 2 2 2 1 0 0 0 0 0 1
Nghost:        3151.75 ave        3207 max        3106 min
Histogram: 1 1 0 1 1 1 2 0 0 1
Neighs:        28489.1 ave       35949 max       25711 min
Histogram: 2 2 2 1 0 0 0 0 0 1

Total # of neighbors = 227913
Ave neighs/atom = 651.18
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 71.5405584008205
variable C2pos equal ${d2}
variable C2pos equal 50.9423768715686
variable C3pos equal ${d3}
variable C3pos equal -33.2565379760247
variable C4pos equal ${d4}
variable C4pos equal 5.23200245095103
variable C5pos equal ${d5}
variable C5pos equal -6.45557156651369
variable C6pos equal ${d6}
variable C6pos equal -3.12394703098302

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-112.490442547832+${C1pos})
variable C15 equal 0.5*(-112.490442547832+71.5405584008205)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-75.9460265325905+${C2pos})
variable C25 equal 0.5*(-75.9460265325905+50.9423768715686)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(32.481637879169+${C3pos})
variable C35 equal 0.5*(32.481637879169+-33.2565379760247)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-14.4744954543106+${C4pos})
variable C45 equal 0.5*(-14.4744954543106+5.23200245095103)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(16.9258136796952+${C5pos})
variable C55 equal 0.5*(16.9258136796952+-6.45557156651369)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(13.892345374291+${C6pos})
variable C65 equal 0.5*(13.892345374291+-3.12394703098302)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 14.5028

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.5028
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.145028 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.407728 -0.4482 -0.642)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122 | 123.8 | 125.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.07373     -41122.504     -9694.6048      0              3758.8201    
       100   301.42662     -41128.669     -6836.8408     -7041.8328      3758.8201    
       200   315.56138     -41131.883      156.08177     -2481.0427      3758.8201    
       300   284.1766      -41113.915     -4373.3489     -1364.8199      3758.8201    
       400   285.06996     -41141.374     -11046.214     -9810.5449      3758.8201    
       500   294.27741     -41155.335     -7495.3683     -7151.9199      3758.8201    
       600   294.52105     -41150.724     -11235.463     -656.09742      3758.8201    
       700   298.86547     -41136.809     -15971.436     -5833.22        3758.8201    
       800   310.46721     -41129.504      1336.169      -7174.9883      3758.8201    
       900   305.88997     -41125.888     -493.3151      -4068.7114      3758.8201    
      1000   282.54509     -41121.995      767.5045      -5321.8423      3758.8201    
      1100   301.10856     -41153.899     -13639.748     -10703.135      3758.8201    
      1200   262.46768     -41122.797     -639.11132     -12362.009      3758.8201    
      1300   287.88395     -41141.689     -8259.0662     -6709.186       3758.8201    
      1400   300.76373     -41133.009     -11876.163     -9222.569       3758.8201    
      1500   330.16967     -41140.584     -9634.4947     -9052.8597      3758.8201    
      1600   290.34144     -41120.874     -15246.914     -7384.895       3758.8201    
      1700   304.28542     -41162.71      -3612.1546     -6409.1084      3758.8201    
      1800   304.37466     -41172.344     -15513.712     -2449.7601      3758.8201    
      1900   294.63619     -41155.987      2898.6582     -380.69707      3758.8201    
      2000   290.01559     -41134.367     -128.76282     -3922.5214      3758.8201    
      2100   324.61563     -41152.353     -12474.635     -9668.1906      3758.8201    
      2200   307.11548     -41142.693     -10828.361     -6942.4388      3758.8201    
      2300   302.48356     -41171.816     -7114.3291     -2001.1753      3758.8201    
      2400   280.05127     -41153.176     -4792.1687     -8790.0024      3758.8201    
      2500   304.37051     -41162.2       -9473.397      -1676.9451      3758.8201    
      2600   313.3097      -41146.194      6273.8894     -1956.4056      3758.8201    
      2700   303.81343     -41132.307     -6130.9173     -3844.4287      3758.8201    
      2800   320.24203     -41162.031     -5158.9267     -5633.3528      3758.8201    
      2900   298.54754     -41159.719     -6664.9105     -8891.9424      3758.8201    
      3000   282.75013     -41163.05      -6059.6871     -8959.0538      3758.8201    
Loop time of 148.267 on 8 procs for 3000 steps with 350 atoms

Performance: 0.874 ns/day, 27.457 hours/ns, 20.234 timesteps/s, 7.082 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 118.96     | 122.29     | 124.31     |  15.8 | 82.48
Bond    | 0.0086651  | 0.0092764  | 0.010061   |   0.4 |  0.01
Neigh   | 9.6547     | 9.844      | 10.069     |   4.5 |  6.64
Comm    | 2.1419     | 4.1646     | 7.4841     |  85.7 |  2.81
Output  | 0.0069598  | 0.0086427  | 0.010045   |   1.1 |  0.01
Modify  | 11.646     | 11.875     | 12.063     |   4.1 |  8.01
Other   |            | 0.0783     |            |       |  0.05

Nlocal:          43.75 ave          54 max          34 min
Histogram: 1 0 0 2 1 2 0 1 0 1
Nghost:        3171.12 ave        3228 max        3116 min
Histogram: 2 0 0 0 2 2 0 1 0 1
Neighs:        28501.4 ave       34609 max       22516 min
Histogram: 1 0 0 2 1 2 0 1 0 1

Total # of neighbors = 228011
Ave neighs/atom = 651.46
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122 | 123.7 | 125.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   282.75013     -41163.05      -6059.7083      0              3758.8201    
       100   289.7601      -41164.627     -9487.1223     -6681.0417      3758.8201    
       200   302.26816     -41147.685     -22090.991     -13325.903      3758.8201    
       300   318.87195     -41148.253     -7637.6388     -11795.8        3758.8201    
       400   320.2855      -41168.14      -12254.999     -7159.6428      3758.8201    
       500   289.82837     -41151.786     -13701.999     -8406.183       3758.8201    
       600   293.5461      -41167.791     -10312.214     -5832.5232      3758.8201    
       700   283.01614     -41170.718     -14131.306     -12896.45       3758.8201    
       800   287.50647     -41186.581     -15927.314     -8523.0108      3758.8201    
       900   305.68505     -41205.884     -10269.907     -9631.6825      3758.8201    
      1000   284.97305     -41168.845     -22115.301     -9358.384       3758.8201    
      1100   315.61654     -41172.51      -9407.7861     -9247.2496      3758.8201    
      1200   308.18103     -41158.399     -22570.797     -10645.077      3758.8201    
      1300   289.60654     -41159.261     -1188.6975     -8617.2948      3758.8201    
      1400   296.98095     -41192.921     -6147.8053     -12100.503      3758.8201    
      1500   274.00928     -41167.419     -9398.5326     -7175.1761      3758.8201    
      1600   287.99575     -41171.595     -6264.3505     -10683.784      3758.8201    
      1700   321.47546     -41198.165     -4423.4085     -1557.7484      3758.8201    
      1800   307.73142     -41190.756     -3213.2943     -7550.152       3758.8201    
      1900   288.53826     -41198.251     -15590.622     -9942.6966      3758.8201    
      2000   285.94852     -41203.755      141.31985      2329.7807      3758.8201    
      2100   287.54131     -41183.784      4092.86       -5735.3747      3758.8201    
      2200   313.26468     -41185.61       1541.0851     -5250.82        3758.8201    
      2300   316.02906     -41194.562     -6207.1408     -5429.7239      3758.8201    
      2400   319.75914     -41216.053     -6785.9548     -7920.1572      3758.8201    
      2500   288.38847     -41194.076     -8741.1452     -5970.4281      3758.8201    
      2600   309.00546     -41214.568     -6149.3871     -13153.699      3758.8201    
      2700   319.00547     -41213.391     -7445.7355     -11500.665      3758.8201    
      2800   329.65369     -41192.267     -5182.896      -8779.3686      3758.8201    
      2900   302.25401     -41169.601      7853.2921     -6437.584       3758.8201    
      3000   297.26767     -41195.002     -1490.7964     -8773.6258      3758.8201    
Loop time of 146.915 on 8 procs for 3000 steps with 350 atoms

Performance: 0.882 ns/day, 27.206 hours/ns, 20.420 timesteps/s, 7.147 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 114.61     | 119.19     | 122.77     |  25.0 | 81.13
Bond    | 0.0086798  | 0.0092602  | 0.010173   |   0.5 |  0.01
Neigh   | 9.4002     | 9.7986     | 10.161     |   8.6 |  6.67
Comm    | 2.1924     | 5.7678     | 10.355     | 113.8 |  3.93
Output  | 0.0014144  | 0.0015656  | 0.0023791  |   0.8 |  0.00
Modify  | 11.71      | 12.067     | 12.467     |   7.8 |  8.21
Other   |            | 0.07666    |            |       |  0.05

Nlocal:          43.75 ave          50 max          36 min
Histogram: 1 0 0 1 2 0 2 0 0 2
Nghost:        3179.75 ave        3241 max        3111 min
Histogram: 1 1 0 0 2 0 2 0 0 2
Neighs:        28515.8 ave       32179 max       23813 min
Histogram: 1 0 0 1 2 0 2 0 0 2

Total # of neighbors = 228126
Ave neighs/atom = 651.78857
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -34.5657733436823
variable C2neg equal ${d2}
variable C2neg equal -28.093030431366
variable C3neg equal ${d3}
variable C3neg equal 109.590052693386
variable C4neg equal ${d4}
variable C4neg equal -4.10928577900031
variable C5neg equal ${d5}
variable C5neg equal -10.6379164784098
variable C6neg equal ${d6}
variable C6neg equal -8.67467529288853

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.2627 -0.4482 -0.642)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.5028
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.145028 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.2382 14.5028 17.0085) with tilt (-6.117672 -0.4482 -0.642)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.2 | 123 | 124.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.07373     -41131.778     -14174.796      0              3758.8201    
       100   299.98872     -41134.812     -4700.6163     -7852.9776      3758.8201    
       200   307.828       -41125.92       2243.6787     -3361.8175      3758.8201    
       300   291.33038     -41118.114     -7973.0794     -4016.6375      3758.8201    
       400   279.46123     -41132.962     -15375.18      -5937.82        3758.8201    
       500   297.40177     -41160.374     -18614.444     -9364.4946      3758.8201    
       600   296.70822     -41158.215     -4374.7009      2363.5831      3758.8201    
       700   301.49774     -41147.595     -7160.7293     -3818.0075      3758.8201    
       800   323.71235     -41149.017     -4666.6047     -4151.9918      3758.8201    
       900   307.39459     -41135.707      10135.564     -5851.5284      3758.8201    
      1000   281.66692     -41129.604     -5236.2916     -6774.3131      3758.8201    
      1100   288.22731     -41145.882     -16614.105     -4792.1097      3758.8201    
      1200   274.98283     -41126.772     -4290.4238     -8580.3273      3758.8201    
      1300   293.36252     -41127.211      2479.8987     -7153.8457      3758.8201    
      1400   311.98973     -41132.101      14007.674     -1257.0411      3758.8201    
      1500   324.6843      -41140.385      233.89857     -10560.174      3758.8201    
      1600   297.91436     -41139.654     -12762.03      -6240.1763      3758.8201    
      1700   294.0853      -41154.419     -4510.0725     -5269.1632      3758.8201    
      1800   285.57498     -41142.467      2705.229      -10649.969      3758.8201    
      1900   308.66801     -41141.634     -2101.4795     -7544.9934      3758.8201    
      2000   309.46768     -41129.665     -16530.526     -7467.0587      3758.8201    
      2100   291.08906     -41122.683     -6455.0069     -5770.0911      3758.8201    
      2200   308.92847     -41168.119     -11365.3       -74.761092      3758.8201    
      2300   284.80729     -41162.35      -10818.758     -7320.9835      3758.8201    
      2400   292.92648     -41159.111     -6306.2637     -11069.626      3758.8201    
      2500   291.28745     -41139.659     -8745.4763     -6093.5032      3758.8201    
      2600   316.37177     -41149.909     -212.47976     -8935.6277      3758.8201    
      2700   277.42868     -41113.439     -3506.1538     -7266.5608      3758.8201    
      2800   284.91326     -41146.075     -17109.424     -11666.179      3758.8201    
      2900   272.38502     -41152.663     -18252.225     -11642.461      3758.8201    
      3000   290.31047     -41159.907     -5675.1326     -17554.596      3758.8201    
Loop time of 136.823 on 8 procs for 3000 steps with 350 atoms

Performance: 0.947 ns/day, 25.338 hours/ns, 21.926 timesteps/s, 7.674 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 76.564     | 97.436     | 114.36     | 162.8 | 71.21
Bond    | 0.0076023  | 0.0082829  | 0.0088523  |   0.5 |  0.01
Neigh   | 6.8285     | 8.5334     | 9.8966     |  46.0 |  6.24
Comm    | 1.3038     | 18.24      | 39.123     | 376.3 | 13.33
Output  | 0.0064146  | 0.007772   | 0.0088713  |   1.0 |  0.01
Modify  | 11.159     | 12.534     | 14.254     |  38.2 |  9.16
Other   |            | 0.06493    |            |       |  0.05

Nlocal:          43.75 ave          54 max          37 min
Histogram: 2 0 3 0 0 0 1 1 0 1
Nghost:        3152.75 ave        3186 max        3105 min
Histogram: 1 1 0 0 0 1 1 2 1 1
Neighs:        28507.1 ave       34647 max       24419 min
Histogram: 2 0 2 1 0 0 1 1 0 1

Total # of neighbors = 228057
Ave neighs/atom = 651.59143
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.3 | 123 | 124.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.31047     -41159.907     -5675.2173      0              3758.8201    
       100   285.90978     -41144.943     -1400.486      -6839.7273      3758.8201    
       200   318.85048     -41147.599     -3443.4361     -7068.5879      3758.8201    
       300   309.23814     -41128.768     -10312.986     -5836.092       3758.8201    
       400   307.64268     -41140.69      -11605.43      -7240.8286      3758.8201    
       500   300.61689     -41142.413      2648.345      -9830.2887      3758.8201    
       600   299.37915     -41154.252     -7380.6559     -8777.0059      3758.8201    
       700   292.57989     -41162.715     -128.11429     -2692.1078      3758.8201    
       800   294.15327     -41154.723     -7316.6274     -7137.7376      3758.8201    
       900   312.33338     -41138.614     -5940.016      -10369.325      3758.8201    
      1000   318.63859     -41156.281     -13674.916     -11243.636      3758.8201    
      1100   298.10557     -41155.87      -16537.007     -8397.6415      3758.8201    
      1200   300.20036     -41162.881     -2120.4096     -12714.136      3758.8201    
      1300   295.76359     -41151.194      1778.4664     -7242.628       3758.8201    
      1400   306.88263     -41141.611     -1967.2338     -4632.3488      3758.8201    
      1500   308.43912     -41124.236     -4544.8728     -4444.7755      3758.8201    
      1600   312.02404     -41138.467     -9573.4364     -10024.852      3758.8201    
      1700   307.14626     -41163.674     -9078.7789     -6543.6692      3758.8201    
      1800   288.8655      -41156.86      -9131.1181     -7156.6919      3758.8201    
      1900   287.98181     -41155.789      10088.869     -6430.5853      3758.8201    
      2000   291.21007     -41140.747     -6503.6616     -10591.182      3758.8201    
      2100   325.19361     -41141.178     -4899.9196     -7999.3567      3758.8201    
      2200   311.59809     -41133.208     -1986.5484     -8863.2228      3758.8201    
      2300   306.76755     -41149.77       2311.8893     -5928.2518      3758.8201    
      2400   295.10864     -41156.716     -11859.786     -4468.7935      3758.8201    
      2500   291.15565     -41160.915     -11637.92      -8972.2449      3758.8201    
      2600   295.84547     -41160.854     -10179.632     -6904.745       3758.8201    
      2700   322.71262     -41157.1       -6488.3417     -6076.4175      3758.8201    
      2800   313.96546     -41134.929     -833.40642     -5093.7184      3758.8201    
      2900   318.05166     -41160.57      -12646.951     -6482.5616      3758.8201    
      3000   303.72404     -41168.158     -18647.786     -12845.649      3758.8201    
Loop time of 136.522 on 8 procs for 3000 steps with 350 atoms

Performance: 0.949 ns/day, 25.282 hours/ns, 21.974 timesteps/s, 7.691 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 77.124     | 94.274     | 114.14     | 166.6 | 69.05
Bond    | 0.0074367  | 0.0079413  | 0.0084308  |   0.4 |  0.01
Neigh   | 6.8285     | 8.2249     | 9.8272     |  47.7 |  6.02
Comm    | 1.0978     | 20.986     | 38.15      | 353.0 | 15.37
Output  | 0.0013422  | 0.0014832  | 0.0020837  |   0.6 |  0.00
Modify  | 11.344     | 12.965     | 14.381     |  38.3 |  9.50
Other   |            | 0.06339    |            |       |  0.05

Nlocal:          43.75 ave          53 max          36 min
Histogram: 2 0 0 1 0 4 0 0 0 1
Nghost:        3150.88 ave        3222 max        3091 min
Histogram: 2 0 0 1 1 2 0 1 0 1
Neighs:        28498.8 ave       34070 max       23846 min
Histogram: 2 0 0 1 0 3 1 0 0 1

Total # of neighbors = 227990
Ave neighs/atom = 651.4
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 75.8255532725149
variable C2pos equal ${d2}
variable C2pos equal 103.736094332303
variable C3pos equal ${d3}
variable C3pos equal 23.8152093038832
variable C4pos equal ${d4}
variable C4pos equal 2.12961880346376
variable C5pos equal ${d5}
variable C5pos equal 3.89212375754313
variable C6pos equal ${d6}
variable C6pos equal 8.88146386240274

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-34.5657733436823+${C1pos})
variable C16 equal 0.5*(-34.5657733436823+75.8255532725149)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-28.093030431366+${C2pos})
variable C26 equal 0.5*(-28.093030431366+103.736094332303)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(109.590052693386+${C3pos})
variable C36 equal 0.5*(109.590052693386+23.8152093038832)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-4.10928577900031+${C4pos})
variable C46 equal 0.5*(-4.10928577900031+2.12961880346376)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(-10.6379164784098+${C5pos})
variable C56 equal 0.5*(-10.6379164784098+3.89212375754313)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(-8.67467529288853+${C6pos})
variable C66 equal 0.5*(-8.67467529288853+8.88146386240274)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 9.4877443581566
variable C22all equal ${C22}
variable C22all equal 62.1669515379392
variable C33all equal ${C33}
variable C33all equal 15.9940596833815

variable C44all equal ${C44}
variable C44all equal 0.327993946151285
variable C55all equal ${C55}
variable C55all equal 5.23512105659075
variable C66all equal ${C66}
variable C66all equal 0.103394284757105

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(28.8627066351082+${C21})
variable C12all equal 0.5*(28.8627066351082+-1.41937467842653)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(11.5681979791059+${C31})
variable C13all equal 0.5*(11.5681979791059+-3.04967538246685)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(0.851707828369552+${C32})
variable C23all equal 0.5*(0.851707828369552+1.86896489459485)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(30.9068603052465+${C41})
variable C14all equal 0.5*(30.9068603052465+-12.1896593741586)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-20.4749420735058+${C51})
variable C15all equal 0.5*(-20.4749420735058+-7.18860275613793)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(20.6298899644163+${C61})
variable C16all equal 0.5*(20.6298899644163+3.30748896591887)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(30.1764939843689+${C42})
variable C24all equal 0.5*(30.1764939843689+3.00361541161881)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-12.5018248305109+${C52})
variable C25all equal 0.5*(-12.5018248305109+2.68175866317138)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(37.8215319504685+${C62})
variable C26all equal 0.5*(37.8215319504685+11.3534096571373)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(38.9428151040842+${C43})
variable C34all equal 0.5*(38.9428151040842+-6.33466117862933)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-0.387450048427851+${C53})
variable C35all equal 0.5*(-0.387450048427851+-1.54523104268849)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(66.7026309986346+${C63})
variable C36all equal 0.5*(66.7026309986346+8.91752076049869)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-4.62124650167979+${C54})
variable C45all equal 0.5*(-4.62124650167979+-5.35963312033518)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-0.989833487768275+${C64})
variable C46all equal 0.5*(-0.989833487768275+2.03199645080226)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-3.37289636043333+${C65})
variable C56all equal 0.5*(-3.37289636043333+5.38419917165399)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 1:01:18
