LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 30*${nthermo}       # steps of equilibration run 20
variable nequil equal 30*100       
variable nrun equal 30*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 30*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-9-vasp
read_data       ${structure}.data
read_data       333U-50C-9-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.006 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 6.58953e-05 on 8 procs for 1 steps with 386 atoms

44.0% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 8.38e-07   | 1.755e-06  | 1.886e-06  |   0.0 |  2.66
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 4.4e-06    | 5.4386e-06 | 5.587e-06  |   0.0 |  8.25
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 5.87e-05   |            |       | 89.08

Nlocal:          48.25 ave          55 max          40 min
Histogram: 2 0 0 0 2 0 1 0 1 2
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-9-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 3000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -0.82 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 142.4 | 144.4 | 146.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -43202.648      118796.37      0              1.7478941      3875.657     
       100   631.0338      -43895.466     -4819.2253      7810.6857      1.7478941      3875.657     
       200   533.30843     -44157.498      15862.756      4773.0232      1.7478941      3875.657     
       300   425.22341     -44305.336      2256.7082     -2590.9668      1.7478941      3875.657     
       400   350.71086     -44415.617      8647.0575     -2223.4531      1.7478941      3875.657     
       500   327.82267     -44524.572      11246.901     -2983.3642      1.7478941      3875.657     
       600   281.23069     -44560.92       9461.1727      475.88207      1.7478941      3875.657     
       700   266.77522     -44585.699      10549.532     -2495.1706      1.7478941      3875.657     
       800   303.32794     -44620.951      15593.795      5822.5453      1.7478941      3875.657     
       900   299.36152     -44595.018      4527.8559     -4715.4924      1.7478941      3875.657     
      1000   319.16248     -44598.921     -1186.3394      1727.7141      1.7478941      3875.657     
      1100   314.01384     -44597.008      4234.2333     -2897.1931      1.7478941      3875.657     
      1200   296.63954     -44596.234      2232.5129     -4474.6891      1.7478941      3875.657     
      1300   297.2041      -44617.222      7165.1973     -553.19322      1.7478941      3875.657     
      1400   298.61517     -44631.197      11973.132      4121.1871      1.7478941      3875.657     
      1500   302.89362     -44634.621      14442.442      3407.9435      1.7478941      3875.657     
      1600   302.27445     -44633.277      10672.965     -1314.5853      1.7478941      3875.657     
      1700   299.78312     -44632.561      3910.9904     -3297.06        1.7478941      3875.657     
      1800   304.25195     -44648.038     -6322.9145     -3326.8684      1.7478941      3875.657     
      1900   301.44067     -44659.194      23690.598     -1816.0767      1.7478941      3875.657     
      2000   289.87138     -44655.159      8378.5973     -2485.0895      1.7478941      3875.657     
      2100   301.28218     -44667.342     -2611.4715      243.11607      1.7478941      3875.657     
      2200   303.40474     -44665.078      13772.112     -1148.2376      1.7478941      3875.657     
      2300   302.72932     -44654.236     -8117.9902     -4784.0309      1.7478941      3875.657     
      2400   298.23291     -44646.643      14731.88      -1508.3234      1.7478941      3875.657     
      2500   295.62437     -44648.964      3601.6509     -1159.4252      1.7478941      3875.657     
      2600   314.28699     -44679.893      8252.674       977.36108      1.7478941      3875.657     
      2700   285.32117     -44673.293     -9809.669      -644.63027      1.7478941      3875.657     
      2800   289.2142      -44686.236     -12047.076     -5303.0917      1.7478941      3875.657     
      2900   285.88087     -44660.043      4061.6564     -7955.176       1.7478941      3875.657     
      3000   340.84522     -44694.627      2804.997      -153.13585      1.7478941      3875.657     
Loop time of 170.137 on 8 procs for 3000 steps with 386 atoms

Performance: 0.762 ns/day, 31.507 hours/ns, 17.633 timesteps/s, 6.806 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 137.63     | 140.35     | 143.88     |  17.5 | 82.49
Bond    | 0.0079329  | 0.0085553  | 0.0092083  |   0.5 |  0.01
Neigh   | 11.151     | 11.385     | 11.568     |   3.8 |  6.69
Comm    | 1.6815     | 5.2254     | 7.9451     |  90.9 |  3.07
Output  | 0.0016742  | 0.0018183  | 0.0026137  |   0.7 |  0.00
Modify  | 12.907     | 13.09      | 13.322     |   3.5 |  7.69
Other   |            | 0.07986    |            |       |  0.05

Nlocal:          48.25 ave          58 max          40 min
Histogram: 1 1 1 2 0 0 1 0 0 2
Nghost:         3723.5 ave        3796 max        3645 min
Histogram: 1 1 0 1 1 0 1 1 1 1
Neighs:        33606.2 ave       40009 max       27942 min
Histogram: 1 1 1 2 0 0 1 0 0 2

Total # of neighbors = 268850
Ave neighs/atom = 696.50259
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-9-vasp_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.6078
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.4502
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.3502

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--153.135854203916)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--153.135854203916)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-6788.13349282808)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-6788.13349282808)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-8841.20170649372)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-8841.20170649372)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--954.148366950205)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--954.148366950205)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--717.610626253598)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--717.610626253598)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--3473.92187866932)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--3473.92187866932)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 16.6078
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.6078
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.166078 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.166078 xy delta 0.094505 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.166078 xy delta 0.094505 xz delta 0.010717 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.441722 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.441722 13.4502 17.3502) with tilt (-9.355995 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.441722 13.4502 17.3502) with tilt (-9.355995 -1.060983 0.0034)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.1 | 144.9 | 146.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   340.84522     -44680.601      46257.991      0              3836.9004    
       100   317.43312     -44667.132     -2595.889       3289.8306      3836.9004    
       200   298.2131      -44685.368      16414.611      2277.2086      3836.9004    
       300   273.09702     -44679.484      8954.7706      3106.9329      3836.9004    
       400   290.25876     -44689.451      2640.1973      914.18245      3836.9004    
       500   302.09796     -44674.001      9602.5006      162.53249      3836.9004    
       600   300.6721      -44651.688      7380.0724      3563.1642      3836.9004    
       700   309.61328     -44671.08      -2421.2907      3580.3946      3836.9004    
       800   290.2471      -44674.938      15438.023      1871.5353      3836.9004    
       900   293.94339     -44690.787      13294.212      3298.9456      3836.9004    
      1000   291.67304     -44682.917     -2124.9077      771.35806      3836.9004    
      1100   314.51591     -44687.525      19286.069      3801.0557      3836.9004    
      1200   301.80746     -44662.376     -6794.2441     -2017.7172      3836.9004    
      1300   291.91831     -44661.334     -5798.2338      374.1254       3836.9004    
      1400   294.23758     -44695.951     -964.01263      750.03122      3836.9004    
      1500   275.43678     -44685.771     -2580.5368      5279.2997      3836.9004    
      1600   309.89888     -44712.37       11902.884      4365.2699      3836.9004    
      1700   298.23602     -44685.497      2362.1947      2795.7929      3836.9004    
      1800   293.97955     -44675.951      527.43596     -575.78994      3836.9004    
      1900   309.98797     -44691.485      12985.938      2417.1802      3836.9004    
      2000   301.31747     -44686.955      17459.735      2904.4919      3836.9004    
      2100   313.37677     -44708.514      7916.9533      1017.4554      3836.9004    
      2200   311.95903     -44718.883      3415.0516      7903.0833      3836.9004    
      2300   290.25025     -44696.258      4183.8075     -1270.2357      3836.9004    
      2400   299.65233     -44679.098      12461.275      1659.3882      3836.9004    
      2500   307.81168     -44671.495      5209.0977      6169.2375      3836.9004    
      2600   311.03208     -44682.285     -8303.9224     -817.87406      3836.9004    
      2700   312.60318     -44708.569      5718.9509     -973.46621      3836.9004    
      2800   284.6996      -44690.01      -1458.6099      3541.5324      3836.9004    
      2900   288.81461     -44692.238      3180.5873      1100.7117      3836.9004    
      3000   304.27882     -44704.258      24284.573      6079.6258      3836.9004    
Loop time of 172.252 on 8 procs for 3000 steps with 386 atoms

Performance: 0.752 ns/day, 31.899 hours/ns, 17.416 timesteps/s, 6.723 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 98.625     | 137.22     | 145.94     | 125.7 | 79.66
Bond    | 0.0078887  | 0.0084465  | 0.0090905  |   0.5 |  0.00
Neigh   | 8.4729     | 11.112     | 11.661     |  30.1 |  6.45
Comm    | 1.6983     | 10.432     | 49.038     | 455.9 |  6.06
Output  | 0.0066967  | 0.0083979  | 0.0096105  |   1.1 |  0.00
Modify  | 12.85      | 13.391     | 16.031     |  27.4 |  7.77
Other   |            | 0.07734    |            |       |  0.04

Nlocal:          48.25 ave          57 max          43 min
Histogram: 1 1 2 2 0 0 0 1 0 1
Nghost:        3775.88 ave        3803 max        3739 min
Histogram: 1 1 0 0 0 1 2 1 0 2
Neighs:        33990.1 ave       39836 max       30256 min
Histogram: 1 1 2 2 0 0 0 1 0 1

Total # of neighbors = 271921
Ave neighs/atom = 704.45855
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.1 | 144.9 | 146.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   304.27882     -44704.258      24284.542      0              3836.9004    
       100   298.11151     -44692.903      9140.7033      2408.3821      3836.9004    
       200   312.56305     -44679.98       9676.4925      2305.3695      3836.9004    
       300   297.69146     -44654.919      3332.5993      2072.6595      3836.9004    
       400   301.70745     -44693.774      10836.674      3417.1376      3836.9004    
       500   300.9066      -44713.07       10296.593      2892.3256      3836.9004    
       600   301.17158     -44709.424     -882.76261     -2583.0109      3836.9004    
       700   314.25948     -44710.068      3948.8056      982.95823      3836.9004    
       800   307.38435     -44694.129      11427.977      1106.6572      3836.9004    
       900   304.87447     -44703.134      10955.847     -4850.8017      3836.9004    
      1000   293.5964      -44708.926      13785.462      1049.8698      3836.9004    
      1100   290.00606     -44712.853      7592.0175     -727.51188      3836.9004    
      1200   297.35846     -44718.671      6285.5131      337.31587      3836.9004    
      1300   296.27161     -44702.816      19672.238      2234.17        3836.9004    
      1400   302.00322     -44708.294      4431.0397      433.2106       3836.9004    
      1500   305.12254     -44736.392      5970.9151      2519.4443      3836.9004    
      1600   290.90423     -44741.136      13269.595      5491.0358      3836.9004    
      1700   302.68674     -44749.375      1004.8117      2134.4648      3836.9004    
      1800   299.25337     -44716.608      1907.9271     -4650.7205      3836.9004    
      1900   308.67411     -44695.333      4882.5728     -7383.8416      3836.9004    
      2000   309.26443     -44713.004      14593.367     -4556.7188      3836.9004    
      2100   316.26912     -44749.045      5438.0875      2769.5293      3836.9004    
      2200   301.15318     -44747.117      8758.3571      1106.8894      3836.9004    
      2300   286.89966     -44736.008      525.38328     -1173.7945      3836.9004    
      2400   288.38232     -44714.838     -3468.4881      702.56366      3836.9004    
      2500   314.08354     -44717.946      2493.4943     -3218.8094      3836.9004    
      2600   310.85616     -44723.395      13772.226     -2828.6298      3836.9004    
      2700   302.65946     -44733.207      16001.569      6091.0436      3836.9004    
      2800   298.97599     -44748.332      1072.9896     -4672.0554      3836.9004    
      2900   290.2907      -44743.854      19076.072      449.59822      3836.9004    
      3000   287.80358     -44719.296     -9814.5524     -2507.9331      3836.9004    
Loop time of 170.957 on 8 procs for 3000 steps with 386 atoms

Performance: 0.758 ns/day, 31.659 hours/ns, 17.548 timesteps/s, 6.774 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 95.949     | 134.22     | 144.49     | 141.8 | 78.51
Bond    | 0.0078018  | 0.0083621  | 0.0089411  |   0.4 |  0.00
Neigh   | 8.2623     | 10.873     | 11.593     |  33.8 |  6.36
Comm    | 2.0797     | 12.353     | 50.634     | 467.6 |  7.23
Output  | 0.0012803  | 0.0014434  | 0.0022232  |   0.8 |  0.00
Modify  | 12.703     | 13.422     | 16.034     |  30.4 |  7.85
Other   |            | 0.07799    |            |       |  0.05

Nlocal:          48.25 ave          60 max          41 min
Histogram: 2 0 2 0 1 2 0 0 0 1
Nghost:        3748.75 ave        3774 max        3705 min
Histogram: 1 0 0 1 0 1 0 3 0 2
Neighs:        33954.4 ave       41797 max       29100 min
Histogram: 2 0 2 0 1 2 0 0 0 1

Total # of neighbors = 271635
Ave neighs/atom = 703.71762
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -23.8599833932707
variable C2neg equal ${d2}
variable C2neg equal -21.8520224180934
variable C3neg equal ${d3}
variable C3neg equal -29.2892816719752
variable C4neg equal ${d4}
variable C4neg equal 20.8881671960555
variable C5neg equal ${d5}
variable C5neg equal 1.72909566705885
variable C6neg equal ${d6}
variable C6neg equal 34.5001827770385

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.6078
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.166078 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.166078 xy delta -0.094505 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.166078 xy delta -0.094505 xz delta -0.010717 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.773878 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.773878 13.4502 17.3502) with tilt (-9.545005 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.773878 13.4502 17.3502) with tilt (-9.545005 -1.082417 0.0034)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 141.4 | 143.7 | 146.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   340.84522     -44672.552     -36868.413      0              3914.4136    
       100   321.77604     -44663.988      1065.1196     -11766.6        3914.4136    
       200   300.77741     -44679.053      1754.4047     -11316.886      3914.4136    
       300   278.53555     -44676.731      10608.781     -8488.4243      3914.4136    
       400   303.41901     -44693.619     -8552.4909     -11139.391      3914.4136    
       500   307.17638     -44666.807     -7587.4483     -9852.4956      3914.4136    
       600   305.86497     -44643.462      1739.3372     -9015.6454      3914.4136    
       700   321.31873     -44668.274     -521.61363     -8525.0234      3914.4136    
       800   296.63604     -44669.463      6988.6537     -6254.4932      3914.4136    
       900   279.97062     -44667.642      8746.4198     -2732.1706      3914.4136    
      1000   296.17403     -44670.938     -9152.3598     -8973.5629      3914.4136    
      1100   292.08431     -44647.608      6048.2548     -8395.576       3914.4136    
      1200   321.80779     -44684.293      3603.1817     -3035.0954      3914.4136    
      1300   301.67341     -44691.829      1373.6161     -5666.748       3914.4136    
      1400   287.34843     -44689.761      16484.848     -4784.4503      3914.4136    
      1500   284.40003     -44671.751     -2352.1114     -7537.8607      3914.4136    
      1600   311.15137     -44684.627      7461.2941     -2150.6326      3914.4136    
      1700   305.97039     -44678.582     -4586.9223     -9397.0374      3914.4136    
      1800   290.39437     -44675.188      2539.0289     -7375.6034      3914.4136    
      1900   302.46035     -44697.274      6505.9231     -3447.1882      3914.4136    
      2000   306.10521     -44704.313      8774.5471     -2435.0081      3914.4136    
      2100   297.99214     -44691.32       4787.7503     -5426.6295      3914.4136    
      2200   333.47539     -44687.626      295.50759     -5445.0681      3914.4136    
      2300   325.00071     -44674.54      -2755.1243     -6965.3018      3914.4136    
      2400   305.50233     -44680.32       5887.889      -3812.6698      3914.4136    
      2500   305.58216     -44698.859     -1882.9216     -3948.7416      3914.4136    
      2600   308.14076     -44703.767      6071.1919     -1880.3526      3914.4136    
      2700   311.99337     -44693.355      998.32982     -4168.761       3914.4136    
      2800   315.5421      -44663.925      3415.5016      761.69927      3914.4136    
      2900   319.74069     -44669.795      7155.5658     -5153.5828      3914.4136    
      3000   296.24998     -44680.153      11505.653     -982.4167       3914.4136    
Loop time of 168.6 on 8 procs for 3000 steps with 386 atoms

Performance: 0.769 ns/day, 31.222 hours/ns, 17.794 timesteps/s, 6.868 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 94.359     | 128.87     | 142.69     | 173.0 | 76.44
Bond    | 0.0077561  | 0.0082854  | 0.0088985  |   0.4 |  0.00
Neigh   | 8.0875     | 10.538     | 11.481     |  43.5 |  6.25
Comm    | 1.618      | 15.449     | 49.971     | 500.0 |  9.16
Output  | 0.0068632  | 0.0086579  | 0.0099823  |   1.1 |  0.01
Modify  | 12.711     | 13.649     | 16.097     |  38.2 |  8.10
Other   |            | 0.07547    |            |       |  0.04

Nlocal:          48.25 ave          59 max          40 min
Histogram: 2 0 1 1 1 1 0 0 1 1
Nghost:        3724.62 ave        3764 max        3675 min
Histogram: 1 0 1 1 1 0 0 1 2 1
Neighs:        33287.8 ave       40238 max       27869 min
Histogram: 2 0 1 1 1 1 0 0 0 2

Total # of neighbors = 266302
Ave neighs/atom = 689.90155
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 141.4 | 143.7 | 146.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.24998     -44680.153      11505.625      0              3914.4136    
       100   309.32537     -44703.259     -8700.3934     -2559.8306      3914.4136    
       200   297.08023     -44716.431     -10746.621     -11020.035      3914.4136    
       300   280.90529     -44715.993      2614.1718     -5447.0899      3914.4136    
       400   298.38731     -44703.337      2060.2094     -2413.6406      3914.4136    
       500   300.4532      -44680.553      350.3105       124.46473      3914.4136    
       600   293.78625     -44668.507      6274.9307     -3468.9843      3914.4136    
       700   302.89423     -44682.899      1083.9871     -87.772791      3914.4136    
       800   290.08215     -44690.417      7314.1653     -4103.8666      3914.4136    
       900   301.57942     -44722.648     -2929.5437     -6190.7797      3914.4136    
      1000   281.90261     -44710.974     -3473.4117     -6551.9026      3914.4136    
      1100   274.15229     -44691.003      5254.7648     -4065.6882      3914.4136    
      1200   297.88259     -44684.009     -13780.454     -6037.2252      3914.4136    
      1300   313.89648     -44686.174      5929.9621      1579.2431      3914.4136    
      1400   290.50007     -44662.597      4765.73       -3870.6204      3914.4136    
      1500   313.42172     -44710.859      4884.9624     -6375.4477      3914.4136    
      1600   302.76992     -44729.983     -832.04554     -6099.3099      3914.4136    
      1700   283.55529     -44708.075      618.73276     -8201.0525      3914.4136    
      1800   275.6885      -44684.406      10263.666     -7014.2035      3914.4136    
      1900   289.43931     -44682.547      3814.7502     -9824.7445      3914.4136    
      2000   293.9593      -44681.84      -2975.1479     -567.86548      3914.4136    
      2100   311.79663     -44698.602      8415.7356     -1338.6307      3914.4136    
      2200   297.25649     -44683.254     -5614.6537     -2802.9251      3914.4136    
      2300   293.53429     -44705.577     -279.42941      1816.8643      3914.4136    
      2400   273.33451     -44700.48       10412.653      415.57323      3914.4136    
      2500   297.02145     -44710.774      11397.935     -1786.0257      3914.4136    
      2600   312.02449     -44698.804      3484.6352     -4304.1572      3914.4136    
      2700   303.91938     -44682.56       8534.2406     -3240.696       3914.4136    
      2800   289.82028     -44676.009      7776.038       473.87687      3914.4136    
      2900   285.33528     -44680.033      3879.0651     -1956.9186      3914.4136    
      3000   290.8183      -44686.84       5835.9991     -4236.6349      3914.4136    
Loop time of 168.278 on 8 procs for 3000 steps with 386 atoms

Performance: 0.770 ns/day, 31.163 hours/ns, 17.828 timesteps/s, 6.881 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 95.984     | 127.5      | 142.07     | 164.1 | 75.77
Bond    | 0.0077401  | 0.0081711  | 0.0089026  |   0.5 |  0.00
Neigh   | 8.0849     | 10.417     | 11.481     |  42.5 |  6.19
Comm    | 1.8769     | 16.452     | 47.978     | 456.9 |  9.78
Output  | 0.0011948  | 0.0013548  | 0.0020741  |   0.7 |  0.00
Modify  | 12.751     | 13.821     | 16.151     |  36.9 |  8.21
Other   |            | 0.0751     |            |       |  0.04

Nlocal:          48.25 ave          58 max          43 min
Histogram: 3 0 1 1 1 0 1 0 0 1
Nghost:        3722.62 ave        3762 max        3675 min
Histogram: 2 0 0 1 0 1 1 1 0 2
Neighs:        33268.2 ave       39661 max       29857 min
Histogram: 3 0 1 1 1 0 1 0 0 1

Total # of neighbors = 266146
Ave neighs/atom = 689.49741
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 41.3760535785134
variable C2pos equal ${d2}
variable C2pos equal 72.9944370367113
variable C3pos equal ${d3}
variable C3pos equal 44.6508067595981
variable C4pos equal ${d4}
variable C4pos equal -12.2500006006067
variable C5pos equal ${d5}
variable C5pos equal -18.7759679941399
variable C6pos equal ${d6}
variable C6pos equal -26.944179884086

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(-23.8599833932707+${C1pos})
variable C11 equal 0.5*(-23.8599833932707+41.3760535785134)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(-21.8520224180934+${C2pos})
variable C21 equal 0.5*(-21.8520224180934+72.9944370367113)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(-29.2892816719752+${C3pos})
variable C31 equal 0.5*(-29.2892816719752+44.6508067595981)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(20.8881671960555+${C4pos})
variable C41 equal 0.5*(20.8881671960555+-12.2500006006067)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(1.72909566705885+${C5pos})
variable C51 equal 0.5*(1.72909566705885+-18.7759679941399)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(34.5001827770385+${C6pos})
variable C61 equal 0.5*(34.5001827770385+-26.944179884086)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.4502
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4502
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.134502 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.134502 yz delta -3.4e-05 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.6078 13.315698 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.6078 13.315698 17.3502) with tilt (-9.4505 -1.0717 0.003366)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.6 | 145.4 | 147.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   340.84522     -44679.429      41627.736      0              3836.9004    
       100   310.9884      -44659.636      3888.2867     -1254.4928      3836.9004    
       200   302.07663     -44690.807      6913.0714     -1965.8664      3836.9004    
       300   285.14992     -44694.942     -5146.7159     -2203.5869      3836.9004    
       400   295.96166     -44698.23       3613.7178     -2855.881       3836.9004    
       500   313.66631     -44688.623      3051.7743     -2413.0289      3836.9004    
       600   320.79857     -44671.442      9447.5378     -1415.671       3836.9004    
       700   312.67541     -44660.316      13081.582      5913.0564      3836.9004    
       800   298.51287     -44672.242      12409.712      3054.8339      3836.9004    
       900   293.39328     -44692.231      16876.889      37.447673      3836.9004    
      1000   294.13518     -44695.996      10621.531     -1543.9979      3836.9004    
      1100   301.08376     -44688.7        11338.632     -2355.1844      3836.9004    
      1200   306.02822     -44677.933      10255.377      725.7549       3836.9004    
      1300   317.01976     -44694.4        13362.758     -398.18727      3836.9004    
      1400   297.12768     -44702.509      9056.5725      3042.0535      3836.9004    
      1500   295.96651     -44721.032      6871.3851      3565.3152      3836.9004    
      1600   294.21192     -44710.466      4603.5294      321.83927      3836.9004    
      1700   303.07221     -44702.044      10888.046      681.66571      3836.9004    
      1800   308.48228     -44694.997      21326.162     -1228.5755      3836.9004    
      1900   307.85326     -44689.516      12420.784     -1246.1067      3836.9004    
      2000   284.9216      -44661.451      9730.7123      5264.7554      3836.9004    
      2100   291.88868     -44671.801      5949.8675     -2641.1896      3836.9004    
      2200   287.05175     -44690.905     -3059.0237      1462.5852      3836.9004    
      2300   305.90625     -44733.884     -2876.1594     -2974.1736      3836.9004    
      2400   282.14719     -44713.344      9840.0393     -3026.9704      3836.9004    
      2500   294.09702     -44703.852      6590.6466      2984.1588      3836.9004    
      2600   309.25655     -44691.64       7325.2287      4439.0169      3836.9004    
      2700   317.3242      -44712.575     -1059.574      -483.51161      3836.9004    
      2800   308.74066     -44717.489      2059.4386      1322.2086      3836.9004    
      2900   294.56697     -44707.8        8881.8068     -4483.637       3836.9004    
      3000   300.32333     -44716.461     -1581.8093     -1625.8526      3836.9004    
Loop time of 172.297 on 8 procs for 3000 steps with 386 atoms

Performance: 0.752 ns/day, 31.907 hours/ns, 17.412 timesteps/s, 6.721 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 99.085     | 127.46     | 145.85     | 183.2 | 73.98
Bond    | 0.0075515  | 0.0080967  | 0.0086746  |   0.5 |  0.00
Neigh   | 8.2805     | 10.358     | 11.797     |  49.2 |  6.01
Comm    | 1.6792     | 20.075     | 48.452     | 461.5 | 11.65
Output  | 0.0066571  | 0.0081461  | 0.009204   |   1.0 |  0.00
Modify  | 12.874     | 14.314     | 16.405     |  42.1 |  8.31
Other   |            | 0.07462    |            |       |  0.04

Nlocal:          48.25 ave          63 max          41 min
Histogram: 2 2 1 1 0 0 1 0 0 1
Nghost:        3776.38 ave        3813 max        3749 min
Histogram: 1 1 2 0 0 2 1 0 0 1
Neighs:        33959.4 ave       43811 max       28937 min
Histogram: 2 2 1 1 0 0 1 0 0 1

Total # of neighbors = 271675
Ave neighs/atom = 703.82124
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.7 | 145.4 | 147.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   300.32333     -44716.461     -1581.7777      0              3836.9004    
       100   310.31321     -44722.938     -2635.0921      233.45522      3836.9004    
       200   287.87409     -44697.737      7016.1503      2180.9838      3836.9004    
       300   299.85747     -44733.1        5010.9081     -5605.3658      3836.9004    
       400   283.56876     -44726.75       2678.3909     -1764.39        3836.9004    
       500   275.64898     -44702.889      6645.1978      139.88663      3836.9004    
       600   300.68041     -44697.417      5660.2033      1721.5663      3836.9004    
       700   325.90244     -44724.232      6682.7201      3177.5577      3836.9004    
       800   287.22563     -44696.902      12254.519      613.58739      3836.9004    
       900   302.78964     -44734.772      5264.875      -2090.0935      3836.9004    
      1000   294.42424     -44747.823      3280.8774     -1302.4722      3836.9004    
      1100   283.14297     -44741.341      3750.8131     -780.07529      3836.9004    
      1200   295.85036     -44719.727      8804.4503     -684.9771       3836.9004    
      1300   311.61502     -44713.358     -5739.1848     -314.48649      3836.9004    
      1400   326.49431     -44722.831      1249.4973      2750.633       3836.9004    
      1500   296.97366     -44708.313      6610.3566     -915.84085      3836.9004    
      1600   292.73126     -44730.924      13969.501      1508.5187      3836.9004    
      1700   290.47825     -44726.524      7321.1347     -1839.4551      3836.9004    
      1800   298.61805     -44717.605      8403.3916     -1967.9628      3836.9004    
      1900   284.76115     -44688.96       13005.436      755.08763      3836.9004    
      2000   289.47924     -44684.238      7727.4734      491.09721      3836.9004    
      2100   282.50075     -44675.686      2331.2616      4486.0787      3836.9004    
      2200   292.83754     -44685.796      2051.0694      3694.7891      3836.9004    
      2300   306.70087     -44694.777      11181.818      5360.1326      3836.9004    
      2400   307.58416     -44695.742      7451.9         6569.3666      3836.9004    
      2500   301.37374     -44708.247     -1592.535       1422.9355      3836.9004    
      2600   289.01891     -44715.511      3581.0107      1309.9721      3836.9004    
      2700   299.11492     -44724.628      12468.901     -242.19046      3836.9004    
      2800   328.5856      -44723.253      2496.1672      3391.9076      3836.9004    
      2900   307.94904     -44686.777      2452.8045      4871.0856      3836.9004    
      3000   283.33108     -44673.771      8225.49        3566.8438      3836.9004    
Loop time of 171.719 on 8 procs for 3000 steps with 386 atoms

Performance: 0.755 ns/day, 31.800 hours/ns, 17.470 timesteps/s, 6.744 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 99.647     | 127.37     | 144.84     | 182.6 | 74.18
Bond    | 0.0075594  | 0.0081944  | 0.0087673  |   0.4 |  0.00
Neigh   | 8.2616     | 10.381     | 11.703     |  47.0 |  6.05
Comm    | 2.2193     | 19.689     | 47.411     | 464.2 | 11.47
Output  | 0.0012699  | 0.0013994  | 0.0020433  |   0.7 |  0.00
Modify  | 12.85      | 14.191     | 16.327     |  40.5 |  8.26
Other   |            | 0.07523    |            |       |  0.04

Nlocal:          48.25 ave          59 max          42 min
Histogram: 2 0 3 0 1 0 0 1 0 1
Nghost:        3785.88 ave        3811 max        3760 min
Histogram: 2 0 0 1 1 0 2 0 1 1
Neighs:        33976.1 ave       41197 max       29667 min
Histogram: 2 0 3 0 1 0 0 1 0 1

Total # of neighbors = 271809
Ave neighs/atom = 704.16839
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 37.6926937152972
variable C2neg equal ${d2}
variable C2neg equal 56.372523028633
variable C3neg equal ${d3}
variable C3neg equal 38.4637190492845
variable C4neg equal ${d4}
variable C4neg equal 14.3744928111676
variable C5neg equal ${d5}
variable C5neg equal 13.8995668940653
variable C6neg equal ${d6}
variable C6neg equal 29.8758007156328

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4502
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.134502 yz delta ${deltayz} remap units box
change_box all y delta 0 0.134502 yz delta 3.4e-05 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.6078 13.584702 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.6078 13.584702 17.3502) with tilt (-9.4505 -1.0717 0.003434)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 140.5 | 143.1 | 145.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   340.84522     -44679.313     -33446.385      0              3914.4136    
       100   307.84207     -44652.798     -4407.9134     -7023.5114      3914.4136    
       200   295.83365     -44670.396      2350.7097     -3377.8678      3914.4136    
       300   276.77146     -44671.609     -2564.6615     -3474.8667      3914.4136    
       400   293.49414     -44684.334      3694.383      -5842.6257      3914.4136    
       500   313.97926     -44686.17       3214.0513     -4121.0561      3914.4136    
       600   308.96838     -44669.695      3881.6943     -4935.9266      3914.4136    
       700   309.78458     -44688.237      7146.6074     -26.810452      3914.4136    
       800   292.8341      -44695.428      1184.7433     -7323.5981      3914.4136    
       900   286.38977     -44697.195     -8992.6324     -4127.7512      3914.4136    
      1000   303.82881     -44698.505     -3332.4556     -2341.0525      3914.4136    
      1100   312.0986      -44686.59       7826.705      -5027.0939      3914.4136    
      1200   302.73066     -44669.388     -15725.288     -6067.0473      3914.4136    
      1300   295.65332     -44681.031     -1867.3069      573.10813      3914.4136    
      1400   275.91207     -44685.617      7158.0864     -2157.4732      3914.4136    
      1500   279.21102     -44681.024      5377.5674     -3354.8756      3914.4136    
      1600   306.89165     -44696.901      2941.3795      1247.387       3914.4136    
      1700   291.42932     -44681.657      4524.5969      461.42177      3914.4136    
      1800   300.82369     -44704.445     -3443.9712     -7239.859       3914.4136    
      1900   297.33833     -44715.337     -6207.8264     -483.9248       3914.4136    
      2000   287.84038     -44730.361      2756.4053     -3098.5869      3914.4136    
      2100   260.95793     -44735.375     -3755.183      -13115.272      3914.4136    
      2200   276.14517     -44734.395     -4441.7773     -5591.6964      3914.4136    
      2300   293.12599     -44724.958     -1609.776      -4774.6362      3914.4136    
      2400   291.73048     -44704.946     -2157.6757     -10062.474      3914.4136    
      2500   298.25819     -44697.623      2192.2993     -6391.4927      3914.4136    
      2600   312.84632     -44711.551      2313.6933     -1632.4844      3914.4136    
      2700   300.92673     -44736.451      8600.167       294.09313      3914.4136    
      2800   291.25224     -44740.965      11765.903     -730.88627      3914.4136    
      2900   299.97835     -44741.675      14003.105      1432.2848      3914.4136    
      3000   311.91313     -44737.634     -3665.6313     -6307.4294      3914.4136    
Loop time of 166.131 on 8 procs for 3000 steps with 386 atoms

Performance: 0.780 ns/day, 30.765 hours/ns, 18.058 timesteps/s, 6.970 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 95.612     | 122.95     | 140.74     | 177.1 | 74.01
Bond    | 0.007409   | 0.0080739  | 0.0089305  |   0.6 |  0.00
Neigh   | 8.0026     | 10.104     | 11.43      |  46.3 |  6.08
Comm    | 1.3617     | 19.158     | 46.505     | 448.7 | 11.53
Output  | 0.0067365  | 0.008088   | 0.0090656  |   0.9 |  0.00
Modify  | 12.488     | 13.826     | 15.929     |  39.8 |  8.32
Other   |            | 0.0733     |            |       |  0.04

Nlocal:          48.25 ave          59 max          44 min
Histogram: 5 0 0 0 1 0 1 0 0 1
Nghost:        3691.12 ave        3747 max        3621 min
Histogram: 1 0 0 2 0 1 1 1 1 1
Neighs:        33255.6 ave       40427 max       30509 min
Histogram: 5 0 0 1 0 0 1 0 0 1

Total # of neighbors = 266045
Ave neighs/atom = 689.23575
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 140.5 | 143.1 | 146 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.91313     -44737.634     -3665.6435      0              3914.4136    
       100   296.93306     -44715.924     -1635.361      -807.64205      3914.4136    
       200   292.86687     -44694.311     -6875.5999     -7370.666       3914.4136    
       300   320.40852     -44705.789     -7873.3952     -10895.736      3914.4136    
       400   319.73789     -44735.522     -1089.5181     -4486.8069      3914.4136    
       500   282.94453     -44718.493      4825.055      -5494.0756      3914.4136    
       600   306.48028     -44743.959      3058.2316     -4054.6286      3914.4136    
       700   294.19758     -44724.139      10199.625     -6864.6471      3914.4136    
       800   311.25095     -44726.648      2431.0043     -4293.0808      3914.4136    
       900   339.78726     -44727.587      3493.2508      1078.1321      3914.4136    
      1000   290.45942     -44685.998     -1357.1961     -2246.4273      3914.4136    
      1100   301.44309     -44719.051     -1690.9554     -11233.105      3914.4136    
      1200   306.071       -44733.692      12564.04      -3787.4958      3914.4136    
      1300   288.71561     -44721.764      5106.1561     -1406.5295      3914.4136    
      1400   303.77354     -44718.45       456.22342     -5149.7935      3914.4136    
      1500   334.02869     -44724.8        7854.6193     -7479.6294      3914.4136    
      1600   307.03291     -44686.222      6031.4204     -6812.732       3914.4136    
      1700   278.16504     -44695.025      6236.5603     -41.57984       3914.4136    
      1800   281.33131     -44712.554     -3106.0385     -7450.1603      3914.4136    
      1900   295.45607     -44724.557      6006.5284     -2962.2399      3914.4136    
      2000   312.62276     -44714.247     -638.7085      -4517.6091      3914.4136    
      2100   319.90291     -44716.259      4645.1351     -7719.7976      3914.4136    
      2200   300.99339     -44713.733      5555.1187     -5822.5379      3914.4136    
      2300   296.81089     -44717.017     -1650.9678      1079.4804      3914.4136    
      2400   295.10934     -44713.644     -3806.5032     -2527.4875      3914.4136    
      2500   304.10489     -44725.572     -2734.3814      302.17225      3914.4136    
      2600   293.06548     -44745.368     -2247.8835     -3518.1023      3914.4136    
      2700   283.71214     -44749.151     -7507.0789     -4807.2038      3914.4136    
      2800   294.0185      -44733.705      4706.8123     -8635.7977      3914.4136    
      2900   288.32388     -44707.236     -5173.2253     -7905.3339      3914.4136    
      3000   305.18838     -44717.378      1516.7348      648.91784      3914.4136    
Loop time of 164.707 on 8 procs for 3000 steps with 386 atoms

Performance: 0.787 ns/day, 30.501 hours/ns, 18.214 timesteps/s, 7.031 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 95.114     | 122.16     | 139.03     | 176.6 | 74.17
Bond    | 0.007441   | 0.008124   | 0.0087085  |   0.5 |  0.00
Neigh   | 8.0482     | 10.065     | 11.353     |  47.9 |  6.11
Comm    | 1.7445     | 18.62      | 45.666     | 452.3 | 11.30
Output  | 0.001293   | 0.0014171  | 0.0019871  |   0.6 |  0.00
Modify  | 12.488     | 13.781     | 15.802     |  41.1 |  8.37
Other   |            | 0.0747     |            |       |  0.05

Nlocal:          48.25 ave          60 max          39 min
Histogram: 1 1 1 1 1 1 0 1 0 1
Nghost:           3705 ave        3741 max        3655 min
Histogram: 1 0 1 0 0 1 3 1 0 1
Neighs:          33254 ave       40982 max       26973 min
Histogram: 1 0 2 1 1 1 0 1 0 1

Total # of neighbors = 266032
Ave neighs/atom = 689.20207
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -8.12680904017977
variable C2pos equal ${d2}
variable C2pos equal 45.5372327541689
variable C3pos equal ${d3}
variable C3pos equal 50.2616801137431
variable C4pos equal ${d4}
variable C4pos equal -8.10543969190618
variable C5pos equal ${d5}
variable C5pos equal -1.57054048777327
variable C6pos equal ${d6}
variable C6pos equal -24.0508084409663

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(37.6926937152972+${C1pos})
variable C12 equal 0.5*(37.6926937152972+-8.12680904017977)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(56.372523028633+${C2pos})
variable C22 equal 0.5*(56.372523028633+45.5372327541689)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(38.4637190492845+${C3pos})
variable C32 equal 0.5*(38.4637190492845+50.2616801137431)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(14.3744928111676+${C4pos})
variable C42 equal 0.5*(14.3744928111676+-8.10543969190618)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(13.8995668940653+${C5pos})
variable C52 equal 0.5*(13.8995668940653+-1.57054048777327)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(29.8758007156328+${C6pos})
variable C62 equal 0.5*(29.8758007156328+-24.0508084409663)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.3502
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.3502
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.173502 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.6078 13.4502 17.176698) with tilt (-9.4505 -1.0717 0.0034)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.8 | 145.8 | 148.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   340.84522     -44675.638      46762.191      0              3836.9004    
       100   313.02214     -44657.238      176.35095     -1281.5301      3836.9004    
       200   304.3449      -44688.021      16198.059     -1039.3947      3836.9004    
       300   289.56293     -44695.226      4055.2947     -2138.7399      3836.9004    
       400   290.06543     -44683.781     -5986.6857     -6594.2928      3836.9004    
       500   301.53199     -44662.463      2457.5784     -3462.2272      3836.9004    
       600   316.4449      -44663.104     -3102.4271      632.83222      3836.9004    
       700   305.73853     -44663.021      8473.4835      6091.5958      3836.9004    
       800   297.50374     -44679.82       3348.9199     -221.97951      3836.9004    
       900   297.14029     -44702.607      10536.895      54.483308      3836.9004    
      1000   282.32544     -44687.84       14372.165      696.19831      3836.9004    
      1100   297.61826     -44687.463      3501.0951     -4022.1864      3836.9004    
      1200   312.79011     -44681.944      9653.1957      1231.2789      3836.9004    
      1300   299.22491     -44661.225     -4805.0949     -1360.8626      3836.9004    
      1400   309.07259     -44696.358      12267.757      2043.2187      3836.9004    
      1500   277.50845     -44689.137      11421.771      7011.349       3836.9004    
      1600   287.22597     -44690.309      9366.1014      4433.8378      3836.9004    
      1700   303.9987      -44690.675      7609.0351     -4559.3008      3836.9004    
      1800   288.94798     -44671.935      2370.1546      621.02869      3836.9004    
      1900   302.92761     -44688.222      13564.511      8478.1886      3836.9004    
      2000   304.52324     -44694.431     -6882.0217      1620.9198      3836.9004    
      2100   301.07026     -44698.951      4615.4635      4351.6297      3836.9004    
      2200   295.67197     -44747.603      1750.5671      1716.0717      3836.9004    
      2300   280.30946     -44732.853      4286.025       4643.7035      3836.9004    
      2400   279.668       -44699.733      16502.203      4332.1225      3836.9004    
      2500   297.12939     -44694.429      13038.672      4660.0478      3836.9004    
      2600   309.83277     -44705.115      8834.1011      10743.404      3836.9004    
      2700   302.23273     -44712.654      4012.8454     -1104.3343      3836.9004    
      2800   285.10281     -44718.563     -202.78609      1709.4801      3836.9004    
      2900   276.84232     -44716.294     -9603.6905     -1783.7583      3836.9004    
      3000   292.73799     -44697.098      2469.0203     -5657.7047      3836.9004    
Loop time of 171.38 on 8 procs for 3000 steps with 386 atoms

Performance: 0.756 ns/day, 31.737 hours/ns, 17.505 timesteps/s, 6.757 katom-step/s
99.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 98.556     | 126.85     | 145.16     | 183.8 | 74.01
Bond    | 0.0075492  | 0.0081314  | 0.0089369  |   0.5 |  0.00
Neigh   | 8.2189     | 10.282     | 11.736     |  48.9 |  6.00
Comm    | 1.6351     | 19.95      | 48.241     | 463.4 | 11.64
Output  | 0.0066806  | 0.0080454  | 0.0090509  |   0.9 |  0.00
Modify  | 12.754     | 14.21      | 16.286     |  41.8 |  8.29
Other   |            | 0.07521    |            |       |  0.04

Nlocal:          48.25 ave          57 max          40 min
Histogram: 1 0 1 0 4 0 0 0 0 2
Nghost:        3761.25 ave        3785 max        3729 min
Histogram: 2 0 1 0 0 1 1 0 0 3
Neighs:        33971.5 ave       39831 max       28269 min
Histogram: 1 0 0 1 4 0 0 0 0 2

Total # of neighbors = 271772
Ave neighs/atom = 704.07254
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.8 | 145.7 | 147.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   292.73799     -44697.098      2469.0157      0              3836.9004    
       100   309.472       -44711.713      6132.6513      1719.8156      3836.9004    
       200   304.79407     -44691.796      8990.3249      2935.6781      3836.9004    
       300   311.83944     -44677.153      10436.245     -187.89309      3836.9004    
       400   314.23053     -44691.738      6739.7476      2346.1039      3836.9004    
       500   313.71362     -44726.475      18380.746      8160.9806      3836.9004    
       600   304.07489     -44723.445     -5104.3243      3547.5065      3836.9004    
       700   302.12092     -44724.656      6551.2008      4431.9472      3836.9004    
       800   306.50661     -44712.034      7469.7709      2536.6937      3836.9004    
       900   320.59645     -44710.447      13293.216      8765.2139      3836.9004    
      1000   312.22326     -44705.974      4014.1812      3626.687       3836.9004    
      1100   304.67394     -44732.247     -3311.1553     -66.379913      3836.9004    
      1200   271.35701     -44710.483      8312.8483      2818.7794      3836.9004    
      1300   294.26492     -44728.885     -6785.3513      4797.2658      3836.9004    
      1400   296.2747      -44709.475      15497.978      6732.8743      3836.9004    
      1500   317.2891      -44703.952      5777.7571      928.1669       3836.9004    
      1600   317.88189     -44687.611      10001.002      6853.992       3836.9004    
      1700   287.82697     -44702.397      12376.753      6254.2836      3836.9004    
      1800   292.79397     -44715.865     -118.70992      1711.9328      3836.9004    
      1900   311.70726     -44748.516      8031.6584      4794.7845      3836.9004    
      2000   285.49786     -44725.491      397.80788      5593.691       3836.9004    
      2100   297.37204     -44723.167      1985.2173     -1218.1897      3836.9004    
      2200   318.50146     -44716.738      10029.189      6767.4428      3836.9004    
      2300   315.429       -44707.424      16982.648      4380.1737      3836.9004    
      2400   299.81477     -44711.038     -50.530762      2547.9538      3836.9004    
      2500   287.52612     -44708.167      8925.1339      1107.6414      3836.9004    
      2600   312.74787     -44740.41       11461.959      4013.8762      3836.9004    
      2700   301.95701     -44732.492      11865.538      4207.017       3836.9004    
      2800   284.47947     -44725.69       9048.8028      908.27745      3836.9004    
      2900   300.80186     -44744.657      8482.8252      4654.5965      3836.9004    
      3000   290.92465     -44715.75       3966.6575      2174.2777      3836.9004    
Loop time of 170.723 on 8 procs for 3000 steps with 386 atoms

Performance: 0.759 ns/day, 31.615 hours/ns, 17.572 timesteps/s, 6.783 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 98.656     | 126.78     | 143.45     | 180.4 | 74.26
Bond    | 0.0075654  | 0.0081267  | 0.0088948  |   0.5 |  0.00
Neigh   | 8.2926     | 10.32      | 11.678     |  48.5 |  6.04
Comm    | 2.6106     | 19.281     | 47.399     | 462.5 | 11.29
Output  | 0.0012488  | 0.0014049  | 0.0020269  |   0.6 |  0.00
Modify  | 12.892     | 14.258     | 16.296     |  41.5 |  8.35
Other   |            | 0.07576    |            |       |  0.04

Nlocal:          48.25 ave          61 max          40 min
Histogram: 2 0 2 0 2 0 0 1 0 1
Nghost:        3774.88 ave        3802 max        3734 min
Histogram: 1 0 1 2 0 0 0 0 1 3
Neighs:          33935 ave       42354 max       28355 min
Histogram: 2 0 2 0 2 0 0 1 0 1

Total # of neighbors = 271480
Ave neighs/atom = 703.31606
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 23.5825178129507
variable C2neg equal ${d2}
variable C2neg equal -38.6283052188
variable C3neg equal ${d3}
variable C3neg equal 34.9615835406345
variable C4neg equal ${d4}
variable C4neg equal 9.09013273229848
variable C5neg equal ${d5}
variable C5neg equal 15.1988019098936
variable C6neg equal ${d6}
variable C6neg equal 11.2689542707098

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.3502
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.173502 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.6078 13.4502 17.523702) with tilt (-9.4505 -1.0717 0.0034)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 141.6 | 143.6 | 145.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   340.84522     -44678.505     -36266.558      0              3914.4136    
       100   311.01471     -44657.721     -9183.3873     -8390.4771      3914.4136    
       200   295.97026     -44680.048     -8361.784      -7695.9368      3914.4136    
       300   277.55899     -44683.655     -16685.905     -5388.9195      3914.4136    
       400   302.36691     -44700.97       14613.66      -7571.3637      3914.4136    
       500   293.89404     -44667.5        6824.811      -4016.5292      3914.4136    
       600   308.84504     -44660.712     -8102.7931     -7397.9281      3914.4136    
       700   312.81601     -44659.969      903.42048     -1953.8287      3914.4136    
       800   306.5459      -44684.375      6339.3234     -5431.2263      3914.4136    
       900   305.49344     -44708.678      8267.4594     -1969.3516      3914.4136    
      1000   292.5448      -44699.438      5716.9187      288.92906      3914.4136    
      1100   302.4095      -44702.307     -1481.099      -1967.536       3914.4136    
      1200   310.96785     -44702.94       3026.5786     -1901.9265      3914.4136    
      1300   301.53144     -44688.31       7447.6237     -1462.4336      3914.4136    
      1400   274.73459     -44669.195     -5719.3388     -9075.3392      3914.4136    
      1500   303.49245     -44703.51      -4898.2326     -2635.7527      3914.4136    
      1600   298.3108      -44699.241      3549.7316     -4114.3091      3914.4136    
      1700   298.19045     -44681.615     -8479.1016     -6474.1134      3914.4136    
      1800   297.68895     -44654.901     -133.81832     -8085.9216      3914.4136    
      1900   317.52856     -44678.558      5516.0847     -354.57038      3914.4136    
      2000   310.87035     -44706.756      5432.8463     -4911.0215      3914.4136    
      2100   283.91256     -44691.712      4336.3778     -7705.8213      3914.4136    
      2200   280.90589     -44682.96       5803.1722     -7875.2949      3914.4136    
      2300   307.87451     -44695.818      1088.7087     -7014.9022      3914.4136    
      2400   310.4992      -44679.648     -10363.651     -3653.894       3914.4136    
      2500   309.02713     -44675.478     -5443.177      -3830.8083      3914.4136    
      2600   271.44388     -44672.007     -1644.8117     -4036.8313      3914.4136    
      2700   282.57394     -44689.547      2271.4287     -6817.2589      3914.4136    
      2800   305.10971     -44708.46      -7940.9507     -2064.69        3914.4136    
      2900   303.39296     -44699.239     -5003.3515     -5292.9933      3914.4136    
      3000   327.68225     -44701.01      -5752.4858     -1312.8794      3914.4136    
Loop time of 167.191 on 8 procs for 3000 steps with 386 atoms

Performance: 0.775 ns/day, 30.961 hours/ns, 17.943 timesteps/s, 6.926 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 95.973     | 123.51     | 141.79     | 178.3 | 73.87
Bond    | 0.0078037  | 0.0082392  | 0.0087927  |   0.4 |  0.00
Neigh   | 8.078      | 10.14      | 11.47      |  48.5 |  6.07
Comm    | 1.2821     | 19.575     | 47.121     | 447.8 | 11.71
Output  | 0.0065914  | 0.0079506  | 0.0089722  |   0.9 |  0.00
Modify  | 12.532     | 13.876     | 15.936     |  41.6 |  8.30
Other   |            | 0.07416    |            |       |  0.04

Nlocal:          48.25 ave          58 max          39 min
Histogram: 1 1 0 2 0 1 1 1 0 1
Nghost:        3723.38 ave        3768 max        3670 min
Histogram: 1 1 0 1 1 0 1 0 1 2
Neighs:        33239.1 ave       39775 max       26893 min
Histogram: 1 1 0 2 0 1 1 1 0 1

Total # of neighbors = 265913
Ave neighs/atom = 688.89378
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 141.6 | 143.6 | 146 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   327.68225     -44701.01      -5752.496       0              3914.4136    
       100   312.6297      -44695.584      1102.4598      2146.3205      3914.4136    
       200   297.46421     -44703.85       3628.2196     -8400.3573      3914.4136    
       300   295.8913      -44725.396     -6064.9509     -9007.9601      3914.4136    
       400   285.29319     -44735.563      638.08797      701.05152      3914.4136    
       500   274.51407     -44715.422     -3625.2509     -2610.9355      3914.4136    
       600   292.71937     -44696.075     -1046.2235     -10332.056      3914.4136    
       700   294.27128     -44679.402      899.92882      319.719        3914.4136    
       800   278.88533     -44657.504     -6853.5577     -8332.3093      3914.4136    
       900   302.77725     -44696.26       5711.5798     -2827.7904      3914.4136    
      1000   285.2023      -44696.169      3055.0422     -2101.4804      3914.4136    
      1100   275.38679     -44692.42       3850.9341     -3353.1         3914.4136    
      1200   293.43933     -44698.066     -12182         -5949.7769      3914.4136    
      1300   321.30478     -44698.298      5748.4508     -6307.3802      3914.4136    
      1400   298.57447     -44673.502      275.02326     -3202.0614      3914.4136    
      1500   303.38091     -44690.839     -6056.9851     -6863.4566      3914.4136    
      1600   296.76199     -44711.818      9754.2585     -4218.9398      3914.4136    
      1700   292.44316     -44730.619      17841.166     -3393.6048      3914.4136    
      1800   280.06559     -44711.996     -3580.7554     -6691.6528      3914.4136    
      1900   307.44379     -44717.754      2968.3773     -2337.9656      3914.4136    
      2000   291.80143     -44690.365      6213.2304     -4059.7621      3914.4136    
      2100   320.96725     -44700.948     -2668.2816     -2561.8904      3914.4136    
      2200   296.77037     -44675.218     -1174.7846     -2718.0912      3914.4136    
      2300   293.69074     -44696.462      1556.1829      1056.1279      3914.4136    
      2400   282.70816     -44704.14      -3498.2914     -6374.433       3914.4136    
      2500   290.26976     -44708.896      8040.0673     -2907.3936      3914.4136    
      2600   297.13738     -44709.196     -2938.5407     -1053.6134      3914.4136    
      2700   292.11099     -44695.186     -9779.9834      441.69713      3914.4136    
      2800   295.79702     -44690.382     -6986.8065     -4551.3426      3914.4136    
      2900   315.59822     -44703.738      400.71245     -2862.8434      3914.4136    
      3000   311.81133     -44692.589     -2737.6297     -7696.249       3914.4136    
Loop time of 167.415 on 8 procs for 3000 steps with 386 atoms

Performance: 0.774 ns/day, 31.003 hours/ns, 17.919 timesteps/s, 6.917 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 95.249     | 123.19     | 141.86     | 179.9 | 73.58
Bond    | 0.0077015  | 0.0082119  | 0.0088548  |   0.5 |  0.00
Neigh   | 8.0569     | 10.217     | 11.606     |  50.6 |  6.10
Comm    | 1.2089     | 19.894     | 47.843     | 447.7 | 11.88
Output  | 0.0012859  | 0.0014271  | 0.002069   |   0.6 |  0.00
Modify  | 12.627     | 14.031     | 16.19      |  43.4 |  8.38
Other   |            | 0.07382    |            |       |  0.04

Nlocal:          48.25 ave          60 max          40 min
Histogram: 1 1 1 1 0 2 1 0 0 1
Nghost:        3706.88 ave        3760 max        3641 min
Histogram: 2 0 0 1 1 0 0 1 1 2
Neighs:          33268 ave       41029 max       27584 min
Histogram: 1 1 1 1 0 3 0 0 0 1

Total # of neighbors = 266144
Ave neighs/atom = 689.49223
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 76.4305935167552
variable C2pos equal ${d2}
variable C2pos equal 139.929144198277
variable C3pos equal ${d3}
variable C3pos equal 36.9467186692656
variable C4pos equal ${d4}
variable C4pos equal -6.14068853070387
variable C5pos equal ${d5}
variable C5pos equal -8.96322200815936
variable C6pos equal ${d6}
variable C6pos equal -8.51794031908211

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(23.5825178129507+${C1pos})
variable C13 equal 0.5*(23.5825178129507+76.4305935167552)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(-38.6283052188+${C2pos})
variable C23 equal 0.5*(-38.6283052188+139.929144198277)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(34.9615835406345+${C3pos})
variable C33 equal 0.5*(34.9615835406345+36.9467186692656)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(9.09013273229848+${C4pos})
variable C43 equal 0.5*(9.09013273229848+-6.14068853070387)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(15.1988019098936+${C5pos})
variable C53 equal 0.5*(15.1988019098936+-8.96322200815936)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(11.2689542707098+${C6pos})
variable C63 equal 0.5*(11.2689542707098+-8.51794031908211)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.3502
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.3502
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.173502 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 -0.170102)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 142.2 | 144.3 | 146.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   340.84522     -44689.24       3416.1119      0              3875.657     
       100   308.71681     -44660.332      4731.4346     -4793.9565      3875.657     
       200   307.27761     -44692.584      6150.563      -6691.6979      3875.657     
       300   281.9087      -44684.868      4421.5811     -4290.2186      3875.657     
       400   302.01176     -44692.65      -2833.4686     -5899.2008      3875.657     
       500   282.11838     -44640.23      -2987.9698     -6012.0814      3875.657     
       600   317.61542     -44661.192     -3545.9044     -3733.6078      3875.657     
       700   307.62952     -44656.833     -483.0841      -1344.9275      3875.657     
       800   293.19067     -44669.691      4099.9034      354.51913      3875.657     
       900   275.69777     -44663.989      3765.4204     -6173.7178      3875.657     
      1000   292.13399     -44669.71       1397.2437     -5127.6524      3875.657     
      1100   310.126       -44662.328      6838.3039     -2006.1564      3875.657     
      1200   314.77247     -44650.695     -8248.4813     -3364.6744      3875.657     
      1300   304.63062     -44649.724     -6202.6695     -5840.3715      3875.657     
      1400   305.65095     -44681.827     -4468.4797     -9019.6872      3875.657     
      1500   301.98043     -44685.658     -8406.1282     -3642.9176      3875.657     
      1600   306.85004     -44688.71      -1660.0487     -1539.0979      3875.657     
      1700   306.32725     -44677.103      13139.202     -7803.8566      3875.657     
      1800   310.8815      -44671.091      1750.8512     -4828.5319      3875.657     
      1900   300.97501     -44668.993      9991.1076      6443.6146      3875.657     
      2000   289.85318     -44675.732      15264.096     -2787.3871      3875.657     
      2100   274.39752     -44677.627     -7526.857      -5503.0673      3875.657     
      2200   293.5612      -44702.958     -1744.2592     -5838.3143      3875.657     
      2300   306.10077     -44685.775      221.918        2217.8875      3875.657     
      2400   321.48087     -44677.525     -7851.4428      2533.7112      3875.657     
      2500   295.77131     -44656.033      11834.529     -128.24414      3875.657     
      2600   282.19066     -44664.82      -1094.6123     -6712.2721      3875.657     
      2700   298.10993     -44697.173      11740.177     -2822.5249      3875.657     
      2800   305.28615     -44702.973     -3381.7704     -3023.2411      3875.657     
      2900   301.29976     -44690.386     -270.71865      3838.2225      3875.657     
      3000   322.13692     -44713.27       17623.395     -1703.0828      3875.657     
Loop time of 168.941 on 8 procs for 3000 steps with 386 atoms

Performance: 0.767 ns/day, 31.285 hours/ns, 17.758 timesteps/s, 6.854 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 97.343     | 121.79     | 143.05     | 175.8 | 72.09
Bond    | 0.0073961  | 0.0079296  | 0.0085283  |   0.5 |  0.00
Neigh   | 8.2106     | 10.1       | 11.677     |  49.3 |  5.98
Comm    | 1.4222     | 22.691     | 47.144     | 407.1 | 13.43
Output  | 0.0065101  | 0.0079569  | 0.0088789  |   1.0 |  0.00
Modify  | 12.678     | 14.274     | 16.159     |  41.7 |  8.45
Other   |            | 0.07291    |            |       |  0.04

Nlocal:          48.25 ave          59 max          41 min
Histogram: 2 0 2 1 0 1 0 0 1 1
Nghost:        3755.12 ave        3796 max        3705 min
Histogram: 1 0 0 1 1 1 2 1 0 1
Neighs:        33604.4 ave       40688 max       28676 min
Histogram: 2 0 2 1 0 1 0 0 1 1

Total # of neighbors = 268835
Ave neighs/atom = 696.46373
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 142.3 | 144.3 | 146.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   322.13692     -44713.27       17623.365      0              3875.657     
       100   290.94834     -44685.437      15055.275     -3295.1394      3875.657     
       200   280.64827     -44707.917     -2764.1023     -8856.6672      3875.657     
       300   300.94113     -44746.008      9630.6103     -6533.5776      3875.657     
       400   296.83733     -44732.138      1215.807      -3366.8757      3875.657     
       500   307.54395     -44722.015      2675.8315     -6361.8825      3875.657     
       600   300.24345     -44708.243     -14822.886     -8859.5919      3875.657     
       700   287.29947     -44708.127     -3971.9215     -853.80267      3875.657     
       800   288.10178     -44710.385      1766.0497     -4651.6892      3875.657     
       900   316.72201     -44733.223      6727.9901     -4308.407       3875.657     
      1000   303.98657     -44699.695      1272.7172     -1821.4205      3875.657     
      1100   333.75891     -44689.62       220.86477     -4844.6746      3875.657     
      1200   330.79854     -44700.567      10673.007     -5478.0445      3875.657     
      1300   308.12687     -44712.356      2821.1749     -4629.8094      3875.657     
      1400   305.52074     -44725.933      2518.3228     -1007.6695      3875.657     
      1500   275.43053     -44701.388      7517.2527     -3836.8673      3875.657     
      1600   288.3522      -44707.5        7507.6392     -6261.0628      3875.657     
      1700   308.44693     -44696.404     -1445.7734     -4472.6986      3875.657     
      1800   314.63633     -44703.136      9416.559      -1906.1426      3875.657     
      1900   298.32138     -44692.213      10340.903      527.31544      3875.657     
      2000   302.31125     -44706.906     -10311.747     -6145.8603      3875.657     
      2100   293.15843     -44722.412      2145.5673     -6361.2847      3875.657     
      2200   279.37819     -44745.522     -11749.647     -8355.6158      3875.657     
      2300   296.99687     -44745.21       9737.2553     -3576.3794      3875.657     
      2400   296.14558     -44716.36       6586.7779     -2276.1784      3875.657     
      2500   298.43272     -44695.502     -4550.0493     -6723.0418      3875.657     
      2600   297.07526     -44688.397     -6696.1168     -6367.1806      3875.657     
      2700   301.98648     -44699.953     -14282.567     -3883.3217      3875.657     
      2800   296.90567     -44722.353      10869.148     -2980.1156      3875.657     
      2900   274.54768     -44708.816      1096.7942     -4012.8164      3875.657     
      3000   312.10917     -44730.192      1792.6835     -5969.7006      3875.657     
Loop time of 168.087 on 8 procs for 3000 steps with 386 atoms

Performance: 0.771 ns/day, 31.127 hours/ns, 17.848 timesteps/s, 6.889 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 96.194     | 119.23     | 141.78     | 191.1 | 70.94
Bond    | 0.0073611  | 0.0078917  | 0.0085164  |   0.4 |  0.00
Neigh   | 8.1916     | 9.9485     | 11.661     |  51.0 |  5.92
Comm    | 1.8569     | 24.407     | 47.443     | 422.3 | 14.52
Output  | 0.0012442  | 0.0013968  | 0.0020715  |   0.7 |  0.00
Modify  | 12.686     | 14.416     | 16.184     |  42.6 |  8.58
Other   |            | 0.07258    |            |       |  0.04

Nlocal:          48.25 ave          57 max          41 min
Histogram: 1 0 2 2 0 1 0 0 1 1
Nghost:        3759.75 ave        3798 max        3707 min
Histogram: 1 1 0 0 0 2 0 1 1 2
Neighs:        33630.2 ave       39366 max       28688 min
Histogram: 1 0 2 1 1 1 0 0 1 1

Total # of neighbors = 269042
Ave neighs/atom = 697
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -58.9363427693749
variable C2neg equal ${d2}
variable C2neg equal -63.3603013337361
variable C3neg equal ${d3}
variable C3neg equal -92.3820131313501
variable C4neg equal ${d4}
variable C4neg equal 1.41374605972715
variable C5neg equal ${d5}
variable C5neg equal -9.87540693563606
variable C6neg equal ${d6}
variable C6neg equal 26.7856703212686

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.3502
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.173502 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.176902)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 142 | 144.2 | 146.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   340.84522     -44690.81       3548.4214      0              3875.657     
       100   304.4076      -44657.301     -1575.794      -5066.0448      3875.657     
       200   306.95877     -44690.178     -1010.4165     -2560.5849      3875.657     
       300   279.50001     -44678.924      2889.7862     -2801.1749      3875.657     
       400   295.3416      -44684.69      -743.29941     -7880.1038      3875.657     
       500   284.67611     -44645.503      729.76402     -4685.9965      3875.657     
       600   318.00896     -44667.721      8606.2641      1448.5001      3875.657     
       700   305.47544     -44666.927      8443.8108      4445.8983      3875.657     
       800   285.54893     -44677.179      9539.1857     -5273.8908      3875.657     
       900   305.7256      -44719.24      -1967.9651     -135.59296      3875.657     
      1000   300.25692     -44700.573      7364.8161      3549.2574      3875.657     
      1100   302.00787     -44677.742      15631.279      8.9981757      3875.657     
      1200   288.11732     -44652.184      14063.502     -2732.8672      3875.657     
      1300   311.5614      -44683.166      3187.0522     -2254.9379      3875.657     
      1400   285.97786     -44686.303      5225.0663     -3837.3036      3875.657     
      1500   301.51864     -44722          9839.7914     -6719.1136      3875.657     
      1600   291.57459     -44701.488     -6233.2874     -4713.3368      3875.657     
      1700   303.0095      -44695.272     -1805.1764     -3557.2594      3875.657     
      1800   316.84864     -44711.852      242.03565      255.77036      3875.657     
      1900   315.90528     -44722.541      2544.8952      419.74057      3875.657     
      2000   298.4383      -44720.621      163.0283       3215.1484      3875.657     
      2100   293.38917     -44719.699     -15563.897      795.85053      3875.657     
      2200   319.73238     -44741.655      5820.237      -5420.0437      3875.657     
      2300   305.83166     -44700.272      8642.035      -3288.0833      3875.657     
      2400   318.6152      -44678.641      6034.7499      3765.0607      3875.657     
      2500   313.55527     -44703.246     -2398.862       1336.3389      3875.657     
      2600   302.59237     -44717.571      2227.1252      2288.3198      3875.657     
      2700   308.20484     -44737.586      1199.7022     -6996.1103      3875.657     
      2800   295.38023     -44721.084     -2092.6576      930.33531      3875.657     
      2900   304.45931     -44707.922      17324.439      8069.3917      3875.657     
      3000   324.25066     -44707.027      1925.4721     -2882.2277      3875.657     
Loop time of 169.633 on 8 procs for 3000 steps with 386 atoms

Performance: 0.764 ns/day, 31.414 hours/ns, 17.685 timesteps/s, 6.827 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 97         | 122.67     | 143.28     | 180.6 | 72.31
Bond    | 0.0077266  | 0.0080316  | 0.0084917  |   0.3 |  0.00
Neigh   | 8.1996     | 10.161     | 11.621     |  48.1 |  5.99
Comm    | 1.7426     | 22.361     | 48.044     | 423.0 | 13.18
Output  | 0.0066696  | 0.0082568  | 0.009382   |   1.1 |  0.00
Modify  | 12.876     | 14.353     | 16.338     |  40.7 |  8.46
Other   |            | 0.0726     |            |       |  0.04

Nlocal:          48.25 ave          59 max          42 min
Histogram: 2 1 1 1 1 0 0 1 0 1
Nghost:        3742.88 ave        3784 max        3700 min
Histogram: 2 0 1 0 0 2 0 0 2 1
Neighs:        33606.1 ave       40819 max       29283 min
Histogram: 2 1 1 1 1 0 0 1 0 1

Total # of neighbors = 268849
Ave neighs/atom = 696.5
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 142.1 | 144.2 | 146.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   324.25066     -44707.027      1925.4596      0              3875.657     
       100   292.54451     -44693.08      -5023.5753     -1837.7621      3875.657     
       200   294.14806     -44713.742     -1324.4518     -5672.2759      3875.657     
       300   304.56193     -44725.693     -1251.1283      24.210904      3875.657     
       400   299.07124     -44711.952      1467.4929      1847.9318      3875.657     
       500   294.35856     -44688.581      1894.3343     -1994.1945      3875.657     
       600   319.66283     -44681.23       9485.601       3909.039       3875.657     
       700   325.04282     -44672.962      5666.4383     -2976.16        3875.657     
       800   314.64942     -44697.513      1210.2287     -740.06956      3875.657     
       900   315.5497      -44716.83      -754.50135     -4613.2155      3875.657     
      1000   292.24242     -44710.654      13002.103     -2358.4697      3875.657     
      1100   302.17011     -44736.406      7904.7742     -2292.7464      3875.657     
      1200   283.00272     -44710.9        713.15132     -4611.6332      3875.657     
      1300   304.69471     -44704.954      13984.006     -928.97349      3875.657     
      1400   319.63292     -44709.351     -785.79493     -1775.7669      3875.657     
      1500   294.37247     -44695.543     -2005.507      -3108.1396      3875.657     
      1600   316.52732     -44732.97       8902.1174     -5422.1471      3875.657     
      1700   310.58841     -44728.183      13049.913     -3427.3814      3875.657     
      1800   300.18004     -44715.018     -4063.8866     -2513.8827      3875.657     
      1900   287.42123     -44706.646     -14579.399     -247.36883      3875.657     
      2000   293.5946      -44711.699      2906.3095      1069.1198      3875.657     
      2100   320.68386     -44719.286     -8055.2219      46.882874      3875.657     
      2200   305.16774     -44708.284      9731.5822      4364.2082      3875.657     
      2300   295.82266     -44724.453     -5166.0486      1348.4278      3875.657     
      2400   277.91449     -44704.733     -11300.311      3288.3628      3875.657     
      2500   291.30146     -44712.669     -6411.8537     -4786.2394      3875.657     
      2600   309.12478     -44725.7       -2943.6976     -4088.9916      3875.657     
      2700   301.39903     -44713.309      6426.3584     -1982.9989      3875.657     
      2800   300.86299     -44707.262      7207.2732     -2155.4635      3875.657     
      2900   316.90299     -44727.149      6305.356       797.58125      3875.657     
      3000   291.20096     -44730.817     -5608.3112     -4229.0481      3875.657     
Loop time of 170.498 on 8 procs for 3000 steps with 386 atoms

Performance: 0.760 ns/day, 31.574 hours/ns, 17.596 timesteps/s, 6.792 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 97.417     | 121.77     | 141.13     | 144.2 | 71.42
Bond    | 0.0078331  | 0.0080588  | 0.00851    |   0.3 |  0.00
Neigh   | 8.2661     | 10.105     | 11.731     |  37.8 |  5.93
Comm    | 4.196      | 23.538     | 47.913     | 328.2 | 13.81
Output  | 0.0012987  | 0.0014407  | 0.0021517  |   0.7 |  0.00
Modify  | 13.354     | 15.005     | 16.845     |  31.1 |  8.80
Other   |            | 0.07311    |            |       |  0.04

Nlocal:          48.25 ave          58 max          40 min
Histogram: 1 1 1 2 0 0 1 0 0 2
Nghost:        3754.75 ave        3810 max        3721 min
Histogram: 2 1 1 0 1 1 1 0 0 1
Neighs:          33584 ave       39998 max       27956 min
Histogram: 1 1 1 0 2 0 1 0 0 2

Total # of neighbors = 268672
Ave neighs/atom = 696.04145
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 41.299180724126
variable C2pos equal ${d2}
variable C2pos equal 36.6822970356885
variable C3pos equal ${d3}
variable C3pos equal -17.8348400922223
variable C4pos equal ${d4}
variable C4pos equal -8.54655167804716
variable C5pos equal ${d5}
variable C5pos equal 11.7145689196831
variable C6pos equal ${d6}
variable C6pos equal -32.7351524356152

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-58.9363427693749+${C1pos})
variable C14 equal 0.5*(-58.9363427693749+41.299180724126)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(-63.3603013337361+${C2pos})
variable C24 equal 0.5*(-63.3603013337361+36.6822970356885)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-92.3820131313501+${C3pos})
variable C34 equal 0.5*(-92.3820131313501+-17.8348400922223)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(1.41374605972715+${C4pos})
variable C44 equal 0.5*(1.41374605972715+-8.54655167804716)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-9.87540693563606+${C5pos})
variable C54 equal 0.5*(-9.87540693563606+11.7145689196831)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(26.7856703212686+${C6pos})
variable C64 equal 0.5*(26.7856703212686+-32.7351524356152)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.3502
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.3502
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.173502 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.245202 0.0034)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 142.2 | 144.3 | 146.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   340.84522     -44689.103      2973.4219      0              3875.657     
       100   317.64673     -44670.028     -1274.6096     -4747.5759      3875.657     
       200   303.69488     -44685.503      3773.8724     -5687.8894      3875.657     
       300   285.31263     -44683.241      5747.1916     -4784.723       3875.657     
       400   287.91866     -44677.61       3528.6809     -9950.799       3875.657     
       500   286.03181     -44645.011      4196.2991     -3679.0606      3875.657     
       600   309.89977     -44648.637      7865.852      -6724.7561      3875.657     
       700   287.73684     -44641.44       15849.07       1550.8542      3875.657     
       800   292.3818      -44674.124     -6051.3781     -3800.7054      3875.657     
       900   300.94419     -44686.858      763.23528     -6673.9503      3875.657     
      1000   287.39659     -44660.092      6338.0167     -2179.9485      3875.657     
      1100   305.76046     -44659.529      576.25499     -5512.1289      3875.657     
      1200   307.1097      -44648.725     -1141.5515     -2944.0201      3875.657     
      1300   320.13543     -44673.194      5288.0592     -2672.5123      3875.657     
      1400   297.48483     -44685.844     -1683.1842     -3112.1912      3875.657     
      1500   282.58214     -44678.467      6175.6645      1020.1052      3875.657     
      1600   311.2336      -44693.417      1412.0414     -6445.3502      3875.657     
      1700   310.42418     -44681.631      6653.9474     -2997.2467      3875.657     
      1800   300.88247     -44676.992      4820.1963     -1076.6018      3875.657     
      1900   281.07425     -44691.783     -4192.4667     -5114.0814      3875.657     
      2000   283.34866     -44702.512      9326.9167     -5982.7869      3875.657     
      2100   289.91366     -44685.515     -9514.2637     -6906.4884      3875.657     
      2200   286.36887     -44662.296      13662.787      1656.1599      3875.657     
      2300   323.75815     -44694.304      2136.5295     -46.036101      3875.657     
      2400   304.95872     -44687.561     -6125.5613     -1818.931       3875.657     
      2500   295.43252     -44699.385     -3876.4577      1307.1922      3875.657     
      2600   293.29267     -44705.185     -1198.421       3165.2806      3875.657     
      2700   290.53225     -44686.216      10461.831      1957.2753      3875.657     
      2800   298.10458     -44664.52       762.84088     -5142.8263      3875.657     
      2900   311.82952     -44662.495      10326.128      1123.8618      3875.657     
      3000   333.11296     -44691.915      6355.7526     -2803.4725      3875.657     
Loop time of 157.152 on 8 procs for 3000 steps with 386 atoms

Performance: 0.825 ns/day, 29.102 hours/ns, 19.090 timesteps/s, 7.369 katom-step/s
99.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 94.555     | 101.25     | 133.43     | 122.1 | 64.43
Bond    | 0.0070073  | 0.0077511  | 0.008737   |   0.6 |  0.00
Neigh   | 8.1288     | 8.6162     | 11.273     |  34.3 |  5.48
Comm    | 0.87692    | 33.062     | 39.761     | 213.7 | 21.04
Output  | 0.0063482  | 0.0077828  | 0.0086769  |   0.9 |  0.00
Modify  | 11.475     | 14.138     | 14.621     |  26.8 |  9.00
Other   |            | 0.06881    |            |       |  0.04

Nlocal:          48.25 ave          58 max          43 min
Histogram: 3 0 2 0 0 1 1 0 0 1
Nghost:           3736 ave        3777 max        3679 min
Histogram: 1 0 0 1 1 1 2 0 0 2
Neighs:        33611.1 ave       40146 max       30115 min
Histogram: 3 0 2 0 0 2 0 0 0 1

Total # of neighbors = 268889
Ave neighs/atom = 696.60363
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 142.2 | 144.3 | 146.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   333.11296     -44691.915      6355.7146      0              3875.657     
       100   318.27055     -44694.168     -5561.0534     -711.95494      3875.657     
       200   306.14518     -44705.218      1992.5877     -3020.457       3875.657     
       300   297.89214     -44696.25       1847.6807     -5851.5856      3875.657     
       400   303.82015     -44689.967      5724.8112     -8399.0202      3875.657     
       500   296.34293     -44664.676      1743.1956     -1472.8622      3875.657     
       600   304.44818     -44681.559     -1440.8596     -1668.1394      3875.657     
       700   300.13886     -44708.804      3327.1107      1137.7337      3875.657     
       800   290.07109     -44706.73      -1620.9821     -5345.6714      3875.657     
       900   293.01271     -44696.1        2817.5294     -2281.5397      3875.657     
      1000   312.90502     -44686.45       8179.4146     -5716.3921      3875.657     
      1100   306.33604     -44674.345      8279.4905      257.96871      3875.657     
      1200   314.80189     -44700.474     -13302.619     -5396.0761      3875.657     
      1300   315.29836     -44713.607      5599.9917      995.08672      3875.657     
      1400   299.17419     -44700.928     -4386.3417     -2968.4043      3875.657     
      1500   301.61517     -44698.575      3518.8916      208.84099      3875.657     
      1600   324.15987     -44693.753      4657.3597     -1865.2981      3875.657     
      1700   315.29705     -44664.43       3262.4767     -5276.3319      3875.657     
      1800   302.21951     -44674.845      1934.135       1081.5428      3875.657     
      1900   308.4746      -44711.2        2467.1442      4148.8763      3875.657     
      2000   289.06536     -44702.205      11073.29      -319.28127      3875.657     
      2100   285.67474     -44706.042      314.54644     -335.10567      3875.657     
      2200   312.14548     -44729.304      16794.725     -2816.2903      3875.657     
      2300   314.00139     -44729.068      2424.5097      385.65391      3875.657     
      2400   300.13937     -44721.496     -2445.1454      178.49949      3875.657     
      2500   308.67587     -44752.005      4280.4375     -2424.7745      3875.657     
      2600   289.28512     -44734.283      3201.5668      2315.7749      3875.657     
      2700   289.0923      -44706.179     -2196.9848     -6150.2394      3875.657     
      2800   301.36234     -44693.567      15147.661     -1688.6101      3875.657     
      2900   315.16529     -44716.492     -2475.495      -4403.5676      3875.657     
      3000   292.24976     -44710.494      4265.6313     -2665.2128      3875.657     
Loop time of 157.232 on 8 procs for 3000 steps with 386 atoms

Performance: 0.824 ns/day, 29.117 hours/ns, 19.080 timesteps/s, 7.365 katom-step/s
99.2% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 94.616     | 101.33     | 133.56     | 122.0 | 64.45
Bond    | 0.0069813  | 0.0077177  | 0.0086141  |   0.5 |  0.00
Neigh   | 8.0978     | 8.6059     | 11.242     |  34.1 |  5.47
Comm    | 0.88424    | 33.117     | 39.828     | 213.5 | 21.06
Output  | 0.001249   | 0.0013947  | 0.0019744  |   0.6 |  0.00
Modify  | 11.458     | 14.1       | 14.606     |  26.7 |  8.97
Other   |            | 0.06876    |            |       |  0.04

Nlocal:          48.25 ave          57 max          40 min
Histogram: 1 0 0 2 1 2 1 0 0 1
Nghost:        3741.38 ave        3792 max        3683 min
Histogram: 1 1 0 1 1 0 2 0 0 2
Neighs:        33649.4 ave       39568 max       28176 min
Histogram: 1 0 0 2 1 2 1 0 0 1

Total # of neighbors = 269195
Ave neighs/atom = 697.39637
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -25.453619750114
variable C2neg equal ${d2}
variable C2neg equal -72.2135772010378
variable C3neg equal ${d3}
variable C3neg equal -20.7303652417418
variable C4neg equal ${d4}
variable C4neg equal -0.903720349326783
variable C5neg equal ${d5}
variable C5neg equal 3.08623429629349
variable C6neg equal ${d6}
variable C6neg equal 14.7123006840645

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.3502
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.173502 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -0.898198 0.0034)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 142 | 144.2 | 146.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   340.84522     -44691.035      3047.3594      0              3875.657     
       100   299.3852      -44652.105     -385.80884     -5438.615       3875.657     
       200   293.76967     -44675.038     -2354.0163     -5765.0382      3875.657     
       300   290.8747      -44690.782      2882.7519     -2031.6312      3875.657     
       400   295.96825     -44686.075      2944.7966     -5998.2453      3875.657     
       500   309.95978     -44674.024     -63.332262     -7235.7963      3875.657     
       600   311.73962     -44660.133      5223.2167     -849.59557      3875.657     
       700   298.27619     -44661.084      1467.9337      751.25527      3875.657     
       800   305.22104     -44693.204      13402.533      769.00672      3875.657     
       900   287.92916     -44684.723      5206.6267     -7376.476       3875.657     
      1000   303.76986     -44690.436      3986.0984      902.10912      3875.657     
      1100   293.4712      -44668.028      8065.4854     -5938.7686      3875.657     
      1200   298.28954     -44656.162      703.72714     -4283.1818      3875.657     
      1300   317.66577     -44674.328      12371.408     -1231.9943      3875.657     
      1400   301.71096     -44679.308      1207.0787     -697.61042      3875.657     
      1500   291.54837     -44693.459     -495.85771     -3680.235       3875.657     
      1600   295.57406     -44699.744      4519.4857     -1572.036       3875.657     
      1700   299.61835     -44684.169      4084.7779     -1193.5947      3875.657     
      1800   323.88561     -44683.468      4531.0836     -273.07182      3875.657     
      1900   322.1952      -44687.211     -4169.7681     -1181.9712      3875.657     
      2000   307.09213     -44676.266      14164.346      3124.3431      3875.657     
      2100   302.02383     -44675.836      3156.2875      4108.7338      3875.657     
      2200   307.51135     -44694.34      -12904.764     -5118.4288      3875.657     
      2300   293.43657     -44696.525      2517.9198     -3683.0607      3875.657     
      2400   303.4437      -44715.742      6563.8041      1138.8861      3875.657     
      2500   287.05468     -44673.144      5167.8094      2643.7662      3875.657     
      2600   309.57666     -44674.774      12558.123     -3052.0417      3875.657     
      2700   303.70063     -44667.402     -9433.4762     -7813.621       3875.657     
      2800   304.84724     -44693.524      9943.1254      3890.4067      3875.657     
      2900   274.30866     -44686.317      1430.2137     -37.365813      3875.657     
      3000   285.33317     -44691.907      4746.1417     -3641.5092      3875.657     
Loop time of 129.334 on 8 procs for 3000 steps with 386 atoms

Performance: 1.002 ns/day, 23.951 hours/ns, 23.196 timesteps/s, 8.954 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 92.232     | 95.852     | 107.04     |  45.8 | 74.11
Bond    | 0.0069187  | 0.0076399  | 0.0083932  |   0.5 |  0.01
Neigh   | 8.0674     | 8.3028     | 9.1854     |  11.8 |  6.42
Comm    | 2.678      | 13.871     | 17.493     | 120.4 | 10.72
Output  | 0.0054151  | 0.0069552  | 0.0079018  |   1.1 |  0.01
Modify  | 10.342     | 11.222     | 11.463     |  10.1 |  8.68
Other   |            | 0.07197    |            |       |  0.06

Nlocal:          48.25 ave          58 max          43 min
Histogram: 2 1 1 1 1 0 1 0 0 1
Nghost:        3730.38 ave        3749 max        3702 min
Histogram: 1 1 0 1 0 0 1 1 0 3
Neighs:        33593.1 ave       40067 max       29895 min
Histogram: 2 1 1 1 0 1 1 0 0 1

Total # of neighbors = 268745
Ave neighs/atom = 696.23057
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 142 | 144.2 | 146.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   285.33317     -44691.907      4746.06        0              3875.657     
       100   278.33037     -44675.493      3222.4387      229.68784      3875.657     
       200   295.34889     -44659.357     -14386.541     -2390.4403      3875.657     
       300   309.20699     -44666.935      11950.176     -1630.6416      3875.657     
       400   290.66311     -44656.635     -2327.5245      608.26442      3875.657     
       500   294.47315     -44674.936      6463.9202     -3211.446       3875.657     
       600   298.61129     -44686.451     -1314.0332     -1463.1093      3875.657     
       700   296.69321     -44660.521     -7188.2711     -1674.8283      3875.657     
       800   316.62698     -44657.736      9936.7295     -290.78272      3875.657     
       900   310.77716     -44667.117      9492.1877      1731.8474      3875.657     
      1000   307.96322     -44685.639      5972.4877      21.890649      3875.657     
      1100   311.74134     -44695.075     -1090.4401      124.03742      3875.657     
      1200   293.09203     -44673.356      11997.13      -6047.426       3875.657     
      1300   306.83873     -44684.524     -2849.9317      843.41616      3875.657     
      1400   285.7914      -44657.506      8962.3005      4031.4761      3875.657     
      1500   298.68586     -44659.311      7620.0754     -985.12886      3875.657     
      1600   314.36446     -44674.717      7954.7613      4197.1519      3875.657     
      1700   281.28971     -44649.685      15629.194      2.2698706      3875.657     
      1800   293.6048      -44675.744     -13131.303     -7192.6958      3875.657     
      1900   299.03119     -44688.662      5299.224       1314.4927      3875.657     
      2000   298.37799     -44688.879      6531.3506      3907.477       3875.657     
      2100   301.76077     -44673.94      -849.00673     -1432.7062      3875.657     
      2200   317.84733     -44672.014      3013.6681     -804.39127      3875.657     
      2300   309.26053     -44661.913      8235.9515      1175.8122      3875.657     
      2400   298.56133     -44685.624     -10299.806     -5627.3839      3875.657     
      2500   301.29519     -44708.254     -735.26154     -2513.657       3875.657     
      2600   287.52267     -44679.544     -1405.3586     -3545.5566      3875.657     
      2700   303.43481     -44676.985      3425.2978     -2950.094       3875.657     
      2800   279.08978     -44649.918      6924.0887      1388.2722      3875.657     
      2900   305.02407     -44684.458     -1202.1638     -5403.0982      3875.657     
      3000   297.58679     -44685.9       -4494.9615     -10138.574      3875.657     
Loop time of 106.7 on 8 procs for 3000 steps with 386 atoms

Performance: 1.215 ns/day, 19.759 hours/ns, 28.116 timesteps/s, 10.853 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 83.819     | 85.978     | 88.161     |  16.2 | 80.58
Bond    | 0.0064283  | 0.006918   | 0.0074609  |   0.5 |  0.01
Neigh   | 8.0702     | 8.1937     | 8.4723     |   4.2 |  7.68
Comm    | 0.73276    | 2.9139     | 5.0759     |  88.0 |  2.73
Output  | 0.0011244  | 0.0012469  | 0.0018257  |   0.6 |  0.00
Modify  | 9.2635     | 9.5355     | 9.6643     |   3.9 |  8.94
Other   |            | 0.07075    |            |       |  0.07

Nlocal:          48.25 ave          56 max          41 min
Histogram: 1 1 0 1 2 0 1 0 0 2
Nghost:           3737 ave        3795 max        3672 min
Histogram: 1 0 1 1 1 0 1 2 0 1
Neighs:        33613.2 ave       38874 max       28644 min
Histogram: 1 1 0 1 2 0 1 0 0 2

Total # of neighbors = 268906
Ave neighs/atom = 696.64767
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 101.177450055151
variable C2pos equal ${d2}
variable C2pos equal 84.6540039890475
variable C3pos equal ${d3}
variable C3pos equal 43.5557645844262
variable C4pos equal ${d4}
variable C4pos equal -13.6949634208281
variable C5pos equal ${d5}
variable C5pos equal 12.3621144235714
variable C6pos equal ${d6}
variable C6pos equal -17.3815549418949

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-25.453619750114+${C1pos})
variable C15 equal 0.5*(-25.453619750114+101.177450055151)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-72.2135772010378+${C2pos})
variable C25 equal 0.5*(-72.2135772010378+84.6540039890475)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-20.7303652417418+${C3pos})
variable C35 equal 0.5*(-20.7303652417418+43.5557645844262)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-0.903720349326783+${C4pos})
variable C45 equal 0.5*(-0.903720349326783+-13.6949634208281)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(3.08623429629349+${C5pos})
variable C55 equal 0.5*(3.08623429629349+12.3621144235714)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(14.7123006840645+${C6pos})
variable C65 equal 0.5*(14.7123006840645+-17.3815549418949)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.4502

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4502
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.134502 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.585002 -1.0717 0.0034)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143 | 144.8 | 146.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   340.84522     -44692.699      1158.6073      0              3875.657     
       100   310.58308     -44664.588      2286.203      -5616.225       3875.657     
       200   310.02472     -44692.945      9847.603      -4626.4713      3875.657     
       300   281.18258     -44678.033      379.61531     -2868.5718      3875.657     
       400   300.49171     -44693.541      5028.7123     -8468.0701      3875.657     
       500   301.47201     -44671.449      631.60007     -7297.257       3875.657     
       600   297.37283     -44648.315     -3560.7316     -1559.1658      3875.657     
       700   306.32419     -44664.447      8030.1294      4067.3383      3875.657     
       800   308.7392      -44685.519      5151.7566     -6649.0912      3875.657     
       900   277.99385     -44663.879     -1677.6413     -4988.2622      3875.657     
      1000   290.78911     -44666.477     -5087.4172     -1099.36        3875.657     
      1100   302.18811     -44664.732      5408.6575     -3266.1726      3875.657     
      1200   318.42754     -44675.125      8829.0247     -6690.863       3875.657     
      1300   302.21189     -44658.327      6616.0699     -4351.1978      3875.657     
      1400   302.73844     -44688.378      9397.3564     -1401.3692      3875.657     
      1500   281.15635     -44679.803      588.82817     -1653.102       3875.657     
      1600   307.03224     -44696.863      905.87691     -4405.6352      3875.657     
      1700   312.61791     -44674.761      4844.2351     -315.86099      3875.657     
      1800   298.08976     -44655.775     -3058.923      -1399.0662      3875.657     
      1900   289.38421     -44649.603      3319.3986     -6381.6207      3875.657     
      2000   313.27811     -44686.865      9118.2739      3419.318       3875.657     
      2100   311.57124     -44711.986      5748.1843      246.61558      3875.657     
      2200   282.11022     -44701.976     -8387.3371     -1240.4961      3875.657     
      2300   302.29232     -44713.026      12532.754     -5163.9011      3875.657     
      2400   297.99715     -44694.231      4284.4543      984.76106      3875.657     
      2500   284.91097     -44662.63      -6212.0727      675.10509      3875.657     
      2600   293.62689     -44663.592      1759.9383     -4626.5783      3875.657     
      2700   308.96096     -44671.673      14808.191      4492.9592      3875.657     
      2800   299.25338     -44674.983      8574.3619      1305.7407      3875.657     
      2900   295.63421     -44691.806      4764.1346      1745.7328      3875.657     
      3000   281.30984     -44683.675      6773.9186      4228.6554      3875.657     
Loop time of 105.814 on 8 procs for 3000 steps with 386 atoms

Performance: 1.225 ns/day, 19.595 hours/ns, 28.352 timesteps/s, 10.944 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 81.725     | 84.428     | 86.95      |  19.8 | 79.79
Bond    | 0.0061007  | 0.0067364  | 0.0071798  |   0.4 |  0.01
Neigh   | 8.1626     | 8.2959     | 8.5469     |   4.2 |  7.84
Comm    | 0.84483    | 3.3664     | 6.0732     |  99.0 |  3.18
Output  | 0.004799   | 0.0062533  | 0.0071417  |   1.1 |  0.01
Modify  | 9.3924     | 9.6399     | 9.7757     |   3.9 |  9.11
Other   |            | 0.07048    |            |       |  0.07

Nlocal:          48.25 ave          59 max          42 min
Histogram: 1 2 2 0 0 1 1 0 0 1
Nghost:        3759.75 ave        3789 max        3710 min
Histogram: 1 0 0 1 1 1 0 0 1 3
Neighs:        33612.1 ave       40732 max       29343 min
Histogram: 1 2 2 0 0 1 1 0 0 1

Total # of neighbors = 268897
Ave neighs/atom = 696.62435
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143 | 144.8 | 146.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   281.30984     -44683.675      6773.8707      0              3875.657     
       100   307.32765     -44699.002     -398.78825      1634.3426      3875.657     
       200   290.43475     -44654.828      10558.571      2176.9999      3875.657     
       300   313.62475     -44686.201      10214.415      1535.5768      3875.657     
       400   293.8731      -44695.203      9503.6106      4481.2482      3875.657     
       500   281.68367     -44700.695     -1808.7822     -1293.4909      3875.657     
       600   302.56291     -44715.37      -9793.6257     -6237.289       3875.657     
       700   312.4407      -44703.494      7012.7092     -9182.6043      3875.657     
       800   314.01848     -44694.798      10141.664     -1601.8176      3875.657     
       900   308.28016     -44698.727      16290.959     -1139.2444      3875.657     
      1000   288.10478     -44708.208      6024.128       3015.0096      3875.657     
      1100   296.29852     -44724.546      9374.1077      3556.9205      3875.657     
      1200   292.7043      -44706.304      7136.5126     -1002.3447      3875.657     
      1300   296.90333     -44692.801      2815.0834     -5253.7224      3875.657     
      1400   320.24198     -44717.021      6497.2004     -1622.9155      3875.657     
      1500   286.38166     -44686.347      6869.5242     -1557.8121      3875.657     
      1600   303.71935     -44714.441      5376.9188     -166.52591      3875.657     
      1700   284.55398     -44714.977      13632.8        3600.621       3875.657     
      1800   285.92667     -44736.478     -1040.7889     -429.37296      3875.657     
      1900   285.14469     -44726.242     -3913.6308     -1160.2245      3875.657     
      2000   308.08149     -44716.523      8103.1202     -1329.3654      3875.657     
      2100   318.15323     -44721.38       1734.1727      197.23014      3875.657     
      2200   312.88617     -44723.485      318.52505      600.0228       3875.657     
      2300   316.17753     -44758.719     -2768.7616     -3480.653       3875.657     
      2400   302.18373     -44747.675     -2894.3817     -3088.4769      3875.657     
      2500   302.40839     -44739.51       5776.2379     -683.58086      3875.657     
      2600   299.35105     -44715.107     -4174.9655     -5175.7172      3875.657     
      2700   299.46461     -44701.348      13957.934     -84.497339      3875.657     
      2800   308.27062     -44714.245      7918.0767      520.35801      3875.657     
      2900   311.52665     -44727.518      2371.8237      566.31187      3875.657     
      3000   299.79819     -44726.746      3253.127      -314.15012      3875.657     
Loop time of 104.683 on 8 procs for 3000 steps with 386 atoms

Performance: 1.238 ns/day, 19.386 hours/ns, 28.658 timesteps/s, 11.062 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 81.518     | 83.529     | 85.955     |  15.4 | 79.79
Bond    | 0.0061137  | 0.006692   | 0.0071361  |   0.4 |  0.01
Neigh   | 8.1459     | 8.2764     | 8.6675     |   5.5 |  7.91
Comm    | 0.66532    | 3.0928     | 5.1056     |  80.3 |  2.95
Output  | 0.0010767  | 0.0011994  | 0.0016897  |   0.5 |  0.00
Modify  | 9.3154     | 9.7067     | 9.8376     |   5.1 |  9.27
Other   |            | 0.07026    |            |       |  0.07

Nlocal:          48.25 ave          60 max          42 min
Histogram: 2 1 1 2 0 0 1 0 0 1
Nghost:         3746.5 ave        3786 max        3704 min
Histogram: 2 0 1 1 0 0 0 0 3 1
Neighs:          33624 ave       41281 max       29486 min
Histogram: 2 1 1 1 1 0 1 0 0 1

Total # of neighbors = 268992
Ave neighs/atom = 696.87047
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -1.63147699965142
variable C2neg equal ${d2}
variable C2neg equal -115.365883586897
variable C3neg equal ${d3}
variable C3neg equal -17.3658323549014
variable C4neg equal ${d4}
variable C4neg equal -2.3049501420615
variable C5neg equal ${d5}
variable C5neg equal 4.10072018404211
variable C6neg equal ${d6}
variable C6neg equal 39.1617764626069

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4502
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.134502 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.315998 -1.0717 0.0034)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 141.5 | 143.8 | 146.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   340.84522     -44687.678      4524.0212      0              3875.657     
       100   306.05924     -44657.498     -3978.1476     -5579.2585      3875.657     
       200   311.1763      -44696.095      542.54148     -3129.9339      3875.657     
       300   282.16227     -44684.327     -4120.1183     -4380.5648      3875.657     
       400   294.86617     -44689.466      894.54262     -5223.4902      3875.657     
       500   286.93692     -44654.386      8186.7658     -4082.6415      3875.657     
       600   295.96218     -44644.691     -5972.9547     -6400.918       3875.657     
       700   305.20541     -44666.984      6824.0404     -2497.0408      3875.657     
       800   303.40457     -44698.416      2212.9428     -1784.9038      3875.657     
       900   293.28419     -44694.871      3815.7705     -145.55639      3875.657     
      1000   281.74568     -44671.817     -1578.577       2233.5771      3875.657     
      1100   309.96776     -44681.495      5440.6027      2309.0014      3875.657     
      1200   319.3869      -44688.194      1968.2689     -659.31886      3875.657     
      1300   299.75828     -44694.349     -5413.0394     -3596.0411      3875.657     
      1400   282.71834     -44689.016      680.94169     -3348.6436      3875.657     
      1500   298.69585     -44705.776      8237.22       -1378.2363      3875.657     
      1600   291.17725     -44692.418      25296.495     -114.67784      3875.657     
      1700   309.34042     -44687.715      12528.727     -6573.5349      3875.657     
      1800   329.56278     -44672.182      13395.321     -935.4697       3875.657     
      1900   318.17093     -44680.829      6753.8281      924.90074      3875.657     
      2000   304.68158     -44690.515     -11638.356      2350.2621      3875.657     
      2100   295.72558     -44691.203     -3292.3195     -1642.2689      3875.657     
      2200   292.44906     -44679.697     -5134.1864     -378.61052      3875.657     
      2300   323.59365     -44681.194      9074.9097      3348.3673      3875.657     
      2400   299.25531     -44650.721      3301.1058      4286.7595      3875.657     
      2500   293.98987     -44691.966     -3600.9758      6499.235       3875.657     
      2600   306.82185     -44718.948      14803.781      5285.246       3875.657     
      2700   284.05812     -44683.995      11553.03      -1182.4058      3875.657     
      2800   294.72695     -44671.462     -5510.7842      2029.7561      3875.657     
      2900   319.2734      -44680.205      7798.0095     -606.8938       3875.657     
      3000   307.5588      -44678.868      13795.478     -199.70759      3875.657     
Loop time of 94.7246 on 8 procs for 3000 steps with 386 atoms

Performance: 1.368 ns/day, 17.542 hours/ns, 31.671 timesteps/s, 12.225 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 71.306     | 73.735     | 76.93      |  21.4 | 77.84
Bond    | 0.0053076  | 0.0056903  | 0.0060464  |   0.3 |  0.01
Neigh   | 7.8806     | 7.9802     | 8.0432     |   2.4 |  8.42
Comm    | 0.60222    | 3.7919     | 6.222      |  94.4 |  4.00
Output  | 0.0045097  | 0.0060882  | 0.0071187  |   1.2 |  0.01
Modify  | 9.0701     | 9.14       | 9.2378     |   2.2 |  9.65
Other   |            | 0.06595    |            |       |  0.07

Nlocal:          48.25 ave          57 max          43 min
Histogram: 1 1 4 0 0 0 0 0 1 1
Nghost:        3732.12 ave        3788 max        3678 min
Histogram: 2 0 2 0 0 0 0 2 1 1
Neighs:        33617.6 ave       39247 max       29966 min
Histogram: 1 1 2 2 0 0 0 0 1 1

Total # of neighbors = 268941
Ave neighs/atom = 696.73834
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 141.4 | 143.8 | 146.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.5588      -44678.868      13795.544      0              3875.657     
       100   306.39223     -44688.519      16521.543      3752.7929      3875.657     
       200   293.68384     -44710.872      4220.8948      4587.7355      3875.657     
       300   297.61264     -44720.323      15757.856      7805.4495      3875.657     
       400   287.8382      -44699.358      14227.911      3615.1102      3875.657     
       500   308.49525     -44700.083     -3777.7947      1107.3273      3875.657     
       600   304.4456      -44683.255      8065.2059      1326.5652      3875.657     
       700   297.56533     -44693.63       3689.7602     -1633.7406      3875.657     
       800   279.65334     -44711.322      6373.6151      875.82221      3875.657     
       900   294.76167     -44721.495     -2273.0182     -2580.2238      3875.657     
      1000   303.31099     -44707.121     -3529.0411      2174.3769      3875.657     
      1100   312.13917     -44707.123      327.2893       273.5502       3875.657     
      1200   304.78907     -44723.848      7602.6369     -215.88027      3875.657     
      1300   288.09944     -44733.314      8291.318       5535.1424      3875.657     
      1400   290.32506     -44730.12      -2750.5418     -3896.7001      3875.657     
      1500   325.50224     -44743.45       9744.673      -1106.7614      3875.657     
      1600   321.89469     -44724.46      -2479.9578     -4011.5301      3875.657     
      1700   290.79386     -44696.569      456.50181     -6314.3774      3875.657     
      1800   316.13333     -44742.899      2513.8928     -2231.4007      3875.657     
      1900   280.84675     -44745.895     -1254.3482      2545.2582      3875.657     
      2000   290.06394     -44755.652      9449.6807     -378.89607      3875.657     
      2100   293.05688     -44736.534      6050.9302     -1900.6217      3875.657     
      2200   296.76874     -44719.905      4765.619       1586.7622      3875.657     
      2300   296.81413     -44700.041     -1661.5668     -1404.6534      3875.657     
      2400   329.35788     -44730.781      3064.406      -1552.0026      3875.657     
      2500   300.00984     -44722.938      385.18899     -1927.2843      3875.657     
      2600   284.62157     -44742.566     -1547.4095      342.41273      3875.657     
      2700   282.70936     -44725.646     -3028.3549     -940.05419      3875.657     
      2800   289.91489     -44705.102      7783.6255      2540.9323      3875.657     
      2900   305.62225     -44705.507      2620.4729     -3144.1256      3875.657     
      3000   314.83077     -44719.312     -3172.3587     -4416.3958      3875.657     
Loop time of 94.2147 on 8 procs for 3000 steps with 386 atoms

Performance: 1.376 ns/day, 17.447 hours/ns, 31.842 timesteps/s, 12.291 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 71.459     | 73.372     | 76.065     |  20.2 | 77.88
Bond    | 0.0053199  | 0.0057208  | 0.0060578  |   0.4 |  0.01
Neigh   | 7.8616     | 7.9843     | 8.3643     |   5.5 |  8.47
Comm    | 0.69768    | 3.3817     | 5.2981     |  94.1 |  3.59
Output  | 0.00080387 | 0.00087749 | 0.0013546  |   0.0 |  0.00
Modify  | 9.0149     | 9.4039     | 9.5289     |   5.2 |  9.98
Other   |            | 0.06575    |            |       |  0.07

Nlocal:          48.25 ave          59 max          40 min
Histogram: 1 0 1 4 0 0 0 0 1 1
Nghost:         3710.5 ave        3741 max        3657 min
Histogram: 1 0 1 0 1 0 1 0 2 2
Neighs:        33593.5 ave       40702 max       27925 min
Histogram: 1 0 1 4 0 0 0 0 1 1

Total # of neighbors = 268748
Ave neighs/atom = 696.23834
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 43.1974817251653
variable C2pos equal ${d2}
variable C2pos equal 50.7469034722909
variable C3pos equal ${d3}
variable C3pos equal 8.48292210831204
variable C4pos equal ${d4}
variable C4pos equal -3.89966288758756
variable C5pos equal ${d5}
variable C5pos equal -2.81505344596798
variable C6pos equal ${d6}
variable C6pos equal -25.3249830703202

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-1.63147699965142+${C1pos})
variable C16 equal 0.5*(-1.63147699965142+43.1974817251653)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-115.365883586897+${C2pos})
variable C26 equal 0.5*(-115.365883586897+50.7469034722909)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-17.3658323549014+${C3pos})
variable C36 equal 0.5*(-17.3658323549014+8.48292210831204)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-2.3049501420615+${C4pos})
variable C46 equal 0.5*(-2.3049501420615+-3.89966288758756)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(4.10072018404211+${C5pos})
variable C56 equal 0.5*(4.10072018404211+-2.81505344596798)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(39.1617764626069+${C6pos})
variable C66 equal 0.5*(39.1617764626069+-25.3249830703202)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 8.75803509262135
variable C22all equal ${C22}
variable C22all equal 50.9548778914009
variable C33all equal ${C33}
variable C33all equal 35.95415110495

variable C44all equal ${C44}
variable C44all equal -3.56640280916001
variable C55all equal ${C55}
variable C55all equal 7.72417435993245
variable C66all equal ${C66}
variable C66all equal 6.91839669614335

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(14.7829423375587+${C21})
variable C12all equal 0.5*(14.7829423375587+25.571207309309)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(50.0065556648529+${C31})
variable C13all equal 0.5*(50.0065556648529+7.68076254381145)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(50.6504194897385+${C32})
variable C23all equal 0.5*(50.6504194897385+44.3626995815138)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-8.81858102262445+${C41})
variable C14all equal 0.5*(-8.81858102262445+4.3190832977244)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(37.8619151525185+${C51})
variable C15all equal 0.5*(37.8619151525185+-8.52343616354053)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(20.7830023627569+${C61})
variable C16all equal 0.5*(20.7830023627569+3.77800144647625)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-13.3390021490238+${C42})
variable C24all equal 0.5*(-13.3390021490238+3.13452655963071)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(6.22021339400485+${C52})
variable C25all equal 0.5*(6.22021339400485+6.16451320314602)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-32.3094900573031+${C62})
variable C26all equal 0.5*(-32.3094900573031+2.91249613733325)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(-55.1084266117862+${C43})
variable C34all equal 0.5*(-55.1084266117862+1.47472210079731)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(11.4126996713422+${C53})
variable C35all equal 0.5*(11.4126996713422+3.11778995086712)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-4.44145512329468+${C63})
variable C36all equal 0.5*(-4.44145512329468+1.37550697581385)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-7.29934188507744+${C54})
variable C45all equal 0.5*(-7.29934188507744+0.91958099202352)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-3.10230651482453+${C64})
variable C46all equal 0.5*(-3.10230651482453+-2.9747410571733)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(0.642833369037065+${C65})
variable C56all equal 0.5*(0.642833369037065+-1.3346271289152)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 1:03:51
