LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 30*${nthermo}       # steps of equilibration run 20
variable nequil equal 30*100       
variable nrun equal 30*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 30*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-RV-32-vasp
read_data       ${structure}.data
read_data       333-RV-32-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.010 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 9.2173e-05 on 8 procs for 1 steps with 331 atoms

47.7% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.956e-06  | 2.1391e-06 | 2.584e-06  |   0.0 |  2.32
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 4.469e-06  | 5.5517e-06 | 7.124e-06  |   0.0 |  6.02
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 8.448e-05  |            |       | 91.66

Nlocal:         41.375 ave          44 max          36 min
Histogram: 1 0 0 0 0 1 1 2 2 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-RV-32-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 3000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = 27.88 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.6 | 129.1 | 130.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -34729.82       144799.92      0              1.400369       3602.6891    
       100   683.66303     -35479.052     -48952.942      2649.1415      1.400369       3602.6891    
       200   557.24668     -35756.544     -838.30449     -1426.2655      1.400369       3602.6891    
       300   515.08152     -36024.756     -5808.8384     -1610.5125      1.400369       3602.6891    
       400   395.61044     -36139.869      1395.4697      2488.6091      1.400369       3602.6891    
       500   318.9385      -36218.976     -2853.1074     -935.25332      1.400369       3602.6891    
       600   284.58968     -36279.633      5524.3292      880.67851      1.400369       3602.6891    
       700   285.48872     -36328.483      6216.625      -5744.3138      1.400369       3602.6891    
       800   288.55366     -36341.687      2559.8857      1508.4823      1.400369       3602.6891    
       900   322.34913     -36379.972     -4094.4895     -2514.8531      1.400369       3602.6891    
      1000   295.99187     -36379.935     -5670.8963     -4582.1347      1.400369       3602.6891    
      1100   282.57744     -36389.632     -7174.3333     -1402.2137      1.400369       3602.6891    
      1200   297.28283     -36410.028      6527.6548     -115.82856      1.400369       3602.6891    
      1300   303.26915     -36411.976     -7382.3597     -1017.4775      1.400369       3602.6891    
      1400   308.31364     -36403.592      116.35074      950.94889      1.400369       3602.6891    
      1500   315.73557     -36410.382      329.37542     -2442.9785      1.400369       3602.6891    
      1600   299.53601     -36415.528      1486.4851     -2938.1167      1.400369       3602.6891    
      1700   290.05467     -36434.971      1072.1344      2286.3871      1.400369       3602.6891    
      1800   295.7381      -36463.807      6978.3378      915.33617      1.400369       3602.6891    
      1900   285.26095     -36458.835     -12195.951     -9499.8126      1.400369       3602.6891    
      2000   285.14666     -36441.433      6852.6924     -2369.6638      1.400369       3602.6891    
      2100   303.76878     -36433.79      -1863.1267      1486.007       1.400369       3602.6891    
      2200   295.01381     -36416.532      12889.822     -4492.4681      1.400369       3602.6891    
      2300   321.788       -36454.543     -2963.6295     -7694.306       1.400369       3602.6891    
      2400   282.77026     -36453.697     -9688.1937     -5454.1243      1.400369       3602.6891    
      2500   271.13023     -36470.617     -2297.1504     -1883.3854      1.400369       3602.6891    
      2600   293.87403     -36495.424     -8256.1311     -4002.318       1.400369       3602.6891    
      2700   311.72014     -36493         -15391.179     -8971.5324      1.400369       3602.6891    
      2800   312.48503     -36475.447      13835.569      2705.4925      1.400369       3602.6891    
      2900   314.4891      -36475.978     -10566.912     -1138.9972      1.400369       3602.6891    
      3000   288.05611     -36468.165     -16904.071     -10452.415      1.400369       3602.6891    
Loop time of 143.51 on 8 procs for 3000 steps with 331 atoms

Performance: 0.903 ns/day, 26.576 hours/ns, 20.905 timesteps/s, 6.919 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 85.04      | 106.55     | 120.02     | 118.5 | 74.25
Bond    | 0.0083753  | 0.0092678  | 0.010111   |   0.6 |  0.01
Neigh   | 6.6345     | 8.5406     | 9.5884     |  33.5 |  5.95
Comm    | 1.9756     | 15.456     | 36.949     | 311.1 | 10.77
Output  | 0.001588   | 0.0017623  | 0.0026124  |   0.8 |  0.00
Modify  | 11.801     | 12.88      | 14.808     |  27.5 |  8.97
Other   |            | 0.0726     |            |       |  0.05

Nlocal:         41.375 ave          51 max          33 min
Histogram: 1 0 2 1 0 1 2 0 0 1
Nghost:        3256.12 ave        3290 max        3215 min
Histogram: 1 1 0 1 0 1 1 0 2 1
Neighs:        26627.4 ave       32490 max       21396 min
Histogram: 1 0 1 1 1 1 2 0 0 1

Total # of neighbors = 213019
Ave neighs/atom = 643.56193
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-RV-32-vasp_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.7087
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.0868
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.5248

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--10452.4146932493)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--10452.4146932493)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--7207.27794192157)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--7207.27794192157)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--12245.6654979482)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--12245.6654979482)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--1226.21484142822)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--1226.21484142822)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-1111.67744912196)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-1111.67744912196)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-1382.04204208308)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-1382.04204208308)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 15.7087
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.7087
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.157087 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.157087 xy delta 0.082042 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.157087 xy delta 0.082042 xz delta 0.001458 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.551613 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.551613 13.0868 17.5248) with tilt (-8.122158 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.551613 13.0868 17.5248) with tilt (-8.122158 -0.144342 -2.0056)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.8 | 127.5 | 129 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.05611     -36468.349      21597.905      0              3566.6622    
       100   304.0535      -36506.069     -11276.387     -1747.954       3566.6622    
       200   273.2311      -36494.233      8122.2181      3668.0107      3566.6622    
       300   304.23505     -36522.591     -11631.013     -3386.4141      3566.6622    
       400   297.57886     -36507.928     -3475.9288      2429.0049      3566.6622    
       500   278.84511     -36478.692     -8638.2827      1331.5887      3566.6622    
       600   314.71424     -36500.122      6862.874      -984.07966      3566.6622    
       700   314.65699     -36501.849     -218.38007      702.55242      3566.6622    
       800   302.1257      -36516.451     -4377.0603      3764.5492      3566.6622    
       900   279.61537     -36518.471      942.60262      4153.5693      3566.6622    
      1000   281.23642     -36529.848      693.56551     -414.50243      3566.6622    
      1100   269.79435     -36508.64      -3480.9148      1592.7543      3566.6622    
      1200   304.98835     -36515.217      3526.4507      584.59574      3566.6622    
      1300   314.52849     -36507.731      12384.838      3011.4985      3566.6622    
      1400   332.41737     -36528.835      5213.9295      2088.526       3566.6622    
      1500   287.71623     -36513.179     -4768.6226      4369.466       3566.6622    
      1600   287.98821     -36527.874     -12778.684      3727.8929      3566.6622    
      1700   297.50423     -36539.28       5740.8665      2401.4747      3566.6622    
      1800   276.35012     -36504.611      6532.884       1364.8908      3566.6622    
      1900   302.8753      -36502.846      3112.1152      6317.7855      3566.6622    
      2000   305.98119     -36504.341     -940.05172      2904.6875      3566.6622    
      2100   300.2121      -36510.095      2302.4202      1030.1806      3566.6622    
      2200   295.69457     -36539.204     -9273.5351     -4006.4574      3566.6622    
      2300   288.9414      -36546.893      165.45388     -875.31236      3566.6622    
      2400   307.44846     -36548.629     -2476.8534      3009.4773      3566.6622    
      2500   289.31596     -36512.891     -2005.8543     -2012.6073      3566.6622    
      2600   299.62638     -36508.145      2662.0963      387.24603      3566.6622    
      2700   304.53621     -36504.968      6895.76        7999.033       3566.6622    
      2800   313.21311     -36525.956      1013.5918      3760.0854      3566.6622    
      2900   290.64858     -36540.759     -2897.1832      760.3329       3566.6622    
      3000   283.28794     -36533.467     -984.26981      7271.3408      3566.6622    
Loop time of 149.9 on 8 procs for 3000 steps with 331 atoms

Performance: 0.865 ns/day, 27.759 hours/ns, 20.013 timesteps/s, 6.624 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 81.644     | 113.86     | 124.03     | 121.2 | 75.96
Bond    | 0.0081911  | 0.0091099  | 0.010426   |   0.7 |  0.01
Neigh   | 7.5036     | 10.272     | 11.246     |  35.3 |  6.85
Comm    | 1.952      | 12.139     | 44.372     | 371.6 |  8.10
Output  | 0.0069644  | 0.0084991  | 0.0098569  |   1.2 |  0.01
Modify  | 12.523     | 13.536     | 16.302     |  30.8 |  9.03
Other   |            | 0.074      |            |       |  0.05

Nlocal:         41.375 ave          48 max          33 min
Histogram: 1 0 2 0 0 0 1 1 2 1
Nghost:        3273.62 ave        3316 max        3243 min
Histogram: 3 0 0 1 1 0 1 0 1 1
Neighs:        26931.5 ave       30940 max       21767 min
Histogram: 1 0 2 0 0 0 1 2 1 1

Total # of neighbors = 215452
Ave neighs/atom = 650.91239
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.3 | 127.6 | 129.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   283.28794     -36533.467     -984.29605      0              3566.6622    
       100   294.46519     -36525.507      14721.652     -12.376252      3566.6622    
       200   320.02206     -36530.647     -4271.3157      4086.2794      3566.6622    
       300   305.97421     -36524.906     -4577.8238      4821.2035      3566.6622    
       400   291.10768     -36517.552      357.90151     -2499.6249      3566.6622    
       500   292.46991     -36525.811     -2296.4903     -565.74871      3566.6622    
       600   293.69516     -36538.961      6767.7871      696.2374       3566.6622    
       700   290.80577     -36531.296     -9876.5982      5312.6332      3566.6622    
       800   301.80329     -36512.586     -1608.3208     -378.84514      3566.6622    
       900   300.74535     -36500.485      2597.715      -692.37395      3566.6622    
      1000   335.59263     -36543.623     -14007.869      2728.8708      3566.6622    
      1100   289.46242     -36528.482      1121.0246     -2036.1618      3566.6622    
      1200   282.12615     -36521.308     -2604.6931      1157.3511      3566.6622    
      1300   302.68606     -36529.44       9954.5943      3406.5999      3566.6622    
      1400   307.67634     -36519.654     -1217.0514      837.06672      3566.6622    
      1500   294.5194      -36489.585     -2148.5027      6196.9761      3566.6622    
      1600   333.74122     -36499.382      2581.4741      1591.5313      3566.6622    
      1700   318.83373     -36485.773     -8385.4444      3388.547       3566.6622    
      1800   291.10288     -36503.925     -312.75733     -1017.0621      3566.6622    
      1900   313.39116     -36533.655      574.35783      9844.2029      3566.6622    
      2000   292.75199     -36521.631     -1176.428       2999.8474      3566.6622    
      2100   292.51456     -36526.219     -9225.0253      911.17606      3566.6622    
      2200   285.60136     -36507.603      5695.0504      4081.1694      3566.6622    
      2300   336.35144     -36528.833      4044.0679      3930.9866      3566.6622    
      2400   329.31491     -36518.72       12773.759      1932.2367      3566.6622    
      2500   296.97944     -36517.198     -2012.0677     -2501.3569      3566.6622    
      2600   291.88492     -36520.833      2232.687       2891.7693      3566.6622    
      2700   306.57963     -36536.422      587.35065      777.05372      3566.6622    
      2800   295.19695     -36533.331     -7098.1451     -4541.926       3566.6622    
      2900   298.76989     -36557.361     -2578.1245      4152.4793      3566.6622    
      3000   310.85247     -36598.873     -5092.9384      8648.5761      3566.6622    
Loop time of 150.279 on 8 procs for 3000 steps with 331 atoms

Performance: 0.862 ns/day, 27.829 hours/ns, 19.963 timesteps/s, 6.608 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 82.754     | 111.95     | 124.04     | 136.5 | 74.49
Bond    | 0.0081024  | 0.0091489  | 0.010859   |   0.8 |  0.01
Neigh   | 7.5292     | 10.077     | 11.172     |  40.0 |  6.71
Comm    | 2.0759     | 14.217     | 43.421     | 383.4 |  9.46
Output  | 0.0013129  | 0.0016965  | 0.0034877  |   1.7 |  0.00
Modify  | 12.808     | 13.953     | 16.503     |  34.1 |  9.28
Other   |            | 0.07427    |            |       |  0.05

Nlocal:         41.375 ave          48 max          34 min
Histogram: 2 0 1 0 1 0 0 2 0 2
Nghost:           3247 ave        3293 max        3202 min
Histogram: 1 0 1 3 0 0 1 0 0 2
Neighs:        26913.2 ave       30883 max       22405 min
Histogram: 2 0 1 0 1 0 0 2 0 2

Total # of neighbors = 215306
Ave neighs/atom = 650.4713
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 193.540788963084
variable C2neg equal ${d2}
variable C2neg equal 45.6373072773481
variable C3neg equal ${d3}
variable C3neg equal 85.287619940919
variable C4neg equal ${d4}
variable C4neg equal 9.18499294826031
variable C5neg equal ${d5}
variable C5neg equal 10.6381419988149
variable C6neg equal ${d6}
variable C6neg equal -8.3105295404284

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.7087
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.157087 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.157087 xy delta -0.082042 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.157087 xy delta -0.082042 xz delta -0.001458 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.865787 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.865787 13.0868 17.5248) with tilt (-8.286242 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.865787 13.0868 17.5248) with tilt (-8.286242 -0.147258 -2.0056)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.8 | 125.2 | 126.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.05611     -36438.935     -51549.69       0              3638.716     
       100   303.65119     -36485.088     -15910.86      -10730.316      3638.716     
       200   278.99549     -36491.524     -1015.3716      2355.6613      3638.716     
       300   285.45071     -36501.685     -7687.4323     -5375.2346      3638.716     
       400   307.03907     -36516.468     -5836.7421     -4190.4627      3638.716     
       500   298.17709     -36495.507     -3159.3076     -2390.4292      3638.716     
       600   319.02624     -36497.461     -11003.209     -3865.9763      3638.716     
       700   288.42072     -36456.552     -8971.1761     -7444.6546      3638.716     
       800   295.89621     -36463.22       11241.329     -5327.1775      3638.716     
       900   296.70024     -36481.888     -1667.7852     -2069.6357      3638.716     
      1000   306.57098     -36515.827      2569.1041      459.11165      3638.716     
      1100   292.40307     -36520.665      14942.288      4950.085       3638.716     
      1200   300.84888     -36533.25       5120.0178     -1169.1012      3638.716     
      1300   307.01202     -36537.841     -18051.064     -5526.6833      3638.716     
      1400   300.37405     -36526.607      349.11363     -4546.4534      3638.716     
      1500   307.2874      -36517.726      2010.7094     -2698.5993      3638.716     
      1600   301.47627     -36504.456      7419.1319     -5067.5013      3638.716     
      1700   314.38309     -36524.217     -13505.639     -2321.1484      3638.716     
      1800   282.52737     -36515.683     -7673.0903     -6773.2264      3638.716     
      1900   293.68387     -36535.959      728.54207     -1931.6196      3638.716     
      2000   302.33772     -36540.692     -8222.9681     -5456.7684      3638.716     
      2100   296.38198     -36498.293     -7222.9746      1068.379       3638.716     
      2200   317.60103     -36509.821     -1016.9506     -1547.7152      3638.716     
      2300   287.90918     -36507.214     -3256.623      -2401.9465      3638.716     
      2400   297.91164     -36533.254     -4572.6942     -1660.4942      3638.716     
      2500   288.6167      -36519.233      765.99571      2479.3525      3638.716     
      2600   296.85426     -36511.904     -3243.6296     -70.565381      3638.716     
      2700   295.83701     -36496.078      12426.255     -4802.8937      3638.716     
      2800   319.64987     -36489.829     -4507.6765      293.0278       3638.716     
      2900   311.26582     -36495.641      1295.7468     -6781.8433      3638.716     
      3000   302.4552      -36516.294      5336.1439      3300.1441      3638.716     
Loop time of 143.118 on 8 procs for 3000 steps with 331 atoms

Performance: 0.906 ns/day, 26.503 hours/ns, 20.962 timesteps/s, 6.938 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 87.457     | 107.34     | 119.42     | 116.5 | 75.00
Bond    | 0.0082974  | 0.0093106  | 0.01057    |   0.8 |  0.01
Neigh   | 7.0929     | 8.5562     | 9.5704     |  32.6 |  5.98
Comm    | 1.9467     | 14.042     | 33.939     | 322.5 |  9.81
Output  | 0.0067284  | 0.0085657  | 0.010576   |   1.5 |  0.01
Modify  | 12.03      | 13.085     | 14.544     |  26.5 |  9.14
Other   |            | 0.07466    |            |       |  0.05

Nlocal:         41.375 ave          48 max          35 min
Histogram: 2 0 0 2 0 0 2 0 1 1
Nghost:        3222.75 ave        3246 max        3191 min
Histogram: 1 0 0 2 1 0 1 0 1 2
Neighs:        26352.8 ave       30420 max       22522 min
Histogram: 2 0 0 2 0 0 2 0 1 1

Total # of neighbors = 210822
Ave neighs/atom = 636.92447
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.8 | 125.2 | 126.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.4552      -36516.294      5336.1622      0              3638.716     
       100   298.78301     -36516.882     -17608.91      -2517.2617      3638.716     
       200   290.945       -36540.31      -2654.0639     -3252.9388      3638.716     
       300   307.83035     -36568.922      872.61503      2406.1634      3638.716     
       400   286.29698     -36536.964     -1891.4386     -2889.8902      3638.716     
       500   288.5196      -36520.79      -15227.378     -4797.9515      3638.716     
       600   307.15657     -36528.171      6233.7872     -5617.3229      3638.716     
       700   287.29685     -36509.018     -1988.8296     -4818.4758      3638.716     
       800   301.13889     -36513.374     -4877.4736     -3858.6332      3638.716     
       900   327.27957     -36533.589     -3687.0139      831.55092      3638.716     
      1000   293.29163     -36522.106     -2586.0807     -11075.68       3638.716     
      1100   288.86334     -36535.632     -3925.245      -1782.0847      3638.716     
      1200   298.91        -36553.139     -157.98612     -2052.8319      3638.716     
      1300   299.21175     -36530.787     -19621.229     -998.84154      3638.716     
      1400   308.12461     -36512.018     -1198.2243     -5862.1596      3638.716     
      1500   316.6631      -36529.274     -10256.882     -9042.1233      3638.716     
      1600   304.51375     -36532.921     -15427.179     -1074.9803      3638.716     
      1700   308.24883     -36549.779      1567.5748     -1524.1536      3638.716     
      1800   289.81907     -36539.916     -1531.7325     -3031.1142      3638.716     
      1900   286.41589     -36533.383     -9253.0686     -6634.7536      3638.716     
      2000   313.45222     -36541.055     -2855.2561     -5542.826       3638.716     
      2100   309.35249     -36527.13      -1454.0356     -5762.1533      3638.716     
      2200   301.51653     -36529.234     -2817.3116     -3104.4355      3638.716     
      2300   295.12723     -36549.128     -4019.4145     -2734.0404      3638.716     
      2400   301.73074     -36561.501     -11539.731     -6652.9999      3638.716     
      2500   306.28822     -36556.742      4658.7259     -8132.4928      3638.716     
      2600   310.73552     -36531.801     -13599.108     -2711.1016      3638.716     
      2700   320.55725     -36526.228      3379.1221      1115.4558      3638.716     
      2800   327.61075     -36557.235     -1713.0027     -6953.1374      3638.716     
      2900   309.61211     -36567.583     -5069.7127     -4325.9242      3638.716     
      3000   273.29697     -36538.868      1520.7259     -7783.3067      3638.716     
Loop time of 144.563 on 8 procs for 3000 steps with 331 atoms

Performance: 0.896 ns/day, 26.771 hours/ns, 20.752 timesteps/s, 6.869 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 112.92     | 116.81     | 119.38     |  20.5 | 80.81
Bond    | 0.0084026  | 0.0094671  | 0.011223   |   0.9 |  0.01
Neigh   | 8.9542     | 9.2707     | 9.5865     |   7.7 |  6.41
Comm    | 3.0393     | 5.6218     | 9.5491     |  94.5 |  3.89
Output  | 0.0013247  | 0.0015659  | 0.0029891  |   1.4 |  0.00
Modify  | 12.411     | 12.764     | 13.106     |   7.3 |  8.83
Other   |            | 0.08065    |            |       |  0.06

Nlocal:         41.375 ave          46 max          37 min
Histogram: 2 0 0 1 2 0 0 1 1 1
Nghost:           3190 ave        3209 max        3158 min
Histogram: 1 1 0 0 0 0 1 3 0 2
Neighs:          26371 ave       29098 max       23718 min
Histogram: 2 0 0 1 2 0 0 1 1 1

Total # of neighbors = 210968
Ave neighs/atom = 637.36556
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -27.0447365095262
variable C2pos equal ${d2}
variable C2pos equal -53.2188128536188
variable C3pos equal ${d3}
variable C3pos equal -26.4311956830805
variable C4pos equal ${d4}
variable C4pos equal -8.6847671085013
variable C5pos equal ${d5}
variable C5pos equal 0.0114847865466948
variable C6pos equal ${d6}
variable C6pos equal -7.90802570605433

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(193.540788963084+${C1pos})
variable C11 equal 0.5*(193.540788963084+-27.0447365095262)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(45.6373072773481+${C2pos})
variable C21 equal 0.5*(45.6373072773481+-53.2188128536188)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(85.287619940919+${C3pos})
variable C31 equal 0.5*(85.287619940919+-26.4311956830805)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(9.18499294826031+${C4pos})
variable C41 equal 0.5*(9.18499294826031+-8.6847671085013)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(10.6381419988149+${C5pos})
variable C51 equal 0.5*(10.6381419988149+0.0114847865466948)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-8.3105295404284+${C6pos})
variable C61 equal 0.5*(-8.3105295404284+-7.90802570605433)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.0868
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.0868
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.130868 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.130868 yz delta 0.020056 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.7087 12.955932 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.7087 12.955932 17.5248) with tilt (-8.2042 -0.1458 -1.985544)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.6 | 127.9 | 129 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.05611     -36457.317      23887.07       0              3566.6622    
       100   302.21612     -36496.647     -8338.2947     -3473.3314      3566.6622    
       200   283.97768     -36500.202      1962.1013      4439.1271      3566.6622    
       300   283.23125     -36499.352     -1288.9317     -4652.8742      3566.6622    
       400   295.09726     -36502.779      4934.6659      1195.6755      3566.6622    
       500   309.67459     -36498.364     -6139.6251     -4116.947       3566.6622    
       600   320.45608     -36499.469     -5050.5054     -5906.4366      3566.6622    
       700   328.5452      -36510.713     -1612.5419     -3654.2012      3566.6622    
       800   313.71342     -36520.13       2702.5836     -1473.4235      3566.6622    
       900   291.94859     -36528.144     -14146.065     -248.86649      3566.6622    
      1000   290.12705     -36528.681      10755.951      5012.6788      3566.6622    
      1100   313.78398     -36521.923     -6605.9709     -923.99664      3566.6622    
      1200   309.75641     -36498.977      6846.6429      6758.5949      3566.6622    
      1300   297.10462     -36488.572      5053.3385     -4113.5689      3566.6622    
      1400   318.58758     -36528.144     -2619.0755      569.20765      3566.6622    
      1500   304.07315     -36533.356     -2869.3316      9197.2484      3566.6622    
      1600   284.16248     -36513.15       4053.9218     -1155.7929      3566.6622    
      1700   306.25497     -36524.681      3135.8298      4726.1416      3566.6622    
      1800   300.94875     -36503.948      14401.084      4928.7753      3566.6622    
      1900   304.69449     -36499.164     -7414.033       204.11674      3566.6622    
      2000   310.79154     -36516.931     -2429.599      -4921.9397      3566.6622    
      2100   293.3735      -36533.291      4099.931       2085.5491      3566.6622    
      2200   287.78151     -36534.246     -14402.298      4341.2512      3566.6622    
      2300   288.57159     -36530.021     -1302.8849     -1103.2258      3566.6622    
      2400   321.36322     -36534.663     -9315.6546      2447.6116      3566.6622    
      2500   311.59475     -36511.299      6403.8266     -1287.0754      3566.6622    
      2600   298.82602     -36515.323      16994.391      5072.911       3566.6622    
      2700   304.65715     -36541.067      2624.4826      790.4165       3566.6622    
      2800   278.93807     -36513.845      148.02403     -574.64166      3566.6622    
      2900   307.14069     -36538.566     -2402.7982      2349.7168      3566.6622    
      3000   308.97062     -36532.696     -11013.47       307.49697      3566.6622    
Loop time of 149.726 on 8 procs for 3000 steps with 331 atoms

Performance: 0.866 ns/day, 27.727 hours/ns, 20.037 timesteps/s, 6.632 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 84.333     | 116.26     | 123.89     | 114.2 | 77.65
Bond    | 0.0084797  | 0.00929    | 0.010553   |   0.7 |  0.01
Neigh   | 7.0422     | 9.171      | 9.794      |  27.4 |  6.13
Comm    | 2.8263     | 10.487     | 42.429     | 380.6 |  7.00
Output  | 0.0072184  | 0.0089223  | 0.010411   |   1.3 |  0.01
Modify  | 13.069     | 13.716     | 15.837     |  22.5 |  9.16
Other   |            | 0.07817    |            |       |  0.05

Nlocal:         41.375 ave          48 max          36 min
Histogram: 2 0 2 0 0 1 1 0 0 2
Nghost:        3292.12 ave        3341 max        3252 min
Histogram: 1 1 1 2 0 1 0 0 0 2
Neighs:        26902.1 ave       30939 max       23606 min
Histogram: 2 0 2 0 1 0 1 0 0 2

Total # of neighbors = 215217
Ave neighs/atom = 650.20242
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 126.5 | 127.8 | 129.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   308.97062     -36532.696     -11013.474      0              3566.6622    
       100   303.91251     -36528.558     -4689.8625      4513.7464      3566.6622    
       200   301.5944      -36540.295      2084.7976      4354.6204      3566.6622    
       300   294.43354     -36560.16       2142.9606     -164.96886      3566.6622    
       400   290.97943     -36559.244     -3865.5807     -536.70618      3566.6622    
       500   297.10182     -36536.612      3868.5174      350.5899       3566.6622    
       600   300.30535     -36530.916     -4706.4852      1544.2734      3566.6622    
       700   289.87086     -36528.54      -10709.945      8986.5458      3566.6622    
       800   294.88177     -36549.071     -4368.5851     -3096.8246      3566.6622    
       900   294.26854     -36564.744      1581.7719      1224.1756      3566.6622    
      1000   270.18521     -36555.668      5295.1637      4112.7937      3566.6622    
      1100   295.83004     -36554.554      4894.3948      5722.1558      3566.6622    
      1200   287.5405      -36520.796     -4184.2176      940.72546      3566.6622    
      1300   319.14926     -36541.954      9634.1306     -2854.2594      3566.6622    
      1400   292.66973     -36536.06       4808.2778      5457.9838      3566.6622    
      1500   294.62495     -36552.579      5665.4531     -1444.543       3566.6622    
      1600   306.29706     -36565.677      2482.452       3052.6881      3566.6622    
      1700   289.7822      -36544.131      12322.66       918.00553      3566.6622    
      1800   299.58612     -36545.27      -10467.971      3129.5072      3566.6622    
      1900   306.30078     -36542.263     -10296.992     -126.84576      3566.6622    
      2000   288.41458     -36523.658      5618.9876      4019.9815      3566.6622    
      2100   284.60479     -36533.69       8910.9709      4262.2125      3566.6622    
      2200   284.8893      -36549.906     -2384.3265      1054.7587      3566.6622    
      2300   298.78093     -36561.973      7416.7172      2805.933       3566.6622    
      2400   300.66307     -36533.601      8686.7503      3369.0586      3566.6622    
      2500   314.72146     -36533.927     -12039.348     -5695.1315      3566.6622    
      2600   313.5383      -36539.269     -1564.302       43.705876      3566.6622    
      2700   291.53922     -36531.418     -2110.5935      2222.3074      3566.6622    
      2800   303.94618     -36550.839      685.23974      1471.804       3566.6622    
      2900   284.01873     -36570.163     -16596.458     -3509.4454      3566.6622    
      3000   288.7002      -36577.681      425.55984      3587.8511      3566.6622    
Loop time of 153.084 on 8 procs for 3000 steps with 331 atoms

Performance: 0.847 ns/day, 28.349 hours/ns, 19.597 timesteps/s, 6.487 katom-step/s
98.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 106.07     | 118.35     | 125.38     |  59.4 | 77.31
Bond    | 0.0082378  | 0.0093502  | 0.010581   |   0.7 |  0.01
Neigh   | 8.0209     | 9.2645     | 9.7288     |  16.1 |  6.05
Comm    | 3.4086     | 10.456     | 22.693     | 200.0 |  6.83
Output  | 0.0014288  | 0.0016632  | 0.0031067  |   1.3 |  0.00
Modify  | 14.514     | 14.93      | 16.221     |  13.0 |  9.75
Other   |            | 0.07576    |            |       |  0.05

Nlocal:         41.375 ave          47 max          34 min
Histogram: 1 0 0 2 1 0 1 0 2 1
Nghost:           3266 ave        3324 max        3219 min
Histogram: 2 0 1 1 1 0 1 1 0 1
Neighs:          26907 ave       30392 max       22250 min
Histogram: 1 0 0 1 2 0 1 0 2 1

Total # of neighbors = 215256
Ave neighs/atom = 650.32024
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 142.262992703423
variable C2neg equal ${d2}
variable C2neg equal 59.0501095390942
variable C3neg equal ${d3}
variable C3neg equal 95.2887812590399
variable C4neg equal ${d4}
variable C4neg equal 8.45324977158608
variable C5neg equal ${d5}
variable C5neg equal -1.95079255630097
variable C6neg equal ${d6}
variable C6neg equal -15.6455903938002

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.0868
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.130868 yz delta ${deltayz} remap units box
change_box all y delta 0 0.130868 yz delta -0.020056 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.7087 13.217668 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.7087 13.217668 17.5248) with tilt (-8.2042 -0.1458 -2.025656)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.5 | 125 | 126.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.05611     -36445.821     -55635.717      0              3638.716     
       100   301.3174      -36488.329     -14693.913     -6515.0982      3638.716     
       200   287.67297     -36504.028     -3282.2516     -1301.6291      3638.716     
       300   304.65583     -36521.148     -4236.9209     -1301.4073      3638.716     
       400   297.08078     -36507.985     -6925.6689     -1574.4566      3638.716     
       500   298.14873     -36512.847      2768.982      -2074.7778      3638.716     
       600   283.12689     -36497.127     -20185.729     -6053.4608      3638.716     
       700   312.58786     -36516.259     -5255.9427     -4780.3232      3638.716     
       800   306.54899     -36513.663     -5894.0504     -4403.6858      3638.716     
       900   300.84913     -36525.384     -10462.328     -5120.2394      3638.716     
      1000   289.86041     -36532.739      11228.498     -4462.6311      3638.716     
      1100   295.75752     -36528.872     -827.27446      3649.8275      3638.716     
      1200   310.58368     -36517.591     -5208.5412     -157.13465      3638.716     
      1300   294.0394      -36484.425      819.39631      3546.5208      3638.716     
      1400   304.3019      -36492.206     -6886.6        -1561.0607      3638.716     
      1500   300.54234     -36516.542     -497.1366      -1752.3217      3638.716     
      1600   295.98062     -36540.356      10144.519      1022.5917      3638.716     
      1700   291.45342     -36541.24      -11163.395      2631.2435      3638.716     
      1800   285.99441     -36528.587     -14013.562     -3474.744       3638.716     
      1900   309.62909     -36528.016      95.47228       2942.2138      3638.716     
      2000   301.85654     -36506.862     -12220.24      -4094.8901      3638.716     
      2100   308.50227     -36520.87      -2796.7156     -5720.7973      3638.716     
      2200   283.83638     -36540.138     -17568.878     -3621.9129      3638.716     
      2300   305.88059     -36561.032      10708.913     -3576.3727      3638.716     
      2400   317.61368     -36554.736      210.34566     -5305.3193      3638.716     
      2500   308.78426     -36527.891     -1933.6937     -3973.6916      3638.716     
      2600   321.20528     -36530.427     -6578.1626     -4689.4685      3638.716     
      2700   295.28385     -36528.266      2408.2874     -879.81213      3638.716     
      2800   279.72998     -36537.581     -9817.4673     -4521.1697      3638.716     
      2900   288.49448     -36532.025     -6766.4766     -3722.9428      3638.716     
      3000   285.40655     -36509.549     -3636.8958     -2690.4731      3638.716     
Loop time of 145.094 on 8 procs for 3000 steps with 331 atoms

Performance: 0.893 ns/day, 26.869 hours/ns, 20.676 timesteps/s, 6.844 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 83.262     | 110.21     | 121.42     | 114.2 | 75.96
Bond    | 0.0079451  | 0.009166   | 0.010451   |   0.8 |  0.01
Neigh   | 6.4695     | 8.7681     | 9.8327     |  33.1 |  6.04
Comm    | 1.3324     | 12.535     | 39.469     | 338.4 |  8.64
Output  | 0.0072217  | 0.0090249  | 0.010986   |   1.4 |  0.01
Modify  | 12.397     | 13.487     | 15.811     |  27.1 |  9.30
Other   |            | 0.0733     |            |       |  0.05

Nlocal:         41.375 ave          48 max          34 min
Histogram: 2 0 0 1 0 2 0 1 0 2
Nghost:        3233.25 ave        3274 max        3216 min
Histogram: 3 2 0 1 0 0 1 0 0 1
Neighs:        26359.2 ave       30384 max       21908 min
Histogram: 2 0 0 1 0 2 0 1 0 2

Total # of neighbors = 210874
Ave neighs/atom = 637.08157
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.6 | 125 | 126.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   285.40655     -36509.549     -3636.8471      0              3638.716     
       100   303.00597     -36518.563     -10639.884     -5146.7741      3638.716     
       200   302.66914     -36502.419     -5352.0109     -1002.8848      3638.716     
       300   320.38295     -36524.566      3705.8488     -573.59568      3638.716     
       400   277.38223     -36515.858     -2605.7379     -1298.4128      3638.716     
       500   286.28814     -36537.112     -5091.4591      272.56913      3638.716     
       600   286.83165     -36537.075      2327.2483      115.6386       3638.716     
       700   294.39398     -36513.258     -8833.1182     -908.85388      3638.716     
       800   307.55565     -36511.266     -6424.561      -4347.6548      3638.716     
       900   302.87328     -36510.203      11069.283     -29.651399      3638.716     
      1000   299.11868     -36518.491     -6281.3401     -1296.806       3638.716     
      1100   293.39339     -36525.021     -3916.0957      830.35028      3638.716     
      1200   292.88333     -36524.412      2864.8228      1507.4534      3638.716     
      1300   315.66922     -36525.99       2615.5813      1248.9925      3638.716     
      1400   298.52189     -36507.816      3102.7696     -2771.4078      3638.716     
      1500   293.0379      -36516.98      -6816.5874      903.50989      3638.716     
      1600   287.14918     -36527.944     -19339.572     -4902.6896      3638.716     
      1700   286.35315     -36532.206     -9926.1886     -5725.5244      3638.716     
      1800   314.13346     -36531.697     -4888.9622      100.41909      3638.716     
      1900   315.10259     -36510.023     -9385.9148     -2283.052       3638.716     
      2000   291.72398     -36495.182     -6181.5401     -126.01782      3638.716     
      2100   289.74731     -36516.175     -7333.5517     -960.71749      3638.716     
      2200   304.53891     -36534.763     -1665.0121      2577.2296      3638.716     
      2300   314.38633     -36542.406     -4025.278      -1176.1811      3638.716     
      2400   295.2284      -36529.944      1728.8079      2420.9503      3638.716     
      2500   295.46407     -36542.342     -5932.5308     -1831.3562      3638.716     
      2600   285.14667     -36554.441     -5416.0176     -895.23531      3638.716     
      2700   270.77696     -36538.736     -6689.881       1925.0446      3638.716     
      2800   306.18498     -36538.439      874.0422       412.05887      3638.716     
      2900   303.51017     -36529.15       4933.0704     -2278.8258      3638.716     
      3000   300.62542     -36534.342     -12270.466      2437.4186      3638.716     
Loop time of 144.592 on 8 procs for 3000 steps with 331 atoms

Performance: 0.896 ns/day, 26.776 hours/ns, 20.748 timesteps/s, 6.868 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 77.708     | 104.17     | 121.2      | 150.8 | 72.04
Bond    | 0.008032   | 0.0089898  | 0.0099852  |   0.7 |  0.01
Neigh   | 6.35       | 8.2928     | 9.7774     |  44.6 |  5.74
Comm    | 1.2454     | 18.267     | 44.715     | 360.0 | 12.63
Output  | 0.0012631  | 0.0014869  | 0.0025381  |   1.0 |  0.00
Modify  | 12.276     | 13.784     | 15.747     |  35.0 |  9.53
Other   |            | 0.07154    |            |       |  0.05

Nlocal:         41.375 ave          52 max          29 min
Histogram: 1 0 0 2 1 0 1 2 0 1
Nghost:        3200.88 ave        3234 max        3171 min
Histogram: 1 1 1 1 0 0 2 1 0 1
Neighs:        26336.8 ave       32681 max       18824 min
Histogram: 1 0 0 1 2 0 1 2 0 1

Total # of neighbors = 210694
Ave neighs/atom = 636.53776
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -130.606236106358
variable C2pos equal ${d2}
variable C2pos equal -98.4024292071034
variable C3pos equal ${d3}
variable C3pos equal -88.192595148374
variable C4pos equal ${d4}
variable C4pos equal -9.44696805844254
variable C5pos equal ${d5}
variable C5pos equal -9.74889556832052
variable C6pos equal ${d6}
variable C6pos equal 9.35703929325462

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(142.262992703423+${C1pos})
variable C12 equal 0.5*(142.262992703423+-130.606236106358)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(59.0501095390942+${C2pos})
variable C22 equal 0.5*(59.0501095390942+-98.4024292071034)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(95.2887812590399+${C3pos})
variable C32 equal 0.5*(95.2887812590399+-88.192595148374)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(8.45324977158608+${C4pos})
variable C42 equal 0.5*(8.45324977158608+-9.44696805844254)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(-1.95079255630097+${C5pos})
variable C52 equal 0.5*(-1.95079255630097+-9.74889556832052)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(-15.6455903938002+${C6pos})
variable C62 equal 0.5*(-15.6455903938002+9.35703929325462)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.5248
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.5248
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.175248 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.7087 13.0868 17.349552) with tilt (-8.2042 -0.1458 -2.0056)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.5 | 127.5 | 128.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.05611     -36463.85       23582.972      0              3566.6622    
       100   305.48104     -36505.521     -7317.224      -3475.1137      3566.6622    
       200   294.28717     -36516.316      6857.872       3739.7679      3566.6622    
       300   298.39241     -36517.47       2792.7805     -2598.5529      3566.6622    
       400   292.55851     -36499.386      4265.9664     -2546.3442      3566.6622    
       500   287.773       -36479.159     -11260.542     -3392.17        3566.6622    
       600   317.49853     -36498.057      6506.1766     -2284.5906      3566.6622    
       700   338.57095     -36528.256     -12395.866     -7431.5525      3566.6622    
       800   298.77697     -36516.781      2150.2522      2126.912       3566.6622    
       900   296.53064     -36538.672      2448.1424      3138.8428      3566.6622    
      1000   283.08882     -36536.858     -2231.4426     -3821.9968      3566.6622    
      1100   300.13337     -36541.961     -3559.5127     -27.811045      3566.6622    
      1200   302.26795     -36515.04       7494.7999      2148.5046      3566.6622    
      1300   302.4406      -36488.297      4860.2967     -1970.0873      3566.6622    
      1400   321.61542     -36511.91       6246.7883     -268.21269      3566.6622    
      1500   296.67507     -36524.071      1180.233      -1482.5393      3566.6622    
      1600   281.69993     -36527.227      4557.1399     -1427.4698      3566.6622    
      1700   292.59711     -36535.33      -418.78735      12.996602      3566.6622    
      1800   303.43201     -36533.642     -2748.0326      3547.6457      3566.6622    
      1900   301.87237     -36518.832      5887.0736      1172.9417      3566.6622    
      2000   316.10328     -36519.246     -2549.3386      8371.8295      3566.6622    
      2100   315.08021     -36516.908     -1673.6232      2644.8828      3566.6622    
      2200   289.99021     -36525.158      1227.8624     -5071.1609      3566.6622    
      2300   289.74385     -36537.718      7812.1462      1831.1662      3566.6622    
      2400   292.56675     -36540.321     -2498.9589     -4739.2799      3566.6622    
      2500   315.66852     -36545.185     -4440.119      -1685.9925      3566.6622    
      2600   304.52799     -36507.455     -5757.5884     -1505.5799      3566.6622    
      2700   313.70224     -36512.366     -3703.548      -300.29927      3566.6622    
      2800   284.46032     -36524.221     -8062.6712      2065.6556      3566.6622    
      2900   281.77679     -36536.271     -12689.596      1346.3477      3566.6622    
      3000   316.43498     -36577.598      6234.7776     -5400.7339      3566.6622    
Loop time of 148.856 on 8 procs for 3000 steps with 331 atoms

Performance: 0.871 ns/day, 27.566 hours/ns, 20.154 timesteps/s, 6.671 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 80.208     | 106.35     | 125.08     | 165.7 | 71.45
Bond    | 0.0081573  | 0.0091003  | 0.010382   |   0.7 |  0.01
Neigh   | 6.5281     | 8.3526     | 9.9038     |  46.9 |  5.61
Comm    | 1.2981     | 20.02      | 46.16      | 381.8 | 13.45
Output  | 0.0062318  | 0.008      | 0.0094727  |   1.3 |  0.01
Modify  | 12.465     | 14.04      | 15.882     |  36.5 |  9.43
Other   |            | 0.07291    |            |       |  0.05

Nlocal:         41.375 ave          50 max          36 min
Histogram: 2 1 1 0 0 2 0 1 0 1
Nghost:           3283 ave        3327 max        3247 min
Histogram: 1 2 1 1 0 0 0 1 0 2
Neighs:        26892.2 ave       32245 max       23580 min
Histogram: 2 1 1 0 1 1 0 1 0 1

Total # of neighbors = 215138
Ave neighs/atom = 649.96375
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.6 | 127.4 | 128.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   316.43498     -36577.598      6234.777       0              3566.6622    
       100   275.4959      -36533.857     -13931.622      196.81289      3566.6622    
       200   312.46642     -36542.201     -17040.945     -1113.216       3566.6622    
       300   303.62794     -36512.94      -5576.7093      2252.6796      3566.6622    
       400   297.98224     -36518.617     -1907.8412     -1928.1051      3566.6622    
       500   295.97421     -36537.383      4861.7616     -970.60346      3566.6622    
       600   292.51127     -36540.874     -5125.4934     -2413.3914      3566.6622    
       700   299.77115     -36545.733     -2050.1212     -2713.5506      3566.6622    
       800   309.48166     -36549.534      466.64295     -3270.1351      3566.6622    
       900   322.75271     -36536.283      1102.0849     -901.64445      3566.6622    
      1000   321.36667     -36526.269     -1390.8426     -5288.7221      3566.6622    
      1100   276.10289     -36520.103     -610.58258      5709.5843      3566.6622    
      1200   291.33309     -36545.613     -5516.5982      1670.7458      3566.6622    
      1300   297.59111     -36551.657     -5379.7051      5844.527       3566.6622    
      1400   314.91099     -36549.049     -237.79813     -226.64966      3566.6622    
      1500   299.31385     -36516.46      -1458.677      -688.81143      3566.6622    
      1600   300.96915     -36514.449     -56.732277     -1522.9594      3566.6622    
      1700   291.32514     -36540.608     -9192.4814     -717.40248      3566.6622    
      1800   294.47643     -36558.668      8377.444      -1364.1865      3566.6622    
      1900   270.19998     -36539.146      2775.4778     -1169.6206      3566.6622    
      2000   308.53564     -36558.076     -6750.6459     -2498.2545      3566.6622    
      2100   310.03158     -36534.948     -5406.8602     -2162.6482      3566.6622    
      2200   310.51778     -36527.589      1173.6691      821.03603      3566.6622    
      2300   288.92428     -36525.748     -3565.3042     -7542.5728      3566.6622    
      2400   285.77109     -36561.766      7660.4547     -2858.4531      3566.6622    
      2500   305.56136     -36573.227      5808.8127      1480.8261      3566.6622    
      2600   304.07981     -36554.983     -12662.767     -3094.7207      3566.6622    
      2700   312.35505     -36544.933      7313.9471     -7696.2658      3566.6622    
      2800   294.1672      -36532.693     -16087.753      2233.4299      3566.6622    
      2900   278.01672     -36547.338     -10710.094     -5201.6591      3566.6622    
      3000   294.05368     -36580.591      5711.2175     -3542.6996      3566.6622    
Loop time of 149.479 on 8 procs for 3000 steps with 331 atoms

Performance: 0.867 ns/day, 27.681 hours/ns, 20.070 timesteps/s, 6.643 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 87.292     | 109.8      | 125.83     | 134.9 | 73.45
Bond    | 0.0081901  | 0.0091594  | 0.010424   |   0.8 |  0.01
Neigh   | 6.6916     | 8.6019     | 9.8985     |  39.9 |  5.75
Comm    | 1.1108     | 17.135     | 39.614     | 341.2 | 11.46
Output  | 0.0012534  | 0.0015214  | 0.0025778  |   1.0 |  0.00
Modify  | 12.539     | 13.859     | 15.803     |  31.8 |  9.27
Other   |            | 0.07403    |            |       |  0.05

Nlocal:         41.375 ave          51 max          36 min
Histogram: 2 1 2 0 0 1 1 0 0 1
Nghost:        3297.75 ave        3341 max        3250 min
Histogram: 1 1 0 1 2 0 0 0 1 2
Neighs:        26898.9 ave       32815 max       23611 min
Histogram: 2 1 2 0 0 1 1 0 0 1

Total # of neighbors = 215191
Ave neighs/atom = 650.12387
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 70.0126883869185
variable C2neg equal ${d2}
variable C2neg equal 43.3340436493794
variable C3neg equal ${d3}
variable C3neg equal 71.866185971594
variable C4neg equal ${d4}
variable C4neg equal 3.23418003561802
variable C5neg equal ${d5}
variable C5neg equal 12.7101342923001
variable C6neg equal ${d6}
variable C6neg equal -8.53032645802689

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.5248
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.175248 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.7087 13.0868 17.700048) with tilt (-8.2042 -0.1458 -2.0056)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.7 | 125.2 | 126.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.05611     -36441.622     -53915.476      0              3638.716     
       100   306.70208     -36489.478     -15769.728     -7100.7052      3638.716     
       200   291.13777     -36503.199     -5392.8675      221.09417      3638.716     
       300   292.10422     -36507.637     -7217.5068     -3924.5575      3638.716     
       400   295.64589     -36498.573     -6746.1385      3688.8577      3638.716     
       500   300.28207     -36494.313     -11489.964     -3288.7749      3638.716     
       600   291.98184     -36483.443     -15700.128     -3808.5198      3638.716     
       700   294.85906     -36480.358     -8386.1032      1557.3131      3638.716     
       800   297.29558     -36475.261     -1504.3797     -1469.1263      3638.716     
       900   313.35913     -36503.192      22807.786     -1891.3424      3638.716     
      1000   283.39029     -36506.253     -8318.2555     -609.57832      3638.716     
      1100   266.41855     -36513.264      1609.517       1258.6906      3638.716     
      1200   274.79849     -36510.416     -6846.1644     -3004.8583      3638.716     
      1300   291.55776     -36496.027     -4521.2991     -2736.1529      3638.716     
      1400   306.45792     -36500.431     -442.23731     -6080.272       3638.716     
      1500   301.80924     -36504.865     -5123.625      -1357.7444      3638.716     
      1600   297.66236     -36514.154      3674.9429      638.93086      3638.716     
      1700   305.09731     -36530.516      346.62955     -4178.4832      3638.716     
      1800   298.707       -36526.286      3709.667       895.55511      3638.716     
      1900   286.21095     -36496.684     -2092.0233     -2305.2168      3638.716     
      2000   301.33899     -36487.127     -4853.553      -6010.7666      3638.716     
      2100   321.80078     -36515.958      1633.9965     -378.15163      3638.716     
      2200   302.5059      -36524.142     -2633.5683     -4048.0069      3638.716     
      2300   280.46167     -36511.257      3756.353      -2924.5239      3638.716     
      2400   292.86786     -36513.676     -18767.697     -3672.5364      3638.716     
      2500   324.47529     -36521.951      5213.4701      339.14906      3638.716     
      2600   314.48845     -36511.509     -3670.4265     -5181.9888      3638.716     
      2700   288.7622      -36526.521     -11487.014     -1059.4189      3638.716     
      2800   303.0972      -36542.698     -4049.5474     -11049.509      3638.716     
      2900   298.73705     -36525.984     -4956.4802     -10735.74       3638.716     
      3000   319.83698     -36523.988     -5370.9322     -8479.108       3638.716     
Loop time of 142.555 on 8 procs for 3000 steps with 331 atoms

Performance: 0.909 ns/day, 26.399 hours/ns, 21.044 timesteps/s, 6.966 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 83.949     | 98.783     | 119.47     | 137.9 | 69.29
Bond    | 0.0081938  | 0.0090251  | 0.0098406  |   0.5 |  0.01
Neigh   | 6.4908     | 7.8395     | 9.0643     |  38.2 |  5.50
Comm    | 1.4713     | 22.194     | 37.03      | 290.8 | 15.57
Output  | 0.0069778  | 0.0089168  | 0.01045    |   1.3 |  0.01
Modify  | 12.453     | 13.652     | 15.027     |  29.2 |  9.58
Other   |            | 0.06847    |            |       |  0.05

Nlocal:         41.375 ave          48 max          33 min
Histogram: 1 0 1 1 1 0 0 1 2 1
Nghost:        3227.25 ave        3254 max        3202 min
Histogram: 2 1 0 1 0 0 1 1 0 2
Neighs:        26345.4 ave       30372 max       21243 min
Histogram: 1 0 1 1 1 0 0 1 2 1

Total # of neighbors = 210763
Ave neighs/atom = 636.74622
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.7 | 125.2 | 126.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   319.83698     -36523.988     -5370.941       0              3638.716     
       100   296.58367     -36514.556     -10873.817     -6863.8616      3638.716     
       200   300.61156     -36546.156     -9416.1514     -7735.413       3638.716     
       300   292.31403     -36542.875     -6356.0036     -3163.1484      3638.716     
       400   294.31655     -36539.829     -19124.92      -5089.4755      3638.716     
       500   308.39076     -36544.279     -11556.78      -10321.073      3638.716     
       600   311.76583     -36537.935     -13757.462     -9160.7191      3638.716     
       700   300.48606     -36540.434     -263.28505     -956.17213      3638.716     
       800   269.59829     -36530.524     -16543.609     -2478.8561      3638.716     
       900   281.43863     -36531.192     -7632.5837     -3991.6777      3638.716     
      1000   313.17494     -36535.787     -3447.5948     -1863.3911      3638.716     
      1100   316.43514     -36535.755     -7504.9901     -7425.7102      3638.716     
      1200   303.86442     -36530.851     -14360.666     -3526.2792      3638.716     
      1300   291.40882     -36530.892     -5678.549      -10867.94       3638.716     
      1400   290.96979     -36529.076     -2880.2629     -9292.2402      3638.716     
      1500   323.72532     -36523.864     -2891.1371     -10539.993      3638.716     
      1600   322.35326     -36505.664     -8105.0304     -3360.9532      3638.716     
      1700   304.59343     -36519.799     -9820.0987     -9354.5965      3638.716     
      1800   306.36672     -36543.909      3730.0316     -3642.8583      3638.716     
      1900   287.39831     -36541.934     -3378.3983     -2908.1481      3638.716     
      2000   295.46146     -36548.208     -786.10283     -2694.0281      3638.716     
      2100   312.21562     -36534.825      4174.2389     -1445.4324      3638.716     
      2200   303.4304      -36511.032     -10946.574     -6679.2946      3638.716     
      2300   306.83943     -36520.343     -12241.887     -9188.3618      3638.716     
      2400   320.2386      -36546.07      -7407.2513     -5729.788       3638.716     
      2500   314.35814     -36554.068      2040.2605     -9262.1152      3638.716     
      2600   307.15822     -36557.388     -11509.864     -5415.4797      3638.716     
      2700   319.55127     -36574.799     -6675.068      -4708.2149      3638.716     
      2800   298.75704     -36558.082     -9590.4005     -1854.1094      3638.716     
      2900   301.29493     -36559.26       1825.2063     -10305.268      3638.716     
      3000   307.86348     -36566.387     -12941.279     -7096.9125      3638.716     
Loop time of 143.132 on 8 procs for 3000 steps with 331 atoms

Performance: 0.905 ns/day, 26.506 hours/ns, 20.960 timesteps/s, 6.938 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 76.618     | 102.02     | 120.47     | 159.4 | 71.28
Bond    | 0.0083424  | 0.0091404  | 0.010014   |   0.6 |  0.01
Neigh   | 6.4432     | 8.039      | 9.0799     |  42.7 |  5.62
Comm    | 0.92013    | 19.393     | 44.824     | 365.7 | 13.55
Output  | 0.0013164  | 0.0015589  | 0.0026829  |   1.1 |  0.00
Modify  | 12.567     | 13.601     | 15.174     |  32.9 |  9.50
Other   |            | 0.0685     |            |       |  0.05

Nlocal:         41.375 ave          50 max          29 min
Histogram: 1 0 0 0 2 2 0 0 2 1
Nghost:        3214.38 ave        3257 max        3186 min
Histogram: 2 1 1 1 0 0 1 1 0 1
Neighs:        26342.8 ave       31569 max       18817 min
Histogram: 1 0 0 0 2 2 0 0 2 1

Total # of neighbors = 210742
Ave neighs/atom = 636.68278
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -33.9996262203538
variable C2pos equal ${d2}
variable C2pos equal -47.8519851468781
variable C3pos equal ${d3}
variable C3pos equal -26.4875720216144
variable C4pos equal ${d4}
variable C4pos equal -24.3790144878098
variable C5pos equal ${d5}
variable C5pos equal -4.90327114436797
variable C6pos equal ${d6}
variable C6pos equal 9.06985172496028

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(70.0126883869185+${C1pos})
variable C13 equal 0.5*(70.0126883869185+-33.9996262203538)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(43.3340436493794+${C2pos})
variable C23 equal 0.5*(43.3340436493794+-47.8519851468781)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(71.866185971594+${C3pos})
variable C33 equal 0.5*(71.866185971594+-26.4875720216144)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(3.23418003561802+${C4pos})
variable C43 equal 0.5*(3.23418003561802+-24.3790144878098)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(12.7101342923001+${C5pos})
variable C53 equal 0.5*(12.7101342923001+-4.90327114436797)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-8.53032645802689+${C6pos})
variable C63 equal 0.5*(-8.53032645802689+9.06985172496028)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.5248
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.5248
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.175248 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.180848)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124.7 | 126.4 | 128.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.05611     -36465.721     -17037.468      0              3602.6891    
       100   298.32945     -36497.993     -8222.5023     -3936.0935      3602.6891    
       200   291.12465     -36507.546     -984.65137      519.55609      3602.6891    
       300   292.26378     -36504.167      606.92611     -4095.8675      3602.6891    
       400   287.28902     -36488.196     -6444.6624     -1722.4406      3602.6891    
       500   307.60323     -36494.972     -6498.4096     -743.28905      3602.6891    
       600   293.69175     -36471.805     -6244.2927     -6226.1859      3602.6891    
       700   315.50194     -36492.807     -1137.5716     -3156.2711      3602.6891    
       800   311.21093     -36509.971      1986.4354     -89.41806       3602.6891    
       900   296.32279     -36525.571      4668.2739     -4183.6955      3602.6891    
      1000   284.29329     -36527.816      8298.0895     -1605.6461      3602.6891    
      1100   296.86023     -36521.7        447.66634     -2312.2019      3602.6891    
      1200   293.22512     -36485.331     -308.60551     -2534.989       3602.6891    
      1300   311.59912     -36488.683      261.52784     -635.02381      3602.6891    
      1400   303.83812     -36478.622      10272.923     -480.72998      3602.6891    
      1500   317.1035      -36505.859      4176.8295     -4149.3253      3602.6891    
      1600   277.90726     -36496.308      7188.7774     -4243.2862      3602.6891    
      1700   305.78939     -36535.899     -8312.4946     -4797.4985      3602.6891    
      1800   317.80435     -36556.079      3380.7873     -3890.5502      3602.6891    
      1900   287.06723     -36525.011      9419.481       2425.9359      3602.6891    
      2000   319.21123     -36529.235      995.2245      -1745.641       3602.6891    
      2100   313.14785     -36503.839      9974.3685     -3529.8039      3602.6891    
      2200   300.35478     -36497.041      6098.3422     -2064.7424      3602.6891    
      2300   296.06634     -36530.6        5789.8291      1216.1272      3602.6891    
      2400   295.06642     -36547.004      7821.7105      364.53127      3602.6891    
      2500   289.32646     -36537.697      8402.1264      1148.9677      3602.6891    
      2600   307.19215     -36552.035     -358.86009      7318.1705      3602.6891    
      2700   299.29362     -36556.054     -4081.6729     -3023.774       3602.6891    
      2800   287.64169     -36555.334     -7935.0409      3208.0921      3602.6891    
      2900   322.21089     -36574.504     -5354.6907     -4139.4951      3602.6891    
      3000   320.57754     -36546.741     -2724.1259     -1536.4067      3602.6891    
Loop time of 145.928 on 8 procs for 3000 steps with 331 atoms

Performance: 0.888 ns/day, 27.024 hours/ns, 20.558 timesteps/s, 6.805 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 97.374     | 108.88     | 122.13     |  78.5 | 74.62
Bond    | 0.0083388  | 0.0092536  | 0.010185   |   0.6 |  0.01
Neigh   | 7.7756     | 8.5471     | 9.2162     |  20.7 |  5.86
Comm    | 1.6824     | 14.941     | 26.472     | 211.9 | 10.24
Output  | 0.0063889  | 0.0083577  | 0.0099907  |   1.4 |  0.01
Modify  | 12.8       | 13.468     | 14.251     |  16.6 |  9.23
Other   |            | 0.06925    |            |       |  0.05

Nlocal:         41.375 ave          51 max          33 min
Histogram: 1 0 2 0 2 0 1 1 0 1
Nghost:         3253.5 ave        3282 max        3210 min
Histogram: 1 0 0 2 0 1 0 1 0 3
Neighs:        26656.8 ave       32573 max       21562 min
Histogram: 1 0 2 0 2 1 0 1 0 1

Total # of neighbors = 213254
Ave neighs/atom = 644.2719
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124.8 | 126.3 | 127.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   320.57754     -36546.741     -2724.1019      0              3602.6891    
       100   299.55157     -36539.672     -3553.832      -2168.451       3602.6891    
       200   286.49992     -36554.454     -2292.208      -2238.1172      3602.6891    
       300   294.52506     -36567.195     -4934.3308      871.73149      3602.6891    
       400   278.70024     -36543.844     -11350.952     -8182.4167      3602.6891    
       500   286.63977     -36538.909     -5763.9853     -6132.0372      3602.6891    
       600   300.79171     -36540.481     -5582.0313     -4102.7248      3602.6891    
       700   312.61752     -36538.626     -3625.3477     -1301.0345      3602.6891    
       800   296.54207     -36504.607     -10195.449     -2233.8285      3602.6891    
       900   319.7087      -36522.817     -14478.55      -4489.7633      3602.6891    
      1000   299.86642     -36538.395      6494.6767     -114.09899      3602.6891    
      1100   306.74502     -36559          5748.3876     -718.42242      3602.6891    
      1200   314.55759     -36563.356     -2001.991      -1210.2759      3602.6891    
      1300   297.18328     -36545.241     -2546.5093     -3805.4261      3602.6891    
      1400   297.75408     -36547.251      3486.7642     -2577.2472      3602.6891    
      1500   328.13935     -36570.365     -8210.328      -726.01309      3602.6891    
      1600   295.07652     -36548.774     -11342.851     -6794.2758      3602.6891    
      1700   299.31719     -36572.739     -1503.0911      1495.3912      3602.6891    
      1800   293.36459     -36575.423      7183.2586      1723.1447      3602.6891    
      1900   287.30732     -36557.943     -11937.966     -7654.4551      3602.6891    
      2000   316.09637     -36550.918     -9245.3136     -1897.6732      3602.6891    
      2100   327.15184     -36556.426     -14634.67      -1607.4875      3602.6891    
      2200   324.55136     -36577.327      4451.1718      445.29984      3602.6891    
      2300   297.66415     -36573.641     -5337.7111     -4196.9199      3602.6891    
      2400   276.56052     -36554.426     -3079.8238     -3441.889       3602.6891    
      2500   319.04265     -36580.82      -6340.824      -9638.5938      3602.6891    
      2600   313.42416     -36551.084     -7806.0775     -7343.2302      3602.6891    
      2700   310.49751     -36545.165      5316.0149      1663.3879      3602.6891    
      2800   293.70644     -36571.196     -7341.7589     -7901.616       3602.6891    
      2900   283.61838     -36579.092     -5426.5143     -6391.3272      3602.6891    
      3000   293.9854      -36569.832     -12089.407     -10808.777      3602.6891    
Loop time of 149.562 on 8 procs for 3000 steps with 331 atoms

Performance: 0.867 ns/day, 27.697 hours/ns, 20.059 timesteps/s, 6.639 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 79.904     | 114.07     | 125.45     | 125.6 | 76.27
Bond    | 0.0082384  | 0.0092936  | 0.010483   |   0.7 |  0.01
Neigh   | 6.5958     | 8.8649     | 9.4473     |  29.4 |  5.93
Comm    | 1.1596     | 12.548     | 46.72      | 378.8 |  8.39
Output  | 0.001274   | 0.001486   | 0.0025428  |   1.0 |  0.00
Modify  | 13.414     | 14         | 16.27      |  23.4 |  9.36
Other   |            | 0.06878    |            |       |  0.05

Nlocal:         41.375 ave          51 max          36 min
Histogram: 3 0 1 0 2 0 1 0 0 1
Nghost:           3263 ave        3318 max        3209 min
Histogram: 2 0 0 0 1 2 1 0 1 1
Neighs:        26628.9 ave       32575 max       23295 min
Histogram: 3 0 1 0 2 1 0 0 0 1

Total # of neighbors = 213031
Ave neighs/atom = 643.59819
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -3.61083755185643
variable C2neg equal ${d2}
variable C2neg equal 48.3658642914692
variable C3neg equal ${d3}
variable C3neg equal 40.717398907058
variable C4neg equal ${d4}
variable C4neg equal 23.1981780328411
variable C5neg equal ${d5}
variable C5neg equal 4.143170669168
variable C6neg equal ${d6}
variable C6neg equal -2.78508441294676

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.5248
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.175248 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -1.830352)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124.6 | 126.3 | 128.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.05611     -36462.055     -15898.405      0              3602.6891    
       100   301.62414     -36498.934     -16711.942     -5087.3322      3602.6891    
       200   285.89025     -36504.858     -3151.066       1154.3303      3602.6891    
       300   301.61284     -36517.434     -3312.3446     -1548.9131      3602.6891    
       400   283.77068     -36488.052     -4513.5553     -752.92828      3602.6891    
       500   313.99072     -36502.336      3396.3859     -798.215        3602.6891    
       600   310.78533     -36498.538     -4720.3723      1226.3128      3602.6891    
       700   303.27994     -36499.948      1042.7149      1087.4872      3602.6891    
       800   292.06418     -36506.275     -8324.668       75.138429      3602.6891    
       900   296.64909     -36518.468      3107.3516      700.18819      3602.6891    
      1000   304.3968      -36520.443      1226.1396      1099.3004      3602.6891    
      1100   316.26986     -36516.347     -6204.631       2918.8897      3602.6891    
      1200   317.89432     -36515.267     -9173.1364     -1797.3481      3602.6891    
      1300   308.16014     -36522.276     -7651.9809      1100.2826      3602.6891    
      1400   302.97466     -36537.457     -1920.6536     -6476.3356      3602.6891    
      1500   281.40702     -36525.438      5627.534       3718.3524      3602.6891    
      1600   302.44365     -36538.645     -7634.4514     -4820.2094      3602.6891    
      1700   304.79429     -36524.654      4101.3243      2336.075       3602.6891    
      1800   311.31673     -36514.86      -17054.227     -2133.4084      3602.6891    
      1900   330.00724     -36521.155      1472.7175     -1166.1265      3602.6891    
      2000   285.91292     -36502.309      3085.3065      3963.5094      3602.6891    
      2100   294.10644     -36531.258      2558.9912      3880.7099      3602.6891    
      2200   286.97658     -36520.963     -15837.286     -4182.0252      3602.6891    
      2300   271.5244      -36506.188     -4626.1129      598.13693      3602.6891    
      2400   318.77468     -36526.092     -14688.588     -6375.2854      3602.6891    
      2500   318.01695     -36507.769      5610.6856      883.29509      3602.6891    
      2600   293.83738     -36499.441      7551.5562      955.26259      3602.6891    
      2700   271.32096     -36498.764      637.93698     -1315.8678      3602.6891    
      2800   290.74537     -36526.207      6673.6995     -611.5427       3602.6891    
      2900   281.41093     -36515.652     -5515.8954     -713.04974      3602.6891    
      3000   290.71482     -36476.131     -5709.3535     -2159.7608      3602.6891    
Loop time of 146.991 on 8 procs for 3000 steps with 331 atoms

Performance: 0.882 ns/day, 27.221 hours/ns, 20.409 timesteps/s, 6.756 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 96.479     | 113.16     | 122.22     |  82.9 | 76.99
Bond    | 0.0079647  | 0.0093565  | 0.010392   |   0.8 |  0.01
Neigh   | 7.7822     | 8.7475     | 9.2413     |  15.5 |  5.95
Comm    | 2.4814     | 11.54      | 28.232     | 259.7 |  7.85
Output  | 0.0067073  | 0.0083522  | 0.0098314  |   1.3 |  0.01
Modify  | 12.973     | 13.455     | 14.419     |  12.5 |  9.15
Other   |            | 0.0697     |            |       |  0.05

Nlocal:         41.375 ave          47 max          32 min
Histogram: 1 0 1 1 0 0 0 1 1 3
Nghost:        3259.25 ave        3296 max        3226 min
Histogram: 1 0 2 0 2 1 0 0 1 1
Neighs:        26630.9 ave       30059 max       20866 min
Histogram: 1 0 1 1 0 0 0 2 0 3

Total # of neighbors = 213047
Ave neighs/atom = 643.64653
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124.7 | 126.3 | 127.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.71482     -36476.131     -5709.3099      0              3602.6891    
       100   298.89551     -36495.313     -5599.883      -2207.0572      3602.6891    
       200   282.51934     -36505.743     -4977.8556     -2212.1286      3602.6891    
       300   293.44636     -36532.157      1621.3075     -8840.0201      3602.6891    
       400   276.33091     -36520.958      768.28238      345.24166      3602.6891    
       500   300.57676     -36523.048     -2498.416      -3897.6429      3602.6891    
       600   326.50155     -36524.121      1558.5884     -3288.4627      3602.6891    
       700   310.46307     -36514.352      2053.8819     -1048.3847      3602.6891    
       800   305.47984     -36535.032     -7731.6427     -2535.0942      3602.6891    
       900   281.96413     -36527.969     -3658.1801     -8465.4361      3602.6891    
      1000   284.4972      -36531.634     -11394.26      -3939.2316      3602.6891    
      1100   302.40341     -36527.481     -4652.0677     -4052.152       3602.6891    
      1200   304.95451     -36501.755     -2261.1098     -5804.5216      3602.6891    
      1300   300.45708     -36513.394     -3171.4018      1745.4049      3602.6891    
      1400   301.02397     -36533.283     -728.48109      1141.9636      3602.6891    
      1500   299.40801     -36543.169     -10341.112     -6585.661       3602.6891    
      1600   306.79069     -36546.207      3880.1565     -3947.5998      3602.6891    
      1700   298.05917     -36524.892      2713.0057     -998.32789      3602.6891    
      1800   292.85607     -36509.112     -13299.304     -5404.4302      3602.6891    
      1900   300.43149     -36522.67       2638.7594     -1973.1196      3602.6891    
      2000   290.04635     -36535.805      6424.8185      317.69336      3602.6891    
      2100   283.25298     -36539.476     -4301.976       246.49898      3602.6891    
      2200   290.6682      -36534.145     -10919.262     -1355.3245      3602.6891    
      2300   303.25919     -36521.933      167.92363      932.09987      3602.6891    
      2400   308.38402     -36519.704     -11521.782     -6108.3549      3602.6891    
      2500   305.99306     -36532.494     -18633.211     -4013.7979      3602.6891    
      2600   293.19422     -36547.772      4775.2331     -3976.7872      3602.6891    
      2700   271.08168     -36524.303     -3082.331      -1372.8736      3602.6891    
      2800   302.00247     -36537.925     -2875.605      -3298.9656      3602.6891    
      2900   325.49967     -36547.103      7787.0594     -2018.8538      3602.6891    
      3000   303.43145     -36536.83       6163.996      -1639.165       3602.6891    
Loop time of 146.721 on 8 procs for 3000 steps with 331 atoms

Performance: 0.883 ns/day, 27.171 hours/ns, 20.447 timesteps/s, 6.768 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 83.229     | 110.15     | 122.87     | 143.9 | 75.07
Bond    | 0.0077917  | 0.0093403  | 0.010541   |   0.8 |  0.01
Neigh   | 6.6026     | 8.4705     | 9.298      |  35.6 |  5.77
Comm    | 1.9092     | 14.626     | 41.54      | 394.8 |  9.97
Output  | 0.0012571  | 0.0015779  | 0.0033323  |   1.7 |  0.00
Modify  | 12.565     | 13.394     | 15.273     |  28.5 |  9.13
Other   |            | 0.06877    |            |       |  0.05

Nlocal:         41.375 ave          48 max          28 min
Histogram: 1 0 0 0 2 0 1 0 0 4
Nghost:        3243.88 ave        3288 max        3203 min
Histogram: 2 1 1 0 0 0 1 0 1 2
Neighs:        26643.8 ave       30617 max       18405 min
Histogram: 1 0 0 0 2 0 1 0 1 3

Total # of neighbors = 213150
Ave neighs/atom = 643.9577
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -89.3002528287476
variable C2pos equal ${d2}
variable C2pos equal -98.6872143206429
variable C3pos equal ${d3}
variable C3pos equal -74.5037543259022
variable C4pos equal ${d4}
variable C4pos equal -15.8622603097375
variable C5pos equal ${d5}
variable C5pos equal 9.56667343453788
variable C6pos equal ${d6}
variable C6pos equal 7.17951072311735

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-3.61083755185643+${C1pos})
variable C14 equal 0.5*(-3.61083755185643+-89.3002528287476)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(48.3658642914692+${C2pos})
variable C24 equal 0.5*(48.3658642914692+-98.6872143206429)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(40.717398907058+${C3pos})
variable C34 equal 0.5*(40.717398907058+-74.5037543259022)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(23.1981780328411+${C4pos})
variable C44 equal 0.5*(23.1981780328411+-15.8622603097375)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(4.143170669168+${C5pos})
variable C54 equal 0.5*(4.143170669168+9.56667343453788)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-2.78508441294676+${C6pos})
variable C64 equal 0.5*(-2.78508441294676+7.17951072311735)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.5248
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.5248
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.175248 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.321048 -2.0056)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124.7 | 126.4 | 128.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.05611     -36465.825     -16570.016      0              3602.6891    
       100   300.73966     -36498.341     -20086.166     -5213.4727      3602.6891    
       200   279.49017     -36492.78      -1443.0739      902.64329      3602.6891    
       300   294.51237     -36503.742     -5544.667      -3092.7483      3602.6891    
       400   296.28609     -36494.537      4298.8892     -3500.3196      3602.6891    
       500   310.67775     -36501.363     -8187.4957     -2525.8836      3602.6891    
       600   292.53435     -36477.296     -6152.071      -2167.7123      3602.6891    
       700   315.06932     -36493.634      5351.1668      2680.5332      3602.6891    
       800   297.93563     -36487.709      1917.644      -3421.2088      3602.6891    
       900   310.90631     -36520.077      6168.1612      393.83632      3602.6891    
      1000   284.91811     -36500.72      -1945.7397      1157.3257      3602.6891    
      1100   281.29471     -36491.131     -6425.664      -2615.5967      3602.6891    
      1200   323.09696     -36515.67      -979.49743      2149.0619      3602.6891    
      1300   304.1424      -36501.47      -5360.8332     -4081.8679      3602.6891    
      1400   319.58388     -36537.02      -7875.2838     -5406.5359      3602.6891    
      1500   311.3813      -36556.795     -5125.5103     -11713.236      3602.6891    
      1600   296.41354     -36547.464      2889.8814     -10517.3        3602.6891    
      1700   284.85656     -36519.223      1288.0692     -1377.4353      3602.6891    
      1800   296.2811      -36504.637     -6261.2017     -1664.9217      3602.6891    
      1900   325.7785      -36524.045     -5780.9675     -9422.7315      3602.6891    
      2000   290.2378      -36506.445      1993.5987     -5969.9438      3602.6891    
      2100   298.90986     -36537.564     -6276.5746     -3669.6842      3602.6891    
      2200   303.92108     -36559.367     -2000.9332     -1205.0059      3602.6891    
      2300   279.05604     -36564.107     -18955.904     -2123.4901      3602.6891    
      2400   285.61066     -36555.622      4644.8262     -2778.2635      3602.6891    
      2500   307.57713     -36549.289     -18196.561     -3772.956       3602.6891    
      2600   326.57947     -36555.142     -14366.621     -5856.6923      3602.6891    
      2700   299.27385     -36540.142     -10584.313     -3930.2765      3602.6891    
      2800   301.80908     -36563.476     -8524.799      -5812.2879      3602.6891    
      2900   301.24487     -36581.224      1306.4486      4293.085       3602.6891    
      3000   266.36147     -36568.658     -13865.884     -3433.656       3602.6891    
Loop time of 146.932 on 8 procs for 3000 steps with 331 atoms

Performance: 0.882 ns/day, 27.210 hours/ns, 20.418 timesteps/s, 6.758 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 79.284     | 109.25     | 123.3      | 152.8 | 74.36
Bond    | 0.0079091  | 0.0093398  | 0.010155   |   0.7 |  0.01
Neigh   | 6.451      | 8.5058     | 9.3724     |  38.8 |  5.79
Comm    | 1.5326     | 15.599     | 45.566     | 404.2 | 10.62
Output  | 0.0067435  | 0.0084576  | 0.010346   |   1.4 |  0.01
Modify  | 12.63      | 13.487     | 15.554     |  31.0 |  9.18
Other   |            | 0.06974    |            |       |  0.05

Nlocal:         41.375 ave          49 max          33 min
Histogram: 1 0 2 0 0 2 0 0 2 1
Nghost:        3249.62 ave        3299 max        3200 min
Histogram: 2 0 1 0 0 2 1 0 0 2
Neighs:        26617.2 ave       31081 max       21489 min
Histogram: 1 0 2 0 0 2 0 0 2 1

Total # of neighbors = 212938
Ave neighs/atom = 643.31722
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124.7 | 126.3 | 128 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   266.36147     -36568.658     -13865.909      0              3602.6891    
       100   291.88464     -36572.981      5227.5811     -5920.7349      3602.6891    
       200   307.99718     -36566.128     -3245.7349     -1676.814       3602.6891    
       300   305.93573     -36557.17       13309.064      2018.7109      3602.6891    
       400   333.60225     -36575.066     -5022.7837     -5519.6805      3602.6891    
       500   314.56519     -36552.344     -8037.2086      191.51243      3602.6891    
       600   312.02927     -36548.589     -9565.2891     -2227.4645      3602.6891    
       700   305.92191     -36554.149     -6949.1128      320.24575      3602.6891    
       800   296.67892     -36561.256     -6169.4858     -5823.036       3602.6891    
       900   296.68457     -36570.902     -8646.8218     -7652.8834      3602.6891    
      1000   298.63205     -36559.666     -10990.928     -6084.2796      3602.6891    
      1100   320.32825     -36550.796      1288.6801      855.39399      3602.6891    
      1200   287.80181     -36519.515     -9965.5183     -3966.3427      3602.6891    
      1300   308.48654     -36557.616      622.23718      140.75655      3602.6891    
      1400   305.37725     -36581.357     -4527.6389      422.70099      3602.6891    
      1500   290.35496     -36563.618     -12475.3       -9412.9437      3602.6891    
      1600   302.11192     -36558.829     -11972.304     -4761.1915      3602.6891    
      1700   310.44282     -36553.728      4167.9165     -2228.4868      3602.6891    
      1800   313.63228     -36554.435      4069.3269      2992.5631      3602.6891    
      1900   293.21503     -36558.072      7419.9798     -3166.1408      3602.6891    
      2000   293.4179      -36579.539     -6736.9804     -1828.1367      3602.6891    
      2100   272.10045     -36546.985     -3948.9767     -2263.7324      3602.6891    
      2200   305.39732     -36556.248     -653.05015      2505.9446      3602.6891    
      2300   309.0921      -36555.126     -1427.5774     -3527.1632      3602.6891    
      2400   286.79518     -36534.787     -4910.299      -3760.0099      3602.6891    
      2500   283.101       -36537.594     -9945.0738     -5489.5283      3602.6891    
      2600   292.50157     -36551.199     -2017.4366     -1832.4195      3602.6891    
      2700   308.18951     -36534.264      8002.0573     -5404.9049      3602.6891    
      2800   311.7122      -36521.062     -3055.1047     -2978.1956      3602.6891    
      2900   300.3961      -36532.031     -10075.362     -2475.8983      3602.6891    
      3000   293.34268     -36549.896     -2056.4411     -3059.4658      3602.6891    
Loop time of 145.927 on 8 procs for 3000 steps with 331 atoms

Performance: 0.888 ns/day, 27.024 hours/ns, 20.558 timesteps/s, 6.805 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 80.873     | 107.7      | 122.6      | 139.9 | 73.80
Bond    | 0.0079657  | 0.009115   | 0.0099771  |   0.6 |  0.01
Neigh   | 6.6295     | 8.4041     | 9.3626     |  36.2 |  5.76
Comm    | 1.3346     | 16.246     | 43.07      | 360.2 | 11.13
Output  | 0.0013812  | 0.0015659  | 0.0024437  |   0.8 |  0.00
Modify  | 12.549     | 13.498     | 15.281     |  28.7 |  9.25
Other   |            | 0.06995    |            |       |  0.05

Nlocal:         41.375 ave          46 max          32 min
Histogram: 1 0 0 0 0 3 0 0 1 3
Nghost:           3228 ave        3276 max        3183 min
Histogram: 2 1 0 0 0 1 1 2 0 1
Neighs:        26626.2 ave       29460 max       20889 min
Histogram: 1 0 0 0 0 3 0 0 1 3

Total # of neighbors = 213010
Ave neighs/atom = 643.53474
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 74.9090548059059
variable C2neg equal ${d2}
variable C2neg equal 62.7269971699914
variable C3neg equal ${d3}
variable C3neg equal 64.0627899305591
variable C4neg equal ${d4}
variable C4neg equal -14.8915975080666
variable C5neg equal ${d5}
variable C5neg equal 13.1755680893662
variable C6neg equal ${d6}
variable C6neg equal -11.2211606849084

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.5248
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.175248 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 0.029448 -2.0056)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124.5 | 126.3 | 128.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.05611     -36462.382     -16155.674      0              3602.6891    
       100   302.7874      -36501.367     -18281.074     -5390.4928      3602.6891    
       200   288.60894     -36509.587      8923.9204      1631.4501      3602.6891    
       300   294.04964     -36514.926     -7514.494      -1166.2995      3602.6891    
       400   285.07255     -36491.987     -2660.4431     -2373.4729      3602.6891    
       500   313.54734     -36503.891     -10555.587     -543.7572       3602.6891    
       600   299.00792     -36487.018     -7975.6999      186.93228      3602.6891    
       700   317.71211     -36510.702     -3915.4211     -3216.6521      3602.6891    
       800   301.20985     -36517.802     -2511.8553      719.14807      3602.6891    
       900   291.16698     -36530.425     -8709.0131     -3143.9929      3602.6891    
      1000   291.09746     -36526.354      2411.7513     -35.456803      3602.6891    
      1100   300.4367      -36503.999      7938.5961      2671.5408      3602.6891    
      1200   308.5432      -36490.713     -21617.463     -5768.371       3602.6891    
      1300   290.92751     -36482.762     -2552.2305     -1623.2515      3602.6891    
      1400   302.70652     -36519.431     -3473.9442     -3687.2133      3602.6891    
      1500   295.66201     -36532.724      2755.5059     -1712.6333      3602.6891    
      1600   293.85802     -36534.41      -10000.503     -980.88251      3602.6891    
      1700   293.9661      -36527.221      1926.6586      2085.1212      3602.6891    
      1800   300.70524     -36513.295     -1989.1964      339.21445      3602.6891    
      1900   291.80425     -36481.095      3399.7578      1938.7963      3602.6891    
      2000   322.45158     -36507.862     -3538.5684     -119.8449       3602.6891    
      2100   303.4303      -36504.237      323.16587     -1331.5838      3602.6891    
      2200   288.78566     -36523.915     -5442.7215      1341.7081      3602.6891    
      2300   290.57082     -36522.068     -9499.5564     -4059.9815      3602.6891    
      2400   291.1772      -36505.757     -1113.9475      195.34887      3602.6891    
      2500   314.83208     -36511.199      11105.946     -368.00738      3602.6891    
      2600   311.58038     -36498.163     -1841.027      -3834.3418      3602.6891    
      2700   299.40235     -36518.635      8527.1657     -1597.9815      3602.6891    
      2800   301.27335     -36539.333      1224.0532     -4960.0986      3602.6891    
      2900   292.66413     -36522.74      -9262.1707     -6775.5319      3602.6891    
      3000   309.29595     -36517.982      5512.2678     -33.443761      3602.6891    
Loop time of 146.278 on 8 procs for 3000 steps with 331 atoms

Performance: 0.886 ns/day, 27.088 hours/ns, 20.509 timesteps/s, 6.788 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 84.557     | 108.1      | 121.55     | 132.5 | 73.90
Bond    | 0.0079764  | 0.009012   | 0.009803   |   0.6 |  0.01
Neigh   | 7.5016     | 9.715      | 10.856     |  40.8 |  6.64
Comm    | 1.6607     | 15.144     | 38.685     | 354.0 | 10.35
Output  | 0.0061208  | 0.0077218  | 0.0091518  |   1.3 |  0.01
Modify  | 12.121     | 13.235     | 15.451     |  35.1 |  9.05
Other   |            | 0.0688     |            |       |  0.05

Nlocal:         41.375 ave          49 max          32 min
Histogram: 1 1 0 0 1 1 1 1 0 2
Nghost:         3253.5 ave        3303 max        3200 min
Histogram: 1 1 1 1 0 1 0 0 1 2
Neighs:        26633.6 ave       31225 max       20910 min
Histogram: 1 1 0 0 1 1 1 1 0 2

Total # of neighbors = 213069
Ave neighs/atom = 643.71299
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124.5 | 126.3 | 127.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.29595     -36517.982      5512.2416      0              3602.6891    
       100   304.50921     -36524.557     -7637.0148     -4119.432       3602.6891    
       200   272.17459     -36510.524     -8422.5994      500.50984      3602.6891    
       300   293.5463      -36558.415     -5857.265      -5401.73        3602.6891    
       400   281.45375     -36559.355     -10314.549     -1040.152       3602.6891    
       500   321.31732     -36575.396     -2654.843      -245.69101      3602.6891    
       600   314.95825     -36554.552     -15709.03      -4505.2179      3602.6891    
       700   297.68112     -36526.9        1959.4853     -2839.8015      3602.6891    
       800   289.24738     -36507.283     -17051.587     -8030.4501      3602.6891    
       900   317.21934     -36517.693     -5239.7303      93.843907      3602.6891    
      1000   316.23236     -36535.774     -7406.8236     -5216.0476      3602.6891    
      1100   303.22556     -36555.033      13123.004     -4008.2607      3602.6891    
      1200   273.72708     -36532.428     -1309.1064      1870.4683      3602.6891    
      1300   302.67771     -36537.411     -5861.2019     -1497.4766      3602.6891    
      1400   298.04046     -36517.511      4881.4726     -6461.331       3602.6891    
      1500   295.98597     -36520.119     -10927.362     -3481.2136      3602.6891    
      1600   307.05042     -36539.73      -17938.236     -4407.6796      3602.6891    
      1700   308.71362     -36580.975      3712.2229     -3430.8847      3602.6891    
      1800   281.08035     -36557.245     -402.76356     -3670.2624      3602.6891    
      1900   286.61713     -36543.566     -9065.046      -4598.9829      3602.6891    
      2000   277.80328     -36510.306     -18616.207     -3667.8297      3602.6891    
      2100   310.47182     -36529.472      6660.2243     -2459.9322      3602.6891    
      2200   307.78719     -36522.148     -7154.5683     -1931.5454      3602.6891    
      2300   294.29157     -36525.8       -19377.686     -3368.8783      3602.6891    
      2400   290.96485     -36551.26       9159.0128     -1673.0968      3602.6891    
      2500   297.7992      -36546.849     -5227.6064     -3410.7187      3602.6891    
      2600   327.07414     -36558.263     -11426.378      2225.4051      3602.6891    
      2700   294.29797     -36524.502      1505.6471     -1605.4955      3602.6891    
      2800   308.74323     -36528.033     -3177.6807     -7786.6014      3602.6891    
      2900   310.27797     -36497.16      -5937.8836     -5441.1434      3602.6891    
      3000   301.95651     -36473.564      3364.5881     -5036.245       3602.6891    
Loop time of 147.008 on 8 procs for 3000 steps with 331 atoms

Performance: 0.882 ns/day, 27.224 hours/ns, 20.407 timesteps/s, 6.755 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 83.969     | 110.2      | 121.65     | 115.6 | 74.96
Bond    | 0.0079006  | 0.0090969  | 0.010076   |   0.7 |  0.01
Neigh   | 7.5185     | 9.9064     | 10.748     |  31.4 |  6.74
Comm    | 2.0921     | 13.557     | 39.783     | 329.5 |  9.22
Output  | 0.0013571  | 0.0016392  | 0.003195   |   1.5 |  0.00
Modify  | 12.433     | 13.265     | 15.659     |  27.1 |  9.02
Other   |            | 0.07012    |            |       |  0.05

Nlocal:         41.375 ave          46 max          37 min
Histogram: 2 0 1 0 0 1 2 1 0 1
Nghost:        3231.88 ave        3256 max        3200 min
Histogram: 1 0 1 1 1 0 1 0 1 2
Neighs:        26674.4 ave       29534 max       24010 min
Histogram: 2 0 1 0 0 1 2 1 0 1

Total # of neighbors = 213395
Ave neighs/atom = 644.69789
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -54.8793397652309
variable C2pos equal ${d2}
variable C2pos equal -100.806995384932
variable C3pos equal ${d3}
variable C3pos equal -88.4217336844625
variable C4pos equal ${d4}
variable C4pos equal -23.447597227679
variable C5pos equal ${d5}
variable C5pos equal -1.97778198079382
variable C6pos equal ${d6}
variable C6pos equal -5.25757264666867

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(74.9090548059059+${C1pos})
variable C15 equal 0.5*(74.9090548059059+-54.8793397652309)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(62.7269971699914+${C2pos})
variable C25 equal 0.5*(62.7269971699914+-100.806995384932)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(64.0627899305591+${C3pos})
variable C35 equal 0.5*(64.0627899305591+-88.4217336844625)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-14.8915975080666+${C4pos})
variable C45 equal 0.5*(-14.8915975080666+-23.447597227679)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(13.1755680893662+${C5pos})
variable C55 equal 0.5*(13.1755680893662+-1.97778198079382)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-11.2211606849084+${C6pos})
variable C65 equal 0.5*(-11.2211606849084+-5.25757264666867)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.0868

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.0868
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.130868 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.335068 -0.1458 -2.0056)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.1 | 126.8 | 128.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.05611     -36464.973     -17853.48       0              3602.6891    
       100   299.06264     -36498.035     -14140.179     -4538.2009      3602.6891    
       200   289.05389     -36506.823     -192.63607      2117.8725      3602.6891    
       300   306.13443     -36516.657      1025.5804     -1390.5199      3602.6891    
       400   296.27302     -36499.938     -2432.7233      1855.4078      3602.6891    
       500   281.37696     -36487.097     -6929.0301      2543.363       3602.6891    
       600   293.19547     -36498.291      938.6693      -1233.6836      3602.6891    
       700   325.56524     -36526.188      962.97262      3051.8855      3602.6891    
       800   289.9184      -36501.396      867.71086     -931.93533      3602.6891    
       900   298.30897     -36519.738      4441.0378      1950.9146      3602.6891    
      1000   280.61668     -36513.935      11523.722      1294.0552      3602.6891    
      1100   290.51164     -36513.93       6449.7981      4698.6215      3602.6891    
      1200   300.43369     -36511.736      252.67521      833.60955      3602.6891    
      1300   314.19919     -36517.271      2127.6429      116.21009      3602.6891    
      1400   292.4168      -36503.57      -10702.949     -906.12619      3602.6891    
      1500   289.95393     -36506.554     -2993.1074     -2781.2634      3602.6891    
      1600   299.95399     -36521.137      8540.9455     -5036.1235      3602.6891    
      1700   288.71353     -36521.967      2932.5885      259.16939      3602.6891    
      1800   291.03135     -36534.821     -1692.1968      3600.0488      3602.6891    
      1900   287.97129     -36525.763      6810.8        -1594.0703      3602.6891    
      2000   292.6587      -36505.688     -3358.135       3649.8517      3602.6891    
      2100   329.12942     -36524.135     -5377.0152     -5361.9791      3602.6891    
      2200   310.65997     -36525.196     -10249.366     -3686.6419      3602.6891    
      2300   292.90205     -36519.711     -8630.8625     -1566.4089      3602.6891    
      2400   310.63251     -36536.801      4418.7419     -485.74734      3602.6891    
      2500   293.62712     -36517.831     -2304.3174     -3584.7465      3602.6891    
      2600   292.5892      -36504.931      2624.9477     -1754.3856      3602.6891    
      2700   318.10365     -36502.368      14000.599      1105.2417      3602.6891    
      2800   311.92618     -36493.662     -1918.6737      505.13241      3602.6891    
      2900   308.59855     -36519.944      7191.3529      1385.89        3602.6891    
      3000   294.30347     -36520.508      5892.3331     -679.02784      3602.6891    
Loop time of 146.146 on 8 procs for 3000 steps with 331 atoms

Performance: 0.887 ns/day, 27.064 hours/ns, 20.527 timesteps/s, 6.795 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 78.581     | 108.61     | 122.29     | 155.8 | 74.31
Bond    | 0.0080728  | 0.0091104  | 0.010224   |   0.8 |  0.01
Neigh   | 6.5706     | 8.5192     | 9.2956     |  38.6 |  5.83
Comm    | 1.8355     | 15.532     | 45.563     | 412.1 | 10.63
Output  | 0.0070317  | 0.0087416  | 0.010402   |   1.4 |  0.01
Modify  | 12.628     | 13.402     | 15.357     |  30.9 |  9.17
Other   |            | 0.06929    |            |       |  0.05

Nlocal:         41.375 ave          46 max          35 min
Histogram: 1 1 1 0 1 0 0 0 1 3
Nghost:        3254.62 ave        3282 max        3210 min
Histogram: 1 0 1 0 0 1 1 0 3 1
Neighs:          26627 ave       29400 max       22764 min
Histogram: 1 1 1 0 1 0 0 0 1 3

Total # of neighbors = 213016
Ave neighs/atom = 643.55287
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.1 | 126.5 | 127.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.30347     -36520.508      5892.3015      0              3602.6891    
       100   267.76662     -36492.471     -5508.0945     -5674.5974      3602.6891    
       200   313.73348     -36506.761     -3002.4611     -2126.9335      3602.6891    
       300   319.49219     -36498.46       76.312656     -3203.1885      3602.6891    
       400   331.58061     -36528.106      9798.2826      420.28864      3602.6891    
       500   304.13678     -36521.858     -1882.0898      261.18458      3602.6891    
       600   301.39837     -36533.927     -5512.2812     -2583.6206      3602.6891    
       700   302.47268     -36547.272     -4428.1293     -433.30463      3602.6891    
       800   314.24324     -36560.478     -12106.769     -1843.1952      3602.6891    
       900   299.78511     -36551.967      9459.1138     -2547.1557      3602.6891    
      1000   305.58981     -36572.011     -1557.8272      1717.4676      3602.6891    
      1100   276.18889     -36554.004      108.7925       2177.9632      3602.6891    
      1200   273.66098     -36532.487      1230.1899      1406.4363      3602.6891    
      1300   312.82342     -36545.387      1547.5547      494.18561      3602.6891    
      1400   311.42995     -36544.295      4009.5068      4086.125       3602.6891    
      1500   309.61646     -36545.397     -10842.653     -1944.6472      3602.6891    
      1600   294.13795     -36557.299     -13189.432     -3227.9179      3602.6891    
      1700   293.75925     -36586.024     -4951.9795     -357.93804      3602.6891    
      1800   277.55608     -36563.859     -147.14927     -4566.7593      3602.6891    
      1900   306.25116     -36569.151      716.95727     -2736.9656      3602.6891    
      2000   297.32943     -36552.767     -2122.9753      1305.5966      3602.6891    
      2100   305.41346     -36558.424     -497.8781      -4528.4429      3602.6891    
      2200   291.2383      -36549.4        9771.6061     -1117.4901      3602.6891    
      2300   291.28226     -36567.882     -2177.3036     -3311.3935      3602.6891    
      2400   300.26307     -36593.616      4471.9266      390.86286      3602.6891    
      2500   280.83348     -36561.19       691.57003     -5298.083       3602.6891    
      2600   300.15151     -36553.723     -2531.8798      1727.7667      3602.6891    
      2700   309.84618     -36559.897      7575.8761     -1050.5968      3602.6891    
      2800   313.70673     -36574.194     -2375.3083      902.24013      3602.6891    
      2900   297.71848     -36572.811      6711.204       2675.8838      3602.6891    
      3000   265.38121     -36570.078     -13827.942      1594.5941      3602.6891    
Loop time of 145.587 on 8 procs for 3000 steps with 331 atoms

Performance: 0.890 ns/day, 26.961 hours/ns, 20.606 timesteps/s, 6.821 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 84.355     | 110.2      | 121.98     | 130.1 | 75.69
Bond    | 0.0080252  | 0.0092925  | 0.01041    |   0.8 |  0.01
Neigh   | 6.547      | 8.6017     | 9.2198     |  32.2 |  5.91
Comm    | 1.6269     | 13.427     | 39.254     | 372.6 |  9.22
Output  | 0.0013936  | 0.0015645  | 0.0024931  |   0.9 |  0.00
Modify  | 12.665     | 13.283     | 15.352     |  26.0 |  9.12
Other   |            | 0.06955    |            |       |  0.05

Nlocal:         41.375 ave          48 max          30 min
Histogram: 1 0 0 2 0 0 0 2 0 3
Nghost:        3262.25 ave        3317 max        3217 min
Histogram: 2 0 0 1 2 0 1 1 0 1
Neighs:          26612 ave       30684 max       19598 min
Histogram: 1 0 0 2 0 0 0 2 0 3

Total # of neighbors = 212896
Ave neighs/atom = 643.19033
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 122.066316492452
variable C2neg equal ${d2}
variable C2neg equal 96.2984323497209
variable C3neg equal ${d3}
variable C3neg equal 64.2580692991529
variable C4neg equal ${d4}
variable C4neg equal 17.4533048890275
variable C5neg equal ${d5}
variable C5neg equal 8.13197082417257
variable C6neg equal ${d6}
variable C6neg equal -10.6265853559413

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.2042 -0.1458 -2.0056)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  331 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.0868
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.130868 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.7087 13.0868 17.5248) with tilt (-8.073332 -0.1458 -2.0056)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124 | 125.5 | 126.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.05611     -36463.667     -15127.208      0              3602.6891    
       100   301.20043     -36499.262     -13356.994     -3994.0924      3602.6891    
       200   289.55085     -36506.482     -1197.3984      1582.442       3602.6891    
       300   306.40686     -36522.764     -10515.973     -3016.1173      3602.6891    
       400   279.43047     -36486.833     -1215.6541     -2389.7661      3602.6891    
       500   291.37752     -36479.678      1889.5255      1619.8296      3602.6891    
       600   307.22823     -36477.66      -2430.1843     -6945.9464      3602.6891    
       700   317.91724     -36483.933      5599.3563     -5366.3347      3602.6891    
       800   285.78288     -36469.899     -8751.8234     -4956.8748      3602.6891    
       900   286.16801     -36490.102     -6075.3402     -338.40666      3602.6891    
      1000   295.62298     -36509.112     -5722.2653     -5206.7811      3602.6891    
      1100   294.35057     -36506.625      1522.9205      2171.214       3602.6891    
      1200   319.9162      -36525.178     -4053.9393      653.13617      3602.6891    
      1300   310.17795     -36510.608      4991.2229     -3287.5068      3602.6891    
      1400   302.75338     -36498.527     -5716.207      -2631.121       3602.6891    
      1500   318.18867     -36518.522     -8683.6151     -3580.1543      3602.6891    
      1600   293.97013     -36511.864     -3862.8219      1853.4774      3602.6891    
      1700   266.08811     -36503.231      9568.9791      295.24761      3602.6891    
      1800   302.70403     -36539.613     -2336.5509     -396.30149      3602.6891    
      1900   317.44424     -36531.281     -9240.4359      202.29617      3602.6891    
      2000   331.99186     -36527.782     -2878.3921      2458.9746      3602.6891    
      2100   310.46965     -36496.614     -6099.5724     -2102.3399      3602.6891    
      2200   311.07399     -36513.281     -4469.4459     -3902.8984      3602.6891    
      2300   286.82509     -36521.528     -1493.9078     -1811.6392      3602.6891    
      2400   287.06518     -36526.858     -756.19531      553.23478      3602.6891    
      2500   297.88125     -36519.984     -8139.6763      3642.8154      3602.6891    
      2600   309.98329     -36511.465     -11919.822      384.19736      3602.6891    
      2700   297.67668     -36496.099     -10181.337     -3297.4449      3602.6891    
      2800   304.98076     -36531.314      3728.7833      3185.6231      3602.6891    
      2900   296.04306     -36545.905      5910.0831      2259.3035      3602.6891    
      3000   282.95594     -36522.518      11711.504     -2549.1603      3602.6891    
Loop time of 137.709 on 8 procs for 3000 steps with 331 atoms

Performance: 0.941 ns/day, 25.502 hours/ns, 21.785 timesteps/s, 7.211 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 73.962     | 93.934     | 113.49     | 159.4 | 68.21
Bond    | 0.0074586  | 0.0083444  | 0.009552   |   0.7 |  0.01
Neigh   | 7.3561     | 9.0136     | 10.575     |  50.1 |  6.55
Comm    | 1.5149     | 21.1       | 41.059     | 336.5 | 15.32
Output  | 0.0057405  | 0.0071898  | 0.0082658  |   1.1 |  0.01
Modify  | 11.999     | 13.582     | 15.257     |  40.7 |  9.86
Other   |            | 0.06377    |            |       |  0.05

Nlocal:         41.375 ave          52 max          36 min
Histogram: 2 1 0 3 0 1 0 0 0 1
Nghost:         3249.5 ave        3286 max        3208 min
Histogram: 2 0 1 0 0 0 1 3 0 1
Neighs:        26637.4 ave       33157 max       23310 min
Histogram: 2 1 1 2 0 1 0 0 0 1

Total # of neighbors = 213099
Ave neighs/atom = 643.80363
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 124.1 | 125.7 | 127.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   282.95594     -36522.518      11711.486      0              3602.6891    
       100   288.14598     -36519.046     -17833.817      481.89755      3602.6891    
       200   304.88391     -36506.489      14645.389     -1109.3967      3602.6891    
       300   316.10067     -36501.972      4578.6513     -1835.7315      3602.6891    
       400   286.38199     -36504.491     -8784.4606     -3367.755       3602.6891    
       500   286.67935     -36518.635     -10082.168     -3761.785       3602.6891    
       600   307.68237     -36538.899     -8637.4026     -4264.455       3602.6891    
       700   299.97911     -36529.985     -12391.769     -64.594934      3602.6891    
       800   295.55844     -36518.167      10765.975      2876.9292      3602.6891    
       900   321.58369     -36528.852     -5359.71       -3490.3656      3602.6891    
      1000   320.60556     -36510.544      8001.9397     -4247.3675      3602.6891    
      1100   318.00217     -36503.072     -12061.078     -4880.5681      3602.6891    
      1200   295.26109     -36518.344      4021.5647      2867.5731      3602.6891    
      1300   287.17366     -36515.868     -9521.8567     -4341.4607      3602.6891    
      1400   313.11289     -36543.123     -2820.2877     -2260.5007      3602.6891    
      1500   286.55248     -36538.705      5631.934      -7252.023       3602.6891    
      1600   293.24327     -36557.034     -1862.8099     -5203.809       3602.6891    
      1700   290.45194     -36537.085     -4872.2        -5206.6772      3602.6891    
      1800   306.68823     -36520.488      1173.9737      79.04658       3602.6891    
      1900   293.02631     -36502         -4894.8369     -2694.8141      3602.6891    
      2000   300.63827     -36516.138     -9949.0883     -5012.0757      3602.6891    
      2100   290.32736     -36535.463     -9781.2878     -1623.2158      3602.6891    
      2200   285.62949     -36534.996     -1615.6203     -2488.3302      3602.6891    
      2300   297.3573      -36531.477     -5992.9838     -2886.4844      3602.6891    
      2400   307.07404     -36519.103     -18700.717     -5859.1806      3602.6891    
      2500   307.58676     -36522.095     -15124.958     -2502.1479      3602.6891    
      2600   309.07764     -36535.549     -12517.277     -4520.6131      3602.6891    
      2700   301.47922     -36546.661      448.18779     -3235.8545      3602.6891    
      2800   286.68218     -36530.774     -6769.7776     -8015.4752      3602.6891    
      2900   318.75353     -36525.18      -12224.992     -7297.8665      3602.6891    
      3000   301.19075     -36503.591      5946.8082     -3573.8188      3602.6891    
Loop time of 137.144 on 8 procs for 3000 steps with 331 atoms

Performance: 0.945 ns/day, 25.397 hours/ns, 21.875 timesteps/s, 7.241 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 73.809     | 93.26      | 113.27     | 161.8 | 68.00
Bond    | 0.0071257  | 0.0080326  | 0.0091032  |   0.7 |  0.01
Neigh   | 7.3697     | 9.0156     | 10.584     |  49.4 |  6.57
Comm    | 1.1138     | 21.157     | 40.589     | 340.0 | 15.43
Output  | 0.0011868  | 0.0013074  | 0.0018562  |   0.6 |  0.00
Modify  | 12.098     | 13.639     | 15.251     |  40.0 |  9.94
Other   |            | 0.06386    |            |       |  0.05

Nlocal:         41.375 ave          47 max          35 min
Histogram: 1 2 0 0 0 1 1 1 0 2
Nghost:        3269.38 ave        3317 max        3226 min
Histogram: 1 2 0 0 2 0 0 1 1 1
Neighs:        26643.4 ave       30041 max       22719 min
Histogram: 1 2 0 0 0 0 2 1 0 2

Total # of neighbors = 213147
Ave neighs/atom = 643.94864
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -69.6973726093462
variable C2pos equal ${d2}
variable C2pos equal -60.2293001082528
variable C3pos equal ${d3}
variable C3pos equal -28.6668263620229
variable C4pos equal ${d4}
variable C4pos equal -4.41667963541492
variable C5pos equal ${d5}
variable C5pos equal -20.7102431560862
variable C6pos equal ${d6}
variable C6pos equal 4.77674852324829

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(122.066316492452+${C1pos})
variable C16 equal 0.5*(122.066316492452+-69.6973726093462)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(96.2984323497209+${C2pos})
variable C26 equal 0.5*(96.2984323497209+-60.2293001082528)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(64.2580692991529+${C3pos})
variable C36 equal 0.5*(64.2580692991529+-28.6668263620229)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(17.4533048890275+${C4pos})
variable C46 equal 0.5*(17.4533048890275+-4.41667963541492)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(8.13197082417257+${C5pos})
variable C56 equal 0.5*(8.13197082417257+-20.7102431560862)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(-10.6265853559413+${C6pos})
variable C66 equal 0.5*(-10.6265853559413+4.77674852324829)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 83.2480262267789
variable C22all equal ${C22}
variable C22all equal -19.6761598340046
variable C33all equal ${C33}
variable C33all equal 22.6893069749898

variable C44all equal ${C44}
variable C44all equal 3.6679588615518
variable C55all equal ${C55}
variable C55all equal 5.59889305428619
variable C66all equal ${C66}
variable C66all equal -2.92491841634651

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(5.8283782985325+${C21})
variable C12all equal 0.5*(5.8283782985325+-3.79075278813535)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(18.0065310832824+${C31})
variable C13all equal 0.5*(18.0065310832824+29.4282121289192)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(-2.25897074874935+${C32})
variable C23all equal 0.5*(-2.25897074874935+3.54809305533295)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-46.455545190302+${C41})
variable C14all equal 0.5*(-46.455545190302+0.250112919879506)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(10.0148575203375+${C51})
variable C15all equal 0.5*(10.0148575203375+5.3248133926808)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(26.1844719415529+${C61})
variable C16all equal 0.5*(26.1844719415529+-8.10927762324136)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-25.1606750145868+${C42})
variable C24all equal 0.5*(-25.1606750145868+-0.49685914342823)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-19.0399991074703+${C52})
variable C25all equal 0.5*(-19.0399991074703+-5.84984406231075)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(18.034566120734+${C62})
variable C26all equal 0.5*(18.034566120734+-3.14427555027279)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(-16.8931777094221+${C43})
variable C34all equal 0.5*(-16.8931777094221+-10.5724172260959)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-12.1794718769517+${C53})
variable C35all equal 0.5*(-12.1794718769517+3.90343157396607)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(17.795621468565+${C63})
variable C36all equal 0.5*(17.795621468565+0.269762633466695)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-19.1695973678728+${C54})
variable C45all equal 0.5*(-19.1695973678728+6.85492205185294)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(6.51831262680629+${C64})
variable C46all equal 0.5*(6.51831262680629+2.19721315508529)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-6.28913616595682+${C65})
variable C56all equal 0.5*(-6.28913616595682+-8.23936666578853)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 1:00:52
