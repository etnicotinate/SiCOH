LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 30*${nthermo}       # steps of equilibration run 20
variable nequil equal 30*100       
variable nrun equal 30*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 30*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-48-vasp
read_data       ${structure}.data
read_data       333U-50C-48-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.010 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 6.66636e-05 on 8 procs for 1 steps with 386 atoms

49.7% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.188e-06  | 1.694e-06  | 2.305e-06  |   0.0 |  2.54
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 4.679e-06  | 4.9758e-06 | 5.377e-06  |   0.0 |  7.46
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 5.999e-05  |            |       | 89.99

Nlocal:          48.25 ave          57 max          44 min
Histogram: 1 3 1 0 2 0 0 0 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-48-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 3000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -0.82 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.5 | 134.6 | 136.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -43252.041      122314.38      0              1.7215889      3934.8755    
       100   687.78657     -44005.613     -8794.9944      17804.973      1.7215889      3934.8755    
       200   532.95414     -44212.652      4685.379       10541.4        1.7215889      3934.8755    
       300   428.38322     -44394.229      13642.414      11934.933      1.7215889      3934.8755    
       400   357.48885     -44522.718      7814.9119      1580.197       1.7215889      3934.8755    
       500   305.20861     -44601.4        10808.086      473.85325      1.7215889      3934.8755    
       600   295.50212     -44683.072     -513.875       -724.2457       1.7215889      3934.8755    
       700   280.46427     -44711.699     -1603.7978      674.06289      1.7215889      3934.8755    
       800   279.60643     -44705.198      4769.2458      5590.237       1.7215889      3934.8755    
       900   318.26234     -44701.239     -1818.0216     -1670.5126      1.7215889      3934.8755    
      1000   330.13743     -44680.939      314.21565      3022.8834      1.7215889      3934.8755    
      1100   306.37201     -44671.549      338.51067      5049.3242      1.7215889      3934.8755    
      1200   285.35817     -44690.413      18102.578      5983.2525      1.7215889      3934.8755    
      1300   282.87873     -44713.783      16541.07       2756.0253      1.7215889      3934.8755    
      1400   283.9657      -44719.988      13551.045      5972.2344      1.7215889      3934.8755    
      1500   299.28169     -44731.239     -5446.4411     -3403.7987      1.7215889      3934.8755    
      1600   295.10399     -44708.179      13091.763      5243.1496      1.7215889      3934.8755    
      1700   306.5935      -44695.641      12607.525      7518.1319      1.7215889      3934.8755    
      1800   307.96105     -44688.824      114.19541     -2361.775       1.7215889      3934.8755    
      1900   297.5467      -44689.544     -11232.833      2065.3884      1.7215889      3934.8755    
      2000   297.63273     -44718.624      3681.1426      2103.8631      1.7215889      3934.8755    
      2100   284.48949     -44729.07       1810.321      -20.474571      1.7215889      3934.8755    
      2200   299.39507     -44746.849      9777.7339      2357.5208      1.7215889      3934.8755    
      2300   309.12185     -44739.177      11871.005      8811.3385      1.7215889      3934.8755    
      2400   299.81281     -44711.424      2203.2625      7478.6982      1.7215889      3934.8755    
      2500   301.13092     -44712.816      7486.3507      1974.8484      1.7215889      3934.8755    
      2600   306.0768      -44733.777      3844.6675      3611.939       1.7215889      3934.8755    
      2700   294.99852     -44744.953      10956.358      6791.8753      1.7215889      3934.8755    
      2800   294.76019     -44755.788      4132.5298      5317.6333      1.7215889      3934.8755    
      2900   285.45879     -44739.503     -2290.237      -2306.3851      1.7215889      3934.8755    
      3000   309.50281     -44750.322      2435.9873      2174.7572      1.7215889      3934.8755    
Loop time of 149.758 on 8 procs for 3000 steps with 386 atoms

Performance: 0.865 ns/day, 27.733 hours/ns, 20.032 timesteps/s, 7.732 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.966     | 99.531     | 127.05     | 153.1 | 66.46
Bond    | 0.0072782  | 0.0080759  | 0.0086829  |   0.5 |  0.01
Neigh   | 6.9853     | 7.7238     | 9.6937     |  40.9 |  5.16
Comm    | 0.92353    | 28.425     | 41.001     | 286.4 | 18.98
Output  | 0.0015226  | 0.0017665  | 0.0024468  |   0.6 |  0.00
Modify  | 12.006     | 14         | 14.734     |  30.7 |  9.35
Other   |            | 0.06812    |            |       |  0.05

Nlocal:          48.25 ave          57 max          43 min
Histogram: 2 0 2 0 1 2 0 0 0 1
Nghost:        3448.25 ave        3477 max        3431 min
Histogram: 2 1 0 3 0 0 0 1 0 1
Neighs:        33067.5 ave       38626 max       29810 min
Histogram: 2 0 2 0 2 1 0 0 0 1

Total # of neighbors = 264540
Ave neighs/atom = 685.33679
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-48-vasp_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.7222
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.589
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.3161

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-2174.75716678958)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-2174.75716678958)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-5471.69318369319)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-5471.69318369319)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-2949.48400840733)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-2949.48400840733)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--1007.88925445766)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--1007.88925445766)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--290.395508686606)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--290.395508686606)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--3881.85471074896)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--3881.85471074896)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 16.7222
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.7222
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.167222 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.167222 xy delta 0.073464 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.167222 xy delta 0.073464 xz delta 0.003071 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.554978 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.554978 13.589 17.3161) with tilt (-7.272936 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.554978 13.589 17.3161) with tilt (-7.272936 -0.304029 -0.018)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.8 | 134.9 | 136.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.50281     -44734.389      50980.43       0              3895.5268    
       100   328.46983     -44750.2        6597.5954      10875.856      3895.5268    
       200   311.74254     -44742.585      8372.5459      12857.357      3895.5268    
       300   302.31804     -44759.397      13614.699      9381.2241      3895.5268    
       400   283.2923      -44748.518      2813.8659      3624.16        3895.5268    
       500   298.42745     -44754.663      12148.272      6704.2127      3895.5268    
       600   309.41162     -44739.256      15797.237      10504.639      3895.5268    
       700   308.8708      -44725.339      4496.7495      6620.4677      3895.5268    
       800   299.55657     -44723.995      7209.6478      11469.502      3895.5268    
       900   301.97195     -44749.451      7041.6087      8105.5913      3895.5268    
      1000   290.92574     -44765.958      15206.112      9645.6112      3895.5268    
      1100   281.88579     -44765.397     -931.27396      4592.2772      3895.5268    
      1200   292.5687      -44759.993      4107.504       6528.8828      3895.5268    
      1300   311.48499     -44753.099      21384.859      11982.187      3895.5268    
      1400   307.51163     -44737.071      23218.764      12669.232      3895.5268    
      1500   303.26547     -44748.73       6628.5448      8831.9418      3895.5268    
      1600   300.32906     -44776.603      25218.127      9583.1414      3895.5268    
      1700   293.32207     -44769.992     -6573.0861      6956.9868      3895.5268    
      1800   282.29439     -44744.89      -3117.7734      13038.101      3895.5268    
      1900   298.17102     -44745.068      6351.0975      9068.6129      3895.5268    
      2000   294.31767     -44730.916      520.23034      10627.616      3895.5268    
      2100   299.21596     -44720.272      2591.183       4120.8579      3895.5268    
      2200   314.84516     -44710.071      19474.904      4214.2793      3895.5268    
      2300   309.21452     -44720.494     -5264.6027      4735.0007      3895.5268    
      2400   290.31399     -44730.389      8906.0132      2826.0076      3895.5268    
      2500   295.91468     -44746.64       2921.6331      8441.379       3895.5268    
      2600   303.38112     -44746.085      2054.8541      9559.9407      3895.5268    
      2700   322.10694     -44745.776     -3400.7706      10914.602      3895.5268    
      2800   319.571       -44733.242      12264.878      10650.989      3895.5268    
      2900   295.48539     -44728.691      8443.2009      12097.634      3895.5268    
      3000   306.95774     -44772.185      3449.3953      8920.9249      3895.5268    
Loop time of 152.919 on 8 procs for 3000 steps with 386 atoms

Performance: 0.848 ns/day, 28.318 hours/ns, 19.618 timesteps/s, 7.573 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 89.156     | 101.81     | 129.81     | 152.5 | 66.58
Bond    | 0.007244   | 0.008279   | 0.0091225  |   0.6 |  0.01
Neigh   | 7.158      | 7.87       | 9.8617     |  40.8 |  5.15
Comm    | 0.87124    | 28.85      | 41.529     | 286.3 | 18.87
Output  | 0.0063558  | 0.0078454  | 0.0087849  |   1.0 |  0.01
Modify  | 12.288     | 14.302     | 15.008     |  30.7 |  9.35
Other   |            | 0.06835    |            |       |  0.04

Nlocal:          48.25 ave          61 max          39 min
Histogram: 1 0 1 2 2 1 0 0 0 1
Nghost:        3490.62 ave        3534 max        3451 min
Histogram: 2 0 0 1 1 1 1 1 0 1
Neighs:        33381.5 ave       41523 max       27452 min
Histogram: 1 0 1 2 2 1 0 0 0 1

Total # of neighbors = 267052
Ave neighs/atom = 691.84456
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 134.6 | 135.3 | 136.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   306.95774     -44772.185      3449.4209      0              3895.5268    
       100   294.1015      -44757.225      6369.092       7854.9216      3895.5268    
       200   310.65297     -44773.788      431.46942      4648.7989      3895.5268    
       300   294.9487      -44758.235      11571.176      10096.11       3895.5268    
       400   308.6921      -44775.059      11385.041      7652.8769      3895.5268    
       500   312.65919     -44791.006     -2340.9598      8437.5659      3895.5268    
       600   304.24184     -44800.122      6762.1483      2813.7874      3895.5268    
       700   284.76587     -44782.383      1011.9997      5905.9893      3895.5268    
       800   308.13249     -44774.204      5180.7796      6731.2099      3895.5268    
       900   331.09875     -44788.64       4382.3876      8968.1559      3895.5268    
      1000   292.99626     -44758.614      1645.5224      9447.0991      3895.5268    
      1100   307.55235     -44790.307      2207.1658      7300.7782      3895.5268    
      1200   294.86483     -44786.1        4054.1576      9423.7594      3895.5268    
      1300   295.19183     -44784.831     -164.2842       3369.3703      3895.5268    
      1400   290.39956     -44775.431     -1022.4017      8810.8949      3895.5268    
      1500   292.29046     -44754.27       10806.927      10483.451      3895.5268    
      1600   296.91887     -44737.248      8959.3381      7807.2969      3895.5268    
      1700   309.99027     -44752.942      11099.987      8846.3559      3895.5268    
      1800   292.99669     -44774.634      9862.4975      5996.1084      3895.5268    
      1900   306.14311     -44799.124      4319.3457      2220.693       3895.5268    
      2000   296.7761      -44788.018      12022.046      9749.7018      3895.5268    
      2100   298.03164     -44764.265      1463.499       11507.282      3895.5268    
      2200   316.97147     -44759.262      9481.2006      9236.7961      3895.5268    
      2300   285.20182     -44731.909      13017.856      4856.6127      3895.5268    
      2400   303.74838     -44762.098      3134.2409      4864.9547      3895.5268    
      2500   307.22835     -44781.42      -12158.014      3081.1965      3895.5268    
      2600   297.15376     -44784.584     -1478.712       7927.3909      3895.5268    
      2700   299.30437     -44783.857     -8952.2804      4062.9572      3895.5268    
      2800   285.65832     -44758.974      6651.1248      7081.837       3895.5268    
      2900   310.25331     -44784.041     -2920.9622      3617.6479      3895.5268    
      3000   302.55318     -44782.38      -6687.0393     -2373.142       3895.5268    
Loop time of 153.743 on 8 procs for 3000 steps with 386 atoms

Performance: 0.843 ns/day, 28.471 hours/ns, 19.513 timesteps/s, 7.532 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 89.834     | 101.89     | 130.35     | 152.0 | 66.28
Bond    | 0.0072681  | 0.0082214  | 0.0089889  |   0.5 |  0.01
Neigh   | 7.1504     | 7.8515     | 9.8595     |  40.7 |  5.11
Comm    | 0.86682    | 29.315     | 41.404     | 283.2 | 19.07
Output  | 0.0012372  | 0.0014169  | 0.0020473  |   0.6 |  0.00
Modify  | 12.56      | 14.604     | 15.295     |  30.3 |  9.50
Other   |            | 0.06771    |            |       |  0.04

Nlocal:          48.25 ave          59 max          41 min
Histogram: 2 1 0 3 0 0 0 0 0 2
Nghost:        3490.88 ave        3531 max        3459 min
Histogram: 1 0 0 3 1 2 0 0 0 1
Neighs:        33395.2 ave       40470 max       28497 min
Histogram: 2 1 0 2 1 0 0 0 0 2

Total # of neighbors = 267162
Ave neighs/atom = 692.12953
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -46.081588719161
variable C2neg equal ${d2}
variable C2neg equal -61.1516493986342
variable C3neg equal ${d3}
variable C3neg equal -51.6640068257105
variable C4neg equal ${d4}
variable C4neg equal -12.6124249900994
variable C5neg equal ${d5}
variable C5neg equal 16.5574153089324
variable C6neg equal ${d6}
variable C6neg equal -11.2180938975561

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.7222
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.167222 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.167222 xy delta -0.073464 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.167222 xy delta -0.073464 xz delta -0.003071 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.889422 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.889422 13.589 17.3161) with tilt (-7.419864 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.889422 13.589 17.3161) with tilt (-7.419864 -0.310171 -0.018)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.2 | 133.5 | 133.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.50281     -44728.382     -40067.561      0              3974.2243    
       100   310.55258     -44723.025     -1503.7813     -5972.9156      3974.2243    
       200   318.12097     -44742.356     -815.30335      793.26857      3974.2243    
       300   287.2584      -44734.19       14449.399      704.34994      3974.2243    
       400   293.61614     -44755.222      5133.3618     -5387.2146      3974.2243    
       500   282.10995     -44731.654      3760.206      -2768.2766      3974.2243    
       600   316.02963     -44746.604     -234.19911     -3400.4096      3974.2243    
       700   303.69427     -44726.059      5293.6727     -1000.5604      3974.2243    
       800   299.08114     -44727.763     -5264.2462     -2735.4675      3974.2243    
       900   291.66876     -44733.657     -2479.6182     -2152.3835      3974.2243    
      1000   293.68715     -44753.665      1615.0221     -1920.4256      3974.2243    
      1100   286.76556     -44749.341     -13962.358     -7772.7816      3974.2243    
      1200   314.56907     -44760.091      2222.4455     -3254.2686      3974.2243    
      1300   322.78032     -44754.2        273.08153     -329.22544      3974.2243    
      1400   299.14078     -44731.734      13138.887     -137.13315      3974.2243    
      1500   296.83845     -44750.346      1164.0874     -2306.4532      3974.2243    
      1600   270.00093     -44739.965     -2853.422      -1691.9608      3974.2243    
      1700   294.08421     -44745.269     -6716.5882     -1566.2464      3974.2243    
      1800   325.03797     -44752.371      3675.9965      4328.2148      3974.2243    
      1900   319.4798      -44757.61       7927.4837     -3425.7001      3974.2243    
      2000   287.83576     -44740.131      3496.5118     -245.63501      3974.2243    
      2100   305.26803     -44758.088      1978.7029      967.63984      3974.2243    
      2200   321.13316     -44755.731      8059.6855     -4593.2695      3974.2243    
      2300   324.75024     -44723.009      2740.2926     -520.1269       3974.2243    
      2400   316.8237      -44728.931     -1549.2179     -4804.9407      3974.2243    
      2500   306.42179     -44744.119     -10313.84      -3025.788       3974.2243    
      2600   303.39849     -44750.415     -6164.0982     -818.18804      3974.2243    
      2700   306.82903     -44758.094     -8154.1808     -2054.2635      3974.2243    
      2800   311.46282     -44780.027      10323.389      5456.1094      3974.2243    
      2900   294.04892     -44787.977      8204.12       -3370.5268      3974.2243    
      3000   305.7088      -44804.082     -1004.2218     -4602.7667      3974.2243    
Loop time of 147.506 on 8 procs for 3000 steps with 386 atoms

Performance: 0.879 ns/day, 27.316 hours/ns, 20.338 timesteps/s, 7.851 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.445     | 98.637     | 125.1      | 147.1 | 66.87
Bond    | 0.0071688  | 0.0080992  | 0.0087305  |   0.5 |  0.01
Neigh   | 6.9793     | 7.6889     | 9.6303     |  40.4 |  5.21
Comm    | 0.8609     | 27.311     | 39.519     | 279.3 | 18.52
Output  | 0.0060304  | 0.0075913  | 0.0085544  |   1.1 |  0.01
Modify  | 11.82      | 13.786     | 14.487     |  30.6 |  9.35
Other   |            | 0.06717    |            |       |  0.05

Nlocal:          48.25 ave          59 max          39 min
Histogram: 1 0 1 0 3 1 0 1 0 1
Nghost:           3446 ave        3491 max        3427 min
Histogram: 4 0 1 0 1 1 0 0 0 1
Neighs:        32695.2 ave       39494 max       26825 min
Histogram: 1 1 0 1 2 1 0 1 0 1

Total # of neighbors = 261562
Ave neighs/atom = 677.62176
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.1 | 133.5 | 133.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   305.7088      -44804.082     -1004.2428      0              3974.2243    
       100   286.25097     -44770.056      2706.224      -3900.8712      3974.2243    
       200   292.62043     -44742.621      2663.3416     -1320.882       3974.2243    
       300   294.56643     -44734.784      3992.5383     -3642.8735      3974.2243    
       400   294.82278     -44738.734     -1630.1363     -4671.189       3974.2243    
       500   307.18456     -44774.292     -4972.6695     -6839.9037      3974.2243    
       600   282.67912     -44776.14       299.99815     -3489.089       3974.2243    
       700   285.13719     -44776.146     -5927.1658     -3031.6375      3974.2243    
       800   287.09749     -44760.954     -1084.4008      431.69094      3974.2243    
       900   295.79967     -44762.453     -7134.2856     -1954.3223      3974.2243    
      1000   288.24617     -44747.467      1144.8449     -727.73063      3974.2243    
      1100   291.18313     -44743.426     -10438.761      2145.0448      3974.2243    
      1200   293.88945     -44756.38      -1750.3543      1750.3264      3974.2243    
      1300   305.27329     -44791.052      11541.033     -5797.4364      3974.2243    
      1400   299.91197     -44789.22      -7666.0892     -6882.7142      3974.2243    
      1500   300.8439      -44775.87       10550.587      4607.016       3974.2243    
      1600   317.23009     -44763.779     -8194.8895     -1232.2673      3974.2243    
      1700   306.23451     -44749.149      7056.4681     -746.41564      3974.2243    
      1800   312.65725     -44762.051     -2514.1036      517.29907      3974.2243    
      1900   298.614       -44778.246     -6974.0417      74.701833      3974.2243    
      2000   281.11956     -44783.294      339.42358     -4735.8019      3974.2243    
      2100   289.57914     -44774.502      11548.381     -7085.5466      3974.2243    
      2200   313.80673     -44774.224      447.91653     -4784.6743      3974.2243    
      2300   303.15075     -44747.775     -6236.2632     -3896.1526      3974.2243    
      2400   300.11326     -44744.604     -14000.105      340.12303      3974.2243    
      2500   284.26711     -44751.192      1634.0465     -71.806081      3974.2243    
      2600   291.18339     -44781.353      698.06806     -2998.134       3974.2243    
      2700   295.75996     -44778.911      4339.0391      3468.9049      3974.2243    
      2800   312.94615     -44750.454     -1622.3073     -209.85662      3974.2243    
      2900   312.49577     -44752.109      9992.3001      1090.5326      3974.2243    
      3000   303.04431     -44762.872     -382.02374      1517.6413      3974.2243    
Loop time of 148.536 on 8 procs for 3000 steps with 386 atoms

Performance: 0.873 ns/day, 27.507 hours/ns, 20.197 timesteps/s, 7.796 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.289     | 100.82     | 125.47     | 150.2 | 67.88
Bond    | 0.0072842  | 0.008051   | 0.0088734  |   0.5 |  0.01
Neigh   | 7.0043     | 7.913      | 9.6587     |  40.4 |  5.33
Comm    | 1.2513     | 25.886     | 40.434     | 296.3 | 17.43
Output  | 0.0011828  | 0.001398   | 0.0019392  |   0.6 |  0.00
Modify  | 12.07      | 13.837     | 14.738     |  30.8 |  9.32
Other   |            | 0.06762    |            |       |  0.05

Nlocal:          48.25 ave          56 max          36 min
Histogram: 1 0 0 0 0 3 0 1 2 1
Nghost:        3449.38 ave        3498 max        3418 min
Histogram: 1 2 0 2 1 0 0 1 0 1
Neighs:        32698.1 ave       37566 max       24860 min
Histogram: 1 0 0 0 1 2 0 1 2 1

Total # of neighbors = 261585
Ave neighs/atom = 677.68135
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 6.65822620007493
variable C2pos equal ${d2}
variable C2pos equal 29.1584490573149
variable C3pos equal ${d3}
variable C3pos equal 13.0900520930531
variable C4pos equal ${d4}
variable C4pos equal 17.3980465340372
variable C5pos equal ${d5}
variable C5pos equal -17.9260852372485
variable C6pos equal ${d6}
variable C6pos equal -6.23012362239219

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(-46.081588719161+${C1pos})
variable C11 equal 0.5*(-46.081588719161+6.65822620007493)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(-61.1516493986342+${C2pos})
variable C21 equal 0.5*(-61.1516493986342+29.1584490573149)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(-51.6640068257105+${C3pos})
variable C31 equal 0.5*(-51.6640068257105+13.0900520930531)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-12.6124249900994+${C4pos})
variable C41 equal 0.5*(-12.6124249900994+17.3980465340372)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(16.5574153089324+${C5pos})
variable C51 equal 0.5*(16.5574153089324+-17.9260852372485)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-11.2180938975561+${C6pos})
variable C61 equal 0.5*(-11.2180938975561+-6.23012362239219)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.589
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.589
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.13589 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.13589 yz delta 0.00018 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.45311 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.45311 17.3161) with tilt (-7.3464 -0.3071 -0.01782)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 134.9 | 135.7 | 136.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.50281     -44728.499      50596.188      0              3895.5268    
       100   325.92053     -44742.867      14316.773      5456.7918      3895.5268    
       200   320.39006     -44752.637      15997.702      8011.4659      3895.5268    
       300   287.80865     -44743.915      13215.308      5286.4603      3895.5268    
       400   289.99725     -44753.336      21102.66       3389.9526      3895.5268    
       500   291.38459     -44745.526      19433.38       5936.9308      3895.5268    
       600   309.66776     -44748.163      2617.6016      8184.5742      3895.5268    
       700   296.81984     -44717.61       2905.0516      5598.3652      3895.5268    
       800   312.38535     -44730.584      18126.85       7676.5403      3895.5268    
       900   291.34289     -44717.604     -2924.5116     -151.93358      3895.5268    
      1000   303.72785     -44757.387      637.15178      5434.3381      3895.5268    
      1100   296.50804     -44778.073     -2747.898       5694.5649      3895.5268    
      1200   264.37406     -44748.659     -2851.2615      2238.4765      3895.5268    
      1300   316.89506     -44785.037      9199.5677      2002.158       3895.5268    
      1400   290.26979     -44736.164     -3533.8045      4500.959       3895.5268    
      1500   301.21771     -44744.079      4658.6478     -745.85521      3895.5268    
      1600   280.47209     -44752.838      5536.0597     -2993.1464      3895.5268    
      1700   283.49771     -44773.917     -5937.1911      1888.3107      3895.5268    
      1800   290.13655     -44763.258     -354.62141      4699.7476      3895.5268    
      1900   307.77602     -44768.433     -4385.5974      3842.7828      3895.5268    
      2000   303.12926     -44760.829     -6554.6822      4967.594       3895.5268    
      2100   321.09004     -44785.021      9907.3746     -591.0926       3895.5268    
      2200   292.13883     -44776.08       8724.82        1793.1536      3895.5268    
      2300   290.21876     -44797.181     -760.82219     -2614.0399      3895.5268    
      2400   282.34165     -44768.792      17087.555      1205.654       3895.5268    
      2500   295.43244     -44760.941      5185.5184      4552.9224      3895.5268    
      2600   277.20971     -44729.522      14791.927      8172.966       3895.5268    
      2700   322.61222     -44770.956      7156.5881      6872.5031      3895.5268    
      2800   302.22302     -44756.962      3558.0914      3497.16        3895.5268    
      2900   272.70741     -44766.958     -1129.6675      2336.472       3895.5268    
      3000   277.56006     -44782.144      10804.656      6938.1353      3895.5268    
Loop time of 156.459 on 8 procs for 3000 steps with 386 atoms

Performance: 0.828 ns/day, 28.974 hours/ns, 19.174 timesteps/s, 7.401 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 91.731     | 111.33     | 130.33     | 151.1 | 71.16
Bond    | 0.007292   | 0.0080496  | 0.0085705  |   0.4 |  0.01
Neigh   | 7.1842     | 8.5791     | 9.9435     |  39.8 |  5.48
Comm    | 2.9398     | 21.919     | 41.494     | 340.2 | 14.01
Output  | 0.0064752  | 0.0081335  | 0.0092891  |   1.1 |  0.01
Modify  | 13.191     | 14.543     | 15.966     |  31.1 |  9.30
Other   |            | 0.07073    |            |       |  0.05

Nlocal:          48.25 ave          57 max          40 min
Histogram: 1 1 0 1 2 1 0 0 0 2
Nghost:           3486 ave        3529 max        3453 min
Histogram: 1 0 1 2 1 2 0 0 0 1
Neighs:        33387.1 ave       39065 max       28146 min
Histogram: 1 1 0 1 2 1 0 0 0 2

Total # of neighbors = 267097
Ave neighs/atom = 691.96114
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 134.9 | 135.6 | 136.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   277.56006     -44782.144      10804.634      0              3895.5268    
       100   283.64691     -44767.575      8233.2658      2498.7607      3895.5268    
       200   290.88064     -44750.523      442.88834      6891.6873      3895.5268    
       300   298.71913     -44758.599      10941.148      4094.4852      3895.5268    
       400   307.20318     -44777.74       3164.0967      66.10448       3895.5268    
       500   291.61668     -44770.3        5002.9295      3422.2431      3895.5268    
       600   278.19533     -44762.453      8375.6013     -3684.2421      3895.5268    
       700   301.90512     -44768.23       1395.5572      2059.7906      3895.5268    
       800   297.43003     -44737.156      2955.2139      6522.8914      3895.5268    
       900   302.74853     -44747.129     -1918.5267      7272.6818      3895.5268    
      1000   283.1526      -44748.288      6429.7984      4729.1373      3895.5268    
      1100   294.39025     -44780.088     -3824.3054     -4907.4112      3895.5268    
      1200   317.53096     -44803.712      24685.815      6965.0282      3895.5268    
      1300   296.10565     -44770.181      17777.617      3650.5084      3895.5268    
      1400   290.33878     -44749.037      13804.041      4129.2585      3895.5268    
      1500   299.58725     -44745.366      7791.198       2038.0551      3895.5268    
      1600   311.30504     -44749.752     -4911.5441      3500.6554      3895.5268    
      1700   300.70295     -44752.328      7639.473      -1368.4512      3895.5268    
      1800   283.24566     -44758.419      7630.9274      3193.8202      3895.5268    
      1900   295.26921     -44766.822      10309.566      1497.6172      3895.5268    
      2000   301.83855     -44748.417      3791.3314      4827.003       3895.5268    
      2100   336.50851     -44776.335      8311.0871      9406.4452      3895.5268    
      2200   283.19577     -44758.067      2432.1642      1179.3418      3895.5268    
      2300   285.60529     -44773.877      6225.3003      5157.9611      3895.5268    
      2400   307.87855     -44777.384      19980.31       4681.054       3895.5268    
      2500   306.1066      -44762.585      12050.77       2999.0365      3895.5268    
      2600   294.08109     -44758.103      8236.8696      4566.4363      3895.5268    
      2700   286.27673     -44780.22       15688.388      305.33699      3895.5268    
      2800   273.86645     -44779.903     -2637.7086     -4352.138       3895.5268    
      2900   298.02324     -44788.89       6179.024       3273.1488      3895.5268    
      3000   303.55555     -44782.468      5907.0636     -4623.135       3895.5268    
Loop time of 158.37 on 8 procs for 3000 steps with 386 atoms

Performance: 0.818 ns/day, 29.328 hours/ns, 18.943 timesteps/s, 7.312 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 91.566     | 115.91     | 133.65     | 168.5 | 73.19
Bond    | 0.0072287  | 0.0081122  | 0.0085994  |   0.5 |  0.01
Neigh   | 7.2081     | 8.9116     | 10.013     |  43.4 |  5.63
Comm    | 1.0947     | 18.823     | 43.142     | 417.5 | 11.89
Output  | 0.0012381  | 0.0014519  | 0.0023541  |   0.9 |  0.00
Modify  | 13.496     | 14.644     | 16.382     |  34.7 |  9.25
Other   |            | 0.07149    |            |       |  0.05

Nlocal:          48.25 ave          57 max          38 min
Histogram: 1 0 0 1 3 0 1 0 0 2
Nghost:        3489.38 ave        3548 max        3462 min
Histogram: 3 1 0 1 1 1 0 0 0 1
Neighs:        33371.4 ave       39110 max       26717 min
Histogram: 1 0 0 1 3 0 1 0 0 2

Total # of neighbors = 266971
Ave neighs/atom = 691.63472
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -68.879642467987
variable C2neg equal ${d2}
variable C2neg equal -11.8908522759137
variable C3neg equal ${d3}
variable C3neg equal -47.7647512484492
variable C4neg equal ${d4}
variable C4neg equal -13.8364059157949
variable C5neg equal ${d5}
variable C5neg equal 15.2258990821963
variable C6neg equal ${d6}
variable C6neg equal 6.31296387876891

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.589
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.13589 yz delta ${deltayz} remap units box
change_box all y delta 0 0.13589 yz delta -0.00018 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.72489 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.72489 17.3161) with tilt (-7.3464 -0.3071 -0.01818)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.4 | 133 | 133.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.50281     -44734.723     -40612.786      0              3974.2243    
       100   309.58048     -44726.322      7687.473       296.40938      3974.2243    
       200   305.78489     -44728.997      7060.0642      4720.9203      3974.2243    
       300   284.39697     -44726.496     -1790.0714      2904.4227      3974.2243    
       400   302.90559     -44748.689     -7964.0183      2.4658861      3974.2243    
       500   290.90536     -44719.465     -5127.0252      189.52905      3974.2243    
       600   322.8577      -44733.186     -6777.9714      3336.0776      3974.2243    
       700   322.67759     -44732.534     -8320.9426     -2219.4093      3974.2243    
       800   294.68792     -44724.582     -11906.475      1171.9083      3974.2243    
       900   277.75045     -44729.549     -3004.3938      4042.4448      3974.2243    
      1000   311.453       -44775.348     -4429.3917      733.49064      3974.2243    
      1100   296.22703     -44755.81      -1692.1843     -1380.1765      3974.2243    
      1200   301.37694     -44738.508      5938.6424     -393.13386      3974.2243    
      1300   301.87758     -44721.437     -3428.3203      6220.4956      3974.2243    
      1400   301.86245     -44716.49      -10049.733      4736.6062      3974.2243    
      1500   302.91237     -44739.921     -8804.0253     -102.10414      3974.2243    
      1600   285.87378     -44746.933      252.5783      -480.99152      3974.2243    
      1700   295.31344     -44755.437     -11758.778      818.30327      3974.2243    
      1800   299.95973     -44748.74      -13696.411     -4358.1616      3974.2243    
      1900   306.17308     -44743.471      5876.2567      2370.1194      3974.2243    
      2000   310.90345     -44712.879     -6334.4873     -1179.729       3974.2243    
      2100   305.02919     -44716.192     -5992.8273     -4698.1033      3974.2243    
      2200   304.0202      -44748.343      5244.3292     -3489.4661      3974.2243    
      2300   300.4019      -44757.934     -3398.3003     -1595.0792      3974.2243    
      2400   285.48181     -44751.957      9590.0359     -3162.0485      3974.2243    
      2500   294.27915     -44741.402      1150.336      -1312.4896      3974.2243    
      2600   313.4925      -44734.388      5959.7764     -154.22212      3974.2243    
      2700   294.26517     -44723.38       4544.5035      3553.0028      3974.2243    
      2800   304.34149     -44748.864      691.31871      5755.8051      3974.2243    
      2900   311.51931     -44775.789     -12894.796     -917.8322       3974.2243    
      3000   301.34735     -44771.407      6704.1348      3103.7162      3974.2243    
Loop time of 152.62 on 8 procs for 3000 steps with 386 atoms

Performance: 0.849 ns/day, 28.263 hours/ns, 19.657 timesteps/s, 7.587 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.752     | 111.97     | 128.47     | 166.0 | 73.37
Bond    | 0.0071909  | 0.0082259  | 0.0087531  |   0.5 |  0.01
Neigh   | 7.0065     | 8.6348     | 9.6577     |  42.6 |  5.66
Comm    | 1.1668     | 17.661     | 40.861     | 417.5 | 11.57
Output  | 0.0064971  | 0.0083246  | 0.0096232  |   1.2 |  0.01
Modify  | 13.206     | 14.263     | 15.923     |  33.8 |  9.35
Other   |            | 0.07132    |            |       |  0.05

Nlocal:          48.25 ave          59 max          40 min
Histogram: 1 0 1 3 1 0 0 1 0 1
Nghost:        3413.38 ave        3433 max        3389 min
Histogram: 2 0 1 0 0 1 1 0 1 2
Neighs:        32692.4 ave       39548 max       27468 min
Histogram: 1 0 1 3 1 0 0 1 0 1

Total # of neighbors = 261539
Ave neighs/atom = 677.56218
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.4 | 133 | 133.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   301.34735     -44771.407      6704.1333      0              3974.2243    
       100   299.40255     -44763.33      -7262.8561      4820.3355      3974.2243    
       200   324.77929     -44758.827      2401.0443      4003.3083      3974.2243    
       300   315.3692      -44730.482      4058.7326      501.57156      3974.2243    
       400   305.2542      -44732.802      7053.6086     -1907.3688      3974.2243    
       500   294.59002     -44740.249     -3502.9064     -502.60066      3974.2243    
       600   293.06358     -44752.212      15134.41       1434.1071      3974.2243    
       700   295.49507     -44760.019      5606.3561      4205.4154      3974.2243    
       800   297.36292     -44764.454      3167.2488      5981.731       3974.2243    
       900   307.1585      -44769.592     -1886.8041      1951.9784      3974.2243    
      1000   297.74816     -44751.932     -1422.9219     -1164.1212      3974.2243    
      1100   307.78171     -44762.129      13257.895      3155.2277      3974.2243    
      1200   293.07604     -44757.069     -5447.8985      1921.7585      3974.2243    
      1300   287.5211      -44774.296     -3379.1315     -5147.7939      3974.2243    
      1400   303.79064     -44798.004     -505.3437       2247.9104      3974.2243    
      1500   294.91042     -44760.135     -1994.6477     -264.36883      3974.2243    
      1600   321.90481     -44766.182      1808.809       1615.8681      3974.2243    
      1700   297.2753      -44741.106     -492.47834      4753.768       3974.2243    
      1800   295.3799      -44748.762      7677.2653      3657.7006      3974.2243    
      1900   290.70479     -44780.063      6514.578       3396.6392      3974.2243    
      2000   286.18284     -44784.432      4807.751       7536.3819      3974.2243    
      2100   299.95146     -44786.008     -3647.1856      1049.5037      3974.2243    
      2200   290.56638     -44761.236      6991.9459     -816.59077      3974.2243    
      2300   306.43231     -44773.437      16165.01       4211.674       3974.2243    
      2400   306.00974     -44770.784     -10929.294      1406.5157      3974.2243    
      2500   300.47365     -44764.294     -19464.488     -837.61786      3974.2243    
      2600   302.38189     -44772.59      -10402.468     -4619.6399      3974.2243    
      2700   296.9149      -44785.904      2603.451      -2896.5436      3974.2243    
      2800   283.92988     -44796.775     -1629.8729      4235.1075      3974.2243    
      2900   292.85047     -44801.826      607.74351      5666.3367      3974.2243    
      3000   319.57063     -44787.518     -8314.0582      527.33054      3974.2243    
Loop time of 151.555 on 8 procs for 3000 steps with 386 atoms

Performance: 0.855 ns/day, 28.066 hours/ns, 19.795 timesteps/s, 7.641 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.317     | 107.72     | 127.38     | 170.4 | 71.08
Bond    | 0.0070723  | 0.0081269  | 0.0086022  |   0.5 |  0.01
Neigh   | 6.9877     | 8.3899     | 9.8384     |  43.9 |  5.54
Comm    | 1.3784     | 21.035     | 40.421     | 385.4 | 13.88
Output  | 0.0012913  | 0.001519   | 0.0024471  |   0.9 |  0.00
Modify  | 12.842     | 14.329     | 15.759     |  34.1 |  9.45
Other   |            | 0.06989    |            |       |  0.05

Nlocal:          48.25 ave          58 max          40 min
Histogram: 1 0 0 4 1 0 0 1 0 1
Nghost:        3418.12 ave        3451 max        3392 min
Histogram: 2 1 0 1 0 1 0 2 0 1
Neighs:        32698.9 ave       38830 max       27459 min
Histogram: 1 0 0 4 1 0 0 1 0 1

Total # of neighbors = 261591
Ave neighs/atom = 677.69689
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 16.6925502757613
variable C2pos equal ${d2}
variable C2pos equal 142.467288828369
variable C3pos equal ${d3}
variable C3pos equal 37.9546909867349
variable C4pos equal ${d4}
variable C4pos equal -5.25852264194427
variable C5pos equal ${d5}
variable C5pos equal -6.40028581570855
variable C6pos equal ${d6}
variable C6pos equal -2.18475705275488

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(-68.879642467987+${C1pos})
variable C12 equal 0.5*(-68.879642467987+16.6925502757613)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(-11.8908522759137+${C2pos})
variable C22 equal 0.5*(-11.8908522759137+142.467288828369)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(-47.7647512484492+${C3pos})
variable C32 equal 0.5*(-47.7647512484492+37.9546909867349)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-13.8364059157949+${C4pos})
variable C42 equal 0.5*(-13.8364059157949+-5.25852264194427)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(15.2258990821963+${C5pos})
variable C52 equal 0.5*(15.2258990821963+-6.40028581570855)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(6.31296387876891+${C6pos})
variable C62 equal 0.5*(6.31296387876891+-2.18475705275488)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.3161
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.3161
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.173161 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.589 17.142939) with tilt (-7.3464 -0.3071 -0.018)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 135.4 | 136.1 | 137.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.50281     -44736.677      46187.9        0              3895.5268    
       100   323.24186     -44744.862      11664.566      6353.5929      3895.5268    
       200   321.04141     -44749.607      5253.4479      6784.3963      3895.5268    
       300   285.27612     -44733.94       10368.489      6497.1958      3895.5268    
       400   283.8485      -44747.547     -5068.2599      3795.433       3895.5268    
       500   277.27622     -44736.72       11429.428      6122.273       3895.5268    
       600   295.80435     -44735.559     -3024.6719      8167.9672      3895.5268    
       700   309.92427     -44733.634      10892.814      3490.3465      3895.5268    
       800   303.00117     -44725.079      3781.003       4772.6264      3895.5268    
       900   298.41642     -44737.256      599.84868      7613.7938      3895.5268    
      1000   288.56841     -44741.93       12039.52       9139.6045      3895.5268    
      1100   301.1469      -44765.185     -11002.477      1417.2001      3895.5268    
      1200   287.2345      -44740.637      4111.8502      1338.2777      3895.5268    
      1300   310.18449     -44747.012      15788.936      6248.0824      3895.5268    
      1400   305.56063     -44732.74       7430.4669      4244.6446      3895.5268    
      1500   308.40093     -44753.51       6768.8788      2893.158       3895.5268    
      1600   274.48361     -44744.88      -3778.8287      3288.7612      3895.5268    
      1700   297.10316     -44767.24       2960.9731      5762.0053      3895.5268    
      1800   293.71774     -44739.078      5128.8619      6010.4265      3895.5268    
      1900   317.25992     -44753.75       697.57109      7441.1577      3895.5268    
      2000   305.46242     -44743.074     -122.43654      7343.6591      3895.5268    
      2100   292.2186      -44741.968      7415.6971      9723.1354      3895.5268    
      2200   294.8796      -44773.032      11058.501      5021.6571      3895.5268    
      2300   291.13184     -44776.778      11812.478      7853.8331      3895.5268    
      2400   297.96726     -44736.651     -2919.7848      6187.9711      3895.5268    
      2500   305.41087     -44735.974      12756.581      3921.1474      3895.5268    
      2600   309.47214     -44749.995      3948.3245      2804.7864      3895.5268    
      2700   309.43203     -44769.166      5707.9461      2237.9069      3895.5268    
      2800   282.09829     -44752.322      8855.7685      6726.2116      3895.5268    
      2900   298.2872      -44776.744     -2586.495       2261.7665      3895.5268    
      3000   286.60867     -44757.953     -1737.1753      1459.0848      3895.5268    
Loop time of 158.088 on 8 procs for 3000 steps with 386 atoms

Performance: 0.820 ns/day, 29.276 hours/ns, 18.977 timesteps/s, 7.325 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.529     | 111.1      | 133.4      | 184.7 | 70.28
Bond    | 0.0072025  | 0.0081688  | 0.0085704  |   0.5 |  0.01
Neigh   | 7.1308     | 8.5509     | 9.9748     |  46.4 |  5.41
Comm    | 1.1931     | 23.481     | 46.075     | 401.4 | 14.85
Output  | 0.0067335  | 0.0085937  | 0.0099411  |   1.2 |  0.01
Modify  | 13.397     | 14.871     | 16.274     |  35.8 |  9.41
Other   |            | 0.06999    |            |       |  0.04

Nlocal:          48.25 ave          55 max          41 min
Histogram: 1 0 1 1 0 3 0 0 0 2
Nghost:        3483.88 ave        3506 max        3470 min
Histogram: 2 1 1 2 0 0 0 0 1 1
Neighs:        33363.5 ave       37652 max       28664 min
Histogram: 1 0 1 1 1 2 0 0 0 2

Total # of neighbors = 266908
Ave neighs/atom = 691.4715
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 135.4 | 136.1 | 137.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   286.60867     -44757.953     -1737.2131      0              3895.5268    
       100   301.21574     -44772.199      20627.283      14623.062      3895.5268    
       200   303.59944     -44749.053      3686.8428      4245.5606      3895.5268    
       300   315.03948     -44735.168      6162.0955      8689.7194      3895.5268    
       400   328.58466     -44762.739      18965.681      6357.6527      3895.5268    
       500   287.36098     -44742.196      3169.9532      3004.2236      3895.5268    
       600   296.55285     -44759.463      11889.375      5059.4699      3895.5268    
       700   294.72496     -44758.179      12131.105      7628.938       3895.5268    
       800   292.36471     -44755.69       5959.7784      7717.962       3895.5268    
       900   314.78548     -44757.888      3829.2915      5745.7672      3895.5268    
      1000   307.18341     -44722.325     -2130.3679      6995.9103      3895.5268    
      1100   298.51628     -44727.243     -5674.4665      1714.743       3895.5268    
      1200   304.56896     -44758.075      3579.0354      3727.0428      3895.5268    
      1300   295.77809     -44761.658      4317.4926      10861.878      3895.5268    
      1400   283.96791     -44749.528      4218.9065      3942.0961      3895.5268    
      1500   294.54504     -44759.475      4582.3337      1076.0178      3895.5268    
      1600   291.28167     -44756.381      3103.0013      4634.6222      3895.5268    
      1700   287.5267      -44740.401      12443.494      4493.2004      3895.5268    
      1800   311.21207     -44746.178     -7367.4653      1535.1673      3895.5268    
      1900   310.04637     -44742.481      11577.621     -88.321774      3895.5268    
      2000   305.10515     -44769.355      1103.4481      2729.1122      3895.5268    
      2100   301.36225     -44780.315      12152.82       248.84499      3895.5268    
      2200   285.81914     -44758.56       5256.3235      4687.6866      3895.5268    
      2300   295.56836     -44758.341      6116.5462      878.52947      3895.5268    
      2400   299.39797     -44737.258     -600.48505      7077.6739      3895.5268    
      2500   337.47361     -44748.43       9555.1033      5118.3764      3895.5268    
      2600   310.93256     -44746.146      6722.5639      5132.788       3895.5268    
      2700   314.2016      -44775.995      3426.2777      2037.2411      3895.5268    
      2800   290.14666     -44762.834     -3453.8164     -1258.7868      3895.5268    
      2900   303.16985     -44785.547      1791.8479      2536.5275      3895.5268    
      3000   302.84353     -44783.119      6178.3142      116.13149      3895.5268    
Loop time of 157.305 on 8 procs for 3000 steps with 386 atoms

Performance: 0.824 ns/day, 29.131 hours/ns, 19.071 timesteps/s, 7.361 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 87.838     | 110.94     | 132.51     | 185.4 | 70.52
Bond    | 0.0073406  | 0.0081009  | 0.0085844  |   0.4 |  0.01
Neigh   | 7.1015     | 8.5279     | 9.9573     |  46.7 |  5.42
Comm    | 1.4851     | 23.042     | 46.164     | 406.5 | 14.65
Output  | 0.0012585  | 0.0014852  | 0.002303   |   0.8 |  0.00
Modify  | 13.294     | 14.721     | 16.132     |  36.1 |  9.36
Other   |            | 0.07012    |            |       |  0.04

Nlocal:          48.25 ave          59 max          39 min
Histogram: 1 0 0 2 1 2 1 0 0 1
Nghost:        3452.25 ave        3465 max        3437 min
Histogram: 1 0 1 1 0 1 1 1 0 2
Neighs:        33374.9 ave       40348 max       27279 min
Histogram: 1 0 1 2 0 2 1 0 0 1

Total # of neighbors = 266999
Ave neighs/atom = 691.70725
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -20.8590246232204
variable C2neg equal ${d2}
variable C2neg equal -7.89670747265041
variable C3neg equal ${d3}
variable C3neg equal 3.91901086031732
variable C4neg equal ${d4}
variable C4neg equal -16.5971707224743
variable C5neg equal ${d5}
variable C5neg equal 0.395184314547827
variable C6neg equal ${d6}
variable C6neg equal 5.02873213347578

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.3161
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.173161 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.589 17.489261) with tilt (-7.3464 -0.3071 -0.018)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.7 | 133.4 | 134.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.50281     -44732.044     -36914.738      0              3974.2243    
       100   319.46551     -44736.71       2558.5208     -1036.0514      3974.2243    
       200   323.07866     -44751.025      3152.1691      4787.4349      3974.2243    
       300   286.88988     -44736.453      3710.2752      990.77671      3974.2243    
       400   299.41916     -44763.032     -6026.4245      69.597085      3974.2243    
       500   296.73208     -44751.568      2914.4734      1368.4523      3974.2243    
       600   297.24339     -44728.703     -1553.1571     -1136.2366      3974.2243    
       700   307.36963     -44727.23       2795.2529      2263.929       3974.2243    
       800   302.32368     -44724.48      -694.93052      2228.2992      3974.2243    
       900   299.31615     -44735.687     -4645.9089      2138.9845      3974.2243    
      1000   317.54686     -44775.861     -5824.4042      2878.0555      3974.2243    
      1100   295.61027     -44768.596      6982.048       2838.3863      3974.2243    
      1200   293.18347     -44751.345      5448.893       2768.0521      3974.2243    
      1300   309.41425     -44742.681      5220.1203     -270.28175      3974.2243    
      1400   317.17059     -44742.388      2652.0248      4114.768       3974.2243    
      1500   271.28261     -44713.344     -9826.7752     -6262.3031      3974.2243    
      1600   282.39879     -44749.586     -7769.2866     -1685.477       3974.2243    
      1700   295.39591     -44763.493      1737.0149     -65.624883      3974.2243    
      1800   293.1874      -44755.499     -244.6859      -2389.1209      3974.2243    
      1900   301.09035     -44757.651     -879.85733     -1958.0343      3974.2243    
      2000   303.53358     -44759.517      8408.0601     -2130.4812      3974.2243    
      2100   310.16402     -44782.667     -5686.3562     -2546.6336      3974.2243    
      2200   291.53902     -44778.22      -3960.2376      6191.8799      3974.2243    
      2300   294.89803     -44775.108     -4308.2504      1126.0629      3974.2243    
      2400   295.38762     -44747.587     -4845.7489     -4641.2111      3974.2243    
      2500   308.67753     -44748.752      743.92085      1835.9185      3974.2243    
      2600   322.34532     -44764.734     -6495.9082     -2138.0155      3974.2243    
      2700   298.13594     -44775.055      9269.9338     -5169.8926      3974.2243    
      2800   280.09856     -44768.18       4957.9373     -3191.6813      3974.2243    
      2900   288.81832     -44758.622     -2824.1039      383.44223      3974.2243    
      3000   302.77896     -44749.065      27018.396      5272.4076      3974.2243    
Loop time of 153.857 on 8 procs for 3000 steps with 386 atoms

Performance: 0.842 ns/day, 28.492 hours/ns, 19.499 timesteps/s, 7.526 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.013     | 107.71     | 129.45     | 182.7 | 70.01
Bond    | 0.0072809  | 0.008154   | 0.0086326  |   0.4 |  0.01
Neigh   | 6.979      | 8.3516     | 9.7678     |  45.5 |  5.43
Comm    | 1.2026     | 22.93      | 44.646     | 395.5 | 14.90
Output  | 0.0065639  | 0.0083335  | 0.0096162  |   1.2 |  0.01
Modify  | 13.372     | 14.78      | 16.141     |  34.8 |  9.61
Other   |            | 0.06886    |            |       |  0.04

Nlocal:          48.25 ave          56 max          40 min
Histogram: 1 1 0 1 1 1 1 0 0 2
Nghost:         3418.5 ave        3448 max        3390 min
Histogram: 1 1 2 0 0 1 1 0 0 2
Neighs:        32718.5 ave       37672 max       27544 min
Histogram: 1 1 0 1 1 1 1 0 0 2

Total # of neighbors = 261748
Ave neighs/atom = 678.10363
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.7 | 133.4 | 134.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.77896     -44749.065      27018.381      0              3974.2243    
       100   287.12534     -44743.109     -5009.5566     -1965.2389      3974.2243    
       200   273.66548     -44755.371     -3195.7105      1176.4492      3974.2243    
       300   283.43554     -44789.921     -2985.6115      607.83584      3974.2243    
       400   278.06362     -44773.797     -3083.5331      2367.0652      3974.2243    
       500   277.89306     -44757.512     -7178.3205     -3898.3226      3974.2243    
       600   297.78014     -44762.379     -415.37537      1747.6175      3974.2243    
       700   310.23985     -44755.833      3668.5733      15.0277        3974.2243    
       800   311.96775     -44749.112      7319.144       4150.5686      3974.2243    
       900   283.82095     -44746.772      8789.642       5300.34        3974.2243    
      1000   283.32956     -44765.032      10239.234      1580.4545      3974.2243    
      1100   298.3714      -44777.191     -6538.7805      3815.0462      3974.2243    
      1200   311.29541     -44785.873     -5546.2209      7183.0841      3974.2243    
      1300   300.66638     -44782.546     -4305.8162      1704.7005      3974.2243    
      1400   278.94123     -44775.23       7533.8392     -1649.608       3974.2243    
      1500   304.94315     -44799.789      7230.6933      1361.3033      3974.2243    
      1600   307.43136     -44770.043      6167.5477     -3896.7568      3974.2243    
      1700   317.91157     -44774.199     -3713.5934      4719.5142      3974.2243    
      1800   307.58967     -44774.546      16918.973      3183.5183      3974.2243    
      1900   304.97535     -44777.618      2179.657       1967.9999      3974.2243    
      2000   294.96622     -44796.727      5432.2964      1038.2922      3974.2243    
      2100   281.59824     -44796.132      9839.2734      493.1729       3974.2243    
      2200   284.88842     -44782.171     -3400.7633     -3442.0604      3974.2243    
      2300   327.13514     -44802.073      14860.538      1565.2056      3974.2243    
      2400   293.77264     -44763.249      11071.936      4367.1592      3974.2243    
      2500   300.59164     -44765.283     -2752.3262     -534.01536      3974.2243    
      2600   308.15328     -44766.356      3026.257       2211.6736      3974.2243    
      2700   305.86463     -44759.186     -5918.2923      4414.762       3974.2243    
      2800   297.70293     -44752.337     -211.0824      -680.60707      3974.2243    
      2900   303.53032     -44781.587     -4245.007       1690.6407      3974.2243    
      3000   294.27557     -44793.114      3636.5478     -1478.8655      3974.2243    
Loop time of 152.446 on 8 procs for 3000 steps with 386 atoms

Performance: 0.850 ns/day, 28.231 hours/ns, 19.679 timesteps/s, 7.596 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.149     | 107.64     | 128.22     | 180.5 | 70.61
Bond    | 0.0073916  | 0.0082173  | 0.0087859  |   0.5 |  0.01
Neigh   | 6.9835     | 8.374      | 9.8289     |  45.6 |  5.49
Comm    | 1.4396     | 22.002     | 43.514     | 398.9 | 14.43
Output  | 0.0012484  | 0.0015115  | 0.0023441  |   0.8 |  0.00
Modify  | 12.899     | 14.349     | 15.73      |  35.4 |  9.41
Other   |            | 0.06937    |            |       |  0.05

Nlocal:          48.25 ave          58 max          39 min
Histogram: 1 0 1 2 1 1 0 0 0 2
Nghost:        3421.38 ave        3458 max        3393 min
Histogram: 1 1 1 1 2 0 0 0 1 1
Neighs:        32695.9 ave       38974 max       26805 min
Histogram: 1 0 1 2 1 1 0 0 0 2

Total # of neighbors = 261567
Ave neighs/atom = 677.63472
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 37.020331842096
variable C2pos equal ${d2}
variable C2pos equal -31.7645828964956
variable C3pos equal ${d3}
variable C3pos equal 11.7107246857981
variable C4pos equal ${d4}
variable C4pos equal 9.3771583443788
variable C5pos equal ${d5}
variable C5pos equal -5.47351868342345
variable C6pos equal ${d6}
variable C6pos equal -3.73595737925354

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(-20.8590246232204+${C1pos})
variable C13 equal 0.5*(-20.8590246232204+37.020331842096)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(-7.89670747265041+${C2pos})
variable C23 equal 0.5*(-7.89670747265041+-31.7645828964956)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(3.91901086031732+${C3pos})
variable C33 equal 0.5*(3.91901086031732+11.7107246857981)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-16.5971707224743+${C4pos})
variable C43 equal 0.5*(-16.5971707224743+9.3771583443788)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(0.395184314547827+${C5pos})
variable C53 equal 0.5*(0.395184314547827+-5.47351868342345)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(5.02873213347578+${C6pos})
variable C63 equal 0.5*(5.02873213347578+-3.73595737925354)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.3161
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.3161
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.173161 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.191161)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134 | 134.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.50281     -44748.712      2132.9288      0              3934.8755    
       100   306.71667     -44732.583      4272.1416      2417.3428      3934.8755    
       200   316.4728      -44739.033      12557.226      4880.9839      3934.8755    
       300   300.56409     -44742.034      8350.9045      3806.7294      3934.8755    
       400   304.82115     -44764.894      8293.1088      5540.1546      3934.8755    
       500   293.73162     -44755.569      4979.8553     -178.98394      3934.8755    
       600   308.15145     -44764.559      612.989        4620.0706      3934.8755    
       700   296.89948     -44739.045      5902.3298      1491.3385      3934.8755    
       800   309.56509     -44738.092     -3486.7039      3401.486       3934.8755    
       900   307.0253      -44726.185      13037.903      4276.9703      3934.8755    
      1000   300.57944     -44737.588      7858.0975      9004.1544      3934.8755    
      1100   282.16316     -44743.117     -4133.86        9565.6472      3934.8755    
      1200   295.35921     -44752.432     -2111.8731      4177.8559      3934.8755    
      1300   303.76022     -44737.342      11888.539      3714.8358      3934.8755    
      1400   296.39842     -44725.098      2179.7321      3374.5273      3934.8755    
      1500   288.59663     -44741.963      5051.7774      2937.5624      3934.8755    
      1600   281.95143     -44751.736     -271.42516      2452.7748      3934.8755    
      1700   305.65905     -44773.329      11042.774      4251.2644      3934.8755    
      1800   314.41192     -44775.571      8181.5368      5617.2877      3934.8755    
      1900   293.63293     -44745.605      9576.6685      1947.9511      3934.8755    
      2000   299.58894     -44741.916      9689.8057      8596.7535      3934.8755    
      2100   293.48421     -44733.917      6336.6775     -830.98981      3934.8755    
      2200   296.56893     -44750.954      7217.0105      3458.9474      3934.8755    
      2300   298.01688     -44757.908      5628.6763      7186.6116      3934.8755    
      2400   293.80187     -44745.741      5988.4117      2393.5332      3934.8755    
      2500   297.56868     -44727.928      9360.5793      5747.0301      3934.8755    
      2600   309.03914     -44726.122     -13646.578      2128.2149      3934.8755    
      2700   301.20377     -44735.732      10529.218      8879.9935      3934.8755    
      2800   288.27178     -44755.296     -8366.8252     -762.73392      3934.8755    
      2900   289.8377      -44753.478      6242.2039      242.57752      3934.8755    
      3000   301.03572     -44759.105      11808.697      1888.7671      3934.8755    
Loop time of 155.223 on 8 procs for 3000 steps with 386 atoms

Performance: 0.835 ns/day, 28.745 hours/ns, 19.327 timesteps/s, 7.460 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.809     | 109.07     | 130.63     | 182.3 | 70.27
Bond    | 0.0074425  | 0.0083394  | 0.0089733  |   0.5 |  0.01
Neigh   | 7.0679     | 8.511      | 9.9287     |  46.5 |  5.48
Comm    | 1.2466     | 22.793     | 45.079     | 398.3 | 14.68
Output  | 0.0067518  | 0.0083827  | 0.0095511  |   1.1 |  0.01
Modify  | 13.31      | 14.758     | 16.188     |  35.9 |  9.51
Other   |            | 0.0696     |            |       |  0.04

Nlocal:          48.25 ave          58 max          41 min
Histogram: 2 0 2 0 2 0 0 0 1 1
Nghost:        3482.62 ave        3507 max        3465 min
Histogram: 1 0 1 3 0 2 0 0 0 1
Neighs:        33060.6 ave       39367 max       28199 min
Histogram: 2 0 0 2 2 0 0 0 1 1

Total # of neighbors = 264485
Ave neighs/atom = 685.1943
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.6 | 134.5 | 135.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   301.03572     -44759.105      11808.616      0              3934.8755    
       100   293.87555     -44752.92       2946.0709     -1934.7137      3934.8755    
       200   282.27017     -44730.697     -1022.5209      3559.1973      3934.8755    
       300   320.10004     -44738.435     -4752.5253      5899.2206      3934.8755    
       400   327.21181     -44750.657     -3226.7494     -3664.5748      3934.8755    
       500   305.6325      -44754.339      468.42355     -4010.8773      3934.8755    
       600   299.70279     -44761.651      8229.3887     -1748.9206      3934.8755    
       700   314.00787     -44775.827      14384.725      1376.6735      3934.8755    
       800   277.78055     -44733.083     -88.234157      4836.2956      3934.8755    
       900   314.0885      -44738.031      17556.237      4045.0523      3934.8755    
      1000   316.28787     -44728.143      13579.505      13416.393      3934.8755    
      1100   318.43069     -44748.39       11073.127      6359.5489      3934.8755    
      1200   305.97091     -44753.607     -4653.5644      1173.3103      3934.8755    
      1300   295.04078     -44747.79      -1553.9262     -2398.7064      3934.8755    
      1400   311.69936     -44766.592      13066.96      -3984.51        3934.8755    
      1500   307.38197     -44775.18       9389.04       -1952.9422      3934.8755    
      1600   288.90562     -44797.37      -6784.3496      1785.9177      3934.8755    
      1700   284.49712     -44788.534      4979.7767      505.42424      3934.8755    
      1800   307.05987     -44789.226      7419.5911      4086.7505      3934.8755    
      1900   307.3725      -44775.455      12409.104      653.08891      3934.8755    
      2000   305.90725     -44767.83       2879.0194      3484.9682      3934.8755    
      2100   305.99352     -44769.508      19023.574      5949.4992      3934.8755    
      2200   293.81993     -44783.703      4800.3965      2514.1834      3934.8755    
      2300   282.98484     -44781.824      13338.287      3726.706       3934.8755    
      2400   286.01679     -44756.891     -2736.2839      3804.1897      3934.8755    
      2500   309.61564     -44765.381      18185.189      4254.7383      3934.8755    
      2600   316.85932     -44775.82       12171.618      2474.6811      3934.8755    
      2700   303.31371     -44776.121      9762.6752      7492.9015      3934.8755    
      2800   278.5598      -44775.012     -11355.33       3001.8207      3934.8755    
      2900   276.77739     -44774.098      3017.6759     -470.37298      3934.8755    
      3000   312.92376     -44767.382      4497.4572     -1517.1554      3934.8755    
Loop time of 155.125 on 8 procs for 3000 steps with 386 atoms

Performance: 0.835 ns/day, 28.727 hours/ns, 19.339 timesteps/s, 7.465 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 87.505     | 109.43     | 130.52     | 182.5 | 70.54
Bond    | 0.0072235  | 0.0082385  | 0.0087358  |   0.5 |  0.01
Neigh   | 7.1117     | 8.5469     | 10.027     |  46.4 |  5.51
Comm    | 1.4821     | 22.568     | 44.514     | 401.6 | 14.55
Output  | 0.0012267  | 0.0014403  | 0.0022455  |   0.8 |  0.00
Modify  | 13.027     | 14.502     | 15.924     |  36.2 |  9.35
Other   |            | 0.06959    |            |       |  0.04

Nlocal:          48.25 ave          59 max          41 min
Histogram: 2 0 1 2 1 0 0 1 0 1
Nghost:        3469.75 ave        3495 max        3424 min
Histogram: 1 0 1 0 0 1 1 1 0 3
Neighs:        33050.2 ave       39944 max       28290 min
Histogram: 2 0 1 2 1 0 0 1 0 1

Total # of neighbors = 264402
Ave neighs/atom = 684.97927
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -37.4083036193631
variable C2neg equal ${d2}
variable C2neg equal 13.4644532354752
variable C3neg equal ${d3}
variable C3neg equal 2.30743330693143
variable C4neg equal ${d4}
variable C4neg equal -7.95632010813323
variable C5neg equal ${d5}
variable C5neg equal 4.80766553879713
variable C6neg equal ${d6}
variable C6neg equal -10.7354147553797

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.3161
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.173161 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 0.155161)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134.1 | 134.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.50281     -44742.033      3340.9522      0              3934.8755    
       100   319.13443     -44742.708      10791.146      3323.174       3934.8755    
       200   319.03541     -44742.765      1761.434       7260.0675      3934.8755    
       300   288.27982     -44725.219      1678.4879      6119.1892      3934.8755    
       400   291.17783     -44736.121      4144.2704      1983.2414      3934.8755    
       500   308.53468     -44751.457      10363.4        3105.0271      3934.8755    
       600   320.75094     -44754.432      14586.37       3788.6173      3934.8755    
       700   323.41993     -44761.996      4928.7717      2051.5752      3934.8755    
       800   313.30951     -44759.693     -7535.223      -508.66701      3934.8755    
       900   289.95022     -44735.861      5993.8282      4462.0783      3934.8755    
      1000   291.46024     -44744.706      19050.259      3121.6144      3934.8755    
      1100   293.67348     -44758.46       1404.397      -1072.9097      3934.8755    
      1200   289.69142     -44742.616      7173.5021     -906.03394      3934.8755    
      1300   299.58735     -44733.835      12370.527      2596.5097      3934.8755    
      1400   323.08885     -44750.919      13048.004      4911.5677      3934.8755    
      1500   295.28881     -44740.257      4253.7744      1722.7358      3934.8755    
      1600   288.60057     -44763.662     -3480.9303     -4360.8433      3934.8755    
      1700   285.94596     -44761.853     -4700.2842     -2887.6295      3934.8755    
      1800   311.7939      -44769.5        5504.9025      3684.1586      3934.8755    
      1900   299.77874     -44747.299     -3535.1988     -1861.6597      3934.8755    
      2000   295.52847     -44743.209     -3557.7561     -583.59373      3934.8755    
      2100   301.25424     -44745.912      6709.1446      5262.598       3934.8755    
      2200   316.39421     -44740.048     -2904.4763      630.63364      3934.8755    
      2300   295.39195     -44720.238      9543.2202      3358.764       3934.8755    
      2400   305.37959     -44761.371     -7108.9871     -1033.4582      3934.8755    
      2500   280.60642     -44749.485     -404.76575      1688.7222      3934.8755    
      2600   283.54198     -44754.455      2419.292       5451.7984      3934.8755    
      2700   307.36592     -44761.539      872.71827      2639.6708      3934.8755    
      2800   317.51951     -44736.803     -7509.4899      2972.648       3934.8755    
      2900   315.25317     -44738.285     -7073.5225      127.02967      3934.8755    
      3000   300.95625     -44748.4       -46.689851      387.77         3934.8755    
Loop time of 155.72 on 8 procs for 3000 steps with 386 atoms

Performance: 0.832 ns/day, 28.837 hours/ns, 19.265 timesteps/s, 7.436 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.774     | 109.01     | 131.1      | 184.2 | 70.01
Bond    | 0.0073355  | 0.0082256  | 0.0086298  |   0.5 |  0.01
Neigh   | 7.0915     | 8.5088     | 9.9311     |  46.0 |  5.46
Comm    | 1.1461     | 23.216     | 45.473     | 398.7 | 14.91
Output  | 0.0064584  | 0.0082457  | 0.0095733  |   1.2 |  0.01
Modify  | 13.434     | 14.896     | 16.303     |  35.4 |  9.57
Other   |            | 0.06952    |            |       |  0.04

Nlocal:          48.25 ave          56 max          43 min
Histogram: 2 0 1 2 1 0 0 0 0 2
Nghost:           3438 ave        3464 max        3412 min
Histogram: 1 0 2 0 0 3 0 1 0 1
Neighs:        33046.8 ave       37846 max       29657 min
Histogram: 2 0 2 1 1 0 0 0 0 2

Total # of neighbors = 264374
Ave neighs/atom = 684.90674
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.4 | 134.1 | 134.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   300.95625     -44748.4       -46.739454      0              3934.8755    
       100   302.2514      -44744.669     -9244.7795      4056.4286      3934.8755    
       200   300.34679     -44730.213      14148.097      3030.1189      3934.8755    
       300   318.30215     -44736.64       8901.4772      3023.5777      3934.8755    
       400   304.85289     -44738.643     -211.74459      6084.7741      3934.8755    
       500   311.8829      -44771.014      356.85619      4397.7549      3934.8755    
       600   287.10974     -44750.658     -2505.6766      1605.3551      3934.8755    
       700   293.77506     -44740.726      4790.4813     -676.24002      3934.8755    
       800   331.44298     -44741.283      4533.6986      4223.7064      3934.8755    
       900   301.62824     -44717.114     -366.15885      3895.2889      3934.8755    
      1000   309.768       -44753.55       4148.5909      5623.7245      3934.8755    
      1100   282.32992     -44739.948     -3474.1344     -1307.8063      3934.8755    
      1200   297.25944     -44753.4        4065.7615      1281.1276      3934.8755    
      1300   310.24135     -44752.787     -1145.7984     -1634.0287      3934.8755    
      1400   311.40167     -44726.749      15759.789     -1874.1648      3934.8755    
      1500   329.66006     -44715.234     -5981.5307      4183.3032      3934.8755    
      1600   331.60184     -44745.959      8955.1125      2513.1276      3934.8755    
      1700   308.32058     -44741.102     -10344.125      6285.4712      3934.8755    
      1800   307.38413     -44756.822      6531.6477      2439.9423      3934.8755    
      1900   287.22364     -44756.976      8635.3392      5297.7965      3934.8755    
      2000   298.67161     -44774.775     -7473.3801      3753.9286      3934.8755    
      2100   305.5226      -44765.618     -4130.2872     -2063.6661      3934.8755    
      2200   311.60125     -44736.996      12236.605      488.81415      3934.8755    
      2300   307.92386     -44735.393      10034.358      3487.3543      3934.8755    
      2400   300.33096     -44755.389     -5868.8945      2981.9118      3934.8755    
      2500   279.17028     -44739.039      9474.9162      6258.5924      3934.8755    
      2600   317.46961     -44777.636      8051.4356      182.54695      3934.8755    
      2700   315.25801     -44763.478      2627.7392      2202.8769      3934.8755    
      2800   328.04232     -44742.537      8193.0571     -5126.508       3934.8755    
      2900   316.78257     -44733.999      11396.698     -2445.5495      3934.8755    
      3000   289.68098     -44741.689     -828.13908     -3415.7801      3934.8755    
Loop time of 155.648 on 8 procs for 3000 steps with 386 atoms

Performance: 0.833 ns/day, 28.824 hours/ns, 19.274 timesteps/s, 7.440 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.792     | 109.17     | 131        | 182.5 | 70.14
Bond    | 0.0074266  | 0.0082869  | 0.0087433  |   0.4 |  0.01
Neigh   | 7.0746     | 8.5025     | 9.9001     |  45.5 |  5.46
Comm    | 1.3097     | 23.135     | 45.53      | 396.1 | 14.86
Output  | 0.0012694  | 0.0015387  | 0.0023972  |   0.9 |  0.00
Modify  | 13.376     | 14.766     | 16.18      |  35.1 |  9.49
Other   |            | 0.06968    |            |       |  0.04

Nlocal:          48.25 ave          58 max          39 min
Histogram: 1 0 0 2 2 1 0 1 0 1
Nghost:        3445.75 ave        3491 max        3400 min
Histogram: 1 0 0 3 1 1 0 0 0 2
Neighs:        33025.1 ave       39076 max       27082 min
Histogram: 1 0 0 2 2 0 1 0 1 1

Total # of neighbors = 264201
Ave neighs/atom = 684.45855
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 56.6461188618938
variable C2pos equal ${d2}
variable C2pos equal 67.0923316562054
variable C3pos equal ${d3}
variable C3pos equal 61.5895583543204
variable C4pos equal ${d4}
variable C4pos equal 30.649015035398
variable C5pos equal ${d5}
variable C5pos equal 1.96514611387183
variable C6pos equal ${d6}
variable C6pos equal -14.2303725300966

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-37.4083036193631+${C1pos})
variable C14 equal 0.5*(-37.4083036193631+56.6461188618938)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(13.4644532354752+${C2pos})
variable C24 equal 0.5*(13.4644532354752+67.0923316562054)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(2.30743330693143+${C3pos})
variable C34 equal 0.5*(2.30743330693143+61.5895583543204)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(-7.95632010813323+${C4pos})
variable C44 equal 0.5*(-7.95632010813323+30.649015035398)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(4.80766553879713+${C5pos})
variable C54 equal 0.5*(4.80766553879713+1.96514611387183)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-10.7354147553797+${C6pos})
variable C64 equal 0.5*(-10.7354147553797+-14.2303725300966)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.3161
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.3161
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.173161 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.480261 -0.018)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134 | 134.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.50281     -44745.774      4698.3239      0              3934.8755    
       100   315.98079     -44741.2        9385.0096      3306.4618      3934.8755    
       200   317.54034     -44739.472      3353.2574      3544.8286      3934.8755    
       300   292.32227     -44729.111      9121.511       4921.8402      3934.8755    
       400   289.94443     -44737.104      11723.202      4207.7525      3934.8755    
       500   291.07392     -44737.233      8242.5804      3972.6144      3934.8755    
       600   310.44431     -44747.438      8944.1553      2383.2338      3934.8755    
       700   303.88616     -44737.702      5239.2668      1287.9241      3934.8755    
       800   301.29072     -44739.53      -9936.4427      4304.1856      3934.8755    
       900   296.0773      -44743.522      2505.208       4686.7103      3934.8755    
      1000   295.1879      -44759.943     -13244.727     -1681.2344      3934.8755    
      1100   287.12011     -44761.926      1689.9991      2410.2526      3934.8755    
      1200   301.40475     -44767.654      1283.4249      4703.4264      3934.8755    
      1300   300.67413     -44741.95       17126.986      3467.8294      3934.8755    
      1400   311.4305      -44743.5       -2369.1071     -1084.4948      3934.8755    
      1500   295.83627     -44742.322     -4380.2453      6720.6417      3934.8755    
      1600   268.36759     -44742.742      414.17678     -2264.935       3934.8755    
      1700   285.72319     -44772.888      402.7656      -1053.2247      3934.8755    
      1800   289.77822     -44769.079     -3109.8782      3349.9386      3934.8755    
      1900   286.93469     -44754.837      12702.388      62.584692      3934.8755    
      2000   298.42383     -44756.862      12891.845      7132.7312      3934.8755    
      2100   308.48659     -44751.117      15197.992      2228.7669      3934.8755    
      2200   306.47966     -44728.442     -8833.6526      1998.1209      3934.8755    
      2300   323.69515     -44741.096      11719.083      3319.907       3934.8755    
      2400   298.91942     -44745.947      7302.9363     -748.22896      3934.8755    
      2500   295.74224     -44762.38      -9578.7726     -4743.4007      3934.8755    
      2600   297.43652     -44761.24      -4585.371       605.36626      3934.8755    
      2700   296.62458     -44734.447      7880.5792      5384.6386      3934.8755    
      2800   324.53457     -44748.609      6007.2945     -1.1519083      3934.8755    
      2900   297.37363     -44741.952      6144.076      -2763.0701      3934.8755    
      3000   282.49929     -44741.304     -3777.7242     -820.56133      3934.8755    
Loop time of 155.127 on 8 procs for 3000 steps with 386 atoms

Performance: 0.835 ns/day, 28.727 hours/ns, 19.339 timesteps/s, 7.465 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 89.444     | 107.28     | 130.69     | 168.7 | 69.16
Bond    | 0.0073705  | 0.0082269  | 0.0085701  |   0.4 |  0.01
Neigh   | 7.1207     | 8.3517     | 9.9553     |  43.4 |  5.38
Comm    | 0.99063    | 24.387     | 42.268     | 353.5 | 15.72
Output  | 0.0064489  | 0.0085263  | 0.010096   |   1.4 |  0.01
Modify  | 13.431     | 15.018     | 16.283     |  32.7 |  9.68
Other   |            | 0.06899    |            |       |  0.04

Nlocal:          48.25 ave          55 max          42 min
Histogram: 1 1 1 1 1 0 1 0 0 2
Nghost:           3462 ave        3496 max        3431 min
Histogram: 1 0 1 2 0 1 2 0 0 1
Neighs:        33038.4 ave       37406 max       29073 min
Histogram: 1 1 1 1 1 0 1 0 0 2

Total # of neighbors = 264307
Ave neighs/atom = 684.73316
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134.3 | 135.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   282.49929     -44741.304     -3777.7156      0              3934.8755    
       100   288.081       -44737.439      8830.1654      4587.5935      3934.8755    
       200   314.01053     -44734.84       12930.526      6530.8469      3934.8755    
       300   322.82868     -44734.811      4465.1276      2605.9616      3934.8755    
       400   313.62868     -44746.536     -2352.5675      1867.1296      3934.8755    
       500   303.79545     -44754.487      11600.224      7998.6241      3934.8755    
       600   295.62729     -44767.306     -1047.6669     -467.40338      3934.8755    
       700   308.27718     -44784.831      4214.1348      881.04237      3934.8755    
       800   302.31938     -44761.225      6822.8479      2653.7388      3934.8755    
       900   321.16725     -44747.871      15242.022      136.68908      3934.8755    
      1000   316.95694     -44746.622      13346.442      4902.4264      3934.8755    
      1100   284.24222     -44730.257     -5295.1333      498.36731      3934.8755    
      1200   288.64455     -44745.928      8664.0375      2543.9245      3934.8755    
      1300   304.31351     -44767.123      2451.4746     -580.83547      3934.8755    
      1400   297.13047     -44776.709      12771.017      1732.5893      3934.8755    
      1500   284.5761      -44791.684     -301.41088      4215.2518      3934.8755    
      1600   277.06824     -44777.559      4110.9281      5067.2858      3934.8755    
      1700   301.29434     -44764.488      11089.453      6976.8956      3934.8755    
      1800   298.14857     -44750.443     -3475.3479      3978.3679      3934.8755    
      1900   302.25856     -44758.092      5658.5313      1562.1149      3934.8755    
      2000   308.52001     -44774.635      2847.9703      6489.3166      3934.8755    
      2100   274.07204     -44764.228      3718.3767      1714.1587      3934.8755    
      2200   273.94192     -44758.729      924.91669      2354.2724      3934.8755    
      2300   306.31382     -44767.758     -140.05219      88.238432      3934.8755    
      2400   295.01101     -44751.021     -3045.6434      3529.2841      3934.8755    
      2500   313.59178     -44771.828      6140.7437      3828.2238      3934.8755    
      2600   312.66861     -44783.957      7232.4522      378.94912      3934.8755    
      2700   267.74583     -44764.067      10953.289     -23.431014      3934.8755    
      2800   296.83605     -44787.189      5498.5497      1890.9611      3934.8755    
      2900   300.06972     -44766.832      8832.9861      757.50584      3934.8755    
      3000   286.21558     -44744.809      12390.8        3623.6584      3934.8755    
Loop time of 156.806 on 8 procs for 3000 steps with 386 atoms

Performance: 0.826 ns/day, 29.038 hours/ns, 19.132 timesteps/s, 7.385 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 103.53     | 118.85     | 129.28     |  73.2 | 75.80
Bond    | 0.0078395  | 0.0082085  | 0.0086673  |   0.3 |  0.01
Neigh   | 8.2255     | 9.3724     | 10.253     |  19.4 |  5.98
Comm    | 3.473      | 13.863     | 29.151     | 213.8 |  8.84
Output  | 0.0012567  | 0.0014726  | 0.002623   |   1.1 |  0.00
Modify  | 13.768     | 14.629     | 15.824     |  16.2 |  9.33
Other   |            | 0.07782    |            |       |  0.05

Nlocal:          48.25 ave          58 max          41 min
Histogram: 1 1 0 2 1 1 1 0 0 1
Nghost:        3453.88 ave        3497 max        3429 min
Histogram: 2 1 1 2 0 0 0 1 0 1
Neighs:        33026.9 ave       39330 max       28442 min
Histogram: 1 1 0 2 1 1 1 0 0 1

Total # of neighbors = 264215
Ave neighs/atom = 684.49482
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 14.680991497242
variable C2neg equal ${d2}
variable C2neg equal 39.7972629241709
variable C3neg equal ${d3}
variable C3neg equal 31.436918625949
variable C4neg equal ${d4}
variable C4neg equal -3.85584302341036
variable C5neg equal ${d5}
variable C5neg equal 12.9177005559251
variable C6neg equal ${d6}
variable C6neg equal -5.39724608632233

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.3161
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.173161 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.133939 -0.018)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134 | 134.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.50281     -44746.443     -107.87415      0              3934.8755    
       100   319.91438     -44746.845      4592.5119      2314.8795      3934.8755    
       200   323.70963     -44746.933      8999.253       5296.0365      3934.8755    
       300   297.502       -44737.945      12075.415      4782.2628      3934.8755    
       400   280.13769     -44733.677      4690.4966      1344.7503      3934.8755    
       500   292.95308     -44742.311      13063.127      3312.6123      3934.8755    
       600   290.13733     -44721.579      8634.0808      4818.7369      3934.8755    
       700   307.9149      -44731.397     -1777.7349      4746.6457      3934.8755    
       800   299.67232     -44729.399      7665.2145      4723.6619      3934.8755    
       900   292.30805     -44740.847      5020.0476      2513.1567      3934.8755    
      1000   288.43213     -44757.622     -1320.344       3311.8692      3934.8755    
      1100   294.31861     -44769.127      2071.7612      913.98957      3934.8755    
      1200   289.82446     -44746.684      5694.0797      2586.1001      3934.8755    
      1300   320.01018     -44759.153      2002.4417      1151.1221      3934.8755    
      1400   298.00519     -44726.531      6327.2132      4598.3344      3934.8755    
      1500   292.27142     -44747.124      9203.7506      393.60914      3934.8755    
      1600   297.91607     -44774.251      4142.1899      753.64859      3934.8755    
      1700   284.39873     -44751.303     -745.24447     -2375.2611      3934.8755    
      1800   298.41357     -44750.204      4199.207       2073.6227      3934.8755    
      1900   293.84184     -44732.911      1984.3974      341.96142      3934.8755    
      2000   283.84456     -44719.322      2635.9922      847.83508      3934.8755    
      2100   307.6518      -44749.498      6378.7881      125.99745      3934.8755    
      2200   303.43441     -44751.654     -12731.666      3576.0374      3934.8755    
      2300   293.55871     -44758.417      2646.7946      5033.0692      3934.8755    
      2400   284.51512     -44783.147      9268.4441      4163.7358      3934.8755    
      2500   274.46257     -44784.937     -4908.4942      2319.944       3934.8755    
      2600   292.10876     -44786.3        760.48259      974.4788       3934.8755    
      2700   284.84057     -44760.261      10357.453     -1887.9563      3934.8755    
      2800   292.75207     -44749.136      7631.7217      1289.8898      3934.8755    
      2900   320.1945      -44772.192      2307.1396      1178.7701      3934.8755    
      3000   294.55362     -44754.461      12063.069      8519.8686      3934.8755    
Loop time of 151.744 on 8 procs for 3000 steps with 386 atoms

Performance: 0.854 ns/day, 28.101 hours/ns, 19.770 timesteps/s, 7.631 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.137     | 116.26     | 127.6      | 157.6 | 76.61
Bond    | 0.0076303  | 0.008109   | 0.0087497  |   0.5 |  0.01
Neigh   | 7.0033     | 9.3653     | 10.395     |  44.4 |  6.17
Comm    | 1.3619     | 12.68      | 42.792     | 476.9 |  8.36
Output  | 0.0065169  | 0.0087158  | 0.010039   |   1.4 |  0.01
Modify  | 12.326     | 13.349     | 15.737     |  37.6 |  8.80
Other   |            | 0.07809    |            |       |  0.05

Nlocal:          48.25 ave          57 max          37 min
Histogram: 1 0 1 0 1 1 2 0 0 2
Nghost:        3443.62 ave        3482 max        3421 min
Histogram: 1 1 3 1 0 0 0 1 0 1
Neighs:        33047.5 ave       38712 max       25736 min
Histogram: 1 0 1 0 1 1 2 0 0 2

Total # of neighbors = 264380
Ave neighs/atom = 684.92228
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134 | 134.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.55362     -44754.461      12063.091      0              3934.8755    
       100   289.85211     -44750.155      2094.5882      8050.1814      3934.8755    
       200   307.44985     -44758.078      431.60196      2913.689       3934.8755    
       300   326.40235     -44754.316      17218.968      9132.2724      3934.8755    
       400   339.54762     -44772.292     -603.19833      7224.7981      3934.8755    
       500   295.7955      -44758.52       4477.5668      4388.5011      3934.8755    
       600   311.6634      -44787.609      7973.5353      2945.7475      3934.8755    
       700   305.78061     -44784.206      8745.5688      4029.7748      3934.8755    
       800   293.25473     -44768.401      7858.3273      5956.0068      3934.8755    
       900   276.54678     -44739.522      703.8931       2028.537       3934.8755    
      1000   312.67346     -44757.192      9887.4281      5187.392       3934.8755    
      1100   313.72756     -44755.654     -362.49216      5748.7065      3934.8755    
      1200   286.78143     -44754.613     -6114.7182      1678.0929      3934.8755    
      1300   283.95662     -44769.157      358.97419      6327.9315      3934.8755    
      1400   283.03932     -44768.005     -278.18423      5663.0326      3934.8755    
      1500   303.97966     -44781.992      0.28369712     8925.5411      3934.8755    
      1600   296.89695     -44765.082      3070.4691      9200.2508      3934.8755    
      1700   295.8627      -44762.337      4598.9892      5295.81        3934.8755    
      1800   304.09136     -44769.45       2127.8404      7988.5297      3934.8755    
      1900   302.4738      -44763.966      3548.5873      10537.401      3934.8755    
      2000   303.2773      -44774.044      536.38033      7757.1628      3934.8755    
      2100   275.12522     -44774.313      8126.3967      13056.981      3934.8755    
      2200   283.68845     -44787.986      13624.773      6310.9394      3934.8755    
      2300   299.24837     -44780.205      4791.9099      10002.371      3934.8755    
      2400   310.76422     -44776.696      11582.439      3447.9327      3934.8755    
      2500   295.24222     -44762.2        2565.8275      4455.4606      3934.8755    
      2600   300.18636     -44778.563      14006.271      10968.887      3934.8755    
      2700   290.27323     -44771.307      14899.723      8008.441       3934.8755    
      2800   318.05429     -44791.697      5783.9554      5356.8015      3934.8755    
      2900   300.83624     -44749.012      10805.35       5536.4153      3934.8755    
      3000   318.11847     -44765.876      552.41498      5566.5056      3934.8755    
Loop time of 152.288 on 8 procs for 3000 steps with 386 atoms

Performance: 0.851 ns/day, 28.202 hours/ns, 19.699 timesteps/s, 7.604 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.073     | 116.36     | 128.15     | 158.5 | 76.41
Bond    | 0.0076596  | 0.0081087  | 0.0089476  |   0.5 |  0.01
Neigh   | 6.9957     | 9.3473     | 10.387     |  43.9 |  6.14
Comm    | 1.2132     | 12.979     | 43.259     | 474.6 |  8.52
Output  | 0.0012351  | 0.001364   | 0.001897   |   0.6 |  0.00
Modify  | 12.482     | 13.514     | 15.889     |  36.9 |  8.87
Other   |            | 0.07824    |            |       |  0.05

Nlocal:          48.25 ave          58 max          39 min
Histogram: 1 0 1 1 2 1 0 1 0 1
Nghost:        3470.12 ave        3510 max        3446 min
Histogram: 1 1 2 2 0 0 0 1 0 1
Neighs:        33019.6 ave       39138 max       27132 min
Histogram: 1 0 1 1 2 1 0 1 0 1

Total # of neighbors = 264157
Ave neighs/atom = 684.34456
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -34.3668906525249
variable C2pos equal ${d2}
variable C2pos equal 20.1495040404175
variable C3pos equal ${d3}
variable C3pos equal 2.30490791116212
variable C4pos equal ${d4}
variable C4pos equal 16.1147868111356
variable C5pos equal ${d5}
variable C5pos equal 10.7525080605464
variable C6pos equal ${d6}
variable C6pos equal -2.83645603517473

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(14.680991497242+${C1pos})
variable C15 equal 0.5*(14.680991497242+-34.3668906525249)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(39.7972629241709+${C2pos})
variable C25 equal 0.5*(39.7972629241709+20.1495040404175)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(31.436918625949+${C3pos})
variable C35 equal 0.5*(31.436918625949+2.30490791116212)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-3.85584302341036+${C4pos})
variable C45 equal 0.5*(-3.85584302341036+16.1147868111356)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(12.9177005559251+${C5pos})
variable C55 equal 0.5*(12.9177005559251+10.7525080605464)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-5.39724608632233+${C6pos})
variable C65 equal 0.5*(-5.39724608632233+-2.83645603517473)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.589

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.589
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.13589 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.48229 -0.3071 -0.018)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134.2 | 135 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.50281     -44746.666      5182.3559      0              3934.8755    
       100   316.48506     -44743.664      9309.8575      3409.5381      3934.8755    
       200   315.14776     -44741.881      5707.0779      5362.2345      3934.8755    
       300   290.96026     -44736.675     -4006.252       4582.8727      3934.8755    
       400   290.87404     -44756.532      12476.228      3990.6323      3934.8755    
       500   283.25474     -44749.584      8309.4894      459.96917      3934.8755    
       600   300.79235     -44747.329     -4991.209       4114.9484      3934.8755    
       700   309.52121     -44732.58       2445.6566      2157.6493      3934.8755    
       800   310.34802     -44720.885      9484.6923      5028.353       3934.8755    
       900   311.69789     -44740.316      11925.512      4339.3522      3934.8755    
      1000   311.05815     -44771.98       6212.9712      7850.7199      3934.8755    
      1100   291.27609     -44770.74      -2381.6454     -144.55987      3934.8755    
      1200   280.35254     -44758.395      11190.36       1881.1104      3934.8755    
      1300   305.25799     -44761.026     -1821.3706      979.08457      3934.8755    
      1400   295.90816     -44745.657      5256.9404     -1609.9985      3934.8755    
      1500   299.87284     -44769.588      1765.1049      3248.7956      3934.8755    
      1600   285.2198      -44779.355     -7641.2124     -269.77678      3934.8755    
      1700   277.81351     -44786.069     -5314.1268     -2060.5828      3934.8755    
      1800   304.70296     -44773.739     -14780.292      933.41202      3934.8755    
      1900   300.19691     -44751.143      8331.4407      1074.6709      3934.8755    
      2000   312.41127     -44771.956      5281.0176      2030.4004      3934.8755    
      2100   296.98321     -44774.025     -6253.2186      2025.8507      3934.8755    
      2200   300.79177     -44792.196      8346.0095     -50.430766      3934.8755    
      2300   290.79639     -44787.082     -1723.5532      4901.3062      3934.8755    
      2400   306.40044     -44779.199      2994.0016      5859.1876      3934.8755    
      2500   287.71871     -44729.982     -1210.6249      1963.9159      3934.8755    
      2600   325.17232     -44774.883     -1617.397       7699.2162      3934.8755    
      2700   291.46232     -44763.687      7368.2361      2230.5199      3934.8755    
      2800   298.78082     -44779.257     -7398.9906      6767.5699      3934.8755    
      2900   293.40008     -44767.535      4757.0869      7006.3861      3934.8755    
      3000   309.74896     -44772.078      3643.0746      3779.3389      3934.8755    
Loop time of 111.725 on 8 procs for 3000 steps with 386 atoms

Performance: 1.160 ns/day, 20.690 hours/ns, 26.852 timesteps/s, 10.365 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 86.345     | 89.74      | 91.48      |  18.3 | 80.32
Bond    | 0.006797   | 0.0076954  | 0.008388   |   0.5 |  0.01
Neigh   | 7.0893     | 7.4365     | 7.5922     |   6.9 |  6.66
Comm    | 2.2379     | 3.9625     | 7.3493     |  86.8 |  3.55
Output  | 0.0048707  | 0.0063805  | 0.0073314  |   1.1 |  0.01
Modify  | 10.356     | 10.5       | 10.841     |   5.8 |  9.40
Other   |            | 0.07175    |            |       |  0.06

Nlocal:          48.25 ave          56 max          41 min
Histogram: 1 0 1 2 1 1 0 0 0 2
Nghost:        3465.62 ave        3489 max        3442 min
Histogram: 1 0 0 1 1 4 0 0 0 1
Neighs:        33085.2 ave       37979 max       28451 min
Histogram: 1 0 1 2 1 1 0 0 0 2

Total # of neighbors = 264682
Ave neighs/atom = 685.70466
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 134.4 | 135.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.74896     -44772.078      3642.9968      0              3934.8755    
       100   309.10347     -44779.33       5682.636       6215.9518      3934.8755    
       200   288.10518     -44780.273      733.60331      8917.4054      3934.8755    
       300   280.45229     -44793.35       5472.8534      6382.947       3934.8755    
       400   292.37936     -44794.61       1717.7844      8304.7397      3934.8755    
       500   309.24272     -44773.597      28418.519      5722.16        3934.8755    
       600   313.21575     -44775.253     -2581.1147      6471.1801      3934.8755    
       700   283.09682     -44762.494     -2148.7358      3201.8251      3934.8755    
       800   290.55065     -44779.004     -2519.7366      1395.272       3934.8755    
       900   311.06685     -44784.594      4305.8247      10117.989      3934.8755    
      1000   301.09673     -44731.611      3056.9359      4740.7385      3934.8755    
      1100   315.40338     -44755.8        3105.0833      2009.4607      3934.8755    
      1200   284.25021     -44746.915     -1854.309      -579.68225      3934.8755    
      1300   309.4832      -44790.239      7554.4439      7072.6476      3934.8755    
      1400   311.94815     -44796.802      15113.423      11146.419      3934.8755    
      1500   276.04002     -44777.716      12058.732      5750.9894      3934.8755    
      1600   277.73412     -44796.765      1432.2661      1120.8852      3934.8755    
      1700   293.1076      -44779.356      8892.088       6038.1462      3934.8755    
      1800   283.288       -44745.835      4103.9313      5213.3069      3934.8755    
      1900   299.67387     -44759.649      780.00066      10316.501      3934.8755    
      2000   290.49999     -44757.621      1978.1503      12262.319      3934.8755    
      2100   304.43697     -44796.714      8751.1338      9180.2787      3934.8755    
      2200   296.89618     -44805.509      11630.446      5281.9672      3934.8755    
      2300   286.79726     -44783.808      7356.2873      7242.498       3934.8755    
      2400   323.38174     -44782.843      17803.219      7108.3826      3934.8755    
      2500   298.83248     -44755.383      9464.231       11446.192      3934.8755    
      2600   303.807       -44773.343      4988.8356      9343.7715      3934.8755    
      2700   293.59027     -44788.223     -3493.1118      9431.5509      3934.8755    
      2800   290.5417      -44792.32      -6213.8805      1220.694       3934.8755    
      2900   299.65087     -44781.74       592.04546      2276.2402      3934.8755    
      3000   309.36234     -44760.474      13354.714      8435.3369      3934.8755    
Loop time of 97.3798 on 8 procs for 3000 steps with 386 atoms

Performance: 1.331 ns/day, 18.033 hours/ns, 30.807 timesteps/s, 11.892 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 76.409     | 77.72      | 79.782     |  11.3 | 79.81
Bond    | 0.0060794  | 0.0068371  | 0.0073932  |   0.5 |  0.01
Neigh   | 7.0466     | 7.1304     | 7.1874     |   1.7 |  7.32
Comm    | 0.59952    | 2.6511     | 3.9748     |  61.2 |  2.72
Output  | 0.0011342  | 0.0012723  | 0.0017618  |   0.5 |  0.00
Modify  | 9.7591     | 9.8039     | 9.8762     |   1.2 | 10.07
Other   |            | 0.06623    |            |       |  0.07

Nlocal:          48.25 ave          56 max          42 min
Histogram: 1 1 1 2 0 1 0 0 0 2
Nghost:        3467.88 ave        3506 max        3448 min
Histogram: 2 1 2 1 0 1 0 0 0 1
Neighs:        33066.9 ave       38072 max       28899 min
Histogram: 1 1 1 2 0 1 0 0 0 2

Total # of neighbors = 264535
Ave neighs/atom = 685.32383
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 63.4353238794973
variable C2neg equal ${d2}
variable C2neg equal 41.3478935109264
variable C3neg equal ${d3}
variable C3neg equal -1.76304598469516
variable C4neg equal ${d4}
variable C4neg equal 8.24435259822735
variable C5neg equal ${d5}
variable C5neg equal 23.3010850991847
variable C6neg equal ${d6}
variable C6neg equal 21.2991172312469

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.589
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.13589 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.21051 -0.3071 -0.018)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.2 | 133.6 | 134.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   309.50281     -44744.854      1193.8428      0              3934.8755    
       100   314.66561     -44738.325      4746.2643      2661.9909      3934.8755    
       200   317.4678      -44735.408      9463.3194      4856.7772      3934.8755    
       300   292.2312      -44723.509      9929.8679      4209.9745      3934.8755    
       400   297.71904     -44744.011      12877.132      2935.2593      3934.8755    
       500   300.97017     -44748.142      8662.1325      3099.278       3934.8755    
       600   304.91976     -44739.613      13146.887      3885.7073      3934.8755    
       700   294.60504     -44724.961      361.30866     -4131.1829      3934.8755    
       800   298.18611     -44734.282     -4084.8197      3399.705       3934.8755    
       900   280.53801     -44724.791      19105.075      5666.8913      3934.8755    
      1000   303.66296     -44758.939      16795.669      3142.6174      3934.8755    
      1100   291.68253     -44746.231     -14168.71       3770.57        3934.8755    
      1200   305.24853     -44747.417     -469.22606      2179.359       3934.8755    
      1300   306.01354     -44734.756      421.3108       3329.1644      3934.8755    
      1400   313.38662     -44739.442      1058.0831      4312.1947      3934.8755    
      1500   316.70595     -44760.909      4268.2275      6782.9613      3934.8755    
      1600   290.88879     -44761.39      -10764.435      1137.2348      3934.8755    
      1700   283.30117     -44751.423      905.82101      2360.3451      3934.8755    
      1800   309.29762     -44757.552      2802.9451      4861.4018      3934.8755    
      1900   299.77067     -44740.798     -1135.3818      6515.2282      3934.8755    
      2000   304.70455     -44749.637      7515.6807      8695.9219      3934.8755    
      2100   316.27455     -44761.366      12857.961      8771.1441      3934.8755    
      2200   300.66016     -44756.365      1739.4838      3175.1591      3934.8755    
      2300   281.39425     -44761.868     -1808.6107      1609.1625      3934.8755    
      2400   297.89698     -44776.809      2291.24        6385.3707      3934.8755    
      2500   292.17444     -44735.991     -9361.8976      3687.5573      3934.8755    
      2600   312.42945     -44743.272     -3689.8677      3262.4037      3934.8755    
      2700   300.54355     -44743.481     -744.45963      6625.3489      3934.8755    
      2800   293.83665     -44747.783     -1832.865       2976.6421      3934.8755    
      2900   292.98912     -44763.462     -4074.271      -1926.8955      3934.8755    
      3000   291.22137     -44780.111      70.359085     -1527.1381      3934.8755    
Loop time of 95.7477 on 8 procs for 3000 steps with 386 atoms

Performance: 1.354 ns/day, 17.731 hours/ns, 31.332 timesteps/s, 12.094 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 74.7       | 76.031     | 78.08      |  12.1 | 79.41
Bond    | 0.0061895  | 0.0070137  | 0.0073644  |   0.4 |  0.01
Neigh   | 6.96       | 7.0181     | 7.0742     |   1.6 |  7.33
Comm    | 0.63118    | 2.6697     | 4.0072     |  64.4 |  2.79
Output  | 0.0042326  | 0.0057508  | 0.0066412  |   1.2 |  0.01
Modify  | 9.9049     | 9.9506     | 9.9906     |   1.0 | 10.39
Other   |            | 0.06556    |            |       |  0.07

Nlocal:          48.25 ave          60 max          42 min
Histogram: 1 2 1 2 0 1 0 0 0 1
Nghost:        3447.12 ave        3478 max        3418 min
Histogram: 2 1 0 1 0 0 0 2 1 1
Neighs:        33044.9 ave       40667 max       29125 min
Histogram: 2 1 1 2 1 0 0 0 0 1

Total # of neighbors = 264359
Ave neighs/atom = 684.86788
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.2 | 133.6 | 134.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.22137     -44780.111      70.341622      0              3934.8755    
       100   282.69731     -44753.866     -294.40155      2048.4764      3934.8755    
       200   301.42824     -44747.732      6849.8792      7735.0118      3934.8755    
       300   293.60436     -44738.081     -3160.6831      186.11546      3934.8755    
       400   304.77977     -44755.19       5759.5358      2881.8993      3934.8755    
       500   283.67677     -44726.35       2035.5338      781.05965      3934.8755    
       600   283.33829     -44714.083     -760.36778      2349.8623      3934.8755    
       700   316.35999     -44732.425     -1481.4405      8027.4679      3934.8755    
       800   303.70772     -44743.571      16221.764      7563.7566      3934.8755    
       900   310.17094     -44771.892      12297.966      8079.4701      3934.8755    
      1000   308.90272     -44777.204     -794.90831      2517.55        3934.8755    
      1100   291.15786     -44758.767     -3158.2293      901.41355      3934.8755    
      1200   293.43604     -44742.627     -10970.657      3812.1725      3934.8755    
      1300   319.4379      -44738.187     -2242.2856      46.053847      3934.8755    
      1400   314.4233      -44740.205      7287.768       4528.2406      3934.8755    
      1500   304.04734     -44755.579     -2553.8453      97.609632      3934.8755    
      1600   280.41637     -44733.394      6414.3886      3447.5513      3934.8755    
      1700   314.42534     -44773.508      9218.7552      7139.3171      3934.8755    
      1800   291.34134     -44759.449     -3832.2814      2820.0895      3934.8755    
      1900   292.6307      -44784.049     -3444.8762     -177.93297      3934.8755    
      2000   284.0425      -44779.182      7260.3161      1051.4117      3934.8755    
      2100   301.02271     -44764.145      434.38059      665.83179      3934.8755    
      2200   294.40639     -44746.318      8480.4947      385.54049      3934.8755    
      2300   283.16634     -44733.585     -2569.3245      1573.4216      3934.8755    
      2400   295.35608     -44752.929     -735.03444      725.31698      3934.8755    
      2500   288.19005     -44769.583     -13739.417      3887.1512      3934.8755    
      2600   274.18413     -44763.738     -2773.0865     -4022.2901      3934.8755    
      2700   293.51512     -44755.154     -12558.193      63.054992      3934.8755    
      2800   300.51204     -44738.978     -755.2226      -1537.4092      3934.8755    
      2900   314.68728     -44759.084      3606.7117     -115.48518      3934.8755    
      3000   293.29635     -44753.46       2633.8385      1898.1105      3934.8755    
Loop time of 95.9573 on 8 procs for 3000 steps with 386 atoms

Performance: 1.351 ns/day, 17.770 hours/ns, 31.264 timesteps/s, 12.068 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 74.656     | 76.161     | 78.433     |  12.6 | 79.37
Bond    | 0.0061856  | 0.0069342  | 0.0071755  |   0.4 |  0.01
Neigh   | 6.9491     | 7.0101     | 7.0742     |   1.8 |  7.31
Comm    | 0.60096    | 2.862      | 4.3758     |  64.7 |  2.98
Output  | 0.0011065  | 0.0012121  | 0.0017361  |   0.6 |  0.00
Modify  | 9.7969     | 9.85       | 9.8964     |   1.2 | 10.26
Other   |            | 0.0657     |            |       |  0.07

Nlocal:          48.25 ave          59 max          41 min
Histogram: 2 0 2 2 0 0 0 0 0 2
Nghost:        3452.12 ave        3476 max        3434 min
Histogram: 1 0 2 1 0 3 0 0 0 1
Neighs:          33030 ave       39978 max       28451 min
Histogram: 2 0 2 2 0 0 0 0 0 2

Total # of neighbors = 264240
Ave neighs/atom = 684.55959
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 2.80312269334456
variable C2pos equal ${d2}
variable C2pos equal 21.3620976249564
variable C3pos equal ${d3}
variable C3pos equal 0.975769056071817
variable C4pos equal ${d4}
variable C4pos equal -2.87191915106871
variable C5pos equal ${d5}
variable C5pos equal -34.4525966474949
variable C6pos equal ${d6}
variable C6pos equal 6.3288841976989

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(63.4353238794973+${C1pos})
variable C16 equal 0.5*(63.4353238794973+2.80312269334456)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(41.3478935109264+${C2pos})
variable C26 equal 0.5*(41.3478935109264+21.3620976249564)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-1.76304598469516+${C3pos})
variable C36 equal 0.5*(-1.76304598469516+0.975769056071817)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(8.24435259822735+${C4pos})
variable C46 equal 0.5*(8.24435259822735+-2.87191915106871)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(23.3010850991847+${C5pos})
variable C56 equal 0.5*(23.3010850991847+-34.4525966474949)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(21.2991172312469+${C6pos})
variable C66 equal 0.5*(21.2991172312469+6.3288841976989)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal -19.711681259543
variable C22all equal ${C22}
variable C22all equal 65.2882182762277
variable C33all equal ${C33}
variable C33all equal 7.81486777305771

variable C44all equal ${C44}
variable C44all equal 11.3463474636324
variable C55all equal ${C55}
variable C55all equal 11.8351043082357
variable C66all equal ${C66}
variable C66all equal 13.8140007144729

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(-26.0935460961128+${C21})
variable C12all equal 0.5*(-26.0935460961128+-15.9966001706596)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(8.0806536094378+${C31})
variable C13all equal 0.5*(8.0806536094378+-19.2869773663287)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(-19.830645184573+${C32})
variable C23all equal 0.5*(-19.830645184573+-4.90503013085715)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(9.61890762126535+${C41})
variable C14all equal 0.5*(9.61890762126535+2.3928107719689)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-9.84294957764145+${C51})
variable C15all equal 0.5*(-9.84294957764145+-0.684334964158051)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(33.1192232864209+${C61})
variable C16all equal 0.5*(33.1192232864209+-8.72410875997415)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(40.2783924458403+${C42})
variable C24all equal 0.5*(40.2783924458403+-9.54746427886958)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(29.9733834822942+${C52})
variable C25all equal 0.5*(29.9733834822942+4.41280663324387)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(31.3549955679414+${C62})
variable C26all equal 0.5*(31.3549955679414+2.06410341300702)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(31.9484958306259+${C43})
variable C34all equal 0.5*(31.9484958306259+-3.61000618904775)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(16.8709132685556+${C53})
variable C35all equal 0.5*(16.8709132685556+-2.53916718443781)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-0.393638464311672+${C63})
variable C36all equal 0.5*(-0.393638464311672+0.64638737711112)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(6.12947189386262+${C54})
variable C45all equal 0.5*(6.12947189386262+3.38640582633448)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(2.68621672357932+${C64})
variable C46all equal 0.5*(2.68621672357932+-12.4828936427382)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-5.5757557741551+${C65})
variable C56all equal 0.5*(-5.5757557741551+-4.11685106074853)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 1:00:34
