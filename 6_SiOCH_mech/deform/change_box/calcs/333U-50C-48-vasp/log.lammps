LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-48-vasp
read_data       ${structure}.data
read_data       333U-50C-48-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.008 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.865 | 6.865 | 6.865 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              344.28356      3999.6146    
         1   300            0              0              344.28356      3999.6146    
Loop time of 5.36076e-05 on 16 procs for 1 steps with 386 atoms

56.4% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.12e-07   | 1.82e-07   | 2.84e-07   |   0.0 |  0.34
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 7.47e-07   | 1.1105e-06 | 1.674e-06  |   0.0 |  2.07
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 5.232e-05  |            |       | 97.59

Nlocal:          48.25 ave          57 max          44 min
Histogram: 1 3 1 0 2 0 0 0 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -0.82 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.8 | 135.9 | 137.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -43252.041      122314.38      0              1.7215889      3934.8755    
       100   698.4055      -44024.262     -1821.2744      20864.087      1.7215889      3934.8755    
       200   527.57421     -44204.218     -1947.2032      9388.297       1.7215889      3934.8755    
       300   431.41236     -44388.41      -10416.889      9534.1838      1.7215889      3934.8755    
       400   349.2883      -44501.16      -1856.996       5985.811       1.7215889      3934.8755    
       500   308.31926     -44590.759      28393.814      10857.697      1.7215889      3934.8755    
       600   308.2885      -44674.702      13308.738      450.39136      1.7215889      3934.8755    
       700   272.96458     -44672.816     -2308.3818     -3224.9749      1.7215889      3934.8755    
       800   283.54115     -44676.345      4169.6506      4348.4014      1.7215889      3934.8755    
       900   307.17404     -44677.556      2261.7062      4567.1491      1.7215889      3934.8755    
      1000   322.87526     -44682.412      12472.683      7079.3867      1.7215889      3934.8755    
      1100   298.57723     -44675.914      7191.1212      6078.2011      1.7215889      3934.8755    
      1200   306.57289     -44727.258      11488.427      1940.7943      1.7215889      3934.8755    
      1300   287.11539     -44749.682     -4165.3468      1800.4471      1.7215889      3934.8755    
      1400   266.99296     -44742.248      13959.629      2017.7697      1.7215889      3934.8755    
      1500   296.88307     -44749.811      1540.9469      3424.3915      1.7215889      3934.8755    
      1600   308.73914     -44728.533      14067.151      2897.7075      1.7215889      3934.8755    
      1700   335.20214     -44742.796      11878.309     -8.4335528      1.7215889      3934.8755    
      1800   297.85016     -44727.26      -1195.9258     -1042.0531      1.7215889      3934.8755    
      1900   293.7155      -44760.787      14366.229      1867.6527      1.7215889      3934.8755    
      2000   287.81495     -44773.041     -5477.543       5833.6367      1.7215889      3934.8755    
Loop time of 102.771 on 16 procs for 2000 steps with 386 atoms

Performance: 0.841 ns/day, 28.547 hours/ns, 19.461 timesteps/s, 7.512 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.615     | 70.012     | 86.604     | 143.6 | 68.12
Bond    | 0.00059029 | 0.00072607 | 0.00084737 |   0.0 |  0.00
Neigh   | 4.6913     | 5.5659     | 6.8763     |  39.4 |  5.42
Comm    | 0.81757    | 17.402     | 28.777     | 287.8 | 16.93
Output  | 0.0010514  | 0.0011944  | 0.0017875  |   0.7 |  0.00
Modify  | 8.4117     | 9.7449     | 10.646     |  30.4 |  9.48
Other   |            | 0.04353    |            |       |  0.04

Nlocal:          48.25 ave          56 max          39 min
Histogram: 1 0 0 0 2 3 0 1 0 1
Nghost:        3448.25 ave        3499 max        3399 min
Histogram: 1 1 0 0 2 1 1 1 0 1
Neighs:        33054.5 ave       37988 max       27072 min
Histogram: 1 0 0 0 2 3 0 1 0 1

Total # of neighbors = 264436
Ave neighs/atom = 685.06736
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-48-vasp_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.7222
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.589
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.3161

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-5833.63667151741)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-5833.63667151741)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-3720.37708523481)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-3720.37708523481)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-3237.42496304645)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-3237.42496304645)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--1621.41825530152)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--1621.41825530152)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-2185.33930750237)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-2185.33930750237)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--5387.04193926932)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--5387.04193926932)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 16.7222
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.7222
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.167222 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.167222 xy delta 0.073464 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.167222 xy delta 0.073464 xz delta 0.003071 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.554978 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.554978 13.589 17.3161) with tilt (-7.272936 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.554978 13.589 17.3161) with tilt (-7.272936 -0.304029 -0.018)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 134 | 136.3 | 138.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.81495     -44757.727      54264.186      0              3895.5268    
       100   279.7512      -44745.946      9669.3365      11490.189      3895.5268    
       200   309.19695     -44751.89       11372.993      8567.3907      3895.5268    
       300   291.63999     -44714.938      2303.3922      9263.5624      3895.5268    
       400   300.50079     -44732.043      2564.0746      5116.4049      3895.5268    
       500   307.87385     -44756.496      8332.374       7568.9491      3895.5268    
       600   296.46405     -44757.908     -1296.6296      12777.28       3895.5268    
       700   286.69137     -44752.771      3943.2894      2446.9814      3895.5268    
       800   291.39136     -44745.205      7343.7733      7578.8654      3895.5268    
       900   314.4391      -44756.331      8092.8231      11035.189      3895.5268    
      1000   276.08529     -44710.385      1548.2388      7563.1453      3895.5268    
      1100   302.67115     -44745.372      3903.7463      9498.3409      3895.5268    
      1200   307.17164     -44771.524     -3942.9247      2632.6163      3895.5268    
      1300   278.70984     -44762.799      11653.918      11176.414      3895.5268    
      1400   299.69403     -44777.484      19521.024      9064.7422      3895.5268    
      1500   289.32408     -44741.94      -19564.227      685.62213      3895.5268    
      1600   303.83545     -44740.942      24904.983      10109.823      3895.5268    
      1700   310.64683     -44754.802      10944.918      10408.208      3895.5268    
      1800   309.57483     -44778.637      10496.202      8598.0869      3895.5268    
      1900   288.24878     -44775.61      -3754.5835      2974.6116      3895.5268    
      2000   287.67661     -44771.055      8805.7954      7260.0063      3895.5268    
Loop time of 104.489 on 16 procs for 2000 steps with 386 atoms

Performance: 0.827 ns/day, 29.025 hours/ns, 19.141 timesteps/s, 7.388 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.826     | 72.907     | 88.43      | 146.7 | 69.77
Bond    | 0.00058815 | 0.00074313 | 0.00090761 |   0.0 |  0.00
Neigh   | 4.7396     | 5.7348     | 6.9258     |  39.7 |  5.49
Comm    | 0.63911    | 16.167     | 30.241     | 311.4 | 15.47
Output  | 0.004586   | 0.0067191  | 0.0081247  |   1.5 |  0.01
Modify  | 8.403      | 9.625      | 10.639     |  31.2 |  9.21
Other   |            | 0.04808    |            |       |  0.05

Nlocal:          48.25 ave          55 max          42 min
Histogram: 1 0 0 2 1 3 0 0 0 1
Nghost:        3430.88 ave        3476 max        3391 min
Histogram: 1 1 1 1 0 1 1 0 1 1
Neighs:        33449.1 ave       37810 max       29454 min
Histogram: 1 0 0 2 1 3 0 0 0 1

Total # of neighbors = 267593
Ave neighs/atom = 693.24611
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 134 | 136.2 | 138.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.67661     -44771.055      8805.7855      0              3895.5268    
       100   301.8747      -44781.646      216.06596      5424.5219      3895.5268    
       200   284.12519     -44732.635      5571.0447      8506.041       3895.5268    
       300   312.81896     -44739.061      1933.826       6361.5677      3895.5268    
       400   314.71596     -44754.674      19923.481      11856.918      3895.5268    
       500   289.14008     -44753.483      3597.8689      7904.4313      3895.5268    
       600   300.2435      -44769.724      10309.361      8377.6842      3895.5268    
       700   299.62955     -44766.55       11093.788      5505.4136      3895.5268    
       800   308.33715     -44760.843     -5558.9958      5535.5052      3895.5268    
       900   329.26766     -44749.229      7800.2538      1644.1819      3895.5268    
      1000   304.83816     -44733.697      4471.3376      436.05588      3895.5268    
      1100   288.98213     -44738.957      4868.5299      9048.085       3895.5268    
      1200   288.30019     -44745.809      1933.6915      2980.9311      3895.5268    
      1300   300.97032     -44758.24      -8742.038       7954.8026      3895.5268    
      1400   301.41938     -44751.467      8322.9287      9500.8059      3895.5268    
      1500   318.8998      -44753.528      12759.632      7092.5816      3895.5268    
      1600   314.94742     -44740.326     -7070.6953      736.30442      3895.5268    
      1700   303.3683      -44738.842      4195.8064      4261.4229      3895.5268    
      1800   294.00786     -44757.952      17444.188      9311.8149      3895.5268    
      1900   292.68034     -44769.321     -6273.9913      1549.6115      3895.5268    
      2000   282.67465     -44747.211      6639.2229      7411.5184      3895.5268    
Loop time of 105.043 on 16 procs for 2000 steps with 386 atoms

Performance: 0.823 ns/day, 29.179 hours/ns, 19.040 timesteps/s, 7.349 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.919     | 76.233     | 88.718     | 132.8 | 72.57
Bond    | 0.00058143 | 0.00073739 | 0.00088435 |   0.0 |  0.00
Neigh   | 4.7908     | 6.0008     | 6.9679     |  35.1 |  5.71
Comm    | 0.63205    | 13.112     | 30.406     | 320.1 | 12.48
Output  | 0.0007994  | 0.00094144 | 0.0013728  |   0.0 |  0.00
Modify  | 8.66       | 9.6495     | 10.888     |  28.2 |  9.19
Other   |            | 0.04559    |            |       |  0.04

Nlocal:          48.25 ave          55 max          43 min
Histogram: 1 2 1 1 0 0 0 1 1 1
Nghost:        3457.38 ave        3508 max        3402 min
Histogram: 2 0 0 1 1 1 0 1 0 2
Neighs:        33411.1 ave       37757 max       29772 min
Histogram: 1 1 2 1 0 0 0 1 1 1

Total # of neighbors = 267289
Ave neighs/atom = 692.45855
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 15.9878864169643
variable C2neg equal ${d2}
variable C2neg equal 3.26036293653659
variable C3neg equal ${d3}
variable C3neg equal 35.8288169994343
variable C4neg equal ${d4}
variable C4neg equal -1.51360972685194
variable C5neg equal ${d5}
variable C5neg equal -0.731296060255644
variable C6neg equal ${d6}
variable C6neg equal 22.9265320771155

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.7222
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.167222 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.167222 xy delta -0.073464 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.167222 xy delta -0.073464 xz delta -0.003071 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.889422 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.889422 13.589 17.3161) with tilt (-7.419864 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.889422 13.589 17.3161) with tilt (-7.419864 -0.310171 -0.018)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133 | 134.7 | 136.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.81495     -44747.396     -49239.043      0              3974.2243    
       100   293.80659     -44754.755     -104.16829     -5218.9266      3974.2243    
       200   303.16505     -44741.096      6794.5155     -995.98668      3974.2243    
       300   313.96081     -44736.195     -3304.8155      634.98183      3974.2243    
       400   305.32617     -44734.647     -3260.7745      142.99531      3974.2243    
       500   293.72483     -44735.947      10036.357      2690.0916      3974.2243    
       600   299.67921     -44759.688      14061.144      1890.673       3974.2243    
       700   281.65538     -44749.853      9484.361      -3083.2989      3974.2243    
       800   300.53824     -44764.608      6306.19       -1877.6474      3974.2243    
       900   299.91159     -44749.361     -7520.498      -4750.2301      3974.2243    
      1000   330.10602     -44771.171      6602.604      -888.93543      3974.2243    
      1100   305.26426     -44744.696     -2959.6246      66.204882      3974.2243    
      1200   293.51398     -44748.291     -6175.1674     -3583.5025      3974.2243    
      1300   296.53092     -44765.331      5452.4448     -3314.0223      3974.2243    
      1400   287.40509     -44751.485     -5392.628      -2811.4826      3974.2243    
      1500   296.26507     -44742.299      2538.3508     -2995.6912      3974.2243    
      1600   307.95281     -44742.527      4248.339      -8022.0717      3974.2243    
      1700   299.85252     -44745.111     -12140.854     -2612.5581      3974.2243    
      1800   314.11389     -44782.803     -7951.3902      887.38726      3974.2243    
      1900   293.51395     -44771.705     -7224.1138     -1913.5793      3974.2243    
      2000   305.18832     -44771.026     -8415.2345     -2748.5957      3974.2243    
Loop time of 102.679 on 16 procs for 2000 steps with 386 atoms

Performance: 0.841 ns/day, 28.522 hours/ns, 19.478 timesteps/s, 7.519 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.653     | 74.506     | 86.644     | 145.8 | 72.56
Bond    | 0.00058152 | 0.00074009 | 0.00093911 |   0.0 |  0.00
Neigh   | 4.6956     | 5.9143     | 6.8632     |  37.7 |  5.76
Comm    | 0.60981    | 12.745     | 29.575     | 352.2 | 12.41
Output  | 0.0044525  | 0.0070722  | 0.0084552  |   1.8 |  0.01
Modify  | 8.4877     | 9.4609     | 10.706     |  30.2 |  9.21
Other   |            | 0.04589    |            |       |  0.04

Nlocal:          48.25 ave          54 max          43 min
Histogram: 2 0 1 1 1 0 1 0 0 2
Nghost:        3428.12 ave        3463 max        3388 min
Histogram: 2 0 1 0 1 0 0 1 1 2
Neighs:        32738.8 ave       36608 max       29388 min
Histogram: 2 0 1 1 1 0 1 0 0 2

Total # of neighbors = 261910
Ave neighs/atom = 678.52332
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.1 | 134.7 | 136.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   305.18832     -44771.026     -8415.1973      0              3974.2243    
       100   284.12783     -44741.117     -4561.0737     -746.63298      3974.2243    
       200   296.16093     -44723.701     -5501.4106     -1948.8348      3974.2243    
       300   328.07191     -44736.98       12879.701     -2374.0851      3974.2243    
       400   291.40361     -44716.012      1316.8528     -2025.5197      3974.2243    
       500   300.74928     -44738.481     -2916.1386     -6175.1276      3974.2243    
       600   295.94162     -44753.11      -4202.6437     -2194.9311      3974.2243    
       700   314.39776     -44786.092      5112.1183     -846.42324      3974.2243    
       800   291.46534     -44769.562      1683.4747     -1508.538       3974.2243    
       900   294.69626     -44778.196      6389.9845     -1445.4838      3974.2243    
      1000   298.3952      -44761.183      15298.021      2079.4762      3974.2243    
      1100   303.0971      -44747.344      805.23999     -2948.351       3974.2243    
      1200   316.06034     -44760.967      3601.7859     -3300.9043      3974.2243    
      1300   290.50916     -44759.266      7539.9033     -5617.7162      3974.2243    
      1400   295.37195     -44785.707     -3193.2647     -4265.9573      3974.2243    
      1500   305.54208     -44786.466     -641.51571      197.19419      3974.2243    
      1600   298.90879     -44770.754      11849.81      -3681.5324      3974.2243    
      1700   283.53253     -44750.451      5290.7846      2884.2979      3974.2243    
      1800   296.38349     -44761.248     -398.78509     -251.79868      3974.2243    
      1900   293.58878     -44751.808     -2600.1236     -868.21896      3974.2243    
      2000   305.84822     -44741.689     -6564.0331     -2162.7005      3974.2243    
Loop time of 103.079 on 16 procs for 2000 steps with 386 atoms

Performance: 0.838 ns/day, 28.633 hours/ns, 19.403 timesteps/s, 7.489 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.716     | 74.625     | 86.885     | 146.0 | 72.40
Bond    | 0.00059259 | 0.00074372 | 0.00093551 |   0.0 |  0.00
Neigh   | 4.7603     | 5.9589     | 6.9336     |  37.7 |  5.78
Comm    | 0.66745    | 12.925     | 29.814     | 350.7 | 12.54
Output  | 0.0008828  | 0.00096169 | 0.0013986  |   0.0 |  0.00
Modify  | 8.5249     | 9.523      | 10.717     |  30.2 |  9.24
Other   |            | 0.04535    |            |       |  0.04

Nlocal:          48.25 ave          54 max          44 min
Histogram: 1 1 0 1 3 0 0 0 1 1
Nghost:        3426.12 ave        3471 max        3380 min
Histogram: 2 0 1 1 0 0 1 0 1 2
Neighs:          32737 ave       36333 max       30075 min
Histogram: 2 0 0 3 1 0 0 0 1 1

Total # of neighbors = 261896
Ave neighs/atom = 678.48705
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 81.0228862306173
variable C2pos equal ${d2}
variable C2pos equal 54.9231697463626
variable C3pos equal ${d3}
variable C3pos equal 38.8751386527886
variable C4pos equal ${d4}
variable C4pos equal -4.34675384940488
variable C5pos equal ${d5}
variable C5pos equal 20.8075761964853
variable C6pos equal ${d6}
variable C6pos equal -20.0982597845881

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(15.9878864169643+${C1pos})
variable C11 equal 0.5*(15.9878864169643+81.0228862306173)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(3.26036293653659+${C2pos})
variable C21 equal 0.5*(3.26036293653659+54.9231697463626)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(35.8288169994343+${C3pos})
variable C31 equal 0.5*(35.8288169994343+38.8751386527886)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-1.51360972685194+${C4pos})
variable C41 equal 0.5*(-1.51360972685194+-4.34675384940488)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(-0.731296060255644+${C5pos})
variable C51 equal 0.5*(-0.731296060255644+20.8075761964853)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(22.9265320771155+${C6pos})
variable C61 equal 0.5*(22.9265320771155+-20.0982597845881)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.589
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.589
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.13589 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.13589 yz delta 0.00018 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.45311 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.45311 17.3161) with tilt (-7.3464 -0.3071 -0.01782)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 134.4 | 136.2 | 138 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.81495     -44756.476      64676.313      0              3895.5268    
       100   288.63405     -44755.34       18225.94       7927.3777      3895.5268    
       200   311.75726     -44755.075      19986.278      6383.1776      3895.5268    
       300   303.14544     -44727.173      6702.1865      4510.5472      3895.5268    
       400   309.69828     -44742.28      -5659.1239      4543.3369      3895.5268    
       500   294.33795     -44745.121      16042.498      3914.5686      3895.5268    
       600   287.55899     -44764.63       16782.134      12006.036      3895.5268    
       700   272.51149     -44760.081      6674.032       819.96207      3895.5268    
       800   269.47544     -44738.386      24211.597      5282.2394      3895.5268    
       900   299.07109     -44742.176      4602.8905      7645.2901      3895.5268    
      1000   319.47334     -44744.714      10800.786      6958.5817      3895.5268    
      1100   313.08573     -44743.243      22139.395      5447.4153      3895.5268    
      1200   293.66131     -44755.323      1996.5566      2052.4792      3895.5268    
      1300   295.16954     -44776.4        11156.218      3617.0462      3895.5268    
      1400   295.06637     -44775.663      9051.0964      6249.4761      3895.5268    
      1500   300.03389     -44753.95       6265.2643      7580.3405      3895.5268    
      1600   292.6811      -44721.496     -233.41258      2922.0608      3895.5268    
      1700   307.88609     -44736.744      11782.437      7482.5631      3895.5268    
      1800   294.69318     -44750.792      13909.248      2234.7954      3895.5268    
      1900   296.34913     -44782.476      12275.091      4236.254       3895.5268    
      2000   282.20738     -44762.787      4866.9371      4257.8613      3895.5268    
Loop time of 104.617 on 16 procs for 2000 steps with 386 atoms

Performance: 0.826 ns/day, 29.060 hours/ns, 19.117 timesteps/s, 7.379 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 59.852     | 74.62      | 86.676     | 122.1 | 71.33
Bond    | 0.00058702 | 0.00072589 | 0.00086353 |   0.0 |  0.00
Neigh   | 4.9022     | 5.901      | 6.7519     |  29.8 |  5.64
Comm    | 2.1647     | 14.223     | 28.979     | 279.6 | 13.60
Output  | 0.0044133  | 0.0071182  | 0.0085573  |   1.9 |  0.01
Modify  | 8.9778     | 9.8206     | 10.829     |  23.3 |  9.39
Other   |            | 0.04464    |            |       |  0.04

Nlocal:          48.25 ave          58 max          39 min
Histogram: 1 0 0 3 1 1 0 1 0 1
Nghost:        3437.38 ave        3475 max        3401 min
Histogram: 2 0 1 0 0 2 0 1 1 1
Neighs:        33397.6 ave       39741 max       27417 min
Histogram: 1 0 0 3 1 1 0 1 0 1

Total # of neighbors = 267181
Ave neighs/atom = 692.17876
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 134.4 | 136.2 | 137.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   282.20738     -44762.787      4866.9234      0              3895.5268    
       100   309.90356     -44782.185     -5254.8722      1215.9209      3895.5268    
       200   315.96837     -44765.23      -6519.5825     -937.53715      3895.5268    
       300   314.69482     -44732.482      10377.336      4930.5283      3895.5268    
       400   309.72982     -44739.066      5919.753       6891.105       3895.5268    
       500   316.29326     -44769.874      5123.4157      3492.283       3895.5268    
       600   302.38556     -44764.757      4056.7298      1833.6534      3895.5268    
       700   297.87838     -44769.973      5048.8302      3357.4752      3895.5268    
       800   290.82844     -44764.054      17369.19       4128.9361      3895.5268    
       900   305.89419     -44767.214      10413.255      3568.4208      3895.5268    
      1000   316.50488     -44763.29       9331.9746      3295.1692      3895.5268    
      1100   306.95155     -44767.113     -8485.6531      10089.146      3895.5268    
      1200   300.22897     -44790.036      2239.0797      5153.1456      3895.5268    
      1300   289.92442     -44780.628      2283.2057      5440.8871      3895.5268    
      1400   308.91316     -44793.132      18934.443      5522.5123      3895.5268    
      1500   301.19598     -44756.388     -7462.2531      4465.6553      3895.5268    
      1600   331.33375     -44761.712      6306.3908      6697.7921      3895.5268    
      1700   307.69503     -44754.406      18892.846      9863.1746      3895.5268    
      1800   308.66489     -44783.613     -643.82809      5305.2711      3895.5268    
      1900   296.60895     -44791.446      2974.2051      7400.2967      3895.5268    
      2000   289.08386     -44781.092      19087.669      6882.9384      3895.5268    
Loop time of 103.675 on 16 procs for 2000 steps with 386 atoms

Performance: 0.833 ns/day, 28.799 hours/ns, 19.291 timesteps/s, 7.446 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 59.515     | 73.469     | 87.184     | 129.3 | 70.86
Bond    | 0.00057659 | 0.00072645 | 0.00088725 |   0.0 |  0.00
Neigh   | 4.8532     | 5.7388     | 6.7409     |  31.7 |  5.54
Comm    | 1.0243     | 14.728     | 28.689     | 288.7 | 14.21
Output  | 0.00084381 | 0.00096686 | 0.0013704  |   0.0 |  0.00
Modify  | 8.6963     | 9.6916     | 10.578     |  24.4 |  9.35
Other   |            | 0.04601    |            |       |  0.04

Nlocal:          48.25 ave          55 max          44 min
Histogram: 2 2 0 1 0 0 2 0 0 1
Nghost:        3459.38 ave        3502 max        3425 min
Histogram: 3 0 1 0 0 0 2 0 1 1
Neighs:        33418.4 ave       37835 max       30762 min
Histogram: 2 2 0 1 0 0 2 0 0 1

Total # of neighbors = 267347
Ave neighs/atom = 692.60881
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 10.6320500923231
variable C2neg equal ${d2}
variable C2neg equal 78.9229979954885
variable C3neg equal ${d3}
variable C3neg equal 101.852032668056
variable C4neg equal ${d4}
variable C4neg equal -9.61051298937368
variable C5neg equal ${d5}
variable C5neg equal -10.9016822076379
variable C6neg equal ${d6}
variable C6neg equal 6.81911518016952

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.589
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.13589 yz delta ${deltayz} remap units box
change_box all y delta 0 0.13589 yz delta -0.00018 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.72489 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.72489 17.3161) with tilt (-7.3464 -0.3071 -0.01818)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.8 | 134.2 | 135.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.81495     -44744.494     -52658.607      0              3974.2243    
       100   289.6024      -44749.02      -228.84928     -158.10041      3974.2243    
       200   308.13481     -44748.502      2494.9425      3564.8587      3974.2243    
       300   312.07443     -44735.672     -5022.4081      2908.7198      3974.2243    
       400   306.2793      -44733.547      5513.555      -207.43968      3974.2243    
       500   297.64644     -44741.86       4745.0625      2781.6389      3974.2243    
       600   291.64663     -44766.626      7927.3293      8989.8408      3974.2243    
       700   273.03892     -44756.726      2907.9113     -2746.2286      3974.2243    
       800   278.72112     -44743.263      15978.535      4004.6643      3974.2243    
       900   305.96094     -44739.797     -810.93296      3032.862       3974.2243    
      1000   301.16691     -44727.226      15260.587     -149.93873      3974.2243    
      1100   308.17654     -44757.99       1737.1951      719.11795      3974.2243    
      1200   284.63377     -44763.081      1920.4782      4737.6437      3974.2243    
      1300   290.6326      -44788.685     -415.49632      5043.7046      3974.2243    
      1400   292.85616     -44787.289      1806.0951     -344.32262      3974.2243    
      1500   312.46499     -44778.115     -9475.8269     -3473.3246      3974.2243    
      1600   298.0851      -44733.25      -4279.6588      3268.2241      3974.2243    
      1700   321.49079     -44764.673      1305.4723      2141.0108      3974.2243    
      1800   296.04864     -44767.377      10876.944      1883.1347      3974.2243    
      1900   285.39928     -44776.122      1796.0759      4458.1559      3974.2243    
      2000   293.88889     -44780.686     -5252.449       7468.8836      3974.2243    
Loop time of 100.065 on 16 procs for 2000 steps with 386 atoms

Performance: 0.863 ns/day, 27.796 hours/ns, 19.987 timesteps/s, 7.715 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.663     | 69.657     | 84.301     | 143.2 | 69.61
Bond    | 0.00057737 | 0.00072278 | 0.00087721 |   0.0 |  0.00
Neigh   | 4.6453     | 5.5093     | 6.5185     |  34.2 |  5.51
Comm    | 0.76886    | 15.423     | 27.423     | 304.6 | 15.41
Output  | 0.0042338  | 0.0061519  | 0.0072651  |   1.4 |  0.01
Modify  | 8.4232     | 9.4247     | 10.288     |  26.0 |  9.42
Other   |            | 0.04374    |            |       |  0.04

Nlocal:          48.25 ave          54 max          40 min
Histogram: 1 0 0 0 1 2 2 0 0 2
Nghost:         3417.5 ave        3450 max        3378 min
Histogram: 2 0 0 0 1 1 1 1 1 1
Neighs:        32754.9 ave       36342 max       27471 min
Histogram: 1 0 0 0 1 2 2 0 0 2

Total # of neighbors = 262039
Ave neighs/atom = 678.85751
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.8 | 134.2 | 135.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   293.88889     -44780.686     -5252.4636      0              3974.2243    
       100   295.15009     -44767.232      607.2796       2820.2858      3974.2243    
       200   312.46665     -44758.678      22751.116      5316.4936      3974.2243    
       300   291.0646      -44735.701      7814.9961      4115.7428      3974.2243    
       400   311.46237     -44768.39      -8329.1269     -345.18206      3974.2243    
       500   301.77909     -44772.787     -3451.8156     -6042.7261      3974.2243    
       600   302.28233     -44784.8       -7524.9907      2408.7906      3974.2243    
       700   294.03988     -44782.687      17627.249      5327.0206      3974.2243    
       800   300.00634     -44783.147      1389.1655     -1788.8787      3974.2243    
       900   278.40515     -44735.08       6730.9505      891.52496      3974.2243    
      1000   313.99925     -44753.208     -623.79239      3823.8517      3974.2243    
      1100   321.25882     -44769.766      30502.49       3618.7888      3974.2243    
      1200   308.68281     -44781.009      2403.7876      3039.0617      3974.2243    
      1300   306.82532     -44784.288      520.49813     -41.805867      3974.2243    
      1400   281.89831     -44751.094     -1983.8653      922.03454      3974.2243    
      1500   324.64941     -44750.836     -9816.9059      3385.9367      3974.2243    
      1600   309.29629     -44734.96      -8612.1028     -477.08331      3974.2243    
      1700   301.40884     -44752.832     -6090.9253     -1153.6461      3974.2243    
      1800   295.09498     -44763.232      5196.8647      7305.5733      3974.2243    
      1900   284.99072     -44750.496     -12032.34       1195.5376      3974.2243    
      2000   298.99827     -44743.539     -4627.6988      814.61228      3974.2243    
Loop time of 99.6933 on 16 procs for 2000 steps with 386 atoms

Performance: 0.867 ns/day, 27.693 hours/ns, 20.062 timesteps/s, 7.744 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.141     | 67.871     | 83.91      | 144.6 | 68.08
Bond    | 0.00058182 | 0.00072136 | 0.00082749 |   0.0 |  0.00
Neigh   | 4.6718     | 5.3518     | 6.5637     |  36.9 |  5.37
Comm    | 0.80116    | 16.856     | 26.589     | 290.3 | 16.91
Output  | 0.00088721 | 0.0010358  | 0.0014529  |   0.5 |  0.00
Modify  | 8.3692     | 9.5693     | 10.241     |  27.5 |  9.60
Other   |            | 0.04297    |            |       |  0.04

Nlocal:          48.25 ave          59 max          41 min
Histogram: 1 0 2 1 2 1 0 0 0 1
Nghost:        3397.62 ave        3425 max        3356 min
Histogram: 1 0 2 0 0 0 0 2 1 2
Neighs:        32727.2 ave       39538 max       28097 min
Histogram: 1 0 2 1 2 1 0 0 0 1

Total # of neighbors = 261818
Ave neighs/atom = 678.28497
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 50.8552646199699
variable C2pos equal ${d2}
variable C2pos equal 67.5459137024241
variable C3pos equal ${d3}
variable C3pos equal 2.67255940121085
variable C4pos equal ${d4}
variable C4pos equal -10.9866432326507
variable C5pos equal ${d5}
variable C5pos equal 2.40556931549051
variable C6pos equal ${d6}
variable C6pos equal -8.70372241870978

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(10.6320500923231+${C1pos})
variable C12 equal 0.5*(10.6320500923231+50.8552646199699)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(78.9229979954885+${C2pos})
variable C22 equal 0.5*(78.9229979954885+67.5459137024241)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(101.852032668056+${C3pos})
variable C32 equal 0.5*(101.852032668056+2.67255940121085)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-9.61051298937368+${C4pos})
variable C42 equal 0.5*(-9.61051298937368+-10.9866432326507)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(-10.9016822076379+${C5pos})
variable C52 equal 0.5*(-10.9016822076379+2.40556931549051)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(6.81911518016952+${C6pos})
variable C62 equal 0.5*(6.81911518016952+-8.70372241870978)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.3161
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.3161
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.173161 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.589 17.142939) with tilt (-7.3464 -0.3071 -0.018)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 134.1 | 136.3 | 138.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.81495     -44750.418      61404.052      0              3895.5268    
       100   284.36975     -44746.601      2773.3496      7508.7994      3895.5268    
       200   302.95485     -44744.159      8575.7136      4139.1916      3895.5268    
       300   306.76388     -44733.152     -2795.3385      9021.4761      3895.5268    
       400   297.73481     -44729.705     -422.53933      7198.7912      3895.5268    
       500   307.55065     -44759.113      7540.1105      8828.6907      3895.5268    
       600   277.23436     -44748.876      24085.628      13665.559      3895.5268    
       700   313.22957     -44801.322      10541.025      2303.603       3895.5268    
       800   285.65642     -44758.442      9604.3958      5809.4248      3895.5268    
       900   300.43054     -44748.291      1759.7811      9628.796       3895.5268    
      1000   312.81713     -44736.638      20031.159      10123.301      3895.5268    
      1100   319.71946     -44737.47       12661.55       436.45901      3895.5268    
      1200   299.68483     -44743.647      12199.076      2996.6437      3895.5268    
      1300   299.2238      -44776.522      1352.9282      2299.4948      3895.5268    
      1400   272.98139     -44750.93       13094.945      2840.5619      3895.5268    
      1500   296.31391     -44755.7       -2641.1507      2456.7011      3895.5268    
      1600   310.44226     -44739.651      3213.2305      6954.7855      3895.5268    
      1700   305.64689     -44722.845     -4621.1886      8739.5015      3895.5268    
      1800   307.07356     -44751.326      4371.0652      4803.4238      3895.5268    
      1900   282.69207     -44742.425     -2427.3973      4690.256       3895.5268    
      2000   284.17984     -44754.554      8584.2384      5293.7443      3895.5268    
Loop time of 102.218 on 16 procs for 2000 steps with 386 atoms

Performance: 0.845 ns/day, 28.394 hours/ns, 19.566 timesteps/s, 7.552 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 59.832     | 70.164     | 85.837     | 129.2 | 68.64
Bond    | 0.00060651 | 0.00072753 | 0.00089715 |   0.0 |  0.00
Neigh   | 4.7429     | 5.4697     | 6.6324     |  32.7 |  5.35
Comm    | 1.1716     | 16.846     | 27.188     | 263.7 | 16.48
Output  | 0.0043853  | 0.0066533  | 0.00792    |   1.6 |  0.01
Modify  | 8.5248     | 9.6897     | 10.408     |  24.6 |  9.48
Other   |            | 0.04144    |            |       |  0.04

Nlocal:          48.25 ave          54 max          41 min
Histogram: 1 0 0 1 1 1 2 1 0 1
Nghost:        3457.62 ave        3509 max        3404 min
Histogram: 1 0 1 1 0 1 2 1 0 1
Neighs:        33391.8 ave       36902 max       28724 min
Histogram: 1 0 0 1 1 1 2 0 1 1

Total # of neighbors = 267134
Ave neighs/atom = 692.05699
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 134.1 | 136.3 | 138.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   284.17984     -44754.554      8584.2348      0              3895.5268    
       100   307.49182     -44766.556      15377.589      10165.192      3895.5268    
       200   333.87063     -44774.077      3944.1226      11781.332      3895.5268    
       300   297.98156     -44728.363     -2193.4641     -1763.1492      3895.5268    
       400   309.11296     -44761.711      4533.9285      1676.5747      3895.5268    
       500   290.12638     -44762.578      4197.6445      5187.9087      3895.5268    
       600   298.81499     -44773.675     -813.59185      4749.4322      3895.5268    
       700   296.53703     -44754.903      9160.783       2669.8516      3895.5268    
       800   319.81516     -44753.058     -4442.3697      1618.8826      3895.5268    
       900   313.03299     -44741.242     -11066.066      5316.4273      3895.5268    
      1000   273.97292     -44740.233      11006.939      5461.7099      3895.5268    
      1100   267.13156     -44736.609     -1409.3563      5259.3388      3895.5268    
      1200   289.77218     -44742.4        2094.0846      4002.6388      3895.5268    
      1300   311.28718     -44749.676     -4823.3031      3860.4913      3895.5268    
      1400   315.97966     -44763.111     -2262.9067      6353.9936      3895.5268    
      1500   289.84601     -44758.844      6602.5813      4695.3027      3895.5268    
      1600   288.94163     -44773.35      -1227.1908      5135.6168      3895.5268    
      1700   285.6773      -44765.153     -1105.5922     -1080.1039      3895.5268    
      1800   308.502       -44770.051      171.77971     -5908.22        3895.5268    
      1900   314.36065     -44760.973      5872.1476      2791.6646      3895.5268    
      2000   292.51442     -44733.985      19859.42       4254.9672      3895.5268    
Loop time of 102.43 on 16 procs for 2000 steps with 386 atoms

Performance: 0.844 ns/day, 28.453 hours/ns, 19.526 timesteps/s, 7.537 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 59.866     | 72.483     | 86.079     | 142.0 | 70.76
Bond    | 0.00060418 | 0.00072728 | 0.00085255 |   0.0 |  0.00
Neigh   | 4.7585     | 5.6806     | 6.6815     |  35.3 |  5.55
Comm    | 1.0355     | 14.63      | 27.245     | 316.0 | 14.28
Output  | 0.00086789 | 0.0010016  | 0.0014528  |   0.6 |  0.00
Modify  | 8.592      | 9.5938     | 10.526     |  27.4 |  9.37
Other   |            | 0.04037    |            |       |  0.04

Nlocal:          48.25 ave          55 max          41 min
Histogram: 1 0 1 0 1 3 0 0 0 2
Nghost:        3442.62 ave        3511 max        3374 min
Histogram: 1 0 1 1 1 1 1 1 0 1
Neighs:        33412.4 ave       37931 max       28736 min
Histogram: 1 1 0 0 3 1 0 0 0 2

Total # of neighbors = 267299
Ave neighs/atom = 692.48446
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -15.9958688319201
variable C2neg equal ${d2}
variable C2neg equal 20.7076984010335
variable C3neg equal ${d3}
variable C3neg equal 53.0452635559595
variable C4neg equal ${d4}
variable C4neg equal -3.41009861073021
variable C5neg equal ${d5}
variable C5neg equal -34.7114550835256
variable C6neg equal ${d6}
variable C6neg equal 25.7904465353805

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.3161
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.173161 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.589 17.489261) with tilt (-7.3464 -0.3071 -0.018)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.9 | 134.5 | 135.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.81495     -44752.567     -50887.603      0              3974.2243    
       100   289.70506     -44754.203     -3506.3743     -1933.1597      3974.2243    
       200   309.9751      -44749.415      4.6869979      1375.4705      3974.2243    
       300   313.95951     -44737.291      2941.0778      2149.1641      3974.2243    
       400   312.23279     -44746.196     -4330.7056     -2631.1922      3974.2243    
       500   307.86919     -44767.856     -9330.9428      430.41032      3974.2243    
       600   297.33875     -44782.502      13922.005      3959.0807      3974.2243    
       700   258.13082     -44744.88      -3603.4536     -3569.9248      3974.2243    
       800   290.9168      -44756.39       4478.3148      3644.8115      3974.2243    
       900   302.36742     -44743.191     -185.78031      1657.0483      3974.2243    
      1000   303.77472     -44736.141     -8537.6431      2041.3049      3974.2243    
      1100   315.14235     -44756.457     -3831.0839      2114.3352      3974.2243    
      1200   289.72959     -44747.359     -5184.5723      6500.1272      3974.2243    
      1300   291.26219     -44771.597      9490.1782      6181.9378      3974.2243    
      1400   285.48867     -44769.066     -1470.2196     -663.53631      3974.2243    
      1500   290.67842     -44749.743     -7680.1247      1030.8895      3974.2243    
      1600   316.07943     -44762.061      1473.6561     -5434.7806      3974.2243    
      1700   319.76641     -44775.798     -2839.6891      3951.2018      3974.2243    
      1800   309.93877     -44787.719      6663.3791      5116.148       3974.2243    
      1900   291.76381     -44785.886      5047.6409      2700.1101      3974.2243    
      2000   295.9643      -44798.499     -765.91704      7170.6952      3974.2243    
Loop time of 100.163 on 16 procs for 2000 steps with 386 atoms

Performance: 0.863 ns/day, 27.823 hours/ns, 19.967 timesteps/s, 7.707 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.301     | 71.272     | 84.168     | 140.6 | 71.16
Bond    | 0.00059836 | 0.00076355 | 0.00095241 |   0.0 |  0.00
Neigh   | 4.6518     | 5.6361     | 6.537      |  35.2 |  5.63
Comm    | 0.91522    | 13.805     | 26.768     | 319.4 | 13.78
Output  | 0.0042723  | 0.0063359  | 0.0075215  |   1.5 |  0.01
Modify  | 8.4902     | 9.4012     | 10.395     |  27.5 |  9.39
Other   |            | 0.04208    |            |       |  0.04

Nlocal:          48.25 ave          55 max          41 min
Histogram: 1 0 2 1 0 1 0 1 0 2
Nghost:        3413.38 ave        3435 max        3378 min
Histogram: 1 0 2 0 0 0 0 1 2 2
Neighs:        32787.5 ave       37194 max       28143 min
Histogram: 1 0 2 1 0 1 0 1 0 2

Total # of neighbors = 262300
Ave neighs/atom = 679.53368
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.8 | 134.5 | 135.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   295.9643      -44798.499     -765.94416      0              3974.2243    
       100   293.80047     -44778.495     -5974.4028      2408.6578      3974.2243    
       200   304.3505      -44767.502      3593.6595      5525.2678      3974.2243    
       300   298.93244     -44758.394      1922.4237     -508.48735      3974.2243    
       400   294.53461     -44750.981      15194.858     -3618.8798      3974.2243    
       500   298.67869     -44753.93      -2751.5143     -2471.0018      3974.2243    
       600   302.16744     -44768.509     -1529.1915     -1820.1283      3974.2243    
       700   288.67586     -44769.007      3588.6073     -847.74775      3974.2243    
       800   290.08198     -44764.848     -16498.325     -4112.464       3974.2243    
       900   300.93035     -44743.994      9433.1726      4514.9482      3974.2243    
      1000   315.04143     -44749.339     -1951.9963     -9.4368723      3974.2243    
      1100   301.11489     -44752.05       2695.96        3413.5198      3974.2243    
      1200   297.03193     -44761.83      -9330.0386     -2258.5424      3974.2243    
      1300   292.92527     -44753.919     -3775.2227     -11854.908      3974.2243    
      1400   293.01677     -44752.687      4770.0096     -2282.6575      3974.2243    
      1500   281.36535     -44750.498     -4999.9482      2876.3116      3974.2243    
      1600   274.76523     -44774.085     -161.79527      6367.4134      3974.2243    
      1700   287.36522     -44792.86      -8589.2937      110.64015      3974.2243    
      1800   287.63617     -44763.16       4580.2205      882.30287      3974.2243    
      1900   296.2151      -44755.175     -2925.4534     -3878.9457      3974.2243    
      2000   304.19694     -44755.446      4760.3173      94.918561      3974.2243    
Loop time of 101.1 on 16 procs for 2000 steps with 386 atoms

Performance: 0.855 ns/day, 28.083 hours/ns, 19.782 timesteps/s, 7.636 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.411     | 73.969     | 84.84      | 142.1 | 73.16
Bond    | 0.00059532 | 0.00075584 | 0.00094037 |   0.0 |  0.00
Neigh   | 4.7113     | 5.876      | 6.6548     |  35.4 |  5.81
Comm    | 1.0339     | 11.919     | 28.457     | 353.9 | 11.79
Output  | 0.00088848 | 0.0010088  | 0.0014158  |   0.5 |  0.00
Modify  | 8.5066     | 9.2886     | 10.461     |  28.3 |  9.19
Other   |            | 0.04473    |            |       |  0.04

Nlocal:          48.25 ave          55 max          43 min
Histogram: 1 1 1 0 2 1 0 1 0 1
Nghost:        3430.38 ave        3476 max        3389 min
Histogram: 2 1 1 0 0 0 0 2 1 1
Neighs:        32768.5 ave       36995 max       29490 min
Histogram: 1 1 1 0 3 0 0 1 0 1

Total # of neighbors = 262148
Ave neighs/atom = 679.1399
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 58.1475612558956
variable C2pos equal ${d2}
variable C2pos equal 37.3479208509164
variable C3pos equal ${d3}
variable C3pos equal 58.648243521566
variable C4pos equal ${d4}
variable C4pos equal 24.6756910257989
variable C5pos equal ${d5}
variable C5pos equal 13.7815449486272
variable C6pos equal ${d6}
variable C6pos equal -9.455926639929

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(-15.9958688319201+${C1pos})
variable C13 equal 0.5*(-15.9958688319201+58.1475612558956)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(20.7076984010335+${C2pos})
variable C23 equal 0.5*(20.7076984010335+37.3479208509164)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(53.0452635559595+${C3pos})
variable C33 equal 0.5*(53.0452635559595+58.648243521566)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-3.41009861073021+${C4pos})
variable C43 equal 0.5*(-3.41009861073021+24.6756910257989)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-34.7114550835256+${C5pos})
variable C53 equal 0.5*(-34.7114550835256+13.7815449486272)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(25.7904465353805+${C6pos})
variable C63 equal 0.5*(25.7904465353805+-9.455926639929)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.3161
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.3161
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.173161 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.191161)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.6 | 135.5 | 137.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.81495     -44770.987     -1546.4363      0              3934.8755    
       100   277.15532     -44751.031     -3260.0245      1484.6212      3934.8755    
       200   314.03308     -44755.118     -6101.6199      1976.4121      3934.8755    
       300   308.87513     -44727.411      22320.736      7409.0507      3934.8755    
       400   307.30374     -44732.778     -2045.5788      2770.0491      3934.8755    
       500   300.46386     -44745.992      8098.793       7124.6145      3934.8755    
       600   287.62005     -44756.91       7075.6309      10285.794      3934.8755    
       700   292.58016     -44768.788     -11936.833      485.87543      3934.8755    
       800   298.91249     -44762.222      3010.1501      4567.2068      3934.8755    
       900   312.32842     -44755.493     -1953.3032      4430.3097      3934.8755    
      1000   292.27504     -44722.446      3220.1688      7731.6902      3934.8755    
      1100   305.64075     -44746.693      8020.0259      7463.4122      3934.8755    
      1200   294.07428     -44758.753      905.26321     -523.95613      3934.8755    
      1300   283.86576     -44758.951      14053.825      4838.2126      3934.8755    
      1400   296.73212     -44757          2689.5618      7339.2247      3934.8755    
      1500   277.51476     -44713.098      13860.3        5982.3634      3934.8755    
      1600   328.91344     -44747.884     -7685.3268      5386.569       3934.8755    
      1700   322.43401     -44758.398      10523.684      110.14739      3934.8755    
      1800   306.63568     -44775.127     -1144.7524      1087.9395      3934.8755    
      1900   281.9256      -44773.31       13824.902      4744.1124      3934.8755    
      2000   291.59169     -44772.117      1237.069       7258.0339      3934.8755    
Loop time of 102.469 on 16 procs for 2000 steps with 386 atoms

Performance: 0.843 ns/day, 28.464 hours/ns, 19.518 timesteps/s, 7.534 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.231     | 78.346     | 85.901     | 119.2 | 76.46
Bond    | 0.00058936 | 0.0007328  | 0.00087101 |   0.0 |  0.00
Neigh   | 4.8281     | 6.2364     | 6.7666     |  31.0 |  6.09
Comm    | 1.1013     | 8.6718     | 28.798     | 358.3 |  8.46
Output  | 0.0042852  | 0.0064863  | 0.0076506  |   1.6 |  0.01
Modify  | 8.601      | 9.1569     | 10.56      |  25.7 |  8.94
Other   |            | 0.0505     |            |       |  0.05

Nlocal:          48.25 ave          52 max          42 min
Histogram: 1 0 0 0 1 1 0 2 1 2
Nghost:         3431.5 ave        3458 max        3403 min
Histogram: 1 1 0 1 1 0 1 1 0 2
Neighs:        33082.9 ave       35643 max       29161 min
Histogram: 1 0 0 1 1 0 2 1 1 1

Total # of neighbors = 264663
Ave neighs/atom = 685.65544
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.6 | 135.3 | 136.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.59169     -44772.117      1237.0645      0              3934.8755    
       100   286.77934     -44752.591      3886.7749      651.23967      3934.8755    
       200   309.07913     -44747.919     -1818.0413      2855.7344      3934.8755    
       300   299.50608     -44739.26      -597.55461      109.65755      3934.8755    
       400   299.10488     -44746.72       3994.5226     -2804.3864      3934.8755    
       500   295.45926     -44748.574      3701.0665      447.58169      3934.8755    
       600   293.68789     -44760.211      6504.0076      3168.0658      3934.8755    
       700   268.8287      -44760.017      2085.7392      3722.4319      3934.8755    
       800   292.78131     -44794.579     -8898.6482      2345.5907      3934.8755    
       900   299.53739     -44762.014     -8779.6541      2323.5301      3934.8755    
      1000   324.30569     -44775.947     -5236.9755      5849.6906      3934.8755    
      1100   315.45047     -44773.886     -2790.8065      7233.3851      3934.8755    
      1200   307.50292     -44782.464      19502.741      6740.5266      3934.8755    
      1300   297.06498     -44792.292     -1833.1722      7264.1804      3934.8755    
      1400   274.06898     -44780.57       12580.884     -2560.9633      3934.8755    
      1500   296.26276     -44771.962      8492.1655      430.43412      3934.8755    
      1600   321.79256     -44779.437     -5337.8154      4185.398       3934.8755    
      1700   301.16009     -44767.776      5509.6386      2877.6625      3934.8755    
      1800   298.72037     -44786.765     -9975.7944      6838.9208      3934.8755    
      1900   277.49078     -44776.998     -1200.0937      8999.9145      3934.8755    
      2000   295.94469     -44771.822      6300.8202      3259.7075      3934.8755    
Loop time of 102.81 on 16 procs for 2000 steps with 386 atoms

Performance: 0.840 ns/day, 28.558 hours/ns, 19.453 timesteps/s, 7.509 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.523     | 82.165     | 86.218     |  98.7 | 79.92
Bond    | 0.00058686 | 0.00073854 | 0.00090928 |   0.0 |  0.00
Neigh   | 4.7881     | 6.4488     | 6.9142     |  25.3 |  6.27
Comm    | 1.1462     | 5.2143     | 28.868     | 391.9 |  5.07
Output  | 0.00087959 | 0.00099525 | 0.0013946  |   0.0 |  0.00
Modify  | 8.432      | 8.9279     | 10.587     |  21.6 |  8.68
Other   |            | 0.05308    |            |       |  0.05

Nlocal:          48.25 ave          55 max          42 min
Histogram: 1 0 0 3 0 2 1 0 0 1
Nghost:        3415.12 ave        3458 max        3370 min
Histogram: 2 0 1 0 0 2 0 0 2 1
Neighs:        33091.2 ave       37373 max       29037 min
Histogram: 1 0 1 2 0 2 0 1 0 1

Total # of neighbors = 264730
Ave neighs/atom = 685.82902
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -26.0803375518837
variable C2neg equal ${d2}
variable C2neg equal -49.6549331360176
variable C3neg equal ${d3}
variable C3neg equal -13.9995467840226
variable C4neg equal ${d4}
variable C4neg equal 18.74030042747
variable C5neg equal ${d5}
variable C5neg equal -21.9721654318693
variable C6neg equal ${d6}
variable C6neg equal 4.57958736386371

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.3161
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.173161 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 0.155161)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.6 | 135.5 | 137.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.81495     -44764.91      -6449.931       0              3934.8755    
       100   288.42985     -44760.439     -3020.1862      1033.5929      3934.8755    
       200   301.51954     -44740.395      10647.004      4908.3303      3934.8755    
       300   318.23232     -44737.731      3889.8601      4569.2131      3934.8755    
       400   305.53209     -44731.986      8203.3213     -1063.9559      3934.8755    
       500   290.99074     -44739.381      11392.247      3676.957       3934.8755    
       600   290.54999     -44758.128      3167.1312      3406.7907      3934.8755    
       700   308.2989      -44781.699     -10757.311     -4770.5463      3934.8755    
       800   288.18814     -44743.453      6704.7947      4164.2639      3934.8755    
       900   303.95899     -44734.131      3428.602      -1071.4023      3934.8755    
      1000   309.27917     -44723.345      2882.8494     -2648.0639      3934.8755    
      1100   319.36527     -44744.542      982.90103     -832.24669      3934.8755    
      1200   300.36484     -44748.28      -2709.0907      2013.9668      3934.8755    
      1300   291.23603     -44761.112      4185.7768      2666.6031      3934.8755    
      1400   299.51394     -44773.983     -5336.6271      680.50589      3934.8755    
      1500   296.8651      -44761.467     -699.27139      1543.0553      3934.8755    
      1600   306.73716     -44755.713      11854.866     -3193.049       3934.8755    
      1700   298.28307     -44729.304      1469.4876     -1531.2704      3934.8755    
      1800   304.577       -44730.282     -758.11675     -1085.4029      3934.8755    
      1900   305.15348     -44748.739      2766.4301     -1967.0064      3934.8755    
      2000   292.54251     -44759.222     -4543.9554      3044.8751      3934.8755    
Loop time of 102.596 on 16 procs for 2000 steps with 386 atoms

Performance: 0.842 ns/day, 28.499 hours/ns, 19.494 timesteps/s, 7.525 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.234     | 81.833     | 86.024     |  98.8 | 79.76
Bond    | 0.00056976 | 0.0007394  | 0.0009459  |   0.0 |  0.00
Neigh   | 4.7956     | 6.4073     | 6.8504     |  24.7 |  6.25
Comm    | 1.1911     | 5.3876     | 29         | 385.3 |  5.25
Output  | 0.0043034  | 0.0063416  | 0.0075036  |   1.5 |  0.01
Modify  | 8.4373     | 8.9096     | 10.516     |  21.0 |  8.68
Other   |            | 0.05107    |            |       |  0.05

Nlocal:          48.25 ave          56 max          38 min
Histogram: 1 0 0 0 1 3 0 1 1 1
Nghost:        3436.75 ave        3468 max        3404 min
Histogram: 1 0 1 1 2 1 0 0 0 2
Neighs:        33080.2 ave       38017 max       26452 min
Histogram: 1 0 0 0 2 2 0 1 1 1

Total # of neighbors = 264642
Ave neighs/atom = 685.60104
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 135.3 | 136.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   292.54251     -44759.222     -4544.0164      0              3934.8755    
       100   300.39464     -44762.44       4009.3824      2535.4573      3934.8755    
       200   306.93006     -44738.237      4183.4605      7940.92        3934.8755    
       300   315.34996     -44732.63      -356.18902     -1935.9377      3934.8755    
       400   315.22558     -44751.187      16876.864      1868.2124      3934.8755    
       500   296.32193     -44745.431      3700.9156     -2401.3876      3934.8755    
       600   294.87666     -44754.44      -4717.2916      1013.0466      3934.8755    
       700   281.36723     -44750.879     -6308.1924     -43.857859      3934.8755    
       800   277.64096     -44767.076      2853.2547     -1030.5369      3934.8755    
       900   270.36447     -44784.946     -3216.9487      3149.0865      3934.8755    
      1000   285.01056     -44781.003      141.12746      7704.4942      3934.8755    
      1100   311.79978     -44779.405     -8320.2953      453.9568       3934.8755    
      1200   294.46287     -44752.907      910.28445     -1536.3865      3934.8755    
      1300   288.58605     -44743.812      12326.753      2047.8978      3934.8755    
      1400   293.98767     -44750.74       5282.8223      5437.3685      3934.8755    
      1500   312.75878     -44764.088      4799.7145      2898.1695      3934.8755    
      1600   281.25594     -44741.88       13897.762      1014.4353      3934.8755    
      1700   295.14843     -44778.975      5238.5325      737.45303      3934.8755    
      1800   296.41461     -44795.53       937.3801      -666.05311      3934.8755    
      1900   283.00665     -44761.724     -15513.756      1083.0697      3934.8755    
      2000   322.72164     -44769.824      5705.6386     -3696.014       3934.8755    
Loop time of 102.136 on 16 procs for 2000 steps with 386 atoms

Performance: 0.846 ns/day, 28.371 hours/ns, 19.582 timesteps/s, 7.559 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.215     | 78.811     | 85.741     | 116.6 | 77.16
Bond    | 0.00053908 | 0.00074194 | 0.00092028 |   0.0 |  0.00
Neigh   | 4.8429     | 6.1882     | 6.6694     |  27.6 |  6.06
Comm    | 1.0953     | 8.0258     | 28.618     | 365.5 |  7.86
Output  | 0.00085703 | 0.00098149 | 0.0013946  |   0.0 |  0.00
Modify  | 8.5898     | 9.0638     | 10.42      |  22.9 |  8.87
Other   |            | 0.04589    |            |       |  0.04

Nlocal:          48.25 ave          54 max          41 min
Histogram: 1 0 1 1 1 1 0 0 1 2
Nghost:        3449.25 ave        3503 max        3402 min
Histogram: 2 0 0 1 0 2 1 1 0 1
Neighs:        33094.1 ave       36891 max       28472 min
Histogram: 1 0 1 1 1 1 0 0 1 2

Total # of neighbors = 264753
Ave neighs/atom = 685.8886
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 96.5591858612469
variable C2pos equal ${d2}
variable C2pos equal 53.8383798626529
variable C3pos equal ${d3}
variable C3pos equal 60.9994733319682
variable C4pos equal ${d4}
variable C4pos equal -3.27378226607135
variable C5pos equal ${d5}
variable C5pos equal -0.758637276650296
variable C6pos equal ${d6}
variable C6pos equal -13.7937714567712

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-26.0803375518837+${C1pos})
variable C14 equal 0.5*(-26.0803375518837+96.5591858612469)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(-49.6549331360176+${C2pos})
variable C24 equal 0.5*(-49.6549331360176+53.8383798626529)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-13.9995467840226+${C3pos})
variable C34 equal 0.5*(-13.9995467840226+60.9994733319682)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(18.74030042747+${C4pos})
variable C44 equal 0.5*(18.74030042747+-3.27378226607135)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-21.9721654318693+${C5pos})
variable C54 equal 0.5*(-21.9721654318693+-0.758637276650296)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(4.57958736386371+${C6pos})
variable C64 equal 0.5*(4.57958736386371+-13.7937714567712)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.3161
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.3161
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.173161 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.480261 -0.018)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.6 | 135.5 | 137.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.81495     -44765.966     -5967.5471      0              3934.8755    
       100   283.14949     -44754.763     -913.89387      1163.6968      3934.8755    
       200   315.34989     -44756.077     -4129.6491      4055.9722      3934.8755    
       300   312.9529      -44732.186      7491.5831      3047.146       3934.8755    
       400   294.14544     -44717.499      10426.454      2632.6362      3934.8755    
       500   304.33722     -44750.08       2657.5649      4674.23        3934.8755    
       600   307.7847      -44772.576      17542.492      5684.2249      3934.8755    
       700   286.16582     -44752.841      5766.73        214.19239      3934.8755    
       800   304.87207     -44768.094      8072.6265      4036.8664      3934.8755    
       900   303.16352     -44762.886      7117.4113      3943.0549      3934.8755    
      1000   283.84837     -44732.007     -2228.0204      4928.7302      3934.8755    
      1100   301.2968      -44737.641      4830.3611      3073.4988      3934.8755    
      1200   322.88048     -44765.735      333.53245      1292.0011      3934.8755    
      1300   304.5193      -44768.522      905.27118      4078.6674      3934.8755    
      1400   293.83459     -44771.717      4548.9889      4842.6026      3934.8755    
      1500   296.40746     -44768.138      8274.6064     -212.97687      3934.8755    
      1600   295.6008      -44736.783     -2917.5757     -2964.9144      3934.8755    
      1700   310.10863     -44733.309      9546.7358      1765.926       3934.8755    
      1800   310.07818     -44735.361     -5933.4315      5850.3983      3934.8755    
      1900   301.7079      -44754.956      5621.2232      6285.9669      3934.8755    
      2000   284.17431     -44761.61      -5032.4978      1501.713       3934.8755    
Loop time of 101.917 on 16 procs for 2000 steps with 386 atoms

Performance: 0.848 ns/day, 28.310 hours/ns, 19.624 timesteps/s, 7.575 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 58.015     | 77.887     | 85.668     | 129.5 | 76.42
Bond    | 0.00055902 | 0.00072593 | 0.00092587 |   0.0 |  0.00
Neigh   | 4.8071     | 6.1314     | 6.7151     |  30.9 |  6.02
Comm    | 0.9133     | 8.6996     | 28.56      | 387.3 |  8.54
Output  | 0.0044184  | 0.0068592  | 0.0081586  |   1.7 |  0.01
Modify  | 8.5618     | 9.1467     | 10.48      |  25.5 |  8.97
Other   |            | 0.04436    |            |       |  0.04

Nlocal:          48.25 ave          57 max          42 min
Histogram: 1 0 2 2 1 0 0 0 1 1
Nghost:         3434.5 ave        3481 max        3398 min
Histogram: 1 1 2 0 1 1 0 0 1 1
Neighs:        33078.4 ave       38668 max       29127 min
Histogram: 1 2 0 3 0 0 0 0 1 1

Total # of neighbors = 264627
Ave neighs/atom = 685.56218
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 135.4 | 137.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   284.17431     -44761.609     -5032.4919      0              3934.8755    
       100   301.68873     -44770.374      14877.116      4995.0341      3934.8755    
       200   317.75794     -44754.207      2973.899       1774.1811      3934.8755    
       300   318.8194      -44750.935      3031.7058      5594.8817      3934.8755    
       400   317.39179     -44769.397      7799.5346      793.0442       3934.8755    
       500   304.24949     -44772.733     -1423.225       2128.6477      3934.8755    
       600   293.74795     -44772.75      -8248.6919      8586.4072      3934.8755    
       700   318.55333     -44794.924     -2252.5134      5058.2839      3934.8755    
       800   294.5581      -44736.045      9946.1394     -2822.9737      3934.8755    
       900   311.37129     -44734.476     -7424.3768     -2088.6488      3934.8755    
      1000   301.68506     -44746.71      -10933.531     -599.41773      3934.8755    
      1100   286.23524     -44745.74       4898.8762      9707.3925      3934.8755    
      1200   294.54289     -44755.811      2318.4166      9961.408       3934.8755    
      1300   292.00799     -44762.629      18776.219      2946.3663      3934.8755    
      1400   274.67339     -44769.206     -8925.0274     -2241.9525      3934.8755    
      1500   275.01757     -44779.747      4599.6178     -1042.6976      3934.8755    
      1600   282.0003      -44751.57      -111.99556     -4756.6071      3934.8755    
      1700   297.18162     -44748.616     -6396.2992      4331.7841      3934.8755    
      1800   315.58112     -44766.342      1770.6228      5475.8107      3934.8755    
      1900   299.20872     -44757.397     -2474.3062     -5844.0135      3934.8755    
      2000   282.34023     -44769.192     -2778.6963      850.92575      3934.8755    
Loop time of 100.273 on 16 procs for 2000 steps with 386 atoms

Performance: 0.862 ns/day, 27.853 hours/ns, 19.946 timesteps/s, 7.699 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 57.103     | 71.767     | 84.019     | 104.9 | 71.57
Bond    | 0.0005603  | 0.00069531 | 0.00085446 |   0.0 |  0.00
Neigh   | 4.7314     | 5.7558     | 6.4965     |  24.8 |  5.74
Comm    | 0.98451    | 13.234     | 27.903     | 244.3 | 13.20
Output  | 0.000845   | 0.00095124 | 0.001347   |   0.0 |  0.00
Modify  | 8.7224     | 9.471      | 10.497     |  19.5 |  9.45
Other   |            | 0.04392    |            |       |  0.04

Nlocal:          48.25 ave          57 max          41 min
Histogram: 1 0 0 4 1 0 0 0 1 1
Nghost:        3423.88 ave        3463 max        3393 min
Histogram: 2 2 0 0 0 0 2 0 0 2
Neighs:        33064.6 ave       38786 max       28485 min
Histogram: 1 0 0 4 1 0 0 1 0 1

Total # of neighbors = 264517
Ave neighs/atom = 685.2772
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -50.4873183840266
variable C2neg equal ${d2}
variable C2neg equal -28.8680916542339
variable C3neg equal ${d3}
variable C3neg equal -11.3759047736849
variable C4neg equal ${d4}
variable C4neg equal 15.1038449330606
variable C5neg equal ${d5}
variable C5neg equal -8.92273928452461
variable C6neg equal ${d6}
variable C6neg equal 9.62873175428129

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.3161
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.173161 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.133939 -0.018)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 135.4 | 137.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.81495     -44770.516     -4009.4145      0              3934.8755    
       100   281.6955      -44756.541     -4483.2485      1973.9733      3934.8755    
       200   304.57478     -44744.026     -7409.4064      2886.2296      3934.8755    
       300   298.45407     -44710.587     -5440.8742      5327.3438      3934.8755    
       400   302.75718     -44720.358     -2676.6953      4035.7417      3934.8755    
       500   311.68417     -44754.811     -4953.848       1841.952       3934.8755    
       600   300.76733     -44767.213      8296.7558      5594.0817      3934.8755    
       700   297.50236     -44777.344      4763.7549     -5018.7191      3934.8755    
       800   272.21288     -44737.354      1051.688       386.44184      3934.8755    
       900   296.40893     -44728.355     -9406.0385      951.81807      3934.8755    
      1000   313.96695     -44726.927      200.19172      4497.4082      3934.8755    
      1100   301.99035     -44727.011     -7445.8976      1267.772       3934.8755    
      1200   287.42939     -44736.514     -11101.606     -1122.725       3934.8755    
      1300   293.30183     -44760.744     -403.10864     -3103.5086      3934.8755    
      1400   281.53532     -44753.578     -9237.8871      2131.0228      3934.8755    
      1500   285.97678     -44741.255     -7661.2766      4365.5434      3934.8755    
      1600   316.36841     -44742.327     -2259.9446      855.02394      3934.8755    
      1700   303.70737     -44714.96       3402.5382      2172.3741      3934.8755    
      1800   294.70827     -44728.681     -6725.5028     -1765.9015      3934.8755    
      1900   302.6128      -44774.059     -507.9374       4962.1553      3934.8755    
      2000   279.97448     -44769.1       -5626.2781      3474.3704      3934.8755    
Loop time of 95.2588 on 16 procs for 2000 steps with 386 atoms

Performance: 0.907 ns/day, 26.461 hours/ns, 20.995 timesteps/s, 8.104 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.484     | 59.352     | 80.015     | 102.1 | 62.31
Bond    | 0.00048177 | 0.00065965 | 0.00079175 |   0.0 |  0.00
Neigh   | 4.6493     | 4.9024     | 6.379      |  25.3 |  5.15
Comm    | 0.55328    | 21.218     | 26.09      | 170.8 | 22.27
Output  | 0.0040596  | 0.0069669  | 0.0083965  |   2.0 |  0.01
Modify  | 8.2611     | 9.7413     | 9.994      |  18.0 | 10.23
Other   |            | 0.03831    |            |       |  0.04

Nlocal:          48.25 ave          55 max          43 min
Histogram: 1 2 1 1 0 1 0 0 0 2
Nghost:        3439.88 ave        3464 max        3410 min
Histogram: 1 1 1 0 0 1 1 0 1 2
Neighs:        33097.1 ave       37567 max       29755 min
Histogram: 1 2 1 1 0 1 0 0 0 2

Total # of neighbors = 264777
Ave neighs/atom = 685.95078
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.5 | 135.2 | 136.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   279.97448     -44769.1       -5626.2491      0              3934.8755    
       100   297.43609     -44773.151     -1347.1156      787.07904      3934.8755    
       200   304.36418     -44753.581     -20582.875     -3548.1946      3934.8755    
       300   306.23212     -44756.714      19531.638      2012.3292      3934.8755    
       400   296.44923     -44748.592      9901.1195      5067.475       3934.8755    
       500   299.09474     -44760.542     -3301.7395     -515.53481      3934.8755    
       600   290.25362     -44779.341      1413.7984      1861.2907      3934.8755    
       700   279.98384     -44779.866      5026.7336      4560.0757      3934.8755    
       800   291.69141     -44768.474     -10206.466      4314.7236      3934.8755    
       900   297.82581     -44748.76       866.64099      785.87981      3934.8755    
      1000   323.46306     -44769.182      196.2652       6836.368       3934.8755    
      1100   286.74431     -44725.152     -5082.1557      1337.0849      3934.8755    
      1200   287.79931     -44731.639      10710.503      1389.7084      3934.8755    
      1300   291.40481     -44759.838      12365.834      2280.8207      3934.8755    
      1400   281.76291     -44761.412      5977.8964      2229.393       3934.8755    
      1500   307.2929      -44766.079     -3591.7761      2269.6328      3934.8755    
      1600   301.10797     -44733.049     -11224.86       1095.7492      3934.8755    
      1700   318.25073     -44751.49       5839.3847      4175.5845      3934.8755    
      1800   297.0807      -44743.13      -12289.559     -3554.0332      3934.8755    
      1900   299.11471     -44761.687      9851.5072      3788.5271      3934.8755    
      2000   295.60449     -44763.435      4901.0642      7041.9909      3934.8755    
Loop time of 96.1972 on 16 procs for 2000 steps with 386 atoms

Performance: 0.898 ns/day, 26.721 hours/ns, 20.791 timesteps/s, 8.025 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.455     | 59.553     | 80.671     | 104.2 | 61.91
Bond    | 0.00048508 | 0.00066824 | 0.00084001 |   0.0 |  0.00
Neigh   | 4.7164     | 4.986      | 6.499      |  25.6 |  5.18
Comm    | 0.5599     | 21.673     | 26.782     | 172.8 | 22.53
Output  | 0.00088704 | 0.0010557  | 0.0015115  |   0.5 |  0.00
Modify  | 8.4244     | 9.9449     | 10.205     |  18.2 | 10.34
Other   |            | 0.03824    |            |       |  0.04

Nlocal:          48.25 ave          57 max          43 min
Histogram: 3 1 1 0 0 1 0 0 0 2
Nghost:         3458.5 ave        3516 max        3418 min
Histogram: 1 1 2 2 0 0 0 0 1 1
Neighs:          33058 ave       38636 max       29495 min
Histogram: 3 1 0 1 0 1 0 0 0 2

Total # of neighbors = 264464
Ave neighs/atom = 685.1399
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -12.2436494713293
variable C2pos equal ${d2}
variable C2pos equal -9.36269221265141
variable C3pos equal ${d3}
variable C3pos equal -27.292808251728
variable C4pos equal ${d4}
variable C4pos equal -4.86548705396328
variable C5pos equal ${d5}
variable C5pos equal -0.568871204022087
variable C6pos equal ${d6}
variable C6pos equal -14.4472883940234

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-50.4873183840266+${C1pos})
variable C15 equal 0.5*(-50.4873183840266+-12.2436494713293)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-28.8680916542339+${C2pos})
variable C25 equal 0.5*(-28.8680916542339+-9.36269221265141)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-11.3759047736849+${C3pos})
variable C35 equal 0.5*(-11.3759047736849+-27.292808251728)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(15.1038449330606+${C4pos})
variable C45 equal 0.5*(15.1038449330606+-4.86548705396328)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(-8.92273928452461+${C5pos})
variable C55 equal 0.5*(-8.92273928452461+-0.568871204022087)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(9.62873175428129+${C6pos})
variable C65 equal 0.5*(9.62873175428129+-14.4472883940234)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.589

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.589
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.13589 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.48229 -0.3071 -0.018)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.6 | 137.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.81495     -44770.956     -5265.6684      0              3934.8755    
       100   285.51208     -44761.409     -1566.1074      2733.6041      3934.8755    
       200   318.57005     -44761.854     -776.88422      5085.6757      3934.8755    
       300   310.46702     -44730.635     -4403.0364      2812.0134      3934.8755    
       400   311.0701      -44740          8917.2733      4967.1975      3934.8755    
       500   311.17695     -44763.221      16664.564      6290.3662      3934.8755    
       600   286.57858     -44757.385      4856.6727      5066.5631      3934.8755    
       700   297.69955     -44779.39       1434.6748     -1863.8432      3934.8755    
       800   298.17435     -44773.333      7970.7545      1546.5354      3934.8755    
       900   306.03415     -44758.814      3824.7611      6552.3028      3934.8755    
      1000   310.52882     -44743.358      6341.4015      8853.4478      3934.8755    
      1100   314.60261     -44751.629     -3254.4008      2652.4595      3934.8755    
      1200   300.28104     -44760.933      5710.7813      8832.6147      3934.8755    
      1300   283.08064     -44762.612      10011.314      4554.1217      3934.8755    
      1400   299.34171     -44774.948      9472.525       336.5508       3934.8755    
      1500   292.57386     -44741.131      4068.4042     -462.68484      3934.8755    
      1600   309.01771     -44735.229     -3100.8004     -4098.5582      3934.8755    
      1700   311.43999     -44737.833      3013.6524     -515.48238      3934.8755    
      1800   306.79108     -44754.941     -6047.3479      2387.3441      3934.8755    
      1900   287.71972     -44763.432      6287.9617      3172.5184      3934.8755    
      2000   292.77522     -44774.804      650.48203      19.527188      3934.8755    
Loop time of 76.7817 on 16 procs for 2000 steps with 386 atoms

Performance: 1.125 ns/day, 21.328 hours/ns, 26.048 timesteps/s, 10.054 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.492     | 57.014     | 63.396     |  33.4 | 74.25
Bond    | 0.00053448 | 0.00070828 | 0.00096781 |   0.0 |  0.00
Neigh   | 4.6985     | 4.8617     | 5.2049     |   6.6 |  6.33
Comm    | 0.99078    | 7.3725     | 9.8999     |  93.0 |  9.60
Output  | 0.003654   | 0.0062741  | 0.0075058  |   1.9 |  0.01
Modify  | 7.1399     | 7.4842     | 7.643      |   5.3 |  9.75
Other   |            | 0.04245    |            |       |  0.06

Nlocal:          48.25 ave          53 max          43 min
Histogram: 1 0 0 1 1 1 2 0 1 1
Nghost:        3424.75 ave        3457 max        3390 min
Histogram: 1 1 0 0 2 1 0 1 1 1
Neighs:        33086.1 ave       36214 max       29781 min
Histogram: 1 0 1 1 1 2 0 1 0 1

Total # of neighbors = 264689
Ave neighs/atom = 685.7228
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.4 | 137.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   292.77522     -44774.804      650.46921      0              3934.8755    
       100   293.69611     -44759.457     -6088.148      -497.02715      3934.8755    
       200   306.75421     -44743.313      10185.487     -1330.6584      3934.8755    
       300   310.58453     -44747.802      18953.734      2633.1399      3934.8755    
       400   298.08253     -44752.202     -11941.618      1905.8077      3934.8755    
       500   306.64992     -44775.691      2283.879      -1227.0389      3934.8755    
       600   292.01489     -44775.064     -1361.5713      3198.3336      3934.8755    
       700   283.006       -44760.321     -9322.8466     -25.755288      3934.8755    
       800   313.24396     -44744.834     -3471.8089      1803.0044      3934.8755    
       900   323.20671     -44751.631      7574.9996      3003.1713      3934.8755    
      1000   292.30505     -44741.093     -9596.3266      380.62928      3934.8755    
      1100   294.76706     -44761.027     -4810.7527      1104.0009      3934.8755    
      1200   282.14669     -44752.833      6736.4286      4332.1829      3934.8755    
      1300   290.7771      -44738.174     -4467.9689     -107.86837      3934.8755    
      1400   322.52763     -44746.051      8297.7537      4312.9808      3934.8755    
      1500   299.06429     -44731.348     -1783.9097      7665.2726      3934.8755    
      1600   301.77324     -44759.507      4083.834       3918.9554      3934.8755    
      1700   304.5047      -44764.8        10034.809      1855.0472      3934.8755    
      1800   292.5547      -44762.944     -3773.7915      2458.79        3934.8755    
      1900   283.77213     -44775.061     -2174.0952     -6664.5914      3934.8755    
      2000   295.17376     -44787.131      1424.6392      4878.3641      3934.8755    
Loop time of 67.9288 on 16 procs for 2000 steps with 386 atoms

Performance: 1.272 ns/day, 18.869 hours/ns, 29.443 timesteps/s, 11.365 katom-step/s
99.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 54.209     | 55.39      | 56.011     |   7.6 | 81.54
Bond    | 0.00054212 | 0.00070596 | 0.0009787  |   0.0 |  0.00
Neigh   | 4.6635     | 4.7521     | 4.8604     |   3.1 |  7.00
Comm    | 0.65571    | 1.276      | 2.4638     |  50.3 |  1.88
Output  | 0.00089931 | 0.0010167  | 0.0012837  |   0.3 |  0.00
Modify  | 6.3565     | 6.4642     | 6.549      |   2.6 |  9.52
Other   |            | 0.0447     |            |       |  0.07

Nlocal:          48.25 ave          55 max          44 min
Histogram: 3 0 1 0 0 2 0 1 0 1
Nghost:        3446.75 ave        3478 max        3425 min
Histogram: 3 1 0 0 0 1 1 1 0 1
Neighs:        33097.1 ave       37618 max       30223 min
Histogram: 3 0 1 0 0 2 0 1 0 1

Total # of neighbors = 264777
Ave neighs/atom = 685.95078
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -9.67929982113675
variable C2neg equal ${d2}
variable C2neg equal -14.6636273423681
variable C3neg equal ${d3}
variable C3neg equal 12.4381334278695
variable C4neg equal ${d4}
variable C4neg equal 0.969661240167846
variable C5neg equal ${d5}
variable C5neg equal -19.5522629452037
variable C6neg equal ${d6}
variable C6neg equal 16.3971679638563

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.3464 -0.3071 -0.018)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.589
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.13589 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.7222 13.589 17.3161) with tilt (-7.21051 -0.3071 -0.018)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.1 | 135.1 | 137.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   287.81495     -44766.503     -5831.0127      0              3934.8755    
       100   278.66584     -44749.61       1802.035       1236.5188      3934.8755    
       200   310.22446     -44748.244     -5099.8675      2522.1148      3934.8755    
       300   309.38355     -44725.506     -12323.227      4769.1161      3934.8755    
       400   318.0588      -44740.912     -152.3163       4466.6192      3934.8755    
       500   315.66849     -44759.629     -2389.9394      5448.4535      3934.8755    
       600   301.84395     -44765.973      12113.568      5268.1602      3934.8755    
       700   269.13959     -44739.625     -7750.0915     -4755.8712      3934.8755    
       800   286.39375     -44752.304      1166.174       2829.0455      3934.8755    
       900   290.25997     -44736.692      11790.299      5242.8269      3934.8755    
      1000   301.42463     -44732.527      11065.748      3887.104       3934.8755    
      1100   311.47063     -44743.354     -10688.439      2473.3707      3934.8755    
      1200   309.61499     -44761.567     -573.00058      920.23729      3934.8755    
      1300   283.90501     -44759.549     -5014.4495      3328.7092      3934.8755    
      1400   286.93559     -44766.29       3449.5781      3894.325       3934.8755    
      1500   305.33122     -44766.098     -6273.1965      3644.6392      3934.8755    
      1600   304.98141     -44741.987     -10161.467     -7229.5611      3934.8755    
      1700   320.2984      -44748.416      11095.041      5427.1423      3934.8755    
      1800   306.35636     -44742.608     -2573.4142      5490.023       3934.8755    
      1900   310.39874     -44763.769     -4592.4394     -1622.2446      3934.8755    
      2000   284.61979     -44753.417      13517.334      4719.0311      3934.8755    
Loop time of 62.9665 on 16 procs for 2000 steps with 386 atoms

Performance: 1.372 ns/day, 17.491 hours/ns, 31.763 timesteps/s, 12.260 katom-step/s
99.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 48.764     | 50.396     | 51.26      |   9.9 | 80.04
Bond    | 0.00042626 | 0.00061856 | 0.00076321 |   0.0 |  0.00
Neigh   | 4.5834     | 4.6704     | 4.7588     |   3.0 |  7.42
Comm    | 0.53158    | 1.3926     | 3.0298     |  59.8 |  2.21
Output  | 0.002996   | 0.0053932  | 0.0064996  |   1.9 |  0.01
Modify  | 6.3684     | 6.4564     | 6.5397     |   2.5 | 10.25
Other   |            | 0.04542    |            |       |  0.07

Nlocal:          48.25 ave          56 max          42 min
Histogram: 2 0 1 0 1 1 2 0 0 1
Nghost:        3433.62 ave        3487 max        3383 min
Histogram: 1 1 1 0 0 2 1 1 0 1
Neighs:        33071.1 ave       37923 max       28883 min
Histogram: 2 0 1 0 1 1 2 0 0 1

Total # of neighbors = 264569
Ave neighs/atom = 685.41192
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.1 | 135.1 | 137.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   284.61979     -44753.417      13517.295      0              3934.8755    
       100   306.0089      -44773.601      12663.697      7474.3026      3934.8755    
       200   288.41287     -44741.796      18.672492      2728.671       3934.8755    
       300   326.68232     -44759.003     -4013.9948      4054.9036      3934.8755    
       400   322.48255     -44750.586      5897.451      -4789.639       3934.8755    
       500   310.6052      -44764.582      6912.9154     -1538.6105      3934.8755    
       600   300.97427     -44774.358      5939.7789      713.51512      3934.8755    
       700   292.50456     -44769.191      1857.2159      2332.9158      3934.8755    
       800   296.91994     -44770.633     -2475.9196      922.66048      3934.8755    
       900   299.64677     -44759.563     -1820.3228      7586.3072      3934.8755    
      1000   302.86347     -44724.535      12698.108      2067.5699      3934.8755    
      1100   318.17747     -44734.406      4837.1886      6296.3253      3934.8755    
      1200   317.45271     -44753.112     -253.18632      3811.3026      3934.8755    
      1300   291.77261     -44748.479      4146.5987     -267.71178      3934.8755    
      1400   301.30996     -44773.045      1214.1441      3680.4334      3934.8755    
      1500   294.64544     -44775.478      2637.8165      8780.6256      3934.8755    
      1600   286.89509     -44762.645      2353.6683     -174.44597      3934.8755    
      1700   318.21249     -44750.454      883.97044     -604.27435      3934.8755    
      1800   315.27095     -44744.628     -1675.2933     -82.478815      3934.8755    
      1900   305.20193     -44759.995      1574.4982      6089.1613      3934.8755    
      2000   288.39202     -44758.466     -6058.0992     -1238.5317      3934.8755    
Loop time of 62.9685 on 16 procs for 2000 steps with 386 atoms

Performance: 1.372 ns/day, 17.491 hours/ns, 31.762 timesteps/s, 12.260 katom-step/s
99.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 49.184     | 50.434     | 51.334     |   8.6 | 80.09
Bond    | 0.00041237 | 0.000612   | 0.00077628 |   0.0 |  0.00
Neigh   | 4.5865     | 4.6794     | 4.8309     |   3.5 |  7.43
Comm    | 0.50529    | 1.4029     | 2.6561     |  51.5 |  2.23
Output  | 0.00088927 | 0.00098848 | 0.0012284  |   0.0 |  0.00
Modify  | 6.2559     | 6.4038     | 6.4924     |   2.9 | 10.17
Other   |            | 0.04636    |            |       |  0.07

Nlocal:          48.25 ave          56 max          39 min
Histogram: 1 0 0 1 2 0 1 2 0 1
Nghost:           3438 ave        3482 max        3393 min
Histogram: 2 0 1 0 1 0 1 1 1 1
Neighs:        33100.2 ave       38158 max       27051 min
Histogram: 1 0 0 1 2 0 1 2 0 1

Total # of neighbors = 264802
Ave neighs/atom = 686.01554
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 71.6587462501663
variable C2pos equal ${d2}
variable C2pos equal 52.987157584563
variable C3pos equal ${d3}
variable C3pos equal 101.254048051034
variable C4pos equal ${d4}
variable C4pos equal -12.0172032267332
variable C5pos equal ${d5}
variable C5pos equal 15.0979987681883
variable C6pos equal ${d6}
variable C6pos equal -0.909270136941378

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-9.67929982113675+${C1pos})
variable C16 equal 0.5*(-9.67929982113675+71.6587462501663)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-14.6636273423681+${C2pos})
variable C26 equal 0.5*(-14.6636273423681+52.987157584563)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(12.4381334278695+${C3pos})
variable C36 equal 0.5*(12.4381334278695+101.254048051034)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(0.969661240167846+${C4pos})
variable C46 equal 0.5*(0.969661240167846+-12.0172032267332)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(-19.5522629452037+${C5pos})
variable C56 equal 0.5*(-19.5522629452037+15.0979987681883)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(16.3971679638563+${C6pos})
variable C66 equal 0.5*(16.3971679638563+-0.909270136941378)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 48.5053863237908
variable C22all equal ${C22}
variable C22all equal 73.2344558489563
variable C33all equal ${C33}
variable C33all equal 55.8467535387628

variable C44all equal ${C44}
variable C44all equal 7.73325908069932
variable C55all equal ${C55}
variable C55all equal -4.74580524427335
variable C66all equal ${C66}
variable C66all equal 7.74394891345746

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(30.7436573561465+${C21})
variable C12all equal 0.5*(30.7436573561465+29.0917663414496)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(21.0758462119878+${C31})
variable C13all equal 0.5*(21.0758462119878+37.3519778261115)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(29.027809625975+${C32})
variable C23all equal 0.5*(29.027809625975+52.2622960346334)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(35.2394241546816+${C41})
variable C14all equal 0.5*(35.2394241546816+-2.93018178812841)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-31.3654839276779+${C51})
variable C15all equal 0.5*(-31.3654839276779+10.0381400681148)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(30.9897232145148+${C61})
variable C16all equal 0.5*(30.9897232145148+1.4141361462637)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(2.09172336331765+${C42})
variable C24all equal 0.5*(2.09172336331765+-10.2985781110122)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-19.1153919334427+${C52})
variable C25all equal 0.5*(-19.1153919334427+-4.2480564460737)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(19.1617651210974+${C62})
variable C26all equal 0.5*(19.1617651210974+-0.94230361927013)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(23.4999632739728+${C43})
variable C34all equal 0.5*(23.4999632739728+10.6327962075343)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-19.3343565127064+${C53})
variable C35all equal 0.5*(-19.3343565127064+-10.4649550674492)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(56.8460907394518+${C63})
variable C36all equal 0.5*(56.8460907394518+8.16725994772575)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(5.11917893954866+${C54})
variable C45all equal 0.5*(5.11917893954866+-11.3654013542598)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-5.52377099328268+${C64})
variable C46all equal 0.5*(-5.52377099328268+-4.60709204645375)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-2.2271320885077+${C65})
variable C56all equal 0.5*(-2.2271320885077+-2.40927831987105)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:40:09
