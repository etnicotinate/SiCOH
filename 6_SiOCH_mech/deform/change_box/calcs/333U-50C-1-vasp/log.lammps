LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 30*${nthermo}       # steps of equilibration run 20
variable nequil equal 30*100       
variable nrun equal 30*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 30*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-1-vasp
read_data       ${structure}.data
read_data       333U-50C-1-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.006 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 4.97708e-05 on 8 procs for 1 steps with 362 atoms

53.0% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.606e-06  | 1.606e-06  | 1.606e-06  |   0.0 |  3.23
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 4.121e-06  | 4.121e-06  | 4.121e-06  |   0.0 |  8.28
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 4.404e-05  |            |       | 88.49

Nlocal:          45.25 ave          51 max          37 min
Histogram: 1 0 0 1 1 1 0 2 1 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-1-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 3000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -7.38 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.5 | 130.8 | 131.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -40664.228      99992.787      0              1.6616584      3964.6564    
       100   740.8413      -41529.586     -10865.282      4784.737       1.6616584      3964.6564    
       200   483.66151     -41655.737     -15689.13       973.40462      1.6616584      3964.6564    
       300   445.20455     -41908.367     -20086.048     -3990.9138      1.6616584      3964.6564    
       400   388.33782     -42054.271      11136.418      4379.5313      1.6616584      3964.6564    
       500   329.4184      -42142.088      1460.1216     -5161.8389      1.6616584      3964.6564    
       600   278.92129     -42178.288     -10564.38      -7488.1879      1.6616584      3964.6564    
       700   274.89052     -42217.21       1651.2021     -6254.7373      1.6616584      3964.6564    
       800   295.35122     -42234.634     -1371.6273     -2150.7416      1.6616584      3964.6564    
       900   308.63426     -42232.201     -4233.001      -966.30669      1.6616584      3964.6564    
      1000   306.87897     -42240.663     -9968.0073     -4106.2584      1.6616584      3964.6564    
      1100   301.70722     -42259.421     -3096.0581     -3747.5144      1.6616584      3964.6564    
      1200   301.75541     -42275.705     -31783.501     -4023.2574      1.6616584      3964.6564    
      1300   299.28222     -42282.522     -3771.6584     -5604.0143      1.6616584      3964.6564    
      1400   280.0515      -42257.507      2888.2296     -7893.1692      1.6616584      3964.6564    
      1500   307.35524     -42271.036      248.29954     -8829.5036      1.6616584      3964.6564    
      1600   313.16546     -42263.909      258.13097     -4703.7915      1.6616584      3964.6564    
      1700   314.2632      -42265.192      10465         -2918.7336      1.6616584      3964.6564    
      1800   295.97837     -42270.323     -2079.0797     -9203.4927      1.6616584      3964.6564    
      1900   286.24232     -42287.526     -3593.7428     -2414.1218      1.6616584      3964.6564    
      2000   282.68742     -42286.447     -9664.1942     -8817.8948      1.6616584      3964.6564    
      2100   294.16539     -42277.253      3492.2615     -2505.2865      1.6616584      3964.6564    
      2200   330.79624     -42297.306      1561.8081     -4744.8906      1.6616584      3964.6564    
      2300   316.43258     -42281.803     -3572.4911     -6313.6841      1.6616584      3964.6564    
      2400   312.45939     -42297.506      3447.6242     -9723.5796      1.6616584      3964.6564    
      2500   281.33349     -42289.628     -8198.8405     -12536.627      1.6616584      3964.6564    
      2600   275.7291      -42297.408     -8755.4062     -12257.392      1.6616584      3964.6564    
      2700   293.43592     -42311.035     -7631.5465     -3770.7434      1.6616584      3964.6564    
      2800   309.48118     -42314.11      -17299.58      -6613.8496      1.6616584      3964.6564    
      2900   317.13087     -42309.86      -5088.916      -5600.818       1.6616584      3964.6564    
      3000   291.54158     -42294.28      -1663.4264     -2940.0937      1.6616584      3964.6564    
Loop time of 149.525 on 8 procs for 3000 steps with 362 atoms

Performance: 0.867 ns/day, 27.690 hours/ns, 20.064 timesteps/s, 7.263 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 100.1      | 115.78     | 125.54     | 102.7 | 77.43
Bond    | 0.0086062  | 0.0090921  | 0.0099685  |   0.4 |  0.01
Neigh   | 7.5118     | 8.6298     | 9.4123     |  27.4 |  5.77
Comm    | 2.7469     | 12.521     | 28.198     | 312.2 |  8.37
Output  | 0.0016821  | 0.001878   | 0.0028201  |   0.8 |  0.00
Modify  | 11.723     | 12.512     | 13.636     |  22.9 |  8.37
Other   |            | 0.07575    |            |       |  0.05

Nlocal:          45.25 ave          49 max          43 min
Histogram: 3 1 0 0 0 1 2 0 0 1
Nghost:        3358.12 ave        3402 max        3317 min
Histogram: 1 1 0 1 1 2 0 0 1 1
Neighs:        28866.6 ave       31167 max       27316 min
Histogram: 3 0 1 0 0 1 2 0 0 1

Total # of neighbors = 230933
Ave neighs/atom = 637.93646
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-1-vasp_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 17.1722
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.1279
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.5867

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--2940.09372688555)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--2940.09372688555)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--3177.13877775185)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--3177.13877775185)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-2250.06600703549)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-2250.06600703549)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-6574.99580513221)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-6574.99580513221)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-880.810994912871)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-880.810994912871)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-1496.35527502351)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1-1496.35527502351)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 17.1722
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.1722
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.171722 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.171722 xy delta 0.08382 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.171722 xy delta 0.08382 xz delta -0.000305 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.000478 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.000478 13.1279 17.5867) with tilt (-8.29818 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.000478 13.1279 17.5867) with tilt (-8.29818 0.030195 0.3027)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.6 | 130.9 | 132.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.54158     -42277.914      43551.551      0              3925.0098    
       100   294.82554     -42307.189     -6326.0697     -2671.5567      3925.0098    
       200   290.8959      -42321.569     -1560.4709     -4440.1189      3925.0098    
       300   275.09978     -42312.963     -13206.822     -7445.6567      3925.0098    
       400   308.09111     -42330.111     -1471.0622     -5443.9825      3925.0098    
       500   309.7638      -42315.284     -596.13949      627.4274       3925.0098    
       600   311.1617      -42311.197     -8175.2174     -3654.9448      3925.0098    
       700   302.45188     -42318.187     -3935.9861     -2653.3373      3925.0098    
       800   292.51774     -42340.111     -5173.4455     -2521.0231      3925.0098    
       900   292.98641     -42352.931     -8874.6424     -6452.147       3925.0098    
      1000   300.1409      -42346.745     -11634.872     -2814.1829      3925.0098    
      1100   313.69903     -42339.658     -11653.477     -4407.6682      3925.0098    
      1200   305.72514     -42315.957      12388.43      -973.3755       3925.0098    
      1300   309.13253     -42315.546     -1670.8402      1954.036       3925.0098    
      1400   306.50662     -42335.116     -11746.695     -8278.8664      3925.0098    
      1500   301.09162     -42355.072     -10339.082     -5219.6747      3925.0098    
      1600   287.67549     -42351.623     -6955.579      -6252.5883      3925.0098    
      1700   311.24094     -42363.85      -7594.6828     -5179.7768      3925.0098    
      1800   309.57445     -42330.216      9862.87       -3758.0746      3925.0098    
      1900   312.2821      -42331.261     -4614.6165     -4299.685       3925.0098    
      2000   302.26956     -42334.853      1558.5068     -1097.3114      3925.0098    
      2100   321.06324     -42362.115     -2196.7601     -3955.0846      3925.0098    
      2200   297.09936     -42341.523     -9049.1293     -6392.3887      3925.0098    
      2300   286.65952     -42331.282     -6645.5392     -2058.7169      3925.0098    
      2400   301.01658     -42335.224      5920.623      -1173.7074      3925.0098    
      2500   307.38131     -42319.945      8994.5382     -73.8529        3925.0098    
      2600   306.01647     -42308.819      7419.996      -5157.1609      3925.0098    
      2700   288.75466     -42307.23      -3455.9744      2000.1749      3925.0098    
      2800   297.83155     -42350.796      3034.7766      364.93468      3925.0098    
      2900   280.26238     -42335.209      4034.8323     -767.76055      3925.0098    
      3000   289.23088     -42333.688      2321.9127      1043.0428      3925.0098    
Loop time of 153.316 on 8 procs for 3000 steps with 362 atoms

Performance: 0.845 ns/day, 28.392 hours/ns, 19.567 timesteps/s, 7.083 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 102.15     | 118.05     | 128.4      | 102.1 | 77.00
Bond    | 0.0081368  | 0.0089495  | 0.0097834  |   0.5 |  0.01
Neigh   | 7.5616     | 8.7347     | 9.6138     |  27.6 |  5.70
Comm    | 3.1476     | 13.499     | 29.392     | 301.9 |  8.80
Output  | 0.0070487  | 0.010308   | 0.012086   |   1.9 |  0.01
Modify  | 12.069     | 12.939     | 14.112     |  22.7 |  8.44
Other   |            | 0.07588    |            |       |  0.05

Nlocal:          45.25 ave          50 max          39 min
Histogram: 1 0 2 1 0 0 0 1 0 3
Nghost:         3384.5 ave        3404 max        3364 min
Histogram: 2 0 0 1 0 1 1 1 0 2
Neighs:        29145.5 ave       32116 max       25364 min
Histogram: 1 0 2 1 0 0 1 0 0 3

Total # of neighbors = 233164
Ave neighs/atom = 644.09945
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.6 | 130.9 | 132.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.23088     -42333.688      2321.859       0              3925.0098    
       100   297.66684     -42329.832      6874.4785      630.35687      3925.0098    
       200   314.65186     -42321.823      6275.4017     -4683.4591      3925.0098    
       300   321.37514     -42323.511      1827.544      -6646.1504      3925.0098    
       400   294.99564     -42336.927      9988.7025      168.20661      3925.0098    
       500   308.44242     -42364.35       1049.4598     -4927.2051      3925.0098    
       600   291.8897      -42341.151     -3908.0288     -1397.725       3925.0098    
       700   293.00602     -42315.837      2909.5803     -1823.6481      3925.0098    
       800   313.46206     -42320.803     -2546.5834      1306.7343      3925.0098    
       900   301.72519     -42317.835      7371.4474      699.77702      3925.0098    
      1000   289.80736     -42317.696     -1482.4864     -4458.3794      3925.0098    
      1100   306.42747     -42338.809      9155.5749     -759.01323      3925.0098    
      1200   302.38414     -42338.783      129.57668     -6257.011       3925.0098    
      1300   292.66226     -42327.64      -1745.9728     -5651.4397      3925.0098    
      1400   308.57069     -42346.544      11304.951      1608.1016      3925.0098    
      1500   296.50609     -42345.181      6898.4242     -2653.991       3925.0098    
      1600   292.16372     -42371.89       5410.3221     -259.8375       3925.0098    
      1700   277.91108     -42360.753      1871.6917      302.76338      3925.0098    
      1800   291.84489     -42355.917     -7186.3705     -3008.2675      3925.0098    
      1900   291.90537     -42343.249      2429.8603     -4009.2355      3925.0098    
      2000   279.7636      -42314.972      2852.635      -1986.2278      3925.0098    
      2100   326.30371     -42349.79      -6442.3504     -1746.4253      3925.0098    
      2200   309.62225     -42336.762     -8731.2453     -4035.2817      3925.0098    
      2300   295.04283     -42351.63      -4317.194       250.31265      3925.0098    
      2400   283.07343     -42347.537      7679.1414      1842.0243      3925.0098    
      2500   287.30761     -42333.151     -2134.6093      1398.0845      3925.0098    
      2600   323.41374     -42337.149     -11492.741     -3767.2185      3925.0098    
      2700   316.43628     -42338.145     -6328.9869     -1674.7532      3925.0098    
      2800   302.5729      -42350.195      6273.8038     -1527.8021      3925.0098    
      2900   288.81256     -42355.5        9307.6982      2458.6597      3925.0098    
      3000   300.94037     -42364.225      2624.9256      336.36207      3925.0098    
Loop time of 153.775 on 8 procs for 3000 steps with 362 atoms

Performance: 0.843 ns/day, 28.477 hours/ns, 19.509 timesteps/s, 7.062 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 100.28     | 121.12     | 129.96     |  98.1 | 78.77
Bond    | 0.0081575  | 0.0091238  | 0.0098096  |   0.6 |  0.01
Neigh   | 7.4608     | 8.9533     | 9.589      |  25.0 |  5.82
Comm    | 2.0724     | 10.913     | 31.751     | 326.9 |  7.10
Output  | 0.0013695  | 0.001606   | 0.0030455  |   1.4 |  0.00
Modify  | 12.068     | 12.698     | 14.195     |  21.0 |  8.26
Other   |            | 0.07659    |            |       |  0.05

Nlocal:          45.25 ave          49 max          41 min
Histogram: 1 0 1 1 0 2 1 0 0 2
Nghost:        3385.88 ave        3419 max        3360 min
Histogram: 2 1 0 1 1 1 0 0 0 2
Neighs:        29181.6 ave       31534 max       26441 min
Histogram: 1 0 1 0 2 1 1 0 0 2

Total # of neighbors = 233453
Ave neighs/atom = 644.89779
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 33.1986883493756
variable C2neg equal ${d2}
variable C2neg equal 72.706027242816
variable C3neg equal ${d3}
variable C3neg equal 48.9882816795262
variable C4neg equal ${d4}
variable C4neg equal -14.955016167159
variable C5neg equal ${d5}
variable C5neg equal -9.46347166727684
variable C6neg equal ${d6}
variable C6neg equal -8.02672030816068

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.1722
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.171722 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.171722 xy delta -0.08382 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.171722 xy delta -0.08382 xz delta 0.000305 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.343922 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.343922 13.1279 17.5867) with tilt (-8.46582 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.343922 13.1279 17.5867) with tilt (-8.46582 0.030805 0.3027)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.7 | 130.1 | 131.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.54158     -42272.512     -45132.834      0              4004.3029    
       100   301.90596     -42304.475     -7201.6859     -13710.011      4004.3029    
       200   297.18176     -42309.923     -11718.1       -12241.78       4004.3029    
       300   288.4529      -42307.528     -7534.1499     -10803.903      4004.3029    
       400   292.97085     -42299.375     -119.42012     -10865.665      4004.3029    
       500   327.5652      -42322.453     -2099.5405     -11280.982      4004.3029    
       600   306.32825     -42302.275     -9532.6407     -5817.6278      4004.3029    
       700   315.09044     -42313.475     -9489.8968     -17668.878      4004.3029    
       800   296.63838     -42308.059     -4199.5744     -9551.896       4004.3029    
       900   291.79382     -42315.807     -8398.9413     -11937.756      4004.3029    
      1000   285.84764     -42311.084      2187.3939     -10238.149      4004.3029    
      1100   280.87763     -42290.761     -17831.729     -12499.243      4004.3029    
      1200   329.74629     -42316.414     -8667.381      -11939.936      4004.3029    
      1300   338.568       -42332.982     -1093.6423     -9302.8598      4004.3029    
      1400   302.31759     -42329.406     -8855.3594     -8297.4384      4004.3029    
      1500   283.7547      -42324.438     -12169.329     -12262.046      4004.3029    
      1600   283.69499     -42322.159     -8620.4977     -7181.7712      4004.3029    
      1700   297.45617     -42311.123     -11548.057     -12504.6        4004.3029    
      1800   315.30605     -42313.902     -5029.0021     -16639.113      4004.3029    
      1900   318.46425     -42331.169     -4882.3917     -11055.994      4004.3029    
      2000   308.44707     -42345.334     -7018.8658     -10189.681      4004.3029    
      2100   296.18468     -42335.615     -10665.16      -10208.408      4004.3029    
      2200   293.53251     -42327.695     -8217.0419     -10104.365      4004.3029    
      2300   295.2188      -42304.087     -3419.5329     -14618.142      4004.3029    
      2400   314.70647     -42311.128      1582.5619     -10010.559      4004.3029    
      2500   298.13269     -42304.941     -2948.1683     -9205.198       4004.3029    
      2600   296.59441     -42314.018     -4798.4188     -7875.5689      4004.3029    
      2700   304.83076     -42320.945     -12205.836     -8176.5333      4004.3029    
      2800   305.61477     -42319.815      6121.1068     -6939.6143      4004.3029    
      2900   299.7271      -42331.972     -10502.848     -13712.052      4004.3029    
      3000   290.12206     -42354.864      8312.1388     -10639.528      4004.3029    
Loop time of 148.285 on 8 procs for 3000 steps with 362 atoms

Performance: 0.874 ns/day, 27.460 hours/ns, 20.231 timesteps/s, 7.324 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 87.951     | 117.22     | 125.51     | 111.1 | 79.05
Bond    | 0.0083043  | 0.0091999  | 0.0098728  |   0.5 |  0.01
Neigh   | 6.7316     | 8.7924     | 9.4779     |  29.1 |  5.93
Comm    | 1.6443     | 9.9511     | 39.209     | 381.3 |  6.71
Output  | 0.0071605  | 0.0089917  | 0.010351   |   1.2 |  0.01
Modify  | 11.548     | 12.23      | 14.305     |  24.8 |  8.25
Other   |            | 0.07733    |            |       |  0.05

Nlocal:          45.25 ave          48 max          43 min
Histogram: 1 0 3 0 1 0 0 0 2 1
Nghost:           3334 ave        3380 max        3284 min
Histogram: 1 0 0 3 1 0 0 1 0 2
Neighs:        28542.5 ave       30259 max       26920 min
Histogram: 1 0 2 1 1 0 0 0 2 1

Total # of neighbors = 228340
Ave neighs/atom = 630.77348
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.7 | 129.8 | 131.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.12206     -42354.864      8312.1876      0              4004.3029    
       100   293.22876     -42342.308      1163.3954     -9484.6451      4004.3029    
       200   299.2991      -42322.383     -19437.354     -12351.035      4004.3029    
       300   306.89228     -42326.666     -14302.371     -9776.2514      4004.3029    
       400   323.55371     -42354.933     -9536.1084     -13003.697      4004.3029    
       500   298.0114      -42347.324     -17954.807     -11810.645      4004.3029    
       600   300.19048     -42352.759      1001.5342     -5704.2625      4004.3029    
       700   307.24777     -42357.622     -45.160302     -15091.966      4004.3029    
       800   303.55156     -42334.693     -8674.3288     -8989.4761      4004.3029    
       900   306.64102     -42299.417     -1619.8509     -14871.545      4004.3029    
      1000   337.92244     -42341.531     -5650.0045     -9802.8637      4004.3029    
      1100   305.88663     -42340.021     -8646.8174     -4681.5174      4004.3029    
      1200   299.00349     -42348.306     -17534.268     -9263.7638      4004.3029    
      1300   307.8671      -42356.434     -6531.5535     -7662.1574      4004.3029    
      1400   321.31526     -42366.931     -10973.023     -13175.398      4004.3029    
      1500   306.40705     -42352.209     -8150.3694     -15369.699      4004.3029    
      1600   301.74278     -42352.691      1946.4454     -11845.48       4004.3029    
      1700   310.57475     -42368.831     -3772.3085     -8161.334       4004.3029    
      1800   296.97156     -42361.703      4607.9677     -9729.9241      4004.3029    
      1900   295.27287     -42347.863     -13225.902     -8242.5761      4004.3029    
      2000   314.54771     -42336.558     -5079.1712     -10527.866      4004.3029    
      2100   294.6189      -42325.144     -14575.012     -17288.356      4004.3029    
      2200   290.28739     -42336.567      4037.4029     -13451.84       4004.3029    
      2300   294.75561     -42360.452     -16959.305     -10181.721      4004.3029    
      2400   263.09563     -42357.663     -6981.5034     -8847.9814      4004.3029    
      2500   258.01836     -42372.284      2749.1365     -6495.926       4004.3029    
      2600   276.32208     -42357.409     -5578.5767     -10668.856      4004.3029    
      2700   307.89951     -42365.488     -7024.875      -13605.135      4004.3029    
      2800   320.61742     -42375.536     -1480.475      -13391.628      4004.3029    
      2900   318.70338     -42377.071     -5044.6969     -6203.2878      4004.3029    
      3000   294.50255     -42351.965     -17807.988     -11719.408      4004.3029    
Loop time of 149.447 on 8 procs for 3000 steps with 362 atoms

Performance: 0.867 ns/day, 27.675 hours/ns, 20.074 timesteps/s, 7.267 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 97.382     | 120.83     | 126.96     |  81.8 | 80.85
Bond    | 0.0082762  | 0.0092642  | 0.0099427  |   0.6 |  0.01
Neigh   | 7.3494     | 8.9472     | 9.4631     |  20.7 |  5.99
Comm    | 1.3732     | 7.5237     | 30.968     | 327.7 |  5.03
Output  | 0.0014409  | 0.0016418  | 0.0026568  |   1.0 |  0.00
Modify  | 11.552     | 12.062     | 13.668     |  17.8 |  8.07
Other   |            | 0.07631    |            |       |  0.05

Nlocal:          45.25 ave          49 max          40 min
Histogram: 1 0 1 0 1 1 1 0 2 1
Nghost:        3306.38 ave        3363 max        3251 min
Histogram: 1 0 1 3 0 0 1 0 0 2
Neighs:          28558 ave       30792 max       25230 min
Histogram: 1 0 1 0 1 1 0 1 1 2

Total # of neighbors = 228464
Ave neighs/atom = 631.11602
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 88.9563975965256
variable C2pos equal ${d2}
variable C2pos equal 135.014233916648
variable C3pos equal ${d3}
variable C3pos equal 29.8495815894431
variable C4pos equal ${d4}
variable C4pos equal 12.4605638301728
variable C5pos equal ${d5}
variable C5pos equal -21.7984813277555
variable C6pos equal ${d6}
variable C6pos equal 9.7031802866568

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(33.1986883493756+${C1pos})
variable C11 equal 0.5*(33.1986883493756+88.9563975965256)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(72.706027242816+${C2pos})
variable C21 equal 0.5*(72.706027242816+135.014233916648)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(48.9882816795262+${C3pos})
variable C31 equal 0.5*(48.9882816795262+29.8495815894431)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-14.955016167159+${C4pos})
variable C41 equal 0.5*(-14.955016167159+12.4605638301728)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(-9.46347166727684+${C5pos})
variable C51 equal 0.5*(-9.46347166727684+-21.7984813277555)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-8.02672030816068+${C6pos})
variable C61 equal 0.5*(-8.02672030816068+9.7031802866568)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.1279
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.1279
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.131279 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.131279 yz delta -0.003027 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.1722 12.996621 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.1722 12.996621 17.5867) with tilt (-8.382 0.0305 0.299673)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.5 | 131.4 | 132.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.54158     -42280.533      39524.962      0              3925.0098    
       100   300.45085     -42314.143     -7097.0724     -7230.044       3925.0098    
       200   299.90016     -42328.803     -13563.271     -8354.2127      3925.0098    
       300   286.14284     -42316.149     -9766.0297     -10248.04       3925.0098    
       400   297.37735     -42300.823     -5638.8455     -6077.6139      3925.0098    
       500   324.33486     -42308.426     -4189.3137     -5828.7378      3925.0098    
       600   310.87679     -42294.355     -3826.5985     -7271.3926      3925.0098    
       700   307.15813     -42306.618     -2144.5311     -13270.998      3925.0098    
       800   269.84882     -42292.838     -13285.393     -1289.0845      3925.0098    
       900   308.28746     -42337.478      4471.9162     -3695.8724      3925.0098    
      1000   294.43165     -42319.483      315.759       -10180.964      3925.0098    
      1100   289.35218     -42302.754     -3323.2731     -43.508598      3925.0098    
      1200   296.4287      -42302.955      9887.877      -4803.1659      3925.0098    
      1300   320.03944     -42325.819     -1772.9335     -800.97352      3925.0098    
      1400   291.42381     -42306.962     -12302.247     -11092.045      3925.0098    
      1500   283.70564     -42317.164     -9665.8706     -9713.4172      3925.0098    
      1600   284.09375     -42323.836     -6730.4056     -5410.7379      3925.0098    
      1700   294.20928     -42321.45      -4258.1348     -2445.0071      3925.0098    
      1800   316.0259      -42320.289      973.05782     -9434.3181      3925.0098    
      1900   317.03091     -42320.388      10974.142      391.49167      3925.0098    
      2000   294.96241     -42336.154      8813.519      -5250.7065      3925.0098    
      2100   278.21753     -42324.649     -6712.1395     -8378.8094      3925.0098    
      2200   307.66009     -42342.833     -324.72462     -9017.9177      3925.0098    
      2300   319.67375     -42337.326      599.08698     -3215.604       3925.0098    
      2400   326.39299     -42323.451     -10670.123     -4462.4343      3925.0098    
      2500   342.53403     -42317.534     -565.04502     -1591.5282      3925.0098    
      2600   315.81035     -42307.954     -5307.6397     -9779.0841      3925.0098    
      2700   332.86035     -42360.678     -11392.795     -7134.778       3925.0098    
      2800   280.53543     -42323.656     -1221.9817     -2726.5744      3925.0098    
      2900   285.57061     -42333.061      2648.2593     -6004.6719      3925.0098    
      3000   297.79426     -42355.646     -6453.3083     -6445.2539      3925.0098    
Loop time of 156.833 on 8 procs for 3000 steps with 362 atoms

Performance: 0.826 ns/day, 29.043 hours/ns, 19.129 timesteps/s, 6.925 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 120.69     | 127.56     | 131.32     |  30.0 | 81.34
Bond    | 0.0084633  | 0.0093174  | 0.010082   |   0.5 |  0.01
Neigh   | 9.1406     | 9.4751     | 9.6925     |   5.3 |  6.04
Comm    | 2.8357     | 6.5488     | 13.384     | 131.4 |  4.18
Output  | 0.0067222  | 0.0090392  | 0.010434   |   1.4 |  0.01
Modify  | 12.888     | 13.146     | 13.507     |   5.1 |  8.38
Other   |            | 0.0803     |            |       |  0.05

Nlocal:          45.25 ave          49 max          43 min
Histogram: 3 1 0 0 0 1 2 0 0 1
Nghost:        3398.25 ave        3412 max        3384 min
Histogram: 1 1 0 1 1 1 0 2 0 1
Neighs:        29159.6 ave       31513 max       27604 min
Histogram: 3 1 0 0 0 1 2 0 0 1

Total # of neighbors = 233277
Ave neighs/atom = 644.4116
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.6 | 131.4 | 132.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   297.79426     -42355.646     -6453.3353      0              3925.0098    
       100   284.79979     -42332.354     -4486.0939     -6353.654       3925.0098    
       200   308.47773     -42325.317     -8563.1321     -8509.9218      3925.0098    
       300   297.1994      -42311.18       307.41181     -11811.55       3925.0098    
       400   314.13955     -42340.007      476.55931     -4669.5517      3925.0098    
       500   293.68657     -42335.993      5663.3321     -2578.1096      3925.0098    
       600   298.16281     -42354.169      11094.367     -584.32166      3925.0098    
       700   275.21794     -42331.004      7537.7202     -7651.7228      3925.0098    
       800   292.49541     -42344.649     -20916.875     -9023.4275      3925.0098    
       900   316.29173     -42376.459      1816.7123     -3610.1263      3925.0098    
      1000   276.16436     -42333.828      2986.2366      1420.7232      3925.0098    
      1100   305.81722     -42351.336     -4437.3528     -5860.5056      3925.0098    
      1200   308.61869     -42314.745     -16894.486     -13728.577      3925.0098    
      1300   330.03147     -42325.416     -1279.4381     -4360.7144      3925.0098    
      1400   326.12387     -42349.31      -6422.3615     -1022.5809      3925.0098    
      1500   311.66269     -42352.723     -12632.062     -7549.5583      3925.0098    
      1600   306.7295      -42357.377      4536.5314     -2572.2628      3925.0098    
      1700   279.82658     -42339.922     -8005.1732     -12361.946      3925.0098    
      1800   279.27043     -42354.235     -10868.914     -6514.6027      3925.0098    
      1900   284.87529     -42365.87       3427.126      -8706.5798      3925.0098    
      2000   297.92661     -42353.549      2186.0959     -5343.375       3925.0098    
      2100   303.56234     -42335.166     -434.54277     -3913.0314      3925.0098    
      2200   314.13739     -42340.912      1740.6856     -6081.6874      3925.0098    
      2300   328.831       -42369.324     -2455.5819     -8255.516       3925.0098    
      2400   287.27051     -42352.712      17553.625     -117.21257      3925.0098    
      2500   269.5879      -42351.886     -4994.7384     -6549.6799      3925.0098    
      2600   269.29782     -42370.635      1453.7191     -2953.8918      3925.0098    
      2700   260.62356     -42338.416     -7170.2708     -9090.1394      3925.0098    
      2800   289.05215     -42335.934      5426.2302     -9417.9954      3925.0098    
      2900   293.86397     -42325.459     -265.76166     -5745.2762      3925.0098    
      3000   304.18796     -42334.688     -5515.7641     -11576.964      3925.0098    
Loop time of 155.083 on 8 procs for 3000 steps with 362 atoms

Performance: 0.836 ns/day, 28.719 hours/ns, 19.344 timesteps/s, 7.003 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 91.835     | 120.95     | 130.14     | 121.3 | 77.99
Bond    | 0.0084978  | 0.0091884  | 0.010129   |   0.5 |  0.01
Neigh   | 6.9791     | 9.0303     | 9.6212     |  31.0 |  5.82
Comm    | 2.4029     | 11.703     | 40.724     | 389.5 |  7.55
Output  | 0.0013913  | 0.0016991  | 0.0035784  |   1.7 |  0.00
Modify  | 12.62      | 13.311     | 15.461     |  26.2 |  8.58
Other   |            | 0.07905    |            |       |  0.05

Nlocal:          45.25 ave          52 max          39 min
Histogram: 1 0 0 3 1 1 0 0 1 1
Nghost:        3366.88 ave        3432 max        3310 min
Histogram: 1 1 1 0 2 1 0 0 1 1
Neighs:        29161.5 ave       33463 max       25403 min
Histogram: 1 0 1 2 1 1 0 0 1 1

Total # of neighbors = 233292
Ave neighs/atom = 644.45304
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -87.5130901968593
variable C2neg equal ${d2}
variable C2neg equal -4.36249083442998
variable C3neg equal ${d3}
variable C3neg equal -24.8266870600021
variable C4neg equal ${d4}
variable C4neg equal -13.8541220713322
variable C5neg equal ${d5}
variable C5neg equal 3.68303556592585
variable C6neg equal ${d6}
variable C6neg equal -17.6761759482473

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.1279
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.131279 yz delta ${deltayz} remap units box
change_box all y delta 0 0.131279 yz delta 0.003027 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.1722 13.259179 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.1722 13.259179 17.5867) with tilt (-8.382 0.0305 0.305727)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.1 | 129.3 | 131.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.54158     -42276.757     -39702.901      0              4004.3029    
       100   296.3702      -42301.161     -2478.4087     -8563.5536      4004.3029    
       200   300.88053     -42313.905     -4118.5404     -11037.146      4004.3029    
       300   286.05785     -42301.951     -17180.265     -13350.72       4004.3029    
       400   305.61695     -42307.394     -12486.618     -12636.356      4004.3029    
       500   293.08498     -42279.799      1288.9098     -10363.835      4004.3029    
       600   314.62657     -42300.698     -4017.1905     -7402.0994      4004.3029    
       700   323.09899     -42323.092     -10062.034     -10522.634      4004.3029    
       800   294.42597     -42326.403     -1938.285      -4484.0711      4004.3029    
       900   283.79472     -42334.962     -15071.568     -10031.333      4004.3029    
      1000   313.9135      -42364.596     -10443.92      -6618.4283      4004.3029    
      1100   298.06878     -42336.044      1292.3722     -7306.499       4004.3029    
      1200   313.51621     -42343.778     -4742.5368     -10480.434      4004.3029    
      1300   299.36302     -42319.698     -4192.6272     -2749.6797      4004.3029    
      1400   293.55943     -42318.056     -3667.0471     -7901.8469      4004.3029    
      1500   298.18998     -42337.772     -3213.4249     -8721.9004      4004.3029    
      1600   288.29093     -42342.287      13164.701     -4075.1455      4004.3029    
      1700   287.91715     -42340.236     -3525.1074     -7831.5027      4004.3029    
      1800   313.13212     -42333.804     -4205.0492     -6910.77        4004.3029    
      1900   317.91191     -42330.937      1042.4494     -8897.0787      4004.3029    
      2000   299.40888     -42316.244     -4458.3145     -8834.4941      4004.3029    
      2100   307.73002     -42346.37      -937.75842      4286.9642      4004.3029    
      2200   291.32069     -42361.898     -11445.898     -7670.7996      4004.3029    
      2300   287.69212     -42353.293     -5530.1586     -11476.038      4004.3029    
      2400   282.74958     -42327.594      6377.2477     -4939.9321      4004.3029    
      2500   299.93405     -42329.907      9211.5234     -2069.2261      4004.3029    
      2600   301.88497     -42341.571     -8242.7755     -3836.9665      4004.3029    
      2700   294.52247     -42368.474     -10662.183     -4617.2527      4004.3029    
      2800   288.30361     -42366.11      -6582.7316     -3958.7392      4004.3029    
      2900   293.18556     -42366.633      2557.9135     -2339.0508      4004.3029    
      3000   299.03393     -42355.378      5387.7257     -5215.737       4004.3029    
Loop time of 149.798 on 8 procs for 3000 steps with 362 atoms

Performance: 0.865 ns/day, 27.740 hours/ns, 20.027 timesteps/s, 7.250 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.079     | 120.18     | 126.39     | 111.0 | 80.23
Bond    | 0.0085008  | 0.0090598  | 0.010011   |   0.4 |  0.01
Neigh   | 6.7279     | 8.9231     | 9.4344     |  28.0 |  5.96
Comm    | 2.0636     | 8.2702     | 40.362     | 422.9 |  5.52
Output  | 0.0078729  | 0.0098381  | 0.011217   |   1.2 |  0.01
Modify  | 11.82      | 12.328     | 14.54      |  24.0 |  8.23
Other   |            | 0.07599    |            |       |  0.05

Nlocal:          45.25 ave          52 max          40 min
Histogram: 2 0 1 0 2 1 0 0 1 1
Nghost:        3312.25 ave        3365 max        3286 min
Histogram: 3 1 1 0 0 1 0 1 0 1
Neighs:        28559.4 ave       32686 max       25227 min
Histogram: 2 0 1 0 2 1 0 0 1 1

Total # of neighbors = 228475
Ave neighs/atom = 631.14641
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.1 | 129 | 131.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   299.03393     -42355.378      5387.7398      0              4004.3029    
       100   303.18821     -42359.727     -12269.869     -5583.3828      4004.3029    
       200   289.4759      -42345.435      2726.3361     -8233.9908      4004.3029    
       300   283.76054     -42338.413     -146.88058     -6688.4282      4004.3029    
       400   303.91455     -42356.068     -789.89545     -2908.263       4004.3029    
       500   312.26823     -42353.412     -6823.6427     -5547.4968      4004.3029    
       600   300.19834     -42346.935     -6752.0461     -9702.7835      4004.3029    
       700   291.12026     -42360.152      12501.949     -2515.8529      4004.3029    
       800   295.31057     -42377.933      5690.9232     -6706.8379      4004.3029    
       900   308.61098     -42368.866      3951.5117     -5682.2738      4004.3029    
      1000   346.00631     -42381.824      8668.4372     -1776.8561      4004.3029    
      1100   292.3228      -42329.196     -8729.6696     -6930.2261      4004.3029    
      1200   291.32632     -42338.106     -5785.2824     -7206.4928      4004.3029    
      1300   276.12601     -42343.587     -7291.5819     -9830.416       4004.3029    
      1400   290.77824     -42373.54      -1884.9007     -4766.1003      4004.3029    
      1500   285.14246     -42351.602     -7135.6869     -7549.5766      4004.3029    
      1600   307.09406     -42343.5        3460.359      -7628.546       4004.3029    
      1700   315.5238      -42352.403     -5088.4811     -8454.7692      4004.3029    
      1800   294.99405     -42355.714      5303.6096     -481.73344      4004.3029    
      1900   281.63094     -42352.088      244.9931       599.10101      4004.3029    
      2000   294.08586     -42360.743     -1841.9355     -4733.4667      4004.3029    
      2100   304.40724     -42367.202     -13596.211     -7937.5393      4004.3029    
      2200   280.43156     -42348.427     -5470.3286     -9832.6112      4004.3029    
      2300   285.20502     -42377.291     -4959.5357     -6666.0136      4004.3029    
      2400   298.04118     -42413.683     -5276.9099     -5103.9891      4004.3029    
      2500   287.52393     -42391.843     -5319.3792     -4131.1649      4004.3029    
      2600   298.77891     -42372.339     -8190.983      -8775.6033      4004.3029    
      2700   303.63032     -42366.376     -2993.7228     -12830.945      4004.3029    
      2800   309.61031     -42377.356     -404.81431     -6436.3126      4004.3029    
      2900   299.44957     -42389.806     -9636.9235     -5884.5916      4004.3029    
      3000   286.10536     -42380.202     -5787.6616     -8798.9609      4004.3029    
Loop time of 149.688 on 8 procs for 3000 steps with 362 atoms

Performance: 0.866 ns/day, 27.720 hours/ns, 20.042 timesteps/s, 7.255 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 87.718     | 120.33     | 126.37     | 112.6 | 80.39
Bond    | 0.0085222  | 0.0089852  | 0.0097161  |   0.4 |  0.01
Neigh   | 6.7241     | 8.9251     | 9.3879     |  28.0 |  5.96
Comm    | 2.0139     | 8.0508     | 40.656     | 435.1 |  5.38
Output  | 0.0013733  | 0.0015861  | 0.0025853  |   1.0 |  0.00
Modify  | 11.835     | 12.294     | 14.512     |  24.0 |  8.21
Other   |            | 0.07703    |            |       |  0.05

Nlocal:          45.25 ave          50 max          40 min
Histogram: 1 0 1 1 0 1 0 2 1 1
Nghost:        3302.88 ave        3316 max        3292 min
Histogram: 1 0 1 2 1 1 1 0 0 1
Neighs:        28557.6 ave       31472 max       25280 min
Histogram: 1 1 0 1 0 1 0 3 0 1

Total # of neighbors = 228461
Ave neighs/atom = 631.10773
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 59.364971917143
variable C2pos equal ${d2}
variable C2pos equal 36.170011389899
variable C3pos equal ${d3}
variable C3pos equal -25.6229615824814
variable C4pos equal ${d4}
variable C4pos equal 11.8597972291224
variable C5pos equal ${d5}
variable C5pos equal -8.84869667697723
variable C6pos equal ${d6}
variable C6pos equal 4.33300319433013

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(-87.5130901968593+${C1pos})
variable C12 equal 0.5*(-87.5130901968593+59.364971917143)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(-4.36249083442998+${C2pos})
variable C22 equal 0.5*(-4.36249083442998+36.170011389899)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(-24.8266870600021+${C3pos})
variable C32 equal 0.5*(-24.8266870600021+-25.6229615824814)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-13.8541220713322+${C4pos})
variable C42 equal 0.5*(-13.8541220713322+11.8597972291224)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(3.68303556592585+${C5pos})
variable C52 equal 0.5*(3.68303556592585+-8.84869667697723)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(-17.6761759482473+${C6pos})
variable C62 equal 0.5*(-17.6761759482473+4.33300319433013)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.5867
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.5867
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.175867 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.1722 13.1279 17.410833) with tilt (-8.382 0.0305 0.3027)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.5 | 131.6 | 132.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.54158     -42282.775      40911.268      0              3925.0098    
       100   294.67269     -42306.302     -10218.813     -7962.0979      3925.0098    
       200   299.41514     -42321.498     -4039.0415     -5186.87        3925.0098    
       300   280.00264     -42304.033     -2025.9382     -8778.6453      3925.0098    
       400   300.0852      -42306.33       6743.6242     -6914.2747      3925.0098    
       500   312.32668     -42305.207     -2254.7979     -1687.4214      3925.0098    
       600   322.54773     -42318.193     -14012.796     -6369.9711      3925.0098    
       700   316.26554     -42333.366      5994.4545     -9807.0602      3925.0098    
       800   282.95267     -42328.598      68.51068      -7583.87        3925.0098    
       900   281.26211     -42336.698     -7273.857      -8402.5556      3925.0098    
      1000   314.97479     -42355.04      -3526.9398     -5428.8126      3925.0098    
      1100   312.60028     -42328.955     -6139.0054     -2170.1659      3925.0098    
      1200   312.50896     -42330.69      -5890.6213     -10024.307      3925.0098    
      1300   309.82538     -42361.56      -1264.8218     -1691.4623      3925.0098    
      1400   280.70043     -42354.156     -5146.8607     -3837.843       3925.0098    
      1500   290.19251     -42352.843     -5630.2281     -1005.9503      3925.0098    
      1600   307.20578     -42346.822     -3786.4225     -3244.7728      3925.0098    
      1700   311.05978     -42335.616     -15190.42      -7405.5251      3925.0098    
      1800   303.45836     -42332.343      9771.5269     -7988.1806      3925.0098    
      1900   297.81941     -42360.438      5975.5408     -4722.4107      3925.0098    
      2000   286.61965     -42364.32       4684.006      -4979.6976      3925.0098    
      2100   307.858       -42374.5        1674.8777     -4903.2873      3925.0098    
      2200   310.66158     -42359.581      7023          -2674.2566      3925.0098    
      2300   327.47332     -42369.565     -573.70349     -9698.9138      3925.0098    
      2400   303.12666     -42349.259     -12377.966     -4192.745       3925.0098    
      2500   313.41368     -42373.678     -9413.5794     -4812.0216      3925.0098    
      2600   275.13431     -42380.572     -1548.1458     -9016.632       3925.0098    
      2700   282.70199     -42374.956     -9552.0584     -8278.6837      3925.0098    
      2800   295.79219     -42362.354      10634.478     -660.01091      3925.0098    
      2900   296.79813     -42346.957      6991.206      -7982.6303      3925.0098    
      3000   302.66237     -42338.012      10168.732     -1228.0753      3925.0098    
Loop time of 155.018 on 8 procs for 3000 steps with 362 atoms

Performance: 0.836 ns/day, 28.707 hours/ns, 19.353 timesteps/s, 7.006 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 99.956     | 125.7      | 131.04     |  87.3 | 81.09
Bond    | 0.008379   | 0.0091455  | 0.0098724  |   0.5 |  0.01
Neigh   | 7.4457     | 9.2245     | 9.6037     |  22.3 |  5.95
Comm    | 2.1015     | 7.449      | 33.181     | 358.4 |  4.81
Output  | 0.0069577  | 0.0096579  | 0.011313   |   1.6 |  0.01
Modify  | 12.176     | 12.549     | 14.345     |  19.3 |  8.10
Other   |            | 0.07603    |            |       |  0.05

Nlocal:          45.25 ave          50 max          41 min
Histogram: 1 0 1 1 1 2 1 0 0 1
Nghost:        3380.88 ave        3408 max        3340 min
Histogram: 1 0 1 0 1 0 1 1 2 1
Neighs:        29153.4 ave       32118 max       26338 min
Histogram: 1 0 1 1 1 2 1 0 0 1

Total # of neighbors = 233227
Ave neighs/atom = 644.27348
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.6 | 131.6 | 132.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.66237     -42338.012      10168.689      0              3925.0098    
       100   310.40556     -42363.662     -3181.3595     -6951.4625      3925.0098    
       200   296.33359     -42372.508     -15766.26      -4684.7038      3925.0098    
       300   284.54363     -42359.916     -7320.5895     -3357.3459      3925.0098    
       400   303.54454     -42362.456     -17.324675     -6553.5576      3925.0098    
       500   294.69937     -42343.93      -11802.857     -12981.724      3925.0098    
       600   291.96915     -42346.449     -6949.3485     -2550.8773      3925.0098    
       700   291.06536     -42382.976     -4056.2847     -7014.318       3925.0098    
       800   282.90126     -42388.245     -9124.3821     -7110.4479      3925.0098    
       900   299.63979     -42387.604      2994.3128     -4426.664       3925.0098    
      1000   310.25562     -42378.789     -3735.9907     -4464.8233      3925.0098    
      1100   311.222       -42365.148     -9411.6237     -4974.5714      3925.0098    
      1200   306.40066     -42358.6        4964.7966     -5634.8193      3925.0098    
      1300   295.3639      -42363.046     -4348.4349     -3716.2609      3925.0098    
      1400   271.94808     -42362.348      2849.0752     -93.271786      3925.0098    
      1500   296.68307     -42377.097     -12732.784     -2501.9262      3925.0098    
      1600   306.44446     -42358.838     -4919.6207     -7158.7926      3925.0098    
      1700   316.30555     -42358.633     -11793.98      -4692.5096      3925.0098    
      1800   314.42452     -42362.897      4231.6734     -736.37663      3925.0098    
      1900   291.88499     -42354.58       3336.4571     -10311.111      3925.0098    
      2000   305.7259      -42372.501      16139.462     -6091.5865      3925.0098    
      2100   297.57956     -42361.732     -631.96773     -8609.4425      3925.0098    
      2200   299.25575     -42359.601     -4227.4765     -6017.4781      3925.0098    
      2300   297.03484     -42351.551      7362.1885     -10538.715      3925.0098    
      2400   309.70361     -42343.119     -3937.6272     -6594.5834      3925.0098    
      2500   320.12544     -42326.634      11246.512     -822.42479      3925.0098    
      2600   327.01903     -42341.966     -4490.1416     -3251.6108      3925.0098    
      2700   289.46067     -42339.676      8144.9397     -1933.0718      3925.0098    
      2800   291.39141     -42350.168     -6977.6958     -2576.8352      3925.0098    
      2900   285.08511     -42349.45       374.82671     -6527.6829      3925.0098    
      3000   298.3658      -42360.66      -880.72587     -6606.6689      3925.0098    
Loop time of 154.869 on 8 procs for 3000 steps with 362 atoms

Performance: 0.837 ns/day, 28.679 hours/ns, 19.371 timesteps/s, 7.012 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 120.17     | 128.01     | 130.2      |  27.6 | 82.66
Bond    | 0.0086505  | 0.0091866  | 0.0097256  |   0.4 |  0.01
Neigh   | 8.9409     | 9.458      | 9.6872     |   7.6 |  6.11
Comm    | 2.8516     | 5.0336     | 12.883     | 139.5 |  3.25
Output  | 0.0014098  | 0.0015568  | 0.0023871  |   0.8 |  0.00
Modify  | 12.049     | 12.274     | 12.787     |   6.6 |  7.93
Other   |            | 0.07855    |            |       |  0.05

Nlocal:          45.25 ave          49 max          40 min
Histogram: 1 1 0 0 2 0 1 0 0 3
Nghost:        3382.62 ave        3419 max        3337 min
Histogram: 1 0 1 0 1 1 1 1 1 1
Neighs:        29140.5 ave       31580 max       25720 min
Histogram: 1 1 0 0 2 0 1 0 0 3

Total # of neighbors = 233124
Ave neighs/atom = 643.98895
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -37.1515729033539
variable C2neg equal ${d2}
variable C2neg equal -40.9830215014387
variable C3neg equal ${d3}
variable C3neg equal 11.3418493563027
variable C4neg equal ${d4}
variable C4neg equal -7.53454266352129
variable C5neg equal ${d5}
variable C5neg equal 4.62156700089989
variable C6neg equal ${d6}
variable C6neg equal -23.8465054583007

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.5867
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.175867 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.1722 13.1279 17.762567) with tilt (-8.382 0.0305 0.3027)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.6 | 129.5 | 130.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.54158     -42273.894     -40423.648      0              4004.3029    
       100   299.22207     -42306.041      332.02009     -8725.5517      4004.3029    
       200   305.79199     -42327.929     -5612.4703     -12290.114      4004.3029    
       300   289.23011     -42315.884     -9307.546      -11236.826      4004.3029    
       400   301.99155     -42317.607     -3174.6687     -10910.686      4004.3029    
       500   317.23577     -42320.588     -7204.9558     -9949.4966      4004.3029    
       600   294.54101     -42291.569     -11226.33      -10900.811      4004.3029    
       700   308.01451     -42298.499     -2314.7051     -14344.527      4004.3029    
       800   300.47958     -42292.164     -5101.4564     -6046.4835      4004.3029    
       900   305.65901     -42307.534     -15574.939     -5110.2408      4004.3029    
      1000   294.54533     -42307.754     -14120.428     -14914.664      4004.3029    
      1100   295.83252     -42304.809     -13149.761     -11462.422      4004.3029    
      1200   299.63297     -42292.898     -5538.7232     -10442.764      4004.3029    
      1300   300.42809     -42279.663     -752.14052     -6225.7206      4004.3029    
      1400   318.6553      -42304.262     -2054.1972     -7069.5981      4004.3029    
      1500   310.05404     -42316.987     -21386.032     -15012.594      4004.3029    
      1600   295.79862     -42320.753     -11045.468     -4304.081       4004.3029    
      1700   289.43767     -42321.913     -2772.9715     -8719.3521      4004.3029    
      1800   300.39442     -42313.501     -4497.6904     -6771.428       4004.3029    
      1900   295.69673     -42276.922      4681.1878     -9728.2974      4004.3029    
      2000   302.87683     -42287.766     -9465.0541     -5141.9168      4004.3029    
      2100   305.17465     -42311.007     -5044.923      -3499.5583      4004.3029    
      2200   291.56784     -42314.019     -9887.675      -10238.814      4004.3029    
      2300   289.63796     -42310.664     -4445.3307     -1184.7822      4004.3029    
      2400   315.27422     -42333.438     -1122.2537     -9374.2058      4004.3029    
      2500   289.4423      -42304.165      6985.7145     -8692.338       4004.3029    
      2600   325.65738     -42349.385      6858.2989     -3893.3163      4004.3029    
      2700   279.20489     -42339.344     -15472.54      -9109.4044      4004.3029    
      2800   289.83843     -42348.969      949.62225     -10893.391      4004.3029    
      2900   296.93178     -42337.28      -26756.305     -8077.0728      4004.3029    
      3000   286.34238     -42303.755     -10171.171     -9422.5594      4004.3029    
Loop time of 150.172 on 8 procs for 3000 steps with 362 atoms

Performance: 0.863 ns/day, 27.810 hours/ns, 19.977 timesteps/s, 7.232 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 103.62     | 121.32     | 126.93     |  66.9 | 80.78
Bond    | 0.0085535  | 0.0091037  | 0.0096684  |   0.4 |  0.01
Neigh   | 7.7956     | 9.0643     | 9.5499     |  18.3 |  6.04
Comm    | 1.9236     | 7.5432     | 25.242     | 268.3 |  5.02
Output  | 0.0078458  | 0.0099543  | 0.011502   |   1.3 |  0.01
Modify  | 11.665     | 12.153     | 13.422     |  15.8 |  8.09
Other   |            | 0.07668    |            |       |  0.05

Nlocal:          45.25 ave          52 max          41 min
Histogram: 2 0 1 2 1 1 0 0 0 1
Nghost:        3344.25 ave        3384 max        3321 min
Histogram: 2 2 1 0 1 0 0 0 0 2
Neighs:        28552.1 ave       32587 max       26048 min
Histogram: 2 0 1 2 1 1 0 0 0 1

Total # of neighbors = 228417
Ave neighs/atom = 630.98619
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.6 | 129.6 | 130.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   286.34238     -42303.755     -10171.187      0              4004.3029    
       100   299.77358     -42316.286      505.56803     -3774.2114      4004.3029    
       200   314.66024     -42311.944     -14841.271     -6047.4885      4004.3029    
       300   317.49862     -42312.491     -8032.3986     -8954.7087      4004.3029    
       400   295.58068     -42326.21      -13726.751     -13070.579      4004.3029    
       500   298.78233     -42342.336     -5848.7596     -10013.065      4004.3029    
       600   280.04266     -42321.891     -8525.2575     -2221.0828      4004.3029    
       700   299.00413     -42315.718     -4862.6626     -9339.9228      4004.3029    
       800   303.27342     -42300.696     -3098.1948     -6654.4519      4004.3029    
       900   301.05496     -42308.385     -5026.3468     -11583.632      4004.3029    
      1000   313.38369     -42329.289     -3210.758      -9528.9747      4004.3029    
      1100   317.25647     -42346.333     -4319.6618     -7006.1112      4004.3029    
      1200   295.27801     -42330.032     -10598.998     -6790.2786      4004.3029    
      1300   292.8446      -42322.317     -6246.5155     -7295.2878      4004.3029    
      1400   315.78387     -42338.057     -5717.9063     -10801.973      4004.3029    
      1500   291.00346     -42318.874     -14376.841     -8659.2781      4004.3029    
      1600   274.25222     -42340.26      -10862.641     -9976.2533      4004.3029    
      1700   284.46744     -42351.105     -14483.133     -13734.428      4004.3029    
      1800   280.88948     -42327.528     -7157.4376     -13548.401      4004.3029    
      1900   297.33387     -42325.422     -4601.6655     -8707.7191      4004.3029    
      2000   325.49824     -42346.422      1613.2296     -5277.2757      4004.3029    
      2100   293.57083     -42323.252     -23714.222     -12533.567      4004.3029    
      2200   308.1447      -42345.022     -13079.797     -5727.9266      4004.3029    
      2300   289.75808     -42324.82      -7476.2032     -9953.4961      4004.3029    
      2400   335.22292     -42332.017     -4733.8528     -2931.0158      4004.3029    
      2500   324.60574     -42313.528     -9942.2133     -8002.0034      4004.3029    
      2600   310.07407     -42318.94      -3611.571      -10903.355      4004.3029    
      2700   292.27646     -42324.816     -14453.424     -8093.4752      4004.3029    
      2800   288.61812     -42325.65      -1961.4575     -10578.482      4004.3029    
      2900   303.76943     -42332.992     -9073.7804     -14429.885      4004.3029    
      3000   306.72999     -42327.438     -13738.098     -9187.6973      4004.3029    
Loop time of 150.764 on 8 procs for 3000 steps with 362 atoms

Performance: 0.860 ns/day, 27.919 hours/ns, 19.899 timesteps/s, 7.203 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 118.28     | 124.52     | 127.24     |  23.3 | 82.60
Bond    | 0.0085832  | 0.0090083  | 0.0095363  |   0.4 |  0.01
Neigh   | 8.579      | 9.2126     | 9.4882     |   8.5 |  6.11
Comm    | 2.151      | 4.8833     | 11.123     | 117.7 |  3.24
Output  | 0.0014993  | 0.0017409  | 0.0032495  |   1.4 |  0.00
Modify  | 11.784     | 12.057     | 12.697     |   7.5 |  8.00
Other   |            | 0.07676    |            |       |  0.05

Nlocal:          45.25 ave          51 max          40 min
Histogram: 2 0 1 1 0 2 0 0 0 2
Nghost:        3338.25 ave        3405 max        3284 min
Histogram: 2 0 1 1 1 0 1 0 0 2
Neighs:        28551.2 ave       32092 max       25278 min
Histogram: 2 0 1 1 0 2 0 0 0 2

Total # of neighbors = 228410
Ave neighs/atom = 630.96685
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 63.3038432766953
variable C2pos equal ${d2}
variable C2pos equal 72.9182273513887
variable C3pos equal ${d3}
variable C3pos equal 83.6912317939172
variable C4pos equal ${d4}
variable C4pos equal 1.3478576255266
variable C5pos equal ${d5}
variable C5pos equal -18.711458080843
variable C6pos equal ${d6}
variable C6pos equal 11.6543421422441

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(-37.1515729033539+${C1pos})
variable C13 equal 0.5*(-37.1515729033539+63.3038432766953)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(-40.9830215014387+${C2pos})
variable C23 equal 0.5*(-40.9830215014387+72.9182273513887)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(11.3418493563027+${C3pos})
variable C33 equal 0.5*(11.3418493563027+83.6912317939172)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-7.53454266352129+${C4pos})
variable C43 equal 0.5*(-7.53454266352129+1.3478576255266)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(4.62156700089989+${C5pos})
variable C53 equal 0.5*(4.62156700089989+-18.711458080843)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-23.8465054583007+${C6pos})
variable C63 equal 0.5*(-23.8465054583007+11.6543421422441)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.5867
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.5867
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.175867 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.126833)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.1 | 130.6 | 132 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.54158     -42284.471     -608.80865      0              3964.6564    
       100   294.49073     -42306.596     -6117.2713     -9674.308       3964.6564    
       200   298.89983     -42316.124     -4889.5242     -11332.125      3964.6564    
       300   290.80199     -42309.854     -10761.292     -10843.122      3964.6564    
       400   302.90828     -42306.147     -3985.5408     -9794.3372      3964.6564    
       500   307.05683     -42296.055     -5269.0806     -7734.8911      3964.6564    
       600   315.09574     -42308.913     -17080.34      -9660.4103      3964.6564    
       700   314.38918     -42323.658      3482.9316     -9036.7662      3964.6564    
       800   306.62103     -42337.736     -4336.4938     -204.77639      3964.6564    
       900   288.20588     -42331.493     -14524.936     -3087.2757      3964.6564    
      1000   284.97858     -42333.587      455.43148     -8227.1057      3964.6564    
      1100   305.19876     -42347.246     -5693.2231     -7164.529       3964.6564    
      1200   313.1985      -42331.375     -11700.269     -8482.0675      3964.6564    
      1300   316.82872     -42311.802     -9351.1586     -3354.4836      3964.6564    
      1400   299.80518     -42290.842     -9576.5131     -12246.751      3964.6564    
      1500   299.2702      -42311.613      5034.9906     -5788.1892      3964.6564    
      1600   283.00203     -42315.822      7925.3827     -7379.5859      3964.6564    
      1700   289.74621     -42320.494     -6207.8342     -8912.3331      3964.6564    
      1800   301.40787     -42304.16      -2072.2255     -9633.6295      3964.6564    
      1900   323.77996     -42314.469      4177.4371     -7674.6075      3964.6564    
      2000   313.11286     -42315.558      8131.4343     -3020.3474      3964.6564    
      2100   292.53059     -42309.109     -1266.8088     -6566.9519      3964.6564    
      2200   294.64236     -42318.4       -980.63131     -5369.0903      3964.6564    
      2300   310.80618     -42344.258      4250.0272     -9686.1678      3964.6564    
      2400   298.78307     -42356.041      955.11026     -8392.7884      3964.6564    
      2500   278.34632     -42337.831      1146.7678     -11359.052      3964.6564    
      2600   290.16966     -42320.455     -4987.6026     -7451.0073      3964.6564    
      2700   294.6947      -42311.468     -7025.0519     -3823.397       3964.6564    
      2800   314.22175     -42334.438     -501.26317     -6972.1155      3964.6564    
      2900   291.26        -42316.035      2397.4229     -4612.1174      3964.6564    
      3000   295.01409     -42330.639     -2083.091      -7259.6044      3964.6564    
Loop time of 152.527 on 8 procs for 3000 steps with 362 atoms

Performance: 0.850 ns/day, 28.246 hours/ns, 19.669 timesteps/s, 7.120 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 125.33     | 126.92     | 128.67     |   9.2 | 83.21
Bond    | 0.0084299  | 0.0090478  | 0.009729   |   0.5 |  0.01
Neigh   | 9.0197     | 9.2962     | 9.5059     |   5.0 |  6.09
Comm    | 2.3174     | 4.0698     | 5.6781     |  51.4 |  2.67
Output  | 0.0067393  | 0.0086731  | 0.0099884  |   1.2 |  0.01
Modify  | 11.934     | 12.14      | 12.414     |   4.3 |  7.96
Other   |            | 0.07852    |            |       |  0.05

Nlocal:          45.25 ave          51 max          40 min
Histogram: 1 3 0 0 0 0 0 2 1 1
Nghost:           3335 ave        3380 max        3301 min
Histogram: 1 1 1 2 0 1 0 0 0 2
Neighs:        28859.6 ave       32463 max       25718 min
Histogram: 1 3 0 0 0 0 0 3 0 1

Total # of neighbors = 230877
Ave neighs/atom = 637.78177
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.3 | 130.5 | 131.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   295.01409     -42330.639     -2083.1481      0              3964.6564    
       100   287.98951     -42323.572     -5994.4908     -6009.2694      3964.6564    
       200   286.85602     -42318.615     -3975.1363     -5050.6228      3964.6564    
       300   312.26866     -42320.214      644.44371     -3243.9741      3964.6564    
       400   309.74228     -42311.093     -10487.881     -7578.5195      3964.6564    
       500   309.62207     -42327.823      215.80936     -8832.6515      3964.6564    
       600   313.77452     -42363.637     -5221.8434     -3588.7494      3964.6564    
       700   275.31834     -42324.262     -8217.381      -7992.1299      3964.6564    
       800   299.01239     -42337.399      92.000409     -8882.0111      3964.6564    
       900   289.48168     -42308.027     -11564.348     -9835.9254      3964.6564    
      1000   312.1564      -42322.379     -8740.7915     -3752.0841      3964.6564    
      1100   302.01788     -42323.124     -6077.0632     -4058.7353      3964.6564    
      1200   288.45285     -42357.389      706.66192     -3352.8948      3964.6564    
      1300   284.62295     -42345.213     -4897.8878     -7390.0475      3964.6564    
      1400   292.37992     -42331.061     -3332.8371     -900.53917      3964.6564    
      1500   300.5606      -42320.879      8937.0563     -6417.2656      3964.6564    
      1600   300.63576     -42321.73      -7508.208       1572.2         3964.6564    
      1700   290.02257     -42322.903      631.43166     -5544.4849      3964.6564    
      1800   291.9724      -42357.134      6847.3424     -5933.9856      3964.6564    
      1900   295.04487     -42367.451      332.11688     -8319.6637      3964.6564    
      2000   277.67804     -42333.993     -4693.4164     -3600.2962      3964.6564    
      2100   305.07515     -42341.012     -21920.511     -10380.439      3964.6564    
      2200   313.97253     -42347.219      547.75423     -8488.8359      3964.6564    
      2300   307.25548     -42344.813      10896.347     -2299.3395      3964.6564    
      2400   305.63693     -42350.712     -1223.9099     -4772.7152      3964.6564    
      2500   291.57774     -42362.829     -11468.015     -6836.7753      3964.6564    
      2600   282.46156     -42368.187      3092.0121     -3155.2096      3964.6564    
      2700   281.17588     -42346.841      2612.853      -502.02734      3964.6564    
      2800   306.66466     -42345.087      4170.2463     -7246.6499      3964.6564    
      2900   297.37815     -42333.081      1349.5315     -2389.0796      3964.6564    
      3000   286.51062     -42327.819     -863.248       -3073.6791      3964.6564    
Loop time of 152.895 on 8 procs for 3000 steps with 362 atoms

Performance: 0.848 ns/day, 28.314 hours/ns, 19.621 timesteps/s, 7.103 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 125.24     | 127.05     | 129.39     |  12.0 | 83.10
Bond    | 0.0086186  | 0.0090957  | 0.0093677  |   0.3 |  0.01
Neigh   | 9.2177     | 9.3002     | 9.4335     |   2.4 |  6.08
Comm    | 1.8041     | 4.154      | 5.9739     |  66.5 |  2.72
Output  | 0.001442   | 0.0016518  | 0.002767   |   1.0 |  0.00
Modify  | 12.163     | 12.301     | 12.389     |   2.1 |  8.05
Other   |            | 0.07611    |            |       |  0.05

Nlocal:          45.25 ave          48 max          42 min
Histogram: 2 1 0 0 0 0 2 0 1 2
Nghost:         3347.5 ave        3385 max        3330 min
Histogram: 4 1 0 0 0 1 1 0 0 1
Neighs:        28858.8 ave       30574 max       26680 min
Histogram: 2 0 1 0 0 0 2 0 1 2

Total # of neighbors = 230870
Ave neighs/atom = 637.76243
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -1.3535538926053
variable C2neg equal ${d2}
variable C2neg equal -60.471075313647
variable C3neg equal ${d3}
variable C3neg equal -4.9937650626831
variable C4neg equal ${d4}
variable C4neg equal 6.12601200894786
variable C5neg equal ${d5}
variable C5neg equal -2.09556009166329
variable C6neg equal ${d6}
variable C6neg equal -22.8443375420643

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.5867
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.175867 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.478567)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.2 | 130.7 | 132 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.54158     -42294.489     -1360.6519      0              3964.6564    
       100   295.03229     -42314.508     -5850.2214     -8790.962       3964.6564    
       200   298.85269     -42319.324     -6945.5333     -9779.5429      3964.6564    
       300   279.31618     -42294.738      1241.627      -11050.396      3964.6564    
       400   319.20962     -42322.381     -111.5177      -12382.971      3964.6564    
       500   314.83665     -42313.508      219.2862      -8704.058       3964.6564    
       600   298.5083      -42318.208     -4693.3174     -3906.1483      3964.6564    
       700   323.06448     -42367.606     -786.86869     -11644.802      3964.6564    
       800   279.75666     -42343.152     -13225.244     -4748.2429      3964.6564    
       900   295.05767     -42355.006      6358.3797     -7215.0308      3964.6564    
      1000   309.75388     -42338.889      3693.9695     -11812.006      3964.6564    
      1100   312.23762     -42321.32      -3861.8001     -7433.8517      3964.6564    
      1200   329.68482     -42342.636     -7537.0667     -13070.724      3964.6564    
      1300   308.84234     -42347.865      332.99177     -2707.9124      3964.6564    
      1400   293.06466     -42346.206      2860.8048     -7065.815       3964.6564    
      1500   295.38999     -42337.181     -12061.302     -5467.9037      3964.6564    
      1600   314.68563     -42337.15      -7800.6204     -5384.3796      3964.6564    
      1700   303.27979     -42316.473      4551.7751     -11083.37       3964.6564    
      1800   298.24109     -42327.141     -12096.959     -6536.4579      3964.6564    
      1900   294.06335     -42352.259     -10876.279     -7208.6682      3964.6564    
      2000   281.76745     -42348.035     -17815.078     -8111.422       3964.6564    
      2100   303.17696     -42356.152     -3471.8899     -9595.2289      3964.6564    
      2200   302.85942     -42345.89      -9597.2064     -2994.8083      3964.6564    
      2300   307.83464     -42347.082     -10505.198     -5486.5779      3964.6564    
      2400   307.31555     -42344.621      8470.7958     -3870.1176      3964.6564    
      2500   301.02516     -42344.352     -592.29533     -11719.31       3964.6564    
      2600   298.99051     -42355.377     -5013.5319     -8962.0914      3964.6564    
      2700   290.37892     -42352.398     -14174.012     -8355.8326      3964.6564    
      2800   306.98599     -42340.733     -375.71428     -6044.4493      3964.6564    
      2900   315.15422     -42335.014     -1657.2002     -2403.2469      3964.6564    
      3000   295.39022     -42324.571     -9342.3386     -7586.7474      3964.6564    
Loop time of 153.113 on 8 procs for 3000 steps with 362 atoms

Performance: 0.846 ns/day, 28.354 hours/ns, 19.593 timesteps/s, 7.093 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 125.67     | 127.58     | 129.57     |  10.4 | 83.33
Bond    | 0.0083554  | 0.0090408  | 0.0097142  |   0.4 |  0.01
Neigh   | 9.3617     | 9.4981     | 9.5863     |   2.3 |  6.20
Comm    | 1.8428     | 3.8366     | 5.7505     |  60.3 |  2.51
Output  | 0.007689   | 0.009493   | 0.010891   |   1.1 |  0.01
Modify  | 12.011     | 12.098     | 12.237     |   2.1 |  7.90
Other   |            | 0.07969    |            |       |  0.05

Nlocal:          45.25 ave          51 max          42 min
Histogram: 1 1 3 0 1 0 1 0 0 1
Nghost:        3354.88 ave        3369 max        3333 min
Histogram: 1 0 0 1 0 2 1 0 1 2
Neighs:        28867.1 ave       32375 max       26970 min
Histogram: 2 1 2 0 1 0 1 0 0 1

Total # of neighbors = 230937
Ave neighs/atom = 637.94751
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.2 | 130.7 | 132 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   295.39022     -42324.571     -9342.3252      0              3964.6564    
       100   299.43279     -42328.427     -692.10457     -4642.5853      3964.6564    
       200   297.84593     -42331.28      -1393.7219     -8633.5722      3964.6564    
       300   291.70953     -42344.019      2567.9258     -14674.172      3964.6564    
       400   291.36089     -42363.193     -9485.914      -11133.965      3964.6564    
       500   278.76193     -42349.519     -7203.9923     -9406.195       3964.6564    
       600   298.76        -42337.621     -10067.688     -8645.1568      3964.6564    
       700   298.16386     -42321.054     -8202.1424     -8782.0368      3964.6564    
       800   296.10202     -42327.3       -10106.695     -7087.1587      3964.6564    
       900   297.13397     -42339.922      184.4986      -3238.1608      3964.6564    
      1000   288.16582     -42355.388     -13442.619     -9213.3331      3964.6564    
      1100   281.82404     -42371.073     -15653.346     -10752.359      3964.6564    
      1200   291.77685     -42347.031     -15064.924     -9468.1207      3964.6564    
      1300   305.43452     -42335.644     -16349.136     -4350.1594      3964.6564    
      1400   295.25559     -42325.625     -3931.4096     -8497.2266      3964.6564    
      1500   305.65091     -42343.812     -5849.8359     -9456.7647      3964.6564    
      1600   303.29142     -42366.987     -10902.303     -5823.2598      3964.6564    
      1700   291.01767     -42363.707     -8120.0251     -10516.556      3964.6564    
      1800   293.70945     -42343.718     -605.68329     -8071.4259      3964.6564    
      1900   312.63212     -42350.048     -7364.6997     -13058.029      3964.6564    
      2000   307.21785     -42348.343      1106.3534     -6477.3991      3964.6564    
      2100   297.03418     -42346.754     -7140.9738     -9567.4054      3964.6564    
      2200   295.48707     -42346.926      3138.3629     -8925.7576      3964.6564    
      2300   288.1754      -42339.428     -7943.8664     -9481.3051      3964.6564    
      2400   292.94405     -42332.392     -2298.3785     -590.90265      3964.6564    
      2500   298.09128     -42321.689     -1489.3805     -12097.937      3964.6564    
      2600   311.24119     -42326.928     -5276.9164     -6765.7179      3964.6564    
      2700   299.73206     -42320.952     -17228.883     -8575.0929      3964.6564    
      2800   272.79052     -42324.785     -1528.6042     -5479.0709      3964.6564    
      2900   302.77614     -42362.684      1612.0447     -9480.4995      3964.6564    
      3000   302.45064     -42354.416     -8412.2126     -10571.72       3964.6564    
Loop time of 152.157 on 8 procs for 3000 steps with 362 atoms

Performance: 0.852 ns/day, 28.177 hours/ns, 19.716 timesteps/s, 7.137 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 101.26     | 123.75     | 128.01     |  76.7 | 81.33
Bond    | 0.0082266  | 0.0090157  | 0.0096362  |   0.4 |  0.01
Neigh   | 7.5432     | 9.2597     | 9.5706     |  21.4 |  6.09
Comm    | 2.6103     | 6.8797     | 29.359     | 325.3 |  4.52
Output  | 0.0014023  | 0.0016076  | 0.0027452  |   1.1 |  0.00
Modify  | 11.865     | 12.182     | 13.91      |  18.8 |  8.01
Other   |            | 0.07922    |            |       |  0.05

Nlocal:          45.25 ave          50 max          40 min
Histogram: 1 0 0 1 1 2 1 0 0 2
Nghost:        3371.12 ave        3393 max        3360 min
Histogram: 3 0 1 2 0 1 0 0 0 1
Neighs:        28855.2 ave       31789 max       25509 min
Histogram: 1 0 0 1 2 1 1 0 1 1

Total # of neighbors = 230842
Ave neighs/atom = 637.68508
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 77.3274571330959
variable C2pos equal ${d2}
variable C2pos equal 49.9805334265713
variable C3pos equal ${d3}
variable C3pos equal -4.25467311924866
variable C4pos equal ${d4}
variable C4pos equal 1.57533588922438
variable C5pos equal ${d5}
variable C5pos equal -8.89908320268421
variable C6pos equal ${d6}
variable C6pos equal 7.55385225985652

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-1.3535538926053+${C1pos})
variable C14 equal 0.5*(-1.3535538926053+77.3274571330959)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(-60.471075313647+${C2pos})
variable C24 equal 0.5*(-60.471075313647+49.9805334265713)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-4.9937650626831+${C3pos})
variable C34 equal 0.5*(-4.9937650626831+-4.25467311924866)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(6.12601200894786+${C4pos})
variable C44 equal 0.5*(6.12601200894786+1.57533588922438)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-2.09556009166329+${C5pos})
variable C54 equal 0.5*(-2.09556009166329+-8.89908320268421)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-22.8443375420643+${C6pos})
variable C64 equal 0.5*(-22.8443375420643+7.55385225985652)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.5867
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.5867
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.175867 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 -0.145367 0.3027)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.1 | 130.6 | 132.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.54158     -42290.501     -2463.4536      0              3964.6564    
       100   293.71874     -42310.016     -6654.2694     -8921.4142      3964.6564    
       200   299.09405     -42318.21      -11831.268     -9599.2879      3964.6564    
       300   280.61        -42296.183     -13156.358     -11374.163      3964.6564    
       400   312.97883     -42315.325     -8011.5438     -11371.982      3964.6564    
       500   301.69196     -42294.591      9031.5249     -7560.8069      3964.6564    
       600   298.43583     -42296.961     -11745.892     -6789.7568      3964.6564    
       700   302.95995     -42312.014      622.0165      -12337.909      3964.6564    
       800   293.15427     -42324.605     -1393.2163     -3919.9699      3964.6564    
       900   291.39123     -42335.617     -2399.2271     -5087.8311      3964.6564    
      1000   276.73508     -42309.007     -5559.3906     -11776.512      3964.6564    
      1100   306.19392     -42321.224     -2135.0276     -8912.181       3964.6564    
      1200   317.35669     -42329.173      3720.0358     -4089.3595      3964.6564    
      1300   297.10772     -42311.631     -4759.6555     -3983.917       3964.6564    
      1400   302.36145     -42331.175     -7979.4954     -9981.0417      3964.6564    
      1500   306.3004      -42358.674     -2047.5757     -4129.9295      3964.6564    
      1600   272.46762     -42333.041      2439.2282     -5010.9275      3964.6564    
      1700   307.95473     -42346.962     -2296.401      -7407.1057      3964.6564    
      1800   315.18276     -42334.424      107.66516     -4366.3138      3964.6564    
      1900   293.69351     -42316.046     -19172.246     -10746.737      3964.6564    
      2000   319.85528     -42357.595      4021.463      -9121.47        3964.6564    
      2100   282.80702     -42351.046     -5826.4515     -7743.1084      3964.6564    
      2200   272.45535     -42335.634     -11550.648     -8220.1843      3964.6564    
      2300   287.98011     -42332.255     -3146.4769     -4124.3054      3964.6564    
      2400   294.09057     -42320.121     -4698.2029     -2287.5056      3964.6564    
      2500   298.43575     -42312.687     -6996.4822     -3470.4344      3964.6564    
      2600   296.91441     -42307.492      7796.785      -4414.9531      3964.6564    
      2700   307.68038     -42321.827     -947.63514     -2674.5913      3964.6564    
      2800   305.71985     -42339.88      -10891.394     -4366.0892      3964.6564    
      2900   302.98331     -42348.053     -5466.4915     -5191.5626      3964.6564    
      3000   282.39251     -42319.211     -6741.2108     -2470.5363      3964.6564    
Loop time of 151.475 on 8 procs for 3000 steps with 362 atoms

Performance: 0.856 ns/day, 28.051 hours/ns, 19.805 timesteps/s, 7.170 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 89.689     | 122        | 127.86     | 110.9 | 80.54
Bond    | 0.0082242  | 0.0090292  | 0.0097133  |   0.5 |  0.01
Neigh   | 6.7296     | 9.0991     | 9.6623     |  30.0 |  6.01
Comm    | 2.211      | 8.0557     | 40.359     | 431.3 |  5.32
Output  | 0.0067983  | 0.0086321  | 0.010008   |   1.2 |  0.01
Modify  | 11.646     | 12.219     | 14.61      |  26.1 |  8.07
Other   |            | 0.07896    |            |       |  0.05

Nlocal:          45.25 ave          49 max          38 min
Histogram: 1 0 0 1 0 1 0 1 1 3
Nghost:        3342.62 ave        3374 max        3326 min
Histogram: 3 1 1 0 1 0 0 1 0 1
Neighs:        28835.4 ave       31060 max       24491 min
Histogram: 1 0 0 1 0 1 0 1 1 3

Total # of neighbors = 230683
Ave neighs/atom = 637.24586
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.2 | 130.6 | 131.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   282.39251     -42319.211     -6741.1676      0              3964.6564    
       100   302.33273     -42335.42      -4355.4822     -3376.3471      3964.6564    
       200   307.0739      -42319.59      -4471.6268     -8191.3304      3964.6564    
       300   313.04835     -42305.993     -7646.7429     -9139.8278      3964.6564    
       400   298.35925     -42314.187     -5288.9673     -11068.755      3964.6564    
       500   292.95564     -42332.254     -10137.06      -10389.895      3964.6564    
       600   292.13306     -42330.37      -5859.1482     -3331.0071      3964.6564    
       700   297.11061     -42333.699     -19745.192     -8579.9094      3964.6564    
       800   317.65105     -42336.848     -4226.183      -1988.6174      3964.6564    
       900   326.20908     -42307.489      1456.7574     -2083.4441      3964.6564    
      1000   328.11472     -42315.502     -5689.699      -8245.7402      3964.6564    
      1100   319.28378     -42336.105      7712.9312     -9768.5476      3964.6564    
      1200   300.47757     -42332.781     -3620.8287     -1829.4792      3964.6564    
      1300   294.54834     -42342.182     -3437.2998     -6984.9951      3964.6564    
      1400   309.96193     -42366.466      11914.427     -1439.5949      3964.6564    
      1500   287.83301     -42342.438     -10393.792     -8945.2227      3964.6564    
      1600   296.7753      -42325.19      -1489.865      -3580.9132      3964.6564    
      1700   328.86103     -42338.701     -5748.6414     -6601.6521      3964.6564    
      1800   315.11528     -42338.97      -2619.8011     -5648.5499      3964.6564    
      1900   290.18502     -42340.923      13592.715     -2820.1116      3964.6564    
      2000   291.5585      -42342.994     -8909.9178     -5832.7223      3964.6564    
      2100   300.79302     -42340.662     -12510.93      -13697.261      3964.6564    
      2200   315.86573     -42340.449     -413.58581     -3571.5233      3964.6564    
      2300   288.8625      -42324.152     -6212.7984     -440.25157      3964.6564    
      2400   286.96759     -42358.016      7505.3223     -2819.4297      3964.6564    
      2500   287.70478     -42350.782     -8427.73       -10271.145      3964.6564    
      2600   310.23495     -42352.648     -3373.9109     -3669.9323      3964.6564    
      2700   298.47635     -42336.792     -15693.271     -6609.5397      3964.6564    
      2800   298.19926     -42337.061      1957.7059     -1440.2469      3964.6564    
      2900   289.64491     -42319.734      2181.2867     -1544.7675      3964.6564    
      3000   306.2327      -42303.658     -3312.0201     -494.92253      3964.6564    
Loop time of 152.938 on 8 procs for 3000 steps with 362 atoms

Performance: 0.847 ns/day, 28.322 hours/ns, 19.616 timesteps/s, 7.101 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 109.4      | 124.58     | 128.61     |  52.2 | 81.46
Bond    | 0.008525   | 0.0091071  | 0.0097078  |   0.4 |  0.01
Neigh   | 8.2473     | 9.3313     | 9.6724     |  14.1 |  6.10
Comm    | 2.6013     | 6.6297     | 21.804     | 226.1 |  4.33
Output  | 0.0013829  | 0.0016005  | 0.0026669  |   1.0 |  0.00
Modify  | 11.956     | 12.306     | 13.396     |  12.3 |  8.05
Other   |            | 0.07796    |            |       |  0.05

Nlocal:          45.25 ave          50 max          42 min
Histogram: 1 1 2 1 0 1 0 1 0 1
Nghost:        3359.75 ave        3399 max        3327 min
Histogram: 1 1 0 2 1 1 0 1 0 1
Neighs:        28858.8 ave       31808 max       26984 min
Histogram: 2 1 1 1 1 0 0 1 0 1

Total # of neighbors = 230870
Ave neighs/atom = 637.76243
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 24.7756971904383
variable C2neg equal ${d2}
variable C2neg equal -20.2482243958512
variable C3neg equal ${d3}
variable C3neg equal 27.3721981558783
variable C4neg equal ${d4}
variable C4neg equal -4.07665190868022
variable C5neg equal ${d5}
variable C5neg equal 26.2491836651147
variable C6neg equal ${d6}
variable C6neg equal -21.7882047781795

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.5867
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.175867 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.206367 0.3027)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.1 | 130.6 | 132 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.54158     -42289.704      325.2486       0              3964.6564    
       100   293.16572     -42309.494     -4893.8777     -8112.2719      3964.6564    
       200   303.18756     -42322.784     -9711.0559     -10051.014      3964.6564    
       300   285.45211     -42299.065     -6209.3582     -9666.2513      3964.6564    
       400   311.99325     -42312.892     -14093.255     -10184.949      3964.6564    
       500   315.81902     -42319.517     -16331.855     -9215.7313      3964.6564    
       600   301.51798     -42327.418     -15425.078     -4423.943       3964.6564    
       700   304.475       -42347.223     -3330.5008     -9657.1103      3964.6564    
       800   298.97223     -42348.781     -13836.572     -6776.0901      3964.6564    
       900   291.58978     -42327.246      5394.8608     -6041.1562      3964.6564    
      1000   312.77423     -42326.688     -6079.588      -10075.964      3964.6564    
      1100   299.73505     -42303.312     -7917.0672     -9251.0389      3964.6564    
      1200   306.60507     -42315.006      5927.1764     -10328.198      3964.6564    
      1300   289.88081     -42310.572     -12410.562     -3377.1215      3964.6564    
      1400   286.83254     -42324.345     -4433.7931     -2529.1639      3964.6564    
      1500   286.68778     -42328.948      7808.7448     -7220.7985      3964.6564    
      1600   299.30141     -42327.326     -3767.9805     -8889.9423      3964.6564    
      1700   316.11766     -42323.346     -9688.2575     -7602.142       3964.6564    
      1800   308.44867     -42321.203     -4080.4905     -3098.5019      3964.6564    
      1900   286.45823     -42333.255     -16141.361     -5839.8234      3964.6564    
      2000   285.4911      -42338.67      -12235.614     -6225.4073      3964.6564    
      2100   279.42649     -42321.067     -3652.7298     -7886.2467      3964.6564    
      2200   292.97305     -42311.627     -16842.318     -8636.0802      3964.6564    
      2300   311.0617      -42323.383     -6595.8269     -3960.8137      3964.6564    
      2400   298.42512     -42322.339      3928.3839     -4778.2693      3964.6564    
      2500   280.87386     -42315.252      601.78624     -8851.387       3964.6564    
      2600   303.0749      -42339.251     -8399.9403     -6528.4906      3964.6564    
      2700   298.75915     -42326.057     -11055.288     -11774.196      3964.6564    
      2800   311.18153     -42325.568     -874.89697     -6021.5216      3964.6564    
      2900   313.85676     -42324.556     -12289.252     -9251.9694      3964.6564    
      3000   307.00332     -42325.1       -6653.0384     -3808.8954      3964.6564    
Loop time of 154.092 on 8 procs for 3000 steps with 362 atoms

Performance: 0.841 ns/day, 28.536 hours/ns, 19.469 timesteps/s, 7.048 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 111.92     | 125.25     | 130.93     |  47.8 | 81.28
Bond    | 0.0080924  | 0.0091377  | 0.0096037  |   0.5 |  0.01
Neigh   | 8.4641     | 9.4297     | 9.9462     |  13.9 |  6.12
Comm    | 1.0154     | 6.6982     | 20.053     | 207.1 |  4.35
Output  | 0.0074936  | 0.0093035  | 0.010928   |   1.2 |  0.01
Modify  | 12.082     | 12.616     | 13.559     |  11.9 |  8.19
Other   |            | 0.07952    |            |       |  0.05

Nlocal:          45.25 ave          48 max          42 min
Histogram: 1 1 0 0 0 2 2 0 1 1
Nghost:        3337.88 ave        3369 max        3317 min
Histogram: 2 1 1 0 2 0 0 0 0 2
Neighs:        28870.9 ave       30595 max       26853 min
Histogram: 1 1 0 0 1 1 1 1 1 1

Total # of neighbors = 230967
Ave neighs/atom = 638.03039
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.2 | 130.6 | 132 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.00332     -42325.1       -6653.0173      0              3964.6564    
       100   306.79884     -42332.057     -9654.6816     -6089.1311      3964.6564    
       200   284.6322      -42336.176      1792.6837     -6883.2692      3964.6564    
       300   266.64017     -42336.126     -5028.043      -12601.666      3964.6564    
       400   282.19661     -42333.446     -20683.809     -8019.675       3964.6564    
       500   311.34036     -42347.192      105.78883     -2954.491       3964.6564    
       600   304.45259     -42340.17       7188.4589     -8015.8567      3964.6564    
       700   307.35216     -42327.974     -1561.0709     -2133.4014      3964.6564    
       800   310.6611      -42315.493     -4118.2825     -6339.4963      3964.6564    
       900   315.75448     -42323.93      -1485.8158     -6159.6614      3964.6564    
      1000   298.91277     -42341.33      -12539.601     -10360.259      3964.6564    
      1100   290.29577     -42339.858     -11597.155     -13017.129      3964.6564    
      1200   296.04748     -42341.403     -9917.4392     -6985.9985      3964.6564    
      1300   295.23479     -42313.38       7382.9715     -5710.2122      3964.6564    
      1400   301.64066     -42295.91      -1494.625      -1688.8748      3964.6564    
      1500   317.03087     -42326.651     -4770.7871     -1420.4157      3964.6564    
      1600   290.9894      -42322.33      -1416.31       -6600.2569      3964.6564    
      1700   296.74393     -42339.091     -13934.624     -12225.122      3964.6564    
      1800   302.3983      -42339.469     -2623.057      -8209.086       3964.6564    
      1900   310.2608      -42313.044      8011.4937     -8116.8179      3964.6564    
      2000   325.61921     -42314.14      -8686.1933     -2055.3983      3964.6564    
      2100   297.32577     -42308.903     -5673.1678     -4851.2502      3964.6564    
      2200   290.11263     -42313.079     -2999.4185     -5061.994       3964.6564    
      2300   293.4382      -42319.727     -9083.1458     -5341.3816      3964.6564    
      2400   304.27721     -42331.511      1756.4499     -8787.6883      3964.6564    
      2500   315.65605     -42352.834      6093.0107     -3671.8553      3964.6564    
      2600   275.98184     -42328.84       1098.8387     -2521.3469      3964.6564    
      2700   299.84417     -42350.492      6543.7408      1940.4455      3964.6564    
      2800   305.22554     -42329.573     -17056.105     -11516.261      3964.6564    
      2900   310.68874     -42317.346      5241.335      -2609.8337      3964.6564    
      3000   310.07954     -42320.366     -4636.1716     -10857.895      3964.6564    
Loop time of 152.693 on 8 procs for 3000 steps with 362 atoms

Performance: 0.849 ns/day, 28.276 hours/ns, 19.647 timesteps/s, 7.112 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 89.122     | 117.08     | 130.02     | 133.8 | 76.67
Bond    | 0.0079913  | 0.0089785  | 0.0096077  |   0.5 |  0.01
Neigh   | 6.8821     | 8.905      | 9.9256     |  36.5 |  5.83
Comm    | 0.95858    | 13.906     | 41.833     | 388.0 |  9.11
Output  | 0.001319   | 0.0015871  | 0.0031857  |   1.5 |  0.00
Modify  | 11.686     | 12.718     | 14.779     |  30.8 |  8.33
Other   |            | 0.07611    |            |       |  0.05

Nlocal:          45.25 ave          50 max          42 min
Histogram: 1 0 3 2 0 0 0 1 0 1
Nghost:         3356.5 ave        3374 max        3344 min
Histogram: 1 1 1 1 2 0 1 0 0 1
Neighs:        28865.4 ave       31796 max       26961 min
Histogram: 1 0 3 2 0 0 0 1 0 1

Total # of neighbors = 230923
Ave neighs/atom = 637.90884
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 80.2271231090947
variable C2pos equal ${d2}
variable C2pos equal 28.5445686208789
variable C3pos equal ${d3}
variable C3pos equal 20.6218320444979
variable C4pos equal ${d4}
variable C4pos equal -1.4602832436011
variable C5pos equal ${d5}
variable C5pos equal 4.89981263071057
variable C6pos equal ${d6}
variable C6pos equal 32.8739379508398

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(24.7756971904383+${C1pos})
variable C15 equal 0.5*(24.7756971904383+80.2271231090947)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-20.2482243958512+${C2pos})
variable C25 equal 0.5*(-20.2482243958512+28.5445686208789)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(27.3721981558783+${C3pos})
variable C35 equal 0.5*(27.3721981558783+20.6218320444979)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-4.07665190868022+${C4pos})
variable C45 equal 0.5*(-4.07665190868022+-1.4602832436011)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(26.2491836651147+${C5pos})
variable C55 equal 0.5*(26.2491836651147+4.89981263071057)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-21.7882047781795+${C6pos})
variable C65 equal 0.5*(-21.7882047781795+32.8739379508398)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.1279

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.1279
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.131279 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.513279 0.0305 0.3027)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.2 | 130.8 | 132.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.54158     -42291.294     -2337.395       0              3964.6564    
       100   297.29202     -42314.522     -4508.9005     -8196.6673      3964.6564    
       200   306.95664     -42326.857     -4503.9692     -10160.525      3964.6564    
       300   284.92782     -42306.049     -3425.56       -9773.4807      3964.6564    
       400   300.97349     -42309.599     -620.93302     -8980.2281      3964.6564    
       500   320.90953     -42314.785     -2450.3785     -10755.11       3964.6564    
       600   312.97131     -42302.096     -4722.3767     -4505.4809      3964.6564    
       700   328.94585     -42326.988      3291.0838     -11581.098      3964.6564    
       800   288.06855     -42318.339      2247.9218     -3154.669       3964.6564    
       900   285.83528     -42331.76      -1839.8671     -2937.7911      3964.6564    
      1000   288.52258     -42327.746     -9534.6365     -4279.9087      3964.6564    
      1100   295.29929     -42310.394     -4204.252      -7589.431       3964.6564    
      1200   298.23481     -42303.224      14305.256     -4798.1733      3964.6564    
      1300   298.50922     -42300.479      8431.494       44.289302      3964.6564    
      1400   302.3944      -42312.702     -14448.33      -5981.7311      3964.6564    
      1500   306.51912     -42333.579     -13321.732     -9053.6604      3964.6564    
      1600   285.18142     -42333.306     -1478.97       -7246.7053      3964.6564    
      1700   285.85726     -42338.911     -8179.4172     -11798.614      3964.6564    
      1800   297.38613     -42326.425      6302.682      -7259.1267      3964.6564    
      1900   316.80425     -42322.899      3681.0563     -7447.2685      3964.6564    
      2000   315.88863     -42330.592      9983.5577     -5186.2817      3964.6564    
      2100   293.69685     -42325.674      7460.0591     -3219.4858      3964.6564    
      2200   322.19265     -42366.581     -4056.026      -6032.8964      3964.6564    
      2300   298.17291     -42346.298     -18356.454     -9397.2613      3964.6564    
      2400   292.21027     -42328.089     -13533.035     -5895.7112      3964.6564    
      2500   323.8057      -42329.453     -3976.0859     -5265.7807      3964.6564    
      2600   296.56149     -42315.508     -12856.085     -3991.2896      3964.6564    
      2700   302.26737     -42345.132     -7773.0305     -8074.8456      3964.6564    
      2800   302.42206     -42353.49      -12325.352     -4078.1749      3964.6564    
      2900   306.58615     -42349.612     -7759.1749     -7628.6662      3964.6564    
      3000   293.42431     -42306.276      3995.7131     -2295.6567      3964.6564    
Loop time of 153.518 on 8 procs for 3000 steps with 362 atoms

Performance: 0.844 ns/day, 28.429 hours/ns, 19.542 timesteps/s, 7.074 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.615     | 115.31     | 130.71     | 154.9 | 75.11
Bond    | 0.0080187  | 0.0089771  | 0.0096471  |   0.5 |  0.01
Neigh   | 6.6975     | 8.7543     | 10.055     |  43.8 |  5.70
Comm    | 0.99244    | 16.404     | 43.066     | 410.8 | 10.69
Output  | 0.0065223  | 0.0079839  | 0.0090079  |   1.0 |  0.01
Modify  | 11.653     | 12.962     | 15.017     |  36.2 |  8.44
Other   |            | 0.0749     |            |       |  0.05

Nlocal:          45.25 ave          49 max          42 min
Histogram: 2 1 0 0 1 2 0 0 0 2
Nghost:        3383.12 ave        3449 max        3328 min
Histogram: 1 0 2 2 0 0 1 1 0 1
Neighs:        28849.5 ave       31167 max       26669 min
Histogram: 2 1 0 0 1 2 0 0 0 2

Total # of neighbors = 230796
Ave neighs/atom = 637.55801
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.3 | 130.8 | 132.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   293.42431     -42306.276      3995.7496      0              3964.6564    
       100   310.12007     -42330.501     -2674.4307     -3905.4073      3964.6564    
       200   294.83525     -42341.307     -25236.159     -10293.904      3964.6564    
       300   282.61073     -42349.894     -473.01755     -6331.0726      3964.6564    
       400   299.66739     -42356.181      305.5008       503.07482      3964.6564    
       500   331.48107     -42373.256     -5569.3646     -3797.9709      3964.6564    
       600   301.31905     -42334.923      1.7084571     -8626.5824      3964.6564    
       700   305.47559     -42336.504     -7640.1672     -10384.911      3964.6564    
       800   315.84933     -42342.302     -4495.9133     -8073.5107      3964.6564    
       900   314.82546     -42326.266     -3226.7942     -11350.295      3964.6564    
      1000   297.57757     -42307.342     -6137.4826     -4657.0449      3964.6564    
      1100   304.5542      -42322.5       -8066.1721     -5541.4162      3964.6564    
      1200   292.54644     -42330.163     -15751.609     -7709.8097      3964.6564    
      1300   281.84241     -42338.921     -15768.057     -10633.662      3964.6564    
      1400   300.45913     -42346.795      3823.6222     -3478.967       3964.6564    
      1500   313.21422     -42321.958      7262.0017     -866.64044      3964.6564    
      1600   317.93306     -42327.661      5763.89       -4571.2315      3964.6564    
      1700   309.04818     -42338.26       10287.651     -3928.7765      3964.6564    
      1800   282.89514     -42333.904     -8842.7875     -8160.4862      3964.6564    
      1900   301.52494     -42354.011     -9702.7388     -9820.876       3964.6564    
      2000   313.82876     -42359.054      1575.9957     -2078.6257      3964.6564    
      2100   323.57371     -42349.831     -10652.586     -5336.3741      3964.6564    
      2200   324.12904     -42320.403     -769.42799     -3971.3634      3964.6564    
      2300   313.23421     -42303.011      251.18799     -10318.593      3964.6564    
      2400   309.65324     -42339.935     -5307.1976     -5136.7447      3964.6564    
      2500   302.8508      -42349.793      5063.301      -5719.1357      3964.6564    
      2600   312.96701     -42365.256      3089.6639     -6457.9785      3964.6564    
      2700   302.33393     -42362.129      3159.238      -6492.1367      3964.6564    
      2800   279.43467     -42352.502     -13500.168     -4168.0993      3964.6564    
      2900   287.18589     -42350.213     -4160.7712     -7455.102       3964.6564    
      3000   296.51015     -42327.008      3489.469      -5112.1889      3964.6564    
Loop time of 145.932 on 8 procs for 3000 steps with 362 atoms

Performance: 0.888 ns/day, 27.024 hours/ns, 20.558 timesteps/s, 7.442 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 82.343     | 108.2      | 123.46     | 149.2 | 74.14
Bond    | 0.0076358  | 0.0084397  | 0.0090676  |   0.4 |  0.01
Neigh   | 6.8135     | 8.6561     | 9.9815     |  41.6 |  5.93
Comm    | 0.8825     | 16.145     | 41.972     | 385.8 | 11.06
Output  | 0.0012967  | 0.0014912  | 0.0022078  |   0.7 |  0.00
Modify  | 11.506     | 12.848     | 14.732     |  34.7 |  8.80
Other   |            | 0.07188    |            |       |  0.05

Nlocal:          45.25 ave          49 max          40 min
Histogram: 1 1 0 0 1 1 0 1 2 1
Nghost:        3358.88 ave        3401 max        3322 min
Histogram: 1 0 1 3 0 0 0 2 0 1
Neighs:        28856.4 ave       31136 max       25576 min
Histogram: 1 1 0 0 1 1 0 1 2 1

Total # of neighbors = 230851
Ave neighs/atom = 637.70994
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -22.0087540124681
variable C2neg equal ${d2}
variable C2neg equal -53.4095396460461
variable C3neg equal ${d3}
variable C3neg equal -5.84614452769177
variable C4neg equal ${d4}
variable C4neg equal 5.65144139520453
variable C5neg equal ${d5}
variable C5neg equal 6.62748881024863
variable C6neg equal ${d6}
variable C6neg equal -9.09082846449247

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.382 0.0305 0.3027)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  362 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.1279
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.131279 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.1722 13.1279 17.5867) with tilt (-8.250721 0.0305 0.3027)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.6 | 130.3 | 131.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.54158     -42289.681     -24.8527        0              3964.6564    
       100   293.80397     -42309.861     -4760.9894     -8768.8624      3964.6564    
       200   289.98416     -42307.859     -4404.2023     -7528.3113      3964.6564    
       300   285.51505     -42299.562     -9053.8138     -10296.791      3964.6564    
       400   306.19462     -42305.369     -6384.9633     -11481.143      3964.6564    
       500   313.09444     -42308.957     -14126.209     -10048.013      3964.6564    
       600   306.44407     -42316.856     -18178.446     -8029.6096      3964.6564    
       700   304.1047      -42330.518     -746.36943     -8133.1456      3964.6564    
       800   261.29893     -42298.66      -8313.294      -6817.8128      3964.6564    
       900   299.5729      -42333.224      4314.6985     -10919.662      3964.6564    
      1000   304.82672     -42319.784      5443.9577     -3507.9329      3964.6564    
      1100   312.93893     -42324.96       6492.1149     -7093.1678      3964.6564    
      1200   308.77176     -42323.663     -11747.602     -8332.6638      3964.6564    
      1300   308.81489     -42321.024     -6124.6964     -2431.4254      3964.6564    
      1400   301.59631     -42308.974     -5003.4642     -6819.3753      3964.6564    
      1500   304.87845     -42304.447     -4789.497      -6726.1896      3964.6564    
      1600   294.72834     -42299.42      -8454.8459     -12982.795      3964.6564    
      1700   273.22099     -42297.509     -9123.4995     -5821.2182      3964.6564    
      1800   285.31582     -42327.997     -3405.2447     -4443.7636      3964.6564    
      1900   278.19124     -42317.821     -4061.8081     -5401.247       3964.6564    
      2000   300.23985     -42298.471      491.73292     -8143.3142      3964.6564    
      2100   315.83597     -42312.697      1701.8512     -7276.6562      3964.6564    
      2200   308.81968     -42316.652      2986.4148     -7196.0486      3964.6564    
      2300   289.87344     -42329.925      4631.3929     -9911.0994      3964.6564    
      2400   273.5856      -42313.521      1804.9252     -1871.0303      3964.6564    
      2500   294.28118     -42319.109     -1266.9918     -8955.471       3964.6564    
      2600   316.8326      -42330.859     -14513.817     -9955.7004      3964.6564    
      2700   311.97201     -42321.99       1114.7714     -7719.4232      3964.6564    
      2800   277.47503     -42307.991      9008.3601     -6180.0828      3964.6564    
      2900   287.12597     -42335.953     -1906.0571     -8956.9377      3964.6564    
      3000   279.56755     -42309.363     -2353.1012     -8796.7823      3964.6564    
Loop time of 143.037 on 8 procs for 3000 steps with 362 atoms

Performance: 0.906 ns/day, 26.488 hours/ns, 20.974 timesteps/s, 7.592 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 79.499     | 107.72     | 120.49     | 154.3 | 75.31
Bond    | 0.0074604  | 0.0082573  | 0.0090017  |   0.5 |  0.01
Neigh   | 6.6441     | 8.7279     | 9.8493     |  40.8 |  6.10
Comm    | 0.87334    | 13.642     | 41.823     | 433.2 |  9.54
Output  | 0.0065177  | 0.0081334  | 0.0093608  |   1.1 |  0.01
Modify  | 11.718     | 12.858     | 14.981     |  34.4 |  8.99
Other   |            | 0.07261    |            |       |  0.05

Nlocal:          45.25 ave          50 max          38 min
Histogram: 1 0 0 0 1 1 3 0 0 2
Nghost:        3329.12 ave        3348 max        3309 min
Histogram: 2 1 0 0 0 2 0 0 1 2
Neighs:        28903.8 ave       31792 max       24526 min
Histogram: 1 0 0 0 1 1 3 0 0 2

Total # of neighbors = 231230
Ave neighs/atom = 638.75691
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.6 | 130.3 | 131.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   279.56755     -42309.363     -2353.1508      0              3964.6564    
       100   323.76741     -42348.651      6251.6444     -4697.0247      3964.6564    
       200   292.91661     -42308.264     -307.36294     -8928.0285      3964.6564    
       300   306.98336     -42310.271     -7171.2256     -6441.3256      3964.6564    
       400   321.93483     -42337.389     -6009.4003     -4510.515       3964.6564    
       500   282.43568     -42326.466     -8046.7033     -5119.2537      3964.6564    
       600   291.94562     -42333.418     -10577.693     -7877.2667      3964.6564    
       700   304.189       -42322.764      2035.0379     -7676.2214      3964.6564    
       800   317.50576     -42328.648     -12615.411     -10368.795      3964.6564    
       900   309.67514     -42330.247      4887.3154     -8253.6268      3964.6564    
      1000   288.02691     -42319.297     -4128.2903     -10786.104      3964.6564    
      1100   302.82643     -42331.68      -131.08315     -1354.9746      3964.6564    
      1200   298.46795     -42319.197     -867.09034     -3764.3995      3964.6564    
      1300   297.92873     -42318.191     -2884.4687     -3764.1781      3964.6564    
      1400   293.91159     -42342.107     -14495.842     -13701.084      3964.6564    
      1500   267.78065     -42329.271      4942.3991     -4805.9921      3964.6564    
      1600   269.70867     -42310.921      867.56437     -4405.6334      3964.6564    
      1700   300.71165     -42324.328      2924.9391     -4298.7855      3964.6564    
      1800   296.50367     -42321.718     -2961.271      -8390.1597      3964.6564    
      1900   295.49025     -42330.749     -2353.6135     -10571.385      3964.6564    
      2000   292.58517     -42344.89      -5635.9777     -8040.3784      3964.6564    
      2100   258.04979     -42328.766      3554.9354     -2947.6845      3964.6564    
      2200   307.16077     -42358.496     -1594.0692     -261.10854      3964.6564    
      2300   307.0784      -42333.8       -11001.618     -13213.998      3964.6564    
      2400   309.30133     -42330.573     -8612.2307     -10189.238      3964.6564    
      2500   292.39708     -42313.795      4022.9582     -7038.2246      3964.6564    
      2600   309.74787     -42334.232     -11307.724     -11986.53       3964.6564    
      2700   294.86847     -42326.498     -6436.7229     -11231.391      3964.6564    
      2800   298.00034     -42345.301     -797.42638     -6034.595       3964.6564    
      2900   296.45414     -42350.393      3418.5274     -7781.9319      3964.6564    
      3000   303.76606     -42346.565     -10.508082     -8050.3569      3964.6564    
Loop time of 104.816 on 8 procs for 3000 steps with 362 atoms

Performance: 1.236 ns/day, 19.410 hours/ns, 28.622 timesteps/s, 10.361 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 76.977     | 80.473     | 85.68      |  26.5 | 76.78
Bond    | 0.0069811  | 0.0076872  | 0.0082307  |   0.4 |  0.01
Neigh   | 6.6433     | 6.8384     | 7.2674     |   6.8 |  6.52
Comm    | 2.3306     | 7.5357     | 11.028     |  86.7 |  7.19
Output  | 0.0012215  | 0.0013241  | 0.0018822  |   0.6 |  0.00
Modify  | 9.4593     | 9.8914     | 10.083     |   5.7 |  9.44
Other   |            | 0.06844    |            |       |  0.07

Nlocal:          45.25 ave          50 max          41 min
Histogram: 1 1 0 1 2 1 0 0 1 1
Nghost:        3334.25 ave        3370 max        3304 min
Histogram: 1 1 1 0 2 1 0 0 1 1
Neighs:        28864.5 ave       31749 max       26364 min
Histogram: 1 1 0 2 1 1 0 0 0 2

Total # of neighbors = 230916
Ave neighs/atom = 637.8895
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 51.7797411487947
variable C2pos equal ${d2}
variable C2pos equal 58.6418233230221
variable C3pos equal ${d3}
variable C3pos equal 44.63131969482
variable C4pos equal ${d4}
variable C4pos equal 9.38726210482397
variable C5pos equal ${d5}
variable C5pos equal -10.5671967250655
variable C6pos equal ${d6}
variable C6pos equal 28.5037269109143

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-22.0087540124681+${C1pos})
variable C16 equal 0.5*(-22.0087540124681+51.7797411487947)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-53.4095396460461+${C2pos})
variable C26 equal 0.5*(-53.4095396460461+58.6418233230221)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-5.84614452769177+${C3pos})
variable C36 equal 0.5*(-5.84614452769177+44.63131969482)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(5.65144139520453+${C4pos})
variable C46 equal 0.5*(5.65144139520453+9.38726210482397)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(6.62748881024863+${C5pos})
variable C56 equal 0.5*(6.62748881024863+-10.5671967250655)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(-9.09082846449247+${C6pos})
variable C66 equal 0.5*(-9.09082846449247+28.5037269109143)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 61.0775429729506
variable C22all equal ${C22}
variable C22all equal 15.9037602777345
variable C33all equal ${C33}
variable C33all equal 47.5165405751099

variable C44all equal ${C44}
variable C44all equal 3.85067394908612
variable C55all equal ${C55}
variable C55all equal 15.5744981479126
variable C66all equal ${C66}
variable C66all equal 9.70644922321091

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(-14.0740591398581+${C21})
variable C12all equal 0.5*(-14.0740591398581+103.860130579732)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(13.0761351866707+${C31})
variable C13all equal 0.5*(13.0761351866707+39.4189316344847)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(15.967602924975+${C32})
variable C23all equal 0.5*(15.967602924975+-25.2248243212417)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(37.9869516202453+${C41})
variable C14all equal 0.5*(37.9869516202453+-1.2472261684931)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(52.5014101497665+${C51})
variable C15all equal 0.5*(52.5014101497665+-15.6309764975162)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(14.8854935681633+${C61})
variable C16all equal 0.5*(14.8854935681633+0.83822998924806)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-5.24527094353785+${C42})
variable C24all equal 0.5*(-5.24527094353785+-0.997162421104901)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(4.14817211251385+${C52})
variable C25all equal 0.5*(4.14817211251385+-2.58283055552569)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(2.616141838488+${C62})
variable C26all equal 0.5*(2.616141838488+-6.67158637695859)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(-4.62421909096588+${C43})
variable C34all equal 0.5*(-4.62421909096588+-3.09334251899735)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(23.9970151001881+${C53})
variable C35all equal 0.5*(23.9970151001881+-7.04494553997155)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(19.3925875835641+${C63})
variable C36all equal 0.5*(19.3925875835641+-6.0960816580283)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-2.76846757614066+${C54})
variable C45all equal 0.5*(-2.76846757614066+-5.49732164717375)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(7.51935175001425+${C64})
variable C46all equal 0.5*(7.51935175001425+-7.64524264110389)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-1.96985395740844+${C65})
variable C56all equal 0.5*(-1.96985395740844+5.54286658633015)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 1:02:28
