LAMMPS (2 Aug 2023 - Update 2)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-EXP-1-vasp
read_data       ${structure}.data
read_data       333-EXP-1-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.011 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.364 | 6.364 | 6.364 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              241.44561      3354.3242    
         1   300            0              0              241.44561      3354.3242    
Loop time of 7.03462e-05 on 8 procs for 1 steps with 271 atoms

50.8% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.37e-07   | 2.5375e-07 | 3.04e-07   |   0.0 |  0.36
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 8.27e-07   | 1.6231e-06 | 1.875e-06  |   0.0 |  2.31
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 6.847e-05  |            |       | 97.33

Nlocal:         33.875 ave          38 max          27 min
Histogram: 1 1 0 0 0 0 2 0 2 2
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -9.02 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 106.3 | 107.8 | 109.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -30660.091      116480.91      0              1.5329564      3290.3881    
       100   746.11056     -31309.274     -38696.74       172.98247      1.5329564      3290.3881    
       200   481.9423      -31413.832     -21598.846     -4990.2462      1.5329564      3290.3881    
       300   415.0172      -31594.78      -6889.2654      2848.4903      1.5329564      3290.3881    
       400   319.35441     -31667.978      1345.5334      5492.5989      1.5329564      3290.3881    
       500   307.93486     -31755.664      15709.453      1992.7981      1.5329564      3290.3881    
       600   291.93109     -31804.953     -14908.396      4297.1335      1.5329564      3290.3881    
       700   272.53843     -31827.42      -7057.6111      7005.1604      1.5329564      3290.3881    
       800   269.95969     -31833.672     -11759.64       7345.6306      1.5329564      3290.3881    
       900   297.95214     -31830.762     -4635.3935      6482.5508      1.5329564      3290.3881    
      1000   336.48475     -31835.004      7737.0158      11025.006      1.5329564      3290.3881    
      1100   312.12582     -31822.482      10590.609      8054.5143      1.5329564      3290.3881    
      1200   300.2432      -31842.812      5483.2865      10584.823      1.5329564      3290.3881    
      1300   285.19686     -31858.474     -15085.453      9616.2066      1.5329564      3290.3881    
      1400   316.95614     -31891.993     -6326.2429      3331.567       1.5329564      3290.3881    
      1500   277.40296     -31841.609      21233.986      9773.2496      1.5329564      3290.3881    
      1600   305.01193     -31830.821     -1199.163       4263.3819      1.5329564      3290.3881    
      1700   320.63369     -31840.183     -9413.4012      6862.321       1.5329564      3290.3881    
      1800   302.33765     -31856.298     -4978.8372      867.81517      1.5329564      3290.3881    
      1900   280.6047      -31867.402      1618.4404      5926.6037      1.5329564      3290.3881    
      2000   273.71107     -31867.778     -8880.7599      6836.9004      1.5329564      3290.3881    
Loop time of 76.1724 on 8 procs for 2000 steps with 271 atoms

Performance: 1.134 ns/day, 21.159 hours/ns, 26.256 timesteps/s, 7.115 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 45.166     | 58.312     | 63.341     |  73.7 | 76.55
Bond    | 0.00068582 | 0.0008354  | 0.00095097 |   0.0 |  0.00
Neigh   | 3.6862     | 4.7997     | 5.1688     |  21.0 |  6.30
Comm    | 1.2023     | 6.2333     | 19.377     | 225.3 |  8.18
Output  | 0.0011219  | 0.0012818  | 0.002183   |   1.0 |  0.00
Modify  | 6.4175     | 6.7915     | 7.9111     |  17.7 |  8.92
Other   |            | 0.0337     |            |       |  0.04

Nlocal:         33.875 ave          39 max          26 min
Histogram: 1 0 0 0 0 1 5 0 0 1
Nghost:        2779.62 ave        2838 max        2729 min
Histogram: 1 1 0 1 1 2 1 0 0 1
Neighs:        19562.1 ave       22420 max       15169 min
Histogram: 1 0 0 0 0 2 4 0 0 1

Total # of neighbors = 156497
Ave neighs/atom = 577.4797
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-EXP-1-vasp_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 14.7487
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.4318
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 16.6096

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-6836.90035895002)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1-6836.90035895002)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-403.444889323348)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-403.444889323348)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--1324.49188351033)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--1324.49188351033)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-3248.05391670844)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-3248.05391670844)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-2049.03014200902)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-2049.03014200902)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--279.966303413969)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--279.966303413969)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 14.7487
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.7487
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.147487 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.147487 xy delta 0.061972 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.147487 xy delta 0.061972 xz delta 0.010047 remap units box
Changing box ...
  triclinic box = (0 0 0) to (14.601213 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  triclinic box = (0 0 0) to (14.601213 13.4318 16.6096) with tilt (-6.135228 -1.0047 -1.8606)
  triclinic box = (0 0 0) to (14.601213 13.4318 16.6096) with tilt (-6.135228 -0.994653 -1.8606)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.6 | 109.4 | 111.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   273.71107     -31857.841      35582.641      0              3257.4843    
       100   291.3064      -31855.421     -11472.285      6144.5558      3257.4843    
       200   320.61729     -31870.007     -2875.0187      9132.5182      3257.4843    
       300   291.85352     -31860.528      16734.417      6832.8711      3257.4843    
       400   297.61332     -31886.533      10356.046      3887.5346      3257.4843    
       500   268.39578     -31877.202     -10937.533      1251.0137      3257.4843    
       600   299.4231      -31895.272      5549.6557      6528.3217      3257.4843    
       700   306.46916     -31877.241      1287.771       12040.471      3257.4843    
       800   319.18613     -31875.596     -1873.0409      5970.0671      3257.4843    
       900   300.13162     -31869.164     -12146.512      10608.321      3257.4843    
      1000   286.93016     -31880.913     -9700.9564      5743.9824      3257.4843    
      1100   254.94466     -31862.043     -4882.2116      1078.3963      3257.4843    
      1200   303.99582     -31891.708     -7465.8547      4251.6859      3257.4843    
      1300   320.69345     -31893.074     -8187.3525      2237.3496      3257.4843    
      1400   301.11235     -31884.658     -1980.5285     -407.65422      3257.4843    
      1500   294.66363     -31887.995     -400.22685     -1535.983       3257.4843    
      1600   286.45884     -31884.315      2441.7738      6560.6317      3257.4843    
      1700   291.72507     -31882.575      3160.5116      4725.9903      3257.4843    
      1800   301.46046     -31875.901      1615.8488      7119.7128      3257.4843    
      1900   308.90127     -31868.105      5792.3666      8923.4531      3257.4843    
      2000   294.94087     -31859.59      -7805.5813      6786.1092      3257.4843    
Loop time of 78.7858 on 8 procs for 2000 steps with 271 atoms

Performance: 1.097 ns/day, 21.885 hours/ns, 25.385 timesteps/s, 6.879 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.644     | 58.107     | 65.929     | 100.1 | 73.75
Bond    | 0.00068008 | 0.00085084 | 0.00095519 |   0.0 |  0.00
Neigh   | 3.6872     | 4.6639     | 5.3847     |  28.1 |  5.92
Comm    | 1.163      | 8.9908     | 20.455     | 254.5 | 11.41
Output  | 0.0038892  | 0.005685   | 0.0071222  |   1.8 |  0.01
Modify  | 6.2643     | 6.984      | 7.962      |  23.0 |  8.86
Other   |            | 0.03402    |            |       |  0.04

Nlocal:         33.875 ave          42 max          27 min
Histogram: 2 0 1 1 0 1 1 0 1 1
Nghost:        2781.62 ave        2831 max        2732 min
Histogram: 1 1 2 0 0 1 0 0 1 2
Neighs:          19778 ave       24153 max       15953 min
Histogram: 2 0 1 1 0 1 1 0 1 1

Total # of neighbors = 158224
Ave neighs/atom = 583.8524
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.5 | 109.4 | 111.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.94087     -31859.59      -7805.621       0              3257.4843    
       100   307.24554     -31877.297      3199.3902      6782.1237      3257.4843    
       200   305.74446     -31900.693      5151.9082      4397.8538      3257.4843    
       300   286.56798     -31900.286     -9243.3785      514.56789      3257.4843    
       400   314.12667     -31910.384     -893.40584      2059.8647      3257.4843    
       500   273.45099     -31872.619      7067.0483      1140.3592      3257.4843    
       600   296.4414      -31888.562      14145.649      6869.5496      3257.4843    
       700   303.44257     -31893.577     -4563.3106      2425.5793      3257.4843    
       800   317.76511     -31908.579     -9096.572       1474.3908      3257.4843    
       900   272.90936     -31894.673     -7661.1668     -1165.4329      3257.4843    
      1000   288.36537     -31908.218      925.99664      2152.4954      3257.4843    
      1100   316.07356     -31900.023      20871.185      5785.5693      3257.4843    
      1200   306.91619     -31885.115      9861.2587      3775.7993      3257.4843    
      1300   283.03725     -31875.57       3564.8299      1006.0441      3257.4843    
      1400   296.01616     -31895.15       188.82429      5804.9662      3257.4843    
      1500   279.33204     -31892.233      1726.1884      3420.0107      3257.4843    
      1600   276.04653     -31898.437     -6695.0252      5573.9341      3257.4843    
      1700   295.31891     -31920.36      -5996.4708      6894.1445      3257.4843    
      1800   308.20785     -31920.033     -997.79519      6853.9579      3257.4843    
      1900   316.23062     -31903.669      8067.525       6931.1577      3257.4843    
      2000   314.00346     -31893.487     -5743.1009      3302.3541      3257.4843    
Loop time of 79.0299 on 8 procs for 2000 steps with 271 atoms

Performance: 1.093 ns/day, 21.953 hours/ns, 25.307 timesteps/s, 6.858 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 45.008     | 55.773     | 66.344     | 114.4 | 70.57
Bond    | 0.00065654 | 0.00083749 | 0.00096779 |   0.0 |  0.00
Neigh   | 3.6585     | 4.4348     | 5.361      |  31.1 |  5.61
Comm    | 0.96023    | 11.529     | 22.292     | 251.6 | 14.59
Output  | 0.00096003 | 0.0010613  | 0.0015135  |   0.5 |  0.00
Modify  | 6.3266     | 7.2588     | 8.0401     |  24.4 |  9.18
Other   |            | 0.03267    |            |       |  0.04

Nlocal:         33.875 ave          39 max          27 min
Histogram: 1 0 0 2 1 1 0 0 0 3
Nghost:           2804 ave        2864 max        2753 min
Histogram: 2 1 0 1 0 0 2 0 0 2
Neighs:        19748.2 ave       22756 max       15920 min
Histogram: 1 0 0 2 1 1 0 0 0 3

Total # of neighbors = 157986
Ave neighs/atom = 582.97417
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -35.8137895659905
variable C2neg equal ${d2}
variable C2neg equal -74.8798760193243
variable C3neg equal ${d3}
variable C3neg equal -54.2892508989441
variable C4neg equal ${d4}
variable C4neg equal -35.2981045518133
variable C5neg equal ${d5}
variable C5neg equal -5.47469595889558
variable C6neg equal ${d6}
variable C6neg equal -19.4431537481472

# Reset box and simulation parameters
clear
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.7487
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.147487 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.147487 xy delta -0.061972 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.147487 xy delta -0.061972 xz delta -0.010047 remap units box
Changing box ...
  triclinic box = (0 0 0) to (14.896187 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  triclinic box = (0 0 0) to (14.896187 13.4318 16.6096) with tilt (-6.259172 -1.0047 -1.8606)
  triclinic box = (0 0 0) to (14.896187 13.4318 16.6096) with tilt (-6.259172 -1.014747 -1.8606)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 106.6 | 108 | 109.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   273.71107     -31849.292     -47770.331      0              3323.292     
       100   291.5856      -31850.949     -5400.391      -1103.5087      3323.292     
       200   297.08705     -31850.811     -2703.5107      820.18034      3323.292     
       300   299.00097     -31871.732      5284.8093      5164.9983      3323.292     
       400   313.15388     -31902.267     -1205.2429      3757.2408      3323.292     
       500   289.37932     -31892.494     -14456.113     -3034.7389      3323.292     
       600   299.01572     -31892.446     -16144.11      -2423.2436      3323.292     
       700   289.9878      -31863.73       6490.3424      3625.4582      3323.292     
       800   317.23984     -31876.024      3067.5362      2166.9487      3323.292     
       900   298.95705     -31871.547     -10501.887      3678.9237      3323.292     
      1000   301.63979     -31892.749     -14357.307      5959.9226      3323.292     
      1100   286.43616     -31884.798      15051.069      3131.4029      3323.292     
      1200   320.64347     -31896.219     -89.825996      1175.6003      3323.292     
      1300   299.56996     -31869.342      3390.3051     -3831.525       3323.292     
      1400   311.86652     -31875.053     -9496.1885     -871.47277      3323.292     
      1500   301.38686     -31870.238      2545.2141      10229.471      3323.292     
      1600   298.99572     -31876.201     -4165.4928      1887.4358      3323.292     
      1700   284.39793     -31873.334      12495.11       1716.6383      3323.292     
      1800   279.27282     -31867.764     -5601.1051      3750.2594      3323.292     
      1900   336.08405     -31895.808     -7013.783       608.0485       3323.292     
      2000   336.69985     -31895.744      3118.9073      6657.984       3323.292     
Loop time of 76.9442 on 8 procs for 2000 steps with 271 atoms

Performance: 1.123 ns/day, 21.373 hours/ns, 25.993 timesteps/s, 7.044 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 43.488     | 55.691     | 64.247     |  97.3 | 72.38
Bond    | 0.00067039 | 0.00085427 | 0.00097981 |   0.0 |  0.00
Neigh   | 3.6367     | 4.5228     | 5.2902     |  26.3 |  5.88
Comm    | 1.1336     | 9.6935     | 21.895     | 233.1 | 12.60
Output  | 0.0040492  | 0.0059129  | 0.0074477  |   1.9 |  0.01
Modify  | 6.2292     | 6.9966     | 7.8861     |  21.2 |  9.09
Other   |            | 0.03318    |            |       |  0.04

Nlocal:         33.875 ave          39 max          23 min
Histogram: 1 0 0 0 0 1 2 0 2 2
Nghost:         2765.5 ave        2817 max        2714 min
Histogram: 1 1 1 0 1 1 1 0 0 2
Neighs:        19365.1 ave       21997 max       13347 min
Histogram: 1 0 0 0 0 1 2 0 1 3

Total # of neighbors = 154921
Ave neighs/atom = 571.66421
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 106.7 | 108 | 109.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   336.69985     -31895.744      3118.8954      0              3323.292     
       100   302.83473     -31882.266      875.65596      3762.6248      3323.292     
       200   291.32252     -31896.319      8581.041       1296.2159      3323.292     
       300   277.70003     -31887.005     -13981.406     -4120.6778      3323.292     
       400   305.50165     -31899.118     -1824.8094     -3620.9347      3323.292     
       500   295.41601     -31882.859     -6145.8503      124.43907      3323.292     
       600   313.43791     -31885.891     -2570.5531     -1965.7777      3323.292     
       700   315.0901      -31868.867     -5199.8347      3499.4804      3323.292     
       800   319.35146     -31857.186      195.73346      1476.246       3323.292     
       900   326.65852     -31875.029     -2903.8208     -6945.6841      3323.292     
      1000   296.98075     -31887.335     -5173.5656      1011.224       3323.292     
      1100   265.12314     -31867.786      1350.7572     -2052.7552      3323.292     
      1200   298.70327     -31880.311     -7325.0326     -8129.3414      3323.292     
      1300   291.67768     -31866.505     -15072.408     -1498.4364      3323.292     
      1400   307.01085     -31878.44      -519.40337      3676.9119      3323.292     
      1500   296.35191     -31876.868      6306.4873     -130.90714      3323.292     
      1600   295.01808     -31900.175     -5890.4171     -3518.7999      3323.292     
      1700   278.56064     -31890.32      -17174.103     -5139.6666      3323.292     
      1800   292.16093     -31878.159     -5826.1656     -2399.1209      3323.292     
      1900   304.07675     -31872.231     -19188.909     -1821.661       3323.292     
      2000   330.58789     -31903.002     -3960.9368      2386.955       3323.292     
Loop time of 76.8406 on 8 procs for 2000 steps with 271 atoms

Performance: 1.124 ns/day, 21.345 hours/ns, 26.028 timesteps/s, 7.054 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 43.013     | 57.138     | 64.357     | 103.6 | 74.36
Bond    | 0.00071855 | 0.00086721 | 0.0011431  |   0.0 |  0.00
Neigh   | 3.6694     | 4.6609     | 5.2717     |  27.5 |  6.07
Comm    | 0.9484     | 8.1682     | 22.296     | 274.0 | 10.63
Output  | 0.00090888 | 0.0010179  | 0.001566   |   0.7 |  0.00
Modify  | 6.225      | 6.8373     | 7.8303     |  22.8 |  8.90
Other   |            | 0.03372    |            |       |  0.04

Nlocal:         33.875 ave          42 max          22 min
Histogram: 1 0 0 0 1 2 1 1 0 2
Nghost:        2763.38 ave        2790 max        2737 min
Histogram: 1 0 2 2 0 0 0 1 0 2
Neighs:        19347.4 ave       23652 max       12795 min
Histogram: 1 0 0 0 2 1 1 1 0 2

Total # of neighbors = 154779
Ave neighs/atom = 571.14022
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 45.089070932287
variable C2pos equal ${d2}
variable C2pos equal 59.2837092378127
variable C3pos equal ${d3}
variable C3pos equal 55.8953255215539
variable C4pos equal ${d4}
variable C4pos equal 32.8762275970967
variable C5pos equal ${d5}
variable C5pos equal -10.9443317257815
variable C6pos equal ${d6}
variable C6pos equal 5.68642387375606

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(-35.8137895659905+${C1pos})
variable C11 equal 0.5*(-35.8137895659905+45.089070932287)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(-74.8798760193243+${C2pos})
variable C21 equal 0.5*(-74.8798760193243+59.2837092378127)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(-54.2892508989441+${C3pos})
variable C31 equal 0.5*(-54.2892508989441+55.8953255215539)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-35.2981045518133+${C4pos})
variable C41 equal 0.5*(-35.2981045518133+32.8762275970967)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(-5.47469595889558+${C5pos})
variable C51 equal 0.5*(-5.47469595889558+-10.9443317257815)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-19.4431537481472+${C6pos})
variable C61 equal 0.5*(-19.4431537481472+5.68642387375606)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.4318
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4318
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.134318 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.134318 yz delta 0.018606 remap units box
Changing box ...
  triclinic box = (0 0 0) to (14.7487 13.297482 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  triclinic box = (0 0 0) to (14.7487 13.297482 16.6096) with tilt (-6.1972 -1.0047 -1.841994)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.6 | 109.5 | 111.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   273.71107     -31860.657      36822.389      0              3257.4843    
       100   276.35647     -31847.27      -6167.5951      2973.0352      3257.4843    
       200   316.80325     -31867.834     -7956.0062      3386.8202      3257.4843    
       300   323.70812     -31887.648     -4678.365       5803.0936      3257.4843    
       400   299.98936     -31894.619      6579.5239      2220.5878      3257.4843    
       500   285.13738     -31900.849      829.43619     -1449.1132      3257.4843    
       600   275.04082     -31887.169      2979.4319      2963.9439      3257.4843    
       700   306.98019     -31880.855     -4776.5084      7440.5224      3257.4843    
       800   325.50428     -31878.215     -3583.6616      5163.9458      3257.4843    
       900   302.41663     -31873.122     -5777.224       5993.0986      3257.4843    
      1000   291.9197      -31890.151      4974.4966      3017.0265      3257.4843    
      1100   261.39491     -31873.01       2441.4756      78.285115      3257.4843    
      1200   307.41153     -31885.76      -7328.4805     -814.54449      3257.4843    
      1300   308.93019     -31872.374     -2714.8114      216.07485      3257.4843    
      1400   320.98143     -31898.119      1238.5641      3381.4136      3257.4843    
      1500   301.78342     -31915.87       145.69008      4643.8007      3257.4843    
      1600   276.52508     -31918.353     -2919.7502      3140.2032      3257.4843    
      1700   267.49289     -31915.22      -4328.7301     -2536.8123      3257.4843    
      1800   292.63779     -31918.599     -10959.213      3903.936       3257.4843    
      1900   303.57231     -31914.549     -2682.3411      2791.8952      3257.4843    
      2000   306.27271     -31924.838      2260.0584      9071.7989      3257.4843    
Loop time of 78.5225 on 8 procs for 2000 steps with 271 atoms

Performance: 1.100 ns/day, 21.812 hours/ns, 25.470 timesteps/s, 6.902 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 44.593     | 59.351     | 65.643     | 106.3 | 75.58
Bond    | 0.00073312 | 0.00084434 | 0.00099553 |   0.0 |  0.00
Neigh   | 3.7172     | 4.8068     | 5.4445     |  27.9 |  6.12
Comm    | 1.1448     | 7.4362     | 22.193     | 300.4 |  9.47
Output  | 0.0038112  | 0.0062056  | 0.0080891  |   2.3 |  0.01
Modify  | 6.2444     | 6.8873     | 7.9819     |  23.4 |  8.77
Other   |            | 0.03444    |            |       |  0.04

Nlocal:         33.875 ave          37 max          28 min
Histogram: 1 0 0 0 1 0 3 1 0 2
Nghost:        2785.75 ave        2821 max        2750 min
Histogram: 1 1 0 0 2 1 1 1 0 1
Neighs:        19786.2 ave       21599 max       16556 min
Histogram: 1 0 0 0 1 0 3 1 0 2

Total # of neighbors = 158290
Ave neighs/atom = 584.09594
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.6 | 109.5 | 111.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   306.27271     -31924.838      2259.9929      0              3257.4843    
       100   286.31161     -31911.607     -6882.5523     -170.37524      3257.4843    
       200   311.32076     -31944.456     -4084.4926      4608.3706      3257.4843    
       300   268.96115     -31932.163      3711.989      -150.52098      3257.4843    
       400   282.98538     -31938.162     -13291.69      -1895.7047      3257.4843    
       500   304.47937     -31926.92      -7649.4918      4098.5904      3257.4843    
       600   322.05916     -31927.691     -13351.88       1682.9912      3257.4843    
       700   318.78112     -31930.199     -12320.889     -1264.1454      3257.4843    
       800   302.18573     -31932.256     -16402.253      4429.9108      3257.4843    
       900   303.80846     -31945.203     -7569.7104     -773.26927      3257.4843    
      1000   308.45012     -31948.591     -2895.0999      6049.5665      3257.4843    
      1100   289.44421     -31930.134     -2897.4851      4673.5679      3257.4843    
      1200   301.97447     -31935.222     -26852.779     -1925.7376      3257.4843    
      1300   312.36254     -31939.287     -10271.133      1537.688       3257.4843    
      1400   295.70849     -31946.174     -13970.382      2307.6685      3257.4843    
      1500   282.06032     -31956.527      3184.7601      3199.2961      3257.4843    
      1600   276.21746     -31942.954     -4648.9129      2509.53        3257.4843    
      1700   290.75257     -31935.388     -11538.275      100.01744      3257.4843    
      1800   306.42302     -31942.387     -3668.7707      780.23863      3257.4843    
      1900   305.32144     -31944.651     -9353.4459     -78.714958      3257.4843    
      2000   296.37        -31955.661     -8090.0744      3597.995       3257.4843    
Loop time of 78.7319 on 8 procs for 2000 steps with 271 atoms

Performance: 1.097 ns/day, 21.870 hours/ns, 25.403 timesteps/s, 6.884 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 44.571     | 60.099     | 65.498     |  94.4 | 76.33
Bond    | 0.00063333 | 0.00084849 | 0.0010689  |   0.0 |  0.00
Neigh   | 3.7666     | 4.8243     | 5.3577     |  24.2 |  6.13
Comm    | 1.5949     | 6.9886     | 22.525     | 277.0 |  8.88
Output  | 0.00085704 | 0.00096831 | 0.0013738  |   0.0 |  0.00
Modify  | 6.2438     | 6.7835     | 7.836      |  20.4 |  8.62
Other   |            | 0.03432    |            |       |  0.04

Nlocal:         33.875 ave          38 max          28 min
Histogram: 1 0 1 0 0 1 1 1 1 2
Nghost:        2784.25 ave        2830 max        2740 min
Histogram: 1 1 0 2 1 0 0 1 0 2
Neighs:          19792 ave       21936 max       16519 min
Histogram: 1 0 1 0 0 1 2 0 1 2

Total # of neighbors = 158336
Ave neighs/atom = 584.26568
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -32.8182080741483
variable C2neg equal ${d2}
variable C2neg equal -78.8536638187371
variable C3neg equal ${d3}
variable C3neg equal -37.3230708623472
variable C4neg equal ${d4}
variable C4neg equal -2.5139321981475
variable C5neg equal ${d5}
variable C5neg equal -12.8685104487231
variable C6neg equal ${d6}
variable C6neg equal -7.33807018198293

# Reset box and simulation parameters
clear
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4318
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.134318 yz delta ${deltayz} remap units box
change_box all y delta 0 0.134318 yz delta -0.018606 remap units box
Changing box ...
  triclinic box = (0 0 0) to (14.7487 13.566118 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  triclinic box = (0 0 0) to (14.7487 13.566118 16.6096) with tilt (-6.1972 -1.0047 -1.879206)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 106.4 | 107.6 | 109.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   273.71107     -31845.936     -49234.019      0              3323.292     
       100   294.06726     -31848.299     -5584.9718      2319.2342      3323.292     
       200   319.51563     -31866.442     -1346.542       7866.1597      3323.292     
       300   286.98315     -31861.766      10491.705      4565.9081      3323.292     
       400   319.02053     -31903.497     -1093.7329      351.78218      3323.292     
       500   271.05484     -31874.28      -14614.856     -1356.9483      3323.292     
       600   299.6628      -31884.876     -11780.67      -5495.7388      3323.292     
       700   340.20676     -31893.301      5239.5115      6610.9434      3323.292     
       800   301.78182     -31870.035     -1689.4497     -171.8525       3323.292     
       900   276.85777     -31868.059     -3904.9508      7867.7937      3323.292     
      1000   269.04466     -31871.082     -6141.8088      1739.8325      3323.292     
      1100   286.29996     -31879.783     -6124.4531      122.01487      3323.292     
      1200   320.16664     -31884.556      9605.6929      2124.6015      3323.292     
      1300   327.77355     -31873.246      4121.0766      1545.0994      3323.292     
      1400   312.61779     -31875.881     -11428.059      4966.2845      3323.292     
      1500   282.52691     -31876.151     -8629.1257      1639.6325      3323.292     
      1600   305.00452     -31909.533      3265.959       436.48345      3323.292     
      1700   264.55417     -31878.362      6277.0501      1602.2542      3323.292     
      1800   331.64037     -31908.195     -12844.635     -256.83411      3323.292     
      1900   326.62561     -31886.822     -8337.2945     -2121.6644      3323.292     
      2000   306.55273     -31867.787     -755.46852      4167.4891      3323.292     
Loop time of 77.3659 on 8 procs for 2000 steps with 271 atoms

Performance: 1.117 ns/day, 21.491 hours/ns, 25.851 timesteps/s, 7.006 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 43.122     | 59.027     | 64.212     |  86.8 | 76.30
Bond    | 0.00066447 | 0.00081366 | 0.00093664 |   0.0 |  0.00
Neigh   | 3.6409     | 4.76       | 5.2067     |  22.1 |  6.15
Comm    | 1.4751     | 6.6599     | 22.564     | 258.3 |  8.61
Output  | 0.0040001  | 0.006702   | 0.008745   |   2.5 |  0.01
Modify  | 6.4328     | 6.8782     | 7.9995     |  18.4 |  8.89
Other   |            | 0.03377    |            |       |  0.04

Nlocal:         33.875 ave          41 max          24 min
Histogram: 1 0 0 0 1 2 2 0 1 1
Nghost:         2761.5 ave        2814 max        2712 min
Histogram: 1 1 0 2 1 1 0 0 0 2
Neighs:        19348.4 ave       23089 max       13921 min
Histogram: 1 0 0 0 1 2 2 0 1 1

Total # of neighbors = 154787
Ave neighs/atom = 571.16974
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 106.5 | 107.6 | 109.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   306.55273     -31867.787     -755.41342      0              3323.292     
       100   289.94622     -31864.101     -12696.466      3488.5832      3323.292     
       200   297.10439     -31898.068     -11692.933     -3797.9199      3323.292     
       300   258.06936     -31870.693     -7657.301      -4108.7423      3323.292     
       400   289.39783     -31880.992     -14480.948      1559.1889      3323.292     
       500   285.33307     -31863.246     -13471.917     -3468.7309      3323.292     
       600   309.57349     -31868.286     -9239.9453     -3739.4884      3323.292     
       700   300.46619     -31866.056      460.50657      272.35894      3323.292     
       800   313.9857      -31888.859      73.089926      3434.6673      3323.292     
       900   275.11493     -31895.683      1952.7221      1886.3174      3323.292     
      1000   273.66453     -31890.805      3993.8794     -1287.9581      3323.292     
      1100   296.81922     -31883.931     -8594.6675     -1450.7878      3323.292     
      1200   297.32442     -31865.37      -3410.692      -587.89379      3323.292     
      1300   307.17954     -31867.104     -6655.1328      2879.0596      3323.292     
      1400   290.86125     -31866.604     -14300.228      1388.864       3323.292     
      1500   273.17676     -31873.42      -12694.688      423.04497      3323.292     
      1600   286.06191     -31895.485      12800.281     -2226.7003      3323.292     
      1700   278.23859     -31891.638     -3211.068      -763.83887      3323.292     
      1800   300.69621     -31883.707     -9445.6407     -4765.3204      3323.292     
      1900   294.71292     -31860.121      10257.802      1261.8055      3323.292     
      2000   325.91471     -31890.705     -1310.3781      1299.4507      3323.292     
Loop time of 77.3185 on 8 procs for 2000 steps with 271 atoms

Performance: 1.117 ns/day, 21.477 hours/ns, 25.867 timesteps/s, 7.010 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 45.419     | 60.791     | 64.815     |  76.0 | 78.62
Bond    | 0.00069689 | 0.0008196  | 0.00094802 |   0.0 |  0.00
Neigh   | 3.8141     | 4.9137     | 5.234      |  19.1 |  6.36
Comm    | 0.81414    | 4.8426     | 20.214     | 269.1 |  6.26
Output  | 0.00093791 | 0.0010996  | 0.0020915  |   1.1 |  0.00
Modify  | 6.4173     | 6.7355     | 7.839      |  16.4 |  8.71
Other   |            | 0.03417    |            |       |  0.04

Nlocal:         33.875 ave          38 max          26 min
Histogram: 1 0 0 1 0 0 2 0 2 2
Nghost:        2755.62 ave        2789 max        2722 min
Histogram: 1 2 1 0 0 0 1 0 1 2
Neighs:          19368 ave       21717 max       15071 min
Histogram: 1 0 0 1 0 0 2 2 0 2

Total # of neighbors = 154944
Ave neighs/atom = 571.74908
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 56.1082085850816
variable C2pos equal ${d2}
variable C2pos equal 97.0087312103716
variable C3pos equal ${d3}
variable C3pos equal 12.629693657452
variable C4pos equal ${d4}
variable C4pos equal 18.9088364926267
variable C5pos equal ${d5}
variable C5pos equal 3.99822599322795
variable C6pos equal ${d6}
variable C6pos equal 5.32369057167427

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(-32.8182080741483+${C1pos})
variable C12 equal 0.5*(-32.8182080741483+56.1082085850816)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(-78.8536638187371+${C2pos})
variable C22 equal 0.5*(-78.8536638187371+97.0087312103716)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(-37.3230708623472+${C3pos})
variable C32 equal 0.5*(-37.3230708623472+12.629693657452)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-2.5139321981475+${C4pos})
variable C42 equal 0.5*(-2.5139321981475+18.9088364926267)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(-12.8685104487231+${C5pos})
variable C52 equal 0.5*(-12.8685104487231+3.99822599322795)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(-7.33807018198293+${C6pos})
variable C62 equal 0.5*(-7.33807018198293+5.32369057167427)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.6096
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.6096
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.166096 remap units box
Changing box ...
  triclinic box = (0 0 0) to (14.7487 13.4318 16.443504) with tilt (-6.1972 -1.0047 -1.8606)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.7 | 109.3 | 111 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   273.71107     -31860.353      35288.078      0              3257.4843    
       100   287.68012     -31855.672     -9867.1076      3507.8541      3257.4843    
       200   303.21738     -31859.192     -6577.9246      5413.3331      3257.4843    
       300   308.82453     -31875.381      5105.6864      7009.3223      3257.4843    
       400   324.68365     -31913.893     -11239.015      1545.2824      3257.4843    
       500   281.44805     -31903.053     -5307.2246      242.04506      3257.4843    
       600   290.91315     -31906.516      2953.6107      1425.5355      3257.4843    
       700   278.19648     -31869.874      5951.2816      10492.468      3257.4843    
       800   306.4053      -31872.777      13306.26       7384.6205      3257.4843    
       900   304.4695      -31870.595     -10481.469      11886.256      3257.4843    
      1000   297.7525      -31884.285      6639.8185      8542.6838      3257.4843    
      1100   289.66555     -31897.81       276.60149      1859.8077      3257.4843    
      1200   305.15912     -31915.737      6084.0863      1789.5675      3257.4843    
      1300   285.65929     -31889.827     -840.68953      3168.4152      3257.4843    
      1400   293.78826     -31875.136     -16551.405      2117.4101      3257.4843    
      1500   320.40163     -31880.666     -7783.6         3197.2305      3257.4843    
      1600   290.52171     -31859.552     -9033.0243     -156.48554      3257.4843    
      1700   305.27195     -31894.422      2765.5996      5021.814       3257.4843    
      1800   289.66282     -31907.764      848.46809      2583.0157      3257.4843    
      1900   266.16559     -31889.225     -80.056847      6039.1308      3257.4843    
      2000   297.72407     -31898.149      2824.7067      1648.6321      3257.4843    
Loop time of 80.0595 on 8 procs for 2000 steps with 271 atoms

Performance: 1.079 ns/day, 22.239 hours/ns, 24.981 timesteps/s, 6.770 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 44.376     | 62.735     | 67.197     |  89.1 | 78.36
Bond    | 0.00069391 | 0.00085278 | 0.0010003  |   0.0 |  0.00
Neigh   | 3.7088     | 5.0118     | 5.3806     |  22.4 |  6.26
Comm    | 0.98557    | 5.458      | 23.812     | 301.9 |  6.82
Output  | 0.0041375  | 0.0069822  | 0.0091863  |   2.6 |  0.01
Modify  | 6.4491     | 6.8129     | 8.1232     |  19.3 |  8.51
Other   |            | 0.03462    |            |       |  0.04

Nlocal:         33.875 ave          40 max          23 min
Histogram: 1 0 0 0 1 1 0 3 0 2
Nghost:        2814.38 ave        2848 max        2773 min
Histogram: 1 0 1 0 1 2 1 0 0 2
Neighs:        19762.2 ave       22971 max       13686 min
Histogram: 1 0 0 0 1 1 0 3 0 2

Total # of neighbors = 158098
Ave neighs/atom = 583.38745
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.7 | 109.3 | 111.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   297.72407     -31898.149      2824.6814      0              3257.4843    
       100   298.99624     -31894.853     -61.943132      7944.3643      3257.4843    
       200   321.85364     -31893.945     -6171.2874      1334.4589      3257.4843    
       300   319.87746     -31874.168      2865.9302      7788.3251      3257.4843    
       400   294.67555     -31873.174     -5203.6328      7862.2083      3257.4843    
       500   286.32554     -31895.267     -8279.7076      9005.623       3257.4843    
       600   293.65621     -31901.34      -695.99793      7371.4997      3257.4843    
       700   320.47141     -31911.622     -975.98642      2105.6175      3257.4843    
       800   329.95978     -31902.324     -5796.6861      4038.1097      3257.4843    
       900   296.32034     -31875.864     -1516.0538      5340.7355      3257.4843    
      1000   298.7271      -31905.436     -2732.9804      3709.7323      3257.4843    
      1100   289.0101      -31908.547     -2550.8877      79.490204      3257.4843    
      1200   295.19684     -31903.858      2943.5167      8656.9166      3257.4843    
      1300   313.02493     -31888.376     -8939.5086      3113.4832      3257.4843    
      1400   317.93162     -31886.589      8660.456       2327.9649      3257.4843    
      1500   307.28717     -31889.681     -2445.3497      5798.811       3257.4843    
      1600   305.60863     -31911.999     -5544.0486      4350.525       3257.4843    
      1700   285.99286     -31912.258     -331.44221      4844.3537      3257.4843    
      1800   279.10588     -31907.661     -1393.959       1001.5368      3257.4843    
      1900   314.96673     -31926.85      -7969.1285      4819.937       3257.4843    
      2000   307.1175      -31895.749      8416.0043      3451.4825      3257.4843    
Loop time of 79.5087 on 8 procs for 2000 steps with 271 atoms

Performance: 1.087 ns/day, 22.086 hours/ns, 25.154 timesteps/s, 6.817 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.907     | 61.839     | 66.794     |  68.9 | 77.78
Bond    | 0.00069031 | 0.00084604 | 0.00094405 |   0.0 |  0.00
Neigh   | 4.247      | 4.9356     | 5.337      |  18.1 |  6.21
Comm    | 1.0885     | 6.0499     | 15.978     | 220.3 |  7.61
Output  | 0.0009386  | 0.0010703  | 0.0015558  |   0.6 |  0.00
Modify  | 6.2501     | 6.6475     | 7.3429     |  15.7 |  8.36
Other   |            | 0.03524    |            |       |  0.04

Nlocal:         33.875 ave          40 max          26 min
Histogram: 1 0 0 0 2 2 1 0 1 1
Nghost:         2798.5 ave        2845 max        2751 min
Histogram: 1 1 0 1 2 1 0 0 0 2
Neighs:        19785.5 ave       23062 max       15423 min
Histogram: 1 0 0 0 2 2 1 0 1 1

Total # of neighbors = 158284
Ave neighs/atom = 584.0738
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -34.3027467449669
variable C2neg equal ${d2}
variable C2neg equal -99.6607064026269
variable C3neg equal ${d3}
variable C3neg equal -10.7074811556985
variable C4neg equal ${d4}
variable C4neg equal -22.7449854192255
variable C5neg equal ${d5}
variable C5neg equal -19.8967851072932
variable C6neg equal ${d6}
variable C6neg equal -0.97779578299559

# Reset box and simulation parameters
clear
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.6096
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.166096 remap units box
Changing box ...
  triclinic box = (0 0 0) to (14.7487 13.4318 16.775696) with tilt (-6.1972 -1.0047 -1.8606)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 106.3 | 107.8 | 109.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   273.71107     -31850.766     -46036.84       0              3323.292     
       100   290.29132     -31849.267     -10142.066      1944.011       3323.292     
       200   311.04662     -31857.218      3084.0528      6234.8963      3323.292     
       300   316.56897     -31879.093      3944.4847      4794.9413      3323.292     
       400   307.61211     -31895.635     -7978.2583     -1862.0926      3323.292     
       500   288.89964     -31896.982     -1280.3976     -185.55354      3323.292     
       600   274.08608     -31880.639     -1924.6499      1593.5187      3323.292     
       700   314.65085     -31883.137      6450.6769      5850.5163      3323.292     
       800   327.92625     -31877.467     -1250.8133      8320.2544      3323.292     
       900   307.72333     -31874.068     -15217.609      7812.2345      3323.292     
      1000   282.15313     -31875.297     -6923.3056      6431.4471      3323.292     
      1100   283.22974     -31880.635      3375.2888      366.29368      3323.292     
      1200   310.99168     -31891.235     -3451.0221      3551.7647      3323.292     
      1300   293.32605     -31876.966     -8048.2068      1084.1565      3323.292     
      1400   302.4097      -31883.848     -11810.538     -3159.627       3323.292     
      1500   303.20347     -31880.347     -7717.4119      2519.4706      3323.292     
      1600   333.29878     -31901.466     -7461.2008      3504.2713      3323.292     
      1700   328.54106     -31896.531      90.712308      7572.1567      3323.292     
      1800   305.69163     -31889.73       2170.2804      1086.5993      3323.292     
      1900   281.5371      -31881.91      -11725.541      2185.7479      3323.292     
      2000   313.54872     -31902.447     -7322.8516     -1138.5633      3323.292     
Loop time of 76.7973 on 8 procs for 2000 steps with 271 atoms

Performance: 1.125 ns/day, 21.333 hours/ns, 26.043 timesteps/s, 7.058 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 43.95      | 57.121     | 64.223     |  92.2 | 74.38
Bond    | 0.00068037 | 0.00084469 | 0.00099942 |   0.0 |  0.00
Neigh   | 3.6366     | 4.6098     | 5.2354     |  24.7 |  6.00
Comm    | 1.1275     | 8.2317     | 21.4       | 242.9 | 10.72
Output  | 0.0035857  | 0.0063331  | 0.008383   |   2.6 |  0.01
Modify  | 6.1662     | 6.7942     | 7.7722     |  20.5 |  8.85
Other   |            | 0.03343    |            |       |  0.04

Nlocal:         33.875 ave          38 max          23 min
Histogram: 1 0 0 0 0 0 1 1 3 2
Nghost:        2763.62 ave        2820 max        2705 min
Histogram: 1 0 1 1 1 2 0 0 0 2
Neighs:        19350.5 ave       21717 max       13364 min
Histogram: 1 0 0 0 0 0 1 2 2 2

Total # of neighbors = 154804
Ave neighs/atom = 571.23247
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 106.4 | 107.8 | 109.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   313.54872     -31902.447     -7322.8634      0              3323.292     
       100   273.71006     -31874.247     -3118.4984      10047.465      3323.292     
       200   276.37119     -31867.332     -11471.96       4527.2455      3323.292     
       300   299.34469     -31855.636     -13273.841      1444.2109      3323.292     
       400   315.49191     -31865.775      4882.2713      4022.8515      3323.292     
       500   300.99592     -31880.884      3795.9001      1352.3973      3323.292     
       600   280.27637     -31879.321     -1179.6788      3131.5091      3323.292     
       700   289.84792     -31882.863     -6838.4606     -3184.3706      3323.292     
       800   309.97028     -31882.949     -2339.4725     -1764.4044      3323.292     
       900   310.37638     -31864.872      10976.486      2051.3071      3323.292     
      1000   331.38946     -31870.052     -25901.603      7320.7238      3323.292     
      1100   305.10055     -31873.701      5631.0844      5188.0769      3323.292     
      1200   294.12605     -31884.25      -436.24711      1315.5392      3323.292     
      1300   273.01592     -31873.103     -10295.832      2962.2835      3323.292     
      1400   296.3748      -31884.906      1604.5069      2257.5142      3323.292     
      1500   310.2488      -31871.729     -8350.765      -1688.0815      3323.292     
      1600   326.36055     -31883.71      -1553.4098     -744.89086      3323.292     
      1700   298.00263     -31888.7        279.78385      2186.386       3323.292     
      1800   272.9337      -31880.108     -911.92616     -748.51608      3323.292     
      1900   313.45137     -31904.26      -5606.5146     -166.21147      3323.292     
      2000   302.31513     -31883.15      -6780.3918     -1204.311       3323.292     
Loop time of 76.4649 on 8 procs for 2000 steps with 271 atoms

Performance: 1.130 ns/day, 21.240 hours/ns, 26.156 timesteps/s, 7.088 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 43.873     | 55.687     | 64.037     | 105.6 | 72.83
Bond    | 0.00065963 | 0.0008437  | 0.0010294  |   0.0 |  0.00
Neigh   | 3.6613     | 4.5419     | 5.2116     |  28.4 |  5.94
Comm    | 1.0685     | 9.4214     | 21.232     | 256.8 | 12.32
Output  | 0.00091087 | 0.0010113  | 0.001491   |   0.6 |  0.00
Modify  | 6.1097     | 6.7795     | 7.6607     |  23.3 |  8.87
Other   |            | 0.03333    |            |       |  0.04

Nlocal:         33.875 ave          39 max          23 min
Histogram: 1 0 0 0 0 1 2 0 3 1
Nghost:        2767.25 ave        2793 max        2737 min
Histogram: 1 1 0 1 0 1 2 0 1 1
Neighs:        19355.1 ave       21981 max       13355 min
Histogram: 1 0 0 0 0 1 1 1 2 2

Total # of neighbors = 154841
Ave neighs/atom = 571.369
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 81.477574248914
variable C2pos equal ${d2}
variable C2pos equal 84.1371633889318
variable C3pos equal ${d3}
variable C3pos equal 75.1908316733015
variable C4pos equal ${d4}
variable C4pos equal 23.7026348049594
variable C5pos equal ${d5}
variable C5pos equal -5.57768160940479
variable C6pos equal ${d6}
variable C6pos equal -3.97301915147761

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(-34.3027467449669+${C1pos})
variable C13 equal 0.5*(-34.3027467449669+81.477574248914)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(-99.6607064026269+${C2pos})
variable C23 equal 0.5*(-99.6607064026269+84.1371633889318)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(-10.7074811556985+${C3pos})
variable C33 equal 0.5*(-10.7074811556985+75.1908316733015)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-22.7449854192255+${C4pos})
variable C43 equal 0.5*(-22.7449854192255+23.7026348049594)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-19.8967851072932+${C5pos})
variable C53 equal 0.5*(-19.8967851072932+-5.57768160940479)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-0.97779578299559+${C6pos})
variable C63 equal 0.5*(-0.97779578299559+-3.97301915147761)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.6096
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.6096
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.166096 remap units box
Changing box ...
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -2.026696)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.1 | 108.8 | 110.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   273.71107     -31864.8       -6426.092       0              3290.3881    
       100   283.58884     -31853.527     -9405.2105      1649.3649      3290.3881    
       200   322.32116     -31866.722     -3543.4258      7518.7608      3290.3881    
       300   326.19636     -31880.116      16082.926      4675.9622      3290.3881    
       400   298.53172     -31886.673      2535.6142      407.97363      3290.3881    
       500   286.03864     -31899.232     -24163.616     -2104.5266      3290.3881    
       600   279.88024     -31889.388     -10807.048     -4360.696       3290.3881    
       700   304.62221     -31878.817      6252.237       6897.0819      3290.3881    
       800   324.22457     -31878.871     -12055.893      1980.6185      3290.3881    
       900   317.25154     -31880.258     -10552.965      7008.588       3290.3881    
      1000   306.5062      -31888.149      5034.9142      4161.5035      3290.3881    
      1100   287.07717     -31881.825      8379.9246      2796.4907      3290.3881    
      1200   284.67809     -31872.723     -10223.138      2689.0145      3290.3881    
      1300   302.60091     -31872.802     -6127.103       4416.9243      3290.3881    
      1400   300.27733     -31866.75      -10224.774      563.31317      3290.3881    
      1500   323.34015     -31891.888     -2610.3869      1996.5742      3290.3881    
      1600   291.09364     -31878.497     -14449.979      2931.0422      3290.3881    
      1700   294.99645     -31885.91      -12782.484     -1851.1092      3290.3881    
      1800   290.91508     -31874.53      -8992.667      -1224.5061      3290.3881    
      1900   319.35665     -31889.895      2941.8134      6998.1859      3290.3881    
      2000   289.43866     -31879.612     -1587.1044      7617.4727      3290.3881    
Loop time of 77.9975 on 8 procs for 2000 steps with 271 atoms

Performance: 1.108 ns/day, 21.666 hours/ns, 25.642 timesteps/s, 6.949 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 44.371     | 58.424     | 65.087     |  96.8 | 74.91
Bond    | 0.00067909 | 0.00084323 | 0.00099326 |   0.0 |  0.00
Neigh   | 3.7461     | 4.7537     | 5.281      |  25.8 |  6.09
Comm    | 1.3468     | 8.0085     | 22.056     | 261.4 | 10.27
Output  | 0.0037346  | 0.0059529  | 0.0077148  |   2.2 |  0.01
Modify  | 6.2451     | 6.7696     | 7.785      |  21.7 |  8.68
Other   |            | 0.03463    |            |       |  0.04

Nlocal:         33.875 ave          39 max          22 min
Histogram: 1 0 0 0 0 2 0 1 2 2
Nghost:         2787.5 ave        2837 max        2743 min
Histogram: 1 0 2 2 0 0 1 0 1 1
Neighs:        19526.4 ave       22458 max       12905 min
Histogram: 1 0 0 0 0 2 0 1 2 2

Total # of neighbors = 156211
Ave neighs/atom = 576.42435
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.2 | 108.8 | 110.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.43866     -31879.612     -1587.1237      0              3290.3881    
       100   317.95857     -31900.393     -2071.9502      3819.9565      3290.3881    
       200   299.12206     -31892.556     -12259.874      2899.1811      3290.3881    
       300   286.25663     -31899.483     -10818.379      3125.407       3290.3881    
       400   274.60621     -31891.917      775.32339      1613.9769      3290.3881    
       500   322.79223     -31903.931     -13479.726     -2152.7159      3290.3881    
       600   306.23299     -31878.887      821.98928      2651.0695      3290.3881    
       700   302.40375     -31880.072     -1360.3998      3551.7058      3290.3881    
       800   313.89026     -31899.907     -7326.9792      5384.3256      3290.3881    
       900   262.32354     -31887.556     -12676.667      3728.2549      3290.3881    
      1000   293.0128      -31914.597     -9434.3343      7760.559       3290.3881    
      1100   298.27886     -31893.811      2009.1377      2610.8592      3290.3881    
      1200   305.15863     -31888.416     -10324.826      315.08526      3290.3881    
      1300   312.57415     -31897.103     -3902.5507      2910.8927      3290.3881    
      1400   316.48957     -31900.857     -5787.7696      5728.5336      3290.3881    
      1500   258.33621     -31867.593     -13611.436     -434.69163      3290.3881    
      1600   293.55389     -31907.211     -8370.2815      8539.4653      3290.3881    
      1700   289.69577     -31925.774      6215.1026      6273.0329      3290.3881    
      1800   281.69078     -31919.613      3564.7915      924.19537      3290.3881    
      1900   293.77821     -31899.244     -905.57179      2161.5996      3290.3881    
      2000   302.53016     -31898.881     -4198.0927     -76.332332      3290.3881    
Loop time of 78.1996 on 8 procs for 2000 steps with 271 atoms

Performance: 1.105 ns/day, 21.722 hours/ns, 25.576 timesteps/s, 6.931 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 45.123     | 59.471     | 65.352     | 105.6 | 76.05
Bond    | 0.00065546 | 0.00084136 | 0.00098534 |   0.0 |  0.00
Neigh   | 3.731      | 4.8051     | 5.3287     |  27.6 |  6.14
Comm    | 1.1596     | 7.0468     | 21.386     | 306.7 |  9.01
Output  | 0.00095339 | 0.0010496  | 0.0015237  |   0.6 |  0.00
Modify  | 6.3206     | 6.8401     | 7.9144     |  23.3 |  8.75
Other   |            | 0.03503    |            |       |  0.04

Nlocal:         33.875 ave          42 max          22 min
Histogram: 1 0 0 1 0 2 0 1 2 1
Nghost:        2793.88 ave        2850 max        2734 min
Histogram: 1 0 1 1 2 0 0 1 0 2
Neighs:        19537.8 ave       24147 max       12876 min
Histogram: 1 0 0 1 0 2 0 2 1 1

Total # of neighbors = 156302
Ave neighs/atom = 576.76015
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -70.0483302437789
variable C2neg equal ${d2}
variable C2neg equal -91.6572845140537
variable C3neg equal ${d3}
variable C3neg equal -36.1540186088508
variable C4neg equal ${d4}
variable C4neg equal -2.56328977099487
variable C5neg equal ${d5}
variable C5neg equal -9.02407530237183
variable C6neg equal ${d6}
variable C6neg equal -9.66470314801349

# Reset box and simulation parameters
clear
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.6096
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.166096 remap units box
Changing box ...
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.694504)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107 | 108.6 | 110.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   273.71107     -31864.415     -10507.177      0              3290.3881    
       100   283.0474      -31853.427     -13329.874      2284.0683      3290.3881    
       200   313.23263     -31861.815     -15661.752      3314.6953      3290.3881    
       300   327.0086      -31883.032      9902.775       5346.3667      3290.3881    
       400   309.00083     -31893.893     -8258.498       2083.9371      3290.3881    
       500   274.98413     -31888.603     -10003.752     -1619.6755      3290.3881    
       600   278.81077     -31890.822     -11850.327      419.40523      3290.3881    
       700   295.79128     -31879.736      5443.8062      8622.8479      3290.3881    
       800   331.00527     -31890.468     -1966.2506      2654.883       3290.3881    
       900   289.39472     -31861.591      3131.6205      7996.7182      3290.3881    
      1000   286.34686     -31872.12       11875.73       5255.826       3290.3881    
      1100   279.54197     -31865.899     -3159.0679      472.83505      3290.3881    
      1200   308.85297     -31873.934     -6265.6421      2524.5823      3290.3881    
      1300   298.74064     -31859.977     -3700.9897     -281.12838      3290.3881    
      1400   326.68076     -31888.32      -4711.8019      4270.6912      3290.3881    
      1500   287.95073     -31873.715      1946.1958      3289.1553      3290.3881    
      1600   277.95045     -31875.241     -2725.7304      3677.1281      3290.3881    
      1700   292.52316     -31895.921      302.61324      3349.6433      3290.3881    
      1800   303.30926     -31906.468     -10651.041      4069.5604      3290.3881    
      1900   301.65401     -31894.766      3557.8759      1332.8117      3290.3881    
      2000   303.6632      -31880.56       6062.0388      4134.4689      3290.3881    
Loop time of 77.6135 on 8 procs for 2000 steps with 271 atoms

Performance: 1.113 ns/day, 21.559 hours/ns, 25.769 timesteps/s, 6.983 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 44.168     | 57.883     | 64.994     |  97.2 | 74.58
Bond    | 0.00069777 | 0.00083051 | 0.00096865 |   0.0 |  0.00
Neigh   | 3.7671     | 4.6456     | 5.242      |  24.9 |  5.99
Comm    | 1.0802     | 8.1917     | 21.905     | 258.2 | 10.55
Output  | 0.0040257  | 0.0065491  | 0.0084815  |   2.3 |  0.01
Modify  | 6.2553     | 6.8511     | 7.7331     |  20.6 |  8.83
Other   |            | 0.03478    |            |       |  0.04

Nlocal:         33.875 ave          39 max          22 min
Histogram: 1 0 0 0 0 0 3 1 0 3
Nghost:         2775.5 ave        2829 max        2730 min
Histogram: 1 1 1 0 2 1 0 0 1 1
Neighs:        19549.4 ave       22533 max       12879 min
Histogram: 1 0 0 0 0 0 3 1 0 3

Total # of neighbors = 156395
Ave neighs/atom = 577.10332
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107 | 108.6 | 110.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   303.6632      -31880.56       6062.0689      0              3290.3881    
       100   291.59744     -31876.907     -2845.2683      2630.6941      3290.3881    
       200   282.49042     -31881.112     -4824.0553      2982.1451      3290.3881    
       300   283.28518     -31876.676      3613.6976      4036.981       3290.3881    
       400   318.22809     -31877.985     -9711.2129      2686.6579      3290.3881    
       500   298.6356      -31857.842     -5332.5033      7297.5933      3290.3881    
       600   322.06757     -31886.235      6949.3256     -1413.6206      3290.3881    
       700   285.52749     -31887.951      2785.5573     -2729.7024      3290.3881    
       800   283.79297     -31888.495     -7015.3586      7183.4495      3290.3881    
       900   282.25565     -31876.251     -18123.112     -2040.728       3290.3881    
      1000   313.8272      -31891.897     -23806.891     -3074.7263      3290.3881    
      1100   317.22382     -31904.097      2873.5455      8906.9998      3290.3881    
      1200   275.97552     -31905.953      426.53663      5942.0054      3290.3881    
      1300   289.3424      -31907.269     -12543.066      101.27733      3290.3881    
      1400   294.56283     -31889.078     -22.223063      8446.8024      3290.3881    
      1500   310.10187     -31897.089     -2033.6491      2075.4572      3290.3881    
      1600   298.37814     -31885.329      8554.2576      826.25241      3290.3881    
      1700   328.28253     -31903.073     -358.38844     -452.63459      3290.3881    
      1800   297.01359     -31890.618     -5328.1471      899.41841      3290.3881    
      1900   313.09457     -31926.588      3303.4328      4188.801       3290.3881    
      2000   279.91557     -31902.788      8147.7604      1718.8761      3290.3881    
Loop time of 78.0835 on 8 procs for 2000 steps with 271 atoms

Performance: 1.107 ns/day, 21.690 hours/ns, 25.614 timesteps/s, 6.941 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 48.299     | 60.422     | 65.487     |  76.3 | 77.38
Bond    | 0.00066383 | 0.00084918 | 0.00097359 |   0.0 |  0.00
Neigh   | 3.7799     | 4.8124     | 5.2203     |  22.7 |  6.16
Comm    | 0.95693    | 6.0301     | 18.155     | 241.7 |  7.72
Output  | 0.00092758 | 0.0010553  | 0.0016654  |   0.7 |  0.00
Modify  | 6.3768     | 6.7806     | 7.8138     |  19.1 |  8.68
Other   |            | 0.03645    |            |       |  0.05

Nlocal:         33.875 ave          41 max          24 min
Histogram: 1 0 1 0 1 2 0 1 0 2
Nghost:        2776.88 ave        2827 max        2738 min
Histogram: 1 1 1 1 0 2 1 0 0 1
Neighs:        19580.5 ave       23529 max       14107 min
Histogram: 1 0 1 0 1 1 1 1 0 2

Total # of neighbors = 156644
Ave neighs/atom = 578.02214
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 51.8583812947748
variable C2pos equal ${d2}
variable C2pos equal 116.622583668032
variable C3pos equal ${d3}
variable C3pos equal 77.4174048561381
variable C4pos equal ${d4}
variable C4pos equal 8.54467955391184
variable C5pos equal ${d5}
variable C5pos equal 5.28387677197168
variable C6pos equal ${d6}
variable C6pos equal 7.80247302983709

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-70.0483302437789+${C1pos})
variable C14 equal 0.5*(-70.0483302437789+51.8583812947748)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(-91.6572845140537+${C2pos})
variable C24 equal 0.5*(-91.6572845140537+116.622583668032)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-36.1540186088508+${C3pos})
variable C34 equal 0.5*(-36.1540186088508+77.4174048561381)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(-2.56328977099487+${C4pos})
variable C44 equal 0.5*(-2.56328977099487+8.54467955391184)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-9.02407530237183+${C5pos})
variable C54 equal 0.5*(-9.02407530237183+5.28387677197168)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-9.66470314801349+${C6pos})
variable C64 equal 0.5*(-9.66470314801349+7.80247302983709)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.6096
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.6096
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.166096 remap units box
Changing box ...
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.170796 -1.8606)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.1 | 108.8 | 110.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   273.71107     -31865.972     -9417.292       0              3290.3881    
       100   282.56083     -31853.826     -10711.947      3903.6056      3290.3881    
       200   330.37116     -31872.934     -1547.5546      6241.2611      3290.3881    
       300   315.39521     -31874.395      8715.8927      4032.8053      3290.3881    
       400   297.74093     -31889.519      2630.0322      3422.3441      3290.3881    
       500   283.05051     -31899.26      -7785.5727     -4997.1791      3290.3881    
       600   285.111       -31893.185     -10742.879     -1409.3619      3290.3881    
       700   306.6936      -31881.109     -218.10328      8290.2825      3290.3881    
       800   329.94773     -31890.027     -2159.4442      5153.9454      3290.3881    
       900   312.03638     -31885.243     -10658.152      7418.2077      3290.3881    
      1000   324.79723     -31907.636     -8864.8841      6676.5127      3290.3881    
      1100   302.64959     -31896.881      2923.9079     -237.214        3290.3881    
      1200   297.19491     -31888.435     -320.78816      2225.3598      3290.3881    
      1300   311.39353     -31887.997     -8522.6304      3767.9182      3290.3881    
      1400   324.23317     -31897.148      663.69274      524.51185      3290.3881    
      1500   277.88548     -31867.507      1583.8596      3486.3154      3290.3881    
      1600   302.5982      -31886.642      2653.1981      2104.1991      3290.3881    
      1700   305.69312     -31894.266     -718.74437      702.98009      3290.3881    
      1800   299.15152     -31908.953     -6523.2767      10055.516      3290.3881    
      1900   295.95174     -31915.486      936.31203     -1423.7895      3290.3881    
      2000   289.24772     -31907.037     -7091.4814      3992.055       3290.3881    
Loop time of 77.4545 on 8 procs for 2000 steps with 271 atoms

Performance: 1.115 ns/day, 21.515 hours/ns, 25.822 timesteps/s, 6.998 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 45.738     | 59.702     | 65.023     |  78.6 | 77.08
Bond    | 0.00069285 | 0.00084965 | 0.001024   |   0.0 |  0.00
Neigh   | 3.679      | 4.8363     | 5.2759     |  22.5 |  6.24
Comm    | 0.92804    | 6.2525     | 20.21      | 242.7 |  8.07
Output  | 0.0044598  | 0.0065464  | 0.0082091  |   1.9 |  0.01
Modify  | 6.1813     | 6.6213     | 7.7873     |  19.4 |  8.55
Other   |            | 0.03536    |            |       |  0.05

Nlocal:         33.875 ave          38 max          25 min
Histogram: 1 0 0 0 1 0 2 1 1 2
Nghost:         2781.5 ave        2832 max        2728 min
Histogram: 1 0 1 1 1 0 2 1 0 1
Neighs:        19553.2 ave       21889 max       14653 min
Histogram: 1 0 0 0 1 0 2 1 1 2

Total # of neighbors = 156426
Ave neighs/atom = 577.21771
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.1 | 108.8 | 111 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   289.24772     -31907.037     -7091.4777      0              3290.3881    
       100   278.02185     -31892.441      6018.3259      2677.9445      3290.3881    
       200   312.83315     -31890.666     -3545.8284     -958.02349      3290.3881    
       300   316.38361     -31889.12      -16243.586      685.53293      3290.3881    
       400   293.88785     -31879.133     -5268.9186      927.07778      3290.3881    
       500   309.21867     -31902.095      1804.5772      1052.4827      3290.3881    
       600   284.58324     -31892.241     -6917.0697      3089.4813      3290.3881    
       700   307.42912     -31907.922     -7912.5719      1413.4342      3290.3881    
       800   307.39924     -31895.885      1278.8594      8408.5421      3290.3881    
       900   347.45958     -31888.866      9509.1593      6153.0615      3290.3881    
      1000   325.31796     -31878.363      5104.9072      5309.2212      3290.3881    
      1100   316.36461     -31897.901     -8580.1391      562.28803      3290.3881    
      1200   294.65407     -31896.005      609.53622      6561.5339      3290.3881    
      1300   268.15993     -31884.348      782.52575      3804.3016      3290.3881    
      1400   299.457       -31896.512     -2234.5749      10816.052      3290.3881    
      1500   322.60298     -31888.107     -8503.0895      8976.5906      3290.3881    
      1600   293.68493     -31865.825     -7996.1772      1708.7012      3290.3881    
      1700   306.09688     -31892.843     -2891.6674      5282.4209      3290.3881    
      1800   293.17849     -31896.823      386.54477     -238.03956      3290.3881    
      1900   298.45314     -31901.96      -2366.9284     -185.31189      3290.3881    
      2000   286.07752     -31892.29      -5793.2686      3990.8197      3290.3881    
Loop time of 77.7223 on 8 procs for 2000 steps with 271 atoms

Performance: 1.112 ns/day, 21.590 hours/ns, 25.733 timesteps/s, 6.974 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.077     | 61.595     | 65.278     |  75.8 | 79.25
Bond    | 0.00068677 | 0.00085618 | 0.0010845  |   0.0 |  0.00
Neigh   | 3.7371     | 4.9785     | 5.2728     |  21.2 |  6.41
Comm    | 0.97843    | 4.6609     | 20.171     | 275.6 |  6.00
Output  | 0.00091634 | 0.0010945  | 0.0021078  |   1.2 |  0.00
Modify  | 6.1535     | 6.4498     | 7.7003     |  18.8 |  8.30
Other   |            | 0.03593    |            |       |  0.05

Nlocal:         33.875 ave          39 max          25 min
Histogram: 1 0 0 0 2 0 1 1 0 3
Nghost:        2769.25 ave        2812 max        2727 min
Histogram: 1 0 2 1 1 0 0 1 0 2
Neighs:        19570.6 ave       22428 max       14658 min
Histogram: 1 0 0 0 2 0 1 1 0 3

Total # of neighbors = 156565
Ave neighs/atom = 577.73063
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -28.8379123585133
variable C2neg equal ${d2}
variable C2neg equal -77.840807856028
variable C3neg equal ${d3}
variable C3neg equal -55.7174479070161
variable C4neg equal ${d4}
variable C4neg equal -30.3446039618047
variable C5neg equal ${d5}
variable C5neg equal -0.169024198803443
variable C6neg equal ${d6}
variable C6neg equal -1.49966137650597

# Reset box and simulation parameters
clear
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.6096
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.166096 remap units box
Changing box ...
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -0.838604 -1.8606)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107 | 108.6 | 110.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   273.71107     -31862.666     -7977.9299      0              3290.3881    
       100   289.05689     -31857.489     -9754.0223      1466.7117      3290.3881    
       200   306.86654     -31859.513     -8559.7844      5549.7539      3290.3881    
       300   312.67318     -31875.167      4566.482       5351.0372      3290.3881    
       400   299.40369     -31886.948      1724.6313     -1087.473       3290.3881    
       500   268.60235     -31882.467     -7914.6588      559.64151      3290.3881    
       600   283.96392     -31893.112     -16976.735     -3420.3467      3290.3881    
       700   293.97929     -31875.764     -10774.805      3705.2914      3290.3881    
       800   319.37779     -31884.26       2195.3472      2017.7997      3290.3881    
       900   302.84425     -31876.006     -6006.9718      8034.507       3290.3881    
      1000   305.91277     -31898.125      3950.6303      3225.6238      3290.3881    
      1100   300.47543     -31901.822      8534.3851      795.36054      3290.3881    
      1200   295.80327     -31892.424      107.49395      3538.9519      3290.3881    
      1300   307.81929     -31891.016      6624.3786      7884.3693      3290.3881    
      1400   286.48609     -31873.345     -16839.568      753.07214      3290.3881    
      1500   301.29488     -31878.694     -5080.0556      2034.5305      3290.3881    
      1600   303.56847     -31881.676     -4590.3459      1058.311       3290.3881    
      1700   297.02021     -31893.091     -386.22414      2767.1629      3290.3881    
      1800   284.49833     -31899.682     -3341.08        4945.9047      3290.3881    
      1900   296.13173     -31913.602     -4039.8588      583.78857      3290.3881    
      2000   302.60492     -31907.924     -8915.9153      1595.1143      3290.3881    
Loop time of 77.9999 on 8 procs for 2000 steps with 271 atoms

Performance: 1.108 ns/day, 21.667 hours/ns, 25.641 timesteps/s, 6.949 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.994     | 60.707     | 65.416     |  69.7 | 77.83
Bond    | 0.00069229 | 0.00084048 | 0.0010292  |   0.0 |  0.00
Neigh   | 3.7302     | 4.8565     | 5.2307     |  20.6 |  6.23
Comm    | 1.0494     | 5.7619     | 19.472     | 226.2 |  7.39
Output  | 0.0048328  | 0.0073594  | 0.009299   |   2.2 |  0.01
Modify  | 6.2558     | 6.6309     | 7.7648     |  17.8 |  8.50
Other   |            | 0.03533    |            |       |  0.05

Nlocal:         33.875 ave          39 max          23 min
Histogram: 1 0 0 0 0 1 3 0 0 3
Nghost:        2765.88 ave        2819 max        2706 min
Histogram: 1 0 0 2 0 1 2 1 0 1
Neighs:        19569.8 ave       22221 max       13494 min
Histogram: 1 0 0 0 0 1 1 2 0 3

Total # of neighbors = 156558
Ave neighs/atom = 577.7048
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107 | 108.6 | 110.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.60492     -31907.924     -8915.9531      0              3290.3881    
       100   302.31394     -31906.132     -5641.5269      133.28827      3290.3881    
       200   281.67138     -31898.687     -1069.8203      1732.1434      3290.3881    
       300   288.51832     -31916.316     -3037.2038     -1370.4118      3290.3881    
       400   276.56025     -31899.652      1612.0189      5792.8717      3290.3881    
       500   314.72673     -31903.125     -9728.4099      786.29524      3290.3881    
       600   319.76972     -31905.004     -2848.911       4223.6067      3290.3881    
       700   320.24793     -31915.382     -6558.1574      3276.442       3290.3881    
       800   285.25312     -31914.179     -9785.7952     -5061.3958      3290.3881    
       900   290.55248     -31919.177      2100.5159     -681.36129      3290.3881    
      1000   293.87927     -31910.143     -12300.706      2254.8042      3290.3881    
      1100   292.50462     -31898.223      4887.6678      206.94223      3290.3881    
      1200   322.14036     -31914.317     -13598.111     -6101.9179      3290.3881    
      1300   303.13519     -31897.524     -2476.456      -61.902542      3290.3881    
      1400   286.63889     -31903.816     -12152.137      2514.7478      3290.3881    
      1500   290.01199     -31924.471     -834.68194      2274.1327      3290.3881    
      1600   304.42805     -31928.808     -7870.4176      4957.4764      3290.3881    
      1700   309.71        -31911.623     -6997.8529      5794.5299      3290.3881    
      1800   312.37206     -31908.116     -3485.5145     -5216.7215      3290.3881    
      1900   286.92412     -31899.331     -7740.4701     -1615.5457      3290.3881    
      2000   292.6367      -31936.675     -15101.639      451.34625      3290.3881    
Loop time of 78.4691 on 8 procs for 2000 steps with 271 atoms

Performance: 1.101 ns/day, 21.797 hours/ns, 25.488 timesteps/s, 6.907 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.82      | 59.11      | 65.796     |  89.1 | 75.33
Bond    | 0.00068334 | 0.00084768 | 0.0010292  |   0.0 |  0.00
Neigh   | 3.7393     | 4.7319     | 5.1988     |  24.2 |  6.03
Comm    | 1.1721     | 7.8513     | 20.129     | 244.4 | 10.01
Output  | 0.00085358 | 0.0011982  | 0.0031833  |   2.2 |  0.00
Modify  | 6.2637     | 6.7399     | 7.747      |  20.5 |  8.59
Other   |            | 0.03391    |            |       |  0.04

Nlocal:         33.875 ave          38 max          26 min
Histogram: 1 0 0 0 1 1 1 0 2 2
Nghost:        2770.25 ave        2836 max        2710 min
Histogram: 1 0 1 2 0 1 1 1 0 1
Neighs:          19585 ave       21693 max       15230 min
Histogram: 1 0 0 0 1 0 2 0 2 2

Total # of neighbors = 156680
Ave neighs/atom = 578.15498
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 64.7016270078835
variable C2pos equal ${d2}
variable C2pos equal 71.1615556543851
variable C3pos equal ${d3}
variable C3pos equal 29.4675505846751
variable C4pos equal ${d4}
variable C4pos equal 11.6539017042436
variable C5pos equal ${d5}
variable C5pos equal 6.05929344148825
variable C6pos equal ${d6}
variable C6pos equal 18.8429515859359

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-28.8379123585133+${C1pos})
variable C15 equal 0.5*(-28.8379123585133+64.7016270078835)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-77.840807856028+${C2pos})
variable C25 equal 0.5*(-77.840807856028+71.1615556543851)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-55.7174479070161+${C3pos})
variable C35 equal 0.5*(-55.7174479070161+29.4675505846751)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-30.3446039618047+${C4pos})
variable C45 equal 0.5*(-30.3446039618047+11.6539017042436)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(-0.169024198803443+${C5pos})
variable C55 equal 0.5*(-0.169024198803443+6.05929344148825)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-1.49966137650597+${C6pos})
variable C65 equal 0.5*(-1.49966137650597+18.8429515859359)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.4318

# Reset box and simulation parameters
clear
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4318
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.134318 remap units box
Changing box ...
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.331518 -1.0047 -1.8606)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.2 | 108.9 | 110.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   273.71107     -31864.287     -6620.4332      0              3290.3881    
       100   287.64105     -31857.001     -13285.829      2353.899       3290.3881    
       200   320.4274      -31867.096     -11387.802      5889.9425      3290.3881    
       300   325.42471     -31885.515      6973.9738      2609.4204      3290.3881    
       400   304.30931     -31894.256     -7291.8308     -649.45506      3290.3881    
       500   287.38124     -31899.244     -4716.6324     -2520.9387      3290.3881    
       600   260.58239     -31869.364      2284.7152     -251.88069      3290.3881    
       700   312.21916     -31884.997      355.23374      7093.9783      3290.3881    
       800   307.20502     -31874.659      5218.7219      369.64767      3290.3881    
       900   282.00723     -31861.847     -1847.8055      8492.6174      3290.3881    
      1000   301.05439     -31888.162     -9962.787       12101.81       3290.3881    
      1100   277.54429     -31874.98       2678.1669     -872.90395      3290.3881    
      1200   308.56768     -31895.898     -7341.9449      631.27531      3290.3881    
      1300   331.17726     -31906.575      1721.5025      2750.0318      3290.3881    
      1400   312.81261     -31899.756     -18757.479     -706.92824      3290.3881    
      1500   299.41429     -31906.568      197.92514      3505.8377      3290.3881    
      1600   290.17868     -31909.564      3032.7386      4271.8544      3290.3881    
      1700   285.1685      -31901.013      9488.6421     -61.996053      3290.3881    
      1800   317.02945     -31906.291     -1669.5579     -158.44835      3290.3881    
      1900   296.29935     -31885.759     -9519.9153      2592.1052      3290.3881    
      2000   293.50879     -31900.435      749.96521      5806.5537      3290.3881    
Loop time of 79.2502 on 8 procs for 2000 steps with 271 atoms

Performance: 1.090 ns/day, 22.014 hours/ns, 25.237 timesteps/s, 6.839 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 46.342     | 62.226     | 65.865     |  77.5 | 78.52
Bond    | 0.00066743 | 0.00084658 | 0.0010476  |   0.0 |  0.00
Neigh   | 3.8519     | 5.0191     | 5.309      |  19.9 |  6.33
Comm    | 1.6089     | 5.2448     | 21.136     | 267.0 |  6.62
Output  | 0.0050719  | 0.0074673  | 0.0093589  |   2.1 |  0.01
Modify  | 6.4202     | 6.7159     | 7.8801     |  17.2 |  8.47
Other   |            | 0.03581    |            |       |  0.05

Nlocal:         33.875 ave          39 max          25 min
Histogram: 1 0 1 0 0 0 1 2 2 1
Nghost:         2782.5 ave        2823 max        2750 min
Histogram: 2 0 1 0 2 1 0 0 1 1
Neighs:        19555.8 ave       22419 max       14704 min
Histogram: 1 0 1 0 0 0 1 2 2 1

Total # of neighbors = 156446
Ave neighs/atom = 577.29151
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 107.2 | 108.9 | 111 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   293.50879     -31900.435      749.96102      0              3290.3881    
       100   305.01757     -31905.39      -1883.9268      7019.4433      3290.3881    
       200   318.84887     -31909.978     -14737.677     -739.29206      3290.3881    
       300   304.68079     -31905.815     -1691.5943      610.71895      3290.3881    
       400   285.77123     -31916.517      160.64012      1917.2844      3290.3881    
       500   287.83843     -31923.502     -11683.676      3286.6614      3290.3881    
       600   296.77299     -31912.545     -11501.893      4825.6707      3290.3881    
       700   304.6628      -31901.681      6749.9878     -2021.6937      3290.3881    
       800   293.93947     -31889.324     -1477.4838     -3667.6491      3290.3881    
       900   306.07898     -31903.998     -6401.183      -779.22716      3290.3881    
      1000   319.82851     -31927.343      1854.5569      7142.6148      3290.3881    
      1100   292.84617     -31918.562     -4259.9199      5330.6934      3290.3881    
      1200   294.56093     -31924.074      5944.6451      1141.1798      3290.3881    
      1300   274.14484     -31905.379      5269.1622      1271.4867      3290.3881    
      1400   300.8672      -31907.053     -6356.6878      12772.4        3290.3881    
      1500   315.85353     -31903.539      2070.1065      6065.27        3290.3881    
      1600   297.39378     -31900.512      144.73031     -2407.6886      3290.3881    
      1700   292.16965     -31919.576     -15050.929     -714.06188      3290.3881    
      1800   276.67174     -31911.479      7435.2289      1473.1306      3290.3881    
      1900   297.98534     -31916.802     -4570.4006      2440.387       3290.3881    
      2000   313.15838     -31901.749     -442.22395      3575.3109      3290.3881    
Loop time of 77.5795 on 8 procs for 2000 steps with 271 atoms

Performance: 1.114 ns/day, 21.550 hours/ns, 25.780 timesteps/s, 6.986 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 55.291     | 60.078     | 64.105     |  37.8 | 77.44
Bond    | 0.00063018 | 0.00080136 | 0.00096406 |   0.0 |  0.00
Neigh   | 4.6913     | 4.9275     | 5.3243     |  10.5 |  6.35
Comm    | 1.7751     | 5.804      | 10.602     | 121.6 |  7.48
Output  | 0.00091638 | 0.0010191  | 0.0015759  |   0.7 |  0.00
Modify  | 6.3218     | 6.7318     | 6.9767     |   9.1 |  8.68
Other   |            | 0.03603    |            |       |  0.05

Nlocal:         33.875 ave          41 max          27 min
Histogram: 1 0 1 1 0 2 2 0 0 1
Nghost:        2779.38 ave        2813 max        2745 min
Histogram: 1 0 2 0 1 1 1 0 0 2
Neighs:        19567.5 ave       23393 max       15813 min
Histogram: 1 1 0 1 0 2 2 0 0 1

Total # of neighbors = 156540
Ave neighs/atom = 577.63838
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -33.0480551133149
variable C2neg equal ${d2}
variable C2neg equal -40.6942232495207
variable C3neg equal ${d3}
variable C3neg equal 17.0585630795565
variable C4neg equal ${d4}
variable C4neg equal -16.9615312441859
variable C5neg equal ${d5}
variable C5neg equal -17.5262720333003
variable C6neg equal ${d6}
variable C6neg equal 1.31832008771951

# Reset box and simulation parameters
clear
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.1972 -1.0047 -1.8606)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  271 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4318
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.134318 remap units box
Changing box ...
  triclinic box = (0 0 0) to (14.7487 13.4318 16.6096) with tilt (-6.062882 -1.0047 -1.8606)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 106.8 | 108.3 | 110.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   273.71107     -31865.734     -11005.375      0              3290.3881    
       100   283.97948     -31855.163     -10082.87       2724.0342      3290.3881    
       200   315.40763     -31863.671     -5794.766       4131.9177      3290.3881    
       300   313.4677      -31872.073      3002.1462      4972.007       3290.3881    
       400   281.45939     -31871.933     -5701.1562      4504.3306      3290.3881    
       500   274.52095     -31886.576     -9746.3317     -1632.723       3290.3881    
       600   276.0621      -31884.745     -2450.1086      2131.924       3290.3881    
       700   305.38002     -31886.989     -9033.0954      5019.8535      3290.3881    
       800   310.68734     -31881.584     -10532.527      1456.1595      3290.3881    
       900   322.87451     -31893.378     -8111.6419      6583.9376      3290.3881    
      1000   280.41742     -31871.674     -3659.381       5708.068       3290.3881    
      1100   297.87164     -31888.536      5971.1535      4507.1341      3290.3881    
      1200   302.41279     -31889.458     -193.29181      4783.7111      3290.3881    
      1300   314.88779     -31890.41      -10086.832      961.64362      3290.3881    
      1400   321.74166     -31882.11      -18979.048      187.6629       3290.3881    
      1500   304.56765     -31864.188      535.68603      7306.889       3290.3881    
      1600   295.68478     -31869.914     -8980.8697      4050.1353      3290.3881    
      1700   295.21686     -31885.962     -14437.333     -966.94418      3290.3881    
      1800   285.25933     -31892.718     -7864.2225      4513.71        3290.3881    
      1900   281.18158     -31892.845      4750.0001      2089.9359      3290.3881    
      2000   313.08368     -31899.877      1330.6061      11241.132      3290.3881    
Loop time of 71.6586 on 8 procs for 2000 steps with 271 atoms

Performance: 1.206 ns/day, 19.905 hours/ns, 27.910 timesteps/s, 7.564 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 39.288     | 47.641     | 59.668     | 124.1 | 66.48
Bond    | 0.00056691 | 0.00073363 | 0.00086399 |   0.0 |  0.00
Neigh   | 3.5628     | 4.1871     | 5.1489     |  35.8 |  5.84
Comm    | 0.81513    | 12.848     | 21.197     | 239.0 | 17.93
Output  | 0.0034184  | 0.0048057  | 0.0060301  |   1.5 |  0.01
Modify  | 5.9791     | 6.9457     | 7.5826     |  28.0 |  9.69
Other   |            | 0.03074    |            |       |  0.04

Nlocal:         33.875 ave          37 max          25 min
Histogram: 1 0 0 0 0 1 0 1 1 4
Nghost:        2789.62 ave        2838 max        2751 min
Histogram: 2 1 0 0 3 0 0 0 1 1
Neighs:          19565 ave       21079 max       14649 min
Histogram: 1 0 0 0 0 0 1 1 1 4

Total # of neighbors = 156520
Ave neighs/atom = 577.56458
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 106.8 | 108.3 | 110.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   313.08368     -31899.877      1330.5967      0              3290.3881    
       100   312.28256     -31909.574     -15397.023      70.340426      3290.3881    
       200   281.02039     -31909.42       874.6355       2305.4075      3290.3881    
       300   281.80998     -31914.515     -9294.2386      4309.8155      3290.3881    
       400   293.72475     -31892.414     -10120.455      279.7429       3290.3881    
       500   307.30847     -31897.034     -4331.3985      4781.6984      3290.3881    
       600   307.63873     -31901.072     -711.61652      194.37147      3290.3881    
       700   289.31637     -31888.246      3501.8061      4951.4343      3290.3881    
       800   303.04122     -31892.473      8545.4575     -1405.3932      3290.3881    
       900   315.61305     -31885.231     -397.80652     -1996.3023      3290.3881    
      1000   326.29764     -31886.432     -2087.3489      560.84784      3290.3881    
      1100   309.0569      -31899.247     -5637.4313     -4903.1845      3290.3881    
      1200   287.48285     -31899.819     -4359.7365     -1475.3654      3290.3881    
      1300   297.8932      -31902.846     -2361.8714     -2311.0672      3290.3881    
      1400   305.58384     -31894.103      9778.5358      7470.3721      3290.3881    
      1500   286.82077     -31856.224     -11441.868     -425.76831      3290.3881    
      1600   336.26973     -31873.398     -16421.614      1889.7247      3290.3881    
      1700   302.8423      -31870.206      761.46992      1599.1731      3290.3881    
      1800   307.97621     -31892.588     -17768.794     -3406.8457      3290.3881    
      1900   320.18222     -31915.674      5700.6377     -140.056        3290.3881    
      2000   301.82264     -31909.451     -6026.4553      1228.2013      3290.3881    
Loop time of 67.7423 on 8 procs for 2000 steps with 271 atoms

Performance: 1.275 ns/day, 18.817 hours/ns, 29.524 timesteps/s, 8.001 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 38.085     | 43.93      | 55.433     |  89.3 | 64.85
Bond    | 0.00052937 | 0.00070213 | 0.00082414 |   0.0 |  0.00
Neigh   | 3.5369     | 3.9741     | 5.0934     |  26.9 |  5.87
Comm    | 1.7267     | 13.236     | 19.077     | 162.8 | 19.54
Output  | 0.00087856 | 0.00099026 | 0.0013087  |   0.0 |  0.00
Modify  | 5.4555     | 6.571      | 7.0005     |  20.8 |  9.70
Other   |            | 0.02922    |            |       |  0.04

Nlocal:         33.875 ave          39 max          23 min
Histogram: 1 0 0 0 0 1 2 1 2 1
Nghost:        2757.75 ave        2794 max        2716 min
Histogram: 2 0 0 0 1 1 2 0 0 2
Neighs:        19578.9 ave       22433 max       13439 min
Histogram: 1 0 0 0 0 1 1 2 2 1

Total # of neighbors = 156631
Ave neighs/atom = 577.97417
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 56.8301435456659
variable C2pos equal ${d2}
variable C2pos equal 35.2094716382422
variable C3pos equal ${d3}
variable C3pos equal 66.1943845177941
variable C4pos equal ${d4}
variable C4pos equal 20.2553351340111
variable C5pos equal ${d5}
variable C5pos equal 7.74113285562602
variable C6pos equal ${d6}
variable C6pos equal 14.0181001357539

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-33.0480551133149+${C1pos})
variable C16 equal 0.5*(-33.0480551133149+56.8301435456659)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-40.6942232495207+${C2pos})
variable C26 equal 0.5*(-40.6942232495207+35.2094716382422)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(17.0585630795565+${C3pos})
variable C36 equal 0.5*(17.0585630795565+66.1943845177941)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-16.9615312441859+${C4pos})
variable C46 equal 0.5*(-16.9615312441859+20.2553351340111)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(-17.5262720333003+${C5pos})
variable C56 equal 0.5*(-17.5262720333003+7.74113285562602)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(1.31832008771951+${C6pos})
variable C66 equal 0.5*(1.31832008771951+14.0181001357539)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 4.63764068314825
variable C22all equal ${C22}
variable C22all equal 9.07753369581724
variable C33all equal ${C33}
variable C33all equal 32.2416752588015

variable C44all equal ${C44}
variable C44all equal 2.99069489145848
variable C55all equal ${C55}
variable C55all equal 2.9451346213424
variable C66all equal ${C66}
variable C66all equal 7.6682101117367

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(11.6450002554666+${C21})
variable C12all equal 0.5*(11.6450002554666+-7.7980833907558)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(23.5874137519735+${C31})
variable C13all equal 0.5*(23.5874137519735+0.803037311304902)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(-7.76177150684755+${C32})
variable C23all equal 0.5*(-7.76177150684755+-12.3466886024476)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-9.09497447450205+${C41})
variable C14all equal 0.5*(-9.09497447450205+-1.2109384773583)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(17.9318573246851+${C51})
variable C15all equal 0.5*(17.9318573246851+-8.20951384233854)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(11.8910442161755+${C61})
variable C16all equal 0.5*(11.8910442161755+-6.87836493719557)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(12.4826495769891+${C42})
variable C24all equal 0.5*(12.4826495769891+8.1974521472396)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-3.33962610082145+${C52})
variable C25all equal 0.5*(-3.33962610082145+-4.43514222774758)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-2.74237580563925+${C62})
variable C26all equal 0.5*(-2.74237580563925+-1.00718980515433)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(20.6316931236437+${C43})
variable C34all equal 0.5*(20.6316931236437+0.478824692866949)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-13.1249486611705+${C53})
variable C35all equal 0.5*(-13.1249486611705+-12.737233358349)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(41.6264737986753+${C63})
variable C36all equal 0.5*(41.6264737986753+-2.4754074672366)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-9.34535112878055+${C54})
variable C45all equal 0.5*(-9.34535112878055+-1.87009926520008)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(1.6469019449126+${C64})
variable C46all equal 0.5*(1.6469019449126+-0.9311150590882)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-4.89256958883714+${C65})
variable C56all equal 0.5*(-4.89256958883714+8.67164510471497)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:32:14
