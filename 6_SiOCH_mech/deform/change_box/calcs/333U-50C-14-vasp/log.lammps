LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 30*${nthermo}       # steps of equilibration run 20
variable nequil equal 30*100       
variable nrun equal 30*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 30*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-14-vasp
read_data       ${structure}.data
read_data       333U-50C-14-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.006 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 6.01506e-05 on 8 procs for 1 steps with 371 atoms

53.4% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.117e-06  | 1.7462e-06 | 1.956e-06  |   0.0 |  2.90
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 3.98e-06   | 3.9977e-06 | 4.051e-06  |   0.0 |  6.65
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 5.441e-05  |            |       | 90.45

Nlocal:         46.375 ave          56 max          42 min
Histogram: 5 0 0 0 0 1 0 1 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-14-vasp_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 3000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -4.92 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 131.1 | 132.2 | 133.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -41361.517      76779.476      0              1.6093426      4136.956     
       100   757.58458     -42308.039      1090.5185      1375.8034      1.6093426      4136.956     
       200   553.99127     -42549.841     -17805.853     -3266.8014      1.6093426      4136.956     
       300   453.74933     -42772.294      5503.4373     -1141.5722      1.6093426      4136.956     
       400   354.65638     -42885.872      12105.459     -1231.6911      1.6093426      4136.956     
       500   316.46261     -42992.252      6164.0458     -2910.6779      1.6093426      4136.956     
       600   257.76594     -43014.883     -1468.1227     -5373.1796      1.6093426      4136.956     
       700   285.78993     -43075.406      12540.187     -3139.3882      1.6093426      4136.956     
       800   293.06882     -43069.928      43.500479     -1277.8527      1.6093426      4136.956     
       900   314.35526     -43073.243     -8966.0254     -8374.0814      1.6093426      4136.956     
      1000   302.72766     -43060.917     -10009.714     -8162.8348      1.6093426      4136.956     
      1100   291.03397     -43057.309     -8107.8021     -611.4311       1.6093426      4136.956     
      1200   308.98482     -43094.602     -11190.291     -4778.1564      1.6093426      4136.956     
      1300   274.45652     -43076.207     -11703.112     -9127.3529      1.6093426      4136.956     
      1400   290.57795     -43106.025     -8194.2558     -8315.5603      1.6093426      4136.956     
      1500   286.27269     -43095.346     -4892.0128     -12527.133      1.6093426      4136.956     
      1600   319.66233     -43115.195     -14919.606     -6297.6191      1.6093426      4136.956     
      1700   310.57321     -43106.988     -17243.468     -9304.987       1.6093426      4136.956     
      1800   295.32746     -43111.903     -2235.1341     -8155.0264      1.6093426      4136.956     
      1900   294.9444      -43128.626     -9221.1634     -7997.7122      1.6093426      4136.956     
      2000   294.96546     -43127.365     -8171.9537     -10515.274      1.6093426      4136.956     
      2100   310.67165     -43136.043     -4130.0998     -6375.6825      1.6093426      4136.956     
      2200   307.30265     -43118.324     -5185.4856     -5849.6401      1.6093426      4136.956     
      2300   304.41343     -43112.016      4255.1155     -4972.0464      1.6093426      4136.956     
      2400   314.71786     -43138.327     -2209.6679     -6016.0785      1.6093426      4136.956     
      2500   296.63935     -43138.771     -3433.9164     -6184.9869      1.6093426      4136.956     
      2600   310.66499     -43161.713     -4319.6476     -1629.6278      1.6093426      4136.956     
      2700   288.84079     -43130.437      10026.637     -3410.8826      1.6093426      4136.956     
      2800   299.2351      -43120.713      3977.0801     -3821.8049      1.6093426      4136.956     
      2900   320.98579     -43130.754     -12095.562     -4913.1712      1.6093426      4136.956     
      3000   295.85779     -43115.536     -8132.5767     -8448.8028      1.6093426      4136.956     
Loop time of 150.653 on 8 procs for 3000 steps with 371 atoms

Performance: 0.860 ns/day, 27.899 hours/ns, 19.913 timesteps/s, 7.388 katom-step/s
98.7% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 122.97     | 125.23     | 128.03     |  13.9 | 83.12
Bond    | 0.0082328  | 0.0092751  | 0.0098739  |   0.6 |  0.01
Neigh   | 8.5243     | 8.6472     | 8.8204     |   4.0 |  5.74
Comm    | 1.5217     | 4.328      | 6.591      |  75.1 |  2.87
Output  | 0.0018088  | 0.0020045  | 0.0029384  |   0.8 |  0.00
Modify  | 12.19      | 12.358     | 12.484     |   3.4 |  8.20
Other   |            | 0.0796     |            |       |  0.05

Nlocal:         46.375 ave          55 max          41 min
Histogram: 1 3 1 0 0 0 1 1 0 1
Nghost:        3365.38 ave        3411 max        3331 min
Histogram: 2 0 0 2 2 0 0 0 1 1
Neighs:        28993.9 ave       34129 max       25614 min
Histogram: 1 3 0 1 0 0 1 1 0 1

Total # of neighbors = 231951
Ave neighs/atom = 625.20485
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-14-vasp_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 17.3186
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 12.8149
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 18.6403

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--8448.80279035795)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--8448.80279035795)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--5056.57264686324)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--5056.57264686324)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--8124.85841178726)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--8124.85841178726)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--400.764304411957)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--400.764304411957)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-2672.37180110607)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-2672.37180110607)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--1917.44318293211)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--1917.44318293211)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 17.3186
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.3186
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.173186 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.173186 xy delta 0.08851 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.173186 xy delta 0.08851 xz delta -0.004589 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.145414 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.145414 12.8149 18.6403) with tilt (-8.76249 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.145414 12.8149 18.6403) with tilt (-8.76249 0.454311 0.2054)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.5 | 131.9 | 133.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   295.85779     -43101.945      42847.799      0              4095.5864    
       100   283.27942     -43109.984     -5801.7944     -1241.1662      4095.5864    
       200   282.22124     -43131.918     -4652.6862     -2540.7504      4095.5864    
       300   292.86348     -43153.231     -10138.792     -8222.2184      4095.5864    
       400   296.06372     -43149.09      -8940.4816     -6085.6752      4095.5864    
       500   303.5789      -43141.831     -14526.182     -1844.5395      4095.5864    
       600   299.38284     -43129.931     -10703.4       -4484.5007      4095.5864    
       700   308.6862      -43146.284      2412.1139     -1421.3722      4095.5864    
       800   294.50422     -43146.028     -3096.04       -2509.9785      4095.5864    
       900   296.02838     -43159.532     -1360.0579     -3606.3955      4095.5864    
      1000   295.08261     -43148.731     -3129.7845     -1584.2367      4095.5864    
      1100   331.50994     -43175.665     -3540.7274     -2877.677       4095.5864    
      1200   303.38281     -43145.59      -9336.3162     -6666.3653      4095.5864    
      1300   292.80161     -43139.73      -7728.0963     -5968.4332      4095.5864    
      1400   311.7423      -43166.549      12225.881     -862.13642      4095.5864    
      1500   280.66038     -43143.161     -270.97454     -2803.0041      4095.5864    
      1600   305.78553     -43171.879     -4085.3392      211.1509       4095.5864    
      1700   319.25066     -43174.433      7629.0605     -3618.0479      4095.5864    
      1800   303.87761     -43153.737      7628.0134     -2548.0914      4095.5864    
      1900   303.84141     -43161.588     -3781.9766      2027.0709      4095.5864    
      2000   290.6082      -43166.55      -3240.2718      77.879248      4095.5864    
      2100   283.85986     -43168.855      9803.3912      868.82367      4095.5864    
      2200   297.25148     -43168.239      2541.8587     -838.98792      4095.5864    
      2300   311.64414     -43152.797     -2805.162      -4255.7587      4095.5864    
      2400   300.78822     -43134.206     -12931.524     -4637.2693      4095.5864    
      2500   306.79961     -43157.482     -9762.312      -4896.4296      4095.5864    
      2600   281.64136     -43168.832     -10243.665     -3712.4969      4095.5864    
      2700   283.76517     -43168.195     -13431.452     -3476.5623      4095.5864    
      2800   294.5738      -43162.44       2181.5444      832.71425      4095.5864    
      2900   300.46823     -43145.877     -10242.676     -7934.9655      4095.5864    
      3000   324.64811     -43161.956     -6593.1024     -9720.9124      4095.5864    
Loop time of 154.067 on 8 procs for 3000 steps with 371 atoms

Performance: 0.841 ns/day, 28.531 hours/ns, 19.472 timesteps/s, 7.224 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 106.79     | 125.62     | 131.52     |  65.9 | 81.54
Bond    | 0.0083393  | 0.0091909  | 0.009677   |   0.5 |  0.01
Neigh   | 7.2836     | 8.6047     | 8.9722     |  17.5 |  5.59
Comm    | 1.4356     | 7.3314     | 26.167     | 272.8 |  4.76
Output  | 0.0070466  | 0.0088351  | 0.010073   |   1.1 |  0.01
Modify  | 12.039     | 12.412     | 13.737     |  14.6 |  8.06
Other   |            | 0.07661    |            |       |  0.05

Nlocal:         46.375 ave          52 max          42 min
Histogram: 2 0 3 0 0 0 0 0 0 3
Nghost:        3416.62 ave        3443 max        3387 min
Histogram: 2 0 0 0 0 3 1 0 0 2
Neighs:          29308 ave       32686 max       26616 min
Histogram: 2 1 2 0 0 0 0 0 0 3

Total # of neighbors = 234464
Ave neighs/atom = 631.97844
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.4 | 131.9 | 133.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   324.64811     -43161.956     -6593.0775      0              4095.5864    
       100   290.61125     -43145.159     -6652.2465      1484.5804      4095.5864    
       200   298.84444     -43172.733     -5033.8439     -4515.181       4095.5864    
       300   310.98866     -43187.061      2657.9807     -3254.9732      4095.5864    
       400   301.88599     -43181.069     -6251.4534     -3582.0799      4095.5864    
       500   314.55682     -43191.944      5707.3101     -622.43373      4095.5864    
       600   314.36764     -43163.035      1234.1634     -338.91664      4095.5864    
       700   326.68186     -43156.241      2649.3583     -4518.8769      4095.5864    
       800   315.04664     -43167.951     -13813.44      -4154.5219      4095.5864    
       900   309.74671     -43186.992     -9200.7772     -100.34955      4095.5864    
      1000   299.85132     -43184.578      616.03749     -593.77462      4095.5864    
      1100   295.54178     -43180.736      6387.5193      4111.7633      4095.5864    
      1200   303.25266     -43161.746     -8215.118      -6114.6882      4095.5864    
      1300   296.89324     -43144.416     -6010.8653     -2176.206       4095.5864    
      1400   296.73165     -43159.247      1370.3416     -648.97058      4095.5864    
      1500   289.49322     -43161.666     -7158.8149      3654.4037      4095.5864    
      1600   295.04628     -43167.327     -1404.5879      1442.9962      4095.5864    
      1700   297.79313     -43166.679     -7859.729       474.37738      4095.5864    
      1800   311.73534     -43178.401      1246.7207      1143.0393      4095.5864    
      1900   297.9276      -43170.134      13709.905     -3866.2368      4095.5864    
      2000   297.73311     -43177.885      2358.2322      85.119042      4095.5864    
      2100   280.12855     -43163.807     -14324.019     -4542.9619      4095.5864    
      2200   296.30736     -43171.98      -5888.5736     -1957.6338      4095.5864    
      2300   303.23474     -43162.071     -230.90178      8.0321161      4095.5864    
      2400   331.32543     -43178.695     -1611.4393      69.475317      4095.5864    
      2500   314.80405     -43175.541     -14878.044     -1932.6563      4095.5864    
      2600   291.69443     -43183.685      13949.26       286.12148      4095.5864    
      2700   297.44687     -43189.556      7578.0278     -2284.2743      4095.5864    
      2800   317.40229     -43195.166     -7603.8018     -1536.1905      4095.5864    
      2900   321.49008     -43189.014     -781.07295     -1309.1484      4095.5864    
      3000   324.36846     -43158.163      5372.7264     -1481.3402      4095.5864    
Loop time of 154.322 on 8 procs for 3000 steps with 371 atoms

Performance: 0.840 ns/day, 28.578 hours/ns, 19.440 timesteps/s, 7.212 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 126.29     | 128.81     | 131.69     |  14.5 | 83.47
Bond    | 0.0086252  | 0.0093939  | 0.009989   |   0.5 |  0.01
Neigh   | 8.5589     | 8.7539     | 8.8941     |   3.5 |  5.67
Comm    | 1.555      | 4.4349     | 6.949      |  78.2 |  2.87
Output  | 0.0014345  | 0.0016832  | 0.0031847  |   1.4 |  0.00
Modify  | 12.092     | 12.238     | 12.442     |   3.1 |  7.93
Other   |            | 0.07894    |            |       |  0.05

Nlocal:         46.375 ave          56 max          40 min
Histogram: 1 1 0 4 0 0 1 0 0 1
Nghost:           3392 ave        3422 max        3358 min
Histogram: 1 0 2 1 0 0 0 1 2 1
Neighs:          29307 ave       34906 max       25620 min
Histogram: 2 0 0 4 0 0 1 0 0 1

Total # of neighbors = 234456
Ave neighs/atom = 631.95687
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 70.5978152003037
variable C2neg equal ${d2}
variable C2neg equal 20.3179621230655
variable C3neg equal ${d3}
variable C3neg equal 6.80321371224134
variable C4neg equal ${d4}
variable C4neg equal 4.29823798404994
variable C5neg equal ${d5}
variable C5neg equal 10.9410780337075
variable C6neg equal ${d6}
variable C6neg equal -6.95187154246916

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.3186
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.173186 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.173186 xy delta -0.08851 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.173186 xy delta -0.08851 xz delta 0.004589 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.491786 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.491786 12.8149 18.6403) with tilt (-8.93951 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.491786 12.8149 18.6403) with tilt (-8.93951 0.463489 0.2054)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.3 | 129.9 | 131.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   295.85779     -43087.37      -53691.198      0              4178.3256    
       100   292.08163     -43107.813     -6929.8657     -9091.5678      4178.3256    
       200   294.26322     -43138.478     -2205.1142     -10443.813      4178.3256    
       300   282.09899     -43133.191     -13640.798     -13430.567      4178.3256    
       400   293.22285     -43132.018      2842.7664     -7360.9637      4178.3256    
       500   302.90446     -43120.224     -5738.0736     -7377.3048      4178.3256    
       600   323.50264     -43132.472     -8619.7832     -9612.1675      4178.3256    
       700   309.00113     -43129.674     -5493.7282     -7165.3288      4178.3256    
       800   295.27612     -43144.752     -5555.5261     -6702.2169      4178.3256    
       900   291.96378     -43156.688      5963.25       -5974.577       4178.3256    
      1000   297.8112      -43158.398      3211.7803     -10913.182      4178.3256    
      1100   305.57918     -43149.228     -2533.4138     -4642.2085      4178.3256    
      1200   306.16535     -43139.959     -3991.3858     -10546.101      4178.3256    
      1300   312.36396     -43146.299     -11085.83      -13311.995      4178.3256    
      1400   301.68091     -43137.843     -3612.7256     -5786.1186      4178.3256    
      1500   294.42917     -43139.255      28.178614     -6407.1007      4178.3256    
      1600   278.84671     -43136.166     -6400.888      -10314.072      4178.3256    
      1700   281.58808     -43138.288     -2114.8442     -10176.107      4178.3256    
      1800   308.3777      -43163.799      4132.3385     -9772.0783      4178.3256    
      1900   314.14402     -43166.734     -5002.2966     -11288.882      4178.3256    
      2000   277.69022     -43142.051      3561.5418     -9386.0999      4178.3256    
      2100   286.11434     -43153.153     -5812.2465     -7239.2419      4178.3256    
      2200   291.88943     -43129.429     -10297.63      -6489.8523      4178.3256    
      2300   331.33595     -43152.858     -7561.9939     -3052.3404      4178.3256    
      2400   280.73117     -43105.894     -3384.9517     -7312.4906      4178.3256    
      2500   301.83745     -43131.628     -11116.423     -7693.3033      4178.3256    
      2600   287.95464     -43124.686     -7164.9932     -9540.6461      4178.3256    
      2700   299.87696     -43159.391     -4162.495      -6960.5381      4178.3256    
      2800   288.18806     -43162.766     -1695.5994     -2643.314       4178.3256    
      2900   308.14492     -43165.555      5619.4763     -8068.9436      4178.3256    
      3000   305.10992     -43140.578     -6304.2488     -7540.2175      4178.3256    
Loop time of 151.356 on 8 procs for 3000 steps with 371 atoms

Performance: 0.856 ns/day, 28.029 hours/ns, 19.821 timesteps/s, 7.354 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 107.66     | 122.75     | 128.1      |  58.8 | 81.10
Bond    | 0.0081347  | 0.0092475  | 0.0098457  |   0.6 |  0.01
Neigh   | 7.4896     | 8.574      | 9.1101     |  16.1 |  5.66
Comm    | 1.8551     | 7.1802     | 22.259     | 242.6 |  4.74
Output  | 0.0072902  | 0.0091119  | 0.010288   |   1.1 |  0.01
Modify  | 12.186     | 12.751     | 13.861     |  13.7 |  8.42
Other   |            | 0.07909    |            |       |  0.05

Nlocal:         46.375 ave          53 max          39 min
Histogram: 1 1 1 1 0 0 0 2 1 1
Nghost:           3368 ave        3422 max        3341 min
Histogram: 2 1 2 0 1 1 0 0 0 1
Neighs:        28688.5 ave       32455 max       24197 min
Histogram: 1 1 0 2 0 0 0 1 2 1

Total # of neighbors = 229508
Ave neighs/atom = 618.61995
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.4 | 130 | 131.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   305.10992     -43140.578     -6304.3211      0              4178.3256    
       100   298.15938     -43142.268     -7725.3131     -8040.2094      4178.3256    
       200   282.59694     -43158.367     -13416.926     -11547.296      4178.3256    
       300   291.46499     -43170.923     -10134.302     -7969.1398      4178.3256    
       400   295.65081     -43164.215     -7084.3262     -12490.497      4178.3256    
       500   289.71604     -43142.002      3887.3617     -10021.831      4178.3256    
       600   311.86708     -43156.972     -7691.2648     -10282.765      4178.3256    
       700   288.67315     -43138.257      3622.5489     -8979.9389      4178.3256    
       800   279.42672     -43165.306     -4203.5887     -2515.2472      4178.3256    
       900   289.85586     -43189.275     -11745.6       -5487.8499      4178.3256    
      1000   304.68634     -43183.608      5836.3344     -7618.2728      4178.3256    
      1100   303.00796     -43166.475     -15184.68      -10104.507      4178.3256    
      1200   291.10715     -43152.495     -5320.7429     -6926.8899      4178.3256    
      1300   321.94039     -43174.414     -16757.423     -7167.7129      4178.3256    
      1400   332.3741      -43163.317     -10208.324     -8446.0901      4178.3256    
      1500   313.82122     -43147.043     -5532.2503     -9596.5511      4178.3256    
      1600   279.78187     -43147.578     -11712.927     -7577.2378      4178.3256    
      1700   285.29965     -43160.075     -12940.252     -11537.197      4178.3256    
      1800   286.97972     -43143.181     -6411.867      -11246.443      4178.3256    
      1900   307.37092     -43147.994     -25.986463     -10027.552      4178.3256    
      2000   306.59571     -43149.419     -15609.139     -9888.5721      4178.3256    
      2100   290.63531     -43156.114     -2619.8167     -6772.7715      4178.3256    
      2200   292.51711     -43202.866     -9216.8336     -7351.6448      4178.3256    
      2300   276.62712     -43188.297     -5892.7906     -7740.159       4178.3256    
      2400   293.08055     -43173.769     -16263.047     -5373.734       4178.3256    
      2500   289.92411     -43142.071     -11046.4       -10649.823      4178.3256    
      2600   287.59892     -43121.94      -10451.018     -9510.9619      4178.3256    
      2700   321.20158     -43141.71      -14021.385     -3279.047       4178.3256    
      2800   307.99985     -43139.383     -6128.7914     -6956.1839      4178.3256    
      2900   285.65352     -43145.941     -2325.8362     -7693.2956      4178.3256    
      3000   295.96649     -43157.495     -5280.2633     -9358.5363      4178.3256    
Loop time of 151.338 on 8 procs for 3000 steps with 371 atoms

Performance: 0.856 ns/day, 28.026 hours/ns, 19.823 timesteps/s, 7.354 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 92.053     | 121.28     | 128.22     | 103.6 | 80.14
Bond    | 0.008124   | 0.009158   | 0.0096352  |   0.5 |  0.01
Neigh   | 6.4582     | 8.4636     | 9.0954     |  27.0 |  5.59
Comm    | 1.9742     | 8.8958     | 38.104     | 382.0 |  5.88
Output  | 0.0013646  | 0.001601   | 0.002909   |   1.2 |  0.00
Modify  | 11.947     | 12.607     | 14.64      |  22.5 |  8.33
Other   |            | 0.08045    |            |       |  0.05

Nlocal:         46.375 ave          54 max          40 min
Histogram: 2 1 0 1 0 1 1 0 1 1
Nghost:        3376.25 ave        3411 max        3332 min
Histogram: 1 0 0 2 0 1 1 1 1 1
Neighs:        28694.9 ave       33167 max       25054 min
Histogram: 2 1 0 1 0 1 1 0 1 1

Total # of neighbors = 229559
Ave neighs/atom = 618.75741
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 9.21787514351444
variable C2pos equal ${d2}
variable C2pos equal 23.7578549456147
variable C3pos equal ${d3}
variable C3pos equal -26.7624020960084
variable C4pos equal ${d4}
variable C4pos equal -14.8717675294628
variable C5pos equal ${d5}
variable C5pos equal -10.5451843641689
variable C6pos equal ${d6}
variable C6pos equal 2.51787568138851

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(70.5978152003037+${C1pos})
variable C11 equal 0.5*(70.5978152003037+9.21787514351444)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(20.3179621230655+${C2pos})
variable C21 equal 0.5*(20.3179621230655+23.7578549456147)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(6.80321371224134+${C3pos})
variable C31 equal 0.5*(6.80321371224134+-26.7624020960084)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(4.29823798404994+${C4pos})
variable C41 equal 0.5*(4.29823798404994+-14.8717675294628)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(10.9410780337075+${C5pos})
variable C51 equal 0.5*(10.9410780337075+-10.5451843641689)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-6.95187154246916+${C6pos})
variable C61 equal 0.5*(-6.95187154246916+2.51787568138851)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 12.8149
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.8149
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.128149 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.128149 yz delta -0.002054 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.686751 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.686751 18.6403) with tilt (-8.851 0.4589 0.203346)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 131.4 | 132.6 | 133.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   295.85779     -43106.568      37543.816      0              4095.5864    
       100   275.24147     -43103.822     -1760.681      -4333.58        4095.5864    
       200   281.57965     -43131.23      -9634.6804     -4109.0003      4095.5864    
       300   308.17011     -43163.594     -14707.98      -13207.396      4095.5864    
       400   288.57846     -43132.991      1543.1032     -10392.096      4095.5864    
       500   299.05545     -43132.045      2500.4539     -1612.8351      4095.5864    
       600   325.45039     -43151.139     -6998.2021     -8479.9441      4095.5864    
       700   312.76275     -43151.464     -2722.8039     -7219.5938      4095.5864    
       800   313.17528     -43171.23       2468.103      -7024.9519      4095.5864    
       900   298.10815     -43171.041     -10163.573     -4924.3076      4095.5864    
      1000   275.99154     -43138.619     -3362.522      -6561.9887      4095.5864    
      1100   309.45438     -43148.213     -4697.8824     -6731.0649      4095.5864    
      1200   322.43065     -43148.825     -13145.09      -3615.6705      4095.5864    
      1300   305.84805     -43147.205     -6968.3159     -10198.46       4095.5864    
      1400   290.45241     -43162.349     -3596.535      -4549.4832      4095.5864    
      1500   291.57516     -43175.678      2300.9018     -5424.283       4095.5864    
      1600   280.12274     -43154.894      10334.065     -7222.3452      4095.5864    
      1700   316.22682     -43166.432     -4957.5186     -3262.4432      4095.5864    
      1800   320.46678     -43164.248     -9277.2857     -3796.8772      4095.5864    
      1900   264.50536     -43122.461     -9776.9342     -4150.5698      4095.5864    
      2000   296.49269     -43172.617     -11718.398     -6169.9191      4095.5864    
      2100   297.85871     -43191.89      -8259.6092     -3753.4435      4095.5864    
      2200   290.86553     -43189.821     -3738.7077     -5092.2182      4095.5864    
      2300   304.58167     -43163.899     -10080.923     -7750.8738      4095.5864    
      2400   306.77241     -43156.993     -14419.517     -8632.9706      4095.5864    
      2500   280.69567     -43134.937      261.29625     -7226.0912      4095.5864    
      2600   295.43739     -43168.776     -3310.0069     -13379.783      4095.5864    
      2700   266.70782     -43168.525     -2525.793      -6063.6676      4095.5864    
      2800   281.36827     -43181.933     -9191.5624     -6822.557       4095.5864    
      2900   290.84691     -43175.197     -10873.098     -3899.9977      4095.5864    
      3000   302.31786     -43175.579      844.71235     -6809.0019      4095.5864    
Loop time of 157.92 on 8 procs for 3000 steps with 371 atoms

Performance: 0.821 ns/day, 29.244 hours/ns, 18.997 timesteps/s, 7.048 katom-step/s
98.5% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 124.45     | 128.83     | 132.97     |  22.5 | 81.58
Bond    | 0.008149   | 0.0092941  | 0.0099561  |   0.6 |  0.01
Neigh   | 8.7121     | 8.9781     | 9.1504     |   4.6 |  5.69
Comm    | 2.4759     | 6.5445     | 10.821     |  98.9 |  4.14
Output  | 0.0072108  | 0.0090306  | 0.01024    |   1.1 |  0.01
Modify  | 13.284     | 13.462     | 13.631     |   3.0 |  8.52
Other   |            | 0.09039    |            |       |  0.06

Nlocal:         46.375 ave          54 max          39 min
Histogram: 1 1 0 1 2 0 1 0 0 2
Nghost:        3440.38 ave        3521 max        3384 min
Histogram: 1 2 0 1 1 1 1 0 0 1
Neighs:        29272.5 ave       33738 max       25128 min
Histogram: 1 1 1 1 1 0 1 0 0 2

Total # of neighbors = 234180
Ave neighs/atom = 631.21294
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 131.3 | 132.6 | 133.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.31786     -43175.579      844.74562      0              4095.5864    
       100   287.94166     -43164.343     -10840.44      -2792.6629      4095.5864    
       200   286.99264     -43188.34      -7434.1533     -295.41093      4095.5864    
       300   293.04569     -43216.635     -4784.7893     -5731.868       4095.5864    
       400   281.82746     -43184.202      4505.8673      674.20012      4095.5864    
       500   291.39845     -43178.683     -17641.158     -5237.5682      4095.5864    
       600   308.30099     -43186.707     -9567.8826     -5018.487       4095.5864    
       700   304.70379     -43177.357     -7229.6904     -5136.9085      4095.5864    
       800   302.20777     -43183.626      13548.866     -493.85117      4095.5864    
       900   277.65491     -43184.411     -2192.3154     -7176.2456      4095.5864    
      1000   287.92417     -43204.01      -2382.3616     -6339.0974      4095.5864    
      1100   306.11296     -43198.046     -5131.8575     -3393.8371      4095.5864    
      1200   298.99229     -43163.537      746.51462     -1201.0274      4095.5864    
      1300   298.95499     -43158.052     -9291.4456     -9163.4073      4095.5864    
      1400   323.4729      -43185.446     -6888.1046     -8136.0908      4095.5864    
      1500   289.78355     -43169.136     -14405.552     -8623.7079      4095.5864    
      1600   284.16256     -43179.545     -12433.175     -7208.1803      4095.5864    
      1700   303.08831     -43185.145     -10718.362     -12638.404      4095.5864    
      1800   304.69123     -43152.211     -11673.322     -6338.9913      4095.5864    
      1900   309.96088     -43151.023     -1488.7933     -5992.1726      4095.5864    
      2000   316.72588     -43174.493     -11835.61      -4663.8923      4095.5864    
      2100   289.00822     -43170.838     -1203.4316     -7667.8101      4095.5864    
      2200   293.37572     -43181.121     -15074.889     -7597.6572      4095.5864    
      2300   302.48741     -43181.976     -2984.7421     -7324.3465      4095.5864    
      2400   289.69279     -43166.127      373.61379     -4070.5174      4095.5864    
      2500   309.57559     -43179.326     -14810.113     -10984.639      4095.5864    
      2600   303.77261     -43173.022     -4024.6015     -4591.2003      4095.5864    
      2700   293.08574     -43190.778     -7894.3509     -8946.0581      4095.5864    
      2800   297.71849     -43212.551     -10579.497     -6882.46        4095.5864    
      2900   292.44775     -43197.804     -11174.04      -11191.428      4095.5864    
      3000   306.32268     -43178.478     -6271.0074     -3639.0813      4095.5864    
Loop time of 156.586 on 8 procs for 3000 steps with 371 atoms

Performance: 0.828 ns/day, 28.997 hours/ns, 19.159 timesteps/s, 7.108 katom-step/s
98.6% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 109.09     | 122.91     | 131.41     |  68.8 | 78.49
Bond    | 0.0087501  | 0.0092449  | 0.0097762  |   0.3 |  0.01
Neigh   | 7.7598     | 8.6153     | 9.0994     |  17.3 |  5.50
Comm    | 3.1648     | 11.643     | 25.461     | 223.4 |  7.44
Output  | 0.0013326  | 0.0015529  | 0.0028748  |   1.3 |  0.00
Modify  | 12.847     | 13.328     | 14.186     |  14.1 |  8.51
Other   |            | 0.08049    |            |       |  0.05

Nlocal:         46.375 ave          52 max          39 min
Histogram: 1 0 1 0 1 1 2 0 0 2
Nghost:        3462.12 ave        3500 max        3440 min
Histogram: 2 0 2 2 0 0 1 0 0 1
Neighs:          29271 ave       32622 max       24977 min
Histogram: 1 1 0 0 1 1 2 0 0 2

Total # of neighbors = 234168
Ave neighs/atom = 631.18059
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 48.7345034774768
variable C2neg equal ${d2}
variable C2neg equal 45.9460226369302
variable C3neg equal ${d3}
variable C3neg equal 47.290980749404
variable C4neg equal ${d4}
variable C4neg equal -0.69631898464013
variable C5neg equal ${d5}
variable C5neg equal -13.9533536808257
variable C6neg equal ${d6}
variable C6neg equal 7.15018360039488

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.8149
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.128149 yz delta ${deltayz} remap units box
change_box all y delta 0 0.128149 yz delta 0.002054 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.943049 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.943049 18.6403) with tilt (-8.851 0.4589 0.207454)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.5 | 129.1 | 131.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   295.85779     -43090.798     -47537.377      0              4178.3256    
       100   285.33461     -43102.077     -3591.5482     -4547.5118      4178.3256    
       200   295.15364     -43141.346      8707.4172     -5919.1672      4178.3256    
       300   288.24394     -43143.155     -3102.7716     -12776.183      4178.3256    
       400   295.46531     -43141.118     -6789.6741     -4448.4907      4178.3256    
       500   307.51294     -43137.107     -10839.264     -5501.561       4178.3256    
       600   316.7013      -43144.366     -10687.837     -9134.4209      4178.3256    
       700   303.93709     -43137.649     -6899.0217     -2625.7752      4178.3256    
       800   296.39091     -43143.058     -9941.0679     -4757.9905      4178.3256    
       900   305.87415     -43160.196      297.59282     -1633.0845      4178.3256    
      1000   288.41415     -43139.773      504.21187     -7003.5094      4178.3256    
      1100   298.79936     -43149.753     -10354.747     -2380.1121      4178.3256    
      1200   289.91621     -43134.127     -14171.887     -7924.0753      4178.3256    
      1300   305.62483     -43130.715      1313.2524     -5795.613       4178.3256    
      1400   314.41545     -43125.102     -1361.6714     -6445.5761      4178.3256    
      1500   302.27088     -43121.418     -8535.1856     -6360.9919      4178.3256    
      1600   308.80031     -43153.181     -7821.4498     -11558.072      4178.3256    
      1700   289.68922     -43143.387     -14676.671     -9838.4062      4178.3256    
      1800   280.41113     -43132.497     -2864.4723     -4760.8923      4178.3256    
      1900   306.91453     -43141.89      -10337.535     -11082.987      4178.3256    
      2000   295.96777     -43117.696     -2649.155      -6814.6595      4178.3256    
      2100   305.0173      -43136.682     -8478.5318     -6358.24        4178.3256    
      2200   274.41163     -43128.368     -2218.7936     -6037.3734      4178.3256    
      2300   296.31782     -43162.268     -8631.8684     -4932.5291      4178.3256    
      2400   281.34599     -43140.083     -4606.3987     -9079.2472      4178.3256    
      2500   304.22746     -43131.224      1082.2936     -3040.5308      4178.3256    
      2600   325.70549     -43147.253     -12422.438     -6817.8294      4178.3256    
      2700   306.88488     -43140.964      2291.0184     -2425.7619      4178.3256    
      2800   293.70778     -43157.231      9970.8983     -1071.655       4178.3256    
      2900   291.57784     -43162.259      4316.3955     -2241.9148      4178.3256    
      3000   296.55782     -43155.439     -3222.4152     -2646.2508      4178.3256    
Loop time of 150.225 on 8 procs for 3000 steps with 371 atoms

Performance: 0.863 ns/day, 27.820 hours/ns, 19.970 timesteps/s, 7.409 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 85.747     | 119.95     | 127.54     | 119.5 | 79.85
Bond    | 0.0088147  | 0.0092937  | 0.0099168  |   0.3 |  0.01
Neigh   | 6.2674     | 8.3897     | 9.2262     |  29.6 |  5.58
Comm    | 1.5803     | 9.1883     | 43.361     | 431.5 |  6.12
Output  | 0.007716   | 0.010308   | 0.01186    |   1.5 |  0.01
Modify  | 11.714     | 12.598     | 14.762     |  24.8 |  8.39
Other   |            | 0.0799     |            |       |  0.05

Nlocal:         46.375 ave          52 max          39 min
Histogram: 1 0 0 2 1 0 1 1 0 2
Nghost:        3338.75 ave        3393 max        3302 min
Histogram: 2 1 0 1 1 0 2 0 0 1
Neighs:        28679.1 ave       31918 max       24490 min
Histogram: 1 0 1 1 1 0 0 2 0 2

Total # of neighbors = 229433
Ave neighs/atom = 618.41779
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 127.4 | 129.3 | 131.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.55782     -43155.439     -3222.4497      0              4178.3256    
       100   297.19088     -43148.054      7658.1208     -3733.6883      4178.3256    
       200   314.39972     -43139.204      2047.1829     -3942.3057      4178.3256    
       300   308.09465     -43110.956     -11735.472     -5682.3146      4178.3256    
       400   327.1016      -43136.341     -15462.673     -9120.3342      4178.3256    
       500   289.62881     -43136.977     -417.74799     -7384.8372      4178.3256    
       600   309.67772     -43173.744     -9531.3092     -2309.2786      4178.3256    
       700   286.1922      -43147.082     -8060.3639     -3711.2671      4178.3256    
       800   316.85354     -43155.166     -7687.5414     -6133.5752      4178.3256    
       900   300.52126     -43127.438     -6579.3007     -8217.5045      4178.3256    
      1000   308.44729     -43140.301     -1933.2485     -3737.6433      4178.3256    
      1100   289.64763     -43147.217      4209.8833     -1753.1502      4178.3256    
      1200   289.85666     -43156.798     -7656.6851     -7352.3126      4178.3256    
      1300   301.21975     -43147.118     -3948.4694     -6995.3902      4178.3256    
      1400   304.04723     -43133.932      1957.3839     -5853.5039      4178.3256    
      1500   304.38783     -43137.805     -4360.4231     -7913.6535      4178.3256    
      1600   302.7542      -43145.504     -21935.9       -9249.3365      4178.3256    
      1700   273.59263     -43144.668     -11206.998     -8499.7884      4178.3256    
      1800   265.23504     -43158.038     -5761.2338     -8530.6419      4178.3256    
      1900   285.20889     -43153.571      7397.8261     -11368.492      4178.3256    
      2000   290.51509     -43137.531     -2619.5481     -7294.0463      4178.3256    
      2100   309.45411     -43149.384     -3818.5427     -2895.9924      4178.3256    
      2200   303.10499     -43141.1       -1936.0676     -9863.3354      4178.3256    
      2300   304.70381     -43147.383     -2846.2318     -6559.0895      4178.3256    
      2400   289.35694     -43143.543     -10301.687     -5334.6674      4178.3256    
      2500   281.10463     -43143.622     -2667.2351     -1426.099       4178.3256    
      2600   318.61757     -43161.716      356.78952     -5975.8284      4178.3256    
      2700   337.53382     -43167.625     -1738.91       -5798.9744      4178.3256    
      2800   307.32772     -43149.075      3907.8406      387.61596      4178.3256    
      2900   310.18961     -43167.948     -22712.521     -8600.1726      4178.3256    
      3000   301.83375     -43163.483     -15689.471     -4263.4882      4178.3256    
Loop time of 150.413 on 8 procs for 3000 steps with 371 atoms

Performance: 0.862 ns/day, 27.854 hours/ns, 19.945 timesteps/s, 7.400 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 106.49     | 122.13     | 127.78     |  64.1 | 81.19
Bond    | 0.0084752  | 0.0092933  | 0.009808   |   0.5 |  0.01
Neigh   | 7.3858     | 8.5175     | 9.3007     |  19.3 |  5.66
Comm    | 1.5111     | 7.1816     | 22.791     | 264.0 |  4.77
Output  | 0.0013158  | 0.0015975  | 0.0031574  |   1.5 |  0.00
Modify  | 11.669     | 12.496     | 13.661     |  16.5 |  8.31
Other   |            | 0.08163    |            |       |  0.05

Nlocal:         46.375 ave          52 max          39 min
Histogram: 1 0 1 1 1 0 0 1 1 2
Nghost:        3371.62 ave        3395 max        3351 min
Histogram: 1 1 1 1 0 1 1 0 1 1
Neighs:        28665.4 ave       31875 max       24467 min
Histogram: 1 0 1 1 1 0 0 1 1 2

Total # of neighbors = 229323
Ave neighs/atom = 618.12129
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -42.407699814074
variable C2pos equal ${d2}
variable C2pos equal 22.1786958455825
variable C3pos equal ${d3}
variable C3pos equal -54.1405278084661
variable C4pos equal ${d4}
variable C4pos equal -5.4788826846214
variable C5pos equal ${d5}
variable C5pos equal 9.55625401233215
variable C6pos equal ${d6}
variable C6pos equal -6.8881473218166

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(48.7345034774768+${C1pos})
variable C12 equal 0.5*(48.7345034774768+-42.407699814074)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(45.9460226369302+${C2pos})
variable C22 equal 0.5*(45.9460226369302+22.1786958455825)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(47.290980749404+${C3pos})
variable C32 equal 0.5*(47.290980749404+-54.1405278084661)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-0.69631898464013+${C4pos})
variable C42 equal 0.5*(-0.69631898464013+-5.4788826846214)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(-13.9533536808257+${C5pos})
variable C52 equal 0.5*(-13.9533536808257+9.55625401233215)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(7.15018360039488+${C6pos})
variable C62 equal 0.5*(7.15018360039488+-6.8881473218166)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 18.6403
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*18.6403
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.186403 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.8149 18.453897) with tilt (-8.851 0.4589 0.2054)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.7 | 131.9 | 133.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   295.85779     -43103.323      40519.367      0              4095.5864    
       100   280.05928     -43105.879     -3531.8649     -3972.9081      4095.5864    
       200   283.20124     -43130.05      -2936.8739     -3702.9677      4095.5864    
       300   300.65039     -43151.787      25.802022     -7562.4132      4095.5864    
       400   293.94655     -43126.947      5034.8322     -6006.7207      4095.5864    
       500   308.23996     -43130.795      1004.7271     -3911.9803      4095.5864    
       600   304.24543     -43138.565     -7692.8183     -10459.927      4095.5864    
       700   309.64501     -43163.085     -7513.3477     -2453.1896      4095.5864    
       800   301.43898     -43170.21       2744.5775      3049.5783      4095.5864    
       900   290.55359     -43158.353      5695.6769     -3063.3807      4095.5864    
      1000   304.72549     -43153.742     -1611.579      -7864.1059      4095.5864    
      1100   302.47755     -43135.304     -10176.285     -8132.6196      4095.5864    
      1200   314.57761     -43155.402     -5529.9642     -7632.6723      4095.5864    
      1300   292.99901     -43154.186     -476.15582     -3966.4007      4095.5864    
      1400   287.08684     -43173.234     -1589.2383     -8351.6201      4095.5864    
      1500   283.89393     -43174.914     -1392.8066     -9223.0517      4095.5864    
      1600   291.41904     -43166.416     -14572.38      -8200.1551      4095.5864    
      1700   315.34255     -43171.284     -629.68336     -5569.5566      4095.5864    
      1800   316.14809     -43176.558     -3871.1992     -8339.6417      4095.5864    
      1900   296.20894     -43188.199     -10816.446     -11415.612      4095.5864    
      2000   286.7218      -43186.419      7105.1807     -3645.5217      4095.5864    
      2100   311.33011     -43189.525      15808.227     -4715.2801      4095.5864    
      2200   293.25034     -43151.346     -7424.3047     -1268.6104      4095.5864    
      2300   304.70337     -43165.518      2862.0896     -4079.6813      4095.5864    
      2400   313.53396     -43187.9       -6656.7653     -7595.7764      4095.5864    
      2500   302.03138     -43175.2        1560.0531     -10365.791      4095.5864    
      2600   296.07449     -43168.013     -5940.7562     -3551.7167      4095.5864    
      2700   301.9911      -43185.434     -2269.056      -4441.5703      4095.5864    
      2800   281.70449     -43181.292      1662.9795     -985.20838      4095.5864    
      2900   283.13651     -43183.933      9523.0632     -4155.5881      4095.5864    
      3000   293.53934     -43162.685      2700.81       -2158.5065      4095.5864    
Loop time of 155.127 on 8 procs for 3000 steps with 371 atoms

Performance: 0.835 ns/day, 28.727 hours/ns, 19.339 timesteps/s, 7.175 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 110.14     | 124.88     | 131.84     |  73.2 | 80.50
Bond    | 0.0090665  | 0.0092739  | 0.0095087  |   0.2 |  0.01
Neigh   | 7.5078     | 8.645      | 9.4782     |  22.5 |  5.57
Comm    | 1.7745     | 8.7568     | 23.48      | 276.4 |  5.64
Output  | 0.0069827  | 0.009056   | 0.010379   |   1.3 |  0.01
Modify  | 11.871     | 12.75      | 13.915     |  18.9 |  8.22
Other   |            | 0.07943    |            |       |  0.05

Nlocal:         46.375 ave          51 max          41 min
Histogram: 1 0 2 0 0 1 1 0 0 3
Nghost:        3412.75 ave        3423 max        3390 min
Histogram: 1 0 0 1 0 0 1 1 1 3
Neighs:        29285.6 ave       32077 max       26187 min
Histogram: 1 2 0 0 1 1 0 0 1 2

Total # of neighbors = 234285
Ave neighs/atom = 631.49596
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.7 | 131.9 | 133.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   293.53934     -43162.685      2700.782       0              4095.5864    
       100   316.85167     -43192.592     -91.284132     -2477.0488      4095.5864    
       200   300.03869     -43197.683     -2515.545      -4992.3379      4095.5864    
       300   268.51533     -43190.132      3635.3628     -4452.3355      4095.5864    
       400   290.16776     -43199.303     -14283.6       -12903.1        4095.5864    
       500   283.76257     -43171.028     -2676.5249     -4305.5509      4095.5864    
       600   295.2632      -43173.717     -22688.022     -7431.5854      4095.5864    
       700   294.19194     -43166.571     -4615.1593     -2528.3722      4095.5864    
       800   301.43112     -43176.142     -9892.0719     -2841.6591      4095.5864    
       900   295.71207     -43183.673      3152.8658     -7040.2374      4095.5864    
      1000   286.52757     -43189.635      3586.0108     -1813.7419      4095.5864    
      1100   289.44374     -43199.337     -7128.337      -6517.2595      4095.5864    
      1200   312.20422     -43195.311     -7670.3624     -5775.1808      4095.5864    
      1300   297.51658     -43157.337     -6725.3835     -8680.655       4095.5864    
      1400   302.83303     -43160.479      4132.4616     -11211.34       4095.5864    
      1500   307.57801     -43166.89      -12125.829     -4587.634       4095.5864    
      1600   298.76112     -43190.03      -18189.611     -11128.31       4095.5864    
      1700   289.53293     -43197.397     -15319.742     -9427.6455      4095.5864    
      1800   289.51702     -43182.055     -14479.836     -7794.6609      4095.5864    
      1900   298.77889     -43170.322     -3691.3865     -2123.767       4095.5864    
      2000   286.59956     -43146.522     -8606.9725     -6755.9304      4095.5864    
      2100   313.97689     -43178.996     -4223.8112     -13396.97       4095.5864    
      2200   295.01082     -43169.794     -7198.871      -5948.217       4095.5864    
      2300   297.93514     -43175.971     -814.9975      -11399.291      4095.5864    
      2400   297.57177     -43182.332      4366.7699     -4338.434       4095.5864    
      2500   296.41775     -43185.778      13743.398     -4546.6978      4095.5864    
      2600   301.72441     -43192.463     -6523.9737     -3517.8209      4095.5864    
      2700   295.34859     -43175.06       6356.5384     -6412.8827      4095.5864    
      2800   311.21484     -43177.721     -4839.9161     -8292.0218      4095.5864    
      2900   319.61169     -43185.078     -10563.381     -4378.271       4095.5864    
      3000   294.1731      -43171.591     -970.61707     -5704.2127      4095.5864    
Loop time of 154.462 on 8 procs for 3000 steps with 371 atoms

Performance: 0.839 ns/day, 28.604 hours/ns, 19.422 timesteps/s, 7.206 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 91.043     | 120.12     | 130.77     | 127.9 | 77.77
Bond    | 0.0084945  | 0.0092007  | 0.0096835  |   0.3 |  0.01
Neigh   | 6.1866     | 8.2775     | 9.446      |  35.6 |  5.36
Comm    | 2.2336     | 12.866     | 41.95      | 390.7 |  8.33
Output  | 0.0013349  | 0.0016622  | 0.0037177  |   1.9 |  0.00
Modify  | 11.895     | 13.107     | 15.204     |  28.6 |  8.49
Other   |            | 0.08032    |            |       |  0.05

Nlocal:         46.375 ave          53 max          38 min
Histogram: 2 0 0 0 0 2 1 0 2 1
Nghost:        3412.88 ave        3465 max        3378 min
Histogram: 3 1 0 0 1 0 1 1 0 1
Neighs:        29300.1 ave       33287 max       24179 min
Histogram: 2 0 0 0 0 2 1 0 2 1

Total # of neighbors = 234401
Ave neighs/atom = 631.80863
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 27.8095588300528
variable C2neg equal ${d2}
variable C2neg equal 15.3489408385899
variable C3neg equal ${d3}
variable C3neg equal 51.2247441278469
variable C4neg equal ${d4}
variable C4neg equal -0.908209946590827
variable C5neg equal ${d5}
variable C5neg equal -16.312957299081
variable C6neg equal ${d6}
variable C6neg equal 11.7462057031129

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*18.6403
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.186403 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.8149 18.826703) with tilt (-8.851 0.4589 0.2054)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.9 | 130.3 | 131.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   295.85779     -43092.65      -48070.239      0              4178.3256    
       100   294.00553     -43114.705     -6624.5053     -5512.5644      4178.3256    
       200   282.19238     -43131.532     -1569.2519     -5710.6476      4178.3256    
       300   292.99047     -43153.492     -10775.877     -11955.751      4178.3256    
       400   284.93301     -43130.776     -15945.725     -6554.7327      4178.3256    
       500   302.10477     -43127.104     -8849.7926     -4705.5163      4178.3256    
       600   324.71158     -43140.528     -14380.542     -7980.4741      4178.3256    
       700   305.11014     -43131.914     -3431.3257     -6567.8331      4178.3256    
       800   312.01837     -43162.727     -11982.154     -7894.857       4178.3256    
       900   294.14381     -43155.134     -808.93618     -5908.2072      4178.3256    
      1000   284.06418     -43132.356     -9505.6416     -5303.7503      4178.3256    
      1100   317.22905     -43145.977      5145.1792     -6345.7988      4178.3256    
      1200   303.1181      -43133.513     -15487.125     -7001.3159      4178.3256    
      1300   283.14168     -43131.124      175.58531     -11770.582      4178.3256    
      1400   309.94248     -43168.052     -7744.5551     -6512.4136      4178.3256    
      1500   278.56323     -43134.036     -15825.698     -6487.1621      4178.3256    
      1600   297.53578     -43146.953     -17019.072     -10622.763      4178.3256    
      1700   288.66209     -43121.592     -7685.807      -10390.301      4178.3256    
      1800   307.40701     -43127.588      6224.0921     -10072.864      4178.3256    
      1900   280.51112     -43117.925      1748.7494     -7497.3896      4178.3256    
      2000   283.56252     -43144.512     -7077.9561     -2222.7682      4178.3256    
      2100   278.98719     -43132.115     -9678.4041     -933.76915      4178.3256    
      2200   299.10797     -43131.821     -7976.0855     -951.66063      4178.3256    
      2300   300.87102     -43114.333     -15077.35      -6691.1928      4178.3256    
      2400   323.91539     -43103.408     -6898.7146     -6418.7499      4178.3256    
      2500   309.16462     -43098.455     -4526.8488     -8874.1263      4178.3256    
      2600   305.60243     -43126.033     -7901.5805     -9085.0322      4178.3256    
      2700   307.49314     -43147.35       1314.787      -5934.0304      4178.3256    
      2800   294.16945     -43142.683      261.4885      -6647.1762      4178.3256    
      2900   286.88124     -43146.759     -6506.0477      444.4351       4178.3256    
      3000   286.15913     -43164.04       2245.3185     -3608.9952      4178.3256    
Loop time of 150.867 on 8 procs for 3000 steps with 371 atoms

Performance: 0.859 ns/day, 27.938 hours/ns, 19.885 timesteps/s, 7.377 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 104.62     | 121.67     | 127.7      |  73.1 | 80.65
Bond    | 0.0083615  | 0.0091303  | 0.0097323  |   0.4 |  0.01
Neigh   | 7.2437     | 8.4962     | 9.3451     |  21.6 |  5.63
Comm    | 1.8953     | 7.9475     | 25.015     | 286.1 |  5.27
Output  | 0.0073322  | 0.0091119  | 0.010371   |   1.1 |  0.01
Modify  | 11.768     | 12.653     | 13.898     |  17.8 |  8.39
Other   |            | 0.08137    |            |       |  0.05

Nlocal:         46.375 ave          54 max          36 min
Histogram: 1 0 1 0 1 0 2 1 1 1
Nghost:        3381.12 ave        3436 max        3338 min
Histogram: 1 1 0 3 1 0 0 0 1 1
Neighs:        28663.6 ave       33118 max       22702 min
Histogram: 1 0 1 0 1 0 2 1 1 1

Total # of neighbors = 229309
Ave neighs/atom = 618.08356
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.8 | 130.4 | 131.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   286.15913     -43164.04       2245.2914      0              4178.3256    
       100   293.67031     -43158.701     -453.02589     -8427.8682      4178.3256    
       200   320.02192     -43156.922      5663.7902     -5974.1653      4178.3256    
       300   314.86668     -43151.965     -19183.255     -2461.1828      4178.3256    
       400   292.95169     -43142.89       4970.3458     -6074.1644      4178.3256    
       500   294.48597     -43149.871     -5993.6531     -6492.0202      4178.3256    
       600   298.04546     -43153.64      -6816.3972     -2748.7602      4178.3256    
       700   304.77755     -43177.127     -1204.0951     -4052.4404      4178.3256    
       800   311.92967     -43210.289     -6856.5891     -4452.0565      4178.3256    
       900   287.27952     -43186.189     -7067.2054     -8248.2685      4178.3256    
      1000   278.34022     -43145.636     -5726.8737     -7315.9239      4178.3256    
      1100   301.12256     -43152.575     -9699.6844     -878.97242      4178.3256    
      1200   305.99329     -43160.671     -6925.2146     -8661.7239      4178.3256    
      1300   276.8363      -43138.412     -9065.035      -1977.8533      4178.3256    
      1400   298.59477     -43155.601     -9623.9709     -2694.3229      4178.3256    
      1500   312.3098      -43168.827     -10886.058     -1916.3104      4178.3256    
      1600   323.25015     -43202.486     -8612.0264     -6538.1842      4178.3256    
      1700   276.75005     -43173.738     -7880.2367     -4407.6168      4178.3256    
      1800   303.92841     -43199.511     -9472.3575     -3542.0589      4178.3256    
      1900   302.65957     -43166.671      6507.9977     -1338.8368      4178.3256    
      2000   303.44365     -43162.276      266.14631     -5334.4884      4178.3256    
      2100   312.31382     -43185.267     -5770.637      -8232.3352      4178.3256    
      2200   302.83921     -43195.368     -2249.1389     -3237.3116      4178.3256    
      2300   298.79657     -43199.531     -11383.385     -8125.9061      4178.3256    
      2400   309.68253     -43186.517      317.11463     -4516.0451      4178.3256    
      2500   324.66331     -43167.268     -7543.666      -1954.9727      4178.3256    
      2600   317.29167     -43165.44      -15971.056     -6855.1812      4178.3256    
      2700   306.23043     -43176.436     -7429.8242     -1569.1717      4178.3256    
      2800   290.36093     -43169.744      7717.7849     -6490.1518      4178.3256    
      2900   297.87007     -43171.937     -10253.287     -7726.5532      4178.3256    
      3000   288.93913     -43149.106     -18326.175     -5656.2859      4178.3256    
Loop time of 151.712 on 8 procs for 3000 steps with 371 atoms

Performance: 0.854 ns/day, 28.095 hours/ns, 19.774 timesteps/s, 7.336 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 90.084     | 120.73     | 128.74     | 113.9 | 79.58
Bond    | 0.0084767  | 0.0091363  | 0.009481   |   0.4 |  0.01
Neigh   | 6.2369     | 8.3733     | 9.3197     |  31.0 |  5.52
Comm    | 1.8278     | 9.8148     | 40.476     | 399.4 |  6.47
Output  | 0.0012782  | 0.0015494  | 0.0025672  |   1.0 |  0.00
Modify  | 11.713     | 12.7       | 14.836     |  25.4 |  8.37
Other   |            | 0.07981    |            |       |  0.05

Nlocal:         46.375 ave          53 max          37 min
Histogram: 1 0 0 1 0 2 2 0 0 2
Nghost:        3377.88 ave        3433 max        3322 min
Histogram: 1 1 2 0 0 0 0 1 2 1
Neighs:        28680.9 ave       32472 max       23298 min
Histogram: 1 0 0 1 0 2 2 0 0 2

Total # of neighbors = 229447
Ave neighs/atom = 618.45553
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -28.2951775549727
variable C2pos equal ${d2}
variable C2pos equal 20.3512874938276
variable C3pos equal ${d3}
variable C3pos equal 5.51424838634316
variable C4pos equal ${d4}
variable C4pos equal -11.7762151219342
variable C5pos equal ${d5}
variable C5pos equal 4.92200078999965
variable C6pos equal ${d6}
variable C6pos equal -1.15776167455564

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(27.8095588300528+${C1pos})
variable C13 equal 0.5*(27.8095588300528+-28.2951775549727)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(15.3489408385899+${C2pos})
variable C23 equal 0.5*(15.3489408385899+20.3512874938276)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(51.2247441278469+${C3pos})
variable C33 equal 0.5*(51.2247441278469+5.51424838634316)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(-0.908209946590827+${C4pos})
variable C43 equal 0.5*(-0.908209946590827+-11.7762151219342)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-16.312957299081+${C5pos})
variable C53 equal 0.5*(-16.312957299081+4.92200078999965)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(11.7462057031129+${C6pos})
variable C63 equal 0.5*(11.7462057031129+-1.15776167455564)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 18.6403
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*18.6403
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.186403 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.018997)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.8 | 130.7 | 132.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   295.85779     -43114.816     -6958.6806      0              4136.956     
       100   277.03355     -43108.817     -6922.1512     -4514.7851      4136.956     
       200   300.73542     -43147.399     -2248.1181     -5355.7614      4136.956     
       300   292.05987     -43139.229     -7505.0401     -8911.4372      4136.956     
       400   298.07708     -43134.628     -4337.6611     -5481.139       4136.956     
       500   293.4591      -43120.227     -7058.3208     -2123.9841      4136.956     
       600   312.55536     -43143.288     -14073.427     -8668.6727      4136.956     
       700   298.85755     -43152.155      1133.0381     -4560.3674      4136.956     
       800   295.59101     -43173.685     -13171.81      -5361.3237      4136.956     
       900   298.32064     -43176.546     -713.5001      -2416.9672      4136.956     
      1000   300.1018      -43152.525     -3411.3843     -4121.3788      4136.956     
      1100   315.94078     -43150.269     -10089.433     -4655.5801      4136.956     
      1200   294.38299     -43132.559     -1474.0382     -8363.2575      4136.956     
      1300   300.62692     -43154.942     -3175.0596     -6627.6968      4136.956     
      1400   293.22796     -43155.613      1135.7896     -7204.253       4136.956     
      1500   284.73796     -43135.872     -6281.92       -2680.5414      4136.956     
      1600   296.60607     -43136.355     -3467.0422     -7906.923       4136.956     
      1700   304.2733      -43129.842     -2510.8019     -8201.3664      4136.956     
      1800   276.51279     -43111.217      4178.8104     -3570.6347      4136.956     
      1900   286.41877     -43153.881     -6204.1006     -8400.9752      4136.956     
      2000   271.67295     -43151.942     -1995.3797     -6990.7696      4136.956     
      2100   278.97131     -43151.062      9068.5022     -2029.8001      4136.956     
      2200   298.0723      -43146.739      354.38689     -6454.5095      4136.956     
      2300   321.03136     -43147.574     -9696.0361     -4095.6166      4136.956     
      2400   292.37816     -43121.283     -4476.0946     -4610.9149      4136.956     
      2500   300.35203     -43137.072      9557.925      -970.32364      4136.956     
      2600   297.75777     -43153.897     -1946.7024     -1322.8513      4136.956     
      2700   298.29554     -43169.747     -1691.189      -7696.5379      4136.956     
      2800   299.29827     -43172.609      3383.0261     -4943.7249      4136.956     
      2900   287.66353     -43159.899      3855.8428     -5077.1396      4136.956     
      3000   303.00579     -43167.165     -8576.9667     -7183.2825      4136.956     
Loop time of 152.343 on 8 procs for 3000 steps with 371 atoms

Performance: 0.851 ns/day, 28.212 hours/ns, 19.692 timesteps/s, 7.306 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 87.469     | 115.42     | 129.8      | 155.0 | 75.76
Bond    | 0.0084124  | 0.009083   | 0.0096493  |   0.4 |  0.01
Neigh   | 5.9708     | 7.9122     | 9.031      |  40.9 |  5.19
Comm    | 1.5422     | 15.933     | 43.864     | 417.2 | 10.46
Output  | 0.0071919  | 0.009077   | 0.010456   |   1.2 |  0.01
Modify  | 11.833     | 12.983     | 14.951     |  32.0 |  8.52
Other   |            | 0.07636    |            |       |  0.05

Nlocal:         46.375 ave          54 max          38 min
Histogram: 2 1 0 0 0 1 0 1 1 2
Nghost:           3396 ave        3440 max        3360 min
Histogram: 2 1 0 0 1 1 1 1 0 1
Neighs:        28971.5 ave       33450 max       23787 min
Histogram: 2 1 0 0 0 1 0 1 1 2

Total # of neighbors = 231772
Ave neighs/atom = 624.72237
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.6 | 130.9 | 132.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   303.00579     -43167.165     -8576.9092      0              4136.956     
       100   288.21968     -43161.744     -8046.5136     -2575.0324      4136.956     
       200   277.49965     -43167.317     -3038.525      -8665.2196      4136.956     
       300   294.30521     -43204.134     -4779.1365     -3327.5184      4136.956     
       400   287.98801     -43192.266      303.51258     -8816.5098      4136.956     
       500   293.28108     -43162.274     -9098.0755     -6660.077       4136.956     
       600   312.39299     -43172.269     -6770.8178     -5904.4631      4136.956     
       700   284.5754      -43145.588     -14403.841     -3184.3165      4136.956     
       800   286.98396     -43157.892     -7005.1729     -2175.5802      4136.956     
       900   282.5647      -43168.067     -14118.493     -6150.2334      4136.956     
      1000   298.35992     -43183.732      2092.9456     -5596.8431      4136.956     
      1100   283.15884     -43151.928      6399.1326     -2229.851       4136.956     
      1200   317.13171     -43161.567      332.21519     -2980.5807      4136.956     
      1300   297.68379     -43154.896     -10815.589     -7071.4229      4136.956     
      1400   310.74074     -43186.004     -9278.1296     -3951.1201      4136.956     
      1500   278.3152      -43158.355     -7047.6821     -3337.5156      4136.956     
      1600   300.4913      -43170.62       9843.7573      1442.0303      4136.956     
      1700   306.98263     -43177.689     -9377.4909     -6213.4403      4136.956     
      1800   306.5432      -43179.037     -3912.1662     -6784.1992      4136.956     
      1900   286.14622     -43160.666     -6317.0526     -6169.9265      4136.956     
      2000   301.52544     -43156.708     -5574.4825     -4994.1012      4136.956     
      2100   313.13071     -43146.287      4982.9411     -4436.2862      4136.956     
      2200   313.57626     -43150.448     -6236.5054     -5782.8455      4136.956     
      2300   315.70205     -43184.071     -17656.433     -3691.1654      4136.956     
      2400   305.16757     -43185.046     -5773.311      -6853.5224      4136.956     
      2500   294.62343     -43179.537      2105.5386     -7075.8593      4136.956     
      2600   294.5754      -43164.217      31.602821     -10282.759      4136.956     
      2700   320.2958      -43156.943      1601.3599      2318.7889      4136.956     
      2800   323.10968     -43168.663     -2435.0749     -2299.4925      4136.956     
      2900   303.45915     -43176.983     -9814.418      -8420.5766      4136.956     
      3000   299.07548     -43182.729     -7041.4742     -2294.7038      4136.956     
Loop time of 152.802 on 8 procs for 3000 steps with 371 atoms

Performance: 0.848 ns/day, 28.297 hours/ns, 19.633 timesteps/s, 7.284 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 89.847     | 114.15     | 130.44     | 169.0 | 74.70
Bond    | 0.0085908  | 0.0091192  | 0.0097466  |   0.4 |  0.01
Neigh   | 6.0983     | 7.8012     | 8.8361     |  41.5 |  5.11
Comm    | 1.3997     | 17.699     | 41.986     | 429.2 | 11.58
Output  | 0.0012844  | 0.0015054  | 0.0027248  |   1.2 |  0.00
Modify  | 12.022     | 13.072     | 14.777     |  32.2 |  8.55
Other   |            | 0.07288    |            |       |  0.05

Nlocal:         46.375 ave          52 max          40 min
Histogram: 1 1 0 1 0 1 1 1 1 1
Nghost:        3394.12 ave        3445 max        3358 min
Histogram: 1 1 2 0 0 3 0 0 0 1
Neighs:          28994 ave       32291 max       25359 min
Histogram: 1 1 1 0 0 1 1 1 1 1

Total # of neighbors = 231952
Ave neighs/atom = 625.20755
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 62.3564077385602
variable C2neg equal ${d2}
variable C2neg equal 17.3161287465532
variable C3neg equal ${d3}
variable C3neg equal 92.1687781991642
variable C4neg equal ${d4}
variable C4neg equal -10.7550618060646
variable C5neg equal ${d5}
variable C5neg equal -10.7612700774189
variable C6neg equal ${d6}
variable C6neg equal 6.98069976655999

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*18.6403
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.186403 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.391803)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.9 | 130.9 | 132.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   295.85779     -43108.338     -7817.352       0              4136.956     
       100   279.57166     -43108.236     -5353.2735     -5240.811       4136.956     
       200   286.62203     -43134.564     -1922.1799     -5088.1043      4136.956     
       300   294.62897     -43144.726     -2113.5241     -11709.845      4136.956     
       400   301.63921     -43139.979      4624.1725     -5287.6667      4136.956     
       500   305.96255     -43135.619     -6924.0657     -6246.2549      4136.956     
       600   298.90663     -43136.237     -7944.5167     -9064.0928      4136.956     
       700   295.02391     -43150.627     -4760.6717     -4088.1286      4136.956     
       800   288.3164      -43149.751      1491.6745      576.14407      4136.956     
       900   298.27481     -43149.973      2204.162      -2094.9374      4136.956     
      1000   304.04703     -43146.401     -3745.202      -6312.1837      4136.956     
      1100   309.72861     -43149.383      6474.0837     -5395.0228      4136.956     
      1200   281.32868     -43120.112     -3002.1571     -3132.1213      4136.956     
      1300   326.46329     -43170.596     -13355.919     -4272.833       4136.956     
      1400   309.37277     -43155.227     -10269.163     -9403.0011      4136.956     
      1500   278.88204     -43141.02      -8855.9581     -12419.113      4136.956     
      1600   292.57934     -43165.765     -1792.4264     -10140.8        4136.956     
      1700   298.62449     -43163.432     -6590.801      -5715.5979      4136.956     
      1800   314.48806     -43161.323     -7571.5724     -3095.5368      4136.956     
      1900   309.9739      -43146.014      937.5901      -7517.3231      4136.956     
      2000   299.45208     -43145.87      -4422.0375     -10282.99       4136.956     
      2100   293.07487     -43157.631      2043.4034     -3567.3151      4136.956     
      2200   282.35412     -43163.28      -1743.4588     -920.53077      4136.956     
      2300   319.47        -43181.656     -4784.2762     -3634.4341      4136.956     
      2400   307.28001     -43135.983      4145.8698     -6075.3051      4136.956     
      2500   303.37225     -43134.645     -1179.8059     -4751.786       4136.956     
      2600   307.37171     -43155.346     -13300.103     -10333.07       4136.956     
      2700   303.50182     -43171.184     -10712.772     -6763.6978      4136.956     
      2800   277.058       -43168.54      -9497.1531     -7631.9474      4136.956     
      2900   251.31312     -43175.282     -1714.5916     -7763.0829      4136.956     
      3000   275.46818     -43202.065     -10428.18      -3777.366       4136.956     
Loop time of 152.354 on 8 procs for 3000 steps with 371 atoms

Performance: 0.851 ns/day, 28.214 hours/ns, 19.691 timesteps/s, 7.305 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 87.676     | 119.55     | 129.38     | 127.9 | 78.47
Bond    | 0.0086221  | 0.0091999  | 0.0097289  |   0.4 |  0.01
Neigh   | 6.1822     | 8.3343     | 8.9713     |  33.3 |  5.47
Comm    | 1.8659     | 11.698     | 43.563     | 408.9 |  7.68
Output  | 0.0076188  | 0.011327   | 0.013277   |   2.0 |  0.01
Modify  | 12.043     | 12.679     | 14.844     |  27.1 |  8.32
Other   |            | 0.07521    |            |       |  0.05

Nlocal:         46.375 ave          55 max          38 min
Histogram: 2 0 0 0 2 0 0 3 0 1
Nghost:           3398 ave        3442 max        3349 min
Histogram: 1 0 0 1 2 2 0 0 0 2
Neighs:        28956.4 ave       33993 max       24011 min
Histogram: 2 0 0 1 1 0 0 3 0 1

Total # of neighbors = 231651
Ave neighs/atom = 624.39623
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.6 | 131.1 | 132.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   275.46818     -43202.065     -10428.21       0              4136.956     
       100   299.09177     -43201.641     -5379.2914      2055.6264      4136.956     
       200   274.00421     -43153.075     -6565.7388     -5449.0151      4136.956     
       300   301.46213     -43158.793      5804.9052     -10907.324      4136.956     
       400   305.06219     -43147.064     -4176.7149     -4729.4284      4136.956     
       500   308.75878     -43149.536     -11104.489     -6428.127       4136.956     
       600   291.55336     -43157.946     -13604.354     -8344.9769      4136.956     
       700   291.65099     -43178.685     -10339.221     -8740.3571      4136.956     
       800   294.83749     -43168.714     -11381.363     -5909.9753      4136.956     
       900   303.93667     -43158.365     -12833.634     -160.11272      4136.956     
      1000   312.45526     -43157.557     -7811.8914     -2882.1295      4136.956     
      1100   294.57568     -43139.52      -1483.6979     -6775.9901      4136.956     
      1200   291.80649     -43141.743      7710.077      -5642.6127      4136.956     
      1300   314.45551     -43147.764     -10995.037     -7791.3136      4136.956     
      1400   331.25473     -43133.999      3598.389      -6793.3615      4136.956     
      1500   320.38669     -43134.27       257.80678     -3231.7269      4136.956     
      1600   297.49618     -43134.008     -14112.909     -5119.2444      4136.956     
      1700   304.48438     -43145.032     -4238.0472      206.13717      4136.956     
      1800   319.15998     -43167.457     -4329.8563     -9000.6677      4136.956     
      1900   290.70453     -43159.238      246.54167     -6912.9807      4136.956     
      2000   286.50404     -43177.054     -6464.2959     -8073.9596      4136.956     
      2100   268.23214     -43181.31      -13290         -6652.5349      4136.956     
      2200   281.8707      -43168.953      4011.3663     -2330.8123      4136.956     
      2300   294.20203     -43156.009     -367.38998     -6754.7877      4136.956     
      2400   297.7571      -43148.631     -15021.528     -7646.8732      4136.956     
      2500   302.45861     -43143.802     -10592.175     -7169.1768      4136.956     
      2600   298.4142      -43139.286      1587.6635     -2678.8974      4136.956     
      2700   309.58802     -43164.574     -12288.478     -8885.5347      4136.956     
      2800   287.87569     -43167.047     -7702.3316     -7497.6056      4136.956     
      2900   292.38372     -43181.8       -12239.756     -7689.2753      4136.956     
      3000   302.0166      -43181.442     -4942.615      -10705.128      4136.956     
Loop time of 152.401 on 8 procs for 3000 steps with 371 atoms

Performance: 0.850 ns/day, 28.222 hours/ns, 19.685 timesteps/s, 7.303 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 111.67     | 123.43     | 128.74     |  53.0 | 80.99
Bond    | 0.0085332  | 0.0090597  | 0.0094532  |   0.3 |  0.01
Neigh   | 7.7424     | 8.5589     | 8.9174     |  13.6 |  5.62
Comm    | 2.5009     | 7.8152     | 19.575     | 210.4 |  5.13
Output  | 0.0013647  | 0.0015968  | 0.0026812  |   1.0 |  0.00
Modify  | 12.146     | 12.507     | 13.324     |  11.3 |  8.21
Other   |            | 0.07756    |            |       |  0.05

Nlocal:         46.375 ave          54 max          40 min
Histogram: 1 1 2 0 0 1 1 1 0 1
Nghost:        3393.25 ave        3433 max        3373 min
Histogram: 2 1 3 0 0 0 1 0 0 1
Neighs:        28986.4 ave       33553 max       25037 min
Histogram: 1 1 2 0 0 1 1 1 0 1

Total # of neighbors = 231891
Ave neighs/atom = 625.04313
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 22.8622196457985
variable C2pos equal ${d2}
variable C2pos equal -8.94553339633842
variable C3pos equal ${d3}
variable C3pos equal -86.5396424171185
variable C4pos equal ${d4}
variable C4pos equal -0.6555370330434
variable C5pos equal ${d5}
variable C5pos equal 20.109504904265
variable C6pos equal ${d6}
variable C6pos equal -8.65252445847314

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(62.3564077385602+${C1pos})
variable C14 equal 0.5*(62.3564077385602+22.8622196457985)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(17.3161287465532+${C2pos})
variable C24 equal 0.5*(17.3161287465532+-8.94553339633842)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(92.1687781991642+${C3pos})
variable C34 equal 0.5*(92.1687781991642+-86.5396424171185)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(-10.7550618060646+${C4pos})
variable C44 equal 0.5*(-10.7550618060646+-0.6555370330434)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-10.7612700774189+${C5pos})
variable C54 equal 0.5*(-10.7612700774189+20.109504904265)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(6.98069976655999+${C6pos})
variable C64 equal 0.5*(6.98069976655999+-8.65252445847314)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 18.6403
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*18.6403
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.186403 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.272497 0.2054)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.6 | 130.5 | 132.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   295.85779     -43111.11      -7861.8863      0              4136.956     
       100   278.60315     -43108.198     -3444.8648     -4961.9443      4136.956     
       200   292.2076      -43138.271     -3993.3663     -5692.7387      4136.956     
       300   292.63302     -43141.272     -3011.6032     -10547.152      4136.956     
       400   287.65839     -43126.318     -7648.0306     -5016.8893      4136.956     
       500   296.54514     -43129.771     -8257.0994     -4211.5695      4136.956     
       600   321.22284     -43155.838     -10091.805     -7309.5819      4136.956     
       700   286.24202     -43131.602      7854.2938     -432.21995      4136.956     
       800   311.81076     -43162.748     -8133.6232     -2955.7936      4136.956     
       900   296.60955     -43151.847     -12358.81      -4357.8713      4136.956     
      1000   278.28444     -43132.004     -14355.481     -6011.0186      4136.956     
      1100   301.85429     -43144.838     -4645.0427     -6046.5898      4136.956     
      1200   303.33459     -43128.752     -12511.238     -7649.337       4136.956     
      1300   299.18129     -43120.693     -5753.7921     -3245.6698      4136.956     
      1400   296.79108     -43131.946     -8496.9103     -8317.6066      4136.956     
      1500   305.17004     -43163.495      7009.9749     -7429.0581      4136.956     
      1600   294.6139      -43174.963     -11147.61      -6605.7599      4136.956     
      1700   288.89026     -43169.811     -9027.5421     -4553.0615      4136.956     
      1800   295.53088     -43153.333     -5398.2041     -6369.7445      4136.956     
      1900   314.61988     -43152.589     -14698.155     -6213.1303      4136.956     
      2000   307.57527     -43139.528      472.64239     -1041.6052      4136.956     
      2100   299.28208     -43142.217     -6273.2184     -8934.8527      4136.956     
      2200   287.75444     -43154.811      1925.8671     -8944.8955      4136.956     
      2300   292.30534     -43162.838      2787.634      -6895.7683      4136.956     
      2400   305.82589     -43139.236      13420.241      2191.7871      4136.956     
      2500   308.81952     -43129.963     -9694.0413     -1964.0033      4136.956     
      2600   293.23776     -43119.879      404.13515     -2462.9751      4136.956     
      2700   314.25789     -43164.716     -16774.357      1593.7269      4136.956     
      2800   294.71443     -43159.916     -13917.854     -10906.634      4136.956     
      2900   277.14974     -43135.98      -22493.512     -8741.8058      4136.956     
      3000   296.46402     -43143.315     -12353.54      -7823.1458      4136.956     
Loop time of 150.697 on 8 procs for 3000 steps with 371 atoms

Performance: 0.860 ns/day, 27.907 hours/ns, 19.908 timesteps/s, 7.386 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 90.415     | 121.22     | 128.37     | 106.4 | 80.44
Bond    | 0.008251   | 0.0089666  | 0.0095504  |   0.4 |  0.01
Neigh   | 6.198      | 8.3278     | 8.834      |  28.2 |  5.53
Comm    | 1.5655     | 8.7188     | 39.522     | 396.8 |  5.79
Output  | 0.0065918  | 0.0087659  | 0.010213   |   1.4 |  0.01
Modify  | 11.825     | 12.331     | 14.474     |  23.3 |  8.18
Other   |            | 0.07711    |            |       |  0.05

Nlocal:         46.375 ave          52 max          39 min
Histogram: 1 0 1 1 1 0 1 0 1 2
Nghost:        3399.25 ave        3459 max        3354 min
Histogram: 1 2 0 1 2 0 0 0 1 1
Neighs:        29019.1 ave       32290 max       24748 min
Histogram: 1 0 1 1 1 0 0 1 1 2

Total # of neighbors = 232153
Ave neighs/atom = 625.74933
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.4 | 130.8 | 132.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.46402     -43143.315     -12353.522      0              4136.956     
       100   304.8233      -43147.598      2267.3794     -3718.5588      4136.956     
       200   307.88493     -43137.936     -14342.644     -8650.404       4136.956     
       300   305.73706     -43124.321      2695.6152     -2452.1574      4136.956     
       400   287.23179     -43128.756     -7511.4626     -10123.394      4136.956     
       500   279.82648     -43145.054     -4702.7291     -8572.2477      4136.956     
       600   285.2797      -43153.298     -5464.7113     -6136.2839      4136.956     
       700   301.86474     -43169.753     -561.64323     -7153.83        4136.956     
       800   297.5777      -43140.919      284.39969     -2687.2621      4136.956     
       900   320.46536     -43142.541      2205.2305     -9026.6168      4136.956     
      1000   313.52065     -43152.286     -2678.2604     -29.929838      4136.956     
      1100   306.45517     -43164.475     -9195.6619     -6293.9213      4136.956     
      1200   292.16769     -43140.252      8190.8874     -6068.5955      4136.956     
      1300   297.37709     -43135.573      583.34272     -5369.1533      4136.956     
      1400   304.6104      -43140.959     -4115.8075     -8045.8286      4136.956     
      1500   302.73307     -43141.411      3268.1356     -5226.7496      4136.956     
      1600   311.06028     -43155.58      -9015.5207     -3046.5162      4136.956     
      1700   297.07192     -43143.724     -8703.3951     -3431.1422      4136.956     
      1800   305.56899     -43167.041      8682.1093     -3392.1429      4136.956     
      1900   275.5942      -43162.497     -7659.7512     -4967.2689      4136.956     
      2000   274.6862      -43159.906     -9482.7591     -8324.3203      4136.956     
      2100   296.49855     -43155.015      4310.94       -8873.4482      4136.956     
      2200   299.53712     -43148.098      278.32881     -1694.2658      4136.956     
      2300   301.82402     -43148.15       6730.6627      779.3821       4136.956     
      2400   294.41493     -43141.442      4114.9248     -9685.1133      4136.956     
      2500   309.80357     -43167.271     -5672.5545     -11678.431      4136.956     
      2600   276.82263     -43161.403      178.33793     -6576.5578      4136.956     
      2700   284.07976     -43183.574     -5806.1816     -1063.5389      4136.956     
      2800   291.18538     -43183.15       4204.4441      1270.411       4136.956     
      2900   294.6187      -43166.655     -657.88474     -3036.9628      4136.956     
      3000   274.40198     -43133.115     -2519.5579     -5046.8673      4136.956     
Loop time of 153.365 on 8 procs for 3000 steps with 371 atoms

Performance: 0.845 ns/day, 28.401 hours/ns, 19.561 timesteps/s, 7.257 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 89.402     | 121.79     | 129.01     | 111.9 | 79.41
Bond    | 0.0080881  | 0.0090885  | 0.0095967  |   0.4 |  0.01
Neigh   | 6.0654     | 8.4183     | 9.0995     |  31.1 |  5.49
Comm    | 3.3267     | 10.558     | 42.954     | 380.0 |  6.88
Output  | 0.0013987  | 0.0016872  | 0.0032089  |   1.4 |  0.00
Modify  | 11.791     | 12.509     | 14.866     |  25.6 |  8.16
Other   |            | 0.0767     |            |       |  0.05

Nlocal:         46.375 ave          58 max          39 min
Histogram: 1 1 1 3 0 0 1 0 0 1
Nghost:         3380.5 ave        3417 max        3359 min
Histogram: 2 1 1 2 0 0 0 1 0 1
Neighs:          28992 ave       35834 max       24730 min
Histogram: 1 2 0 3 0 0 1 0 0 1

Total # of neighbors = 231936
Ave neighs/atom = 625.16442
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 34.4701109025899
variable C2neg equal ${d2}
variable C2neg equal -51.1064266213284
variable C3neg equal ${d3}
variable C3neg equal 39.4282490208355
variable C4neg equal ${d4}
variable C4neg equal 9.42043758342133
variable C5neg equal ${d5}
variable C5neg equal -10.6845570177159
variable C6neg equal ${d6}
variable C6neg equal 0.0419213860557969

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*18.6403
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.186403 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.645303 0.2054)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.9 | 130.8 | 132.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   295.85779     -43110.803     -8059.6976      0              4136.956     
       100   277.25678     -43107.596     -1381.9375     -4494.1727      4136.956     
       200   289.69359     -43134.675     -5598.4711     -5500.547       4136.956     
       300   305.01864     -43148.818     -14488.912     -8772.6652      4136.956     
       400   300.17148     -43135.952     -4167.7306     -7938.8502      4136.956     
       500   293.09141     -43127.044     -10899.653     -3168.7093      4136.956     
       600   312.74639     -43152.64      -4284.2144     -7019.9375      4136.956     
       700   299.73243     -43145.794     -7515.1861      904.78038      4136.956     
       800   295.02857     -43149.793     -10604.043     -4405.6183      4136.956     
       900   301.19681     -43159.527      2780.7703     -5871.7997      4136.956     
      1000   289.9189      -43134.89      -10206.863     -6550.3753      4136.956     
      1100   314.74605     -43146.045     -8788.2443     -2014.1848      4136.956     
      1200   307.80381     -43139.496     -7692.4837     -1846.0603      4136.956     
      1300   293.62176     -43135.707     -18259.011     -10327.134      4136.956     
      1400   296.42078     -43155.856     -2861.6084     -9775.1796      4136.956     
      1500   277.97076     -43144.179     -15217.506     -9628.5821      4136.956     
      1600   281.77767     -43135.012     -10852.687     -10938.294      4136.956     
      1700   309.77501     -43140.563     -4192.4617     -7103.9432      4136.956     
      1800   314.14215     -43140.608     -4255.8087     -7446.3881      4136.956     
      1900   309.98006     -43159.212     -3312.9969     -3958.4052      4136.956     
      2000   294.37377     -43160.6       -9160.4633     -6508.4013      4136.956     
      2100   299.54413     -43157.563     -7556.4843     -6312.1847      4136.956     
      2200   317.4074      -43146.168     -9152.9849     -6399.7427      4136.956     
      2300   312.91033     -43132.604      9536.6406     -3501.0046      4136.956     
      2400   325.21212     -43154.646     -4005.4041      190.22616      4136.956     
      2500   303.78075     -43150.641     -269.62736     -7674.4368      4136.956     
      2600   280.13449     -43136.365     -3426.6126     -3245.6334      4136.956     
      2700   305.99743     -43162.647      3408.3402     -918.97942      4136.956     
      2800   302.41377     -43149.204      1361.3615     -1319.5078      4136.956     
      2900   329.19723     -43141.822     -3785.1922     -5887.8325      4136.956     
      3000   312.5983      -43126.805     -14208.422     -10543.287      4136.956     
Loop time of 152.539 on 8 procs for 3000 steps with 371 atoms

Performance: 0.850 ns/day, 28.248 hours/ns, 19.667 timesteps/s, 7.296 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 111.34     | 122.47     | 130.04     |  59.2 | 80.29
Bond    | 0.0079166  | 0.0090385  | 0.0097557  |   0.6 |  0.01
Neigh   | 7.5877     | 8.5996     | 9.2584     |  19.2 |  5.64
Comm    | 1.1312     | 8.6844     | 19.835     | 222.2 |  5.69
Output  | 0.0081336  | 0.0099935  | 0.011284   |   1.1 |  0.01
Modify  | 11.993     | 12.683     | 13.688     |  16.1 |  8.31
Other   |            | 0.07901    |            |       |  0.05

Nlocal:         46.375 ave          56 max          40 min
Histogram: 2 0 1 2 0 1 1 0 0 1
Nghost:        3403.62 ave        3454 max        3356 min
Histogram: 2 0 0 0 1 3 0 0 1 1
Neighs:        28988.2 ave       34419 max       25351 min
Histogram: 2 0 1 2 0 1 1 0 0 1

Total # of neighbors = 231906
Ave neighs/atom = 625.08356
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.7 | 131 | 132.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.5983      -43126.805     -14208.415      0              4136.956     
       100   320.08077     -43161.139     -3299.0118     -4047.337       4136.956     
       200   281.83491     -43137.81      -4087.9067     -5787.1231      4136.956     
       300   308.58692     -43166.905     -6690.2387     -6579.3516      4136.956     
       400   313.20127     -43158.275     -6276.0444     -5240.4827      4136.956     
       500   318.6509      -43143.516     -18340.158     -6314.2523      4136.956     
       600   322.13718     -43134.215     -4674.0138     -6930.1093      4136.956     
       700   300.87889     -43140.64      -2750.6739     -5279.0045      4136.956     
       800   291.84072     -43155.523     -7364.5133     -6723.9639      4136.956     
       900   282.31317     -43142.67      -6098.6532     -4577.9881      4136.956     
      1000   318.9923      -43159.467      10336.905     -5602.9679      4136.956     
      1100   317.29972     -43151.03       1538.3569     -742.79437      4136.956     
      1200   287.39008     -43143.898     -8397.1094     -2559.1477      4136.956     
      1300   294.58172     -43183.394     -17483.925     -8577.6576      4136.956     
      1400   276.62459     -43158.07      -7565.0832     -4194.1797      4136.956     
      1500   293.75366     -43163.539     -237.06306     -6326.0151      4136.956     
      1600   291.12381     -43146.211     -1407.2289     -2722.2094      4136.956     
      1700   292.6186      -43141.37       9228.1736     -3218.2518      4136.956     
      1800   285.24788     -43128.745     -16553.978     -4855.5803      4136.956     
      1900   313.14035     -43146.168     -3580.0722     -6043.1069      4136.956     
      2000   293.07088     -43117.414      3627.1801     -1489.1419      4136.956     
      2100   315.34865     -43165.812     -4697.851      -4488.2803      4136.956     
      2200   290.84688     -43160.903     -6904.3777     -8091.0849      4136.956     
      2300   281.26309     -43154.971      2248.0998     -8972.0891      4136.956     
      2400   298.65692     -43156.4       -1015.0893     -3092.2442      4136.956     
      2500   318.94728     -43142.488     -11453.432     -7716.4377      4136.956     
      2600   312.81675     -43141.08       2717.309      -2511.0146      4136.956     
      2700   315.98863     -43163.03       1552.6886     -6558.2759      4136.956     
      2800   302.05995     -43162.991      3436.7456     -3523.3625      4136.956     
      2900   302.27659     -43169.834     -1526.4613     -9826.6279      4136.956     
      3000   314.15729     -43180.833      3921.2289     -9698.6155      4136.956     
Loop time of 150.935 on 8 procs for 3000 steps with 371 atoms

Performance: 0.859 ns/day, 27.951 hours/ns, 19.876 timesteps/s, 7.374 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 87.344     | 117.26     | 128.44     | 145.9 | 77.69
Bond    | 0.008356   | 0.008938   | 0.0094954  |   0.4 |  0.01
Neigh   | 6.1894     | 8.1566     | 8.9434     |  37.2 |  5.40
Comm    | 1.6026     | 12.781     | 42.7       | 441.9 |  8.47
Output  | 0.0013737  | 0.0016137  | 0.0029844  |   1.3 |  0.00
Modify  | 11.857     | 12.648     | 14.625     |  30.0 |  8.38
Other   |            | 0.07573    |            |       |  0.05

Nlocal:         46.375 ave          53 max          39 min
Histogram: 1 1 1 1 0 0 0 2 0 2
Nghost:        3399.25 ave        3450 max        3366 min
Histogram: 2 1 1 0 1 0 2 0 0 1
Neighs:        28985.2 ave       32922 max       24657 min
Histogram: 1 1 1 1 0 0 0 2 0 2

Total # of neighbors = 231882
Ave neighs/atom = 625.01887
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 12.6637271378117
variable C2pos equal ${d2}
variable C2pos equal -9.08433842974252
variable C3pos equal ${d3}
variable C3pos equal -18.0523490115978
variable C4pos equal ${d4}
variable C4pos equal 8.6237593249515
variable C5pos equal ${d5}
variable C5pos equal 10.0974175137825
variable C6pos equal ${d6}
variable C6pos equal 0.521064147158591

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(34.4701109025899+${C1pos})
variable C15 equal 0.5*(34.4701109025899+12.6637271378117)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-51.1064266213284+${C2pos})
variable C25 equal 0.5*(-51.1064266213284+-9.08433842974252)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(39.4282490208355+${C3pos})
variable C35 equal 0.5*(39.4282490208355+-18.0523490115978)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(9.42043758342133+${C4pos})
variable C45 equal 0.5*(9.42043758342133+8.6237593249515)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(-10.6845570177159+${C5pos})
variable C55 equal 0.5*(-10.6845570177159+10.0974175137825)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(0.0419213860557969+${C6pos})
variable C65 equal 0.5*(0.0419213860557969+0.521064147158591)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 12.8149

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.8149
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.128149 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.979149 0.4589 0.2054)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.7 | 131.7 | 133.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   295.85779     -43113.032     -5130.3016      0              4136.956     
       100   278.63943     -43109.963     -3405.5089     -4265.0672      4136.956     
       200   290.44894     -43135.555      481.69208     -6235.7704      4136.956     
       300   299.91364     -43144.665     -12668.817     -9942.6343      4136.956     
       400   294.51542     -43127.247      1118.3638     -6220.5324      4136.956     
       500   285.13908     -43113.875     -8899.9006     -3703.3152      4136.956     
       600   302.36744     -43145.03      -15500.798     -7777.366       4136.956     
       700   302.12969     -43163.779     -2656.439      -2412.9932      4136.956     
       800   286.86951     -43157.313     -13216.005     -5684.1339      4136.956     
       900   296.97564     -43160.268     -11708.034      660.97342      4136.956     
      1000   307.89004     -43156.664     -2999.879       1575.515       4136.956     
      1100   289.26136     -43126.783      3618.3423     -4607.8251      4136.956     
      1200   307.63048     -43142.312     -5144.875      -6343.8429      4136.956     
      1300   302.8527      -43139.399     -7474.7125     -8309.4661      4136.956     
      1400   308.4349      -43161.058     -2671.5418     -7628.0782      4136.956     
      1500   295.0374      -43155.367      3825.4235     -5464.8469      4136.956     
      1600   291.81776     -43154.169     -270.11706     -10106.341      4136.956     
      1700   314.38515     -43164.949      1290.6599     -2632.6086      4136.956     
      1800   302.86932     -43134.536     -3937.216      -4923.683       4136.956     
      1900   295.06707     -43126.935     -3566.7268     -5300.1367      4136.956     
      2000   291.54296     -43143.241     -16682.766     -6302.0634      4136.956     
      2100   288.5296      -43159.323     -3699.1549     -6077.6259      4136.956     
      2200   289.21956     -43156.777     -17434.677     -7647.804       4136.956     
      2300   338.99481     -43175.302     -14554.308     -7133.2409      4136.956     
      2400   298.35545     -43122.17       6650.4941     -6168.1427      4136.956     
      2500   309.46468     -43147.034     -12998.946     -7183.9808      4136.956     
      2600   295.46074     -43147.01      -2090.2654     -4403.277       4136.956     
      2700   290.54379     -43144.467     -6789.8206     -8915.3448      4136.956     
      2800   296.30944     -43148.799     -5626.1099     -7234.2119      4136.956     
      2900   295.56094     -43146.053     -10957.158     -7519.0193      4136.956     
      3000   310.90997     -43171.476      6435.9787     -7662.7377      4136.956     
Loop time of 151.976 on 8 procs for 3000 steps with 371 atoms

Performance: 0.853 ns/day, 28.144 hours/ns, 19.740 timesteps/s, 7.324 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 87.998     | 118.29     | 129.33     | 141.4 | 77.83
Bond    | 0.0084577  | 0.0091414  | 0.0097103  |   0.4 |  0.01
Neigh   | 6.1825     | 8.1849     | 8.9293     |  36.2 |  5.39
Comm    | 1.6921     | 12.741     | 43.027     | 430.8 |  8.38
Output  | 0.0073639  | 0.0098922  | 0.012083   |   1.6 |  0.01
Modify  | 11.923     | 12.669     | 14.683     |  29.3 |  8.34
Other   |            | 0.07536    |            |       |  0.05

Nlocal:         46.375 ave          53 max          39 min
Histogram: 2 1 0 0 0 1 1 0 0 3
Nghost:        3404.62 ave        3445 max        3373 min
Histogram: 2 0 0 2 2 0 0 0 0 2
Neighs:        28985.4 ave       32853 max       24727 min
Histogram: 2 1 0 0 1 0 1 0 0 3

Total # of neighbors = 231883
Ave neighs/atom = 625.02156
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.5 | 131.9 | 133.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   310.90997     -43171.476      6435.9705      0              4136.956     
       100   278.88102     -43141.855     -452.07042     -4177.2585      4136.956     
       200   289.00551     -43139.046     -14636.529     -9195.8459      4136.956     
       300   318.25177     -43141.387     -6267.9505     -5958.3916      4136.956     
       400   293.1346      -43122.198     -570.27677     -7668.3106      4136.956     
       500   289.83475     -43146.574      1151.6304     -5515.5998      4136.956     
       600   275.30245     -43146.342      1966.8488     -1312.273       4136.956     
       700   290.68415     -43154.549     -11288.909      215.76571      4136.956     
       800   308.31208     -43155.114     -1707.2638     -9822.1344      4136.956     
       900   319.56339     -43150.799     -10393.167     -7901.4453      4136.956     
      1000   295.21333     -43127.028     -4830.8734     -5321.1956      4136.956     
      1100   279.36822     -43143.603     -18842.282     -9723.5672      4136.956     
      1200   264.20072     -43148.417      2059.0864     -10262.927      4136.956     
      1300   309.00066     -43183.155     -7747.0277     -7485.6528      4136.956     
      1400   289.46054     -43150.473     -11357.45      -5037.9954      4136.956     
      1500   301.81905     -43153.253      4924.2265     -7429.3006      4136.956     
      1600   296.06962     -43138.677      6499.3891      719.73375      4136.956     
      1700   330.59289     -43140.086     -8690.9326     -4006.5487      4136.956     
      1800   320.81544     -43120.437     -13931.131     -7142.2258      4136.956     
      1900   311.92563     -43147.876      4623.3874     -6412.5045      4136.956     
      2000   296.89839     -43152.244     -1949.5524     -7355.1799      4136.956     
      2100   307.8359      -43161.783     -4924.5265     -3097.9481      4136.956     
      2200   301.37459     -43146.781     -1469.4554     -6417.2664      4136.956     
      2300   320.74619     -43159.979      1458.1216     -5534.2488      4136.956     
      2400   300.48768     -43156.263     -1589.4868     -9736.2436      4136.956     
      2500   280.01651     -43161.728     -11168.816     -4620.5728      4136.956     
      2600   295.43732     -43170.732      1606.3065     -1638.9653      4136.956     
      2700   296.89273     -43152.973     -6582.9231     -9054.0763      4136.956     
      2800   313.62653     -43147.981     -5106.9119     -6557.9767      4136.956     
      2900   330.49406     -43158.356     -1411.8967     -1945.5277      4136.956     
      3000   320.92607     -43185.405      251.47419     -4470.0285      4136.956     
Loop time of 142.74 on 8 procs for 3000 steps with 371 atoms

Performance: 0.908 ns/day, 26.433 hours/ns, 21.017 timesteps/s, 7.797 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 82.222     | 106.55     | 121.03     | 155.4 | 74.65
Bond    | 0.0083677  | 0.0085242  | 0.0087691  |   0.2 |  0.01
Neigh   | 6.1842     | 7.9004     | 8.927      |  43.3 |  5.53
Comm    | 1.3195     | 15.798     | 40.13      | 403.6 | 11.07
Output  | 0.0012574  | 0.0014165  | 0.002095   |   0.7 |  0.00
Modify  | 11.374     | 12.41      | 14.134     |  34.7 |  8.69
Other   |            | 0.0722     |            |       |  0.05

Nlocal:         46.375 ave          53 max          38 min
Histogram: 1 0 0 0 3 0 2 0 0 2
Nghost:        3420.38 ave        3459 max        3380 min
Histogram: 1 0 1 2 0 0 1 2 0 1
Neighs:          28990 ave       32755 max       24188 min
Histogram: 1 0 0 1 2 0 2 0 0 2

Total # of neighbors = 231920
Ave neighs/atom = 625.12129
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 40.3149307004837
variable C2neg equal ${d2}
variable C2neg equal 49.791286148366
variable C3neg equal ${d3}
variable C3neg equal 42.408070930032
variable C4neg equal ${d4}
variable C4neg equal -5.17235074633588
variable C5neg equal ${d5}
variable C5neg equal 1.78502255502081
variable C6neg equal ${d6}
variable C6neg equal 9.00081651218336

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.8149
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.128149 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.722851 0.4589 0.2054)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.5 | 130.2 | 131.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   295.85779     -43109.958     -11008.375      0              4136.956     
       100   278.55746     -43107.236     -6643.912      -5300.9092      4136.956     
       200   289.6092      -43135.628     -2974.4527     -3651.0116      4136.956     
       300   314.24654     -43162.048     -3829.9006     -12225.451      4136.956     
       400   286.80657     -43114.546      7996.6864     -2728.9654      4136.956     
       500   303.93613     -43120.687     -3010.7634     -3741.1737      4136.956     
       600   319.24279     -43146.593     -6803.5039     -8988.5207      4136.956     
       700   307.15347     -43157.369     -848.0151      -5523.2534      4136.956     
       800   287.67216     -43159.071      5685.5816     -6285.5742      4136.956     
       900   288.83079     -43156.123      4206.7418     -713.50371      4136.956     
      1000   288.48273     -43127.943     -17999.512     -6828.5792      4136.956     
      1100   300.44211     -43121.83      -10135.588     -6243.6268      4136.956     
      1200   319.85304     -43151.499     -7370.5173     -11138.78       4136.956     
      1300   285.21312     -43145.264     -10351.271     -3605.3814      4136.956     
      1400   278.51171     -43153.093     -9486.338      -5319.5246      4136.956     
      1500   289.67754     -43154.425     -8056.2924     -9124.3727      4136.956     
      1600   301.63375     -43144.061     -9455.3459     -9789.1709      4136.956     
      1700   319.67338     -43154.069     -1994.5616     -6156.5998      4136.956     
      1800   300.1094      -43140.113     -2509.9994     -2910.4605      4136.956     
      1900   294.92617     -43152.083      2137.1897     -8217.6587      4136.956     
      2000   288.53532     -43155.699     -2985.651      -7922.1597      4136.956     
      2100   296.65578     -43159.705      99.374587     -684.91878      4136.956     
      2200   305.26681     -43135.498     -3602.9317      324.2669       4136.956     
      2300   304.51112     -43123.371     -10617.542     -4186.2623      4136.956     
      2400   309.59184     -43135.969     -11576.086     -3398.2903      4136.956     
      2500   305.60161     -43151.486     -13285.472     -1567.7172      4136.956     
      2600   287.64694     -43153.549     -3026.2794     -6222.7388      4136.956     
      2700   294.19937     -43160.899     -6823.5669     -12789.97       4136.956     
      2800   303.76384     -43162.581     -3595.3834     -6614.0425      4136.956     
      2900   294.83427     -43147.378      40.332447     -4401.9779      4136.956     
      3000   304.20704     -43154.012     -5258.5385     -2183.9069      4136.956     
Loop time of 138.532 on 8 procs for 3000 steps with 371 atoms

Performance: 0.936 ns/day, 25.654 hours/ns, 21.656 timesteps/s, 8.034 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 80.081     | 102.65     | 117.25     | 159.3 | 74.10
Bond    | 0.0078727  | 0.0081306  | 0.0083017  |   0.1 |  0.01
Neigh   | 6.0226     | 7.6887     | 8.7391     |  45.6 |  5.55
Comm    | 1.1459     | 15.748     | 38.322     | 406.8 | 11.37
Output  | 0.006319   | 0.0080169  | 0.0091771  |   1.1 |  0.01
Modify  | 11.292     | 12.358     | 14.036     |  36.1 |  8.92
Other   |            | 0.06962    |            |       |  0.05

Nlocal:         46.375 ave          54 max          41 min
Histogram: 2 1 1 0 1 1 0 0 0 2
Nghost:           3363 ave        3437 max        3306 min
Histogram: 1 1 1 1 2 0 0 1 0 1
Neighs:        28982.2 ave       33469 max       25660 min
Histogram: 2 1 1 0 1 1 0 0 0 2

Total # of neighbors = 231858
Ave neighs/atom = 624.95418
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.5 | 130.3 | 131.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   304.20704     -43154.012     -5258.5468      0              4136.956     
       100   302.34078     -43154.009     -9639.9187     -6915.9771      4136.956     
       200   289.07559     -43160.62      -11268.165     -7623.6255      4136.956     
       300   287.30218     -43186.268     -9167.2044     -11117.088      4136.956     
       400   291.5486      -43179.97      -8805.1064     -5556.2469      4136.956     
       500   290.09815     -43155.096     -9338.0399     -9577.2176      4136.956     
       600   299.13219     -43154.214     -4565.2687     -11269.576      4136.956     
       700   286.04568     -43146.203     -7701.7927     -6162.0787      4136.956     
       800   294.7688      -43162.137     -9163.371      -10621.23       4136.956     
       900   296.75233     -43184.729     -5591.1577     -7493.6171      4136.956     
      1000   278.69014     -43191.898      2467.9037     -3592.6293      4136.956     
      1100   276.26025     -43176.241     -4891.081      -2687.5877      4136.956     
      1200   302.71755     -43176.022     -15852.899     -10438.128      4136.956     
      1300   304.83931     -43168.288     -8011.6203     -8545.864       4136.956     
      1400   296.84004     -43151.146     -11625.637     -7399.7549      4136.956     
      1500   296.14127     -43136.43      -9405.7697     -7089.6369      4136.956     
      1600   326.06665     -43160.88      -14703.263     -7580.7313      4136.956     
      1700   308.40283     -43158.842      5605.2166     -7305.1749      4136.956     
      1800   306.8959      -43186.092     -6344.5463     -7449.4392      4136.956     
      1900   296.06537     -43179.532     -5041.0293     -9118.6252      4136.956     
      2000   300.05129     -43164.754     -8109.1322     -11456.221      4136.956     
      2100   306.67992     -43140.194     -12591.159     -4223.3532      4136.956     
      2200   307.68459     -43147.953     -8566.8719     -5014.4464      4136.956     
      2300   290.48612     -43143.199     -7787.8165     -7193.9458      4136.956     
      2400   301.1261      -43156.454     -10776.735     -8117.4139      4136.956     
      2500   289.6259      -43162.427     -11336.489     -6883.2635      4136.956     
      2600   299.14976     -43195.09      -1533.3166     -9429.2317      4136.956     
      2700   310.66465     -43205.008     -9538.028      -8518.544       4136.956     
      2800   313.43905     -43167.468     -12940.959     -11005.579      4136.956     
      2900   308.5595      -43149.141     -8632.1863     -5709.7981      4136.956     
      3000   294.18977     -43137.237     -5771.7141     -9728.4212      4136.956     
Loop time of 103.868 on 8 procs for 3000 steps with 371 atoms

Performance: 1.248 ns/day, 19.235 hours/ns, 28.883 timesteps/s, 10.716 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 76.82      | 80.248     | 86.618     |  37.1 | 77.26
Bond    | 0.007107   | 0.0077109  | 0.008808   |   0.6 |  0.01
Neigh   | 5.99       | 6.2726     | 6.9045     |  13.0 |  6.04
Comm    | 1.1674     | 7.5324     | 10.961     | 121.1 |  7.25
Output  | 0.0012372  | 0.001382   | 0.0019079  |   0.5 |  0.00
Modify  | 9.0925     | 9.7368     | 10.023     |  10.6 |  9.37
Other   |            | 0.06896    |            |       |  0.07

Nlocal:         46.375 ave          53 max          37 min
Histogram: 1 1 0 0 0 2 1 0 1 2
Nghost:           3350 ave        3406 max        3306 min
Histogram: 2 0 0 3 0 0 1 1 0 1
Neighs:        28990.8 ave       32855 max       23488 min
Histogram: 1 1 0 0 0 2 1 0 1 2

Total # of neighbors = 231926
Ave neighs/atom = 625.13747
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 12.9657333679164
variable C2pos equal ${d2}
variable C2pos equal 8.1305006161058
variable C3pos equal ${d3}
variable C3pos equal -35.1282248973044
variable C4pos equal ${d4}
variable C4pos equal -4.99099341154109
variable C5pos equal ${d5}
variable C5pos equal 2.66770566980132
variable C6pos equal ${d6}
variable C6pos equal 1.91969234507009

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(40.3149307004837+${C1pos})
variable C16 equal 0.5*(40.3149307004837+12.9657333679164)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(49.791286148366+${C2pos})
variable C26 equal 0.5*(49.791286148366+8.1305006161058)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(42.408070930032+${C3pos})
variable C36 equal 0.5*(42.408070930032+-35.1282248973044)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-5.17235074633588+${C4pos})
variable C46 equal 0.5*(-5.17235074633588+-4.99099341154109)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(1.78502255502081+${C5pos})
variable C56 equal 0.5*(1.78502255502081+2.66770566980132)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(9.00081651218336+${C6pos})
variable C66 equal 0.5*(9.00081651218336+1.91969234507009)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 39.9078451719091
variable C22all equal ${C22}
variable C22all equal 34.0623592412564
variable C33all equal ${C33}
variable C33all equal 28.369496257095

variable C44all equal ${C44}
variable C44all equal -5.705299419554
variable C55all equal ${C55}
variable C55all equal -0.2935697519667
variable C66all equal ${C66}
variable C66all equal 5.46025442862672

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(3.1634018317014+${C21})
variable C12all equal 0.5*(3.1634018317014+22.0379085343401)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(-0.242809362459949+${C31})
variable C13all equal 0.5*(-0.242809362459949+-9.97959419188353)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(17.8501141662087+${C32})
variable C23all equal 0.5*(17.8501141662087+-3.42477352953105)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(42.6093136921793+${C41})
variable C14all equal 0.5*(42.6093136921793+-5.28676477270643)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(23.5669190202008+${C51})
variable C15all equal 0.5*(23.5669190202008+0.1979468347693)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(26.6403320342+${C61})
variable C16all equal 0.5*(26.6403320342+-2.21699793054032)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(4.18529767510739+${C42})
variable C24all equal 0.5*(4.18529767510739+-3.08760083463077)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-30.0953825255355+${C52})
variable C25all equal 0.5*(-30.0953825255355+-2.19854983424677)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(28.9608933822359+${C62})
variable C26all equal 0.5*(28.9608933822359+0.13101813928914)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(2.81456789102285+${C43})
variable C34all equal 0.5*(2.81456789102285+-6.34221253426251)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(10.6879500046189+${C53})
variable C35all equal 0.5*(10.6879500046189+-5.69547825454067)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(3.6399230163638+${C63})
variable C36all equal 0.5*(3.6399230163638+5.29422201427863)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(9.02209845418642+${C54})
variable C45all equal 0.5*(9.02209845418642+4.67411741342305)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-5.08167207893849+${C64})
variable C46all equal 0.5*(-5.08167207893849+-0.835912345956575)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(2.22636411241107+${C65})
variable C56all equal 0.5*(2.22636411241107+0.281492766607194)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 1:02:26
