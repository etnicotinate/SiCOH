LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-14-vasp
read_data       ${structure}.data
read_data       333U-50C-14-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.006 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.865 | 6.865 | 6.865 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              330.86992      3656.0256    
         1   300            0              0              330.86992      3656.0256    
Loop time of 5.33472e-05 on 16 procs for 1 steps with 371 atoms

64.9% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 3.87e-07   | 6.9375e-07 | 8.42e-07   |   0.0 |  1.30
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 1.582e-06  | 2.137e-06  | 2.605e-06  |   0.0 |  4.01
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 5.052e-05  |            |       | 94.69

Nlocal:         46.375 ave          56 max          42 min
Histogram: 5 0 0 0 0 1 0 1 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -4.92 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.4 | 133.5 | 134.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -41361.517      76779.476      0              1.6093426      4136.956     
       100   771.66802     -42324.661     -1681.0458     -2230.6232      1.6093426      4136.956     
       200   541.55246     -42531.365     -7664.8908     -4534.5137      1.6093426      4136.956     
       300   452.90604     -42766.933     -897.93218      50.658177      1.6093426      4136.956     
       400   375.56004     -42905.514     -5460.8109     -8165.0058      1.6093426      4136.956     
       500   316.59196     -42983.663      5399.9887     -531.06879      1.6093426      4136.956     
       600   281.72963     -43028.906     -3387.4831      1125.4114      1.6093426      4136.956     
       700   288.9727      -43076.387     -12633.033     -5248.3809      1.6093426      4136.956     
       800   276.08019     -43058.119     -7081.7796     -3420.2758      1.6093426      4136.956     
       900   312.29936     -43069.947      3943.3165     -6040.2866      1.6093426      4136.956     
      1000   318.58427     -43069.829     -5928.7228     -4228.8343      1.6093426      4136.956     
      1100   326.07714     -43085.389     -6331.9825     -12028.349      1.6093426      4136.956     
      1200   304.27019     -43081.5        5189.1811     -5851.0467      1.6093426      4136.956     
      1300   289.98539     -43098.264     -9655.9357     -5570.6112      1.6093426      4136.956     
      1400   273.6763      -43087.047     -9781.4062     -6035.8693      1.6093426      4136.956     
      1500   290.18633     -43090.197     -15294.479     -6623.1557      1.6093426      4136.956     
      1600   326.37526     -43117.009     -14725.53      -9297.2458      1.6093426      4136.956     
      1700   283.83458     -43069.479     -1755.6095     -10965.336      1.6093426      4136.956     
      1800   308.70731     -43107.974     -14654.115     -5837.0227      1.6093426      4136.956     
      1900   300.98888     -43114.266     -10522.375     -7464.6504      1.6093426      4136.956     
      2000   290.15392     -43107.817     -9307.6599     -4640.1242      1.6093426      4136.956     
Loop time of 101.678 on 16 procs for 2000 steps with 371 atoms

Performance: 0.850 ns/day, 28.244 hours/ns, 19.670 timesteps/s, 7.298 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 76.808     | 77.448     | 78.271     |   4.8 | 76.17
Bond    | 0.00073589 | 0.0008223  | 0.00095263 |   0.0 |  0.00
Neigh   | 5.4161     | 5.5133     | 5.6744     |   3.3 |  5.42
Comm    | 8.2249     | 9.0402     | 9.7043     |  13.9 |  8.89
Output  | 0.0011239  | 0.0013302  | 0.00266    |   1.4 |  0.00
Modify  | 9.0886     | 9.3011     | 9.4551     |   3.6 |  9.15
Other   |            | 0.3732     |            |       |  0.37

Nlocal:         46.375 ave          57 max          36 min
Histogram: 1 0 0 1 3 1 0 1 0 1
Nghost:        3391.88 ave        3434 max        3345 min
Histogram: 2 0 1 1 0 0 0 0 2 2
Neighs:        29024.4 ave       35521 max       22714 min
Histogram: 1 0 0 1 3 1 0 1 0 1

Total # of neighbors = 232195
Ave neighs/atom = 625.86253
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-14-vasp_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 17.3186
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 12.8149
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 18.6403

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--4640.12424504188)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--4640.12424504188)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--2967.31513121554)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--2967.31513121554)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--7478.63252903687)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--7478.63252903687)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--264.627318629224)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--264.627318629224)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-4135.3095829716)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1-4135.3095829716)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--3555.99801886744)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--3555.99801886744)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 17.3186
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.3186
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.173186 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.173186 xy delta 0.08851 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.173186 xy delta 0.08851 xz delta -0.004589 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.145414 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.145414 12.8149 18.6403) with tilt (-8.76249 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.145414 12.8149 18.6403) with tilt (-8.76249 0.454311 0.2054)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.5 | 134 | 135.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.15392     -43093.389      40911.034      0              4095.5864    
       100   292.73679     -43100.389      1159.6538      3101.7022      4095.5864    
       200   293.92171     -43109.185     -4198.8113     -2113.7861      4095.5864    
       300   300.67564     -43124.219     -700.33078     -8950.2737      4095.5864    
       400   304.75316     -43133.036     -4084.8143     -9803.7884      4095.5864    
       500   300.01781     -43139.155     -10090.78      -5681.5743      4095.5864    
       600   295.52313     -43142.617     -358.71141      93.850042      4095.5864    
       700   280.6738      -43115.975     -6248.4299     -5053.5411      4095.5864    
       800   309.28318     -43127.659     -18090.126     -8306.1419      4095.5864    
       900   312.69238     -43128.683     -17669.477     -827.60881      4095.5864    
      1000   289.58275     -43121.86      -4977.4609     -5742.5597      4095.5864    
      1100   289.97749     -43142.818     -11312.328     -6929.186       4095.5864    
      1200   285.4252      -43147.998     -907.48979     -858.65669      4095.5864    
      1300   317.27327     -43172.404      871.19749     -1648.6697      4095.5864    
      1400   302.13042     -43150.898     -8135.7485     -1585.8463      4095.5864    
      1500   293.47711     -43136.488      13109.089     -1476.0951      4095.5864    
      1600   308.38894     -43150.335     -9405.4688     -456.23765      4095.5864    
      1700   293.21283     -43139.974      141.64901      1630.558       4095.5864    
      1800   294.46753     -43146.681     -840.08966     -5448.3022      4095.5864    
      1900   307.28323     -43145.054     -9778.081      -4180.1795      4095.5864    
      2000   298.29299     -43120.924      47.108785     -2514.2176      4095.5864    
Loop time of 103.727 on 16 procs for 2000 steps with 371 atoms

Performance: 0.833 ns/day, 28.813 hours/ns, 19.281 timesteps/s, 7.153 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 77.053     | 79.535     | 81.431     |  16.8 | 76.68
Bond    | 0.00068025 | 0.00077285 | 0.00092441 |   0.0 |  0.00
Neigh   | 5.4483     | 5.5445     | 5.6535     |   3.2 |  5.35
Comm    | 7.1263     | 9.009      | 11.486     |  49.9 |  8.69
Output  | 0.0067207  | 0.0097019  | 0.01123    |   1.7 |  0.01
Modify  | 9.1862     | 9.3064     | 9.4182     |   2.7 |  8.97
Other   |            | 0.3211     |            |       |  0.31

Nlocal:         46.375 ave          54 max          38 min
Histogram: 1 1 0 1 1 1 0 1 0 2
Nghost:        3383.12 ave        3419 max        3335 min
Histogram: 1 0 1 1 0 0 2 1 0 2
Neighs:        29309.6 ave       34052 max       24133 min
Histogram: 1 0 1 1 1 1 0 1 0 2

Total # of neighbors = 234477
Ave neighs/atom = 632.01348
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.5 | 134 | 135.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   298.29299     -43120.924      47.116481      0              4095.5864    
       100   311.79954     -43146.766     -1304.6012      686.1383       4095.5864    
       200   286.35861     -43148.786     -6298.5587     -7228.4597      4095.5864    
       300   279.81143     -43152.447      11360.579     -5281.4638      4095.5864    
       400   296.31827     -43158.493     -15645.531     -1139.6374      4095.5864    
       500   303.25699     -43158.971      5537.3511      116.28191      4095.5864    
       600   284.18102     -43136.183     -2618.2075      490.43647      4095.5864    
       700   313.43245     -43149.396     -5311.8428     -4563.7542      4095.5864    
       800   330.98242     -43143.138     -1439.4507     -1117.4652      4095.5864    
       900   313.49477     -43130.281     -4697.9438     -3612.1331      4095.5864    
      1000   293.42517     -43150.133     -7535.5423     -4534.302       4095.5864    
      1100   290.96442     -43154.847     -9463.0465     -3621.6742      4095.5864    
      1200   309.29952     -43169.824      7228.4212     -736.9968       4095.5864    
      1300   294.76069     -43140.278      1626.2108     -2615.7944      4095.5864    
      1400   306.93215     -43134.101      11638.637     -3188.8239      4095.5864    
      1500   306.03687     -43130.48       3102.6102      1001.0261      4095.5864    
      1600   288.79336     -43139.709      1939.1722     -5291.3868      4095.5864    
      1700   309.36097     -43182.624      903.68156     -2339.5133      4095.5864    
      1800   300.6543      -43171.487     -9687.417      -3078.311       4095.5864    
      1900   311.53023     -43166.324     -4178.9668     -2519.3986      4095.5864    
      2000   310.31256     -43129.563     -3585.1291     -4378.9491      4095.5864    
Loop time of 103.789 on 16 procs for 2000 steps with 371 atoms

Performance: 0.832 ns/day, 28.830 hours/ns, 19.270 timesteps/s, 7.149 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 78.26      | 79.55      | 81.403     |  13.8 | 76.65
Bond    | 0.00067075 | 0.00076828 | 0.00091344 |   0.0 |  0.00
Neigh   | 5.5006     | 5.6104     | 5.7702     |   3.9 |  5.41
Comm    | 7.0742     | 8.9584     | 10.245     |  41.3 |  8.63
Output  | 0.00093062 | 0.0011188  | 0.0021981  |   1.2 |  0.00
Modify  | 9.1153     | 9.3171     | 9.4534     |   3.1 |  8.98
Other   |            | 0.3511     |            |       |  0.34

Nlocal:         46.375 ave          58 max          32 min
Histogram: 1 0 0 1 1 2 1 0 0 2
Nghost:        3398.62 ave        3452 max        3353 min
Histogram: 1 2 1 0 0 1 1 0 0 2
Neighs:        29298.2 ave       36526 max       20384 min
Histogram: 1 0 0 1 1 2 1 0 0 2

Total # of neighbors = 234386
Ave neighs/atom = 631.76819
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 2.64635703095106
variable C2neg equal ${d2}
variable C2neg equal -14.3699023902153
variable C3neg equal ${d3}
variable C3neg equal 55.31527108936
variable C4neg equal ${d4}
variable C4neg equal 30.2878586756738
variable C5neg equal ${d5}
variable C5neg equal -15.1652477374363
variable C6neg equal ${d6}
variable C6neg equal -12.9068048693553

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.3186
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.173186 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.173186 xy delta -0.08851 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.173186 xy delta -0.08851 xz delta 0.004589 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.491786 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.491786 12.8149 18.6403) with tilt (-8.93951 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.491786 12.8149 18.6403) with tilt (-8.93951 0.463489 0.2054)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.7 | 131.7 | 133.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.15392     -43082.694     -50330.271      0              4178.3256    
       100   289.78118     -43086.265      4787.0318     -6284.9628      4178.3256    
       200   309.07396     -43120.699     -5954.9326     -6540.3564      4178.3256    
       300   273.49888     -43105.262     -11971.087     -14307.345      4178.3256    
       400   304.7207      -43136.3        7877.3904     -14343.971      4178.3256    
       500   291.62146     -43113.456     -14735.234     -4394.7297      4178.3256    
       600   275.17236     -43087.312     -977.26078     -5163.8272      4178.3256    
       700   312.83815     -43115.402     -2431.4329     -8133.9705      4178.3256    
       800   302.24089     -43105.67      -3184.6017     -7266.4244      4178.3256    
       900   316.09217     -43135.831     -16080.286     -6161.2026      4178.3256    
      1000   296.52252     -43126.132     -11857.673     -10621.454      4178.3256    
      1100   317.96315     -43152.483     -10339.473     -12964.537      4178.3256    
      1200   291.79987     -43123.278      807.27171     -4216.7849      4178.3256    
      1300   293.87711     -43122.865     -7846.2309     -9187.7403      4178.3256    
      1400   294.58743     -43115.994     -6899.5237     -6861.3928      4178.3256    
      1500   297.31017     -43110.69      -3036.3374     -4547.4342      4178.3256    
      1600   319.90784     -43131.579     -1711.3513     -5235.9325      4178.3256    
      1700   300.11639     -43110.271     -16919.728     -10263.682      4178.3256    
      1800   321.06532     -43140.239     -11328.398     -15371.437      4178.3256    
      1900   301.30974     -43139.346     -11079.768     -8699.6144      4178.3256    
      2000   291.85435     -43137.793     -12534.478     -9692.7156      4178.3256    
Loop time of 102.006 on 16 procs for 2000 steps with 371 atoms

Performance: 0.847 ns/day, 28.335 hours/ns, 19.607 timesteps/s, 7.274 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 76.399     | 78.189     | 80.637     |  16.5 | 76.65
Bond    | 0.00067533 | 0.00077879 | 0.00085934 |   0.0 |  0.00
Neigh   | 5.3863     | 5.5408     | 5.6753     |   4.2 |  5.43
Comm    | 6.1641     | 8.6773     | 10.534     |  50.8 |  8.51
Output  | 0.0069716  | 0.012118   | 0.014368   |   2.7 |  0.01
Modify  | 8.9672     | 9.1331     | 9.3415     |   4.4 |  8.95
Other   |            | 0.4526     |            |       |  0.44

Nlocal:         46.375 ave          55 max          40 min
Histogram: 1 1 0 3 1 0 0 0 1 1
Nghost:        3356.88 ave        3409 max        3321 min
Histogram: 2 1 0 2 1 0 0 0 0 2
Neighs:        28748.1 ave       33852 max       24790 min
Histogram: 1 1 0 3 1 0 0 0 1 1

Total # of neighbors = 229985
Ave neighs/atom = 619.90566
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.8 | 131.7 | 133.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.85435     -43137.793     -12534.42       0              4178.3256    
       100   303.3513      -43141.69      -6355.3748     -11807          4178.3256    
       200   307.85746     -43120.972     -5953.4046     -11397.095      4178.3256    
       300   305.36126     -43089.583     -1851.9534     -11528.067      4178.3256    
       400   316.18819     -43118.353     -1199.9688     -5437.7817      4178.3256    
       500   295.78649     -43111.466     -5253.1494     -11099.854      4178.3256    
       600   294.44083     -43116.476     -22058.461     -16045.127      4178.3256    
       700   290.07218     -43127.776     -12534.41      -9335.2556      4178.3256    
       800   293.94032     -43147.619     -8464.3258     -11157.121      4178.3256    
       900   290.55624     -43159.561     -13040.188     -8293.8853      4178.3256    
      1000   278.1616      -43149.403     -18492.824     -10891.954      4178.3256    
      1100   301.96797     -43139.922     -5297.0189     -10144.673      4178.3256    
      1200   303.43987     -43129.949     -10793.547     -8070.8821      4178.3256    
      1300   304.27758     -43128.903     -3799.5307     -6150.9218      4178.3256    
      1400   300.55437     -43118.423     -5921.8409     -5121.2143      4178.3256    
      1500   293.77556     -43110.788     -1447.8232     -3929.4303      4178.3256    
      1600   306.47506     -43143.91      -14774.573     -11386.449      4178.3256    
      1700   291.97753     -43149.398     -19963.054     -9666.2005      4178.3256    
      1800   293.88795     -43151.014     -18693.95      -11318.368      4178.3256    
      1900   298.88658     -43133.437     -4403.6959     -6674.374       4178.3256    
      2000   314.96492     -43121.824     -334.95874     -4673.4893      4178.3256    
Loop time of 102.157 on 16 procs for 2000 steps with 371 atoms

Performance: 0.846 ns/day, 28.377 hours/ns, 19.578 timesteps/s, 7.263 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 76.853     | 78.306     | 80.91      |  15.6 | 76.65
Bond    | 0.00066811 | 0.0007776  | 0.00085854 |   0.0 |  0.00
Neigh   | 5.3508     | 5.6132     | 5.9778     |   7.4 |  5.49
Comm    | 6.1302     | 8.7636     | 10.276     |  47.3 |  8.58
Output  | 0.00093555 | 0.0011461  | 0.0023304  |   1.3 |  0.00
Modify  | 8.7669     | 9.0843     | 9.3365     |   5.9 |  8.89
Other   |            | 0.3881     |            |       |  0.38

Nlocal:         46.375 ave          59 max          39 min
Histogram: 2 1 1 1 1 0 0 0 1 1
Nghost:         3352.5 ave        3424 max        3275 min
Histogram: 1 1 1 1 0 0 0 1 2 1
Neighs:        28719.1 ave       36302 max       24227 min
Histogram: 2 1 2 0 1 0 0 0 1 1

Total # of neighbors = 229753
Ave neighs/atom = 619.28032
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 0.338071093046392
variable C2pos equal ${d2}
variable C2pos equal 14.7508127941739
variable C3pos equal ${d3}
variable C3pos equal -61.0739224343385
variable C4pos equal ${d4}
variable C4pos equal -19.057177405547
variable C5pos equal ${d5}
variable C5pos equal 4.86618427034098
variable C6pos equal ${d6}
variable C6pos equal 15.8287938490546

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(2.64635703095106+${C1pos})
variable C11 equal 0.5*(2.64635703095106+0.338071093046392)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(-14.3699023902153+${C2pos})
variable C21 equal 0.5*(-14.3699023902153+14.7508127941739)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(55.31527108936+${C3pos})
variable C31 equal 0.5*(55.31527108936+-61.0739224343385)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(30.2878586756738+${C4pos})
variable C41 equal 0.5*(30.2878586756738+-19.057177405547)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(-15.1652477374363+${C5pos})
variable C51 equal 0.5*(-15.1652477374363+4.86618427034098)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-12.9068048693553+${C6pos})
variable C61 equal 0.5*(-12.9068048693553+15.8287938490546)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 12.8149
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.8149
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.128149 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.128149 yz delta -0.002054 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.686751 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.686751 18.6403) with tilt (-8.851 0.4589 0.203346)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.5 | 134.5 | 135.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.15392     -43099.79       37957.165      0              4095.5864    
       100   290.06384     -43099.573      6252.0953     -691.14542      4095.5864    
       200   303.81037     -43110.951     -22378.372     -5803.4436      4095.5864    
       300   301.42825     -43113.238     -3994.9585     -11026.49       4095.5864    
       400   295.49813     -43117.249     -890.44238     -14166.759      4095.5864    
       500   286.61257     -43123.308      543.65253     -3159.4937      4095.5864    
       600   296.47745     -43135.044     -2583.5162     -1749.6911      4095.5864    
       700   305.76433     -43129.017     -8950.5824     -6546.4515      4095.5864    
       800   312.92441     -43120.261      327.52778     -4060.4896      4095.5864    
       900   331.08172     -43134.001     -16163.139     -2734.8459      4095.5864    
      1000   304.88038     -43125.885     -3831.2408     -2227.8879      4095.5864    
      1100   297.02153     -43140.908      10990.446     -5450.2067      4095.5864    
      1200   294.20316     -43158.785      11203.463     -2237.3901      4095.5864    
      1300   294.83384     -43164.582     -4136.2572     -9814.735       4095.5864    
      1400   307.20677     -43156.303     -5754.1489     -3108.5457      4095.5864    
      1500   306.63949     -43127.559     -10769.515      1751.5428      4095.5864    
      1600   299.97037     -43109.835     -6551.5809     -7615.8761      4095.5864    
      1700   302.97677     -43129.15      -2799.3077     -6250.9358      4095.5864    
      1800   306.35096     -43151.852     -474.52488     -7883.6425      4095.5864    
      1900   288.95116     -43139.923      3310.943      -2801.4665      4095.5864    
      2000   312.05615     -43162.578     -1525.6199     -6308.8482      4095.5864    
Loop time of 104.262 on 16 procs for 2000 steps with 371 atoms

Performance: 0.829 ns/day, 28.962 hours/ns, 19.182 timesteps/s, 7.117 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 78.719     | 80.223     | 82.831     |  14.0 | 76.94
Bond    | 0.00068913 | 0.00077474 | 0.00087536 |   0.0 |  0.00
Neigh   | 5.5647     | 5.7385     | 6.0577     |   6.1 |  5.50
Comm    | 6.0205     | 8.691      | 10.186     |  43.3 |  8.34
Output  | 0.0060841  | 0.0099391  | 0.011743   |   2.2 |  0.01
Modify  | 8.8718     | 9.2569     | 9.4684     |   6.1 |  8.88
Other   |            | 0.3416     |            |       |  0.33

Nlocal:         46.375 ave          54 max          40 min
Histogram: 2 0 2 1 0 0 0 0 1 2
Nghost:        3437.25 ave        3484 max        3370 min
Histogram: 1 0 1 1 1 0 0 0 2 2
Neighs:        29322.4 ave       33943 max       25335 min
Histogram: 2 0 1 2 0 0 0 0 1 2

Total # of neighbors = 234579
Ave neighs/atom = 632.28841
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.5 | 134.5 | 136 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.05615     -43162.577     -1525.5896      0              4095.5864    
       100   295.57915     -43151.102      3433.254      -3452.6042      4095.5864    
       200   284.54286     -43144.274     -10015.519     -4086.9126      4095.5864    
       300   284.17493     -43124.001     -201.86581     -6148.0903      4095.5864    
       400   306.46886     -43122.752     -2883.1355      834.7495       4095.5864    
       500   312.07992     -43136.866     -15305.677     -7503.438       4095.5864    
       600   294.94848     -43143.45       9016.8512     -7714.2924      4095.5864    
       700   295.39793     -43156.299     -20201.934     -1937.8414      4095.5864    
       800   300.53823     -43167.674     -17180.084     -4808.1863      4095.5864    
       900   302.93917     -43159.64      -12129.098     -8319.3343      4095.5864    
      1000   300.38107     -43144.854     -15025.354     -6509.3526      4095.5864    
      1100   304.34234     -43152.467      628.94622     -9870.5644      4095.5864    
      1200   278.31936     -43170.231     -8464.5623     -9104.5519      4095.5864    
      1300   283.93883     -43184.036     -7851.0201     -7012.2055      4095.5864    
      1400   297.83623     -43175.927     -12555.968     -7640.301       4095.5864    
      1500   309.89729     -43165.534      1634.4074     -5234.8924      4095.5864    
      1600   292.87965     -43139.143     -8942.1112     -7610.8464      4095.5864    
      1700   305.61141     -43160.31      -7667.6088     -2931.5967      4095.5864    
      1800   284.0505      -43174.483     -15912.125     -4248.8981      4095.5864    
      1900   304.26121     -43196.822     -12669.115     -13529.076      4095.5864    
      2000   277.79529     -43155.029     -23448.325     -8160.8825      4095.5864    
Loop time of 104.906 on 16 procs for 2000 steps with 371 atoms

Performance: 0.824 ns/day, 29.140 hours/ns, 19.065 timesteps/s, 7.073 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 78.527     | 80.521     | 82.363     |  12.4 | 76.76
Bond    | 0.00070948 | 0.00077626 | 0.00085276 |   0.0 |  0.00
Neigh   | 5.5198     | 5.6474     | 5.8162     |   4.3 |  5.38
Comm    | 7.1813     | 9.0538     | 11.108     |  37.9 |  8.63
Output  | 0.00087241 | 0.0011321  | 0.0026894  |   1.8 |  0.00
Modify  | 9.0715     | 9.2724     | 9.4595     |   4.5 |  8.84
Other   |            | 0.4093     |            |       |  0.39

Nlocal:         46.375 ave          54 max          38 min
Histogram: 2 0 0 0 1 2 0 1 1 1
Nghost:        3450.75 ave        3496 max        3399 min
Histogram: 1 0 0 2 1 0 2 0 1 1
Neighs:        29294.8 ave       33941 max       24081 min
Histogram: 2 0 0 0 1 2 0 1 1 1

Total # of neighbors = 234358
Ave neighs/atom = 631.69272
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -35.6740827797397
variable C2neg equal ${d2}
variable C2neg equal -35.2609774489312
variable C3neg equal ${d3}
variable C3neg equal 31.783518983892
variable C4neg equal ${d4}
variable C4neg equal 10.5622814361643
variable C5neg equal ${d5}
variable C5neg equal -17.8497580210796
variable C6neg equal ${d6}
variable C6neg equal 7.22972041553682

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.8149
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.128149 yz delta ${deltayz} remap units box
change_box all y delta 0 0.128149 yz delta 0.002054 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.943049 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.943049 18.6403) with tilt (-8.851 0.4589 0.207454)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129 | 131.1 | 132.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.15392     -43082.375     -45411.815      0              4178.3256    
       100   291.48086     -43088.221     -959.1064      -3314.5381      4178.3256    
       200   294.82595     -43103.376     -6615.1842     -5200.7003      4178.3256    
       300   269.25514     -43094.428     -23895.524     -13424.093      4178.3256    
       400   299.69256     -43130.814     -4206.8495     -12090.954      4178.3256    
       500   330.71208     -43165.481     -5169.6558      960.20714      4178.3256    
       600   308.65526     -43141.46       8670.8133     -2448.2197      4178.3256    
       700   302.03296     -43131.623     -2603.7142     -6198.1594      4178.3256    
       800   298.48722     -43128.156     -6006.9429     -4735.1888      4178.3256    
       900   302.52287     -43134.377     -6408.4594     -9803.4769      4178.3256    
      1000   309.11256     -43135.873     -16239.127     -5610.7159      4178.3256    
      1100   297.11712     -43111.566     -4995.7694     -13674.399      4178.3256    
      1200   301.69242     -43117.8       -2313.9333     -8353.4697      4178.3256    
      1300   296.17447     -43135.241     -4768.2676     -11159.911      4178.3256    
      1400   284.98341     -43143.386     -6852.8756     -5181.8985      4178.3256    
      1500   275.02527     -43135.403     -13804.144     -9078.3238      4178.3256    
      1600   291.18663     -43129.758     -12090.473     -10914.09       4178.3256    
      1700   300.9505      -43119.673     -1711.614      -7151.9582      4178.3256    
      1800   326.90899     -43139.111     -8005.0367     -8153.645       4178.3256    
      1900   304.21576     -43132.244     -14919.061     -11414.884      4178.3256    
      2000   307.00274     -43160.232     -8489.1919     -8643.48        4178.3256    
Loop time of 100.913 on 16 procs for 2000 steps with 371 atoms

Performance: 0.856 ns/day, 28.031 hours/ns, 19.819 timesteps/s, 7.353 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 76.183     | 77.476     | 79.125     |   9.4 | 76.77
Bond    | 0.0006614  | 0.00076713 | 0.00088543 |   0.0 |  0.00
Neigh   | 5.3321     | 5.4585     | 5.6093     |   4.3 |  5.41
Comm    | 6.8062     | 8.4913     | 9.7987     |  28.6 |  8.41
Output  | 0.0065389  | 0.010049   | 0.011752   |   2.0 |  0.01
Modify  | 8.8793     | 9.1171     | 9.295      |   4.5 |  9.03
Other   |            | 0.3597     |            |       |  0.36

Nlocal:         46.375 ave          54 max          36 min
Histogram: 1 0 0 2 0 2 0 1 0 2
Nghost:         3345.5 ave        3391 max        3303 min
Histogram: 4 0 0 0 0 0 0 1 1 2
Neighs:        28705.6 ave       33410 max       22415 min
Histogram: 1 0 0 0 3 1 0 1 0 2

Total # of neighbors = 229645
Ave neighs/atom = 618.98922
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129 | 131.1 | 132.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   307.00274     -43160.232     -8489.1888      0              4178.3256    
       100   294.54082     -43139.495      551.10766     -1676.9403      4178.3256    
       200   311.95518     -43137.46      -4330.5759     -8361.5649      4178.3256    
       300   297.69696     -43094.009     -15516.151     -13917.572      4178.3256    
       400   301.96914     -43101.498     -15302.948     -9787.7589      4178.3256    
       500   281.76806     -43123.099     -11482.876     -5776.132       4178.3256    
       600   286.81847     -43129.363     -10668.871     -6357.3022      4178.3256    
       700   290.39254     -43127.279     -5447.8048     -4917.4645      4178.3256    
       800   316.7459      -43130.207     -13593.568     -6577.8486      4178.3256    
       900   301.37669     -43104.224     -4387.6135     -8131.2673      4178.3256    
      1000   308.50772     -43130.166     -3070.8532     -5486.4092      4178.3256    
      1100   296.6987      -43152.125     -7231.0469     -7966.244       4178.3256    
      1200   283.09421     -43131.812     -9202.341      -8691.0124      4178.3256    
      1300   301.69743     -43130.46      -13877.78      -4865.5343      4178.3256    
      1400   313.66347     -43137.818     -3677.376      -7130.2242      4178.3256    
      1500   292.39902     -43137.792     -11301.539     -7433.594       4178.3256    
      1600   284.50448     -43159.076     -11169.62      -6272.2877      4178.3256    
      1700   281.23461     -43147.611     -767.20341     -1717.894       4178.3256    
      1800   307.85727     -43158.626     -10540.225     -3513.9364      4178.3256    
      1900   307.63477     -43145.146     -15475.285     -7178.3341      4178.3256    
      2000   314.88515     -43142.013     -15910.986     -12264.39       4178.3256    
Loop time of 101.781 on 16 procs for 2000 steps with 371 atoms

Performance: 0.849 ns/day, 28.272 hours/ns, 19.650 timesteps/s, 7.290 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 75.922     | 77.785     | 80.764     |  16.2 | 76.42
Bond    | 0.00065266 | 0.00075964 | 0.00086605 |   0.0 |  0.00
Neigh   | 5.2988     | 5.4969     | 5.6633     |   5.8 |  5.40
Comm    | 5.8085     | 8.845      | 10.756     |  48.8 |  8.69
Output  | 0.0009366  | 0.0013959  | 0.0043848  |   3.0 |  0.00
Modify  | 8.9985     | 9.1779     | 9.4342     |   5.2 |  9.02
Other   |            | 0.4737     |            |       |  0.47

Nlocal:         46.375 ave          56 max          40 min
Histogram: 2 0 2 1 0 1 0 0 1 1
Nghost:         3370.5 ave        3418 max        3336 min
Histogram: 3 0 0 1 1 1 0 0 0 2
Neighs:        28709.6 ave       34493 max       25062 min
Histogram: 2 0 2 1 1 0 0 0 1 1

Total # of neighbors = 229677
Ave neighs/atom = 619.07547
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 77.2528704723059
variable C2pos equal ${d2}
variable C2pos equal 27.6854974748679
variable C3pos equal ${d3}
variable C3pos equal 44.1332916643393
variable C4pos equal ${d4}
variable C4pos equal -7.53191110366596
variable C5pos equal ${d5}
variable C5pos equal 17.6832404137587
variable C6pos equal ${d6}
variable C6pos equal -13.4969973407402

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(-35.6740827797397+${C1pos})
variable C12 equal 0.5*(-35.6740827797397+77.2528704723059)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(-35.2609774489312+${C2pos})
variable C22 equal 0.5*(-35.2609774489312+27.6854974748679)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(31.783518983892+${C3pos})
variable C32 equal 0.5*(31.783518983892+44.1332916643393)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(10.5622814361643+${C4pos})
variable C42 equal 0.5*(10.5622814361643+-7.53191110366596)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(-17.8497580210796+${C5pos})
variable C52 equal 0.5*(-17.8497580210796+17.6832404137587)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(7.22972041553682+${C6pos})
variable C62 equal 0.5*(7.22972041553682+-13.4969973407402)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 18.6403
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*18.6403
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.186403 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.8149 18.453897) with tilt (-8.851 0.4589 0.2054)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 131.6 | 133.6 | 135.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.15392     -43097.194      37569.667      0              4095.5864    
       100   293.69407     -43104.094      4526.2569      164.31805      4095.5864    
       200   306.30014     -43122.62       249.55246     -5428.5345      4095.5864    
       300   294.83431     -43122.084     -10551.361     -9209.4793      4095.5864    
       400   294.65942     -43122.623     -11255.326     -13506.696      4095.5864    
       500   281.80114     -43110.209     -7152.5965     -1274.7011      4095.5864    
       600   309.24894     -43136.492      1769.1835     -2689.9303      4095.5864    
       700   291.94759     -43111.3        7427.0151     -7943.9569      4095.5864    
       800   306.47621     -43130.729     -11431.386     -9768.7087      4095.5864    
       900   296.63737     -43132.415      780.71878      447.36672      4095.5864    
      1000   306.89178     -43155.177     -8940.495      -9573.4618      4095.5864    
      1100   300.8204      -43144.566     -7722.1715     -8184.3874      4095.5864    
      1200   309.33652     -43140.73      -4774.8526     -3059.8335      4095.5864    
      1300   313.63582     -43141.957     -5328.206      -1175.4779      4095.5864    
      1400   290.75854     -43131.486     -463.48284     -6117.1872      4095.5864    
      1500   308.6886      -43170.467      1054.3391     -9809.3479      4095.5864    
      1600   297.53811     -43167.681      6265.5894     -6072.4503      4095.5864    
      1700   286.74653     -43153.978     -8817.028      -7314.8096      4095.5864    
      1800   301.74336     -43149.607      6042.279      -83.451003      4095.5864    
      1900   303.08416     -43123.365      7660.0842     -3583.6176      4095.5864    
      2000   311.81078     -43125.644     -15379.187     -3683.5146      4095.5864    
Loop time of 103.878 on 16 procs for 2000 steps with 371 atoms

Performance: 0.832 ns/day, 28.855 hours/ns, 19.253 timesteps/s, 7.143 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 76.778     | 79.293     | 82.279     |  17.6 | 76.33
Bond    | 0.00067821 | 0.00077592 | 0.00088842 |   0.0 |  0.00
Neigh   | 5.396      | 5.5467     | 5.7791     |   5.4 |  5.34
Comm    | 6.3369     | 9.349      | 11.909     |  51.9 |  9.00
Output  | 0.0054659  | 0.010305   | 0.012413   |   2.7 |  0.01
Modify  | 9.0061     | 9.2958     | 9.5098     |   5.3 |  8.95
Other   |            | 0.3833     |            |       |  0.37

Nlocal:         46.375 ave          58 max          41 min
Histogram: 3 1 2 0 0 0 0 1 0 1
Nghost:        3395.25 ave        3455 max        3335 min
Histogram: 1 2 1 0 0 0 0 1 1 2
Neighs:          29335 ave       36466 max       25918 min
Histogram: 3 1 1 1 0 0 0 1 0 1

Total # of neighbors = 234680
Ave neighs/atom = 632.56065
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 131.6 | 133.6 | 135.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   311.81078     -43125.644     -15379.186      0              4095.5864    
       100   322.88639     -43150.515     -8273.1709     -4224.9928      4095.5864    
       200   291.58569     -43151.481     -2153.1979     -5329.8998      4095.5864    
       300   290.07245     -43159.943     -3844.6259      922.52477      4095.5864    
       400   291.83258     -43158.367     -19031.915     -5962.8577      4095.5864    
       500   318.96803     -43182.394     -7263.3668     -6369.3082      4095.5864    
       600   295.04337     -43157.107      2668.0522     -1799.1051      4095.5864    
       700   315.74557     -43182.761      843.51376     -2866.5645      4095.5864    
       800   309.86023     -43177.412     -5038.2482     -7135.1889      4095.5864    
       900   307.46534     -43193.46       1498.469      -2150.2407      4095.5864    
      1000   287.11899     -43190.261      6768.5855     -2469.1406      4095.5864    
      1100   286.29956     -43182.122     -2771.2629     -6500.8786      4095.5864    
      1200   296.42481     -43153.491      13369.366     -1009.5766      4095.5864    
      1300   298.80581     -43150.451      1051.5458     -4981.9023      4095.5864    
      1400   313.54425     -43185.056      9745.8175     -2497.05        4095.5864    
      1500   286.94324     -43179.352     -13459.753     -2444.5931      4095.5864    
      1600   281.56614     -43172.459     -13264.627     -5417.9815      4095.5864    
      1700   297.50112     -43174.331     -18354.365     -7859.2358      4095.5864    
      1800   309.63123     -43153.771     -812.82219     -2345.1753      4095.5864    
      1900   311.57427     -43153.611      7137.9548      2683.5086      4095.5864    
      2000   314.39113     -43177.551     -4063.3266      3944.9819      4095.5864    
Loop time of 104.739 on 16 procs for 2000 steps with 371 atoms

Performance: 0.825 ns/day, 29.094 hours/ns, 19.095 timesteps/s, 7.084 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 78.308     | 80.634     | 84.163     |  19.0 | 76.99
Bond    | 0.00064842 | 0.00077344 | 0.0008873  |   0.0 |  0.00
Neigh   | 5.4028     | 5.585      | 5.7979     |   6.1 |  5.33
Comm    | 5.309      | 8.9036     | 11.287     |  57.9 |  8.50
Output  | 0.000939   | 0.0012842  | 0.0034759  |   2.3 |  0.00
Modify  | 8.9834     | 9.2539     | 9.5172     |   5.7 |  8.84
Other   |            | 0.3603     |            |       |  0.34

Nlocal:         46.375 ave          55 max          37 min
Histogram: 1 0 1 2 0 1 1 0 0 2
Nghost:        3398.38 ave        3457 max        3337 min
Histogram: 2 1 1 0 0 0 0 0 2 2
Neighs:        29306.2 ave       34638 max       23408 min
Histogram: 1 0 0 2 2 0 1 0 0 2

Total # of neighbors = 234450
Ave neighs/atom = 631.9407
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 86.988587966769
variable C2neg equal ${d2}
variable C2neg equal 16.0278983476637
variable C3neg equal ${d3}
variable C3neg equal 26.8660458586639
variable C4neg equal ${d4}
variable C4neg equal 0.250412458187171
variable C5neg equal ${d5}
variable C5neg equal -20.6062879121134
variable C6neg equal ${d6}
variable C6neg equal 13.6398562297467

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*18.6403
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.186403 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.8149 18.826703) with tilt (-8.851 0.4589 0.2054)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.9 | 132.1 | 134.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.15392     -43085.014     -46277.381      0              4178.3256    
       100   290.98648     -43088.614      5891.9232     -3330.9682      4178.3256    
       200   301.47799     -43105.671     -9699.2866     -5744.4491      4178.3256    
       300   291.77108     -43111.052     -6126.6764     -13891.655      4178.3256    
       400   297.84626     -43118.205     -10621.678     -11979.788      4178.3256    
       500   310.13298     -43126.527     -1375.631      -2742.6605      4178.3256    
       600   287.84277     -43105.765     -16318.628     -5701.9337      4178.3256    
       700   302.15055     -43115.477     -5654.6502     -7383.1908      4178.3256    
       800   300.45549     -43121.804     -7620.8407     -9215.2942      4178.3256    
       900   287.0149      -43117.595     -8296.3121     -3730.6674      4178.3256    
      1000   289.88134     -43118.501     -19901.567     -7809.84        4178.3256    
      1100   301.05388     -43117.832     -9019.4915     -12629.75       4178.3256    
      1200   294.47404     -43115.584     -6377.0867     -7854.3878      4178.3256    
      1300   310.42482     -43148.14      -7009.7113     -6752.6139      4178.3256    
      1400   290.07344     -43138.534     -13909.264     -7861.167       4178.3256    
      1500   290.13658     -43134.041     -14407.884     -6352.1743      4178.3256    
      1600   308.18143     -43141.032     -3536.9058     -5418.0829      4178.3256    
      1700   311.98577     -43139.78      -17935.368     -12774.594      4178.3256    
      1800   306.68502     -43135.743     -6701.7479     -5861.6575      4178.3256    
      1900   299.57117     -43132.879     -14372.107     -12617.451      4178.3256    
      2000   301.29284     -43138.9       -10520.023     -12080.031      4178.3256    
Loop time of 101.27 on 16 procs for 2000 steps with 371 atoms

Performance: 0.853 ns/day, 28.131 hours/ns, 19.749 timesteps/s, 7.327 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 76.586     | 77.59      | 78.762     |   8.2 | 76.62
Bond    | 0.00064783 | 0.00077964 | 0.00088303 |   0.0 |  0.00
Neigh   | 5.459      | 5.5073     | 5.5552     |   1.4 |  5.44
Comm    | 7.512      | 8.6517     | 9.6535     |  24.1 |  8.54
Output  | 0.0058709  | 0.010775   | 0.012903   |   2.7 |  0.01
Modify  | 9.0789     | 9.1323     | 9.2107     |   1.6 |  9.02
Other   |            | 0.3775     |            |       |  0.37

Nlocal:         46.375 ave          56 max          37 min
Histogram: 1 0 2 0 1 2 0 0 0 2
Nghost:        3359.75 ave        3434 max        3296 min
Histogram: 1 1 0 1 2 0 1 1 0 1
Neighs:        28716.1 ave       34455 max       23005 min
Histogram: 1 0 2 0 1 2 0 0 0 2

Total # of neighbors = 229729
Ave neighs/atom = 619.21563
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.9 | 132.1 | 134 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   301.29284     -43138.9       -10520.052      0              4178.3256    
       100   309.06567     -43151.7       -16578.694     -14190.314      4178.3256    
       200   300.09016     -43142.689     -907.25112     -7316.7981      4178.3256    
       300   311.10405     -43133.327     -23820.492     -8625.7899      4178.3256    
       400   312.55542     -43129.304     -2452.2366     -10445.857      4178.3256    
       500   302.82403     -43141.585     -11135.97      -13779.34       4178.3256    
       600   300.44781     -43162.002     -9224.7282     -11635.164      4178.3256    
       700   285.79162     -43140.493      7320.4727     -11552.267      4178.3256    
       800   315.42227     -43161.657     -14912.226     -5477.4817      4178.3256    
       900   311.99349     -43161.411     -9154.6835     -13223.938      4178.3256    
      1000   290.90926     -43140.984     -10589.288     -10381.492      4178.3256    
      1100   304.67391     -43153.752     -19694.804     -13007.779      4178.3256    
      1200   304.02888     -43145.192      3785.3471     -8658.2661      4178.3256    
      1300   310.01884     -43149.717     -529.28421     -7403.2364      4178.3256    
      1400   308.64001     -43151.181     -8361.4183     -3326.9965      4178.3256    
      1500   299.07199     -43147.332     -5243.1953     -11077.836      4178.3256    
      1600   304.34184     -43154.929     -8120.9316     -12372.445      4178.3256    
      1700   309.54914     -43163.944     -13693.883     -11770.862      4178.3256    
      1800   293.67544     -43143.775     -843.6702      -12206.192      4178.3256    
      1900   318.91451     -43162.354      4733.2534     -7362.6981      4178.3256    
      2000   301.22022     -43137.27      -18113.973     -7432.64        4178.3256    
Loop time of 102.185 on 16 procs for 2000 steps with 371 atoms

Performance: 0.846 ns/day, 28.385 hours/ns, 19.572 timesteps/s, 7.261 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 75.863     | 78.717     | 82.73      |  23.1 | 77.03
Bond    | 0.0006393  | 0.00079819 | 0.00096106 |   0.0 |  0.00
Neigh   | 5.439      | 5.5798     | 5.7483     |   5.4 |  5.46
Comm    | 4.3993     | 8.4211     | 11.353     |  70.8 |  8.24
Output  | 0.00086007 | 0.0011081  | 0.0025067  |   1.6 |  0.00
Modify  | 8.9315     | 9.1284     | 9.2909     |   4.3 |  8.93
Other   |            | 0.3367     |            |       |  0.33

Nlocal:         46.375 ave          57 max          37 min
Histogram: 1 1 0 1 2 1 0 0 0 2
Nghost:        3342.38 ave        3398 max        3278 min
Histogram: 1 1 1 1 0 0 0 1 1 2
Neighs:        28716.6 ave       35184 max       23052 min
Histogram: 1 1 0 2 1 1 0 0 0 2

Total # of neighbors = 229733
Ave neighs/atom = 619.22642
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 28.2951653818151
variable C2pos equal ${d2}
variable C2pos equal 20.3737614794871
variable C3pos equal ${d3}
variable C3pos equal -1.98410939862974
variable C4pos equal ${d4}
variable C4pos equal -8.21849446871133
variable C5pos equal ${d5}
variable C5pos equal 10.6808014722595
variable C6pos equal ${d6}
variable C6pos equal -0.282874927388232

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(86.988587966769+${C1pos})
variable C13 equal 0.5*(86.988587966769+28.2951653818151)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(16.0278983476637+${C2pos})
variable C23 equal 0.5*(16.0278983476637+20.3737614794871)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(26.8660458586639+${C3pos})
variable C33 equal 0.5*(26.8660458586639+-1.98410939862974)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(0.250412458187171+${C4pos})
variable C43 equal 0.5*(0.250412458187171+-8.21849446871133)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-20.6062879121134+${C5pos})
variable C53 equal 0.5*(-20.6062879121134+10.6808014722595)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(13.6398562297467+${C6pos})
variable C63 equal 0.5*(13.6398562297467+-0.282874927388232)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 18.6403
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*18.6403
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.186403 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.018997)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.8 | 132.9 | 134.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.15392     -43102.318     -8818.2438      0              4136.956     
       100   289.1302      -43098.844      2291.8708     -903.65925      4136.956     
       200   301.68469     -43107.781     -11814.529     -2901.5303      4136.956     
       300   303.15764     -43121.084     -13331.991     -9555.0568      4136.956     
       400   311.24151     -43135.312     -2599.1923     -14564.964      4136.956     
       500   302.59084     -43133.191      2107.4911      4337.2046      4136.956     
       600   306.05302     -43132.275     -4397.8802     -1995.1764      4136.956     
       700   302.02927     -43123.495     -74.680918     -5966.7735      4136.956     
       800   279.45916     -43114.681     -16767.257     -8139.7472      4136.956     
       900   292.51106     -43127.597     -7419.6313     -3138.1968      4136.956     
      1000   322.27373     -43146.56      -7742.5644     -4158.7061      4136.956     
      1100   297.0257      -43118.401     -3225.322      -3187.866       4136.956     
      1200   298.56202     -43129.531      716.24441     -6716.2787      4136.956     
      1300   302.08802     -43156.033      13026.064     -7526.9276      4136.956     
      1400   306.99989     -43178.479      2780.892      -11010.018      4136.956     
      1500   272.66528     -43135.224     -10913.614     -6632.6157      4136.956     
      1600   314.01799     -43153.305     -6308.7119     -3560.8016      4136.956     
      1700   309.89593     -43130.173     -4608.3096     -7132.3447      4136.956     
      1800   328.74683     -43152.749     -11637.481     -15092.971      4136.956     
      1900   294.07899     -43149.037     -15335.174     -13303.489      4136.956     
      2000   291.53211     -43176.665     -2914.2894     -4519.3838      4136.956     
Loop time of 102.565 on 16 procs for 2000 steps with 371 atoms

Performance: 0.842 ns/day, 28.490 hours/ns, 19.500 timesteps/s, 7.234 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 77.378     | 78.804     | 80.01      |   9.4 | 76.83
Bond    | 0.00067068 | 0.00077762 | 0.00083976 |   0.0 |  0.00
Neigh   | 5.4192     | 5.5894     | 5.7436     |   4.0 |  5.45
Comm    | 7.3767     | 8.559      | 10.049     |  29.5 |  8.34
Output  | 0.0061174  | 0.011079   | 0.013244   |   2.7 |  0.01
Modify  | 9.0398     | 9.2309     | 9.434      |   3.9 |  9.00
Other   |            | 0.3701     |            |       |  0.36

Nlocal:         46.375 ave          55 max          39 min
Histogram: 2 0 1 1 0 2 0 0 0 2
Nghost:        3383.62 ave        3430 max        3334 min
Histogram: 2 1 0 1 0 0 0 0 2 2
Neighs:        28996.8 ave       34372 max       24518 min
Histogram: 2 0 1 1 1 1 0 0 0 2

Total # of neighbors = 231974
Ave neighs/atom = 625.26685
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.8 | 132.9 | 134.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.53211     -43176.665     -2914.3047      0              4136.956     
       100   314.60166     -43194.077     -11313.661     -3181.4179      4136.956     
       200   300.77778     -43142.758     -1441.7852     -1600.1792      4136.956     
       300   303.45756     -43139.329      476.85255     -4611.0618      4136.956     
       400   316.60612     -43166.06      -11996.297     -8403.0027      4136.956     
       500   301.93673     -43169.532     -15185.019     -9893.0013      4136.956     
       600   283.36302     -43159.431     -6510.9673     -5038.4146      4136.956     
       700   305.33606     -43172.209     -12082.885     -8626.2392      4136.956     
       800   313.06965     -43131.978     -11010.224     -6775.3867      4136.956     
       900   304.29483     -43127.074     -5678.8839     -10437.708      4136.956     
      1000   310.15934     -43162.536     -11849.777     -9952.2904      4136.956     
      1100   310.78587     -43179.411     -10261.179     -7295.813       4136.956     
      1200   293.94733     -43175.797     -17586.76      -7686.0891      4136.956     
      1300   305.46713     -43193.184     -2167.9699     -4172.2963      4136.956     
      1400   298.30351     -43190.404     -12861.745     -7822.4826      4136.956     
      1500   297.52838     -43202.014     -11219.832     -9787.0275      4136.956     
      1600   279.96984     -43181.501     -10414.843     -12361.906      4136.956     
      1700   295.21944     -43171.707     -8820.4264     -10915.872      4136.956     
      1800   310.25651     -43171.581     -8920.5483     -8508.3421      4136.956     
      1900   290.28267     -43145.466     -12734.767     -7356.0734      4136.956     
      2000   311.72509     -43191.958     -10934.8       -9043.0126      4136.956     
Loop time of 102.623 on 16 procs for 2000 steps with 371 atoms

Performance: 0.842 ns/day, 28.506 hours/ns, 19.489 timesteps/s, 7.230 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 77.4       | 79.349     | 82.255     |  16.4 | 77.32
Bond    | 0.00066935 | 0.00078049 | 0.0008792  |   0.0 |  0.00
Neigh   | 5.4033     | 5.546      | 5.6849     |   3.7 |  5.40
Comm    | 5.3708     | 8.2919     | 10.241     |  51.2 |  8.08
Output  | 0.00090248 | 0.0011589  | 0.0027231  |   1.7 |  0.00
Modify  | 8.923      | 9.1068     | 9.2689     |   3.9 |  8.87
Other   |            | 0.3272     |            |       |  0.32

Nlocal:         46.375 ave          57 max          35 min
Histogram: 1 0 1 0 1 3 0 0 1 1
Nghost:        3386.88 ave        3440 max        3342 min
Histogram: 1 3 0 0 0 1 0 1 1 1
Neighs:        29010.4 ave       35568 max       22064 min
Histogram: 1 0 1 0 2 2 0 0 1 1

Total # of neighbors = 232083
Ave neighs/atom = 625.56065
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -44.6122665659309
variable C2neg equal ${d2}
variable C2neg equal 11.5058083971448
variable C3neg equal ${d3}
variable C3neg equal -49.4585635837228
variable C4neg equal ${d4}
variable C4neg equal -2.94804992288081
variable C5neg equal ${d5}
variable C5neg equal -17.4829810387323
variable C6neg equal ${d6}
variable C6neg equal 10.1270870693312

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*18.6403
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.186403 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.391803)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.8 | 132.9 | 134.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.15392     -43104.823     -8152.2578      0              4136.956     
       100   292.26576     -43105.365     -448.62869     -2011.3289      4136.956     
       200   306.29555     -43113.828     -8247.6286     -6829.2561      4136.956     
       300   306.47175     -43118.641     -1749.4313     -9636.9804      4136.956     
       400   311.04202     -43129.109     -7308.8321     -14794.084      4136.956     
       500   293.94665     -43126.399     -3451.7706     -2293.1072      4136.956     
       600   294.23954     -43141.468     -4305.6866     -4826.8984      4136.956     
       700   295.93056     -43132.882     -5597.2304     -5444.8803      4136.956     
       800   313.06504     -43134.013     -9921.7742     -3227.2251      4136.956     
       900   301.0853      -43110.814     -6546.8571     -269.22793      4136.956     
      1000   305.33159     -43120.544     -8399.6404     -4426.286       4136.956     
      1100   288.98298     -43116.084     -13982.001     -8011.1834      4136.956     
      1200   293.21553     -43125.119      855.78905     -4289.0879      4136.956     
      1300   297.14731     -43129.939     -7012.1852     -6022.47        4136.956     
      1400   317.55973     -43156.207      6428.3799     -4656.2875      4136.956     
      1500   299.40905     -43150.37      -2429.6408     -2079.6995      4136.956     
      1600   295.00583     -43152.284      4112.4306      69.292447      4136.956     
      1700   306.17029     -43166.014     -11131.497     -8189.0831      4136.956     
      1800   306.37848     -43161.084     -9113.1708     -5916.1081      4136.956     
      1900   293.85454     -43126.077     -2112.0007     -4778.6035      4136.956     
      2000   302.86227     -43114.48      -5778.3891      371.64795      4136.956     
Loop time of 102.607 on 16 procs for 2000 steps with 371 atoms

Performance: 0.842 ns/day, 28.502 hours/ns, 19.492 timesteps/s, 7.232 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 77.596     | 79.104     | 80.957     |  13.7 | 77.09
Bond    | 0.00068875 | 0.0007684  | 0.00085141 |   0.0 |  0.00
Neigh   | 5.5169     | 5.6036     | 5.68       |   1.9 |  5.46
Comm    | 6.4235     | 8.2498     | 9.7942     |  42.7 |  8.04
Output  | 0.006359   | 0.010514   | 0.012384   |   2.3 |  0.01
Modify  | 9.1605     | 9.2776     | 9.3884     |   2.3 |  9.04
Other   |            | 0.3607     |            |       |  0.35

Nlocal:         46.375 ave          58 max          41 min
Histogram: 2 3 0 1 0 0 0 1 0 1
Nghost:        3396.75 ave        3447 max        3325 min
Histogram: 1 0 0 1 1 1 0 2 1 1
Neighs:        29021.6 ave       35971 max       25919 min
Histogram: 3 2 0 1 0 0 0 1 0 1

Total # of neighbors = 232173
Ave neighs/atom = 625.80323
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 131.2 | 133 | 134.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.86227     -43114.48      -5778.4257      0              4136.956     
       100   307.85626     -43133.727      4298.9583     -824.39499      4136.956     
       200   299.38869     -43154.389      9971.0671     -1814.2501      4136.956     
       300   287.30701     -43143.723      2434.5428     -4476.3106      4136.956     
       400   294.23286     -43139.217     -8875.6741     -2864.828       4136.956     
       500   304.50902     -43146.361     -696.8522      -1876.7292      4136.956     
       600   303.02188     -43148.233     -7882.1957     -7575.8917      4136.956     
       700   285.70766     -43143.555     -4025.2249     -8182.7119      4136.956     
       800   292.54161     -43159.136     -7846.8651     -5147.4018      4136.956     
       900   318.38448     -43163.33       10956.959     -7462.8052      4136.956     
      1000   289.30433     -43110.798     -3347.5425     -5406.5893      4136.956     
      1100   296.67659     -43122.196     -294.75996     -3264.0388      4136.956     
      1200   287.04607     -43133.683      6585.0892     -5685.9702      4136.956     
      1300   281.17657     -43154.88      -7830.0592     -5392.3541      4136.956     
      1400   271.7681      -43135.47      -11998.714     -6034.2688      4136.956     
      1500   289.34507     -43139.935     -11337.728     -4770.6552      4136.956     
      1600   294.47804     -43127.048      1914.6519     -2178.2777      4136.956     
      1700   293.71417     -43111.973      802.82557     -5066.3083      4136.956     
      1800   302.47905     -43122.701      2055.4368     -2327.8847      4136.956     
      1900   292.15244     -43149.32       1762.3446     -3328.2201      4136.956     
      2000   277.27882     -43151.769      5799.5823     -68.6477        4136.956     
Loop time of 102.832 on 16 procs for 2000 steps with 371 atoms

Performance: 0.840 ns/day, 28.564 hours/ns, 19.449 timesteps/s, 7.216 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 76.027     | 78.117     | 81.521     |  19.4 | 75.97
Bond    | 0.00067733 | 0.0007708  | 0.00084527 |   0.0 |  0.00
Neigh   | 5.3302     | 5.5625     | 5.7306     |   6.1 |  5.41
Comm    | 6.0847     | 9.5026     | 11.678     |  57.0 |  9.24
Output  | 0.0009229  | 0.0011034  | 0.0021178  |   1.2 |  0.00
Modify  | 9.0041     | 9.2301     | 9.5154     |   6.7 |  8.98
Other   |            | 0.4171     |            |       |  0.41

Nlocal:         46.375 ave          54 max          41 min
Histogram: 3 1 0 0 1 0 1 0 0 2
Nghost:           3398 ave        3438 max        3346 min
Histogram: 1 1 1 1 0 0 0 0 1 3
Neighs:        29021.4 ave       33790 max       25989 min
Histogram: 3 1 0 0 1 1 0 0 1 1

Total # of neighbors = 232171
Ave neighs/atom = 625.79784
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -46.320486097537
variable C2pos equal ${d2}
variable C2pos equal -62.7647246182024
variable C3pos equal ${d3}
variable C3pos equal -95.3978959160962
variable C4pos equal ${d4}
variable C4pos equal 8.78492171268786
variable C5pos equal ${d5}
variable C5pos equal -4.32395666183954
variable C6pos equal ${d6}
variable C6pos equal -7.61437382271162

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-44.6122665659309+${C1pos})
variable C14 equal 0.5*(-44.6122665659309+-46.320486097537)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(11.5058083971448+${C2pos})
variable C24 equal 0.5*(11.5058083971448+-62.7647246182024)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-49.4585635837228+${C3pos})
variable C34 equal 0.5*(-49.4585635837228+-95.3978959160962)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(-2.94804992288081+${C4pos})
variable C44 equal 0.5*(-2.94804992288081+8.78492171268786)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-17.4829810387323+${C5pos})
variable C54 equal 0.5*(-17.4829810387323+-4.32395666183954)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(10.1270870693312+${C6pos})
variable C64 equal 0.5*(10.1270870693312+-7.61437382271162)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 18.6403
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*18.6403
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.186403 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.272497 0.2054)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.8 | 133 | 134.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.15392     -43099.068     -6432.8387      0              4136.956     
       100   289.61786     -43097.68      -772.9067      -809.84553      4136.956     
       200   302.95217     -43110.986     -10459.973     -6485.2063      4136.956     
       300   296.47592     -43116.879     -18900.92      -14968.038      4136.956     
       400   297.8043      -43124.039     -7392.3585     -13959.73       4136.956     
       500   295.34204     -43124.212     -5795.9552     -5858.3991      4136.956     
       600   310.22272     -43137.803     -1024.9902     -901.43854      4136.956     
       700   305.81827     -43131.016     -3741.9365     -7311.0145      4136.956     
       800   311.27868     -43136.956      1690.9006     -7014.7899      4136.956     
       900   307.07931     -43135.357     -2042.51       -3002.2574      4136.956     
      1000   290.61374     -43117.108      5134.71       -5717.3052      4136.956     
      1100   308.91971     -43130.566     -47.96182      -7765.761       4136.956     
      1200   286.00799     -43100.64       1493.4917     -4310.7892      4136.956     
      1300   311.38203     -43129.519      2683.1163     -26.962482      4136.956     
      1400   281.22016     -43112.648     -19833.731     -7662.254       4136.956     
      1500   280.07788     -43121.447     -8539.3111     -3740.8295      4136.956     
      1600   294.71908     -43129.572      2016.9613     -4275.1464      4136.956     
      1700   304.37082     -43126.945     -5096.8627     -4909.9841      4136.956     
      1800   307.2035      -43132.862      1382.5892     -1930.0158      4136.956     
      1900   286.49679     -43124.424      2452.1075     -4564.6564      4136.956     
      2000   293.42752     -43136.691     -13619.153     -4221.4802      4136.956     
Loop time of 102.797 on 16 procs for 2000 steps with 371 atoms

Performance: 0.840 ns/day, 28.555 hours/ns, 19.456 timesteps/s, 7.218 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 75.748     | 78.369     | 79.579     |  12.6 | 76.24
Bond    | 0.00069769 | 0.00078957 | 0.00090747 |   0.0 |  0.00
Neigh   | 5.3853     | 5.5283     | 5.6637     |   3.6 |  5.38
Comm    | 7.9594     | 9.2725     | 11.878     |  37.0 |  9.02
Output  | 0.0063947  | 0.010733   | 0.012725   |   2.4 |  0.01
Modify  | 9.0426     | 9.2255     | 9.3821     |   3.8 |  8.97
Other   |            | 0.3906     |            |       |  0.38

Nlocal:         46.375 ave          56 max          38 min
Histogram: 1 1 0 2 1 1 0 0 1 1
Nghost:        3396.75 ave        3448 max        3337 min
Histogram: 2 0 0 1 1 0 0 1 1 2
Neighs:        28987.9 ave       34634 max       23876 min
Histogram: 1 1 0 1 3 0 0 0 0 2

Total # of neighbors = 231903
Ave neighs/atom = 625.07547
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.8 | 132.9 | 134.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   293.42752     -43136.691     -13619.157      0              4136.956     
       100   308.99284     -43153.163      1415.7717     -5003.3137      4136.956     
       200   317.5517      -43175.037     -2248.2378     -554.23323      4136.956     
       300   274.96411     -43159.786     -7617.0968     -2619.3038      4136.956     
       400   286.06273     -43176.842     -2051.6961     -8482.9679      4136.956     
       500   277.41224     -43139.781     -2769.5863     -7528.7334      4136.956     
       600   313.61256     -43162.009     -6541.6422     -4212.7459      4136.956     
       700   300.44041     -43156.394     -6762.4758     -5187.3238      4136.956     
       800   289.81185     -43148.743     -11538.969     -8302.1124      4136.956     
       900   309.97898     -43167.73      -10286.314     -4638.6366      4136.956     
      1000   288.63038     -43165.204     -20128.719     -5737.6959      4136.956     
      1100   287.72434     -43178.188     -14017.199     -9991.6954      4136.956     
      1200   303.96009     -43175.357     -6373.478      -9730.8351      4136.956     
      1300   322.628       -43169.191     -442.4535      -8080.5824      4136.956     
      1400   313.78304     -43164.407     -11035.476     -5004.7814      4136.956     
      1500   306.25338     -43168.598     -1675.9396     -2598.8996      4136.956     
      1600   291.81807     -43175.71      -5900.7839     -8305.9112      4136.956     
      1700   271.55698     -43178.376      4658.6701     -4076.8395      4136.956     
      1800   263.68747     -43203.965     -1109.5661     -7175.2754      4136.956     
      1900   290.86819     -43227.182     -3159.1928     -4399.7644      4136.956     
      2000   292.42516     -43194.965     -9574.9772     -5902.55        4136.956     
Loop time of 102.963 on 16 procs for 2000 steps with 371 atoms

Performance: 0.839 ns/day, 28.601 hours/ns, 19.425 timesteps/s, 7.206 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 77.47      | 79.055     | 81.479     |  14.4 | 76.78
Bond    | 0.00067436 | 0.00079151 | 0.0009046  |   0.0 |  0.00
Neigh   | 5.4603     | 5.5451     | 5.6398     |   2.9 |  5.39
Comm    | 6.3391     | 8.7393     | 10.34      |  42.5 |  8.49
Output  | 0.00091681 | 0.0011999  | 0.002962   |   1.9 |  0.00
Modify  | 9.0697     | 9.2313     | 9.4097     |   3.4 |  8.97
Other   |            | 0.3896     |            |       |  0.38

Nlocal:         46.375 ave          56 max          36 min
Histogram: 1 1 0 1 0 1 2 0 0 2
Nghost:        3401.88 ave        3455 max        3329 min
Histogram: 2 0 1 0 1 0 0 0 0 4
Neighs:        28976.4 ave       34951 max       22574 min
Histogram: 1 1 0 1 0 1 2 0 0 2

Total # of neighbors = 231811
Ave neighs/atom = 624.82749
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -12.7915292783441
variable C2neg equal ${d2}
variable C2neg equal -15.8382724033352
variable C3neg equal ${d3}
variable C3neg equal -40.0204988589732
variable C4neg equal ${d4}
variable C4neg equal 1.39872242186575
variable C5neg equal ${d5}
variable C5neg equal 2.62385630950004
variable C6neg equal ${d6}
variable C6neg equal 10.4025042677118

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*18.6403
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.186403 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.645303 0.2054)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130.8 | 132.9 | 134.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.15392     -43107.645     -10596.288      0              4136.956     
       100   292.69026     -43107.133      7098.5279     -3262.179       4136.956     
       200   297.95887     -43099.764     -8995.3956     -4696.3739      4136.956     
       300   310.5963      -43113.253     -7877.7414     -14184.532      4136.956     
       400   321.64512     -43131.153     -9805.6822     -11920.384      4136.956     
       500   300.23295     -43131.621     -13409.664     -3477.6104      4136.956     
       600   295.41436     -43138.712     -2671.7552     -8591.5682      4136.956     
       700   293.66884     -43129.784      3869.0712     -5834.3883      4136.956     
       800   310.58126     -43126.213      1633.3454     -4437.8945      4136.956     
       900   302.42449     -43106.3       -13895.067     -6019.2184      4136.956     
      1000   294.27994     -43115.708     -8518.7886     -5615.0967      4136.956     
      1100   299.94567     -43147.038     -9602.1571     -6615.9528      4136.956     
      1200   301.34991     -43154.177      7743.6503     -12182.956      4136.956     
      1300   289.39215     -43135.684     -4124.6502     -8447.8446      4136.956     
      1400   300.71192     -43132.736     -105.21869     -4208.5409      4136.956     
      1500   308.2301      -43124.091      1913.0435     -3217.9617      4136.956     
      1600   325.24544     -43130.718      187.16784     -4734.9952      4136.956     
      1700   309.62333     -43120.093     -1762.1874     -2351.2683      4136.956     
      1800   286.77471     -43119.739      5945.3112     -8261.6666      4136.956     
      1900   301.40068     -43152.772     -15178.534     -6174.8808      4136.956     
      2000   295.61351     -43150.308     -20565.52      -9129.2392      4136.956     
Loop time of 102.939 on 16 procs for 2000 steps with 371 atoms

Performance: 0.839 ns/day, 28.594 hours/ns, 19.429 timesteps/s, 7.208 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 77.688     | 79.407     | 81.744     |  16.5 | 77.14
Bond    | 0.00069993 | 0.00080332 | 0.00093167 |   0.0 |  0.00
Neigh   | 5.4688     | 5.6147     | 5.7662     |   4.2 |  5.45
Comm    | 5.9821     | 8.2586     | 10.071     |  51.9 |  8.02
Output  | 0.0057865  | 0.010356   | 0.012398   |   2.6 |  0.01
Modify  | 9.0629     | 9.2677     | 9.4297     |   4.4 |  9.00
Other   |            | 0.3794     |            |       |  0.37

Nlocal:         46.375 ave          55 max          35 min
Histogram: 1 0 0 1 1 1 1 1 1 1
Nghost:        3408.88 ave        3461 max        3345 min
Histogram: 1 1 0 1 1 0 0 1 1 2
Neighs:        28997.9 ave       34168 max       21977 min
Histogram: 1 0 0 1 1 1 1 1 1 1

Total # of neighbors = 231983
Ave neighs/atom = 625.29111
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 131.1 | 133 | 134.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   295.61351     -43150.308     -20565.53       0              4136.956     
       100   291.89278     -43148.459     -11764.85      -7549.6924      4136.956     
       200   307.54704     -43154.269     -2707.9458     -4399.5856      4136.956     
       300   308.00109     -43128.144     -9865.3004     -5564.1213      4136.956     
       400   317.60985     -43134.818     -6673.4591     -2461.039       4136.956     
       500   307.74654     -43159.499     -3176.9492     -4698.6907      4136.956     
       600   303.43611     -43167.873      3540.9849     -5621.3399      4136.956     
       700   285.58359     -43139.52      -523.6965      -7611.8517      4136.956     
       800   308.65786     -43143.214      6309.3317      811.422        4136.956     
       900   302.58955     -43119.61      -7200.5681     -9226.5946      4136.956     
      1000   322.15629     -43132.898      10944.862     -2854.7825      4136.956     
      1100   306.59431     -43153.494      4714.8035     -4910.333       4136.956     
      1200   301.72535     -43177.515     -15874.092     -5190.2737      4136.956     
      1300   304.80163     -43195.559     -15163.571     -8273.811       4136.956     
      1400   296.85437     -43186.567     -6311.5988     -10037.525      4136.956     
      1500   297.77232     -43169.146     -11811.99      -7716.3629      4136.956     
      1600   310.14603     -43152.01      -6959.2274     -9979.1035      4136.956     
      1700   314.37675     -43156.297     -3035.8973     -3156.4842      4136.956     
      1800   289.22959     -43151.281     -10856.095     -3576.8293      4136.956     
      1900   305.77942     -43181.019     -4926.2524     -13918.607      4136.956     
      2000   299.3931      -43173.023     -3738.4183     -9385.0057      4136.956     
Loop time of 102.8 on 16 procs for 2000 steps with 371 atoms

Performance: 0.840 ns/day, 28.556 hours/ns, 19.455 timesteps/s, 7.218 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 77.274     | 79.518     | 81.655     |  14.0 | 77.35
Bond    | 0.00069843 | 0.00079866 | 0.00090757 |   0.0 |  0.00
Neigh   | 5.3699     | 5.6775     | 5.8336     |   6.3 |  5.52
Comm    | 5.9397     | 8.1048     | 10.462     |  44.9 |  7.88
Output  | 0.00093874 | 0.001153   | 0.0024692  |   1.5 |  0.00
Modify  | 8.927      | 9.1404     | 9.4817     |   5.8 |  8.89
Other   |            | 0.3573     |            |       |  0.35

Nlocal:         46.375 ave          54 max          38 min
Histogram: 2 0 0 1 0 2 0 1 1 1
Nghost:        3370.12 ave        3414 max        3330 min
Histogram: 1 0 1 2 1 0 1 1 0 1
Neighs:        28975.8 ave       33410 max       23863 min
Histogram: 2 0 0 1 0 2 0 1 0 2

Total # of neighbors = 231806
Ave neighs/atom = 624.81402
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 48.0775109889266
variable C2pos equal ${d2}
variable C2pos equal -17.1366260762009
variable C3pos equal ${d3}
variable C3pos equal 53.3872745771061
variable C4pos equal ${d4}
variable C4pos equal -14.3368040883075
variable C5pos equal ${d5}
variable C5pos equal 32.523356298899
variable C6pos equal ${d6}
variable C6pos equal -13.4715155985668

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-12.7915292783441+${C1pos})
variable C15 equal 0.5*(-12.7915292783441+48.0775109889266)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-15.8382724033352+${C2pos})
variable C25 equal 0.5*(-15.8382724033352+-17.1366260762009)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-40.0204988589732+${C3pos})
variable C35 equal 0.5*(-40.0204988589732+53.3872745771061)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(1.39872242186575+${C4pos})
variable C45 equal 0.5*(1.39872242186575+-14.3368040883075)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(2.62385630950004+${C5pos})
variable C55 equal 0.5*(2.62385630950004+32.523356298899)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(10.4025042677118+${C6pos})
variable C65 equal 0.5*(10.4025042677118+-13.4715155985668)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 12.8149

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.8149
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.128149 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.979149 0.4589 0.2054)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132 | 133.6 | 135 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.15392     -43106.018     -9990.194       0              4136.956     
       100   293.14125     -43107.36       1003.137      -2920.6416      4136.956     
       200   300.41927     -43107.261     -8946.5263     -7483.5198      4136.956     
       300   299.1693      -43106.911     -14827.571     -11528.413      4136.956     
       400   323.50737     -43138.406      1962.161      -9774.4909      4136.956     
       500   305.22083     -43143.39      -4377.101       799.78914      4136.956     
       600   289.25201     -43150.027      1091.1834      1693.1953      4136.956     
       700   308.9605      -43173.413     -11095.424     -10160.398      4136.956     
       800   297.00979     -43150.308      11841.157     -3601.9634      4136.956     
       900   309.45167     -43140.789     -5957.7718     -5406.62        4136.956     
      1000   321.33648     -43138.583     -9976.5113     -5904.9321      4136.956     
      1100   303.78056     -43147.313     -8596.6999     -8510.3278      4136.956     
      1200   288.38683     -43163.117     -5913.9879     -5997.827       4136.956     
      1300   278.56033     -43164.118      13036.061     -5400.9717      4136.956     
      1400   289.13758     -43155.693     -8260.775      -3485.4066      4136.956     
      1500   284.61005     -43121.668     -8004.9103      984.83577      4136.956     
      1600   304.29011     -43126.911     -9786.5177     -7212.8986      4136.956     
      1700   311.96151     -43142.573     -2333.3005     -3009.5574      4136.956     
      1800   313.98588     -43166.084     -2631.6966     -7138.5643      4136.956     
      1900   291.73522     -43160.546      1860.2478     -4699.6274      4136.956     
      2000   298.86064     -43178.954     -3595.8205     -5326.14        4136.956     
Loop time of 103.287 on 16 procs for 2000 steps with 371 atoms

Performance: 0.837 ns/day, 28.691 hours/ns, 19.364 timesteps/s, 7.184 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 77.588     | 78.928     | 82.529     |  16.5 | 76.42
Bond    | 0.00070948 | 0.00080387 | 0.00088077 |   0.0 |  0.00
Neigh   | 5.4543     | 5.6645     | 5.8248     |   4.4 |  5.48
Comm    | 5.4493     | 9.1058     | 10.474     |  49.5 |  8.82
Output  | 0.006467   | 0.0097872  | 0.011396   |   1.9 |  0.01
Modify  | 8.9828     | 9.1939     | 9.4431     |   4.7 |  8.90
Other   |            | 0.3847     |            |       |  0.37

Nlocal:         46.375 ave          56 max          41 min
Histogram: 3 0 1 1 1 0 0 0 1 1
Nghost:        3379.12 ave        3424 max        3330 min
Histogram: 1 1 2 0 0 0 0 0 2 2
Neighs:          29035 ave       34980 max       25727 min
Histogram: 3 0 1 1 1 0 0 0 1 1

Total # of neighbors = 232280
Ave neighs/atom = 626.09164
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 131.2 | 133.4 | 135 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   298.86064     -43178.954     -3595.7932      0              4136.956     
       100   295.35101     -43161.243     -11885.011     -4236.598       4136.956     
       200   301.43471     -43137.093     -18331.197     -9338.5763      4136.956     
       300   302.14287     -43125.565     -4490.6069     -12577.102      4136.956     
       400   297.6244      -43129.466      5899.3244     -3347.6053      4136.956     
       500   287.11923     -43128.471     -6093.6565     -5420.3081      4136.956     
       600   321.02736     -43176.022     -9680.6224     -2031.8533      4136.956     
       700   286.67366     -43155.899     -5177.9225     -464.14887      4136.956     
       800   304.09558     -43201.762      11.389674     -4805.4092      4136.956     
       900   282.81071     -43194.073     -1188.9257     -3981.5726      4136.956     
      1000   276.6105      -43158.66       626.25325     -5019.4747      4136.956     
      1100   290.26438     -43157.646      1792.046      -5217.6109      4136.956     
      1200   301.34862     -43153.59      -4407.0513     -313.65662      4136.956     
      1300   314.04816     -43154.825     -3028.1391     -6832.1088      4136.956     
      1400   308.16206     -43141.626     -15411.472     -6580.6757      4136.956     
      1500   301.98673     -43160.913     -15189.535     -3203.3104      4136.956     
      1600   304.00544     -43190.656     -7661.7525     -6234.5968      4136.956     
      1700   274.12905     -43161.224     -2682.3926     -2273.1859      4136.956     
      1800   301.48633     -43164.393     -6058.0184     -7719.1502      4136.956     
      1900   309.58335     -43158.237     -18058.543     -9824.4794      4136.956     
      2000   311.20733     -43166.765     -5688.2646     -10282.961      4136.956     
Loop time of 97.4821 on 16 procs for 2000 steps with 371 atoms

Performance: 0.886 ns/day, 27.078 hours/ns, 20.517 timesteps/s, 7.612 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 64.359     | 69.904     | 79.447     |  76.3 | 71.71
Bond    | 0.00062844 | 0.00076574 | 0.00087029 |   0.0 |  0.00
Neigh   | 4.6808     | 5.1382     | 5.8184     |  20.8 |  5.27
Comm    | 3.4855     | 13.069     | 18.61      | 176.3 | 13.41
Output  | 0.00092252 | 0.0010309  | 0.0014423  |   0.5 |  0.00
Modify  | 8.4745     | 9.152      | 9.6246     |  15.7 |  9.39
Other   |            | 0.2171     |            |       |  0.22

Nlocal:         46.375 ave          55 max          37 min
Histogram: 1 1 0 1 0 2 0 1 0 2
Nghost:        3399.88 ave        3463 max        3342 min
Histogram: 2 2 0 0 0 0 0 1 1 2
Neighs:        28989.1 ave       34081 max       23158 min
Histogram: 1 1 0 1 0 2 0 1 0 2

Total # of neighbors = 231913
Ave neighs/atom = 625.10243
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -57.1760466269932
variable C2neg equal ${d2}
variable C2neg equal -18.9662861509245
variable C3neg equal ${d3}
variable C3neg equal -42.9810916835061
variable C4neg equal ${d4}
variable C4neg equal -8.58003007308039
variable C5neg equal ${d5}
variable C5neg equal -37.2451345820836
variable C6neg equal ${d6}
variable C6neg equal 17.6587767733632

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.8149
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.128149 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.722851 0.4589 0.2054)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 129.9 | 131.8 | 133.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.15392     -43101.754     -6550.7523      0              4136.956     
       100   288.5753      -43097.95      -3221.5518     -1687.7327      4136.956     
       200   305.92163     -43115.456     -15395.501     -4649.0217      4136.956     
       300   298.18815     -43124.668      1574.5142     -6554.686       4136.956     
       400   307.21417     -43137.849      2826.5068     -13708.857      4136.956     
       500   292.12479     -43122.459     -11880.763      1735.2352      4136.956     
       600   298.0665      -43124.022     -3336.3394     -3146.6946      4136.956     
       700   314.86196     -43131.638      14764.488     -8591.8032      4136.956     
       800   317.24143     -43143.036     -10836.741     -8957.7862      4136.956     
       900   291.17233     -43126.513     -19379.476      15.432976      4136.956     
      1000   300.89994     -43140.191     -6072.1617     -3951.3295      4136.956     
      1100   296.59625     -43130.044      2191.1259     -5105.1323      4136.956     
      1200   291.2452      -43116.69      -1463.2284     -2384.1831      4136.956     
      1300   286.30435     -43118.338     -8996.1925     -3830.5654      4136.956     
      1400   295.41539     -43129.416      1064.5348     -4681.1237      4136.956     
      1500   308.43229     -43133.72      -4921.8106     -1862.4813      4136.956     
      1600   325.53386     -43146.749     -3521.2616     -4485.5467      4136.956     
      1700   302.01186     -43126.025      4356.08       -9391.5937      4136.956     
      1800   287.54144     -43106.11      -5591.357      -5835.5051      4136.956     
      1900   306.18241     -43123.747     -12802.17      -7802.9448      4136.956     
      2000   303.76572     -43126.297     -8593.1498     -2224.35        4136.956     
Loop time of 92.5841 on 16 procs for 2000 steps with 371 atoms

Performance: 0.933 ns/day, 25.718 hours/ns, 21.602 timesteps/s, 8.014 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 53.555     | 62.477     | 77.823     | 138.9 | 67.48
Bond    | 0.00058119 | 0.0007346  | 0.00090039 |   0.0 |  0.00
Neigh   | 4.0319     | 4.7091     | 5.7747     |  35.5 |  5.09
Comm    | 1.0106     | 16.371     | 25.305     | 271.3 | 17.68
Output  | 0.0042038  | 0.0068867  | 0.008251   |   1.9 |  0.01
Modify  | 7.922      | 8.9768     | 9.6437     |  25.7 |  9.70
Other   |            | 0.04262    |            |       |  0.05

Nlocal:         46.375 ave          61 max          36 min
Histogram: 2 0 1 3 0 0 0 0 1 1
Nghost:         3367.5 ave        3408 max        3308 min
Histogram: 1 0 0 1 2 0 0 1 0 3
Neighs:        28965.9 ave       37611 max       22625 min
Histogram: 2 0 1 3 0 0 0 0 0 2

Total # of neighbors = 231727
Ave neighs/atom = 624.60108
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 130 | 131.8 | 133.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   303.76572     -43126.297     -8593.1799      0              4136.956     
       100   313.61371     -43139.092     -11706.397     -6134.4023      4136.956     
       200   280.17313     -43138.5       -11284.582     -5995.3827      4136.956     
       300   276.33727     -43139.769     -1084.8085     -4478.4572      4136.956     
       400   297.77247     -43148.231     -12893.904     -8156.9977      4136.956     
       500   314.56604     -43160.105     -3477.867      -6932.941       4136.956     
       600   294.08067     -43152.314      6450.8099     -3665.4295      4136.956     
       700   275.59241     -43170.978      3981.9151     -9607.3624      4136.956     
       800   273.94438     -43162.51      -16729.096     -8324.4354      4136.956     
       900   291.2312      -43157.998     -5853.047      -6102.6509      4136.956     
      1000   289.49679     -43141.993     -10429.626     -4305.8167      4136.956     
      1100   306.90635     -43148.555     -12402.394     -3144.9071      4136.956     
      1200   299.76532     -43141.422     -9965.2208     -8839.7114      4136.956     
      1300   283.78513     -43147.317      1320.2974     -8552.3634      4136.956     
      1400   287.61389     -43163.99      -13828.137     -10840.712      4136.956     
      1500   296.53882     -43162.083      715.18327     -6593.9167      4136.956     
      1600   309.51453     -43148.279     -3535.2988     -384.96096      4136.956     
      1700   330.22195     -43153.906     -5185.6014     -2431.5122      4136.956     
      1800   308.45954     -43143.238      245.22952     -5255.898       4136.956     
      1900   296.95944     -43176.494     -15835.834     -11255.858      4136.956     
      2000   282.02349     -43162.165     -8141.7352     -6550.3566      4136.956     
Loop time of 70.7571 on 16 procs for 2000 steps with 371 atoms

Performance: 1.221 ns/day, 19.655 hours/ns, 28.266 timesteps/s, 10.487 katom-step/s
99.7% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 51.24      | 54.037     | 59.127     |  40.2 | 76.37
Bond    | 0.00052013 | 0.00068825 | 0.00089228 |   0.0 |  0.00
Neigh   | 4.0615     | 4.2355     | 4.4933     |   8.0 |  5.99
Comm    | 0.54557    | 5.6462     | 8.4414     | 124.4 |  7.98
Output  | 0.00091943 | 0.0010068  | 0.0013321  |   0.4 |  0.00
Modify  | 6.5458     | 6.7938     | 6.9603     |   6.2 |  9.60
Other   |            | 0.04337    |            |       |  0.06

Nlocal:         46.375 ave          56 max          34 min
Histogram: 1 1 0 0 0 3 0 0 1 2
Nghost:        3370.62 ave        3439 max        3305 min
Histogram: 2 1 1 0 0 0 0 2 0 2
Neighs:        29002.6 ave       34671 max       21389 min
Histogram: 1 0 1 0 0 3 0 0 1 2

Total # of neighbors = 232021
Ave neighs/atom = 625.39353
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 19.3554291052666
variable C2pos equal ${d2}
variable C2pos equal -8.81829046534038
variable C3pos equal ${d3}
variable C3pos equal -64.4848075166489
variable C4pos equal ${d4}
variable C4pos equal -7.30251942353756
variable C5pos equal ${d5}
variable C5pos equal 17.7451698706397
variable C6pos equal ${d6}
variable C6pos equal 0.736605064179256

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-57.1760466269932+${C1pos})
variable C16 equal 0.5*(-57.1760466269932+19.3554291052666)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(-18.9662861509245+${C2pos})
variable C26 equal 0.5*(-18.9662861509245+-8.81829046534038)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-42.9810916835061+${C3pos})
variable C36 equal 0.5*(-42.9810916835061+-64.4848075166489)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(-8.58003007308039+${C4pos})
variable C46 equal 0.5*(-8.58003007308039+-7.30251942353756)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(-37.2451345820836+${C5pos})
variable C56 equal 0.5*(-37.2451345820836+17.7451698706397)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(17.6587767733632+${C6pos})
variable C66 equal 0.5*(17.6587767733632+0.736605064179256)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 1.49221406199873
variable C22all equal ${C22}
variable C22all equal -3.78773998703165
variable C33all equal ${C33}
variable C33all equal 12.4409682300171

variable C44all equal ${C44}
variable C44all equal 2.91843589490352
variable C55all equal ${C55}
variable C55all equal 17.5736063041995
variable C66all equal ${C66}
variable C66all equal 9.19769091877123

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(20.7893938462831+${C21})
variable C12all equal 0.5*(20.7893938462831+0.1904552019793)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(57.641876674292+${C31})
variable C13all equal 0.5*(57.641876674292+-2.87932567248925)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(18.2008299135754+${C32})
variable C23all equal 0.5*(18.2008299135754+37.9584053241157)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-45.466376331734+${C41})
variable C14all equal 0.5*(-45.466376331734+5.6153406350634)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(17.6429908552912+${C51})
variable C15all equal 0.5*(17.6429908552912+-5.14953173354766)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-18.9103087608633+${C61})
variable C16all equal 0.5*(-18.9103087608633+1.46099448984965)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-25.6294581105288+${C42})
variable C24all equal 0.5*(-25.6294581105288+1.51518516624917)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-16.4874492397681+${C52})
variable C25all equal 0.5*(-16.4874492397681+-0.0832588036604509)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-13.8922883081324+${C62})
variable C26all equal 0.5*(-13.8922883081324+-3.13363846260169)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(-72.4282297499095+${C43})
variable C34all equal 0.5*(-72.4282297499095+-3.98404100526208)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(6.68338785906645+${C53})
variable C35all equal 0.5*(6.68338785906645+-4.96274321992695)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-53.7329496000775+${C63})
variable C36all equal 0.5*(-53.7329496000775+6.67849065117923)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(-6.46904083322088+${C54})
variable C45all equal 0.5*(-6.46904083322088+-10.9034688502859)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-7.94127474830898+${C64})
variable C46all equal 0.5*(-7.94127474830898+1.25635662330979)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-9.74998235572195+${C65})
variable C56all equal 0.5*(-9.74998235572195+-1.5345056654275)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:42:06
