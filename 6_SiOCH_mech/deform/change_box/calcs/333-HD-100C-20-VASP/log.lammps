LAMMPS (2 Aug 2023 - Update 2)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 30*${nthermo}       # steps of equilibration run 20
variable nequil equal 30*100       
variable nrun equal 30*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 30*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333-HD-100C-20-VASP
read_data       ${structure}.data
read_data       333-HD-100C-20-VASP.data
Reading data file ...
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.011 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.365 | 6.365 | 6.365 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
         1   0              0              0              0              0            
Loop time of 8.72404e-05 on 8 procs for 1 steps with 366 atoms

57.2% CPU use with 8 MPI tasks x 1 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 2.095e-06  | 2.7679e-06 | 3.842e-06  |   0.0 |  3.17
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 3.491e-06  | 6.0587e-06 | 7.054e-06  |   0.0 |  6.94
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 7.841e-05  |            |       | 89.88

Nlocal:          45.75 ave          58 max          36 min
Histogram: 1 0 2 1 1 1 1 0 0 1
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-HD-100C-20-VASP_opt.data
System init for write_data ...
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 3000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -29.52 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.6 | 139.4 | 141 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -43286.839      45299.205      0              1.9525358      3659.697     
       100   599.27424     -43834.059     -3009.8602     -4123.31        1.9525358      3659.697     
       200   458.30867     -43941.185      11212.708     -315.13511      1.9525358      3659.697     
       300   393.17497     -44073.096      1211.1542     -7078.8565      1.9525358      3659.697     
       400   341.50667     -44162.038      7913.201      -5761.0699      1.9525358      3659.697     
       500   295.84906     -44209.187      5491.8649     -6777.4272      1.9525358      3659.697     
       600   282.31452     -44247.015     -5543.8252     -11144.998      1.9525358      3659.697     
       700   283.481       -44269.891      4184.8378     -5515.5519      1.9525358      3659.697     
       800   284.08298     -44256.915     -2109.4199     -1319.246       1.9525358      3659.697     
       900   313.45681     -44256.089     -2028.3296     -3766.2932      1.9525358      3659.697     
      1000   298.18214     -44225.18      -1924.1231     -1348.2062      1.9525358      3659.697     
      1100   312.09253     -44240.133     -1798.2958     -6574.4288      1.9525358      3659.697     
      1200   313.08627     -44259.874     -12021.533     -11578.65       1.9525358      3659.697     
      1300   313.71648     -44294.202     -2721.8391     -7009.0915      1.9525358      3659.697     
      1400   282.00449     -44298.798     -149.98277     -13016.107      1.9525358      3659.697     
      1500   293.92582     -44319.884     -2285.4836     -12646.597      1.9525358      3659.697     
      1600   280.18657     -44285.806     -8576.4799     -15226.182      1.9525358      3659.697     
      1700   310.36768     -44287.703     -4590.3589     -10995.93       1.9525358      3659.697     
      1800   313.24526     -44276.286      777.31426     -10214.924      1.9525358      3659.697     
      1900   314.01998     -44294.153     -5367.7754     -12060.526      1.9525358      3659.697     
      2000   297.57615     -44308.157      4937.6857     -10846.978      1.9525358      3659.697     
      2100   300.25404     -44328.294     -7391.909      -9500.0499      1.9525358      3659.697     
      2200   296.27262     -44320.627     -10745.644     -12974.744      1.9525358      3659.697     
      2300   292.37136     -44290.05      -2296.2793     -14471.734      1.9525358      3659.697     
      2400   314.53135     -44285.083     -10056.945     -5820.7901      1.9525358      3659.697     
      2500   318.36978     -44282.394      3138.0747     -5789.7155      1.9525358      3659.697     
      2600   303.09921     -44287.021      9501.509      -10485.347      1.9525358      3659.697     
      2700   289.29067     -44304.412      85.032593     -11821.531      1.9525358      3659.697     
      2800   273.74553     -44304.487     -1822.301      -5778.9498      1.9525358      3659.697     
      2900   298.69053     -44317.052     -9247.0211     -6781.3396      1.9525358      3659.697     
      3000   279.8848      -44271.102      3186.9141     -9211.538       1.9525358      3659.697     
Loop time of 177.529 on 8 procs for 3000 steps with 366 atoms

Performance: 0.730 ns/day, 32.876 hours/ns, 16.899 timesteps/s, 6.185 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 103.66     | 142.19     | 152.06     | 123.8 | 80.10
Bond    | 0.0081777  | 0.0089983  | 0.0099493  |   0.7 |  0.01
Neigh   | 7.528      | 10.162     | 10.686     |  31.4 |  5.72
Comm    | 1.9679     | 11.853     | 50.414     | 429.3 |  6.68
Output  | 0.0017499  | 0.001902   | 0.0028115  |   0.8 |  0.00
Modify  | 12.724     | 13.232     | 15.854     |  27.4 |  7.45
Other   |            | 0.0786     |            |       |  0.04

Nlocal:          45.75 ave          56 max          33 min
Histogram: 1 0 0 2 0 1 2 0 0 2
Nghost:        3567.25 ave        3625 max        3511 min
Histogram: 1 0 1 0 3 0 1 1 0 1
Neighs:        32074.4 ave       39197 max       23648 min
Histogram: 1 0 0 2 0 2 1 0 0 2

Total # of neighbors = 256595
Ave neighs/atom = 701.07923
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-HD-100C-20-VASP_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.1249
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.4224
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 16.909

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--9211.53798857196)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--9211.53798857196)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-3564.7356185873)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1-3564.7356185873)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-4419.96811899667)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1-4419.96811899667)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-2908.7329816477)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1-2908.7329816477)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--1929.95667144916)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--1929.95667144916)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--5056.95982999594)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--5056.95982999594)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 16.1249
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.1249
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.161249 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.161249 xy delta 0.082539 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.161249 xy delta 0.082539 xz delta -0.006162 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.963651 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.963651 13.4224 16.909) with tilt (-8.171361 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.963651 13.4224 16.909) with tilt (-8.171361 0.610038 -0.6491)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.9 | 139.8 | 141.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   279.8848      -44263.136      45421.893      0              3623.1       
       100   320.57787     -44290.239      12740.098      2708.129       3623.1       
       200   318.71495     -44302.011     -2501.8522      3211.2114      3623.1       
       300   294.66961     -44306.957     -4927.9833      1010.7466      3623.1       
       400   293.71796     -44314.327      6924.6917     -25.342793      3623.1       
       500   293.88959     -44298.115     -3110.8808     -992.1249       3623.1       
       600   297.47931     -44276.138      13735.068     -1072.6663      3623.1       
       700   310.38204     -44289.913      14177.091      1394.4257      3623.1       
       800   301.34387     -44289.355     -12348.9        243.06043      3623.1       
       900   315.32302     -44316.028      777.10832     -4391.987       3623.1       
      1000   291.65903     -44312.635      5026.0433     -5585.5933      3623.1       
      1100   282.59938     -44317.346      4187.1164      1882.7173      3623.1       
      1200   278.78482     -44298.94      -2886.9158     -4125.8712      3623.1       
      1300   318.45775     -44298.182      414.99993     -1604.0984      3623.1       
      1400   311.40188     -44302.073      3991.7427      3383.0868      3623.1       
      1500   295.66448     -44309.426      785.86894     -1833.1882      3623.1       
      1600   283.25872     -44307.888     -2553.0762     -6471.6354      3623.1       
      1700   289.83569     -44307.426      11651.409      1014.508       3623.1       
      1800   326.67474     -44314.869      10429.685      386.64431      3623.1       
      1900   304.80888     -44280.637      2019.9082      595.02914      3623.1       
      2000   315.06366     -44306.434      9731.2958     -1083.1486      3623.1       
      2100   290.6151      -44295.574      2346.6429     -767.16081      3623.1       
      2200   312.58076     -44316.305      9345.414       3005.691       3623.1       
      2300   286.74951     -44285.311      5198.04        1096.6139      3623.1       
      2400   304.86781     -44291.605      2002.4782      700.38879      3623.1       
      2500   312.51777     -44280.636      10041.406      1338.5983      3623.1       
      2600   319.59222     -44277.21       1440.773       2479.6476      3623.1       
      2700   310.27584     -44299.469     -7471.4219      4248.0012      3623.1       
      2800   274.22285     -44283.896      5441.3275      4992.3538      3623.1       
      2900   290.51113     -44299.399      15838.166     -1858.5928      3623.1       
      3000   288.98639     -44278.783      7187.3353     -4967.4755      3623.1       
Loop time of 180.511 on 8 procs for 3000 steps with 366 atoms

Performance: 0.718 ns/day, 33.428 hours/ns, 16.619 timesteps/s, 6.083 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 108.84     | 140.84     | 153.88     | 133.3 | 78.02
Bond    | 0.0083731  | 0.0091224  | 0.0097375  |   0.5 |  0.01
Neigh   | 7.8161     | 10.045     | 10.8       |  34.2 |  5.56
Comm    | 2.5994     | 15.661     | 47.64      | 399.7 |  8.68
Output  | 0.0077955  | 0.0097579  | 0.011089   |   1.2 |  0.01
Modify  | 13.137     | 13.865     | 16.129     |  29.2 |  7.68
Other   |            | 0.07746    |            |       |  0.04

Nlocal:          45.75 ave          54 max          35 min
Histogram: 1 0 1 1 0 1 1 0 2 1
Nghost:        3601.25 ave        3651 max        3552 min
Histogram: 2 1 0 0 1 0 1 1 0 2
Neighs:          32397 ave       37762 max       25273 min
Histogram: 1 0 1 1 0 1 1 0 1 2

Total # of neighbors = 259176
Ave neighs/atom = 708.13115
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138 | 139.8 | 141.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   288.98639     -44278.783      7187.3081      0              3623.1       
       100   294.21402     -44282.573     -4965.1696     -2916.6533      3623.1       
       200   303.32997     -44288.378      19536.066      2966.0042      3623.1       
       300   298.64371     -44294.221      16298.741      5879.459       3623.1       
       400   293.73973     -44305.889      3876.9448      4464.7661      3623.1       
       500   284.94131     -44297.839      6651.5818      4679.7063      3623.1       
       600   313.3507      -44310.385      6276.7136      5564.7945      3623.1       
       700   301.45214     -44268.517      8050.7969     -2596.5612      3623.1       
       800   314.309       -44288.591      4878.8463      162.41211      3623.1       
       900   296.02604     -44291.567     -162.98496      2377.2437      3623.1       
      1000   306.68062     -44307.712      839.98827     -1295.3465      3623.1       
      1100   282.05441     -44282.366     -6254.792       1769.5196      3623.1       
      1200   313.26347     -44306.199      10812.256     -797.07438      3623.1       
      1300   307.43388     -44269.152      9588.8397      3096.5372      3623.1       
      1400   315.70401     -44270.81      -4714.0438     -3722.001       3623.1       
      1500   298.63968     -44291.169      4162.2739      158.12562      3623.1       
      1600   294.6054      -44294.193     -5204.037      -5991.7995      3623.1       
      1700   295.79044     -44288.374     -2826.7661     -10927.779      3623.1       
      1800   314.19967     -44296.48       1500.3053     -1805.7932      3623.1       
      1900   299.88543     -44289.539      11321.433     -3737.8875      3623.1       
      2000   301.86819     -44323.617      8760.8385     -2274.1452      3623.1       
      2100   305.6871      -44337.172      10172.453      5586.3069      3623.1       
      2200   310.39398     -44329.075      3581.76        645.27098      3623.1       
      2300   292.53743     -44276.637     -3396.7554      5006.5656      3623.1       
      2400   316.96684     -44291.949      6968.1423      1124.8262      3623.1       
      2500   302.91023     -44288.334     -2968.0849     -495.02525      3623.1       
      2600   316.44697     -44319.058      7547.9183      3861.6936      3623.1       
      2700   301.20323     -44323.029      2554.644      -3639.5607      3623.1       
      2800   297.44761     -44327.412      8736.7622      473.93056      3623.1       
      2900   305.15469     -44312.073      3565.1814     -3939.2865      3623.1       
      3000   301.2808      -44275.244      3458.2946     -2210.3111      3623.1       
Loop time of 180.349 on 8 procs for 3000 steps with 366 atoms

Performance: 0.719 ns/day, 33.398 hours/ns, 16.634 timesteps/s, 6.088 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 106.49     | 137.21     | 154.32     | 160.2 | 76.08
Bond    | 0.0085575  | 0.0092262  | 0.0099526  |   0.5 |  0.01
Neigh   | 7.6313     | 9.7879     | 10.851     |  41.2 |  5.43
Comm    | 2.2099     | 19.34      | 50.043     | 426.8 | 10.72
Output  | 0.0013662  | 0.0015674  | 0.0028228  |   1.2 |  0.00
Modify  | 12.881     | 13.923     | 16.067     |  34.6 |  7.72
Other   |            | 0.0772     |            |       |  0.04

Nlocal:          45.75 ave          53 max          35 min
Histogram: 1 0 1 1 0 0 0 2 2 1
Nghost:        3605.62 ave        3644 max        3562 min
Histogram: 1 0 0 2 1 1 0 1 1 1
Neighs:        32390.5 ave       37506 max       25271 min
Histogram: 1 0 1 1 0 0 1 2 1 1

Total # of neighbors = 259124
Ave neighs/atom = 707.98907
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 70.9399315449249
variable C2neg equal ${d2}
variable C2neg equal 35.4439265715332
variable C3neg equal ${d3}
variable C3neg equal 22.2117540471256
variable C4neg equal ${d4}
variable C4neg equal 0.636690397958581
variable C5neg equal ${d5}
variable C5neg equal 12.4226599774535
variable C6neg equal ${d6}
variable C6neg equal 17.3135890446877

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.1249
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.161249 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.161249 xy delta -0.082539 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.161249 xy delta -0.082539 xz delta 0.006162 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.286149 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.286149 13.4224 16.909) with tilt (-8.336439 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.286149 13.4224 16.909) with tilt (-8.336439 0.622362 -0.6491)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.1 | 138.1 | 139.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   279.8848      -44251.07      -31844.817      0              3696.294     
       100   314.98216     -44271.304     -7285.3587     -19348.941      3696.294     
       200   311.29223     -44279.039     -9231.673      -11712.103      3696.294     
       300   285.35342     -44284.466     -2377.5011     -15782.317      3696.294     
       400   292.14132     -44293.309     -9589.5599     -21402.321      3696.294     
       500   292.83387     -44278.811     -1856.128      -12828.915      3696.294     
       600   321.3962      -44280.565     -11216.776     -19881.193      3696.294     
       700   315.29109     -44266.804     -12776.11      -16266.486      3696.294     
       800   308.54384     -44268.128     -13467.165     -14153.127      3696.294     
       900   301.06086     -44265.325     -69.898337     -11346.9        3696.294     
      1000   303.76722     -44280.038     -5825.9304     -22093.604      3696.294     
      1100   298.20278     -44288.678     -12401.452     -20672.123      3696.294     
      1200   284.06813     -44293.809     -11316.607     -12124.469      3696.294     
      1300   296.8638      -44303.24      -3878.4889     -18467.215      3696.294     
      1400   317.23867     -44282.849     -3189.1863     -16244.392      3696.294     
      1500   304.54307     -44262.606     -8963.2351     -14676.927      3696.294     
      1600   311.61903     -44274.042     -1024.4635     -13407.589      3696.294     
      1700   307.72066     -44289.55      -11390.97      -17987.863      3696.294     
      1800   293.15911     -44295.792     -9543.2431     -17892.559      3696.294     
      1900   295.34972     -44293.219     -8608.2818     -12866.949      3696.294     
      2000   312.98556     -44268.155     -3275.3173     -14968.27       3696.294     
      2100   303.21337     -44253.608      3465.2585     -12152.01       3696.294     
      2200   307.24657     -44277.757     -4852.4469     -16314.388      3696.294     
      2300   288.87037     -44285.345     -3869.7306     -17008.212      3696.294     
      2400   293.54366     -44292.264     -14639.669     -20511.966      3696.294     
      2500   282.34682     -44267.688     -20177.256     -19740.335      3696.294     
      2600   308.58206     -44271.358     -12284.137     -12058.022      3696.294     
      2700   300.62856     -44253.968     -1738.3206     -13500.477      3696.294     
      2800   299.80846     -44259.223     -574.75425     -11737.593      3696.294     
      2900   312.90868     -44290.648     -5544.4775     -12845.755      3696.294     
      3000   294.1547      -44293.174     -14382.314     -20065.416      3696.294     
Loop time of 174.783 on 8 procs for 3000 steps with 366 atoms

Performance: 0.741 ns/day, 32.367 hours/ns, 17.164 timesteps/s, 6.282 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 102.45     | 135.11     | 149.03     | 155.7 | 77.30
Bond    | 0.0083333  | 0.0091134  | 0.0097392  |   0.4 |  0.01
Neigh   | 7.6307     | 9.7833     | 10.671     |  38.1 |  5.60
Comm    | 2.3131     | 16.247     | 48.875     | 448.8 |  9.30
Output  | 0.0071904  | 0.0091969  | 0.010559   |   1.2 |  0.01
Modify  | 12.679     | 13.547     | 15.745     |  32.7 |  7.75
Other   |            | 0.07607    |            |       |  0.04

Nlocal:          45.75 ave          52 max          32 min
Histogram: 1 0 0 0 0 0 1 3 1 2
Nghost:        3547.25 ave        3573 max        3517 min
Histogram: 1 1 1 0 0 0 2 1 1 1
Neighs:        31741.5 ave       36108 max       22653 min
Histogram: 1 0 0 0 0 1 2 2 0 2

Total # of neighbors = 253932
Ave neighs/atom = 693.80328
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.1 | 138.1 | 139.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   294.1547      -44293.174     -14382.228      0              3696.294     
       100   303.58837     -44295.04      -15277.677     -25460.484      3696.294     
       200   300.5844      -44261.297     -2139.74       -12991.269      3696.294     
       300   316.06635     -44259.335      3239.0676     -12696.915      3696.294     
       400   288.06763     -44245.41      -4803.8959     -16451.785      3696.294     
       500   305.27442     -44275.117      4828.6696     -16106.279      3696.294     
       600   293.1204      -44273.83       463.23804     -12209.325      3696.294     
       700   297.68142     -44290.642     -1692.677      -15272.283      3696.294     
       800   288.88993     -44292.763     -8102.5873     -19794.698      3696.294     
       900   276.98463     -44277.056      5198.0748     -16560.231      3696.294     
      1000   309.39053     -44276.774     -8220.7055     -14107.622      3696.294     
      1100   317.61715     -44282.14      -13686.127     -18116.039      3696.294     
      1200   297.49301     -44282.088     -3822.2804     -18794.688      3696.294     
      1300   286.59702     -44286.489     -2631.8806     -13272.138      3696.294     
      1400   293.94565     -44290.622     -6951.5935     -12724.462      3696.294     
      1500   299.19632     -44291.935     -15251.794     -20632.926      3696.294     
      1600   300.81084     -44283.387     -148.13461     -22959.135      3696.294     
      1700   317.50627     -44287.326     -7526.0011     -15911.196      3696.294     
      1800   318.52282     -44294.956     -11298.776     -20716.291      3696.294     
      1900   304.72983     -44314.777     -12851.616     -18140.642      3696.294     
      2000   291.10057     -44305.01       6044.8033     -12822.734      3696.294     
      2100   309.56622     -44301.216      9381.038      -9572.8364      3696.294     
      2200   306.68909     -44282.942     -12585.342     -11301.609      3696.294     
      2300   317.6671      -44299.16      -8326.142      -16044.07       3696.294     
      2400   289.18431     -44278.779      4077.8984     -12296.99       3696.294     
      2500   296.69503     -44288.353     -5432.3769     -18580.033      3696.294     
      2600   303.86075     -44281.774     -6346.1771     -18028.411      3696.294     
      2700   294.74276     -44252.084     -3067.0678     -14985.474      3696.294     
      2800   324.40563     -44272.175     -6310.7908     -19766.925      3696.294     
      2900   302.78857     -44260.177      4654.9528     -7441.062       3696.294     
      3000   293.07686     -44286.153     -8190.2026     -14680.52       3696.294     
Loop time of 174.821 on 8 procs for 3000 steps with 366 atoms

Performance: 0.741 ns/day, 32.374 hours/ns, 17.160 timesteps/s, 6.281 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 102.5      | 131.44     | 149.86     | 173.4 | 75.18
Bond    | 0.0085315  | 0.0092136  | 0.0099369  |   0.4 |  0.01
Neigh   | 7.5542     | 9.5352     | 10.715     |  43.8 |  5.45
Comm    | 1.6256     | 20.07      | 49.012     | 443.5 | 11.48
Output  | 0.0012998  | 0.0016833  | 0.003631   |   1.8 |  0.00
Modify  | 12.505     | 13.694     | 15.681     |  36.8 |  7.83
Other   |            | 0.07507    |            |       |  0.04

Nlocal:          45.75 ave          51 max          35 min
Histogram: 1 0 0 1 0 1 0 1 2 2
Nghost:        3547.38 ave        3565 max        3532 min
Histogram: 1 1 0 3 0 0 1 0 0 2
Neighs:        31744.5 ave       35402 max       24758 min
Histogram: 1 0 0 1 0 1 0 2 1 2

Total # of neighbors = 253956
Ave neighs/atom = 693.86885
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 55.4144634470011
variable C2pos equal ${d2}
variable C2pos equal 34.9709085304703
variable C3pos equal ${d3}
variable C3pos equal 80.1119576328435
variable C4pos equal ${d4}
variable C4pos equal -3.76681648759161
variable C5pos equal ${d5}
variable C5pos equal 18.1996131475278
variable C6pos equal ${d6}
variable C6pos equal -17.8496549728985

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(70.9399315449249+${C1pos})
variable C11 equal 0.5*(70.9399315449249+55.4144634470011)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(35.4439265715332+${C2pos})
variable C21 equal 0.5*(35.4439265715332+34.9709085304703)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(22.2117540471256+${C3pos})
variable C31 equal 0.5*(22.2117540471256+80.1119576328435)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(0.636690397958581+${C4pos})
variable C41 equal 0.5*(0.636690397958581+-3.76681648759161)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(12.4226599774535+${C5pos})
variable C51 equal 0.5*(12.4226599774535+18.1996131475278)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(17.3135890446877+${C6pos})
variable C61 equal 0.5*(17.3135890446877+-17.8496549728985)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.4224
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4224
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.134224 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.134224 yz delta 0.006491 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.1249 13.288176 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.1249 13.288176 16.909) with tilt (-8.2539 0.6162 -0.642609)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.7 | 140.4 | 142 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   279.8848      -44252.427      46277.103      0              3623.1       
       100   312.9602      -44274.177      2761.7022     -2921.1467      3623.1       
       200   315.82096     -44290.646      2483.5565     -985.90436      3623.1       
       300   286.61982     -44289.883     -495.06293     -5124.5754      3623.1       
       400   291.36253     -44302.732      3112.1001     -6116.0768      3623.1       
       500   294.4609      -44289.274      3428.109      -9022.335       3623.1       
       600   315.43887     -44285.292      18110.076     -7107.2143      3623.1       
       700   297.65509     -44264.245      2961.4258     -6067.5157      3623.1       
       800   313.46413     -44293.957     -2156.1891     -3190.4207      3623.1       
       900   307.77031     -44295.762      5853.6734     -8842.2319      3623.1       
      1000   301.02018     -44307.196      437.8778      -11805.938      3623.1       
      1100   293.88255     -44314.686      5249.5708     -8385.2808      3623.1       
      1200   305.52716     -44313.15       5840.0616     -9300.7454      3623.1       
      1300   336.61707     -44316.672      3856.2157     -9474.0128      3623.1       
      1400   306.48443     -44289.988     -3112.7841     -4845.3983      3623.1       
      1500   291.24528     -44282.962     -1780.1864     -9374.4796      3623.1       
      1600   299.20681     -44297.234      13983.79      -7005.0061      3623.1       
      1700   288.1757      -44292.6        5474.8164     -6475.5835      3623.1       
      1800   286.14783     -44311.512     -2654.648      -11012.601      3623.1       
      1900   277.44272     -44306.834      7766.3907     -7791.6673      3623.1       
      2000   290.72103     -44296.002     -3336.9444     -7152.2543      3623.1       
      2100   302.83957     -44288.287      8647.2595     -8423.3865      3623.1       
      2200   300.82662     -44278.981     -3407.2162     -8108.9062      3623.1       
      2300   292.98004     -44276.068      823.53678     -2074.9126      3623.1       
      2400   313.16572     -44299.409      4844.3094     -5314.7711      3623.1       
      2500   296.3206      -44289.669      771.23103     -5895.6954      3623.1       
      2600   294.03987     -44288.986      37.840414     -10518.629      3623.1       
      2700   314.05364     -44301.833     -4998.7753     -13143          3623.1       
      2800   309.40798     -44298.667      1443.4343     -9438.7527      3623.1       
      2900   291.99143     -44301.318      5983.7172     -6934.3846      3623.1       
      3000   286.33925     -44323.62      -737.08071     -11160.391      3623.1       
Loop time of 184.928 on 8 procs for 3000 steps with 366 atoms

Performance: 0.701 ns/day, 34.246 hours/ns, 16.223 timesteps/s, 5.937 katom-step/s
98.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 143.52     | 149.79     | 156.38     |  36.9 | 81.00
Bond    | 0.0089797  | 0.009392   | 0.009981   |   0.4 |  0.01
Neigh   | 10.189     | 10.594     | 11.016     |   8.7 |  5.73
Comm    | 3.3723     | 10.008     | 16.228     | 144.2 |  5.41
Output  | 0.069929   | 0.080803   | 0.08841    |   2.6 |  0.04
Modify  | 13.998     | 14.366     | 14.725     |   6.5 |  7.77
Other   |            | 0.07978    |            |       |  0.04

Nlocal:          45.75 ave          54 max          35 min
Histogram: 1 0 2 0 0 0 2 0 1 2
Nghost:        3598.25 ave        3634 max        3561 min
Histogram: 2 1 0 1 0 0 0 1 1 2
Neighs:        32364.1 ave       37630 max       25230 min
Histogram: 1 0 2 0 0 0 2 0 1 2

Total # of neighbors = 258913
Ave neighs/atom = 707.41257
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.8 | 140.4 | 142 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   286.33925     -44323.62      -737.14647      0              3623.1       
       100   282.60333     -44302.109     -17802.639     -13807.287      3623.1       
       200   292.78868     -44285.531     -1078.7291     -11777.468      3623.1       
       300   299.71106     -44289.115      1909.929      -11301.971      3623.1       
       400   297.77271     -44295.661      6725.2391     -9687.651       3623.1       
       500   276.48713     -44285.174      941.18409     -5154.6316      3623.1       
       600   301.41551     -44314.192      5667.5047     -2165.9886      3623.1       
       700   304.9091      -44301.09      -728.9167      -6140.3883      3623.1       
       800   305.5827      -44281.87      -4419.1392     -988.85999      3623.1       
       900   307.63073     -44283.244     -1863.3733     -4793.5062      3623.1       
      1000   288.98507     -44292.613      8762.2939     -6998.3675      3623.1       
      1100   307.2141      -44334.026      10780.883      342.94524      3623.1       
      1200   280.66301     -44300.958      664.89247     -3955.8497      3623.1       
      1300   289.93102     -44292.54      -5589.3879     -7210.6211      3623.1       
      1400   315.36995     -44311.335      1607.0665     -4102.122       3623.1       
      1500   276.11904     -44268.992     -6055.3118     -8034.5943      3623.1       
      1600   309.31224     -44297.945     -4744.2231     -14058.009      3623.1       
      1700   324.35016     -44274.784      6823.4146     -6968.7802      3623.1       
      1800   321.96744     -44272.065      6443.3969     -6006.7746      3623.1       
      1900   305.45058     -44283.652      1196.8036     -7588.0594      3623.1       
      2000   295.89033     -44292.837     -5335.6587     -9238.4423      3623.1       
      2100   304.85677     -44323.682      5528.1041     -7711.6647      3623.1       
      2200   297.31622     -44322.162     -8571.7927     -8506.2929      3623.1       
      2300   298.93197     -44304.692     -7769.9682     -11970.225      3623.1       
      2400   293.04514     -44277.167      2428.1212     -8468.5384      3623.1       
      2500   303.38759     -44276.989      3352.3671     -6790.026       3623.1       
      2600   322.70017     -44282.462     -6434.668      -10622.175      3623.1       
      2700   307.00589     -44277.359      9038.6103     -8852.4314      3623.1       
      2800   312.84924     -44315.398     -7423.582      -15390.753      3623.1       
      2900   283.75048     -44301.464     -4991.9325     -12656.822      3623.1       
      3000   291.09182     -44309.023      8760.8105     -13756.885      3623.1       
Loop time of 180.58 on 8 procs for 3000 steps with 366 atoms

Performance: 0.718 ns/day, 33.441 hours/ns, 16.613 timesteps/s, 6.080 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 113.3      | 142.92     | 155.11     | 112.8 | 79.15
Bond    | 0.0085302  | 0.0091712  | 0.0097913  |   0.4 |  0.01
Neigh   | 8.1572     | 10.097     | 10.906     |  28.7 |  5.59
Comm    | 1.5624     | 13.778     | 43.371     | 363.2 |  7.63
Output  | 0.0014132  | 0.0015993  | 0.0027555  |   1.1 |  0.00
Modify  | 12.907     | 13.695     | 15.667     |  25.0 |  7.58
Other   |            | 0.07857    |            |       |  0.04

Nlocal:          45.75 ave          53 max          34 min
Histogram: 1 0 0 2 0 0 1 1 1 2
Nghost:        3574.88 ave        3621 max        3528 min
Histogram: 1 2 0 0 1 1 0 1 0 2
Neighs:        32395.8 ave       37058 max       24609 min
Histogram: 1 0 0 2 0 0 1 1 0 3

Total # of neighbors = 259166
Ave neighs/atom = 708.10383
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -46.0557284101932
variable C2neg equal ${d2}
variable C2neg equal 17.1494986265507
variable C3neg equal ${d3}
variable C3neg equal -32.2882070929466
variable C4neg equal ${d4}
variable C4neg equal 1.56306495429101
variable C5neg equal ${d5}
variable C5neg equal -16.6436337951881
variable C6neg equal ${d6}
variable C6neg equal 5.34762039230964

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4224
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.134224 yz delta ${deltayz} remap units box
change_box all y delta 0 0.134224 yz delta -0.006491 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.1249 13.556624 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.1249 13.556624 16.909) with tilt (-8.2539 0.6162 -0.655591)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137 | 137.9 | 138.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   279.8848      -44255.585     -36403.312      0              3696.294     
       100   322.22257     -44284.011     -8302.3065     -10459.436      3696.294     
       200   310.96486     -44287.085     -9456.8984     -10908.191      3696.294     
       300   289.90915     -44296.509     -11123.755     -14547.106      3696.294     
       400   280.01551     -44288.876     -8550.6241     -17716.044      3696.294     
       500   305.46938     -44295.803     -4861.2577     -12187.332      3696.294     
       600   301.51242     -44269.473     -7873.5192     -14488.637      3696.294     
       700   308.82638     -44275.003     -6417.8979     -10802.522      3696.294     
       800   297.82339     -44271.697     -2559.4739     -10266.622      3696.294     
       900   307.67057     -44288.93      -12212.203     -13353.899      3696.294     
      1000   300.97266     -44299.785      8860.0885     -10871.665      3696.294     
      1100   285.83288     -44295.768     -13203.383     -13207.524      3696.294     
      1200   287.02515     -44304.307      541.52192     -9634.6981      3696.294     
      1300   289.36347     -44295.503     -8627.9522     -12709.917      3696.294     
      1400   292.13625     -44275.617     -6705.1407     -14897.893      3696.294     
      1500   308.35271     -44276.878     -12947.911     -7645.7626      3696.294     
      1600   314.49775     -44280.2       -19987.436     -9610.7124      3696.294     
      1700   295.1981      -44288.482     -6450.1884     -13645.777      3696.294     
      1800   277.71958     -44294.671     -8554.0446     -16076.381      3696.294     
      1900   289.28004     -44298.414     -12038.624     -13348.976      3696.294     
      2000   305.86396     -44288.676     -5866.8032     -13875.679      3696.294     
      2100   309.83981     -44285.671     -2149.5275     -7729.072       3696.294     
      2200   294.13317     -44272.035     -5313.1119     -9942.5352      3696.294     
      2300   321.21016     -44305.568     -2175.7078     -12157.151      3696.294     
      2400   293.99968     -44308.971     -10408.127     -15188.76       3696.294     
      2500   273.9628      -44300.813     -6199.8477     -11819.816      3696.294     
      2600   296.47087     -44301.376      4973.5005     -8277.8539      3696.294     
      2700   307.88024     -44293.437     -814.11562     -9552.4256      3696.294     
      2800   312.96716     -44291.828     -629.52991     -8883.2104      3696.294     
      2900   313.70262     -44301.151     -11032.465     -18109.575      3696.294     
      3000   291.86447     -44309.557     -8582.2437     -14373.168      3696.294     
Loop time of 174.057 on 8 procs for 3000 steps with 366 atoms

Performance: 0.745 ns/day, 32.233 hours/ns, 17.236 timesteps/s, 6.308 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 103.54     | 137.77     | 148.91     | 130.5 | 79.15
Bond    | 0.0086613  | 0.0090784  | 0.0096649  |   0.3 |  0.01
Neigh   | 7.5833     | 9.9785     | 10.724     |  34.3 |  5.73
Comm    | 1.7133     | 12.892     | 47.107     | 426.6 |  7.41
Output  | 0.0064894  | 0.0082073  | 0.0093389  |   1.1 |  0.00
Modify  | 12.564     | 13.324     | 15.739     |  29.9 |  7.66
Other   |            | 0.07698    |            |       |  0.04

Nlocal:          45.75 ave          53 max          36 min
Histogram: 1 1 0 0 1 2 0 0 1 2
Nghost:         3552.5 ave        3581 max        3524 min
Histogram: 1 1 0 0 2 1 1 0 1 1
Neighs:        31768.5 ave       36450 max       25476 min
Histogram: 1 1 0 0 1 2 0 0 1 2

Total # of neighbors = 254148
Ave neighs/atom = 694.39344
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.1 | 137.9 | 138.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   291.86447     -44309.557     -8582.4139      0              3696.294     
       100   301.7302      -44312.541      221.58283     -11898.838      3696.294     
       200   276.91066     -44253.237     -1891.0977     -11878.212      3696.294     
       300   304.67778     -44267.559      10540.94      -10975.46       3696.294     
       400   310.87318     -44291.366     -12154.406     -14208.609      3696.294     
       500   303.63992     -44303.233     -5516.724      -9865.9146      3696.294     
       600   295.26021     -44309.51      -3450.1908     -9914.8353      3696.294     
       700   280.76166     -44295.896     -13956.533     -14429.416      3696.294     
       800   306.48069     -44311.329     -3856.4896     -13946.812      3696.294     
       900   288.66187     -44251.226     -16652.489     -12995.301      3696.294     
      1000   311.72641     -44277.757     -7951.263      -11615.786      3696.294     
      1100   290.94951     -44283.452     -4333.7689     -14728.418      3696.294     
      1200   290.78932     -44296.506     -5835.082      -12015.463      3696.294     
      1300   297.98939     -44309.008     -337.46493     -10145.652      3696.294     
      1400   292.45954     -44304.947     -501.85257     -14779.318      3696.294     
      1500   308.97884     -44325.049      7015.5507     -4824.4719      3696.294     
      1600   315.28288     -44311.861     -8989.8911     -17831.7        3696.294     
      1700   307.69878     -44283.077     -7838.7694     -16342.203      3696.294     
      1800   304.63178     -44283.276     -6758.0124     -7199.0669      3696.294     
      1900   297.30427     -44305.512     -3024.8683     -11559.797      3696.294     
      2000   280.31366     -44305.705      908.03713     -10758.86       3696.294     
      2100   300.04085     -44318.933     -7644.2845     -10677.2        3696.294     
      2200   296.6629      -44299.77      -8032.6002     -13044.751      3696.294     
      2300   290.39604     -44282.669      5405.1756     -9031.7684      3696.294     
      2400   303.06291     -44295.473     -11480.124     -13028.899      3696.294     
      2500   311.84665     -44316.393     -13555.173     -16462.045      3696.294     
      2600   281.64417     -44318.489     -2125.2771     -10932.665      3696.294     
      2700   285.34462     -44326.59      -17644.444     -15822.106      3696.294     
      2800   290.53568     -44304.515     -7157.5879     -12568.45       3696.294     
      2900   302.0995      -44296.811     -7563.8764     -14948.326      3696.294     
      3000   330.26759     -44314.244      365.05674     -14612.964      3696.294     
Loop time of 173.961 on 8 procs for 3000 steps with 366 atoms

Performance: 0.745 ns/day, 32.215 hours/ns, 17.245 timesteps/s, 6.312 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 103        | 133.12     | 148.99     | 130.1 | 76.52
Bond    | 0.0088226  | 0.0092506  | 0.0098939  |   0.3 |  0.01
Neigh   | 7.5514     | 9.6843     | 10.664     |  33.6 |  5.57
Comm    | 1.6287     | 17.539     | 47.646     | 358.5 | 10.08
Output  | 0.0012831  | 0.0015573  | 0.0025683  |   1.0 |  0.00
Modify  | 12.58      | 13.534     | 15.681     |  28.4 |  7.78
Other   |            | 0.07642    |            |       |  0.04

Nlocal:          45.75 ave          55 max          35 min
Histogram: 1 0 1 1 0 0 2 2 0 1
Nghost:        3539.62 ave        3569 max        3517 min
Histogram: 2 0 0 1 2 1 1 0 0 1
Neighs:        31751.4 ave       37672 max       24758 min
Histogram: 1 0 2 0 0 1 1 2 0 1

Total # of neighbors = 254011
Ave neighs/atom = 694.01913
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 54.7299461145615
variable C2pos equal ${d2}
variable C2pos equal 104.001092708885
variable C3pos equal ${d3}
variable C3pos equal 152.785420046072
variable C4pos equal ${d4}
variable C4pos equal -8.99059795771804
variable C5pos equal ${d5}
variable C5pos equal -10.5353837055713
variable C6pos equal ${d6}
variable C6pos equal -3.77627322559471

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(-46.0557284101932+${C1pos})
variable C12 equal 0.5*(-46.0557284101932+54.7299461145615)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(17.1494986265507+${C2pos})
variable C22 equal 0.5*(17.1494986265507+104.001092708885)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(-32.2882070929466+${C3pos})
variable C32 equal 0.5*(-32.2882070929466+152.785420046072)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(1.56306495429101+${C4pos})
variable C42 equal 0.5*(1.56306495429101+-8.99059795771804)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(-16.6436337951881+${C5pos})
variable C52 equal 0.5*(-16.6436337951881+-10.5353837055713)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(5.34762039230964+${C6pos})
variable C62 equal 0.5*(5.34762039230964+-3.77627322559471)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.909
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.909
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.16909 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.1249 13.4224 16.73991) with tilt (-8.2539 0.6162 -0.6491)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.7 | 140.3 | 141.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   279.8848      -44252.828      43632.192      0              3623.1       
       100   317.56803     -44280.364      6968.0145     -2161.5885      3623.1       
       200   325.89529     -44308.044     -5379.612      -3610.3939      3623.1       
       300   299.4934      -44308.297      8020.7658     -107.29042      3623.1       
       400   286.69428     -44302.467     -3620.2709     -2785.0934      3623.1       
       500   287.87567     -44293.061      16288.187     -1975.0364      3623.1       
       600   297.10324     -44270.273     -8483.8111     -3592.4601      3623.1       
       700   322.02033     -44276.851      14218.373     -2121.4592      3623.1       
       800   303.3669      -44268.444      5543.8117     -371.59809      3623.1       
       900   308.07704     -44288.72       3122.2046     -2078.4088      3623.1       
      1000   278.45026     -44271.294     -2221.8992     -6157.0124      3623.1       
      1100   303.79579     -44299.565     -6776.6752     -7656.4086      3623.1       
      1200   302.92311     -44281.598     -4269.2121     -3517.4518      3623.1       
      1300   328.55446     -44277.348      2992.9639     -4000.1223      3623.1       
      1400   305.52458     -44265.954     -1205.128      -744.08294      3623.1       
      1500   311.12249     -44295.72       4201.0335     -2715.8582      3623.1       
      1600   300.29825     -44296.827      9065.7111     -5346.3002      3623.1       
      1700   298.77275     -44301.247      2177.1965     -6471.2704      3623.1       
      1800   286.17449     -44300.469      2423.8944     -5822.6646      3623.1       
      1900   280.6113      -44309.161      8654.9325     -1014.5378      3623.1       
      2000   294.09439     -44311.03      -1427.9827     -8279.061       3623.1       
      2100   308.61244     -44296.942      5355.3665     -4061.4218      3623.1       
      2200   310.4158      -44292.481      442.62325     -11637.876      3623.1       
      2300   293.1859      -44288.252      801.86565     -8964.1877      3623.1       
      2400   292.35721     -44313.468      20201.89      -4308.7543      3623.1       
      2500   277.06994     -44322.751     -664.69843     -599.04741      3623.1       
      2600   274.80269     -44308.007      1777.4673     -4273.4978      3623.1       
      2700   301.76877     -44313.699      1337.2226     -7915.2327      3623.1       
      2800   309.782       -44312.682      10010.547     -2987.2549      3623.1       
      2900   297.33535     -44296.485      4908.1717     -1679.7904      3623.1       
      3000   301.57808     -44294.248      3550.687      -4866.8179      3623.1       
Loop time of 180.665 on 8 procs for 3000 steps with 366 atoms

Performance: 0.717 ns/day, 33.456 hours/ns, 16.605 timesteps/s, 6.078 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 105.96     | 141.56     | 155.56     | 139.9 | 78.35
Bond    | 0.0086333  | 0.0091     | 0.0097901  |   0.4 |  0.01
Neigh   | 7.6879     | 10.079     | 11.045     |  36.2 |  5.58
Comm    | 1.2024     | 15.243     | 50.815     | 426.5 |  8.44
Output  | 0.0074037  | 0.0096161  | 0.011356   |   1.4 |  0.01
Modify  | 12.756     | 13.691     | 16.111     |  31.1 |  7.58
Other   |            | 0.07712    |            |       |  0.04

Nlocal:          45.75 ave          53 max          36 min
Histogram: 1 0 2 0 0 1 0 1 1 2
Nghost:        3610.38 ave        3649 max        3568 min
Histogram: 1 0 0 1 2 1 1 1 0 1
Neighs:        32389.1 ave       37561 max       25993 min
Histogram: 1 0 2 0 1 0 0 2 0 2

Total # of neighbors = 259113
Ave neighs/atom = 707.95902
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.8 | 140.3 | 141.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   301.57808     -44294.248      3550.6352      0              3623.1       
       100   299.93299     -44295.172      13253.412     -4102.1304      3623.1       
       200   299.68897     -44304.535      3340.3689     -9832.7784      3623.1       
       300   289.35998     -44317.541      8066.4208     -8740.1973      3623.1       
       400   277.57312     -44305.364      4646.6527     -8084.1296      3623.1       
       500   296.83899     -44294.365      7563.583      -9166.0301      3623.1       
       600   306.25169     -44297.653      9409.3147     -4498.2541      3623.1       
       700   290.81264     -44287.132      7611.9621     -9817.7644      3623.1       
       800   304.30061     -44309.527      14899.89      -9845.3111      3623.1       
       900   300.30021     -44317.12       3306.1227     -9680.1622      3623.1       
      1000   280.0742      -44298.277      7392.0209     -8390.7227      3623.1       
      1100   297.11211     -44296.022      6769.6011     -1789.3142      3623.1       
      1200   316.98582     -44300.415      3666.7371     -4660.5102      3623.1       
      1300   311.13251     -44303.766     -7498.6024     -8153.5445      3623.1       
      1400   298.59387     -44327.077      8014.9116     -9335.8278      3623.1       
      1500   277.19923     -44312.82       5048.8692     -2336.7908      3623.1       
      1600   289.72878     -44312.569      5176.0291     -4582.4645      3623.1       
      1700   296.02828     -44300.587     -694.78834     -9202.4408      3623.1       
      1800   304.41745     -44303.922      2151.9158     -4710.0674      3623.1       
      1900   283.12265     -44282.418     -5973.6092     -4760.5638      3623.1       
      2000   282.58117     -44290.564      1295.326      -6405.4693      3623.1       
      2100   294.44282     -44329.405     -4943.0296     -5935.6049      3623.1       
      2200   292.88956     -44331.338      1613.4441     -4915.6582      3623.1       
      2300   308.27109     -44323.019     -5149.4329     -5727.1336      3623.1       
      2400   283.25182     -44274.278      4775.13       -9480.6426      3623.1       
      2500   298.18226     -44285.232     -1763.3319     -5842.5211      3623.1       
      2600   291.75352     -44290.675      9578.2539     -2934.6252      3623.1       
      2700   299.0673      -44299.847      9297.9098     -1959.7453      3623.1       
      2800   307.27608     -44315.709      10022.329     -2440.0979      3623.1       
      2900   270.55742     -44301.565      4735.4872     -6477.1549      3623.1       
      3000   277.73123     -44309.349      580.44206     -9087.0569      3623.1       
Loop time of 180.332 on 8 procs for 3000 steps with 366 atoms

Performance: 0.719 ns/day, 33.395 hours/ns, 16.636 timesteps/s, 6.089 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 106.39     | 138.22     | 155.41     | 153.1 | 76.65
Bond    | 0.0085357  | 0.0090789  | 0.0097902  |   0.4 |  0.01
Neigh   | 7.7052     | 9.8217     | 10.94      |  39.5 |  5.45
Comm    | 1.1781     | 18.403     | 50.223     | 419.7 | 10.21
Output  | 0.0013323  | 0.0017688  | 0.0042845  |   2.3 |  0.00
Modify  | 12.706     | 13.797     | 15.932     |  33.3 |  7.65
Other   |            | 0.0765     |            |       |  0.04

Nlocal:          45.75 ave          54 max          35 min
Histogram: 1 0 1 0 1 0 2 2 0 1
Nghost:        3597.62 ave        3627 max        3573 min
Histogram: 3 0 1 0 0 0 1 0 2 1
Neighs:        32397.8 ave       38194 max       25262 min
Histogram: 1 0 1 0 1 0 2 2 0 1

Total # of neighbors = 259182
Ave neighs/atom = 708.14754
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 1.26130485275984
variable C2neg equal ${d2}
variable C2neg equal 6.45280826761288
variable C3neg equal ${d3}
variable C3neg equal 59.528009357652
variable C4neg equal ${d4}
variable C4neg equal 19.1290178849319
variable C5neg equal ${d5}
variable C5neg equal -10.7284925218616
variable C6neg equal ${d6}
variable C6neg equal 6.20125330427231

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.005 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.909
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.16909 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.1249 13.4224 17.07809) with tilt (-8.2539 0.6162 -0.6491)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.4 | 138 | 139.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   279.8848      -44259.267     -35205.187      0              3696.294     
       100   317.89968     -44280.235     -6674.1554     -12443.886      3696.294     
       200   327.48297     -44298.424     -8050.1729     -9180.7186      3696.294     
       300   283.39049     -44282.275     -4887.8599     -12405.44       3696.294     
       400   283.24885     -44292.305     -4266.5057     -15575.062      3696.294     
       500   296.62941     -44292.13      -13167.589     -10367.711      3696.294     
       600   306.74846     -44277.204     -11940.308     -13786.891      3696.294     
       700   314.27329     -44269.471     -11826.972     -15118.033      3696.294     
       800   318.7288      -44281.039     -2473.1767     -8779.8723      3696.294     
       900   306.64633     -44282.293      455.74303     -10720.638      3696.294     
      1000   312.95073     -44310.092      1458.4768     -10057.379      3696.294     
      1100   294.80246     -44304.519     -8423.4075     -13330.008      3696.294     
      1200   288.27012     -44307.269     -1873.0146     -11385.28       3696.294     
      1300   294.66617     -44288.469     -7308.0949     -10739.823      3696.294     
      1400   281.32871     -44247.853     -6232.3984     -14577.034      3696.294     
      1500   324.71461     -44289.797      3143.6451     -10075.569      3696.294     
      1600   313.45405     -44301.316      1671.2714     -10550.427      3696.294     
      1700   276.8613      -44288.301     -14892.493     -12931.121      3696.294     
      1800   288.75541     -44301.519     -12609.873     -16446.203      3696.294     
      1900   293.93253     -44292.756     -7975.4334     -13137.071      3696.294     
      2000   304.94352     -44286.207      1566.1043     -14815.477      3696.294     
      2100   302.64371     -44281.683     -5752.551      -11798.133      3696.294     
      2200   289.50363     -44290.292      2399.7297     -8978.1767      3696.294     
      2300   292.49956     -44319.145     -672.81634     -13227.688      3696.294     
      2400   303.47783     -44325.494      289.37819     -16068.844      3696.294     
      2500   288.81564     -44280.314     -11380.294     -11418.776      3696.294     
      2600   293.56062     -44270.442     -8734.8234     -13640.329      3696.294     
      2700   320.21818     -44301.171     -14496.766     -13512.225      3696.294     
      2800   296.66514     -44291.266     -2870.1586     -15327.866      3696.294     
      2900   286.32987     -44298.786     -1816.6848     -12299.119      3696.294     
      3000   272.82274     -44299.07       2310.3266     -12176.686      3696.294     
Loop time of 174.083 on 8 procs for 3000 steps with 366 atoms

Performance: 0.744 ns/day, 32.238 hours/ns, 17.233 timesteps/s, 6.307 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 107.08     | 133.49     | 148.37     | 122.3 | 76.68
Bond    | 0.0085611  | 0.009042   | 0.010232   |   0.5 |  0.01
Neigh   | 7.7128     | 9.6778     | 10.818     |  33.8 |  5.56
Comm    | 2.1236     | 17.02      | 43.407     | 342.3 |  9.78
Output  | 0.0064946  | 0.0083697  | 0.0096548  |   1.2 |  0.00
Modify  | 12.609     | 13.798     | 15.8       |  28.8 |  7.93
Other   |            | 0.07747    |            |       |  0.04

Nlocal:          45.75 ave          54 max          34 min
Histogram: 1 0 0 1 1 0 0 3 1 1
Nghost:        3540.12 ave        3604 max        3484 min
Histogram: 1 0 1 1 2 1 0 1 0 1
Neighs:        31724.5 ave       37412 max       24032 min
Histogram: 1 0 1 1 0 0 2 1 1 1

Total # of neighbors = 253796
Ave neighs/atom = 693.43169
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136.1 | 137.9 | 139.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   272.82274     -44299.07       2310.4877      0              3696.294     
       100   294.97311     -44307.733     -5044.6367     -14364.794      3696.294     
       200   300.93807     -44284.021     -13373.464     -13826.681      3696.294     
       300   309.93417     -44292.905     -5187.9276     -11113.658      3696.294     
       400   306.97304     -44294.509      3531.7868     -8911.2327      3696.294     
       500   283.96066     -44284.571     -7249.2626     -18128.143      3696.294     
       600   283.92894     -44308.01      -9634.2205     -9458.308       3696.294     
       700   288.82766     -44319.157     -16949.325     -12788.656      3696.294     
       800   288.01644     -44282.111     -248.88422     -13258.926      3696.294     
       900   303.16386     -44284.259     -3501.6        -14766.85       3696.294     
      1000   289.67327     -44270.669     -10029.44      -11307.737      3696.294     
      1100   306.24952     -44299.622     -7759.1478     -11567.192      3696.294     
      1200   271.70955     -44280.912     -3236.0127     -12905.15       3696.294     
      1300   270.96852     -44292.026     -9995.0164     -16048.122      3696.294     
      1400   295.28112     -44299.713      402.66422     -12460.087      3696.294     
      1500   303.42869     -44277.681     -6197.695      -11825.322      3696.294     
      1600   305.2373      -44282.657      4752.0475     -12109.645      3696.294     
      1700   300.92253     -44289.545     -1035.8319     -14453.309      3696.294     
      1800   284.35219     -44294.235      671.24121     -15763.65       3696.294     
      1900   285.67439     -44320.823     -4398.8928     -14093.273      3696.294     
      2000   293.98026     -44315.56      -9609.1377     -15990.329      3696.294     
      2100   312.61435     -44300.006     -5315.0963     -17761.363      3696.294     
      2200   286.97414     -44267.35      -11193.98      -14500.599      3696.294     
      2300   309.65399     -44286.8       -1184.2755     -9510.6336      3696.294     
      2400   291.29024     -44277.96      -5161.7292     -16091.562      3696.294     
      2500   294.31426     -44306.586     -8772.1873     -16348.957      3696.294     
      2600   296.68735     -44320.348     -5438.6974     -12747.373      3696.294     
      2700   281.63124     -44278.796     -15146.228     -6498.5797      3696.294     
      2800   301.80165     -44271.113     -7548.2387     -14567.414      3696.294     
      2900   313.81539     -44286.699     -2469.1748     -12689.165      3696.294     
      3000   321.38226     -44306.069     -4920.0614     -14999.14       3696.294     
Loop time of 174.556 on 8 procs for 3000 steps with 366 atoms

Performance: 0.742 ns/day, 32.325 hours/ns, 17.186 timesteps/s, 6.290 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 101.75     | 135.37     | 149.88     | 161.1 | 77.55
Bond    | 0.008574   | 0.0092858  | 0.010571   |   0.6 |  0.01
Neigh   | 7.5505     | 9.7638     | 10.591     |  39.2 |  5.59
Comm    | 1.6158     | 16.148     | 49.799     | 466.6 |  9.25
Output  | 0.0013958  | 0.0015999  | 0.002522   |   0.9 |  0.00
Modify  | 12.373     | 13.184     | 15.434     |  33.9 |  7.55
Other   |            | 0.07574    |            |       |  0.04

Nlocal:          45.75 ave          55 max          34 min
Histogram: 1 0 0 2 1 1 0 1 0 2
Nghost:        3541.88 ave        3569 max        3516 min
Histogram: 1 0 1 2 1 0 1 0 0 2
Neighs:        31746.2 ave       38169 max       24047 min
Histogram: 1 0 0 2 1 1 0 1 0 2

Total # of neighbors = 253970
Ave neighs/atom = 693.9071
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 58.6428774232113
variable C2pos equal ${d2}
variable C2pos equal 60.3667939230214
variable C3pos equal ${d3}
variable C3pos equal 74.8804043202417
variable C4pos equal ${d4}
variable C4pos equal -9.11003425534985
variable C5pos equal ${d5}
variable C5pos equal -8.58143871030925
variable C6pos equal ${d6}
variable C6pos equal -3.79574182834281

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(1.26130485275984+${C1pos})
variable C13 equal 0.5*(1.26130485275984+58.6428774232113)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(6.45280826761288+${C2pos})
variable C23 equal 0.5*(6.45280826761288+60.3667939230214)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(59.528009357652+${C3pos})
variable C33 equal 0.5*(59.528009357652+74.8804043202417)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(19.1290178849319+${C4pos})
variable C43 equal 0.5*(19.1290178849319+-9.11003425534985)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-10.7284925218616+${C5pos})
variable C53 equal 0.5*(-10.7284925218616+-8.58143871030925)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(6.20125330427231+${C6pos})
variable C63 equal 0.5*(6.20125330427231+-3.79574182834281)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.909
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.909
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.16909 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.81819)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.5 | 139 | 140.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   279.8848      -44265.847      3625.3368      0              3659.697     
       100   309.39075     -44277.446      2706.1382     -7376.7955      3659.697     
       200   320.41714     -44294.387     -7527.9601     -4506.2494      3659.697     
       300   300.2743      -44303.042      5189.867      -6433.2738      3659.697     
       400   293.07385     -44307.203     -2986.7976     -11834.012      3659.697     
       500   294.44543     -44295.994     -1459.4495     -9104.4683      3659.697     
       600   300.34722     -44275.764     -5145.3385     -11954.731      3659.697     
       700   325.43099     -44278.547     -2883.1757     -8550.467       3659.697     
       800   302.11485     -44267.502      499.43422     -8482.1261      3659.697     
       900   299.92743     -44299.46       2998.5402     -9144.9805      3659.697     
      1000   283.81839     -44286.547     -1387.8858     -10660.72       3659.697     
      1100   322.33008     -44322.273      2991.5254     -10079.195      3659.697     
      1200   299.59689     -44300.971      6832.1202     -9875.524       3659.697     
      1300   308.33571     -44313.808     -6187.0438     -12391.329      3659.697     
      1400   302.98762     -44316.071      3582.5506     -12471.696      3659.697     
      1500   285.03692     -44297.588     -3886.7746     -10528.35       3659.697     
      1600   291.72409     -44284.294      3812.2021     -6308.227       3659.697     
      1700   310.47543     -44284.247     -1530.8389     -6803.3367      3659.697     
      1800   308.73835     -44273.919     -3218.9468     -11768.208      3659.697     
      1900   320.99098     -44308.971     -10387.643     -6850.4572      3659.697     
      2000   288.83217     -44303.759     -5380.7742     -14187.264      3659.697     
      2100   294.99776     -44303.164     -9979.8871     -16419.322      3659.697     
      2200   295.4836      -44280.951     -9901.6133     -10382.461      3659.697     
      2300   308.24205     -44275.239      6461.8065     -10298.785      3659.697     
      2400   313.44843     -44282.131     -2431.9343     -11391.383      3659.697     
      2500   300.15808     -44281.413      3487.0668     -8061.0726      3659.697     
      2600   295.7317      -44281.303     -4954.3906     -12568.81       3659.697     
      2700   316.46291     -44301.618      1208.6966     -12322.971      3659.697     
      2800   303.4834      -44294.675     -8873.627      -15400.011      3659.697     
      2900   303.02804     -44314.933     -10906.919     -16955.347      3659.697     
      3000   269.07013     -44297.1       -3183.0838     -11687.859      3659.697     
Loop time of 177.376 on 8 procs for 3000 steps with 366 atoms

Performance: 0.731 ns/day, 32.847 hours/ns, 16.913 timesteps/s, 6.190 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 107.24     | 139.11     | 151.69     | 122.8 | 78.43
Bond    | 0.008277   | 0.0093124  | 0.010218   |   0.6 |  0.01
Neigh   | 7.8286     | 9.9813     | 10.788     |  31.2 |  5.63
Comm    | 2.123      | 14.728     | 46.573     | 377.4 |  8.30
Output  | 0.0078293  | 0.0096777  | 0.010899   |   1.1 |  0.01
Modify  | 12.677     | 13.462     | 15.653     |  27.1 |  7.59
Other   |            | 0.07578    |            |       |  0.04

Nlocal:          45.75 ave          53 max          37 min
Histogram: 1 0 0 2 0 2 0 1 1 1
Nghost:        3570.38 ave        3610 max        3528 min
Histogram: 1 1 1 0 0 1 2 0 1 1
Neighs:        32096.8 ave       37267 max       26406 min
Histogram: 1 0 1 1 0 2 0 2 0 1

Total # of neighbors = 256774
Ave neighs/atom = 701.56831
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.5 | 139 | 140.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   269.07013     -44297.1       -3183.1758      0              3659.697     
       100   291.7392      -44303.924     -6252.988      -14886.36       3659.697     
       200   301.35179     -44289.136     -2393.5698     -11409.698      3659.697     
       300   319.13493     -44305.992      8239.5682     -16825.862      3659.697     
       400   287.70558     -44285.322     -8719.6343     -6434.3941      3659.697     
       500   293.18029     -44307.61       7052.1994     -4197.5348      3659.697     
       600   285.71629     -44292.499     -4985.3325     -8378.42        3659.697     
       700   318.37675     -44282.425     -5738.0928     -8695.8544      3659.697     
       800   336.01795     -44305.624     -11608.922     -8029.7728      3659.697     
       900   297.64749     -44295.095     -8531.4901     -14899.758      3659.697     
      1000   292.49747     -44296.834     -7040.2447     -10886.822      3659.697     
      1100   307.50809     -44313.133     -1274.1491     -6900.0055      3659.697     
      1200   294.39287     -44293.668     -10330.252     -13677.009      3659.697     
      1300   294.50361     -44267.123      8827.7205     -6688.288       3659.697     
      1400   294.81879     -44258.614     -3028.9511     -8452.5255      3659.697     
      1500   312.71391     -44298.509     -5351.4891     -8945.1165      3659.697     
      1600   293.24851     -44308.849     -6573.8196     -5694.6746      3659.697     
      1700   282.4835      -44301.795     -4517.21       -4838.1607      3659.697     
      1800   304.5668      -44314.66      -69.492525     -9859.9932      3659.697     
      1900   304.51167     -44289.048      5179.2302     -8762.4701      3659.697     
      2000   318.43771     -44282.504     -2536.7983     -6552.7551      3659.697     
      2100   314.04153     -44290.707      3963.7111     -6579.2767      3659.697     
      2200   296.37231     -44283.953      1860.1387     -15566.079      3659.697     
      2300   305.70138     -44305.921     -6099.8156     -8909.3224      3659.697     
      2400   282.37509     -44293.116     -16307.792     -13012.389      3659.697     
      2500   299.81416     -44312.972     -9593.0455     -10152.758      3659.697     
      2600   302.81356     -44289.156      3112.5432     -10608.454      3659.697     
      2700   338.97862     -44309.808     -5990.9401     -6732.7836      3659.697     
      2800   294.29335     -44280.431     -15814.259     -8451.8837      3659.697     
      2900   310.63956     -44315.615      825.54762     -12847.093      3659.697     
      3000   300.74513     -44305.438     -477.3848      -5478.4676      3659.697     
Loop time of 177.454 on 8 procs for 3000 steps with 366 atoms

Performance: 0.730 ns/day, 32.862 hours/ns, 16.906 timesteps/s, 6.188 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 102.45     | 137.59     | 151.52     | 164.8 | 77.53
Bond    | 0.0087783  | 0.0092893  | 0.010326   |   0.5 |  0.01
Neigh   | 7.5363     | 9.9169     | 10.8       |  42.0 |  5.59
Comm    | 2.1109     | 16.081     | 51.214     | 481.9 |  9.06
Output  | 0.0012933  | 0.0016604  | 0.0036076  |   1.8 |  0.00
Modify  | 12.868     | 13.783     | 16.167     |  35.8 |  7.77
Other   |            | 0.07625    |            |       |  0.04

Nlocal:          45.75 ave          53 max          36 min
Histogram: 1 0 0 1 2 1 0 1 0 2
Nghost:        3584.62 ave        3618 max        3549 min
Histogram: 2 0 0 1 2 0 0 1 0 2
Neighs:        32080.5 ave       37176 max       25675 min
Histogram: 1 0 0 2 1 1 0 1 0 2

Total # of neighbors = 256644
Ave neighs/atom = 701.21311
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 37.825335425525
variable C2neg equal ${d2}
variable C2neg equal 8.08742280186351
variable C3neg equal ${d3}
variable C3neg equal -49.0655477589175
variable C4neg equal ${d4}
variable C4neg equal 8.34402303629771
variable C5neg equal ${d5}
variable C5neg equal 12.5010372207803
variable C6neg equal ${d6}
variable C6neg equal 1.06827197865716

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.909
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.16909 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.48001)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.5 | 139.1 | 140.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   279.8848      -44267.896      2506.2241      0              3659.697     
       100   304.58494     -44274.648      4340.004      -6426.5857      3659.697     
       200   316.73978     -44292.604     -4238.0579     -4035.4162      3659.697     
       300   296.84627     -44300.085     -3582.0144     -9179.6368      3659.697     
       400   290.95516     -44307.937     -6860.4513     -10311.219      3659.697     
       500   288.75745     -44297.326      1161.7935     -7209.5678      3659.697     
       600   325.7248      -44311.047     -5568.199      -10314.66       3659.697     
       700   307.20475     -44269.519      748.32916     -6144.9424      3659.697     
       800   314.42435     -44250.457     -4944.8288     -5389.6448      3659.697     
       900   323.09762     -44269.343      2924.9534     -10028.377      3659.697     
      1000   318.48991     -44305.477     -11458.74      -11564.935      3659.697     
      1100   304.63665     -44306.689     -5405.99       -8881.9457      3659.697     
      1200   303.89451     -44312.367     -345.34337     -6500.2971      3659.697     
      1300   286.89939     -44298.133      5795.3048     -5129.1892      3659.697     
      1400   303.93589     -44311.466      4488.1981     -12095.373      3659.697     
      1500   315.9909      -44298.342     -8023.5682     -8498.5814      3659.697     
      1600   320.86524     -44296.964      2906.7722     -10097.049      3659.697     
      1700   287.53978     -44289.985     -3634.8526     -5046.1524      3659.697     
      1800   302.29716     -44317.773      5881.3571     -8961.8823      3659.697     
      1900   301.68425     -44312.962      4819.3637     -7389.3477      3659.697     
      2000   287.37431     -44292.236     -1790.2437     -6308.0996      3659.697     
      2100   295.50133     -44289.867     -7457.3437     -8088.826       3659.697     
      2200   319.31553     -44280.031     -12049.643     -11818.893      3659.697     
      2300   312.33416     -44271.214      514.827       -5939.6998      3659.697     
      2400   317.26794     -44303.324      1521.3297     -8999.5425      3659.697     
      2500   312.7569      -44311.784      1823.3564     -9791.0586      3659.697     
      2600   305.47825     -44309.478      10705.512     -4767.1388      3659.697     
      2700   284.64097     -44286.452     -4348.7701     -4540.3591      3659.697     
      2800   302.52786     -44280.58      -13475.672     -12933.011      3659.697     
      2900   302.74394     -44258.044      4832.6381     -7252.7476      3659.697     
      3000   300.26069     -44282.693     -2036.2418     -9934.1101      3659.697     
Loop time of 177.611 on 8 procs for 3000 steps with 366 atoms

Performance: 0.730 ns/day, 32.891 hours/ns, 16.891 timesteps/s, 6.182 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 104.16     | 137.88     | 151.73     | 164.4 | 77.63
Bond    | 0.0087616  | 0.009072   | 0.0098325  |   0.3 |  0.01
Neigh   | 7.5693     | 9.7991     | 10.662     |  41.0 |  5.52
Comm    | 2.3028     | 16.183     | 49.9       | 479.8 |  9.11
Output  | 0.0074031  | 0.0096913  | 0.01154    |   1.4 |  0.01
Modify  | 12.783     | 13.651     | 15.897     |  34.9 |  7.69
Other   |            | 0.07619    |            |       |  0.04

Nlocal:          45.75 ave          55 max          35 min
Histogram: 1 0 2 0 0 1 1 1 0 2
Nghost:           3580 ave        3629 max        3527 min
Histogram: 1 1 0 0 1 2 1 0 1 1
Neighs:        32080.4 ave       38625 max       25108 min
Histogram: 1 0 2 0 0 1 2 0 1 1

Total # of neighbors = 256643
Ave neighs/atom = 701.21038
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.5 | 139.1 | 140.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   300.26069     -44282.693     -2036.3075      0              3659.697     
       100   301.06212     -44292.247      13647.886     -13766.199      3659.697     
       200   298.95333     -44320.081      3429.0619     -8343.6649      3659.697     
       300   281.99688     -44321.061      3035.0792     -7250.704       3659.697     
       400   297.09074     -44326.176     -218.78819     -8806.5778      3659.697     
       500   291.45866     -44303.232      148.99604     -9162.1301      3659.697     
       600   320.52548     -44316.998     -29.412503     -6005.0029      3659.697     
       700   305.51045     -44297.149     -1198.1681     -9220.9131      3659.697     
       800   305.9214      -44301.429     -2489.8654     -9039.1982      3659.697     
       900   288.91635     -44316.916      4456.921      -9378.6979      3659.697     
      1000   273.21021     -44312.41      -6315.1648     -12029.081      3659.697     
      1100   273.07849     -44289.397     -13040.593     -12998.36       3659.697     
      1200   298.5656      -44294.338      4268.7403     -11407.441      3659.697     
      1300   296.21693     -44289.266     -1187.0047     -12085.392      3659.697     
      1400   315.67573     -44309.785     -4515.0792     -10403.487      3659.697     
      1500   293.86385     -44287.828      3142.1832     -12049.974      3659.697     
      1600   309.26951     -44309.253      5115.8885     -7497.5869      3659.697     
      1700   286.3502      -44294.573     -2847.6413     -8026.6456      3659.697     
      1800   294.13988     -44312.258     -5875.7848     -11902.34       3659.697     
      1900   295.05409     -44302.424     -1696.2302     -9246.2075      3659.697     
      2000   312.11265     -44293.587     -1277.1083     -9622.7416      3659.697     
      2100   310.63262     -44281.184      4426.8123     -1385.2233      3659.697     
      2200   307.62154     -44309.21      -15394.222     -13058.126      3659.697     
      2300   286.36573     -44304.727     -8872.2634     -12696.467      3659.697     
      2400   297.87229     -44304.871      4429.4623     -6560.9102      3659.697     
      2500   305.38538     -44294.958      3106.9811     -7833.7728      3659.697     
      2600   319.6351      -44296.604     -2912.6899     -9177.2876      3659.697     
      2700   313.37226     -44287.046     -4355.3338     -6790.3337      3659.697     
      2800   288.93528     -44286.418      344.02222     -10039.052      3659.697     
      2900   300.47057     -44310.761      3009.0881     -5512.8581      3659.697     
      3000   286.15277     -44285.423     -11618.534     -11367.41       3659.697     
Loop time of 177.348 on 8 procs for 3000 steps with 366 atoms

Performance: 0.731 ns/day, 32.842 hours/ns, 16.916 timesteps/s, 6.191 katom-step/s
99.1% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 104.54     | 136.67     | 150.96     | 153.2 | 77.06
Bond    | 0.0085942  | 0.0089461  | 0.009833   |   0.4 |  0.01
Neigh   | 7.5952     | 9.8572     | 11.139     |  38.4 |  5.56
Comm    | 2.5005     | 16.821     | 48.934     | 436.6 |  9.48
Output  | 0.0013167  | 0.0016822  | 0.0040866  |   2.2 |  0.00
Modify  | 12.602     | 13.918     | 16.198     |  32.6 |  7.85
Other   |            | 0.07593    |            |       |  0.04

Nlocal:          45.75 ave          53 max          38 min
Histogram: 1 1 1 0 0 1 0 2 1 1
Nghost:           3570 ave        3609 max        3531 min
Histogram: 2 1 0 0 0 2 0 1 0 2
Neighs:        32076.6 ave       37056 max       27119 min
Histogram: 1 2 0 0 0 1 0 3 0 1

Total # of neighbors = 256613
Ave neighs/atom = 701.12842
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 21.8443703840341
variable C2pos equal ${d2}
variable C2pos equal 3.93616916534335
variable C3pos equal ${d3}
variable C3pos equal -43.2247211890207
variable C4pos equal ${d4}
variable C4pos equal 8.51028695670543
variable C5pos equal ${d5}
variable C5pos equal 14.1687507171561
variable C6pos equal ${d6}
variable C6pos equal -3.46819718338348

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(37.825335425525+${C1pos})
variable C14 equal 0.5*(37.825335425525+21.8443703840341)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(8.08742280186351+${C2pos})
variable C24 equal 0.5*(8.08742280186351+3.93616916534335)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-49.0655477589175+${C3pos})
variable C34 equal 0.5*(-49.0655477589175+-43.2247211890207)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(8.34402303629771+${C4pos})
variable C44 equal 0.5*(8.34402303629771+8.51028695670543)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(12.5010372207803+${C5pos})
variable C54 equal 0.5*(12.5010372207803+14.1687507171561)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(1.06827197865716+${C6pos})
variable C64 equal 0.5*(1.06827197865716+-3.46819718338348)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 16.909
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.909
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.16909 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.44711 -0.6491)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.5 | 139.1 | 140.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   279.8848      -44268.595      3094.3125      0              3659.697     
       100   311.21975     -44281.729      7194.8432     -6653.3428      3659.697     
       200   317.0009      -44293.069     -8815.1697     -2635.4428      3659.697     
       300   295.05451     -44299.416      1526.4697     -7047.3235      3659.697     
       400   280.87343     -44293.225      2300.1169     -7860.7289      3659.697     
       500   298.17825     -44298.785     -2668.6707     -7520.7183      3659.697     
       600   322.52065     -44296.417     -3988.4325     -10845.943      3659.697     
       700   310.88643     -44272.17      -4836.2248     -10901.405      3659.697     
       800   288.54335     -44292.887     -8067.0675     -6002.4138      3659.697     
       900   305.10205     -44320.174     -2987.0168     -12293.913      3659.697     
      1000   274.98994     -44280.167     -7983.1238     -12277.092      3659.697     
      1100   310.42359     -44296.448      2786.0381     -12994.217      3659.697     
      1200   305.62529     -44277.993      7414.8959     -9204.7686      3659.697     
      1300   311.32515     -44297.371     -866.64681     -8987.7662      3659.697     
      1400   287.39698     -44305.439      9833.251      -7011.8504      3659.697     
      1500   295.77354     -44304.737     -3059.8989     -5420.5138      3659.697     
      1600   310.32753     -44302.647     -1341.3049     -9440.3553      3659.697     
      1700   314.5024      -44299.183      232.20141     -6158.4814      3659.697     
      1800   319.50095     -44300.094      5929.6992     -10458.408      3659.697     
      1900   292.87015     -44285.386      2431.7629     -10924.207      3659.697     
      2000   296.45008     -44301.958     -7347.351      -12759.116      3659.697     
      2100   280.38719     -44293.01      -4098.321      -5355.7985      3659.697     
      2200   305.56004     -44320.685      8132.5615     -8276.9714      3659.697     
      2300   292.23317     -44298.818     -11873.762     -12838.462      3659.697     
      2400   319.16602     -44302.729     -8152.0546     -9910.5089      3659.697     
      2500   297.72429     -44275.79      -7391.0554     -10490.012      3659.697     
      2600   297.60453     -44298.474     -9088.3052     -8656.0476      3659.697     
      2700   295.47855     -44326.511      5294.9237     -10292.541      3659.697     
      2800   309.59453     -44339.28       9669.4894     -3316.1629      3659.697     
      2900   307.20648     -44321.926     -1959.8821     -9695.6635      3659.697     
      3000   296.21184     -44288.084     -1770.2755     -13985.74       3659.697     
Loop time of 177.118 on 8 procs for 3000 steps with 366 atoms

Performance: 0.732 ns/day, 32.800 hours/ns, 16.938 timesteps/s, 6.199 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 103.17     | 140.05     | 151.63     | 128.2 | 79.07
Bond    | 0.0085298  | 0.0091334  | 0.0096556  |   0.4 |  0.01
Neigh   | 7.5117     | 10.027     | 10.714     |  31.3 |  5.66
Comm    | 1.968      | 13.583     | 50.462     | 411.9 |  7.67
Output  | 0.007598   | 0.0097793  | 0.011396   |   1.3 |  0.01
Modify  | 12.694     | 13.358     | 15.881     |  27.1 |  7.54
Other   |            | 0.0769     |            |       |  0.04

Nlocal:          45.75 ave          53 max          33 min
Histogram: 1 0 0 0 1 1 1 1 1 2
Nghost:        3554.62 ave        3595 max        3514 min
Histogram: 1 1 0 0 1 3 0 1 0 1
Neighs:        32071.1 ave       37172 max       23624 min
Histogram: 1 0 0 0 1 2 1 0 1 2

Total # of neighbors = 256569
Ave neighs/atom = 701.0082
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.5 | 139.1 | 140.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   296.21184     -44288.084     -1770.2287      0              3659.697     
       100   286.88081     -44283.674     -7922.7382     -16675.888      3659.697     
       200   291.23371     -44301.682     -10926.297     -13864.606      3659.697     
       300   286.08935     -44303.983      620.30551     -10816.374      3659.697     
       400   306.65134     -44307.813      4998.3993     -3053.1271      3659.697     
       500   318.39581     -44299.85      -2698.0476     -11354.868      3659.697     
       600   291.99153     -44274.472     -5752.2896     -10492.341      3659.697     
       700   300.13876     -44315.098      2957.5741     -8373.3321      3659.697     
       800   295.19572     -44326.629      11633.811     -8027.236       3659.697     
       900   286.17509     -44319.591     -4854.4257     -7682.6325      3659.697     
      1000   306.93788     -44307.672      5290.3298     -8802.3731      3659.697     
      1100   317.15579     -44294.73      -4871.8932     -11667.33       3659.697     
      1200   296.4225      -44278.96      -827.87146     -10469.974      3659.697     
      1300   283.36295     -44293.251      2175.2446     -8804.6984      3659.697     
      1400   294.41216     -44317.494     -425.05341     -10594.736      3659.697     
      1500   302.08547     -44315.761      2960.8401     -5697.0749      3659.697     
      1600   324.50081     -44312.3       -8373.3581     -10159.59       3659.697     
      1700   314.08011     -44282.235     -9297.6551     -4829.4877      3659.697     
      1800   334.96119     -44277.585      3245.7779     -4367.5564      3659.697     
      1900   347.95148     -44315.113     -7132.7994     -8896.3229      3659.697     
      2000   292.17002     -44287.702     -10499.785     -11515.348      3659.697     
      2100   297.13706     -44310.165      896.05351     -8427.0844      3659.697     
      2200   291.3294      -44308.59      -620.99606     -10974.64       3659.697     
      2300   295.91898     -44298.434     -1729.0623     -9385.0086      3659.697     
      2400   301.79049     -44279.308     -2930.8888     -12182.905      3659.697     
      2500   305.87733     -44268.23       2896.2789     -8782.1325      3659.697     
      2600   308.05299     -44292.069      4718.2572     -4068.5321      3659.697     
      2700   298.85903     -44318.774      6755.623      -7619.8687      3659.697     
      2800   287.79332     -44311.638      4113.8095     -2523.2829      3659.697     
      2900   281.39518     -44290.407     -3501.3507     -13604.447      3659.697     
      3000   332.64608     -44322.805      2994.1411     -17934.701      3659.697     
Loop time of 177.169 on 8 procs for 3000 steps with 366 atoms

Performance: 0.732 ns/day, 32.809 hours/ns, 16.933 timesteps/s, 6.197 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 102.72     | 143.05     | 151.37     | 128.6 | 80.74
Bond    | 0.0086692  | 0.0093846  | 0.0099307  |   0.4 |  0.01
Neigh   | 7.452      | 10.151     | 10.73      |  32.2 |  5.73
Comm    | 2.2546     | 10.589     | 50.917     | 472.8 |  5.98
Output  | 0.0013508  | 0.0017015  | 0.0037385  |   1.9 |  0.00
Modify  | 12.715     | 13.288     | 15.995     |  28.2 |  7.50
Other   |            | 0.07858    |            |       |  0.04

Nlocal:          45.75 ave          52 max          33 min
Histogram: 1 0 1 0 0 0 1 0 3 2
Nghost:        3563.62 ave        3602 max        3532 min
Histogram: 1 0 2 1 1 1 0 1 0 1
Neighs:        32082.2 ave       36410 max       23652 min
Histogram: 1 0 1 0 0 0 1 0 3 2

Total # of neighbors = 256658
Ave neighs/atom = 701.25137
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -88.3874442388795
variable C2neg equal ${d2}
variable C2neg equal -51.7187929991926
variable C3neg equal ${d3}
variable C3neg equal -86.6260260320991
variable C4neg equal ${d4}
variable C4neg equal -1.93326573635792
variable C5neg equal ${d5}
variable C5neg equal 24.9176640181262
variable C6neg equal ${d6}
variable C6neg equal -2.34989254484284

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.909
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.16909 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.78529 -0.6491)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.4 | 139 | 140.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   279.8848      -44266.509      4524.5468      0              3659.697     
       100   310.57029     -44279.477     -2079.0218     -7362.2751      3659.697     
       200   313.15025     -44285.823      4928.8074     -3232.6597      3659.697     
       300   297.05033     -44297.017      1582.2004     -9184.3126      3659.697     
       400   282.8066      -44297.08      -7738.6344     -9631.4308      3659.697     
       500   290.09705     -44297.426     -382.17342     -7879.4453      3659.697     
       600   317.13479     -44299.714     -2961.3079     -8324.5031      3659.697     
       700   323.8956      -44282.528     -12507.472     -12346.51       3659.697     
       800   318.80118     -44274.843     -7119.8522     -7870.0691      3659.697     
       900   303.46401     -44301.911     -2247.7216     -10909.557      3659.697     
      1000   305.8651      -44327.844     -5859.7877     -8407.4006      3659.697     
      1100   284.34224     -44314.731      8940.6163     -10369.526      3659.697     
      1200   287.33586     -44304.792     -902.53417     -6433.6645      3659.697     
      1300   289.79143     -44277.082      786.79009     -5357.7554      3659.697     
      1400   292.20548     -44274.312      4846.0098     -9840.2758      3659.697     
      1500   310.08449     -44300.098     -2721.6344     -9730.7535      3659.697     
      1600   296.55693     -44314.692      439.33769     -15270.246      3659.697     
      1700   291.28919     -44326.215      936.0933      -6695.9831      3659.697     
      1800   285.8522      -44310.548      1658.7077     -11344.9        3659.697     
      1900   292.3525      -44304.066     -1257.2802     -9102.3555      3659.697     
      2000   294.02097     -44292.492     -5841.4112     -8032.019       3659.697     
      2100   300.44419     -44285.74      -1458.3801     -5907.3626      3659.697     
      2200   314.09442     -44288.37      -3553.9212     -6231.2726      3659.697     
      2300   318.41126     -44277.35      -2229.3122     -15331.315      3659.697     
      2400   299.0353      -44275.408     -75.935219     -17860.088      3659.697     
      2500   301.56795     -44308.2       -2618.5009     -8481.0088      3659.697     
      2600   295.76238     -44313.869      33.670495     -11823.137      3659.697     
      2700   282.07197     -44295.504     -6336.9297     -11284.282      3659.697     
      2800   309.69131     -44292.317      8542.487      -5350.5811      3659.697     
      2900   314.81332     -44284.915      6451.072      -5274.2266      3659.697     
      3000   312.16199     -44295.66       3140.7619     -8603.4734      3659.697     
Loop time of 165.549 on 8 procs for 3000 steps with 366 atoms

Performance: 0.783 ns/day, 30.657 hours/ns, 18.122 timesteps/s, 6.632 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 99.177     | 123.56     | 141.02     | 149.3 | 74.64
Bond    | 0.0079617  | 0.0084684  | 0.008896   |   0.3 |  0.01
Neigh   | 7.808      | 9.5406     | 10.805     |  38.0 |  5.76
Comm    | 1.3745     | 18.861     | 43.22      | 382.2 | 11.39
Output  | 0.0061689  | 0.0081834  | 0.0094803  |   1.3 |  0.00
Modify  | 12.25      | 13.497     | 15.256     |  32.1 |  8.15
Other   |            | 0.07383    |            |       |  0.04

Nlocal:          45.75 ave          56 max          37 min
Histogram: 1 1 1 1 1 1 0 0 0 2
Nghost:        3565.12 ave        3604 max        3529 min
Histogram: 1 0 1 1 0 2 2 0 0 1
Neighs:        32081.5 ave       39049 max       26393 min
Histogram: 1 1 2 0 1 1 0 0 0 2

Total # of neighbors = 256652
Ave neighs/atom = 701.23497
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.5 | 139 | 140.8 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   312.16199     -44295.66       3140.6599      0              3659.697     
       100   304.35875     -44298.252      127.51113     -6286.3385      3659.697     
       200   298.60283     -44314.214      3547.1638     -7773.8826      3659.697     
       300   279.0075      -44320.113      6477.9611     -11606.752      3659.697     
       400   280.88693     -44317.081     -9602.9236     -10404.731      3659.697     
       500   294.42375     -44295.003     -5426.3625     -9436.6916      3659.697     
       600   301.99116     -44292.807     -6442.4088     -8996.1333      3659.697     
       700   298.56237     -44286.746     -5037.628      -4473.4664      3659.697     
       800   283.03612     -44285.181     -1844.4931     -11294.714      3659.697     
       900   299.08755     -44312.972      2188.6685     -9131.7721      3659.697     
      1000   306.06567     -44322.002     -4905.454      -10119.76       3659.697     
      1100   307.51815     -44304.55      -5415.2667     -8478.1134      3659.697     
      1200   325.20189     -44304.17      -6531.6646     -14721.307      3659.697     
      1300   300.5856      -44279.153     -3394.0809     -9805.0129      3659.697     
      1400   278.73039     -44286.356     -6852.8392     -4996.7618      3659.697     
      1500   272.3614      -44296.698     -7669.4732     -9518.0795      3659.697     
      1600   293.98927     -44312.747     -7825.5564     -10394.24       3659.697     
      1700   286.29992     -44281.158     -3373.1889     -12733.014      3659.697     
      1800   291.24754     -44278.848      1865.3594     -13934.295      3659.697     
      1900   322.57183     -44313.991     -1004.8178     -6923.0524      3659.697     
      2000   313.5226      -44315.991      3157.2428     -4894.1776      3659.697     
      2100   293.46109     -44304.162      3933.426      -5065.1059      3659.697     
      2200   285.61016     -44306.419      1396.1166     -7941.499       3659.697     
      2300   296.77766     -44311.443     -5122.196      -6596.7898      3659.697     
      2400   317.3624      -44303.748      640.34298     -7129.7064      3659.697     
      2500   317.59072     -44300.1       -6651.6825     -10994.856      3659.697     
      2600   305.75698     -44306.959     -5271.1576     -11181.037      3659.697     
      2700   294.35541     -44315.738      492.02872     -13543.775      3659.697     
      2800   296.17993     -44313.614      1124.6612     -6512.1607      3659.697     
      2900   299.21243     -44309.705      8392.0467      1169.956       3659.697     
      3000   288.65587     -44277.659     -1333.0562     -9231.7857      3659.697     
Loop time of 154.445 on 8 procs for 3000 steps with 366 atoms

Performance: 0.839 ns/day, 28.601 hours/ns, 19.424 timesteps/s, 7.109 katom-step/s
99.0% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 92.706     | 113.15     | 130.54     | 143.8 | 73.26
Bond    | 0.0075522  | 0.0080605  | 0.0084352  |   0.3 |  0.01
Neigh   | 7.5518     | 8.9375     | 10.312     |  36.3 |  5.79
Comm    | 1.9233     | 19.333     | 39.791     | 347.9 | 12.52
Output  | 0.0013258  | 0.0014656  | 0.0021334  |   0.7 |  0.00
Modify  | 11.587     | 12.941     | 14.331     |  30.3 |  8.38
Other   |            | 0.07175    |            |       |  0.05

Nlocal:          45.75 ave          55 max          37 min
Histogram: 2 0 0 1 0 2 1 1 0 1
Nghost:        3575.62 ave        3622 max        3531 min
Histogram: 1 0 2 0 0 2 2 0 0 1
Neighs:        32049.1 ave       38006 max       26493 min
Histogram: 2 0 0 1 0 3 0 1 0 1

Total # of neighbors = 256393
Ave neighs/atom = 700.52732
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 0.205160145010413
variable C2pos equal ${d2}
variable C2pos equal -47.8284884960683
variable C3pos equal ${d3}
variable C3pos equal 15.1284385630624
variable C4pos equal ${d4}
variable C4pos equal 3.96717525674615
variable C5pos equal ${d5}
variable C5pos equal 6.9738044677086
variable C6pos equal ${d6}
variable C6pos equal -25.0631025612689

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(-88.3874442388795+${C1pos})
variable C15 equal 0.5*(-88.3874442388795+0.205160145010413)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-51.7187929991926+${C2pos})
variable C25 equal 0.5*(-51.7187929991926+-47.8284884960683)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(-86.6260260320991+${C3pos})
variable C35 equal 0.5*(-86.6260260320991+15.1284385630624)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-1.93326573635792+${C4pos})
variable C45 equal 0.5*(-1.93326573635792+3.96717525674615)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(24.9176640181262+${C5pos})
variable C55 equal 0.5*(24.9176640181262+6.9738044677086)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-2.34989254484284+${C6pos})
variable C65 equal 0.5*(-2.34989254484284+-25.0631025612689)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 13.4224

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4224
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.134224 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.388124 0.6162 -0.6491)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.8 | 139.5 | 141.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   279.8848      -44270.258      4944.3658      0              3659.697     
       100   309.08694     -44282.164      1150.8838     -6827.8096      3659.697     
       200   312.70342     -44290.682     -7386.6242     -3949.4329      3659.697     
       300   303.82609     -44309.11      -898.54911     -7024.5343      3659.697     
       400   293.61388     -44311.883     -8866.443      -13296.645      3659.697     
       500   286.42313     -44297.058     -4562.5305     -6207.4167      3659.697     
       600   313.03801     -44292.889     -94.677025     -10862.277      3659.697     
       700   309.99179     -44276.832      2318.2749     -8174.9718      3659.697     
       800   309.26931     -44291.589      8574.6371     -7591.4027      3659.697     
       900   305.69        -44307.832      3388.3333     -9310.2888      3659.697     
      1000   289.67982     -44308.218     -904.45723     -11082.345      3659.697     
      1100   287.30785     -44307.048     -4434.7779     -8557.6534      3659.697     
      1200   287.50371     -44297.711      4601.5311     -4758.699       3659.697     
      1300   316.45334     -44303.762      3130.023      -6317.0522      3659.697     
      1400   309.67237     -44249.19       2668.2735     -7118.2571      3659.697     
      1500   326.43738     -44268.989     -7640.154      -8649.6711      3659.697     
      1600   298.52021     -44270.856     -11848.392     -9618.65        3659.697     
      1700   285.97205     -44283.152      3977.7608     -4358.5606      3659.697     
      1800   281.49049     -44295.647      1472.8938     -7042.434       3659.697     
      1900   308.60556     -44320.517      5301.5566     -1170.8536      3659.697     
      2000   306.05946     -44292.929      2471.218      -12112.374      3659.697     
      2100   309.25246     -44272.714      483.57069     -9023.9553      3659.697     
      2200   300.05217     -44287.986      3650.3988     -8260.4259      3659.697     
      2300   304.47793     -44327.07       2659.7536     -8901.1393      3659.697     
      2400   285.09883     -44307.848     -9951.6511     -8441.0853      3659.697     
      2500   304.79607     -44319.391      4946.1535     -10391.262      3659.697     
      2600   294.65919     -44284.922      488.70332     -5091.6313      3659.697     
      2700   314.66456     -44297.082     -8416.2854     -11528.134      3659.697     
      2800   304.66947     -44306.509      1882.464      -8199.0336      3659.697     
      2900   290.73178     -44324.796      7847.89       -3070.4724      3659.697     
      3000   290.27123     -44323.747      1676.5307     -11785.754      3659.697     
Loop time of 100.399 on 8 procs for 3000 steps with 366 atoms

Performance: 1.291 ns/day, 18.592 hours/ns, 29.881 timesteps/s, 10.936 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 79.812     | 81.423     | 82.945     |  12.4 | 81.10
Bond    | 0.0064124  | 0.0066706  | 0.0068937  |   0.2 |  0.01
Neigh   | 7.3424     | 7.4923     | 7.6161     |   3.4 |  7.46
Comm    | 0.89627    | 2.427      | 4.0495     |  72.0 |  2.42
Output  | 0.0043174  | 0.006031   | 0.007202   |   1.3 |  0.01
Modify  | 8.8605     | 8.9776     | 9.1173     |   2.8 |  8.94
Other   |            | 0.06673    |            |       |  0.07

Nlocal:          45.75 ave          53 max          34 min
Histogram: 1 0 0 0 1 1 2 1 1 1
Nghost:         3572.5 ave        3613 max        3541 min
Histogram: 1 1 1 0 2 2 0 0 0 1
Neighs:        32073.1 ave       37123 max       24354 min
Histogram: 1 0 0 0 1 2 1 1 1 1

Total # of neighbors = 256585
Ave neighs/atom = 701.05191
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.8 | 139.5 | 141.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.27123     -44323.747      1676.4831      0              3659.697     
       100   285.3603      -44307.599      352.97917     -10125.259      3659.697     
       200   311.72799     -44302.475     -2.1483415     -7472.6015      3659.697     
       300   300.18079     -44290.904      287.65099     -12049.629      3659.697     
       400   304.55698     -44313.547      6009.8636     -7970.3094      3659.697     
       500   295.47461     -44316.935     -418.265       -2686.952       3659.697     
       600   287.66544     -44302.252      2409.4145     -5923.8165      3659.697     
       700   314.47518     -44287.641      151.30563     -1816.0984      3659.697     
       800   306.17439     -44276.226     -3429.3592     -11518.38       3659.697     
       900   328.19895     -44318.266     -573.58614     -8535.9373      3659.697     
      1000   289.5405      -44300.638     -2876.4749     -9511.2076      3659.697     
      1100   311.96717     -44316.555      5090.1684     -3491.881       3659.697     
      1200   324.6385      -44319.391      2494.8842     -6202.5666      3659.697     
      1300   309.19066     -44307.857      1990.075      -10180.037      3659.697     
      1400   278.63861     -44313.537     -11657.733     -10849.116      3659.697     
      1500   279.00912     -44316.743      5175.0004     -9805.0274      3659.697     
      1600   276.09678     -44290.245     -4044.6956     -9688.8849      3659.697     
      1700   301.78453     -44299.791      5013.2149     -10815.183      3659.697     
      1800   309.89138     -44309.296     -3316.3197     -7717.9506      3659.697     
      1900   307.12368     -44312.253     -8985.6995     -10425.759      3659.697     
      2000   298.19656     -44309.657      142.80542     -7371.8842      3659.697     
      2100   307.59847     -44325.71      -4770.7404     -8882.8005      3659.697     
      2200   293.43189     -44306.923     -7257.5469     -11825.756      3659.697     
      2300   300.76351     -44303.497      2644.1887     -8073.1923      3659.697     
      2400   292.03266     -44277.244      7855.0146     -3564.3115      3659.697     
      2500   319.28909     -44289.132     -146.60446     -11301.444      3659.697     
      2600   305.82194     -44274.324     -1798.5349     -8650.0727      3659.697     
      2700   296.15975     -44296.414     -6517.5834     -10134.321      3659.697     
      2800   293.90453     -44310.373      7960.1309     -11566.418      3659.697     
      2900   301.24248     -44316.453      8349.8456     -6234.2858      3659.697     
      3000   301.24537     -44287.108      848.01041     -9823.3372      3659.697     
Loop time of 91.1009 on 8 procs for 3000 steps with 366 atoms

Performance: 1.423 ns/day, 16.871 hours/ns, 32.931 timesteps/s, 12.053 katom-step/s
98.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 70.776     | 72.524     | 73.959     |  13.0 | 79.61
Bond    | 0.0055328  | 0.0057491  | 0.0059102  |   0.2 |  0.01
Neigh   | 7.281      | 7.4134     | 7.5456     |   3.4 |  8.14
Comm    | 0.9041     | 2.3436     | 4.0771     |  72.2 |  2.57
Output  | 0.00079312 | 0.00088196 | 0.0013905  |   0.0 |  0.00
Modify  | 8.6219     | 8.7498     | 8.8721     |   2.8 |  9.60
Other   |            | 0.06306    |            |       |  0.07

Nlocal:          45.75 ave          52 max          37 min
Histogram: 1 1 1 0 0 0 1 0 2 2
Nghost:        3566.38 ave        3606 max        3526 min
Histogram: 1 2 0 0 1 0 2 0 0 2
Neighs:        32087.6 ave       36563 max       26434 min
Histogram: 1 1 1 0 0 0 1 2 0 2

Total # of neighbors = 256701
Ave neighs/atom = 701.36885
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -6.19905549043151
variable C2neg equal ${d2}
variable C2neg equal 26.7686616502083
variable C3neg equal ${d3}
variable C3neg equal -26.1674729440577
variable C4neg equal ${d4}
variable C4neg equal 9.22965189529081
variable C5neg equal ${d5}
variable C5neg equal 9.41716105721062
variable C6neg equal ${d6}
variable C6neg equal 18.9587347788197

# Reset box and simulation parameters
clear
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread. (src/comm.cpp:98)
  using 1 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4224
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.134224 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.119676 0.6162 -0.6491)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 3000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.4 | 138.4 | 139.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   279.8848      -44264.724      3030.6956      0              3659.697     
       100   317.35313     -44284.771      1261.4275     -6680.9045      3659.697     
       200   321.73869     -44293.38      -9235.8518     -5165.2469      3659.697     
       300   292.55299     -44292.898      212.36217     -7805.1378      3659.697     
       400   288.09711     -44298.672     -8859.8557     -10619.935      3659.697     
       500   291.5559      -44293.663      947.79299     -9984.4399      3659.697     
       600   322.86249     -44297.39      -3609.9561     -12005.587      3659.697     
       700   311.27598     -44266.778     -2943.768      -8061.4099      3659.697     
       800   312.8912      -44278.112     -538.80039     -7390.3171      3659.697     
       900   303.55719     -44279.847      2766.9376     -6871.3526      3659.697     
      1000   296.33358     -44289.496     -6349.3408     -8479.0329      3659.697     
      1100   286.61922     -44294.879     -5505.7363     -7881.0251      3659.697     
      1200   291.00385     -44297.332     -2441.4701     -7434.2504      3659.697     
      1300   322.42184     -44288.656      3778.4686     -6980.7786      3659.697     
      1400   293.80023     -44259.437     -1919.41       -7429.4146      3659.697     
      1500   298.3704      -44280.66      -1933.8062     -7016.3086      3659.697     
      1600   307.26208     -44309.929     -3234.0362     -5297.5381      3659.697     
      1700   298.40721     -44309.836     -107.92812     -6008.6777      3659.697     
      1800   288.24063     -44294.988     -5721.2231     -8593.8         3659.697     
      1900   279.59315     -44280.05      -153.87833     -5576.5862      3659.697     
      2000   280.37722     -44264.602     -4777.7713     -5768.3484      3659.697     
      2100   297.60262     -44262.67      -10664.593     -9566.3956      3659.697     
      2200   318.38342     -44285.554     -2398.2304     -13008.448      3659.697     
      2300   314.91305     -44300.334     -11556.092     -12249.378      3659.697     
      2400   292.73739     -44282.606     -2658.786      -11548.264      3659.697     
      2500   302.6627      -44294.251     -3096.3405     -8838.8575      3659.697     
      2600   301.33941     -44299.182     -2472.7901     -6161.0017      3659.697     
      2700   300.6766      -44311.858     -6483.0741     -11620.026      3659.697     
      2800   279.21603     -44301.416      1458.7136     -6079.2618      3659.697     
      2900   306.07697     -44321.51       11368.627     -10639.308      3659.697     
      3000   302.31591     -44284.836     -3182.7649     -7733.7611      3659.697     
Loop time of 90.7512 on 8 procs for 3000 steps with 366 atoms

Performance: 1.428 ns/day, 16.806 hours/ns, 33.057 timesteps/s, 12.099 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 70.706     | 72.135     | 73.591     |  11.6 | 79.49
Bond    | 0.0054879  | 0.0057625  | 0.0059645  |   0.2 |  0.01
Neigh   | 7.2267     | 7.3189     | 7.4457     |   3.2 |  8.06
Comm    | 0.9435     | 2.4158     | 3.8597     |  63.6 |  2.66
Output  | 0.0043431  | 0.0060035  | 0.0070301  |   1.3 |  0.01
Modify  | 8.6995     | 8.8077     | 8.8886     |   2.4 |  9.71
Other   |            | 0.06231    |            |       |  0.07

Nlocal:          45.75 ave          52 max          34 min
Histogram: 1 0 0 1 0 1 1 1 1 2
Nghost:         3557.5 ave        3582 max        3534 min
Histogram: 2 0 0 3 0 0 0 0 1 2
Neighs:        32085.2 ave       36548 max       24302 min
Histogram: 1 0 0 1 0 1 1 1 1 2

Total # of neighbors = 256682
Ave neighs/atom = 701.31694
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 3000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.4 | 138.4 | 139.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   302.31591     -44284.836     -3182.7968      0              3659.697     
       100   302.7306      -44287.282     -4677.9406     -8571.1117      3659.697     
       200   301.2875      -44311.232     -11510.042     -12094.8        3659.697     
       300   279.1712      -44311.176     -3488.6191     -14166.836      3659.697     
       400   286.0671      -44310.834      3913.5048     -9691.4264      3659.697     
       500   303.39729     -44308.761     -5614.1852     -6689.9903      3659.697     
       600   304.8974      -44306.732      113.7865      -8087.3073      3659.697     
       700   287.50653     -44289.191      500.06552     -12865.386      3659.697     
       800   299.79582     -44293.351     -302.49611     -9548.3286      3659.697     
       900   321.96391     -44302.697     -10000.291     -9749.1194      3659.697     
      1000   319.81598     -44302.826      2462.9421     -10330.654      3659.697     
      1100   278.74221     -44290.527     -4348.3064     -11002.038      3659.697     
      1200   293.98428     -44316.725      355.08497     -10517.744      3659.697     
      1300   313.47166     -44326.746     -13072.197     -19150.177      3659.697     
      1400   308.80102     -44296.94      -5088.0355     -14577.726      3659.697     
      1500   319.92406     -44271.355     -22072.652     -16865.695      3659.697     
      1600   314.2572      -44266.417     -9339.998      -16759.048      3659.697     
      1700   336.17705     -44312.665      3457.4111     -9999.841       3659.697     
      1800   295.29628     -44291.326      3315.0413     -13552.685      3659.697     
      1900   298.93662     -44303.803     -4189.8725     -11811.141      3659.697     
      2000   305.38229     -44316.844      721.29682     -13900.215      3659.697     
      2100   305.13342     -44307.244     -11065.092     -12252.39       3659.697     
      2200   323.92957     -44299.547     -11774.654     -9676.2119      3659.697     
      2300   310.77511     -44276.319     -2923.2087     -11150.199      3659.697     
      2400   299.30073     -44283.109      6046.1055     -8112.0702      3659.697     
      2500   290.84261     -44304.637      2092.3256     -9459.8918      3659.697     
      2600   297.23896     -44312.432     -6849.2237     -13207.909      3659.697     
      2700   300.80098     -44303.586     -1596.8901     -15999.241      3659.697     
      2800   282.59393     -44259.946     -4209.1658     -13610.066      3659.697     
      2900   329.04962     -44293.379     -2043.3419     -15992.43       3659.697     
      3000   288.90609     -44264.137     -6351.3643     -15087.118      3659.697     
Loop time of 90.7919 on 8 procs for 3000 steps with 366 atoms

Performance: 1.427 ns/day, 16.813 hours/ns, 33.043 timesteps/s, 12.094 katom-step/s
98.8% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 70.87      | 72.33      | 73.517     |  11.3 | 79.67
Bond    | 0.0055432  | 0.0057878  | 0.0060937  |   0.2 |  0.01
Neigh   | 7.2262     | 7.3969     | 7.5482     |   3.7 |  8.15
Comm    | 1.0143     | 2.223      | 3.7011     |  64.9 |  2.45
Output  | 0.00082259 | 0.00089751 | 0.0013788  |   0.0 |  0.00
Modify  | 8.6048     | 8.7725     | 8.9336     |   3.4 |  9.66
Other   |            | 0.06264    |            |       |  0.07

Nlocal:          45.75 ave          54 max          34 min
Histogram: 1 1 0 0 0 1 2 0 1 2
Nghost:           3545 ave        3580 max        3507 min
Histogram: 1 1 1 0 1 1 0 0 2 1
Neighs:        32071.2 ave       37303 max       24311 min
Histogram: 1 1 0 0 0 1 2 0 1 2

Total # of neighbors = 256570
Ave neighs/atom = 701.01093
Ave special neighs/atom = 0
Neighbor list builds = 300
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 59.5343186457569
variable C2pos equal ${d2}
variable C2pos equal 26.3852447982161
variable C3pos equal ${d3}
variable C3pos equal 55.2458407703886
variable C4pos equal ${d4}
variable C4pos equal -5.63077631641318
variable C5pos equal ${d5}
variable C5pos equal 4.57979914026493
variable C6pos equal ${d6}
variable C6pos equal -4.6928492865874

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-6.19905549043151+${C1pos})
variable C16 equal 0.5*(-6.19905549043151+59.5343186457569)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(26.7686616502083+${C2pos})
variable C26 equal 0.5*(26.7686616502083+26.3852447982161)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-26.1674729440577+${C3pos})
variable C36 equal 0.5*(-26.1674729440577+55.2458407703886)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(9.22965189529081+${C4pos})
variable C46 equal 0.5*(9.22965189529081+-5.63077631641318)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(9.41716105721062+${C5pos})
variable C56 equal 0.5*(9.41716105721062+4.57979914026493)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(18.9587347788197+${C6pos})
variable C66 equal 0.5*(18.9587347788197+-4.6928492865874)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 63.177197495963
variable C22all equal ${C22}
variable C22all equal 60.5752956677178
variable C33all equal ${C33}
variable C33all equal 67.2042068389468

variable C44all equal ${C44}
variable C44all equal 8.42715499650157
variable C55all equal ${C55}
variable C55all equal 15.9457342429174
variable C66all equal ${C66}
variable C66all equal 7.13294274611615

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(4.33710885218415+${C21})
variable C12all equal 0.5*(4.33710885218415+35.2074175510017)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(29.9520911379856+${C31})
variable C13all equal 0.5*(29.9520911379856+51.1618558399845)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(33.4098010953171+${C32})
variable C23all equal 0.5*(33.4098010953171+60.2486064765627)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(29.8348529047795+${C41})
variable C14all equal 0.5*(29.8348529047795+-1.56506304481651)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-44.0911420469345+${C51})
variable C15all equal 0.5*(-44.0911420469345+15.3111365624906)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(26.6676315776627+${C61})
variable C16all equal 0.5*(26.6676315776627+-0.2680329641054)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(6.01179598360343+${C42})
variable C24all equal 0.5*(6.01179598360343+-3.71376650171351)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-49.7736407476305+${C52})
variable C25all equal 0.5*(-49.7736407476305+-13.5895087503797)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(26.5769532242122+${C62})
variable C26all equal 0.5*(26.5769532242122+0.785673583357465)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(-46.1451344739691+${C43})
variable C34all equal 0.5*(-46.1451344739691+5.00949181479103)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(-35.7487937345184+${C53})
variable C35all equal 0.5*(-35.7487937345184+-9.65496561608543)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(14.5391839131654+${C63})
variable C36all equal 0.5*(14.5391839131654+1.20275573796475)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(1.01695476019411+${C54})
variable C45all equal 0.5*(1.01695476019411+13.3348939689682)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(1.79943778943882+${C64})
variable C46all equal 0.5*(1.79943778943882+-1.19996260236316)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(6.99848009873778+${C65})
variable C56all equal 0.5*(6.99848009873778+-13.7064975530559)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 1:07:51
