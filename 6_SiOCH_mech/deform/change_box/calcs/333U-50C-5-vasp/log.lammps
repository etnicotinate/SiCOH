LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nthermo equal ${nevery}*${nrepeat}           # interval for thermo output
variable nthermo equal 10*${nrepeat}           
variable nthermo equal 10*10           
variable nfreq equal ${nthermo} # length of one average
variable nfreq equal 100 
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 20*${nthermo}       # steps of equilibration run 20
variable nequil equal 20*100       
variable nrun equal 20*${nthermo}          # stpes of equilibrated run 20
variable nrun equal 20*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 2.0e-2

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-5-vasp
read_data       ${structure}.data
read_data       333U-50C-5-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.008 seconds

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123457 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
WARNING: No pairwise cutoff or binsize set. Atom sorting therefore disabled. (src/atom.cpp:2366)
WARNING: Communication cutoff is 0.0. No ghost atoms will be generated. Atoms may get lost. (src/comm_brick.cpp:210)
Per MPI rank memory allocation (min/avg/max) = 6.865 | 6.865 | 6.865 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   300            0              0              312.09081      3628.1033    
         1   300            0              0              312.09081      3628.1033    
Loop time of 6.85294e-05 on 16 procs for 1 steps with 350 atoms

50.9% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = search direction is not downhill
  Energy initial, next-to-last, final = 
                     0                  0                  0
  Force two-norm initial, final = 0 0
  Force max component initial, final = 0 0
  Final line search alpha, max atom move = 0 0
  Iterations, force evaluations = 1 0

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0          | 0          | 0          |   0.0 |  0.00
Bond    | 1.42e-07   | 2.16e-07   | 2.99e-07   |   0.0 |  0.32
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 9.24e-07   | 1.3131e-06 | 1.952e-06  |   0.0 |  1.92
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 6.7e-05    |            |       | 97.77

Nlocal:          43.75 ave          49 max          38 min
Histogram: 2 1 0 1 0 0 0 1 1 2
Nghost:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0

Total # of neighbors = 0
Ave neighs/atom = 0
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
thermo_style custom step temp pe press f_avgp[1] density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
run ${nequil}
run 2000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -10.66 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 123.6 | 124.3 | 124.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]       Density         Volume    
         0   300           -38963.433      102489.53      0              1.6516858      3932.1873    
       100   879.79004     -40156.727     -30775.182     -2587.5646      1.6516858      3932.1873    
       200   617.95881     -40444.039     -10883.188     -1468.4049      1.6516858      3932.1873    
       300   496.76746     -40706.226     -15573.749     -3869.1053      1.6516858      3932.1873    
       400   383.78614     -40835.544     -1963.4912     -293.69362      1.6516858      3932.1873    
       500   312.5375      -40920.503      12698.015     -1916.096       1.6516858      3932.1873    
       600   296.51411     -41000.018     -12014.707     -5420.6518      1.6516858      3932.1873    
       700   277.95969     -41032.973     -2060.6521     -8054.8066      1.6516858      3932.1873    
       800   280.77233     -41054.911      11879.411     -4029.8555      1.6516858      3932.1873    
       900   291.38923     -41051.026     -18895.083     -8791.6251      1.6516858      3932.1873    
      1000   307.46164     -41042.18      -3232.9616     -7235.3467      1.6516858      3932.1873    
      1100   308.49306     -41037.031     -11865.619     -12687.188      1.6516858      3932.1873    
      1200   302.14035     -41039.703     -3341.9475     -5952.6926      1.6516858      3932.1873    
      1300   288.07371     -41033.857     -6131.0638     -10132.497      1.6516858      3932.1873    
      1400   304.39711     -41061.913     -6205.5819     -7635.298       1.6516858      3932.1873    
      1500   278.77012     -41043.3       -10948.309     -5043.7377      1.6516858      3932.1873    
      1600   287.69325     -41041.929     -9426.3385     -9835.1692      1.6516858      3932.1873    
      1700   305.87734     -41039.279     -3330.0229     -6519.2309      1.6516858      3932.1873    
      1800   295.10422     -41026.412      4679.7459     -1357.299       1.6516858      3932.1873    
      1900   292.60162     -41034.165     -6184.6094     -5012.8437      1.6516858      3932.1873    
      2000   292.834       -41044.521     -18943.234     -9567.9772      1.6516858      3932.1873    
Loop time of 85.9083 on 16 procs for 2000 steps with 350 atoms

Performance: 1.006 ns/day, 23.863 hours/ns, 23.281 timesteps/s, 8.148 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 48.098     | 57.258     | 70.825     | 136.9 | 66.65
Bond    | 0.00067384 | 0.00073645 | 0.00081879 |   0.0 |  0.00
Neigh   | 4.583      | 5.3226     | 6.5298     |  38.4 |  6.20
Comm    | 1.3139     | 14.899     | 24.069     | 268.4 | 17.34
Output  | 0.0010651  | 0.0012162  | 0.0018246  |   0.7 |  0.00
Modify  | 7.1786     | 8.3856     | 9.1274     |  30.6 |  9.76
Other   |            | 0.04144    |            |       |  0.05

Nlocal:          43.75 ave          54 max          38 min
Histogram: 3 1 0 0 0 3 0 0 0 1
Nghost:           3129 ave        3204 max        3072 min
Histogram: 1 2 0 0 2 1 0 1 0 1
Neighs:        27230.8 ave       33378 max       23710 min
Histogram: 3 1 0 0 0 3 0 0 0 1

Total # of neighbors = 217846
Ave neighs/atom = 622.41714
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-5-vasp_opt.data
System init for write_data ...

# Save initial pressure, box size
variable pxx0 equal f_avgp[1]
variable pyy0 equal f_avgp[2]
variable pzz0 equal f_avgp[3]
variable pxy0 equal f_avgp[4]
variable pxz0 equal f_avgp[5]
variable pyz0 equal f_avgp[6]

# use tmp to save initial box length
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.6782
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 14.2194
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.6383

# define the derivatives, w.r.t. strain tensor
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--9567.97723711924)/(v_delta/v_len0)*${ufac}
variable d1 equal -(v_pxx1--9567.97723711924)/(v_delta/v_len0)*0.000101325
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--18162.998648874)/(v_delta/v_len0)*${ufac}
variable d2 equal -(v_pyy1--18162.998648874)/(v_delta/v_len0)*0.000101325
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--5808.90147086121)/(v_delta/v_len0)*${ufac}
variable d3 equal -(v_pzz1--5808.90147086121)/(v_delta/v_len0)*0.000101325
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--4201.4050255052)/(v_delta/v_len0)*${ufac}*0.5
variable d4 equal -(v_pyz1--4201.4050255052)/(v_delta/v_len0)*0.000101325*0.5
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--2261.6534810411)/(v_delta/v_len0)*${ufac}*0.5
variable d5 equal -(v_pxz1--2261.6534810411)/(v_delta/v_len0)*0.000101325*0.5
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--4802.72657847884)/(v_delta/v_len0)*${ufac}*0.5
variable d6 equal -(v_pxy1--4802.72657847884)/(v_delta/v_len0)*0.000101325*0.5

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 15.6782
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.6782
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.156782 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.156782 xy delta 0.070409 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.156782 xy delta 0.070409 xz delta 0.010144 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.521418 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  triclinic box = (0 0 0) to (15.521418 14.2194 17.6383) with tilt (-6.970491 -1.0144 0.675)
  triclinic box = (0 0 0) to (15.521418 14.2194 17.6383) with tilt (-6.970491 -1.004256 0.675)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg1 all custom 100 dump/neg_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.5 | 123.8 | 126.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   292.834       -41037.098      26787.33       0              3892.8654    
       100   304.80611     -41058.181      640.24023     -184.17456      3892.8654    
       200   293.70432     -41066.053     -8482.9396     -3756.2745      3892.8654    
       300   285.59125     -41076.387     -2156.6246     -6907.1053      3892.8654    
       400   302.10586     -41090.233     -9834.8124     -7075.2701      3892.8654    
       500   287.82224     -41061.084     -7162.8456     -4699.6031      3892.8654    
       600   307.56378     -41066.832     -15471.093     -8866.2386      3892.8654    
       700   302.57335     -41063.375     -13516.457     -6180.4562      3892.8654    
       800   290.56755     -41082.142     -3065.1868     -11023.482      3892.8654    
       900   306.95484     -41131.12      -3523.2267     -4923.1412      3892.8654    
      1000   279.09031     -41118.072     -6571.9053      3674.3169      3892.8654    
      1100   288.10906     -41106.28      -5356.897      -2226.5387      3892.8654    
      1200   303.87928     -41091.994     -12777.681     -7404.8698      3892.8654    
      1300   318.47619     -41106.099     -15735.465     -4837.8989      3892.8654    
      1400   284.6716      -41118.782     -8584.3147     -8391.66        3892.8654    
      1500   259.68926     -41131.198     -305.04372     -5375.3505      3892.8654    
      1600   294.85443     -41167.233     -2377.966      -7782.8488      3892.8654    
      1700   310.35468     -41152.557     -8768.5482     -7413.0332      3892.8654    
      1800   307.4915      -41123.75      -9448.1301     -7021.5435      3892.8654    
      1900   310.98153     -41118.583      3550.3319     -2965.5664      3892.8654    
      2000   301.46086     -41113.735     -23557.134     -3143.0275      3892.8654    
Loop time of 88.1351 on 16 procs for 2000 steps with 350 atoms

Performance: 0.980 ns/day, 24.482 hours/ns, 22.692 timesteps/s, 7.942 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 49.492     | 58.187     | 71.972     | 130.1 | 66.02
Bond    | 0.00058262 | 0.00072382 | 0.00084822 |   0.0 |  0.00
Neigh   | 4.6013     | 5.3496     | 6.4608     |  36.4 |  6.07
Comm    | 2.2945     | 16.07      | 24.772     | 247.5 | 18.23
Output  | 0.0043052  | 0.0064147  | 0.0075733  |   1.5 |  0.01
Modify  | 7.3647     | 8.4789     | 9.232      |  29.0 |  9.62
Other   |            | 0.04283    |            |       |  0.05

Nlocal:          43.75 ave          50 max          40 min
Histogram: 2 1 0 2 1 0 0 0 0 2
Nghost:        3128.38 ave        3189 max        3080 min
Histogram: 1 1 1 1 0 2 1 0 0 1
Neighs:        27516.2 ave       31232 max       25148 min
Histogram: 2 1 1 1 1 0 0 0 1 1

Total # of neighbors = 220130
Ave neighs/atom = 628.94286
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg1

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.5 | 123.8 | 126.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   301.46086     -41113.735     -23557.152      0              3892.8654    
       100   316.93332     -41128.319     -66.093319     -3949.0884      3892.8654    
       200   298.46553     -41122.72      -2274.1491     -5930.8346      3892.8654    
       300   286.15288     -41140.796      3316.7294     -3997.5986      3892.8654    
       400   285.16202     -41137.222     -2568.4016     -5771.7147      3892.8654    
       500   288.58598     -41113.51       3724.3488     -2973.9588      3892.8654    
       600   308.8368      -41122.287      3577.9156     -3385.5305      3892.8654    
       700   316.52248     -41133.473     -11220.769     -6669.2049      3892.8654    
       800   305.43587     -41143.623     -12765.093     -2385.1654      3892.8654    
       900   289.81768     -41140.044     -835.80644     -6690.3754      3892.8654    
      1000   291.22799     -41128.517     -17614.645     -8993.8711      3892.8654    
      1100   320.21129     -41117.377     -5479.175       1586.455       3892.8654    
      1200   320.80046     -41125.388      787.57645     -138.88259      3892.8654    
      1300   305.06667     -41134.008     -866.37607     -6473.6063      3892.8654    
      1400   284.40369     -41125.099     -13837.761     -3280.094       3892.8654    
      1500   304.90081     -41146.651     -3159.5267     -6147.296       3892.8654    
      1600   318.7616      -41133.627     -4801.2455     -2230.2014      3892.8654    
      1700   330.43589     -41116.284      5081.4698     -8811.6964      3892.8654    
      1800   317.01021     -41115.727     -13581.056     -5735.8517      3892.8654    
      1900   290.4556      -41113.157     -6879.9106     -7751.3327      3892.8654    
      2000   314.85038     -41150.25      -9568.8982     -8678.4969      3892.8654    
Loop time of 87.5358 on 16 procs for 2000 steps with 350 atoms

Performance: 0.987 ns/day, 24.315 hours/ns, 22.848 timesteps/s, 7.997 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 49.75      | 58.156     | 72.487     | 128.9 | 66.44
Bond    | 0.00058812 | 0.00072838 | 0.00087126 |   0.0 |  0.00
Neigh   | 4.5691     | 5.353      | 6.686      |  36.1 |  6.12
Comm    | 1.3597     | 15.687     | 24.091     | 248.1 | 17.92
Output  | 0.00085933 | 0.000959   | 0.0014617  |   0.0 |  0.00
Modify  | 6.9611     | 8.2985     | 9.0884     |  29.2 |  9.48
Other   |            | 0.03943    |            |       |  0.05

Nlocal:          43.75 ave          47 max          38 min
Histogram: 1 1 0 0 0 0 2 1 1 2
Nghost:        3125.62 ave        3216 max        3039 min
Histogram: 1 0 1 2 0 1 1 1 0 1
Neighs:          27533 ave       29575 max       24194 min
Histogram: 2 0 0 0 0 0 2 1 1 2

Total # of neighbors = 220264
Ave neighs/atom = 629.32571
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 9.01265911590559
variable C2neg equal ${d2}
variable C2neg equal 24.9694992615409
variable C3neg equal ${d3}
variable C3neg equal 24.6731392539354
variable C4neg equal ${d4}
variable C4neg equal -14.453428282428
variable C5neg equal ${d5}
variable C5neg equal -11.4135302062663
variable C6neg equal ${d6}
variable C6neg equal 11.5652509719463

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.6782
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.156782 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.156782 xy delta -0.070409 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.156782 xy delta -0.070409 xz delta -0.010144 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.834982 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.834982 14.2194 17.6383) with tilt (-7.111309 -1.0144 0.675)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.834982 14.2194 17.6383) with tilt (-7.111309 -1.024544 0.675)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos1 all custom 100 dump/pos_deform1.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.3 | 122.4 | 124.6 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   292.834       -41017.453     -60599.356      0              3971.5092    
       100   306.16063     -41043.232     -2438.468      -11266.287      3971.5092    
       200   290.58373     -41052.432     -14628.695     -12253.591      3971.5092    
       300   276.05867     -41056.328     -21837.983     -11363.25       3971.5092    
       400   298.46544     -41070.755     -9173.6239     -7571.3582      3971.5092    
       500   285.1339      -41041.997     -8770.3817     -12195.986      3971.5092    
       600   293.40512     -41034.475     -20664.063     -15467.851      3971.5092    
       700   311.62138     -41046.787     -4329.6788     -10856.945      3971.5092    
       800   312.27753     -41060.388     -210.20694     -13339.749      3971.5092    
       900   307.80773     -41075.264     -12480.133     -8364.8526      3971.5092    
      1000   291.1904      -41067.686     -14339.25      -12402.465      3971.5092    
      1100   306.60748     -41075.977     -1378.7339     -13812.115      3971.5092    
      1200   320.41563     -41081.129     -17914.62      -11698.632      3971.5092    
      1300   291.23895     -41050.681     -24684.766     -15820.864      3971.5092    
      1400   309.39784     -41074.212     -9293.4473     -12250.343      3971.5092    
      1500   274.01829     -41043.978     -17701.289     -17419.779      3971.5092    
      1600   306.31319     -41070.68      -9308.9038     -11816.726      3971.5092    
      1700   291.1744      -41052.555     -13005.029     -13935.809      3971.5092    
      1800   302.34224     -41069.775     -14769.361     -16061.894      3971.5092    
      1900   301.24369     -41080.894     -11779.636     -12469.946      3971.5092    
      2000   292.20351     -41084.669     -15779.571     -11839.578      3971.5092    
Loop time of 84.2263 on 16 procs for 2000 steps with 350 atoms

Performance: 1.026 ns/day, 23.396 hours/ns, 23.746 timesteps/s, 8.311 katom-step/s
99.6% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 48.001     | 54.432     | 69.997     | 122.3 | 64.63
Bond    | 0.00063071 | 0.00071869 | 0.00082855 |   0.0 |  0.00
Neigh   | 4.4513     | 5.0497     | 6.4421     |  33.8 |  6.00
Comm    | 0.92737    | 16.487     | 22.915     | 222.2 | 19.57
Output  | 0.0037219  | 0.0056615  | 0.0066435  |   1.5 |  0.01
Modify  | 6.8099     | 8.2133     | 8.8216     |  26.6 |  9.75
Other   |            | 0.03718    |            |       |  0.04

Nlocal:          43.75 ave          50 max          36 min
Histogram: 1 0 0 2 0 1 2 0 1 1
Nghost:         3081.5 ave        3176 max        3002 min
Histogram: 1 0 1 2 0 1 2 0 0 1
Neighs:        26949.5 ave       30679 max       22454 min
Histogram: 1 0 0 2 0 1 2 0 1 1

Total # of neighbors = 215596
Ave neighs/atom = 615.98857
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos1

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.2 | 122.4 | 124.7 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   292.20351     -41084.669     -15779.552      0              3971.5092    
       100   310.11319     -41102.456     -6686.4918     -11388.597      3971.5092    
       200   283.04818     -41080.124      1172.3887     -8491.0692      3971.5092    
       300   272.89849     -41080.232     -1547.088      -6264.3615      3971.5092    
       400   309.96788     -41105.837     -7080.1084     -9601.3094      3971.5092    
       500   331.17558     -41104.012     -10362.38      -16097.05       3971.5092    
       600   282.46704     -41055.692     -9604.0175     -2778.2722      3971.5092    
       700   304.90483     -41103.362     -13986.084     -6926.3032      3971.5092    
       800   291.05497     -41115.007     -20820.726     -14809.739      3971.5092    
       900   294.91365     -41109.037      5970.6702     -9472.6863      3971.5092    
      1000   301.55262     -41100.149     -11810.234     -12398.608      3971.5092    
      1100   310.64592     -41102.016     -15295.612     -11380.358      3971.5092    
      1200   294.37546     -41084.855     -8497.493      -11185.681      3971.5092    
      1300   304.83327     -41092.695     -8705.8606     -10704.86       3971.5092    
      1400   283.44325     -41075.427     -20937.212     -15387.199      3971.5092    
      1500   319.58088     -41112.95      -10645.435     -10507.563      3971.5092    
      1600   312.91897     -41116.965     -18520.186     -9588.4129      3971.5092    
      1700   300.11032     -41114.156     -9663.6231     -13741.419      3971.5092    
      1800   274.75894     -41102.977     -17344.772     -9071.9421      3971.5092    
      1900   276.90092     -41106.149      2341.6457     -11561.46       3971.5092    
      2000   291.89357     -41097.588     -1312.2498     -10504.678      3971.5092    
Loop time of 84.0656 on 16 procs for 2000 steps with 350 atoms

Performance: 1.028 ns/day, 23.352 hours/ns, 23.791 timesteps/s, 8.327 katom-step/s
99.6% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 47.658     | 54.353     | 70.123     | 121.3 | 64.66
Bond    | 0.00062253 | 0.0007199  | 0.00080439 |   0.0 |  0.00
Neigh   | 4.4456     | 5.0643     | 6.4962     |  34.2 |  6.02
Comm    | 0.67153    | 16.433     | 23.129     | 220.7 | 19.55
Output  | 0.00083229 | 0.00097686 | 0.0012672  |   0.0 |  0.00
Modify  | 6.7325     | 8.1726     | 8.7982     |  27.0 |  9.72
Other   |            | 0.04084    |            |       |  0.05

Nlocal:          43.75 ave          49 max          38 min
Histogram: 3 0 0 0 0 0 0 3 1 1
Nghost:        3064.12 ave        3137 max        3001 min
Histogram: 1 0 2 1 0 1 2 0 0 1
Neighs:        26958.4 ave       30017 max       23410 min
Histogram: 1 2 0 0 0 0 0 3 1 1

Total # of neighbors = 215667
Ave neighs/atom = 616.19143
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 9.49112029298014
variable C2pos equal ${d2}
variable C2pos equal -75.6503177756794
variable C3pos equal ${d3}
variable C3pos equal 61.1404348574417
variable C4pos equal ${d4}
variable C4pos equal -7.18095770152316
variable C5pos equal ${d5}
variable C5pos equal 6.85317623231737
variable C6pos equal ${d6}
variable C6pos equal -6.23622307102408

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(9.01265911590559+${C1pos})
variable C11 equal 0.5*(9.01265911590559+9.49112029298014)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(24.9694992615409+${C2pos})
variable C21 equal 0.5*(24.9694992615409+-75.6503177756794)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(24.6731392539354+${C3pos})
variable C31 equal 0.5*(24.6731392539354+61.1404348574417)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(-14.453428282428+${C4pos})
variable C41 equal 0.5*(-14.453428282428+-7.18095770152316)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(-11.4135302062663+${C5pos})
variable C51 equal 0.5*(-11.4135302062663+6.85317623231737)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(11.5652509719463+${C6pos})
variable C61 equal 0.5*(11.5652509719463+-6.23622307102408)

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 14.2194
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.2194
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.142194 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.142194 yz delta -0.00675 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.6782 14.077206 17.6383) with tilt (-7.0409 -1.0144 0.675)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.6782 14.077206 17.6383) with tilt (-7.0409 -1.0144 0.66825)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg2 all custom 100 dump/neg_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 123.8 | 126.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   292.834       -41042.564      23905.838      0              3892.8654    
       100   298.6612      -41055.925     -3225.0176     -3665.6365      3892.8654    
       200   285.58865     -41058.997     -9885.5644     -6687.0283      3892.8654    
       300   280.49505     -41068.9       -5456.4839     -9564.5377      3892.8654    
       400   292.94041     -41073.979     -7136.4429     -5354.9818      3892.8654    
       500   293.20969     -41061.418     -6593.8404     -7096.8151      3892.8654    
       600   303.39199     -41061.527     -13205.195     -8808.2188      3892.8654    
       700   308.13153     -41068.969     -2537.6773     -2126.5153      3892.8654    
       800   285.35061     -41060.125     -7249.123      -13200.484      3892.8654    
       900   310.14255     -41098.786     -6273.1475     -1311.8502      3892.8654    
      1000   291.10703     -41087.754     -354.50414     -4196.2565      3892.8654    
      1100   298.60733     -41092.484     -10024.04      -10326.131      3892.8654    
      1200   309.79937     -41089.695     -2936.3731     -12293.943      3892.8654    
      1300   310.70423     -41084.961     -5614.7365     -2684.3692      3892.8654    
      1400   289.09869     -41069.583     -9188.6525     -4339.1192      3892.8654    
      1500   286.30083     -41080.012      7322.1324     -6766.6761      3892.8654    
      1600   310.91473     -41106.568     -10315.68      -7335.196       3892.8654    
      1700   295.82348     -41086.542     -9097.7997     -11060.966      3892.8654    
      1800   306.51777     -41088.172     -4626.8512     -9568.4572      3892.8654    
      1900   309.35492     -41092.34       7588.2821     -6002.5766      3892.8654    
      2000   290.21619     -41089.046     -12613.872     -6669.1681      3892.8654    
Loop time of 86.6912 on 16 procs for 2000 steps with 350 atoms

Performance: 0.997 ns/day, 24.081 hours/ns, 23.070 timesteps/s, 8.075 katom-step/s
99.6% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 49.383     | 56.077     | 72.053     | 123.6 | 64.69
Bond    | 0.00058808 | 0.0007137  | 0.0009603  |   0.0 |  0.00
Neigh   | 4.5952     | 5.2096     | 6.7329     |  35.3 |  6.01
Comm    | 0.93508    | 16.91      | 23.601     | 225.0 | 19.51
Output  | 0.0039023  | 0.005988   | 0.0069756  |   1.5 |  0.01
Modify  | 6.9164     | 8.447      | 9.0698     |  27.8 |  9.74
Other   |            | 0.04047    |            |       |  0.05

Nlocal:          43.75 ave          49 max          37 min
Histogram: 1 0 1 0 1 2 0 0 2 1
Nghost:         3139.5 ave        3206 max        3083 min
Histogram: 1 1 1 0 1 1 1 1 0 1
Neighs:        27499.9 ave       30683 max       23294 min
Histogram: 1 0 1 0 1 2 0 0 2 1

Total # of neighbors = 219999
Ave neighs/atom = 628.56857
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg2

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.5 | 123.8 | 126.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.21619     -41089.046     -12613.906      0              3892.8654    
       100   282.70661     -41076.246     -24455.175     -9400.1976      3892.8654    
       200   311.99673     -41081.773     -15600.997     -12716.84       3892.8654    
       300   328.29806     -41077.563     -3109.2452     -7640.8229      3892.8654    
       400   310.91898     -41079.119     -11590.969     -7787.2045      3892.8654    
       500   293.0938      -41092.145     -7545.2568     -12772.89       3892.8654    
       600   297.63218     -41101.932     -17080.55      -11059.657      3892.8654    
       700   308.12337     -41101.155     -5858.8011     -8530.9237      3892.8654    
       800   304.67345     -41080.731     -19134.725     -10790.908      3892.8654    
       900   320.46548     -41079.755     -2481.5555     -13734.198      3892.8654    
      1000   322.35577     -41063.821      801.3847      -5891.5552      3892.8654    
      1100   315.96761     -41092.661     -4532.4853     -11803.056      3892.8654    
      1200   301.55157     -41097.057     -8182.4615     -13129.414      3892.8654    
      1300   295.61358     -41103.121     -4373.9141     -12320.484      3892.8654    
      1400   301.65496     -41120.567     -2498.7788     -8049.0411      3892.8654    
      1500   285.1456      -41117.499     -7877.8975     -6368.9171      3892.8654    
      1600   265.03354     -41101.648     -21878.447     -14238.295      3892.8654    
      1700   301.13284     -41110.571     -16901.502     -10418.37       3892.8654    
      1800   309.1154      -41099.61      -23281.046     -12966.052      3892.8654    
      1900   314.91832     -41106.257     -21303.42      -15554.849      3892.8654    
      2000   302.38609     -41122.261     -10506.469     -8856.2641      3892.8654    
Loop time of 87.187 on 16 procs for 2000 steps with 350 atoms

Performance: 0.991 ns/day, 24.219 hours/ns, 22.939 timesteps/s, 8.029 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 49.624     | 57.242     | 72.581     | 119.8 | 65.65
Bond    | 0.00061598 | 0.00072481 | 0.00096536 |   0.0 |  0.00
Neigh   | 4.5344     | 5.2463     | 6.7669     |  35.1 |  6.02
Comm    | 0.96713    | 16.308     | 23.923     | 224.5 | 18.70
Output  | 0.000835   | 0.00091245 | 0.0012714  |   0.0 |  0.00
Modify  | 6.8224     | 8.3481     | 9.0683     |  28.0 |  9.57
Other   |            | 0.04139    |            |       |  0.05

Nlocal:          43.75 ave          48 max          39 min
Histogram: 1 1 0 1 1 0 1 1 1 1
Nghost:        3135.75 ave        3209 max        3072 min
Histogram: 1 0 2 1 0 2 0 1 0 1
Neighs:        27530.5 ave       30070 max       24672 min
Histogram: 2 0 0 1 1 0 1 1 1 1

Total # of neighbors = 220244
Ave neighs/atom = 629.26857
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 7.21143324603315
variable C2neg equal ${d2}
variable C2neg equal 83.4216895968842
variable C3neg equal ${d3}
variable C3neg equal -9.94789369259898
variable C4neg equal ${d4}
variable C4neg equal -16.9004894642652
variable C5neg equal ${d5}
variable C5neg equal 12.1100599625967
variable C6neg equal ${d6}
variable C6neg equal -4.44473993870974

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.2194
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.142194 yz delta ${deltayz} remap units box
change_box all y delta 0 0.142194 yz delta 0.00675 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.6782 14.361594 17.6383) with tilt (-7.0409 -1.0144 0.675)
  triclinic box = (0 0 0) to (15.6782 14.361594 17.6383) with tilt (-7.0409 -1.0144 0.68175)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos2 all custom 100 dump/pos_deform2.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.6 | 121.8 | 124 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   292.834       -41013.591     -60617.19       0              3971.5092    
       100   299.155       -41031.94      -162.60408     -6968.0574      3971.5092    
       200   300.48779     -41058.093     -2346.7692     -9680.175       3971.5092    
       300   289.85407     -41069.018     -10534.516     -8041.1591      3971.5092    
       400   286.17809     -41062.294     -20986.133     -7366.2127      3971.5092    
       500   288.86905     -41055.21      -13936.659     -10470.674      3971.5092    
       600   297.3176      -41051.542     -8551.3727     -10037.643      3971.5092    
       700   297.51123     -41049.601     -11521.546     -10492.885      3971.5092    
       800   313.23702     -41077.745     -18491.122     -18537.493      3971.5092    
       900   303.75917     -41089.432     -10672.537     -10823.266      3971.5092    
      1000   280.9986      -41078.95       3581.0962     -7028.7167      3971.5092    
      1100   308.30227     -41087.077     -11046.423     -11043.659      3971.5092    
      1200   301.36094     -41059.087     -21609.445     -12048.494      3971.5092    
      1300   312.00093     -41065.048     -13883.153     -8131.8546      3971.5092    
      1400   297.83565     -41065.07      -6726.515      -14402.321      3971.5092    
      1500   291.2842      -41081.549     -13360.543     -15592.971      3971.5092    
      1600   297.26991     -41097.676     -16622.057     -13624.702      3971.5092    
      1700   281.75617     -41064.975     -20079.461     -15738.322      3971.5092    
      1800   331.40941     -41097.097     -5638.2217     -11066.443      3971.5092    
      1900   294.96515     -41067.211     -5531.8929     -13443.302      3971.5092    
      2000   303.70992     -41081.699     -3415.6465     -12333.957      3971.5092    
Loop time of 85.3566 on 16 procs for 2000 steps with 350 atoms

Performance: 1.012 ns/day, 23.710 hours/ns, 23.431 timesteps/s, 8.201 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 47.84      | 56.813     | 70.923     | 125.1 | 66.56
Bond    | 0.00059345 | 0.00071242 | 0.00086674 |   0.0 |  0.00
Neigh   | 4.4624     | 5.2535     | 6.578      |  35.9 |  6.15
Comm    | 0.89543    | 15.009     | 23.982     | 243.5 | 17.58
Output  | 0.0038963  | 0.0062633  | 0.0074994  |   1.7 |  0.01
Modify  | 6.9067     | 8.2342     | 9.0282     |  28.7 |  9.65
Other   |            | 0.03963    |            |       |  0.05

Nlocal:          43.75 ave          49 max          41 min
Histogram: 1 2 1 2 0 1 0 0 0 1
Nghost:        3084.12 ave        3159 max        3022 min
Histogram: 1 1 1 1 0 2 1 0 0 1
Neighs:        26976.4 ave       30068 max       25363 min
Histogram: 1 2 1 2 1 0 0 0 0 1

Total # of neighbors = 215811
Ave neighs/atom = 616.60286
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos2

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 119.7 | 121.8 | 124.1 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   303.70992     -41081.699     -3415.7014      0              3971.5092    
       100   294.83108     -41071.841     -10886.067     -12898.415      3971.5092    
       200   297.55128     -41080.559     -10275.873     -15161.005      3971.5092    
       300   301.44519     -41090.665     -13989.586     -10142.961      3971.5092    
       400   310.44917     -41098.19      -12764.824     -9005.4966      3971.5092    
       500   295.52596     -41079.301     -8205.79       -6789.5344      3971.5092    
       600   271.95195     -41051.776     -14143.809     -9619.7999      3971.5092    
       700   310.00247     -41072.671     -2812.8018     -12619.44       3971.5092    
       800   310.38953     -41060.257     -11553.11      -11331.46       3971.5092    
       900   293.71618     -41049.017     -20497.581     -9848.7107      3971.5092    
      1000   284.55736     -41069.761     -8565.4146     -8512.9343      3971.5092    
      1100   287.40288     -41089.662     -6940.1821     -11109.349      3971.5092    
      1200   298.36235     -41094.652     -11372.076     -15982.014      3971.5092    
      1300   307.47319     -41093.076     -10924.158     -10709.638      3971.5092    
      1400   329.7413      -41079.701     -19181.027     -7870.077       3971.5092    
      1500   310.47198     -41052.378     -6260.43       -3288.8378      3971.5092    
      1600   316.2428      -41084.342     -18055.508     -9754.3893      3971.5092    
      1700   295.52224     -41077.828     -14870.743     -8591.9501      3971.5092    
      1800   294.86004     -41084.985     -13213.395     -3190.4033      3971.5092    
      1900   297.00602     -41096.322     -2068.5212     -10958.082      3971.5092    
      2000   302.71021     -41101.435      116.67523     -9220.187       3971.5092    
Loop time of 85.1658 on 16 procs for 2000 steps with 350 atoms

Performance: 1.014 ns/day, 23.657 hours/ns, 23.484 timesteps/s, 8.219 katom-step/s
99.6% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 47.559     | 56.94      | 70.949     | 137.1 | 66.86
Bond    | 0.00065341 | 0.00070782 | 0.00083933 |   0.0 |  0.00
Neigh   | 4.4823     | 5.2447     | 6.5898     |  40.5 |  6.16
Comm    | 0.74151    | 14.756     | 24.15      | 269.5 | 17.33
Output  | 0.00092231 | 0.00098121 | 0.0012478  |   0.0 |  0.00
Modify  | 6.8397     | 8.1834     | 8.9492     |  32.4 |  9.61
Other   |            | 0.04017    |            |       |  0.05

Nlocal:          43.75 ave          48 max          38 min
Histogram: 1 1 0 0 1 1 0 0 1 3
Nghost:        3071.38 ave        3136 max        3015 min
Histogram: 1 1 1 0 2 1 0 1 0 1
Neighs:          26972 ave       29413 max       23632 min
Histogram: 2 0 0 0 1 1 0 1 1 2

Total # of neighbors = 215776
Ave neighs/atom = 616.50286
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -3.52398437741854
variable C2pos equal ${d2}
variable C2pos equal -58.4268454937485
variable C3pos equal ${d3}
variable C3pos equal -11.4967690789256
variable C4pos equal ${d4}
variable C4pos equal -4.30622299921805
variable C5pos equal ${d5}
variable C5pos equal 8.02379217767312
variable C6pos equal ${d6}
variable C6pos equal -8.55227107013238

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(7.21143324603315+${C1pos})
variable C12 equal 0.5*(7.21143324603315+-3.52398437741854)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(83.4216895968842+${C2pos})
variable C22 equal 0.5*(83.4216895968842+-58.4268454937485)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(-9.94789369259898+${C3pos})
variable C32 equal 0.5*(-9.94789369259898+-11.4967690789256)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-16.9004894642652+${C4pos})
variable C42 equal 0.5*(-16.9004894642652+-4.30622299921805)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(12.1100599625967+${C5pos})
variable C52 equal 0.5*(12.1100599625967+8.02379217767312)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(-4.44473993870974+${C6pos})
variable C62 equal 0.5*(-4.44473993870974+-8.55227107013238)

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.6383
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.6383
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.176383 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.6782 14.2194 17.461917) with tilt (-7.0409 -1.0144 0.675)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg3 all custom 100 dump/neg_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.6 | 124 | 126.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   292.834       -41041.331      28266.896      0              3892.8654    
       100   308.56198     -41064.933      3436.0008     -3979.2686      3892.8654    
       200   287.04589     -41055.832     -6135.6742     -4314.0573      3892.8654    
       300   287.34282     -41069.269     -1760.7907     -8732.5709      3892.8654    
       400   302.25868     -41078.912     -5873.8222     -6719.6504      3892.8654    
       500   287.40092     -41059.045     -11597.962     -7369.7471      3892.8654    
       600   310.23113     -41081.037      1085.6301     -6564.3829      3892.8654    
       700   297.98258     -41077.276     -11013.767     -8784.422       3892.8654    
       800   291.73868     -41077.3       -6934.6896     -14321.883      3892.8654    
       900   298.32054     -41080.01       3899.9475     -86.16921       3892.8654    
      1000   299.1003      -41071.272     -12637.214     -7153.1203      3892.8654    
      1100   321.02706     -41090.761     -7208.757      -4574.1583      3892.8654    
      1200   306.98917     -41082.201     -9942.5132     -8926.457       3892.8654    
      1300   305.76093     -41083.873     -7090.849      -12391.647      3892.8654    
      1400   294.82876     -41074.265     -4451.1678     -13494.204      3892.8654    
      1500   300.49075     -41082.4       -4167.0305     -12095.552      3892.8654    
      1600   289.20761     -41071.97      -4565.9162     -6507.2938      3892.8654    
      1700   303.40525     -41080.38      -5190.4488     -7791.5166      3892.8654    
      1800   321.67567     -41091.628     -12939.203     -11325.777      3892.8654    
      1900   303.40711     -41082.731     -12615.542     -12764.919      3892.8654    
      2000   306.77517     -41101.845      2904.9033     -4546.6838      3892.8654    
Loop time of 87.9676 on 16 procs for 2000 steps with 350 atoms

Performance: 0.982 ns/day, 24.435 hours/ns, 22.736 timesteps/s, 7.957 katom-step/s
99.6% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 49.062     | 58.933     | 72.669     | 128.5 | 66.99
Bond    | 0.00060676 | 0.00073167 | 0.00098191 |   0.0 |  0.00
Neigh   | 4.5989     | 5.4033     | 6.571      |  35.1 |  6.14
Comm    | 1.5049     | 15.241     | 25.116     | 252.6 | 17.33
Output  | 0.0039784  | 0.0060108  | 0.0070958  |   1.5 |  0.01
Modify  | 7.1739     | 8.3442     | 9.1523     |  28.3 |  9.49
Other   |            | 0.03987    |            |       |  0.05

Nlocal:          43.75 ave          49 max          39 min
Histogram: 1 0 1 1 1 2 0 0 0 2
Nghost:           3123 ave        3208 max        3048 min
Histogram: 1 1 0 1 2 0 2 0 0 1
Neighs:          27522 ave       30743 max       24510 min
Histogram: 1 0 1 1 1 2 0 0 1 1

Total # of neighbors = 220176
Ave neighs/atom = 629.07429
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg3

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.7 | 124 | 126.2 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   306.77517     -41101.845      2904.8452      0              3892.8654    
       100   301.34724     -41096.789     -1990.6786     -7794.2404      3892.8654    
       200   305.97637     -41087.708     -2925.4115     -8382.2266      3892.8654    
       300   305.38779     -41060.187      5315.7071     -5980.1163      3892.8654    
       400   323.93497     -41088.026     -5234.1535     -5625.8344      3892.8654    
       500   292.5486      -41086.877      463.89321     -12866.055      3892.8654    
       600   299.23952     -41101.308     -589.74498     -1761.1082      3892.8654    
       700   277.6823      -41078.583     -12188.573     -3260.4572      3892.8654    
       800   301.84608     -41086.293      2713.3011     -5810.8898      3892.8654    
       900   300.30122     -41061.395     -4191.1986     -7154.1298      3892.8654    
      1000   334.10123     -41081.668     -8398.3551     -8238.6062      3892.8654    
      1100   295.33239     -41080.863      9700.9655      2152.0723      3892.8654    
      1200   301.03749     -41111.171     -7770.1259     -1652.9144      3892.8654    
      1300   290.68276     -41111.888      9237.4148     -2050.5632      3892.8654    
      1400   291.65737     -41111.479     -14216.846     -8319.3509      3892.8654    
      1500   310.39602     -41105.417     -7209.1787     -9892.7256      3892.8654    
      1600   320.47913     -41098.96      -6595.2695     -7283.4951      3892.8654    
      1700   317.80487     -41116.013     -7541.9513     -4474.1789      3892.8654    
      1800   302.37204     -41115.771     -12025.076     -8414.8134      3892.8654    
      1900   289.46634     -41111.736     -10746.378     -11919.696      3892.8654    
      2000   295.37759     -41131.883      15809.853     -6339.2273      3892.8654    
Loop time of 87.5151 on 16 procs for 2000 steps with 350 atoms

Performance: 0.987 ns/day, 24.310 hours/ns, 22.853 timesteps/s, 7.999 katom-step/s
99.6% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 48.758     | 58.767     | 73.034     | 123.8 | 67.15
Bond    | 0.00061591 | 0.00072156 | 0.00098871 |   0.0 |  0.00
Neigh   | 4.5859     | 5.393      | 6.573      |  33.8 |  6.16
Comm    | 0.94148    | 15.206     | 25.216     | 243.3 | 17.38
Output  | 0.00085068 | 0.00097372 | 0.0014067  |   0.0 |  0.00
Modify  | 6.9206     | 8.1036     | 8.9185     |  27.6 |  9.26
Other   |            | 0.04394    |            |       |  0.05

Nlocal:          43.75 ave          49 max          38 min
Histogram: 1 1 0 1 1 0 2 0 0 2
Nghost:         3121.5 ave        3205 max        3055 min
Histogram: 1 0 2 1 0 2 1 0 0 1
Neighs:          27525 ave       30535 max       23915 min
Histogram: 1 0 1 0 2 0 2 0 0 2

Total # of neighbors = 220200
Ave neighs/atom = 629.14286
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 32.7153088405422
variable C2neg equal ${d2}
variable C2neg equal 95.7361588351202
variable C3neg equal ${d3}
variable C3neg equal 30.32101285081
variable C4neg equal ${d4}
variable C4neg equal 9.79877159074914
variable C5neg equal ${d5}
variable C5neg equal -0.285756798330555
variable C6neg equal ${d6}
variable C6neg equal 32.8340722130607

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.6383
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.176383 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.6782 14.2194 17.814683) with tilt (-7.0409 -1.0144 0.675)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos3 all custom 100 dump/pos_deform3.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.3 | 122.3 | 124.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   292.834       -41013.259     -59918.939      0              3971.5092    
       100   294.76825     -41027.554     -760.24395     -6728.351       3971.5092    
       200   295.95176     -41055.538     -5340.6168     -9495.9536      3971.5092    
       300   284.15139     -41066.122     -18399.505     -8828.4101      3971.5092    
       400   293.45006     -41072.779     -10643.482     -10589.802      3971.5092    
       500   291.96664     -41058.771     -10395.824     -9574.2346      3971.5092    
       600   299.65996     -41040.524     -10888.055     -10388.355      3971.5092    
       700   325.59609     -41049.134     -5768.4036     -14627.868      3971.5092    
       800   293.1996      -41021.083     -16563.279     -15785.654      3971.5092    
       900   299.24371     -41040.538     -21566.058     -10543.652      3971.5092    
      1000   302.80513     -41059.057     -257.42562     -3435.3343      3971.5092    
      1100   291.05247     -41054.053     -7781.2683     -9283.4188      3971.5092    
      1200   308.69298     -41069.758     -7121.9124     -6538.2179      3971.5092    
      1300   298.43529     -41046.726     -20658.468     -8425.7213      3971.5092    
      1400   310.96263     -41056.147     -8044.5682     -15198.382      3971.5092    
      1500   291.01821     -41037.804     -1481.8826     -13014.642      3971.5092    
      1600   303.83757     -41055.292     -17582.812     -9513.5612      3971.5092    
      1700   296.28048     -41052.686     -15760.594     -10037.88       3971.5092    
      1800   294.93526     -41056.835     -7787.5824     -16663.667      3971.5092    
      1900   298.5323      -41064.515     -14978.552     -9935.5807      3971.5092    
      2000   297.59795     -41057.954     -15880.512     -11147.147      3971.5092    
Loop time of 85.3296 on 16 procs for 2000 steps with 350 atoms

Performance: 1.013 ns/day, 23.703 hours/ns, 23.439 timesteps/s, 8.203 katom-step/s
99.6% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 47.425     | 59.127     | 70.318     | 140.4 | 69.29
Bond    | 0.00057945 | 0.00072551 | 0.00087038 |   0.0 |  0.00
Neigh   | 4.4609     | 5.4561     | 6.3933     |  37.0 |  6.39
Comm    | 1.469      | 12.657     | 24.364     | 303.5 | 14.83
Output  | 0.003982   | 0.0070675  | 0.0086075  |   2.1 |  0.01
Modify  | 7.0947     | 8.0362     | 9.041      |  30.6 |  9.42
Other   |            | 0.04617    |            |       |  0.05

Nlocal:          43.75 ave          48 max          37 min
Histogram: 1 0 0 1 0 0 2 2 1 1
Nghost:        3097.88 ave        3166 max        3040 min
Histogram: 1 1 1 0 2 0 2 0 0 1
Neighs:        26983.8 ave       29540 max       22866 min
Histogram: 1 0 0 1 0 0 2 2 1 1

Total # of neighbors = 215870
Ave neighs/atom = 616.77143
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos3

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.4 | 122.3 | 124.3 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   297.59795     -41057.954     -15880.459      0              3971.5092    
       100   292.55253     -41049.512     -17931.73      -12880.746      3971.5092    
       200   293.06612     -41042.972     -19359.602     -12082.018      3971.5092    
       300   313.83309     -41047.997     -20727.577     -12891.557      3971.5092    
       400   317.05154     -41049.101     -10556.596     -10380.73       3971.5092    
       500   289.82445     -41052.507     -23941.842     -9657.8221      3971.5092    
       600   285.33633     -41058.834     -20789.488     -10774          3971.5092    
       700   297.98483     -41061.38      -8937.4189     -7957.6583      3971.5092    
       800   295.09291     -41044.388     -6994.864      -12683.608      3971.5092    
       900   316.78881     -41034.522     -19650.318     -13591.602      3971.5092    
      1000   334.68214     -41029.231     -8549.2063     -10940.645      3971.5092    
      1100   320.73127     -41043.19      -6071.0683     -12516.892      3971.5092    
      1200   303.39726     -41042.209     -5985.7253     -11287.662      3971.5092    
      1300   296.17671     -41049.117     -8980.8004     -13318.223      3971.5092    
      1400   314.90265     -41084.05      -7005.03       -12714.197      3971.5092    
      1500   286.47347     -41063.245     -1505.3567     -7949.1039      3971.5092    
      1600   288.23779     -41085.666     -18820.539     -9498.8403      3971.5092    
      1700   275.34268     -41075.3       -19329.494     -14426.772      3971.5092    
      1800   320.59724     -41092.352     -6231.7086     -12483.052      3971.5092    
      1900   314.05123     -41077.322     -2352.9851     -7512.0017      3971.5092    
      2000   302.59546     -41070.521     -1309.5394     -7582.5482      3971.5092    
Loop time of 85.119 on 16 procs for 2000 steps with 350 atoms

Performance: 1.015 ns/day, 23.644 hours/ns, 23.497 timesteps/s, 8.224 katom-step/s
99.6% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 48.676     | 57.236     | 70.576     | 120.3 | 67.24
Bond    | 0.0005599  | 0.00071772 | 0.00087979 |   0.0 |  0.00
Neigh   | 4.6226     | 5.2964     | 6.4064     |  31.9 |  6.22
Comm    | 1.1341     | 14.469     | 23.027     | 239.4 | 17.00
Output  | 0.0007613  | 0.000862   | 0.0013054  |   0.0 |  0.00
Modify  | 6.9592     | 8.0748     | 8.7549     |  26.0 |  9.49
Other   |            | 0.04114    |            |       |  0.05

Nlocal:          43.75 ave          48 max          40 min
Histogram: 1 2 0 0 0 2 0 2 0 1
Nghost:        3093.25 ave        3143 max        3055 min
Histogram: 2 0 2 0 1 0 1 1 0 1
Neighs:        26944.6 ave       29402 max       24657 min
Histogram: 1 2 0 0 2 0 0 2 0 1

Total # of neighbors = 215557
Ave neighs/atom = 615.87714
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -20.1173595651328
variable C2pos equal ${d2}
variable C2pos equal -34.0181500996812
variable C3pos equal ${d3}
variable C3pos equal -10.2930817651295
variable C4pos equal ${d4}
variable C4pos equal -6.64206012417494
variable C5pos equal ${d5}
variable C5pos equal -0.731235501775906
variable C6pos equal ${d6}
variable C6pos equal -10.1224430173754

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(32.7153088405422+${C1pos})
variable C13 equal 0.5*(32.7153088405422+-20.1173595651328)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(95.7361588351202+${C2pos})
variable C23 equal 0.5*(95.7361588351202+-34.0181500996812)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(30.32101285081+${C3pos})
variable C33 equal 0.5*(30.32101285081+-10.2930817651295)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(9.79877159074914+${C4pos})
variable C43 equal 0.5*(9.79877159074914+-6.64206012417494)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(-0.285756798330555+${C5pos})
variable C53 equal 0.5*(-0.285756798330555+-0.731235501775906)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(32.8340722130607+${C6pos})
variable C63 equal 0.5*(32.8340722130607+-10.1224430173754)

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.6383
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.6383
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.176383 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.498617)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg4 all custom 100 dump/neg_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.9 | 123.2 | 125.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   292.834       -41043.189     -20529.838      0              3932.1873    
       100   293.33966     -41048.241     -555.57008     -5476.6223      3932.1873    
       200   293.97459     -41059.042     -12904.683     -6999.2145      3932.1873    
       300   282.33599     -41060.976     -10123.295     -9804.9273      3932.1873    
       400   304.98472     -41081.652     -3134.4383     -6727.1255      3932.1873    
       500   288.13918     -41059.811     -1968.7253     -5621.1103      3932.1873    
       600   298.53762     -41064.749     -11314.027     -10073.612      3932.1873    
       700   301.24445     -41073.349     -9637.0437     -8803.6322      3932.1873    
       800   285.95479     -41069.741     -16193.103     -15966.655      3932.1873    
       900   322.6371      -41122.192     -1643.1877     -220.01547      3932.1873    
      1000   297.9248      -41109.355     -12529.269     -3730.0771      3932.1873    
      1100   289.75166     -41087.455     -16273.756     -6272.0485      3932.1873    
      1200   328.62716     -41101.305     -23142.091     -10369.543      3932.1873    
      1300   319.42693     -41102.712     -15869.096     -4110.9361      3932.1873    
      1400   316.01139     -41144.081     -13023.021     -13169.295      3932.1873    
      1500   274.91096     -41138.546     -12827.346     -8981.2789      3932.1873    
      1600   277.09618     -41145.063     -11604.262     -12116.295      3932.1873    
      1700   299.37055     -41143.489     -21739.483     -15888.998      3932.1873    
      1800   334.26099     -41152.16      -15954.293     -17094.271      3932.1873    
      1900   297.25305     -41113.343     -9838.1936     -12261.451      3932.1873    
      2000   316.49524     -41146.034     -9390.8625     -8730.9307      3932.1873    
Loop time of 86.4937 on 16 procs for 2000 steps with 350 atoms

Performance: 0.999 ns/day, 24.026 hours/ns, 23.123 timesteps/s, 8.093 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 48.17      | 58.088     | 72.107     | 138.4 | 67.16
Bond    | 0.00054459 | 0.00074544 | 0.00095607 |   0.0 |  0.00
Neigh   | 4.5253     | 5.3475     | 6.5296     |  37.7 |  6.18
Comm    | 0.80377    | 14.821     | 24.738     | 274.0 | 17.14
Output  | 0.0040897  | 0.0064262  | 0.0077447  |   1.7 |  0.01
Modify  | 6.9976     | 8.1882     | 9.0187     |  30.7 |  9.47
Other   |            | 0.04152    |            |       |  0.05

Nlocal:          43.75 ave          49 max          39 min
Histogram: 1 1 0 2 0 1 0 1 0 2
Nghost:        3120.25 ave        3195 max        3049 min
Histogram: 1 1 0 1 1 2 0 0 1 1
Neighs:        27244.2 ave       30448 max       24450 min
Histogram: 2 0 2 0 0 1 1 0 1 1

Total # of neighbors = 217954
Ave neighs/atom = 622.72571
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg4

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121 | 123.2 | 125.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   316.49524     -41146.034     -9390.8484      0              3932.1873    
       100   283.38639     -41111.888     -8162.553      -13775.521      3932.1873    
       200   312.46573     -41125.744     -13499.121     -9311.1455      3932.1873    
       300   316.81447     -41133.533     -12501.579     -7780.562       3932.1873    
       400   301.42582     -41149.553     -18863.302     -12608.859      3932.1873    
       500   284.37728     -41140.445     -26473.336     -15634.549      3932.1873    
       600   293.05062     -41134.885      2381.834      -11790.236      3932.1873    
       700   290.44262     -41112.103     -2586.8573     -10231.881      3932.1873    
       800   314.47495     -41111.993     -4396.1905     -12542.593      3932.1873    
       900   328.24491     -41098.795     -21451.025     -12436.679      3932.1873    
      1000   324.4851      -41125.126     -14420.629     -8306.3908      3932.1873    
      1100   311.51728     -41135.018     -8945.4002     -13095.891      3932.1873    
      1200   294.59993     -41126.567     -4523.4337     -13644.094      3932.1873    
      1300   314.08094     -41144.658     -19031.115     -8016.6075      3932.1873    
      1400   312.56066     -41130.799     -12512.839     -10715.983      3932.1873    
      1500   327.83036     -41135.444     -14322.789     -13780.075      3932.1873    
      1600   290.49468     -41110.194     -6370.4837     -7942.8008      3932.1873    
      1700   287.57349     -41135.057     -9938.5976     -11297.312      3932.1873    
      1800   295.34448     -41146.777     -7120.0373     -15041.135      3932.1873    
      1900   283.82384     -41121.167     -4480.3409     -7403.2694      3932.1873    
      2000   338.80399     -41143.578     -3126.4237     -19317.762      3932.1873    
Loop time of 86.8587 on 16 procs for 2000 steps with 350 atoms

Performance: 0.995 ns/day, 24.127 hours/ns, 23.026 timesteps/s, 8.059 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 48.504     | 58.214     | 72.562     | 139.1 | 67.02
Bond    | 0.00053478 | 0.00074388 | 0.00094983 |   0.0 |  0.00
Neigh   | 4.4795     | 5.328      | 6.5046     |  37.6 |  6.13
Comm    | 0.79852    | 15.148     | 24.879     | 272.6 | 17.44
Output  | 0.00079369 | 0.00091348 | 0.0013563  |   0.0 |  0.00
Modify  | 6.9474     | 8.1239     | 8.9601     |  30.5 |  9.35
Other   |            | 0.04301    |            |       |  0.05

Nlocal:          43.75 ave          47 max          39 min
Histogram: 1 1 0 0 0 0 2 2 1 1
Nghost:           3117 ave        3203 max        3033 min
Histogram: 1 1 0 1 2 0 0 1 1 1
Neighs:        27238.2 ave       29161 max       24423 min
Histogram: 2 0 0 0 0 0 2 2 1 1

Total # of neighbors = 217906
Ave neighs/atom = 622.58857
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -98.7896918051954
variable C2neg equal ${d2}
variable C2neg equal 26.425436164027
variable C3neg equal ${d3}
variable C3neg equal -130.373234191867
variable C4neg equal ${d4}
variable C4neg equal 27.0789152554466
variable C5neg equal ${d5}
variable C5neg equal -4.4640007988643
variable C6neg equal ${d6}
variable C6neg equal -2.31288495331555

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.6383
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.176383 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.851383)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos4 all custom 100 dump/pos_deform4.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.9 | 123.2 | 125.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   292.834       -41038.294     -16683.633      0              3932.1873    
       100   299.18804     -41049.868     -5797.3409     -6780.769       3932.1873    
       200   305.90331     -41067.883     -7253.8938     -6993.0002      3932.1873    
       300   288.24786     -41061.783     -10156.741     -11157.768      3932.1873    
       400   300.62759     -41072.672     -11043.68      -6762.7665      3932.1873    
       500   282.6473      -41057.722     -12593.33      -10604.215      3932.1873    
       600   303.85681     -41070.089     -15113.948     -7324.182       3932.1873    
       700   293.41338     -41054.907     -25721.262     -9100.7322      3932.1873    
       800   318.52059     -41078.182     -2192.7211     -11689.445      3932.1873    
       900   311.37264     -41076.096     -3558.3062     -6753.96        3932.1873    
      1000   297.6547      -41069.127     -2633.5261     -6692.8518      3932.1873    
      1100   319.27007     -41087.772     -19549.261     -7157.4829      3932.1873    
      1200   278.15246     -41043.412     -522.68302     -7635.4739      3932.1873    
      1300   293.20996     -41053.332     -18390.84      -11167.573      3932.1873    
      1400   294.13353     -41053.105     -6997.704      -10255.976      3932.1873    
      1500   317.33852     -41084.484     -3015.2031     -10768.697      3932.1873    
      1600   305.30563     -41086.458     -7224.8535     -7137.1591      3932.1873    
      1700   293.36089     -41082.163     -8644.7847     -7380.159       3932.1873    
      1800   310.07774     -41096.518     -10552.656     -7891.0212      3932.1873    
      1900   306.49629     -41090.491     -11434.422     -11355.639      3932.1873    
      2000   286.25918     -41062.874     -7063.0821     -11419.161      3932.1873    
Loop time of 86.3712 on 16 procs for 2000 steps with 350 atoms

Performance: 1.000 ns/day, 23.992 hours/ns, 23.156 timesteps/s, 8.105 katom-step/s
99.6% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 47.814     | 58.013     | 71.705     | 136.4 | 67.17
Bond    | 0.00056068 | 0.00075334 | 0.0008906  |   0.0 |  0.00
Neigh   | 4.5049     | 5.3689     | 6.5123     |  36.7 |  6.22
Comm    | 1.0633     | 14.754     | 24.952     | 270.4 | 17.08
Output  | 0.0039109  | 0.0064323  | 0.0078095  |   1.8 |  0.01
Modify  | 7.0361     | 8.1865     | 9.0583     |  29.9 |  9.48
Other   |            | 0.04177    |            |       |  0.05

Nlocal:          43.75 ave          47 max          36 min
Histogram: 1 0 0 1 0 0 0 2 0 4
Nghost:           3102 ave        3169 max        3044 min
Histogram: 1 0 1 1 1 2 1 0 0 1
Neighs:        27232.1 ave       29305 max       22430 min
Histogram: 1 0 0 1 0 0 0 2 1 3

Total # of neighbors = 217857
Ave neighs/atom = 622.44857
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos4

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121 | 123.2 | 125.4 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   286.25918     -41062.874     -7063.1216      0              3932.1873    
       100   298.35152     -41091.317     -6388.1565     -6433.592       3932.1873    
       200   290.28766     -41115.199     -10095.241     -6619.7635      3932.1873    
       300   311.07081     -41144.646     -17417.537     -9323.2865      3932.1873    
       400   283.59245     -41121.819      1970.4272     -8362.3791      3932.1873    
       500   302.38175     -41131.69       450.62782     -8136.7551      3932.1873    
       600   307.86606     -41113.602     -9051.855      -7827.0829      3932.1873    
       700   318.17216     -41098.212     -11190.881     -12912.65       3932.1873    
       800   313.54445     -41107.652     -4383.6008     -3937.0479      3932.1873    
       900   288.29217     -41104.612     -20838.771     -14144.107      3932.1873    
      1000   302.18993     -41127.149     -8902.4956     -10639.666      3932.1873    
      1100   305.4621      -41141.094      3818.8317     -4148.8058      3932.1873    
      1200   274.03213     -41117.046     -9922.6754     -2879.9385      3932.1873    
      1300   296.05248     -41117.89      -19197.457     -8208.2021      3932.1873    
      1400   314.42272     -41110.861     -12028.97      -6146.0599      3932.1873    
      1500   310.14261     -41107.335     -6360.498      -13162.85       3932.1873    
      1600   284.52109     -41109.621     -14539.361     -9758.0463      3932.1873    
      1700   316.81494     -41155.304     -8608.425      -9413.4134      3932.1873    
      1800   284.33928     -41120.506      977.78639     -5239.5795      3932.1873    
      1900   312.4591      -41141.712     -12748.549     -7325.0816      3932.1873    
      2000   306.40676     -41113.157     -13977.373     -11746.075      3932.1873    
Loop time of 88.1997 on 16 procs for 2000 steps with 350 atoms

Performance: 0.980 ns/day, 24.500 hours/ns, 22.676 timesteps/s, 7.937 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 48.515     | 60.85      | 73.556     | 149.1 | 68.99
Bond    | 0.00064359 | 0.00076783 | 0.00088821 |   0.0 |  0.00
Neigh   | 4.5597     | 5.6155     | 6.7821     |  40.5 |  6.37
Comm    | 0.80746    | 13.508     | 25.845     | 316.2 | 15.31
Output  | 0.00088037 | 0.00101    | 0.0014783  |   0.6 |  0.00
Modify  | 7.0107     | 8.1833     | 9.2445     |  33.8 |  9.28
Other   |            | 0.04172    |            |       |  0.05

Nlocal:          43.75 ave          46 max          39 min
Histogram: 1 0 0 0 2 0 0 1 1 3
Nghost:        3158.75 ave        3230 max        3102 min
Histogram: 1 0 2 1 0 2 1 0 0 1
Neighs:          27239 ave       28590 max       24297 min
Histogram: 1 0 0 0 2 0 0 1 1 3

Total # of neighbors = 217912
Ave neighs/atom = 622.60571
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 22.069577723421
variable C2pos equal ${d2}
variable C2pos equal -1.69320004375563
variable C3pos equal ${d3}
variable C3pos equal 57.9029720228316
variable C4pos equal ${d4}
variable C4pos equal 0.499499303421582
variable C5pos equal ${d5}
variable C5pos equal -3.99029492168664
variable C6pos equal ${d6}
variable C6pos equal -1.90683578064678

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-98.7896918051954+${C1pos})
variable C14 equal 0.5*(-98.7896918051954+22.069577723421)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(26.425436164027+${C2pos})
variable C24 equal 0.5*(26.425436164027+-1.69320004375563)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(-130.373234191867+${C3pos})
variable C34 equal 0.5*(-130.373234191867+57.9029720228316)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(27.0789152554466+${C4pos})
variable C44 equal 0.5*(27.0789152554466+0.499499303421582)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-4.4640007988643+${C5pos})
variable C54 equal 0.5*(-4.4640007988643+-3.99029492168664)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-2.31288495331555+${C6pos})
variable C64 equal 0.5*(-2.31288495331555+-1.90683578064678)

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 17.6383
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.6383
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.176383 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.190783 0.675)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg5 all custom 100 dump/neg_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.9 | 123.2 | 125.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   292.834       -41041.457     -17677.656      0              3932.1873    
       100   297.59117     -41051.893     -1226.4605     -5974.6447      3932.1873    
       200   298.42684     -41063.305     -12732.397     -5233.1754      3932.1873    
       300   283.05422     -41059.086     -9077.387      -8139.3083      3932.1873    
       400   308.58124     -41081.161     -21606.909     -7063.0286      3932.1873    
       500   280.39522     -41051.573     -14981.096     -11484.163      3932.1873    
       600   311.20826     -41067.374     -15464.041     -5813.3556      3932.1873    
       700   292.24186     -41040.916     -4699.4787     -7191.414       3932.1873    
       800   291.17297     -41045.928     -2411.2791     -14398.396      3932.1873    
       900   299.64124     -41063.753     -8737.5664     -6566.4236      3932.1873    
      1000   299.36668     -41070.242     -14333.621     -8260.1144      3932.1873    
      1100   292.98144     -41055.495     -12208.771     -11353.864      3932.1873    
      1200   313.59014     -41065.943     -13304.45      -9547.1414      3932.1873    
      1300   308.97169     -41066.522     -18099.319     -4394.9195      3932.1873    
      1400   294.76273     -41062.468     -16251.881     -13686.76       3932.1873    
      1500   294.39555     -41066.436     -10088.996     -8297.057       3932.1873    
      1600   306.69223     -41072.482     -8448.0721     -7670.9833      3932.1873    
      1700   308.31836     -41073.96      -12582.957     -8590.0903      3932.1873    
      1800   303.60971     -41068.645     -5976.4542     -9802.2104      3932.1873    
      1900   296.53388     -41071.379     -6527.4677     -11629.609      3932.1873    
      2000   283.59423     -41061.701     -15855.143     -14431.332      3932.1873    
Loop time of 87.2434 on 16 procs for 2000 steps with 350 atoms

Performance: 0.990 ns/day, 24.234 hours/ns, 22.924 timesteps/s, 8.024 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 48.638     | 58.954     | 72.834     | 136.9 | 67.57
Bond    | 0.00060645 | 0.00075232 | 0.00089351 |   0.0 |  0.00
Neigh   | 4.4701     | 5.4328     | 6.752      |  39.9 |  6.23
Comm    | 0.78059    | 14.655     | 24.966     | 274.5 | 16.80
Output  | 0.0041527  | 0.0059766  | 0.0071096  |   1.4 |  0.01
Modify  | 6.8287     | 8.1555     | 9.1241     |  32.8 |  9.35
Other   |            | 0.03941    |            |       |  0.05

Nlocal:          43.75 ave          48 max          39 min
Histogram: 1 0 0 1 3 0 1 0 1 1
Nghost:        3086.88 ave        3152 max        3023 min
Histogram: 1 1 1 0 1 1 1 0 1 1
Neighs:        27243.1 ave       29756 max       24260 min
Histogram: 1 0 0 1 3 0 0 1 0 2

Total # of neighbors = 217945
Ave neighs/atom = 622.7
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg5

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.1 | 123.2 | 125.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   283.59423     -41061.701     -15855.123      0              3932.1873    
       100   291.28335     -41069.199     -12054.864     -15564.142      3932.1873    
       200   297.1133      -41058.211      19.005385     -10758.235      3932.1873    
       300   296.51192     -41032.799     -7758.554      -5390.5062      3932.1873    
       400   313.09751     -41048.654     -9167.8401     -13964.132      3932.1873    
       500   290.0101      -41061.262     -10248.764     -9439.48        3932.1873    
       600   313.33389     -41099.254     -1625.9229     -7502.241       3932.1873    
       700   307.53697     -41093.995     -1282.6685     -6849.8585      3932.1873    
       800   282.41838     -41070.639     -10884.735     -9361.2434      3932.1873    
       900   298.11945     -41077.323      2213.4039     -11827.841      3932.1873    
      1000   325.94002     -41081.772     -13245.366     -7751.8325      3932.1873    
      1100   307.88425     -41068.345     -8873.0152     -10963.724      3932.1873    
      1200   298.82591     -41091.523     -8388.8947     -9108.5282      3932.1873    
      1300   279.26634     -41079.395     -13932.122     -3169.6571      3932.1873    
      1400   287.94183     -41076.218     -24582.679     -10851.886      3932.1873    
      1500   310.37268     -41093.637     -12195.721     -6357.1797      3932.1873    
      1600   282.63211     -41078.193      246.04957     -6432.6375      3932.1873    
      1700   263.24145     -41091.978      2842.6497     -10577.681      3932.1873    
      1800   295.71756     -41127.857     -14863.804     -3928.0499      3932.1873    
      1900   285.9589      -41093.294     -5276.9175     -5950.8133      3932.1873    
      2000   277.29345     -41068.571      2430.4365     -8089.0282      3932.1873    
Loop time of 88.4808 on 16 procs for 2000 steps with 350 atoms

Performance: 0.976 ns/day, 24.578 hours/ns, 22.604 timesteps/s, 7.911 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 47.937     | 60.782     | 73.215     | 152.8 | 68.70
Bond    | 0.00060397 | 0.00075204 | 0.00089727 |   0.0 |  0.00
Neigh   | 4.4653     | 5.6597     | 6.9676     |  43.9 |  6.40
Comm    | 1.136      | 13.56      | 26.394     | 323.2 | 15.33
Output  | 0.00082662 | 0.00098379 | 0.0014409  |   0.0 |  0.00
Modify  | 7.1        | 8.4349     | 9.6491     |  36.7 |  9.53
Other   |            | 0.04198    |            |       |  0.05

Nlocal:          43.75 ave          48 max          39 min
Histogram: 1 0 0 1 1 3 0 1 0 1
Nghost:        3114.38 ave        3182 max        3052 min
Histogram: 1 0 1 1 1 2 0 0 1 1
Neighs:        27254.1 ave       29915 max       24453 min
Histogram: 1 0 1 0 1 3 0 1 0 1

Total # of neighbors = 218033
Ave neighs/atom = 622.95143
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal 14.9854512960064
variable C2neg equal ${d2}
variable C2neg equal 111.064159781893
variable C3neg equal ${d3}
variable C3neg equal 32.533944705619
variable C4neg equal ${d4}
variable C4neg equal 11.5395683206523
variable C5neg equal ${d5}
variable C5neg equal -1.30047998321922
variable C6neg equal ${d6}
variable C6neg equal 13.4826375982417

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.6383
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.176383 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -0.838017 0.675)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos5 all custom 100 dump/pos_deform5.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.9 | 123.2 | 125.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   292.834       -41039.405     -19721.454      0              3932.1873    
       100   295.36393     -41046.812     -3209.2823     -6302.3317      3932.1873    
       200   290.46512     -41052.293     -11693.065     -9487.0486      3932.1873    
       300   280.6334      -41054.619     -17868.458     -11297.972      3932.1873    
       400   308.84013     -41081.068     -13780.343     -9605.6212      3932.1873    
       500   288.38714     -41060.675     -12239.401     -9761.7217      3932.1873    
       600   296.50317     -41064.338      1021.2313     -7558.5726      3932.1873    
       700   301.06216     -41064.084     -9301.5805     -10000.67       3932.1873    
       800   293.57522     -41058.874      4846.6418     -15662.742      3932.1873    
       900   302.60441     -41065.644     -26727.246     -10080.672      3932.1873    
      1000   291.08784     -41047.922     -11281.007     -4126.2908      3932.1873    
      1100   317.9272      -41073.678     -11774.894     -9369.7106      3932.1873    
      1200   305.93235     -41064.938     -11050.178     -5259.8895      3932.1873    
      1300   302.68894     -41074.12      -16790.468     -11762.618      3932.1873    
      1400   280.85978     -41064.208      2380.0141     -15994.816      3932.1873    
      1500   287.83556     -41077.474      2897.6051     -9306.8974      3932.1873    
      1600   280.51235     -41066.487      7605.8877     -4863.4565      3932.1873    
      1700   311.10171     -41088.891     -17445.065     -8393.8913      3932.1873    
      1800   307.56618     -41091.843     -7262.5945     -9828.2705      3932.1873    
      1900   306.10647     -41106.682     -9620.2631     -10790.137      3932.1873    
      2000   290.3486      -41118.768     -15905.058     -4650.827       3932.1873    
Loop time of 88.6839 on 16 procs for 2000 steps with 350 atoms

Performance: 0.974 ns/day, 24.634 hours/ns, 22.552 timesteps/s, 7.893 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 47.795     | 62.958     | 73.64      | 144.7 | 70.99
Bond    | 0.00057524 | 0.00074863 | 0.0010264  |   0.0 |  0.00
Neigh   | 4.4483     | 5.8273     | 6.9128     |  40.5 |  6.57
Comm    | 0.81777    | 11.485     | 26.638     | 338.3 | 12.95
Output  | 0.0042278  | 0.0065598  | 0.0078753  |   1.7 |  0.01
Modify  | 7.2538     | 8.3608     | 9.7636     |  34.4 |  9.43
Other   |            | 0.04531    |            |       |  0.05

Nlocal:          43.75 ave          46 max          40 min
Histogram: 1 0 0 0 0 2 3 0 0 2
Nghost:        3096.75 ave        3169 max        3032 min
Histogram: 1 0 2 1 0 1 2 0 0 1
Neighs:        27247.8 ave       28604 max       24933 min
Histogram: 1 0 0 0 1 1 2 1 0 2

Total # of neighbors = 217982
Ave neighs/atom = 622.80571
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos5

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121 | 123.2 | 125.5 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   290.3486      -41118.768     -15904.987      0              3932.1873    
       100   290.30445     -41108.081     -3466.5584     -12280.975      3932.1873    
       200   299.30527     -41092.133     -7521.8839     -9872.0541      3932.1873    
       300   322.2111      -41084.045     -1255.0991     -2783.3447      3932.1873    
       400   306.14099     -41072.379     -10065.451     -8881.1292      3932.1873    
       500   310.19709     -41089.578     -17036.626     -9920.2051      3932.1873    
       600   306.10399     -41105.287     -5949.8818     -8150.49        3932.1873    
       700   287.45491     -41089.877     -1976.8762     -9235.5608      3932.1873    
       800   292.6547      -41092.477     -12009.25      -14109.982      3932.1873    
       900   287.85389     -41113.025     -15512.37      -14017.223      3932.1873    
      1000   283.92309     -41124.112      257.29472     -11528.964      3932.1873    
      1100   293.83286     -41116.67      -3313.3343     -6863.8307      3932.1873    
      1200   292.20419     -41083.029     -17596.951     -14554.177      3932.1873    
      1300   320.61491     -41109.069     -15873.433     -5223.9318      3932.1873    
      1400   283.64637     -41092.306     -11715.057     -6921.5774      3932.1873    
      1500   295.97181     -41121.938     -19613.633     -4787.1743      3932.1873    
      1600   303.76869     -41136.918     -11626.799     -10692.452      3932.1873    
      1700   283.35943     -41134.63      -12056.111     -8788.546       3932.1873    
      1800   277.9529      -41156.901      4821.8544     -8490.8194      3932.1873    
      1900   284.47739     -41153.48      -11725.821     -9158.436       3932.1873    
      2000   313.79205     -41154.017     -21911.84      -14451.39       3932.1873    
Loop time of 88.2993 on 16 procs for 2000 steps with 350 atoms

Performance: 0.978 ns/day, 24.528 hours/ns, 22.650 timesteps/s, 7.928 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 47.695     | 62.587     | 73.198     | 140.6 | 70.88
Bond    | 0.00057536 | 0.00073808 | 0.0010239  |   0.0 |  0.00
Neigh   | 4.5712     | 5.8313     | 7.0101     |  40.7 |  6.60
Comm    | 0.96806    | 11.569     | 26.447     | 326.7 | 13.10
Output  | 0.00085644 | 0.0010062  | 0.0014664  |   0.6 |  0.00
Modify  | 7.0666     | 8.2668     | 9.5522     |  34.7 |  9.36
Other   |            | 0.04356    |            |       |  0.05

Nlocal:          43.75 ave          47 max          39 min
Histogram: 1 2 0 0 0 0 0 1 2 2
Nghost:        3103.75 ave        3192 max        3028 min
Histogram: 1 0 1 2 0 1 2 0 0 1
Neighs:        27253.5 ave       29272 max       24214 min
Histogram: 1 2 0 0 0 0 0 1 2 2

Total # of neighbors = 218028
Ave neighs/atom = 622.93714
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal 49.4811768837745
variable C2pos equal ${d2}
variable C2pos equal -17.3058672825105
variable C3pos equal ${d3}
variable C3pos equal 80.9846250270473
variable C4pos equal ${d4}
variable C4pos equal -8.66920163351812
variable C5pos equal ${d5}
variable C5pos equal 14.8312511861366
variable C6pos equal ${d6}
variable C6pos equal -6.62953898441372

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(14.9854512960064+${C1pos})
variable C15 equal 0.5*(14.9854512960064+49.4811768837745)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(111.064159781893+${C2pos})
variable C25 equal 0.5*(111.064159781893+-17.3058672825105)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(32.533944705619+${C3pos})
variable C35 equal 0.5*(32.533944705619+80.9846250270473)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(11.5395683206523+${C4pos})
variable C45 equal 0.5*(11.5395683206523+-8.66920163351812)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(-1.30047998321922+${C5pos})
variable C55 equal 0.5*(-1.30047998321922+14.8312511861366)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(13.4826375982417+${C6pos})
variable C65 equal 0.5*(13.4826375982417+-6.62953898441372)

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which reference length to use
if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 14.2194

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Negative-change ${dir} starts.*****"
*****Negative-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.2194
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.142194 remap units box
Changing box ...
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.183094 -1.0144 0.675)

# Run MD for Negative deformation
# save trajectory
dump dump_neg${dir} all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom ${nthermo} dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform${dir}.lammpstrj id type x y z
dump dump_neg6 all custom 100 dump/neg_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.2 | 123.5 | 126 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   292.834       -41042.886     -17522.896      0              3932.1873    
       100   295.73618     -41051.266     -6012.8308     -5621.6533      3932.1873    
       200   299.80646     -41065.491     -12469.157     -8150.7695      3932.1873    
       300   273.37674     -41051.183     -23909.658     -11026.514      3932.1873    
       400   306.25766     -41083.963     -13545.593     -5982.5269      3932.1873    
       500   280.09632     -41055.125     -8341.75       -9384.2009      3932.1873    
       600   295.93387     -41056.801     -5051.2943     -8428.8892      3932.1873    
       700   304.89593     -41061.961     -16228.674     -8923.2991      3932.1873    
       800   308.66727     -41073.056     -14404.075     -14551.768      3932.1873    
       900   280.38882     -41049.7       -18319.81      -8905.95        3932.1873    
      1000   305.38265     -41067.365     -4575.3845     -1517.1024      3932.1873    
      1100   301.59377     -41058.333     -150.86155     -10079.357      3932.1873    
      1200   302.98057     -41074.464     -21959.525     -5677.0582      3932.1873    
      1300   300.20165     -41089.249     -24438.352     -10889.709      3932.1873    
      1400   291.70405     -41088.102     -10663.481     -12986.209      3932.1873    
      1500   291.79606     -41071.942     -13745.413     -12604.433      3932.1873    
      1600   306.21721     -41067.891     -1068.8947     -6387.5855      3932.1873    
      1700   313.9209      -41066.685     -27167.094     -8420.2672      3932.1873    
      1800   295.25396     -41058.365     -17696.336     -14650.3        3932.1873    
      1900   292.41945     -41082.828     -9248.5643     -10256.829      3932.1873    
      2000   285.21907     -41102.988     -15778.733     -11122.809      3932.1873    
Loop time of 88.7117 on 16 procs for 2000 steps with 350 atoms

Performance: 0.974 ns/day, 24.642 hours/ns, 22.545 timesteps/s, 7.891 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 47.535     | 60.627     | 73.219     | 150.3 | 68.34
Bond    | 0.00062187 | 0.00074661 | 0.00085723 |   0.0 |  0.00
Neigh   | 4.6103     | 5.7406     | 7.0836     |  42.4 |  6.47
Comm    | 0.99083    | 13.574     | 26.655     | 317.5 | 15.30
Output  | 0.0043528  | 0.0069236  | 0.0082704  |   1.8 |  0.01
Modify  | 7.3503     | 8.717      | 9.8692     |  34.8 |  9.83
Other   |            | 0.04556    |            |       |  0.05

Nlocal:          43.75 ave          47 max          40 min
Histogram: 1 1 1 0 1 0 0 1 2 1
Nghost:        3118.62 ave        3193 max        3046 min
Histogram: 1 0 1 2 0 1 2 0 0 1
Neighs:        27235.4 ave       29223 max       25094 min
Histogram: 1 1 1 1 0 0 1 0 2 1

Total # of neighbors = 217883
Ave neighs/atom = 622.52286
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_neg${dir}
undump dump_neg6

# Run equilibration
print "*****Equilibration neg${dir} starts.*****"
*****Equilibration neg6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.2 | 123.5 | 126 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   285.21907     -41102.988     -15778.728      0              3932.1873    
       100   302.16279     -41110.482     -6117.6515     -6063.9051      3932.1873    
       200   313.00499     -41105.447     -15830.974     -6469.5203      3932.1873    
       300   317.53058     -41093.165     -8117.1347     -9619.1917      3932.1873    
       400   325.02764     -41108.275     -16079.336     -7623.5238      3932.1873    
       500   308.50019     -41132.519     -13662.565     -5180.1866      3932.1873    
       600   315.2656      -41158.83      -17001.664     -8901.0542      3932.1873    
       700   278.25342     -41124.106     -10896.577     -12621.233      3932.1873    
       800   291.35863     -41114.83      -17689.659     -10142.53       3932.1873    
       900   324.64837     -41134.368      12359.452     -11737.531      3932.1873    
      1000   298.13464     -41117.771     -14062.354     -15954.844      3932.1873    
      1100   291.74025     -41147.531     -7136.3853     -9951.6133      3932.1873    
      1200   276.75293     -41145.777     -7860.6111     -6417.0741      3932.1873    
      1300   277.45399     -41134.711      628.6696      -12375.465      3932.1873    
      1400   297.85116     -41134.113     -14988.779     -18031.418      3932.1873    
      1500   312.4059      -41133.843     -790.77908     -4205.8683      3932.1873    
      1600   309.25377     -41127.503     -15078.261     -8496.008       3932.1873    
      1700   290.36252     -41113.327     -13338.057     -8704.513       3932.1873    
      1800   304.26535     -41141.797      5525.227      -2768.2199      3932.1873    
      1900   310.26235     -41146.081     -4863.9639     -9811.9048      3932.1873    
      2000   296.68403     -41134.598     -13903.554     -9799.1499      3932.1873    
Loop time of 84.5526 on 16 procs for 2000 steps with 350 atoms

Performance: 1.022 ns/day, 23.487 hours/ns, 23.654 timesteps/s, 8.279 katom-step/s
99.6% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 44.734     | 52.673     | 69.876     | 135.2 | 62.30
Bond    | 0.00056815 | 0.00072066 | 0.0008594  |   0.0 |  0.00
Neigh   | 4.5369     | 5.2021     | 6.962      |  40.3 |  6.15
Comm    | 0.63679    | 17.824     | 25.757     | 232.3 | 21.08
Output  | 0.00075279 | 0.00087001 | 0.001192   |   0.0 |  0.00
Modify  | 7.0212     | 8.8103     | 9.4911     |  31.5 | 10.42
Other   |            | 0.04076    |            |       |  0.05

Nlocal:          43.75 ave          52 max          36 min
Histogram: 1 0 0 3 0 1 2 0 0 1
Nghost:        3113.62 ave        3180 max        3056 min
Histogram: 1 1 1 0 2 1 0 0 1 1
Neighs:        27240.4 ave       32211 max       22725 min
Histogram: 1 0 0 3 1 0 2 0 0 1

Total # of neighbors = 217923
Ave neighs/atom = 622.63714
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor Negative deformation, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1neg equal ${d1}
variable C1neg equal -2.34235702215246
variable C2neg equal ${d2}
variable C2neg equal 46.6681189977956
variable C3neg equal ${d3}
variable C3neg equal -5.69645497784593
variable C4neg equal ${d4}
variable C4neg equal 19.334648868104
variable C5neg equal ${d5}
variable C5neg equal 10.6784862451277
variable C6neg equal ${d6}
variable C6neg equal 15.7255271791251

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-7.0409 -1.0144 0.675)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  350 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds
print "*****Positive-change ${dir} starts.*****"
*****Positive-change 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: 4

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.2194
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.142194 remap units box
Changing box ...
  triclinic box = (0 0 0) to (15.6782 14.2194 17.6383) with tilt (-6.898706 -1.0144 0.675)

# Run positive deformation MD
# save trajectory
dump dump_pos${dir} all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom ${nthermo} dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform${dir}.lammpstrj id type x y z
dump dump_pos6 all custom 100 dump/pos_deform6.lammpstrj id type x y z
run ${nrun}
run 2000
All restart file global fix info was re-assigned
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.6 | 122.7 | 124.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   292.834       -41038.438     -19654.492      0              3932.1873    
       100   293.09571     -41043.326      2135.4684     -6803.0135      3932.1873    
       200   299.45428     -41060.506     -7161.2989     -6661.3446      3932.1873    
       300   282.79326     -41055.311     -19112.264     -10420.492      3932.1873    
       400   295.83374     -41063.764     -8639.4779     -7254.7713      3932.1873    
       500   285.46875     -41044.184      1735.5368     -6797.7183      3932.1873    
       600   300.7786      -41048.322     -17418.187     -8293.7417      3932.1873    
       700   310.45554     -41063.94      -3754.6958     -7293.194       3932.1873    
       800   300.99989     -41082.199     -13223.833     -12554.251      3932.1873    
       900   307.09643     -41110.505     -10570.697     -9556.797       3932.1873    
      1000   285.55568     -41099.249     -12074.571     -6185.9522      3932.1873    
      1100   295.12676     -41109.021     -13442.966     -10337.281      3932.1873    
      1200   290.36407     -41081.11      -12087.476     -6881.1349      3932.1873    
      1300   308.75114     -41071.292     -4301.2396     -4374.7294      3932.1873    
      1400   297.69628     -41050.109     -6730.1471     -9914.9402      3932.1873    
      1500   312.01148     -41085.896     -13065.432     -13315.356      3932.1873    
      1600   285.68852     -41088.215     -14680.463     -11546.042      3932.1873    
      1700   301.03997     -41119.141      7017.2        -4853.3907      3932.1873    
      1800   273.88066     -41085.998     -2153.1917     -9221.5349      3932.1873    
      1900   291.57898     -41079.072     -13054.52      -4725.1647      3932.1873    
      2000   305.93053     -41068.085     -21069.482     -7534.1395      3932.1873    
Loop time of 84.8135 on 16 procs for 2000 steps with 350 atoms

Performance: 1.019 ns/day, 23.559 hours/ns, 23.581 timesteps/s, 8.253 katom-step/s
99.6% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 44.858     | 52.595     | 70.064     | 138.2 | 62.01
Bond    | 0.00048873 | 0.00071103 | 0.00099274 |   0.0 |  0.00
Neigh   | 4.4915     | 5.1476     | 6.8802     |  40.8 |  6.07
Comm    | 0.64835    | 18.103     | 25.831     | 235.4 | 21.34
Output  | 0.0040162  | 0.0060324  | 0.0071292  |   1.5 |  0.01
Modify  | 7.157      | 8.9201     | 9.593      |  31.6 | 10.52
Other   |            | 0.04137    |            |       |  0.05

Nlocal:          43.75 ave          51 max          37 min
Histogram: 2 0 0 0 1 2 2 0 0 1
Nghost:        3101.88 ave        3170 max        3048 min
Histogram: 2 0 0 3 0 1 0 1 0 1
Neighs:        27251.2 ave       31501 max       23057 min
Histogram: 1 1 0 0 1 1 3 0 0 1

Total # of neighbors = 218010
Ave neighs/atom = 622.88571
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked
undump dump_pos${dir}
undump dump_pos6

# Run equilibration
print "*****Equilibration pos${dir} starts.*****"
*****Equilibration pos6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press f_avgp[1] vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
thermo_modify norm no

# NVT
fix 4 all nvt temp ${temp} ${temp} ${tdamp}
fix 4 all nvt temp 300 ${temp} ${tdamp}
fix 4 all nvt temp 300 300 ${tdamp}
fix 4 all nvt temp 300 300 50
run ${nequil}
run 2000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.6 | 122.7 | 124.9 Mbytes
   Step          Temp          PotEng         Press        f_avgp[1]        Volume    
         0   305.93053     -41068.085     -21069.492      0              3932.1873    
       100   287.56562     -41063.37      -11876.362     -9347.3683      3932.1873    
       200   302.39543     -41107.5        3846.1233     -8413.6711      3932.1873    
       300   288.77259     -41102.256     -3013.9529     -6924.985       3932.1873    
       400   316.20087     -41125.075     -8224.2255     -5670.1995      3932.1873    
       500   286.88618     -41090.318     -11010.871     -10164.831      3932.1873    
       600   309.14998     -41107.111     -21201.197     -11606.701      3932.1873    
       700   303.78924     -41110.357     -10869.849     -13863.567      3932.1873    
       800   297.26549     -41115.211      992.98356     -798.91422      3932.1873    
       900   319.63858     -41123.938     -5269.7367     -7556.2197      3932.1873    
      1000   301.31743     -41083.072     -14241.559     -5608.3582      3932.1873    
      1100   301.76523     -41087.884     -47.761265     -7587.3885      3932.1873    
      1200   279.97085     -41104.208     -24771.937     -11311.728      3932.1873    
      1300   292.86677     -41123.22      -23728.187     -9724.4885      3932.1873    
      1400   302.73865     -41123.784     -8480.8479     -3624.2553      3932.1873    
      1500   280.90715     -41091.066     -5143.0314     -11494.292      3932.1873    
      1600   317.9383      -41099.589     -13755.009     -6026.9676      3932.1873    
      1700   319.69178     -41096.393     -18038.467     -9192.3258      3932.1873    
      1800   331.93117     -41138.636     -8890.4195     -7821.7159      3932.1873    
      1900   303.79291     -41125.783     -11236.997     -11071.432      3932.1873    
      2000   293.51734     -41133.773      3321.1879     -8180.3331      3932.1873    
Loop time of 84.5316 on 16 procs for 2000 steps with 350 atoms

Performance: 1.022 ns/day, 23.481 hours/ns, 23.660 timesteps/s, 8.281 katom-step/s
99.6% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 44.994     | 52.665     | 69.609     | 135.7 | 62.30
Bond    | 0.00049579 | 0.00070425 | 0.00097407 |   0.0 |  0.00
Neigh   | 4.495      | 5.1408     | 6.8751     |  40.8 |  6.08
Comm    | 0.92338    | 17.853     | 25.514     | 232.9 | 21.12
Output  | 0.00070192 | 0.00083899 | 0.0011902  |   0.0 |  0.00
Modify  | 7.0671     | 8.8317     | 9.4941     |  31.7 | 10.45
Other   |            | 0.04026    |            |       |  0.05

Nlocal:          43.75 ave          49 max          41 min
Histogram: 2 1 1 2 0 0 1 0 0 1
Nghost:        3099.12 ave        3170 max        3032 min
Histogram: 1 1 0 1 2 1 0 0 0 2
Neighs:        27230.1 ave       30532 max       25404 min
Histogram: 2 1 1 2 0 0 1 0 0 1

Total # of neighbors = 217841
Ave neighs/atom = 622.40286
Ave special neighs/atom = 0
Neighbor list builds = 200
Dangerous builds not checked

# Obtain new stress tensor, convert index from LAMMPS to Voigt
variable pxx1 equal f_avgp[1]
variable pyy1 equal f_avgp[2]
variable pzz1 equal f_avgp[3]
variable pxy1 equal f_avgp[4]
variable pxz1 equal f_avgp[5]
variable pyz1 equal f_avgp[6]

# Compute elastic constant from pressure tensor
# d1 = -[pxx1-pxx0]/[(]v_delta/v_len0] defined in input script
variable C1pos equal ${d1}
variable C1pos equal -14.0603040849798
variable C2pos equal ${d2}
variable C2pos equal -41.1628937257366
variable C3pos equal ${d3}
variable C3pos equal -23.3047154323382
variable C4pos equal ${d4}
variable C4pos equal 0.240350330783069
variable C5pos equal ${d5}
variable C5pos equal 11.4214158817754
variable C6pos equal ${d6}
variable C6pos equal 5.03822304580078

# Combine positive and negative
variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(-2.34235702215246+${C1pos})
variable C16 equal 0.5*(-2.34235702215246+-14.0603040849798)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(46.6681189977956+${C2pos})
variable C26 equal 0.5*(46.6681189977956+-41.1628937257366)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-5.69645497784593+${C3pos})
variable C36 equal 0.5*(-5.69645497784593+-23.3047154323382)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(19.334648868104+${C4pos})
variable C46 equal 0.5*(19.334648868104+0.240350330783069)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(10.6784862451277+${C5pos})
variable C56 equal 0.5*(10.6784862451277+11.4214158817754)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(15.7255271791251+${C6pos})
variable C66 equal 0.5*(15.7255271791251+5.03822304580078)

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
include calc.mod.lmp
variable C11all equal ${C11}
variable C11all equal 9.25188970444287
variable C22all equal ${C22}
variable C22all equal 12.4974220515679
variable C33all equal ${C33}
variable C33all equal 10.0139655428402

variable C44all equal ${C44}
variable C44all equal 13.7892072794341
variable C55all equal ${C55}
variable C55all equal 6.76538560145869
variable C66all equal ${C66}
variable C66all equal 10.3818751124629

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(1.8437244343073+${C21})
variable C12all equal 0.5*(1.8437244343073+-25.3404092570692)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(6.2989746377047+${C31})
variable C13all equal 0.5*(6.2989746377047+42.9067870556885)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(30.8590043677195+${C32})
variable C23all equal 0.5*(30.8590043677195+-10.7223313857623)

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-38.3600570408872+${C41})
variable C14all equal 0.5*(-38.3600570408872+-10.8171929919756)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(32.2333140898904+${C51})
variable C15all equal 0.5*(32.2333140898904+-2.28017698697446)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-8.20133055356613+${C61})
variable C16all equal 0.5*(-8.20133055356613+2.66451395046111)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(12.3661180601357+${C42})
variable C24all equal 0.5*(12.3661180601357+-10.6033562317416)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(46.8791462496912+${C52})
variable C25all equal 0.5*(46.8791462496912+10.0669260701349)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(2.7526126360295+${C62})
variable C26all equal 0.5*(2.7526126360295+-6.49850550442106)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(-36.2351310845177+${C43})
variable C34all equal 0.5*(-36.2351310845177+1.5783557332871)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(56.7592848663331+${C53})
variable C35all equal 0.5*(56.7592848663331+-0.508496150053231)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-14.5005852050921+${C63})
variable C36all equal 0.5*(-14.5005852050921+11.3558145978427)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(1.43518334356709+${C54})
variable C45all equal 0.5*(1.43518334356709+-4.22714786027547)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(9.78749959944354+${C64})
variable C46all equal 0.5*(9.78749959944354+-2.10986036698116)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(11.0499510634516+${C65})
variable C56all equal 0.5*(11.0499510634516+3.42654930691399)

# print stiffness tensor to "C.log"
print """
# stiffness tensor (GPa) for ${structure} by change-box method
${C11all} ${C12all} ${C13all} ${C14all} ${C15all} ${C16all}
${C12all} ${C22all} ${C23all} ${C24all} ${C25all} ${C26all}
${C13all} ${C23all} ${C33all} ${C34all} ${C35all} ${C36all}
${C14all} ${C24all} ${C34all} ${C44all} ${C45all} ${C46all}
${C15all} ${C25all} ${C35all} ${C45all} ${C55all} ${C56all}
${C16all} ${C26all} ${C36all} ${C46all} ${C56all} ${C66all}
"""  file C.log screen no

Total wall time: 0:36:06
