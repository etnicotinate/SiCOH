LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 100
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 50
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 1.0                  # the deformation magnitude 0.01

variable FF string "SiOCHN_2018.ff C H O Si"   # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si
variable structure string 333U-50C-26-vasp

# Read the initial sctructure
# box tilt large
read_data       ${structure}.data
read_data       333U-50C-26-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.013 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
fix bondinfo all reaxff/bonds 1 bonds_opt.reaxff

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
dump dump_opt all custom 1 dump/dump_opt.lammpstrj id type q x y z
minimize 1.0e-6 1.0e-6 100 1000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -6.56 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120 | 120.8 | 121.6 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0             -30507.348      0             -30507.348      114558.11    
        56   0             -34478.774      0             -34478.774     -10092.764    
Loop time of 5.34154 on 16 procs for 56 steps with 365 atoms

96.8% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
     -30507.3481403154  -34478.7564123808  -34478.7742384725
  Force two-norm initial, final = 4322.995 139.22122
  Force max component initial, final = 826.83927 46.417724
  Final line search alpha, max atom move = 0.00087753514 0.040733184
  Iterations, force evaluations = 56 158

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.8579     | 3.4133     | 3.8852     |  22.3 | 63.90
Bond    | 4.205e-05  | 5.8144e-05 | 7.0967e-05 |   0.0 |  0.00
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.21456    | 0.68586    | 1.2428     |  49.7 | 12.84
Output  | 0.010293   | 0.013691   | 0.01537    |   1.3 |  0.26
Modify  | 1.2168     | 1.2176     | 1.2181     |   0.1 | 22.79
Other   |            | 0.01104    |            |       |  0.21

Nlocal:         45.625 ave          54 max          36 min
Histogram: 1 1 0 1 2 0 0 0 0 3
Nghost:        2886.75 ave        2905 max        2864 min
Histogram: 1 0 1 2 0 0 0 0 3 1
Neighs:        25049.8 ave       29297 max       20155 min
Histogram: 2 0 0 0 3 0 0 0 0 3

Total # of neighbors = 200398
Ave neighs/atom = 549.03562
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-26-vasp_opt.data
System init for write_data ...
undump dump_opt
unfix bondinfo
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
dump dump_eq all custom ${nthermo} dump/dump_eq.lammpstrj id type q x y z
dump dump_eq all custom 100 dump/dump_eq.lammpstrj id type q x y z

# compute MSD
compute msd1 all msd
fix myMSD all ave/time ${nevery} ${nrepeat} ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 ${nrepeat} ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 10 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 10 100 c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out

run ${nequil}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 113.8 | 114.6 | 115.4 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -34478.774     -6864.9342      1.4343051      4609.3376    
       100   316.97888     -34460.466     -12688.129      1.4343051      4609.3376    
       200   466.10213     -34647.09      -6215.0705      1.4343051      4609.3376    
       300   436.07218     -34762.573     -3679.2313      1.4343051      4609.3376    
       400   410.83769     -34902.795      3222.3684      1.4343051      4609.3376    
       500   368.5432      -34982.066     -2047.054       1.4343051      4609.3376    
       600   299.57447     -35002.185     -7464.3604      1.4343051      4609.3376    
       700   344.8371      -35153.049      2491.5008      1.4343051      4609.3376    
       800   365.95312     -35277.61      -4280.7384      1.4343051      4609.3376    
       900   323.97946     -35329.891     -5120.6611      1.4343051      4609.3376    
      1000   293.55964     -35368.292     -11264.018      1.4343051      4609.3376    
      1100   309.82448     -35427.328     -9190.1801      1.4343051      4609.3376    
      1200   301.38812     -35455.663     -9300.4052      1.4343051      4609.3376    
      1300   304.36099     -35488.872     -11075.117      1.4343051      4609.3376    
      1400   308.57875     -35501.659     -2573.1934      1.4343051      4609.3376    
      1500   304.73521     -35511.719     -6167.7259      1.4343051      4609.3376    
      1600   295.4373      -35535.926     -14126.217      1.4343051      4609.3376    
      1700   291.18919     -35574.752     -8739.2516      1.4343051      4609.3376    
      1800   292.58606     -35603.833     -3986.9457      1.4343051      4609.3376    
      1900   297.23286     -35615.4       -10160.649      1.4343051      4609.3376    
      2000   275.6427      -35589.239     -12567.087      1.4343051      4609.3376    
      2100   305.80105     -35609.234     -5488.3816      1.4343051      4609.3376    
      2200   321.82142     -35622.812     -16655.855      1.4343051      4609.3376    
      2300   299.87785     -35624.575     -1957.3897      1.4343051      4609.3376    
      2400   294.02099     -35648.044     -7419.1428      1.4343051      4609.3376    
      2500   289.72467     -35660.311     -9801.8693      1.4343051      4609.3376    
      2600   281.32918     -35663.039     -4390.2176      1.4343051      4609.3376    
      2700   308.5974      -35689.364     -955.23213      1.4343051      4609.3376    
      2800   335.84248     -35714.267     -352.43111      1.4343051      4609.3376    
      2900   310.6126      -35733.058     -1268.2996      1.4343051      4609.3376    
      3000   331.77089     -35781.964     -8938.8992      1.4343051      4609.3376    
      3100   308.5098      -35809.504     -5323.1059      1.4343051      4609.3376    
      3200   306.46668     -35839.786      1829.7663      1.4343051      4609.3376    
      3300   298.25924     -35853.676     -6115.9196      1.4343051      4609.3376    
      3400   330.67829     -35911.736     -10506.221      1.4343051      4609.3376    
      3500   299.80773     -35919.519      5022.4232      1.4343051      4609.3376    
      3600   298.54045     -35945.803      1973.4157      1.4343051      4609.3376    
      3700   303.62654     -35984.905      12779.293      1.4343051      4609.3376    
      3800   314.22399     -36031.064     -11429.77       1.4343051      4609.3376    
      3900   323.7061      -36088.264     -9139.9309      1.4343051      4609.3376    
      4000   328.18018     -36134.879     -6772.1681      1.4343051      4609.3376    
      4100   308.64546     -36146.086     -10018.519      1.4343051      4609.3376    
      4200   330.5653      -36204.236     -4206.8219      1.4343051      4609.3376    
      4300   264.20237     -36147.686     -6807.4359      1.4343051      4609.3376    
      4400   317.31326     -36199.316     -1893.8903      1.4343051      4609.3376    
      4500   318.42109     -36188.148      3954.4528      1.4343051      4609.3376    
      4600   280.00455     -36129.657      5852.4958      1.4343051      4609.3376    
      4700   323.58548     -36157.26      -1687.3137      1.4343051      4609.3376    
      4800   287.19092     -36134.862     -7311.0097      1.4343051      4609.3376    
      4900   321.42811     -36205.22      -5167.2558      1.4343051      4609.3376    
      5000   285.4514      -36176.256     -12606.895      1.4343051      4609.3376    
Loop time of 176.684 on 16 procs for 5000 steps with 365 atoms

Performance: 1.223 ns/day, 19.632 hours/ns, 28.299 timesteps/s, 10.329 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 96.869     | 119.7      | 144.23     | 201.4 | 67.75
Bond    | 0.0013713  | 0.001608   | 0.0018319  |   0.4 |  0.00
Neigh   | 8.8891     | 10.913     | 12.843     |  54.5 |  6.18
Comm    | 1.7398     | 26.281     | 49.108     | 430.0 | 14.87
Output  | 0.018097   | 0.020097   | 0.022055   |   1.0 |  0.01
Modify  | 17.747     | 19.676     | 21.706     |  40.5 | 11.14
Other   |            | 0.09739    |            |       |  0.06

Nlocal:         45.625 ave          51 max          38 min
Histogram: 2 0 0 0 0 1 1 1 2 1
Nghost:        2845.38 ave        2873 max        2820 min
Histogram: 2 1 0 1 0 1 0 1 0 2
Neighs:        24997.6 ave       27945 max       21032 min
Histogram: 2 0 0 0 0 1 1 1 2 1

Total # of neighbors = 199981
Ave neighs/atom = 547.89315
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333U-50C-26-vasp_eq.data
System init for write_data ...
undump dump_eq
unfix myMSD

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 17.6144
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 14.9838
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.4642

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.8795
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 2.088
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -6.9346

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 17.6144
variable dlen equal lx-${len0}
variable dlen equal lx-17.6144
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*17.6144
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 17.6144 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 17.6144 xy delta -6.9346 xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 17.6144 xy delta -6.9346 xz delta 2.088 remap v units box flip no
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos1.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom 100 dump/pos1_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos1 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.9 | 117.8 | 118.7 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   285.4514      -36176.256     -12607.04       4609.3376      17.6144        14.9838        17.4642      
       100   291.17183     -36190.895     -1340.3142      4701.5244      17.966688      14.9838        17.4642      
       200   392.62221     -36117.81      -8802.5088      4793.7111      18.318976      14.9838        17.4642      
       300   433.78752     -36043.293      259.41441      4885.8979      18.671264      14.9838        17.4642      
       400   462.69081     -36073.37       13103.201      4978.0846      19.023552      14.9838        17.4642      
       500   449.95025     -36080.332      2291.9739      5070.2714      19.37584       14.9838        17.4642      
       600   486.0937      -36079.199      2619.0938      5162.4581      19.728128      14.9838        17.4642      
       700   386.46458     -35984.133     -2844.3368      5254.6449      20.080416      14.9838        17.4642      
       800   403.91403     -35985.553      2268.4318      5346.8316      20.432704      14.9838        17.4642      
       900   421.06423     -35991.671     -5022.1478      5439.0184      20.784992      14.9838        17.4642      
      1000   379.51692     -35934.72      -4779.1093      5531.2051      21.13728       14.9838        17.4642      
      1100   386.36848     -36007.196      356.07678      5623.3919      21.489568      14.9838        17.4642      
      1200   367.11342     -36062.103     -3792.924       5715.5786      21.841856      14.9838        17.4642      
      1300   355.03246     -36041.678     -8841.6667      5807.7654      22.194144      14.9838        17.4642      
      1400   380.90899     -36086.298     -8824.0442      5899.9521      22.546432      14.9838        17.4642      
      1500   292.96376     -35987.237     -9001.2571      5992.1389      22.89872       14.9838        17.4642      
      1600   313.78962     -36031.39      -6294.7314      6084.3256      23.251008      14.9838        17.4642      
      1700   325.70994     -36123.374     -2689.6602      6176.5124      23.603296      14.9838        17.4642      
      1800   351.58646     -36128.319     -8702.073       6268.6991      23.955584      14.9838        17.4642      
      1900   334.18823     -36102.188     -6629.8187      6360.8859      24.307872      14.9838        17.4642      
      2000   324.72974     -36128.98      -16158.187      6453.0726      24.66016       14.9838        17.4642      
      2100   301.51564     -36095.152     -10956.266      6545.2594      25.012448      14.9838        17.4642      
      2200   304.917       -36086.725     -13136.158      6637.4461      25.364736      14.9838        17.4642      
      2300   332.83771     -36132.758     -7931.8694      6729.6329      25.717024      14.9838        17.4642      
      2400   391.18853     -36178.671     -8450.5977      6821.8196      26.069312      14.9838        17.4642      
      2500   312.28575     -36124.317     -3737.9997      6914.0064      26.4216        14.9838        17.4642      
      2600   298.11078     -36146.469     -10965.351      7006.1932      26.773888      14.9838        17.4642      
      2700   330.2538      -36153.087     -8717.9217      7098.3799      27.126176      14.9838        17.4642      
      2800   368.9583      -36154.625     -14971.792      7190.5667      27.478464      14.9838        17.4642      
      2900   314.48259     -36103.9       -16961.56       7282.7534      27.830752      14.9838        17.4642      
      3000   261.22573     -36042.665     -14924.448      7374.9402      28.18304       14.9838        17.4642      
      3100   321.94192     -36059.406     -14895.57       7467.1269      28.535328      14.9838        17.4642      
      3200   374.15665     -36088.603     -10919.2        7559.3137      28.887616      14.9838        17.4642      
      3300   387.26696     -36046.307     -9662.788       7651.5004      29.239904      14.9838        17.4642      
      3400   382.15542     -36084.847     -7184.021       7743.6872      29.592192      14.9838        17.4642      
      3500   362.24785     -36082.419     -6861.4234      7835.8739      29.94448       14.9838        17.4642      
      3600   338.32938     -36053.01      -3880.7266      7928.0607      30.296768      14.9838        17.4642      
      3700   373.19559     -36117.909     -8165.8405      8020.2474      30.649056      14.9838        17.4642      
      3800   318.13295     -36033.957     -9233.8452      8112.4342      31.001344      14.9838        17.4642      
      3900   327.52136     -36035.467     -7214.955       8204.6209      31.353632      14.9838        17.4642      
      4000   329.61169     -36037.829     -2816.0157      8296.8077      31.70592       14.9838        17.4642      
      4100   301.50412     -36008.443     -1264.9187      8388.9944      32.058208      14.9838        17.4642      
      4200   351.30259     -36110.681     -4758.8239      8481.1812      32.410496      14.9838        17.4642      
      4300   314.82183     -36066.586     -3420.8887      8573.3679      32.762784      14.9838        17.4642      
      4400   264.94759     -35993.286     -401.7383       8665.5547      33.115072      14.9838        17.4642      
      4500   299.05578     -36028.915     -1606.9515      8757.7414      33.46736       14.9838        17.4642      
      4600   305.71248     -36037.601     -1654.3505      8849.9282      33.819648      14.9838        17.4642      
      4700   267.95106     -36031.442     -3942.0797      8942.1149      34.171936      14.9838        17.4642      
      4800   284.58001     -36019.813      274.56199      9034.3017      34.524224      14.9838        17.4642      
      4900   309.12954     -36057.29      -2941.1455      9126.4884      34.876512      14.9838        17.4642      
      5000   345.35721     -36069.77      -5163.5052      9218.6752      35.2288        14.9838        17.4642      
Loop time of 136.121 on 16 procs for 5000 steps with 365 atoms

Performance: 1.587 ns/day, 15.125 hours/ns, 36.732 timesteps/s, 13.407 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 76.998     | 91.517     | 102.14     | 115.7 | 67.23
Bond    | 0.0011763  | 0.0015484  | 0.0018555  |   0.6 |  0.00
Neigh   | 6.1662     | 7.0308     | 8.5811     |  28.0 |  5.17
Comm    | 7.5597     | 18.14      | 32.666     | 260.1 | 13.33
Output  | 0.018484   | 0.020951   | 0.02238    |   0.8 |  0.02
Modify  | 17.716     | 19.32      | 20.163     |  17.2 | 14.19
Other   |            | 0.09001    |            |       |  0.07

Nlocal:         45.625 ave          81 max           8 min
Histogram: 3 0 0 1 0 0 0 0 0 4
Nghost:        2052.62 ave        2599 max        1520 min
Histogram: 4 0 0 0 0 0 0 0 0 4
Neighs:        14373.5 ave       26296 max        1885 min
Histogram: 3 1 0 0 0 0 0 0 0 4

Total # of neighbors = 114988
Ave neighs/atom = 315.03562
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 14.9838
variable dlen equal ly-${len0}
variable dlen equal ly-14.9838
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*14.9838
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 14.9838 yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 14.9838 yz delta 0.8795 remap v units box flip no
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos2.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom 100 dump/pos2_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos2 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.9 | 117.8 | 118.7 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   285.4514      -36176.256     -12607.04       4609.3376      17.6144        14.9838        17.4642      
       100   292.44382     -36191.875     -1150.6687      4701.5244      17.6144        15.283476      17.4642      
       200   406.74182     -36054.082     -10659.697      4793.7111      17.6144        15.583152      17.4642      
       300   429.8698      -35983.059     -8743.5592      4885.8979      17.6144        15.882828      17.4642      
       400   471.93818     -36000.609     -14248.444      4978.0846      17.6144        16.182504      17.4642      
       500   503.23776     -36065.582     -1924.2476      5070.2714      17.6144        16.48218       17.4642      
       600   447.8639      -36078.663     -9124.3469      5162.4581      17.6144        16.781856      17.4642      
       700   389.22813     -36052.052     -19505.408      5254.6449      17.6144        17.081532      17.4642      
       800   395.06932     -36034.425     -13116.965      5346.8316      17.6144        17.381208      17.4642      
       900   406.78839     -36047.996     -23959.092      5439.0184      17.6144        17.680884      17.4642      
      1000   414.35734     -36007.639     -11753.186      5531.2051      17.6144        17.98056       17.4642      
      1100   437.44366     -36045.45      -14803.778      5623.3919      17.6144        18.280236      17.4642      
      1200   409.92121     -36018.371     -10936.495      5715.5786      17.6144        18.579912      17.4642      
      1300   387.9585      -36061.596     -10564.724      5807.7654      17.6144        18.879588      17.4642      
      1400   352.72213     -36106.95      -20917.15       5899.9521      17.6144        19.179264      17.4642      
      1500   365.53855     -36111.948     -15250.645      5992.1389      17.6144        19.47894       17.4642      
      1600   310.17123     -36066.178     -17261.709      6084.3256      17.6144        19.778616      17.4642      
      1700   350.09348     -36112.466     -11202.89       6176.5124      17.6144        20.078292      17.4642      
      1800   342.02904     -36153.871     -9576.4423      6268.6991      17.6144        20.377968      17.4642      
      1900   297.52767     -36120.37      -17719.758      6360.8859      17.6144        20.677644      17.4642      
      2000   323.32026     -36128.495     -23680.514      6453.0726      17.6144        20.97732       17.4642      
      2100   285.91649     -36067.027     -16632.068      6545.2594      17.6144        21.276996      17.4642      
      2200   267.56458     -36010.957     -20866.538      6637.4461      17.6144        21.576672      17.4642      
      2300   285.02025     -35991.686     -21709.409      6729.6329      17.6144        21.876348      17.4642      
      2400   371.74996     -36083.038     -12190.172      6821.8196      17.6144        22.176024      17.4642      
      2500   308.85113     -36021.902     -10000.46       6914.0064      17.6144        22.4757        17.4642      
      2600   322.49148     -36048.052     -4123.6567      7006.1932      17.6144        22.775376      17.4642      
      2700   339.19179     -36090.107     -13772.12       7098.3799      17.6144        23.075052      17.4642      
      2800   317.13065     -36077.645     -10229.06       7190.5667      17.6144        23.374728      17.4642      
      2900   277.77814     -36017.94      -13578.823      7282.7534      17.6144        23.674404      17.4642      
      3000   276.16389     -36017.778     -6644.3595      7374.9402      17.6144        23.97408       17.4642      
      3100   341.69229     -36062.812     -9879.2827      7467.1269      17.6144        24.273756      17.4642      
      3200   329.8275      -36082.436     -5655.5563      7559.3137      17.6144        24.573432      17.4642      
      3300   315.84545     -36041.247     -12946.714      7651.5004      17.6144        24.873108      17.4642      
      3400   285.72608     -35997.264     -9117.3188      7743.6872      17.6144        25.172784      17.4642      
      3500   285.68993     -35986.56      -17549.327      7835.8739      17.6144        25.47246       17.4642      
      3600   296.09598     -35965.383     -17095.158      7928.0607      17.6144        25.772136      17.4642      
      3700   323.77618     -35955.34      -17203.002      8020.2474      17.6144        26.071812      17.4642      
      3800   357.06682     -35954.241     -12651.351      8112.4342      17.6144        26.371488      17.4642      
      3900   330.67829     -35919.313     -16353.771      8204.6209      17.6144        26.671164      17.4642      
      4000   351.80009     -35915.831     -1140.2938      8296.8077      17.6144        26.97084       17.4642      
      4100   314.97268     -35861.474     -7653.5317      8388.9944      17.6144        27.270516      17.4642      
      4200   303.92358     -35827.689     -17068.887      8481.1812      17.6144        27.570192      17.4642      
      4300   281.32758     -35762.667     -16245.203      8573.3679      17.6144        27.869868      17.4642      
      4400   341.08237     -35838.617     -18823.674      8665.5547      17.6144        28.169544      17.4642      
      4500   337.18593     -35821.708     -17497.849      8757.7414      17.6144        28.46922       17.4642      
      4600   311.07965     -35771.546     -20199.254      8849.9282      17.6144        28.768896      17.4642      
      4700   321.15758     -35754.635     -17280.482      8942.1149      17.6144        29.068572      17.4642      
      4800   333.57473     -35777.479     -12842.64       9034.3017      17.6144        29.368248      17.4642      
      4900   316.36801     -35760.46      -15895.464      9126.4884      17.6144        29.667924      17.4642      
      5000   293.28865     -35675.748     -16242.181      9218.6752      17.6144        29.9676        17.4642      
Loop time of 122.51 on 16 procs for 5000 steps with 365 atoms

Performance: 1.763 ns/day, 13.612 hours/ns, 40.813 timesteps/s, 14.897 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 60.64      | 82.686     | 96.459     | 168.2 | 67.49
Bond    | 0.0011456  | 0.0015484  | 0.001921   |   0.5 |  0.00
Neigh   | 4.9234     | 6.2089     | 7.2009     |  36.8 |  5.07
Comm    | 2.8435     | 16.615     | 38.701     | 375.3 | 13.56
Output  | 0.017761   | 0.020184   | 0.021633   |   0.9 |  0.02
Modify  | 15.858     | 16.89      | 18.148     |  22.5 | 13.79
Other   |            | 0.08793    |            |       |  0.07

Nlocal:         45.625 ave          79 max           6 min
Histogram: 1 1 0 1 0 1 1 0 2 1
Nghost:           1665 ave        1882 max        1458 min
Histogram: 2 0 0 1 1 2 0 0 0 2
Neighs:        12282.2 ave       21816 max        1563 min
Histogram: 1 1 0 1 0 2 1 0 0 2

Total # of neighbors = 98258
Ave neighs/atom = 269.2
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.4642
variable dlen equal lz-${len0}
variable dlen equal lz-17.4642
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*17.4642
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 17.4642 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos3.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom 100 dump/pos3_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos3 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.9 | 117.8 | 118.7 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   285.4514      -36176.256     -12607.04       4609.3376      17.6144        14.9838        17.4642      
       100   292.54781     -36195.474     -1216.9401      4701.5244      17.6144        14.9838        17.813484    
       200   380.67746     -36086.49      -2346.5139      4793.7111      17.6144        14.9838        18.162768    
       300   435.70757     -36081.216     -1319.0479      4885.8979      17.6144        14.9838        18.512052    
       400   485.224       -36109.695      27722.707      4978.0846      17.6144        14.9838        18.861336    
       500   431.6401      -36059.621      10091.752      5070.2714      17.6144        14.9838        19.21062     
       600   413.53467     -36020.528     -2046.2704      5162.4581      17.6144        14.9838        19.559904    
       700   385.93602     -35962.449     -13582.845      5254.6449      17.6144        14.9838        19.909188    
       800   384.4581      -35923.17      -16739.95       5346.8316      17.6144        14.9838        20.258472    
       900   390.40875     -35907.365     -12938.043      5439.0184      17.6144        14.9838        20.607756    
      1000   392.72711     -35888.419     -4014.2449      5531.2051      17.6144        14.9838        20.95704     
      1100   381.60176     -35875.306     -22301.293      5623.3919      17.6144        14.9838        21.306324    
      1200   346.25412     -35860.983     -20410.413      5715.5786      17.6144        14.9838        21.655608    
      1300   367.985       -35874.35      -3074.2347      5807.7654      17.6144        14.9838        22.004892    
      1400   352.90422     -35910.712     -17265.08       5899.9521      17.6144        14.9838        22.354176    
      1500   337.04301     -35842.834     -22222.603      5992.1389      17.6144        14.9838        22.70346     
      1600   332.6121      -35804.425     -18477.672      6084.3256      17.6144        14.9838        23.052744    
      1700   357.12804     -35734.548     -18727.23       6176.5124      17.6144        14.9838        23.402028    
      1800   438.60467     -35778.565     -18054.456      6268.6991      17.6144        14.9838        23.751312    
      1900   395.33498     -35714.006     -17377.924      6360.8859      17.6144        14.9838        24.100596    
      2000   467.04416     -35830.96      -19135.608      6453.0726      17.6144        14.9838        24.44988     
      2100   418.6443      -35861.313     -7824.2912      6545.2594      17.6144        14.9838        24.799164    
      2200   379.39516     -35928.095     -10830.765      6637.4461      17.6144        14.9838        25.148448    
      2300   343.52352     -36007.759     -9003.8611      6729.6329      17.6144        14.9838        25.497732    
      2400   380.82601     -35979.178     -10439.609      6821.8196      17.6144        14.9838        25.847016    
      2500   395.18777     -35929.15      -8996.0776      6914.0064      17.6144        14.9838        26.1963      
      2600   378.42518     -35945.615     -18111.827      7006.1932      17.6144        14.9838        26.545584    
      2700   341.16607     -35831.993     -14448.634      7098.3799      17.6144        14.9838        26.894868    
      2800   406.45968     -35899.126     -16528.46       7190.5667      17.6144        14.9838        27.244152    
      2900   379.32425     -35905.676     -8854.2324      7282.7534      17.6144        14.9838        27.593436    
      3000   377.20849     -35896.694     -19714.579      7374.9402      17.6144        14.9838        27.94272     
      3100   435.52183     -35955.305     -12732.348      7467.1269      17.6144        14.9838        28.292004    
      3200   392.96744     -35942.941     -10643.553      7559.3137      17.6144        14.9838        28.641288    
      3300   413.92635     -36017.813     -14859.739      7651.5004      17.6144        14.9838        28.990572    
      3400   337.40762     -35961.634     -11668.526      7743.6872      17.6144        14.9838        29.339856    
      3500   380.58156     -36022.527     -16028.034      7835.8739      17.6144        14.9838        29.68914     
      3600   421.59802     -36052.579     -14064.922      7928.0607      17.6144        14.9838        30.038424    
      3700   360.83092     -36072.859     -13158.499      8020.2474      17.6144        14.9838        30.387708    
      3800   347.6904      -36118.651     -8933.7179      8112.4342      17.6144        14.9838        30.736992    
      3900   351.18121     -36130.905     -10776.051      8204.6209      17.6144        14.9838        31.086276    
      4000   316.16211     -36065.102     -14401.282      8296.8077      17.6144        14.9838        31.43556     
      4100   349.34579     -36093.181     -10529.598      8388.9944      17.6144        14.9838        31.784844    
      4200   337.14086     -36085.588     -7840.4021      8481.1812      17.6144        14.9838        32.134128    
      4300   340.78169     -36096.851     -11880.807      8573.3679      17.6144        14.9838        32.483412    
      4400   347.45636     -36112.973     -14977.749      8665.5547      17.6144        14.9838        32.832696    
      4500   318.87786     -36047.379     -11671.601      8757.7414      17.6144        14.9838        33.18198     
      4600   324.75612     -36018.998     -12677.021      8849.9282      17.6144        14.9838        33.531264    
      4700   351.18251     -35996.512     -15038.603      8942.1149      17.6144        14.9838        33.880548    
      4800   332.57979     -35960.085     -13835.629      9034.3017      17.6144        14.9838        34.229832    
      4900   306.60402     -35912.825     -12687.287      9126.4884      17.6144        14.9838        34.579116    
      5000   337.8795      -35942.609     -19310.31       9218.6752      17.6144        14.9838        34.9284      
Loop time of 123.794 on 16 procs for 5000 steps with 365 atoms

Performance: 1.745 ns/day, 13.755 hours/ns, 40.390 timesteps/s, 14.742 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 63.046     | 83.945     | 98.754     | 165.1 | 67.81
Bond    | 0.0012745  | 0.0015569  | 0.0019149  |   0.5 |  0.00
Neigh   | 4.9335     | 6.3639     | 7.4499     |  43.4 |  5.14
Comm    | 1.9692     | 16.796     | 37.682     | 369.2 | 13.57
Output  | 0.017359   | 0.019935   | 0.021527   |   0.9 |  0.02
Modify  | 15.46      | 16.582     | 18.006     |  27.1 | 13.39
Other   |            | 0.08556    |            |       |  0.07

Nlocal:         45.625 ave          64 max          23 min
Histogram: 1 1 1 0 0 0 1 2 1 1
Nghost:        1718.38 ave        1804 max        1616 min
Histogram: 2 0 0 2 0 0 0 0 3 1
Neighs:        12452.8 ave       17695 max        6335 min
Histogram: 1 2 0 0 0 1 0 1 2 1

Total # of neighbors = 99622
Ave neighs/atom = 272.93699
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 17.6144
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.8795)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*17.6144
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_p all deform 100 yz delta ${delta} remap v units box flip no
fix deform_p all deform 100 yz delta 17.6144 remap v units box flip no
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos4.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom 100 dump/pos4_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos4 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.9 | 117.8 | 118.7 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   285.4514      -36176.256     -12607.04       4609.3376      17.6144        14.9838        17.4642      
       100   292.45376     -36190.918     -1685.3717      4609.3376      17.6144        14.9838        17.4642      
       200   391.6444      -36138.457     -1254.1485      4609.3376      17.6144        14.9838        17.4642      
       300   470.71909     -36177.668     -13044.098      4609.3376      17.6144        14.9838        17.4642      
       400   416.38898     -36141.011     -4507.7106      4609.3376      17.6144        14.9838        17.4642      
       500   387.874       -36084.34       11373.205      4609.3376      17.6144        14.9838        17.4642      
       600   434.22719     -36187.026      4619.2095      4609.3376      17.6144        14.9838        17.4642      
       700   406.73718     -36281.07       32.029131      4609.3376      17.6144        14.9838        17.4642      
       800   460.75083     -36360.374      3644.2371      4609.3376      17.6144        14.9838        17.4642      
       900   429.05546     -36363.846      10646.202      4609.3376      17.6144        14.9838        17.4642      
      1000   347.61706     -36298.295      3040.4351      4609.3376      17.6144        14.9838        17.4642      
      1100   426.20298     -36465.072      8492.6139      4609.3376      17.6144        14.9838        17.4642      
      1200   391.17037     -36428.184      12327.476      4609.3376      17.6144        14.9838        17.4642      
      1300   364.81427     -36447.014     -9004.6474      4609.3376      17.6144        14.9838        17.4642      
      1400   324.79133     -36452.855     -2291.0154      4609.3376      17.6144        14.9838        17.4642      
      1500   338.07086     -36393.335      4572.2352      4609.3376      17.6144        14.9838        17.4642      
      1600   360.17852     -36408.181      1386.6905      4609.3376      17.6144        14.9838        17.4642      
      1700   350.72204     -36409.108      4533.0328      4609.3376      17.6144        14.9838        17.4642      
      1800   403.52984     -36524.606      13910.612      4609.3376      17.6144        14.9838        17.4642      
      1900   350.5724      -36520.468     -4128.8895      4609.3376      17.6144        14.9838        17.4642      
      2000   337.3867      -36357.902      9091.2342      4609.3376      17.6144        14.9838        17.4642      
      2100   284.49095     -36391.702     -6616.0403      4609.3376      17.6144        14.9838        17.4642      
      2200   330.5713      -36470.804     -396.079        4609.3376      17.6144        14.9838        17.4642      
      2300   326.79625     -36472.105     -6933.2018      4609.3376      17.6144        14.9838        17.4642      
      2400   368.91097     -36526.501     -5717.7404      4609.3376      17.6144        14.9838        17.4642      
      2500   300.05942     -36501.001     -1288.9707      4609.3376      17.6144        14.9838        17.4642      
      2600   349.2146      -36416.396     -9022.5058      4609.3376      17.6144        14.9838        17.4642      
      2700   341.38507     -36412.827     -5178.4646      4609.3376      17.6144        14.9838        17.4642      
      2800   338.9533      -36426.857     -1721.6628      4609.3376      17.6144        14.9838        17.4642      
      2900   329.84736     -36395.759     -4174.4678      4609.3376      17.6144        14.9838        17.4642      
      3000   323.65253     -36460.529     -6800.2888      4609.3376      17.6144        14.9838        17.4642      
      3100   370.7729      -36484.399     -6771.7833      4609.3376      17.6144        14.9838        17.4642      
      3200   352.35405     -36543.896     -20214.263      4609.3376      17.6144        14.9838        17.4642      
      3300   371.13193     -36546.716     -6710.033       4609.3376      17.6144        14.9838        17.4642      
      3400   314.57188     -36507.999     -15073.306      4609.3376      17.6144        14.9838        17.4642      
      3500   305.89744     -36511.045     -18947.652      4609.3376      17.6144        14.9838        17.4642      
      3600   387.23767     -36579.679     -8951.4213      4609.3376      17.6144        14.9838        17.4642      
      3700   278.83939     -36503.214     -21526.044      4609.3376      17.6144        14.9838        17.4642      
      3800   338.08792     -36567.973     -13936.805      4609.3376      17.6144        14.9838        17.4642      
      3900   325.55698     -36568.247     -14533.233      4609.3376      17.6144        14.9838        17.4642      
      4000   342.70101     -36613.91      -17408.874      4609.3376      17.6144        14.9838        17.4642      
      4100   333.62366     -36583.107     -22375.308      4609.3376      17.6144        14.9838        17.4642      
      4200   363.11589     -36569.395     -23371.249      4609.3376      17.6144        14.9838        17.4642      
      4300   286.65005     -36561.079     -25555.318      4609.3376      17.6144        14.9838        17.4642      
      4400   316.1725      -36546.62      -16255.179      4609.3376      17.6144        14.9838        17.4642      
      4500   321.12901     -36571.74      -27595.891      4609.3376      17.6144        14.9838        17.4642      
      4600   314.76944     -36612.776     -10869.691      4609.3376      17.6144        14.9838        17.4642      
      4700   326.86358     -36590.58      -17170.064      4609.3376      17.6144        14.9838        17.4642      
      4800   380.9629      -36603.075     -20659.468      4609.3376      17.6144        14.9838        17.4642      
      4900   319.13979     -36490.508     -23063.835      4609.3376      17.6144        14.9838        17.4642      
      5000   408.73812     -36544.08      -10108.488      4609.3376      17.6144        14.9838        17.4642      
Loop time of 211.117 on 16 procs for 5000 steps with 365 atoms

Performance: 1.023 ns/day, 23.457 hours/ns, 23.684 timesteps/s, 8.644 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 115.88     | 149.95     | 173.63     | 211.7 | 71.02
Bond    | 0.0012481  | 0.0016286  | 0.0018901  |   0.5 |  0.00
Neigh   | 9.9631     | 12.899     | 15.029     |  60.0 |  6.11
Comm    | 2.8043     | 26.482     | 60.607     | 503.6 | 12.54
Output  | 0.016701   | 0.019021   | 0.020572   |   0.9 |  0.01
Modify  | 19.461     | 21.651     | 24.624     |  46.7 | 10.26
Other   |            | 0.1184     |            |       |  0.06

Nlocal:         45.625 ave          54 max          32 min
Histogram: 1 0 0 1 0 2 0 1 1 2
Nghost:        4163.75 ave        4272 max        4036 min
Histogram: 1 2 1 0 0 0 0 0 0 4
Neighs:        24968.2 ave       29114 max       18125 min
Histogram: 1 0 0 1 0 1 1 1 1 2

Total # of neighbors = 199746
Ave neighs/atom = 547.24932
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 14.9838
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-2.088)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*14.9838
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_p all deform 100 xz delta ${delta} remap v units box flip no
fix deform_p all deform 100 xz delta 14.9838 remap v units box flip no
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos5.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom 100 dump/pos5_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos5 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.9 | 117.8 | 118.7 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   285.4514      -36176.256     -12607.04       4609.3376      17.6144        14.9838        17.4642      
       100   295.63891     -36192.099     -1836.3124      4609.3376      17.6144        14.9838        17.4642      
       200   423.05014     -36136.69      -1617.6795      4609.3376      17.6144        14.9838        17.4642      
       300   414.54721     -36116.724     -6616.4272      4609.3376      17.6144        14.9838        17.4642      
       400   477.87287     -36186.408      7884.3485      4609.3376      17.6144        14.9838        17.4642      
       500   409.88278     -36204.553     -1427.6571      4609.3376      17.6144        14.9838        17.4642      
       600   378.97881     -36217.864     -11099.342      4609.3376      17.6144        14.9838        17.4642      
       700   330.21341     -36261.759     -6454.5755      4609.3376      17.6144        14.9838        17.4642      
       800   338.87552     -36282.099     -17725.737      4609.3376      17.6144        14.9838        17.4642      
       900   341.26858     -36316.117      356.54088      4609.3376      17.6144        14.9838        17.4642      
      1000   387.54274     -36338.758     -7247.7118      4609.3376      17.6144        14.9838        17.4642      
      1100   343.68085     -36355.817     -14166.872      4609.3376      17.6144        14.9838        17.4642      
      1200   326.67402     -36393.234     -12297.418      4609.3376      17.6144        14.9838        17.4642      
      1300   347.28686     -36417.84      -5154.3844      4609.3376      17.6144        14.9838        17.4642      
      1400   346.47733     -36462.403      2707.3036      4609.3376      17.6144        14.9838        17.4642      
      1500   354.73939     -36425.75      -8384.1414      4609.3376      17.6144        14.9838        17.4642      
      1600   366.77544     -36450.684     -344.17856      4609.3376      17.6144        14.9838        17.4642      
      1700   358.00349     -36404.365     -713.49562      4609.3376      17.6144        14.9838        17.4642      
      1800   363.25188     -36370.424     -7766.9102      4609.3376      17.6144        14.9838        17.4642      
      1900   371.12826     -36344.443     -10844.54       4609.3376      17.6144        14.9838        17.4642      
      2000   366.78896     -36321.877     -15199.757      4609.3376      17.6144        14.9838        17.4642      
      2100   429.54096     -36360.256     -2667.4641      4609.3376      17.6144        14.9838        17.4642      
      2200   417.33667     -36373.708     -10666.032      4609.3376      17.6144        14.9838        17.4642      
      2300   358.26724     -36309.814     -25138.881      4609.3376      17.6144        14.9838        17.4642      
      2400   367.01086     -36233.224     -12162.462      4609.3376      17.6144        14.9838        17.4642      
      2500   383.87035     -36211.259     -16026.304      4609.3376      17.6144        14.9838        17.4642      
      2600   364.59875     -36237.011     -18433.053      4609.3376      17.6144        14.9838        17.4642      
      2700   363.31254     -36273.38      -3496.3189      4609.3376      17.6144        14.9838        17.4642      
      2800   323.15189     -36238.874     -6565.322       4609.3376      17.6144        14.9838        17.4642      
      2900   331.77847     -36257.474     -21685.038      4609.3376      17.6144        14.9838        17.4642      
      3000   296.51431     -36250.937     -21071.972      4609.3376      17.6144        14.9838        17.4642      
      3100   318.8291      -36273.651     -18271.724      4609.3376      17.6144        14.9838        17.4642      
      3200   344.84072     -36279.058     -11607.553      4609.3376      17.6144        14.9838        17.4642      
      3300   392.19554     -36398.606     -2736.0345      4609.3376      17.6144        14.9838        17.4642      
      3400   380.3491      -36402.101     -7268.0179      4609.3376      17.6144        14.9838        17.4642      
      3500   354.0868      -36423.597     -20341.695      4609.3376      17.6144        14.9838        17.4642      
      3600   340.71746     -36367.256     -18048.19       4609.3376      17.6144        14.9838        17.4642      
      3700   333.51292     -36423.436     -13231.454      4609.3376      17.6144        14.9838        17.4642      
      3800   333.48797     -36339.514     -22061.569      4609.3376      17.6144        14.9838        17.4642      
      3900   361.93221     -36326.633     -10411.32       4609.3376      17.6144        14.9838        17.4642      
      4000   391.34942     -36353.167     -7965.6956      4609.3376      17.6144        14.9838        17.4642      
      4100   324.62636     -36297.453     -896.18764      4609.3376      17.6144        14.9838        17.4642      
      4200   339.65934     -36370.357     -23057.74       4609.3376      17.6144        14.9838        17.4642      
      4300   319.66929     -36359.093     -14234.346      4609.3376      17.6144        14.9838        17.4642      
      4400   299.68027     -36362.181     -9638.2428      4609.3376      17.6144        14.9838        17.4642      
      4500   326.72823     -36373.774     -6044.3208      4609.3376      17.6144        14.9838        17.4642      
      4600   308.32539     -36292.227     -26861.75       4609.3376      17.6144        14.9838        17.4642      
      4700   339.44069     -36348.623     -30243.263      4609.3376      17.6144        14.9838        17.4642      
      4800   319.7014      -36306.834     -13034.791      4609.3376      17.6144        14.9838        17.4642      
      4900   380.48731     -36364.361     -2846.7704      4609.3376      17.6144        14.9838        17.4642      
      5000   355.40813     -36331.619     -9862.4142      4609.3376      17.6144        14.9838        17.4642      
Loop time of 200.949 on 16 procs for 5000 steps with 365 atoms

Performance: 1.075 ns/day, 22.328 hours/ns, 24.882 timesteps/s, 9.082 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 110.37     | 143.51     | 163.73     | 178.8 | 71.42
Bond    | 0.0014586  | 0.0017238  | 0.0020536  |   0.4 |  0.00
Neigh   | 9.7286     | 12.741     | 14.611     |  52.9 |  6.34
Comm    | 3.507      | 23.712     | 56.838     | 439.8 | 11.80
Output  | 0.016152   | 0.018356   | 0.019681   |   0.8 |  0.01
Modify  | 18.926     | 20.847     | 23.897     |  41.6 | 10.37
Other   |            | 0.1141     |            |       |  0.06

Nlocal:         45.625 ave          54 max          34 min
Histogram: 1 0 0 0 2 1 0 2 1 1
Nghost:           3582 ave        3640 max        3518 min
Histogram: 1 1 1 0 1 0 1 1 0 2
Neighs:          25028 ave       29338 max       18919 min
Histogram: 1 0 0 0 2 1 0 3 0 1

Total # of neighbors = 200224
Ave neighs/atom = 548.5589
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.4642
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--6.9346)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*17.4642
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_p all deform 100 xy delta ${delta} remap v units box flip no
fix deform_p all deform 100 xy delta 17.4642 remap v units box flip no

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos6.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom 100 dump/pos6_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos6 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.9 | 117.8 | 118.7 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   285.4514      -36176.256     -12607.04       4609.3376      17.6144        14.9838        17.4642      
       100   293.67319     -36192.598     -1364.4524      4609.3376      17.6144        14.9838        17.4642      
       200   459.10496     -36049.845     -7148.3257      4609.3376      17.6144        14.9838        17.4642      
       300   452.24866     -35975.836     -10578.676      4609.3376      17.6144        14.9838        17.4642      
       400   430.0463      -35967.644     -19294.145      4609.3376      17.6144        14.9838        17.4642      
       500   440.2232      -36047.713     -12898.763      4609.3376      17.6144        14.9838        17.4642      
       600   380.69335     -36095.893     -4159.254       4609.3376      17.6144        14.9838        17.4642      
       700   412.10587     -36147.709     -8068.0218      4609.3376      17.6144        14.9838        17.4642      
       800   388.43478     -36106.419      1609.9173      4609.3376      17.6144        14.9838        17.4642      
       900   443.50405     -36122.686     -13465.248      4609.3376      17.6144        14.9838        17.4642      
      1000   425.09946     -36113.1        1316.1615      4609.3376      17.6144        14.9838        17.4642      
      1100   438.21633     -36269.978     -9174.4837      4609.3376      17.6144        14.9838        17.4642      
      1200   356.9167      -36227.998     -12004.917      4609.3376      17.6144        14.9838        17.4642      
      1300   335.1255      -36264.259     -9932.5449      4609.3376      17.6144        14.9838        17.4642      
      1400   319.54863     -36233.817     -8109.1898      4609.3376      17.6144        14.9838        17.4642      
      1500   334.01002     -36262.246     -13778.888      4609.3376      17.6144        14.9838        17.4642      
      1600   382.6121      -36106.779     -8625.8272      4609.3376      17.6144        14.9838        17.4642      
      1700   405.21432     -36191.13       3900.913       4609.3376      17.6144        14.9838        17.4642      
      1800   420.68962     -36177.196     -7468.6816      4609.3376      17.6144        14.9838        17.4642      
      1900   394.62597     -36193.752     -4670.5336      4609.3376      17.6144        14.9838        17.4642      
      2000   310.88648     -36119.188     -11178.09       4609.3376      17.6144        14.9838        17.4642      
      2100   321.14809     -36150.8       -7883.6483      4609.3376      17.6144        14.9838        17.4642      
      2200   331.07384     -36215.936     -8680.2663      4609.3376      17.6144        14.9838        17.4642      
      2300   303.36585     -36184.62      -3541.9752      4609.3376      17.6144        14.9838        17.4642      
      2400   301.46012     -36098.113     -11181.362      4609.3376      17.6144        14.9838        17.4642      
      2500   324.45565     -36166.649     -9499.1355      4609.3376      17.6144        14.9838        17.4642      
      2600   339.80605     -36172.255     -17964.924      4609.3376      17.6144        14.9838        17.4642      
      2700   344.03603     -36191.177     -13834.729      4609.3376      17.6144        14.9838        17.4642      
      2800   284.56324     -36109.506     -17164.132      4609.3376      17.6144        14.9838        17.4642      
      2900   335.75441     -36173.405     -10725.602      4609.3376      17.6144        14.9838        17.4642      
      3000   359.7326      -36242.732     -5349.584       4609.3376      17.6144        14.9838        17.4642      
      3100   372.51598     -36221.155      3145.8303      4609.3376      17.6144        14.9838        17.4642      
      3200   345.6043      -36235.601     -5743.5212      4609.3376      17.6144        14.9838        17.4642      
      3300   352.27608     -36242.522     -2670.8245      4609.3376      17.6144        14.9838        17.4642      
      3400   334.10569     -36241.959     -6674.3695      4609.3376      17.6144        14.9838        17.4642      
      3500   309.95106     -36268.348     -908.81064      4609.3376      17.6144        14.9838        17.4642      
      3600   360.98787     -36283.405      1288.9313      4609.3376      17.6144        14.9838        17.4642      
      3700   348.07526     -36258.361      2325.8755      4609.3376      17.6144        14.9838        17.4642      
      3800   338.45005     -36277.607     -4147.7145      4609.3376      17.6144        14.9838        17.4642      
      3900   342.69529     -36349.253     -8023.8237      4609.3376      17.6144        14.9838        17.4642      
      4000   333.82433     -36310.27      -6000.8997      4609.3376      17.6144        14.9838        17.4642      
      4100   344.41893     -36333.516     -11152.861      4609.3376      17.6144        14.9838        17.4642      
      4200   308.00887     -36345.895     -13354.667      4609.3376      17.6144        14.9838        17.4642      
      4300   307.34253     -36340.189     -13964.626      4609.3376      17.6144        14.9838        17.4642      
      4400   368.19883     -36367.007     -2399.9374      4609.3376      17.6144        14.9838        17.4642      
      4500   346.86372     -36316.989     -2300.0215      4609.3376      17.6144        14.9838        17.4642      
      4600   349.54173     -36350.447     -2992.9562      4609.3376      17.6144        14.9838        17.4642      
      4700   353.27508     -36348.694     -13141.356      4609.3376      17.6144        14.9838        17.4642      
      4800   337.56038     -36341.351     -13445.485      4609.3376      17.6144        14.9838        17.4642      
      4900   327.8516      -36332.41      -466.6605       4609.3376      17.6144        14.9838        17.4642      
      5000   374.7184      -36364.035     -1404.0416      4609.3376      17.6144        14.9838        17.4642      
Loop time of 177.712 on 16 procs for 5000 steps with 365 atoms

Performance: 1.215 ns/day, 19.746 hours/ns, 28.135 timesteps/s, 10.269 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 96.274     | 129.4      | 140.92     | 162.3 | 72.82
Bond    | 0.0015015  | 0.0017545  | 0.0019723  |   0.4 |  0.00
Neigh   | 8.9762     | 11.73      | 13.488     |  47.9 |  6.60
Comm    | 4.4148     | 15.906     | 49.059     | 462.9 |  8.95
Output  | 0.016431   | 0.018666   | 0.019992   |   0.8 |  0.01
Modify  | 18.749     | 20.547     | 23.328     |  36.4 | 11.56
Other   |            | 0.1066     |            |       |  0.06

Nlocal:         45.625 ave          53 max          38 min
Histogram: 1 0 1 1 1 2 0 0 0 2
Nghost:           3015 ave        3043 max        2982 min
Histogram: 2 0 0 0 1 1 2 0 0 2
Neighs:        25075.8 ave       29180 max       21033 min
Histogram: 1 0 1 2 0 2 0 0 0 2

Total # of neighbors = 200606
Ave neighs/atom = 549.60548
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:19:15
