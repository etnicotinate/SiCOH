LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 100
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 50
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 1.0                  # the deformation magnitude 0.01

variable FF string "SiOCHN_2018.ff C H O Si"   # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si
variable structure string 333-HD-100C-14-VASP

# Read the initial sctructure
# box tilt large
read_data       ${structure}.data
read_data       333-HD-100C-14-VASP.data
Reading data file ...
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.028 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
fix bondinfo all reaxff/bonds 1 bonds_opt.reaxff

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
dump dump_opt all custom 1 dump/dump_opt.lammpstrj id type q x y z
minimize 1.0e-6 1.0e-6 100 1000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -29.52 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 139 | 141.2 | 144.1 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0             -40261.317      0             -40261.317     -891.25124    
        55   0             -41382.513      0             -41382.513     -14873.577    
Loop time of 10.6227 on 16 procs for 55 steps with 366 atoms

97.4% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
     -40261.3171075932  -41382.5049795122  -41382.5134018035
  Force two-norm initial, final = 1496.0927 99.630518
  Force max component initial, final = 339.92512 46.341031
  Final line search alpha, max atom move = 0.0019208878 0.089015921
  Iterations, force evaluations = 55 200

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 7.4842     | 8.0939     | 8.5448     |  14.0 | 76.19
Bond    | 0.00011101 | 0.00012805 | 0.0001511  |   0.0 |  0.00
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.20253    | 0.65388    | 1.264      |  49.2 |  6.16
Output  | 0.011626   | 0.017165   | 0.020852   |   2.5 |  0.16
Modify  | 1.8412     | 1.8416     | 1.8419     |   0.0 | 17.34
Other   |            | 0.01601    |            |       |  0.15

Nlocal:          45.75 ave          50 max          38 min
Histogram: 1 0 0 0 0 2 1 1 1 2
Nghost:        3435.12 ave        3497 max        3372 min
Histogram: 2 0 0 0 2 2 0 0 0 2
Neighs:        31070.1 ave       33753 max       26028 min
Histogram: 1 0 0 0 1 1 1 1 1 2

Total # of neighbors = 248561
Ave neighs/atom = 679.12842
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-HD-100C-14-VASP_opt.data
System init for write_data ...
undump dump_opt
unfix bondinfo
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
dump dump_eq all custom ${nthermo} dump/dump_eq.lammpstrj id type q x y z
dump dump_eq all custom 100 dump/dump_eq.lammpstrj id type q x y z

# compute MSD
compute msd1 all msd
fix myMSD all ave/time ${nevery} ${nrepeat} ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 ${nrepeat} ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 10 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 10 100 c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out

run ${nequil}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.8 | 134.9 | 137.2 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -41382.514     -10916.633      1.8952586      3770.2978    
       100   199.77019     -41235.45      -1689.1931      1.8952586      3770.2978    
       200   224.45023     -41199.482     -4879.7134      1.8952586      3770.2978    
       300   267.1912      -41177.531      621.38665      1.8952586      3770.2978    
       400   295.21977     -41147.431     -6997.3016      1.8952586      3770.2978    
       500   309.44051     -41126.6       -8631.8248      1.8952586      3770.2978    
       600   312.93059     -41111.662     -10882.92       1.8952586      3770.2978    
       700   318.15065     -41120.457      6213.5625      1.8952586      3770.2978    
       800   296.27648     -41121.298     -1767.3852      1.8952586      3770.2978    
       900   302.42441     -41156.745      5801.9552      1.8952586      3770.2978    
      1000   275.20682     -41138.436      6900.0264      1.8952586      3770.2978    
      1100   271.36668     -41111.081     -2709.8943      1.8952586      3770.2978    
      1200   321.63808     -41133.562     -11822.237      1.8952586      3770.2978    
      1300   324.36411     -41151.994      2970.3247      1.8952586      3770.2978    
      1400   295.29743     -41142.352     -3596.5161      1.8952586      3770.2978    
      1500   276.43251     -41118.569     -9748.6815      1.8952586      3770.2978    
      1600   315.31697     -41140.809      5512.5201      1.8952586      3770.2978    
      1700   300.90833     -41114.316     -9580.3174      1.8952586      3770.2978    
      1800   315.26402     -41124.598     -5993.2652      1.8952586      3770.2978    
      1900   302.90299     -41140.53       4698.7399      1.8952586      3770.2978    
      2000   291.54153     -41148.491      5015.4775      1.8952586      3770.2978    
      2100   294.01598     -41146.745     -27.809539      1.8952586      3770.2978    
      2200   300.92317     -41122.127      3871.447       1.8952586      3770.2978    
      2300   328.71005     -41145.088     -8007.0277      1.8952586      3770.2978    
      2400   304.42467     -41135.156      4035.1326      1.8952586      3770.2978    
      2500   294.74846     -41133.72       3110.5537      1.8952586      3770.2978    
      2600   303.85753     -41138.172     -2087.7672      1.8952586      3770.2978    
      2700   332.24553     -41136.31      -7007.1735      1.8952586      3770.2978    
      2800   314.5113      -41114.397     -2059.1348      1.8952586      3770.2978    
      2900   297.89325     -41131.393     -8659.2378      1.8952586      3770.2978    
      3000   283.65703     -41127.886     -1413.9278      1.8952586      3770.2978    
      3100   310.49163     -41150.502     -3210.5579      1.8952586      3770.2978    
      3200   311.60685     -41145.204      7451.2445      1.8952586      3770.2978    
      3300   303.94388     -41125.39      -3784.111       1.8952586      3770.2978    
      3400   314.3307      -41122.423      11717.877      1.8952586      3770.2978    
      3500   300.44738     -41114.48      -2574.4908      1.8952586      3770.2978    
      3600   309.51906     -41146.354     -8514.3583      1.8952586      3770.2978    
      3700   276.3655      -41135.276     -12909.692      1.8952586      3770.2978    
      3800   288.06521     -41147.14      -4648.0358      1.8952586      3770.2978    
      3900   305.04489     -41141.744     -7720.6988      1.8952586      3770.2978    
      4000   311.8497      -41141.706     -5700.6962      1.8952586      3770.2978    
      4100   296.297       -41124.787     -1100.1487      1.8952586      3770.2978    
      4200   297.60958     -41119.724      3559.5864      1.8952586      3770.2978    
      4300   304.67249     -41115.361     -1617.6044      1.8952586      3770.2978    
      4400   318.48648     -41120.184      81.587472      1.8952586      3770.2978    
      4500   295.13047     -41120.524      6.4047417      1.8952586      3770.2978    
      4600   310.07563     -41157.679     -3294.7074      1.8952586      3770.2978    
      4700   297.41521     -41151.131      4558.7683      1.8952586      3770.2978    
      4800   278.5745      -41124.3        7076.7315      1.8952586      3770.2978    
      4900   300.60867     -41110.827      6957.7418      1.8952586      3770.2978    
      5000   310.90845     -41120.255     -15262.583      1.8952586      3770.2978    
Loop time of 260.778 on 16 procs for 5000 steps with 366 atoms

Performance: 0.828 ns/day, 28.975 hours/ns, 19.173 timesteps/s, 7.017 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 196.83     | 198.8      | 201.41     |  11.0 | 76.23
Bond    | 0.0015881  | 0.0018576  | 0.0022281  |   0.5 |  0.00
Neigh   | 17.595     | 17.891     | 18.283     |   5.9 |  6.86
Comm    | 18.539     | 20.905     | 23.098     |  34.7 |  8.02
Output  | 0.026408   | 0.031619   | 0.037329   |   1.8 |  0.01
Modify  | 21.525     | 22.079     | 22.557     |   7.5 |  8.47
Other   |            | 1.071      |            |       |  0.41

Nlocal:          45.75 ave          52 max          39 min
Histogram: 1 0 0 2 1 0 3 0 0 1
Nghost:         3436.5 ave        3500 max        3383 min
Histogram: 1 0 2 1 1 0 1 1 0 1
Neighs:        31083.6 ave       35153 max       26633 min
Histogram: 1 0 0 2 1 0 3 0 0 1

Total # of neighbors = 248669
Ave neighs/atom = 679.4235
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333-HD-100C-14-VASP_eq.data
System init for write_data ...
undump dump_eq
unfix myMSD

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.724
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.9031
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.2465

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.4371
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 0.1778
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -7.584

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 15.724
variable dlen equal lx-${len0}
variable dlen equal lx-15.724
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.005 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*15.724
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 15.724 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 15.724 xy delta -7.584 xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 15.724 xy delta -7.584 xz delta 0.1778 remap v units box flip no
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos1.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom 100 dump/pos1_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos1 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.8 | 139.5 | 141.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   310.90845     -41120.255     -15262.46       3770.2978      15.724         13.9031        17.2465      
       100   308.11895     -41137.958     -471.47817      3845.7038      16.03848       13.9031        17.2465      
       200   407.90202     -41020.527     -2502.2025      3921.1097      16.35296       13.9031        17.2465      
       300   423.58799     -40904.275     -15217.142      3996.5157      16.66744       13.9031        17.2465      
       400   423.98266     -40838.132     -15447.809      4071.9216      16.98192       13.9031        17.2465      
       500   465.43696     -40819.523     -38661.637      4147.3276      17.2964        13.9031        17.2465      
       600   498.96737     -40784.948     -37767.045      4222.7335      17.61088       13.9031        17.2465      
       700   427.18817     -40659.871     -43502.585      4298.1395      17.92536       13.9031        17.2465      
       800   404.04626     -40576.844     -52647.173      4373.5454      18.23984       13.9031        17.2465      
       900   387.15556     -40502.198     -50795.736      4448.9514      18.55432       13.9031        17.2465      
      1000   362.45495     -40397.2       -56375.124      4524.3574      18.8688        13.9031        17.2465      
      1100   414.56948     -40342.261     -58873.82       4599.7633      19.18328       13.9031        17.2465      
      1200   412.11075     -40261.026     -52236.638      4675.1693      19.49776       13.9031        17.2465      
      1300   422.66749     -40162.669     -59216.71       4750.5752      19.81224       13.9031        17.2465      
      1400   355.15351     -39933.375     -72537.318      4825.9812      20.12672       13.9031        17.2465      
      1500   348.4698      -39824.526     -69876.164      4901.3871      20.4412        13.9031        17.2465      
      1600   447.90607     -39752.773     -56316.459      4976.7931      20.75568       13.9031        17.2465      
      1700   454.76512     -39862.904     -46871.113      5052.199       21.07016       13.9031        17.2465      
      1800   405.39179     -39861.534     -47963.647      5127.605       21.38464       13.9031        17.2465      
      1900   330.7121      -39765.034     -51125.204      5203.011       21.69912       13.9031        17.2465      
      2000   354.72331     -39748.831     -54223.467      5278.4169      22.0136        13.9031        17.2465      
      2100   470.13531     -39879.52      -46001.014      5353.8229      22.32808       13.9031        17.2465      
      2200   404.49138     -39924.02      -47245.849      5429.2288      22.64256       13.9031        17.2465      
      2300   422.02441     -40040.487     -27550.703      5504.6348      22.95704       13.9031        17.2465      
      2400   380.5655      -40129.254     -13645.318      5580.0407      23.27152       13.9031        17.2465      
      2500   341.98582     -40103.035     -24060.126      5655.4467      23.586         13.9031        17.2465      
      2600   423.10339     -40203.655     -30610.333      5730.8527      23.90048       13.9031        17.2465      
      2700   277.08241     -40042.782     -24040.856      5806.2586      24.21496       13.9031        17.2465      
      2800   349.15209     -40178.774     -30465.822      5881.6646      24.52944       13.9031        17.2465      
      2900   313.79827     -40131.779     -34435.128      5957.0705      24.84392       13.9031        17.2465      
      3000   260.2076      -40051.877     -37373.869      6032.4765      25.1584        13.9031        17.2465      
      3100   270.43806     -40028.296     -30405.454      6107.8824      25.47288       13.9031        17.2465      
      3200   309.44485     -39995.979     -30615.106      6183.2884      25.78736       13.9031        17.2465      
      3300   339.5687      -40029.33      -37629.082      6258.6943      26.10184       13.9031        17.2465      
      3400   277.42239     -39922.801     -35097.149      6334.1003      26.41632       13.9031        17.2465      
      3500   327.80548     -39953.783     -36465.616      6409.5063      26.7308        13.9031        17.2465      
      3600   272.5346      -39910.486     -34875.905      6484.9122      27.04528       13.9031        17.2465      
      3700   304.87001     -39887.487     -38391.886      6560.3182      27.35976       13.9031        17.2465      
      3800   262.78629     -39807.656     -39968.257      6635.7241      27.67424       13.9031        17.2465      
      3900   281.08979     -39774.454     -36608.78       6711.1301      27.98872       13.9031        17.2465      
      4000   265.45282     -39694.791     -36828.532      6786.536       28.3032        13.9031        17.2465      
      4100   325.76823     -39706.182     -36445.017      6861.942       28.61768       13.9031        17.2465      
      4200   326.79816     -39641.751     -36607.533      6937.3479      28.93216       13.9031        17.2465      
      4300   313.12065     -39596.167     -40430.621      7012.7539      29.24664       13.9031        17.2465      
      4400   303.96033     -39546.316     -39890.208      7088.1599      29.56112       13.9031        17.2465      
      4500   282.94126     -39436.377     -39390.049      7163.5658      29.8756        13.9031        17.2465      
      4600   292.01398     -39357.486     -38383.372      7238.9718      30.19008       13.9031        17.2465      
      4700   432.56195     -39421.136     -25405.048      7314.3777      30.50456       13.9031        17.2465      
      4800   428.10122     -39565.447     -24910.266      7389.7837      30.81904       13.9031        17.2465      
      4900   354.29682     -39605.889     -23761.822      7465.1896      31.13352       13.9031        17.2465      
      5000   325.23582     -39654.903     -21228.248      7540.5956      31.448         13.9031        17.2465      
Loop time of 190.825 on 16 procs for 5000 steps with 366 atoms

Performance: 1.132 ns/day, 21.203 hours/ns, 26.202 timesteps/s, 9.590 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 138.79     | 141.09     | 142.39     |   9.8 | 73.94
Bond    | 0.0015404  | 0.0018234  | 0.0022342  |   0.6 |  0.00
Neigh   | 9.9767     | 10.2       | 10.435     |   5.3 |  5.35
Comm    | 16.872     | 18.235     | 20.479     |  28.3 |  9.56
Output  | 0.030541   | 0.038712   | 0.044983   |   2.2 |  0.02
Modify  | 19.633     | 20.083     | 20.485     |   6.3 | 10.52
Other   |            | 1.174      |            |       |  0.62

Nlocal:          45.75 ave          60 max          25 min
Histogram: 1 0 0 0 3 0 1 0 2 1
Nghost:        2458.12 ave        2647 max        2263 min
Histogram: 2 2 0 0 0 0 0 0 1 3
Neighs:        15934.5 ave       20917 max        8931 min
Histogram: 1 0 0 1 2 0 1 0 2 1

Total # of neighbors = 127476
Ave neighs/atom = 348.29508
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.9031
variable dlen equal ly-${len0}
variable dlen equal ly-13.9031
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*13.9031
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 13.9031 yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 13.9031 yz delta 0.4371 remap v units box flip no
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos2.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom 100 dump/pos2_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos2 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.8 | 139.5 | 141.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   310.90845     -41120.255     -15262.46       3770.2978      15.724         13.9031        17.2465      
       100   311.92305     -41137.399     -520.23739      3845.7038      15.724         14.181162      17.2465      
       200   373.69656     -41056.805      3356.8262      3921.1097      15.724         14.459224      17.2465      
       300   389.31123     -40982.397     -4104.7919      3996.5157      15.724         14.737286      17.2465      
       400   383.23193     -40916.731     -11087.608      4071.9216      15.724         15.015348      17.2465      
       500   439.37949     -40859.785     -20540.642      4147.3276      15.724         15.29341       17.2465      
       600   401.40078     -40735.686     -31961.24       4222.7335      15.724         15.571472      17.2465      
       700   409.50485     -40665.074     -40567.655      4298.1395      15.724         15.849534      17.2465      
       800   370.32463     -40581.758     -39570.256      4373.5454      15.724         16.127596      17.2465      
       900   434.17965     -40540.897     -46499.891      4448.9514      15.724         16.405658      17.2465      
      1000   363.80561     -40335.895     -60266.847      4524.3574      15.724         16.68372       17.2465      
      1100   407.51507     -40280.884     -66548.681      4599.7633      15.724         16.961782      17.2465      
      1200   456.97613     -40187.125     -56023.07       4675.1693      15.724         17.239844      17.2465      
      1300   367.93433     -40002.264     -61741.005      4750.5752      15.724         17.517906      17.2465      
      1400   405.57687     -39939.658     -63364.964      4825.9812      15.724         17.795968      17.2465      
      1500   353.48596     -39793.094     -77365.296      4901.3871      15.724         18.07403       17.2465      
      1600   371.37141     -39646.124     -68301.324      4976.7931      15.724         18.352092      17.2465      
      1700   375.85948     -39517.065     -75932.594      5052.199       15.724         18.630154      17.2465      
      1800   438.24078     -39456.05      -68396.324      5127.605       15.724         18.908216      17.2465      
      1900   425.17581     -39402.325     -60818.273      5203.011       15.724         19.186278      17.2465      
      2000   502.50917     -39480.249     -56385.037      5278.4169      15.724         19.46434       17.2465      
      2100   541.37021     -39665.719     -41109.01       5353.8229      15.724         19.742402      17.2465      
      2200   626.51033     -39992.472     -21806.165      5429.2288      15.724         20.020464      17.2465      
      2300   495.3592      -40156.128     -10377.933      5504.6348      15.724         20.298526      17.2465      
      2400   469.01025     -40315.535     -15752.367      5580.0407      15.724         20.576588      17.2465      
      2500   357.93174     -40300.632     -13554.638      5655.4467      15.724         20.85465       17.2465      
      2600   326.85445     -40338.283     -17620.698      5730.8527      15.724         21.132712      17.2465      
      2700   305.05353     -40333.526     -20777.009      5806.2586      15.724         21.410774      17.2465      
      2800   336.31342     -40333.265     -13151.31       5881.6646      15.724         21.688836      17.2465      
      2900   323.14996     -40281.709     -21113.113      5957.0705      15.724         21.966898      17.2465      
      3000   315.4589      -40286.434     -17296.242      6032.4765      15.724         22.24496       17.2465      
      3100   347.21807     -40301.256     -24060.704      6107.8824      15.724         22.523022      17.2465      
      3200   344.83673     -40243.267     -19593.236      6183.2884      15.724         22.801084      17.2465      
      3300   366.894       -40202.352     -24122.253      6258.6943      15.724         23.079146      17.2465      
      3400   402.9396      -40183.172     -24015.652      6334.1003      15.724         23.357208      17.2465      
      3500   354.3623      -40089.681     -21842.493      6409.5063      15.724         23.63527       17.2465      
      3600   336.65524     -40038.335     -23998.539      6484.9122      15.724         23.913332      17.2465      
      3700   352.47176     -40078.386     -20922.879      6560.3182      15.724         24.191394      17.2465      
      3800   312.65712     -40051.13      -22240.958      6635.7241      15.724         24.469456      17.2465      
      3900   457.83091     -40276.037     -12797.496      6711.1301      15.724         24.747518      17.2465      
      4000   388.02994     -40337.925     -8402.674       6786.536       15.724         25.02558       17.2465      
      4100   340.40802     -40371.236     -7424.0596      6861.942       15.724         25.303642      17.2465      
      4200   303.6392      -40379.1       -16451.292      6937.3479      15.724         25.581704      17.2465      
      4300   330.19912     -40409.594     -16469.736      7012.7539      15.724         25.859766      17.2465      
      4400   280.17092     -40322.871     -14212.854      7088.1599      15.724         26.137828      17.2465      
      4500   294.09998     -40273.118     -14805.977      7163.5658      15.724         26.41589       17.2465      
      4600   323.85083     -40265.881     -14527.801      7238.9718      15.724         26.693952      17.2465      
      4700   271.45234     -40160.818     -19574.799      7314.3777      15.724         26.972014      17.2465      
      4800   318.93629     -40158.123     -20468.519      7389.7837      15.724         27.250076      17.2465      
      4900   294.43638     -40159.025     -21108.227      7465.1896      15.724         27.528138      17.2465      
      5000   394.25738     -40283.978     -13392.301      7540.5956      15.724         27.8062        17.2465      
Loop time of 179.109 on 16 procs for 5000 steps with 366 atoms

Performance: 1.206 ns/day, 19.901 hours/ns, 27.916 timesteps/s, 10.217 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 119.06     | 126.09     | 134.26     |  51.5 | 70.40
Bond    | 0.0013794  | 0.0017796  | 0.002171   |   0.6 |  0.00
Neigh   | 9.2746     | 10.011     | 10.661     |  19.5 |  5.59
Comm    | 12.725     | 20.964     | 27.874     | 126.1 | 11.70
Output  | 0.0294     | 0.035517   | 0.041449   |   2.0 |  0.02
Modify  | 20.104     | 20.932     | 21.665     |  15.1 | 11.69
Other   |            | 1.078      |            |       |  0.60

Nlocal:          45.75 ave          77 max          16 min
Histogram: 3 0 1 0 0 0 0 0 2 2
Nghost:        1900.62 ave        2316 max        1481 min
Histogram: 4 0 0 0 0 0 0 0 0 4
Neighs:          18084 ave       31519 max        5328 min
Histogram: 3 1 0 0 0 0 0 0 2 2

Total # of neighbors = 144672
Ave neighs/atom = 395.27869
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.2465
variable dlen equal lz-${len0}
variable dlen equal lz-17.2465
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*17.2465
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 17.2465 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos3.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom 100 dump/pos3_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos3 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.8 | 139.5 | 141.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   310.90845     -41120.255     -15262.46       3770.2978      15.724         13.9031        17.2465      
       100   309.65351     -41136.539      1084.0227      3845.7038      15.724         13.9031        17.59143     
       200   430.01659     -41030.054     -6521.497       3921.1097      15.724         13.9031        17.93636     
       300   467.25869     -40960.239     -3127.7871      3996.5157      15.724         13.9031        18.28129     
       400   448.17292     -40856.944     -22920.499      4071.9216      15.724         13.9031        18.62622     
       500   506.58176     -40810.952     -25467.576      4147.3276      15.724         13.9031        18.97115     
       600   407.42904     -40667.049     -42295.6        4222.7335      15.724         13.9031        19.31608     
       700   463.10208     -40687.375     -47102.143      4298.1395      15.724         13.9031        19.66101     
       800   460.06542     -40641.587     -56874.671      4373.5454      15.724         13.9031        20.00594     
       900   370.59084     -40493.206     -57250.048      4448.9514      15.724         13.9031        20.35087     
      1000   362.85237     -40420.477     -62524.09       4524.3574      15.724         13.9031        20.6958      
      1100   358.34632     -40294.08      -77122.98       4599.7633      15.724         13.9031        21.04073     
      1200   359.91034     -40175.77      -82550.37       4675.1693      15.724         13.9031        21.38566     
      1300   435.06546     -40106.333     -87462.938      4750.5752      15.724         13.9031        21.73059     
      1400   373.85432     -39909.788     -88725.048      4825.9812      15.724         13.9031        22.07552     
      1500   336.19084     -39774.52      -96783.643      4901.3871      15.724         13.9031        22.42045     
      1600   325.16537     -39589.61      -98437.337      4976.7931      15.724         13.9031        22.76538     
      1700   336.64297     -39427.822     -104645.37      5052.199       15.724         13.9031        23.11031     
      1800   347.4104      -39270.147     -110197.02      5127.605       15.724         13.9031        23.45524     
      1900   344.37846     -39051.644     -104028.98      5203.011       15.724         13.9031        23.80017     
      2000   490.51074     -39054.029     -96450.931      5278.4169      15.724         13.9031        24.1451      
      2100   497.10372     -39073.583     -85090.585      5353.8229      15.724         13.9031        24.49003     
      2200   512.16298     -39124.093     -67117.049      5429.2288      15.724         13.9031        24.83496     
      2300   469.02397     -39227.162     -66238.595      5504.6348      15.724         13.9031        25.17989     
      2400   388.54424     -39201.605     -62880.481      5580.0407      15.724         13.9031        25.52482     
      2500   386.79855     -39161.826     -70759.822      5655.4467      15.724         13.9031        25.86975     
      2600   424.60895     -39227.518     -69494.978      5730.8527      15.724         13.9031        26.21468     
      2700   425.57664     -39238.848     -68241.769      5806.2586      15.724         13.9031        26.55961     
      2800   436.28183     -39394.392     -49861.787      5881.6646      15.724         13.9031        26.90454     
      2900   389.21743     -39485.11      -43254.148      5957.0705      15.724         13.9031        27.24947     
      3000   429.37626     -39708.036     -43372.561      6032.4765      15.724         13.9031        27.5944      
      3100   377.2993      -39784.928     -41980.496      6107.8824      15.724         13.9031        27.93933     
      3200   355.98887     -39910.385     -30998.497      6183.2884      15.724         13.9031        28.28426     
      3300   305.20666     -39893.254     -33405.824      6258.6943      15.724         13.9031        28.62919     
      3400   285.18247     -39852.5       -35217.406      6334.1003      15.724         13.9031        28.97412     
      3500   381.65719     -39921.64      -28764.984      6409.5063      15.724         13.9031        29.31905     
      3600   368.94467     -40002.979     -31819.621      6484.9122      15.724         13.9031        29.66398     
      3700   463.37604     -40249.359     -13537.991      6560.3182      15.724         13.9031        30.00891     
      3800   365.68166     -40375.712     -10647.956      6635.7241      15.724         13.9031        30.35384     
      3900   331.56624     -40516.744     -6750.0763      6711.1301      15.724         13.9031        30.69877     
      4000   274.41758     -40536.73       9504.9676      6786.536       15.724         13.9031        31.0437      
      4100   265.46119     -40593.531     -2921.0222      6861.942       15.724         13.9031        31.38863     
      4200   293.93083     -40629.739     -985.77029      6937.3479      15.724         13.9031        31.73356     
      4300   289.6457      -40600.536     -6555.0605      7012.7539      15.724         13.9031        32.07849     
      4400   291.81977     -40574.181     -4994.3085      7088.1599      15.724         13.9031        32.42342     
      4500   275.70365     -40555.393     -3046.4402      7163.5658      15.724         13.9031        32.76835     
      4600   332.95628     -40650.455      9339.5173      7238.9718      15.724         13.9031        33.11328     
      4700   301.76412     -40635.53       429.02686      7314.3777      15.724         13.9031        33.45821     
      4800   256.31142     -40590.23      -3319.0791      7389.7837      15.724         13.9031        33.80314     
      4900   283.88568     -40514.942     -1988.1608      7465.1896      15.724         13.9031        34.14807     
      5000   337.08086     -40534.733     -4515.4793      7540.5956      15.724         13.9031        34.493       
Loop time of 185.442 on 16 procs for 5000 steps with 366 atoms

Performance: 1.165 ns/day, 20.605 hours/ns, 26.963 timesteps/s, 9.868 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 134.62     | 136.69     | 140.39     |  17.1 | 73.71
Bond    | 0.0015356  | 0.0019216  | 0.0023124  |   0.6 |  0.00
Neigh   | 9.7857     | 10.01      | 10.325     |   5.6 |  5.40
Comm    | 14.809     | 18.389     | 20.408     |  44.6 |  9.92
Output  | 0.027708   | 0.032735   | 0.037258   |   1.5 |  0.02
Modify  | 19.033     | 19.2       | 19.569     |   4.0 | 10.35
Other   |            | 1.118      |            |       |  0.60

Nlocal:          45.75 ave          57 max          34 min
Histogram: 1 1 1 0 1 1 0 1 0 2
Nghost:        2169.25 ave        2315 max        2047 min
Histogram: 2 2 0 0 0 0 1 1 0 2
Neighs:        19395.5 ave       23275 max       14491 min
Histogram: 1 0 2 0 1 0 1 0 0 3

Total # of neighbors = 155164
Ave neighs/atom = 423.94536
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 15.724
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.4371)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.002 seconds
  read_restart CPU = 0.007 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*15.724
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_p all deform 100 yz delta ${delta} remap v units box flip no
fix deform_p all deform 100 yz delta 15.724 remap v units box flip no
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos4.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom 100 dump/pos4_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos4 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.8 | 139.5 | 141.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   310.90845     -41120.255     -15262.46       3770.2978      15.724         13.9031        17.2465      
       100   310.61075     -41136.22      -112.12724      3770.2978      15.724         13.9031        17.2465      
       200   461.71008     -40936.888      6379.8968      3770.2978      15.724         13.9031        17.2465      
       300   561.51386     -40768.567      16180.932      3770.2978      15.724         13.9031        17.2465      
       400   524.99609     -40837.356      22007.367      3770.2978      15.724         13.9031        17.2465      
       500   477.66195     -40664.017      2481.2994      3770.2978      15.724         13.9031        17.2465      
       600   447.36844     -40758.17       11915.99       3770.2978      15.724         13.9031        17.2465      
       700   428.2581      -40799.143      12000.916      3770.2978      15.724         13.9031        17.2465      
       800   453.7627      -40603.259      16745.96       3770.2978      15.724         13.9031        17.2465      
       900   416.91296     -40694.277      3125.9229      3770.2978      15.724         13.9031        17.2465      
      1000   397.19674     -40743.272      3311.9791      3770.2978      15.724         13.9031        17.2465      
      1100   374.99199     -40836.613     -3377.3328      3770.2978      15.724         13.9031        17.2465      
      1200   361.85738     -40811.5        4228.1305      3770.2978      15.724         13.9031        17.2465      
      1300   350.58521     -40821.174     -15035.053      3770.2978      15.724         13.9031        17.2465      
      1400   357.67045     -40785.156     -11545.836      3770.2978      15.724         13.9031        17.2465      
      1500   365.51007     -40759.33       539.31475      3770.2978      15.724         13.9031        17.2465      
      1600   346.75076     -40754.828     -7446.965       3770.2978      15.724         13.9031        17.2465      
      1700   348.78868     -40742.112     -21228.583      3770.2978      15.724         13.9031        17.2465      
      1800   351.13903     -40705.767     -19026.868      3770.2978      15.724         13.9031        17.2465      
      1900   329.97236     -40656.771     -5806.8583      3770.2978      15.724         13.9031        17.2465      
      2000   404.23361     -40645.609     -18273.63       3770.2978      15.724         13.9031        17.2465      
      2100   407.08979     -40639.089     -5085.1465      3770.2978      15.724         13.9031        17.2465      
      2200   325.43464     -40550.047     -14377.821      3770.2978      15.724         13.9031        17.2465      
      2300   367.88425     -40536.89      -21740.075      3770.2978      15.724         13.9031        17.2465      
      2400   348.02002     -40488.111     -12197.132      3770.2978      15.724         13.9031        17.2465      
      2500   369.91177     -40451.007     -20729.316      3770.2978      15.724         13.9031        17.2465      
      2600   359.94247     -40355.206     -31457.504      3770.2978      15.724         13.9031        17.2465      
      2700   354.35776     -40369.933     -19053.419      3770.2978      15.724         13.9031        17.2465      
      2800   313.82061     -40343.807     -11996.848      3770.2978      15.724         13.9031        17.2465      
      2900   304.81786     -40297.859     -11423.349      3770.2978      15.724         13.9031        17.2465      
      3000   332.53897     -40215.561     -22327.317      3770.2978      15.724         13.9031        17.2465      
      3100   341.33637     -40210.538     -14272.13       3770.2978      15.724         13.9031        17.2465      
      3200   427.55484     -40200.529     -21630.515      3770.2978      15.724         13.9031        17.2465      
      3300   375.63817     -40130.517     -31298.406      3770.2978      15.724         13.9031        17.2465      
      3400   381.05346     -39991.267     -22147.07       3770.2978      15.724         13.9031        17.2465      
      3500   384.82333     -39978.294     -33528.559      3770.2978      15.724         13.9031        17.2465      
      3600   384.33572     -39959.198     -26404.386      3770.2978      15.724         13.9031        17.2465      
      3700   395.76895     -39955.57      -32541.683      3770.2978      15.724         13.9031        17.2465      
      3800   368.29653     -39897.333     -23582.748      3770.2978      15.724         13.9031        17.2465      
      3900   355.13105     -39840.917     -21659.46       3770.2978      15.724         13.9031        17.2465      
      4000   413.47811     -39829.574     -13726.209      3770.2978      15.724         13.9031        17.2465      
      4100   409.21521     -39915.731     -25798.447      3770.2978      15.724         13.9031        17.2465      
      4200   362.86633     -39977.099     -7149.4559      3770.2978      15.724         13.9031        17.2465      
      4300   361.23316     -39995.367     -21028.631      3770.2978      15.724         13.9031        17.2465      
      4400   370.60699     -39967.815     -3808.1182      3770.2978      15.724         13.9031        17.2465      
      4500   390.00566     -39966.733     -25997          3770.2978      15.724         13.9031        17.2465      
      4600   385.62809     -39935.789     -11613.481      3770.2978      15.724         13.9031        17.2465      
      4700   390.85289     -39861.402     -14023.527      3770.2978      15.724         13.9031        17.2465      
      4800   389.4632      -39801.941     -33103.481      3770.2978      15.724         13.9031        17.2465      
      4900   377.73172     -39751.767     -11935.866      3770.2978      15.724         13.9031        17.2465      
      5000   424.01161     -39890.968     -19954.177      3770.2978      15.724         13.9031        17.2465      
Loop time of 303.12 on 16 procs for 5000 steps with 366 atoms

Performance: 0.713 ns/day, 33.680 hours/ns, 16.495 timesteps/s, 6.037 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 226.08     | 233.01     | 238.22     |  27.4 | 76.87
Bond    | 0.0016499  | 0.0019132  | 0.0022304  |   0.5 |  0.00
Neigh   | 19.7       | 20.567     | 21.061     |  11.1 |  6.79
Comm    | 18.242     | 23.313     | 30.451     |  88.8 |  7.69
Output  | 0.024384   | 0.03027    | 0.034965   |   1.8 |  0.01
Modify  | 24.557     | 25.238     | 26.308     |  12.7 |  8.33
Other   |            | 0.9603     |            |       |  0.32

Nlocal:          45.75 ave          50 max          42 min
Histogram: 1 1 2 0 0 1 0 1 1 1
Nghost:           4696 ave        4728 max        4665 min
Histogram: 1 0 0 3 1 1 0 0 1 1
Neighs:        31054.9 ave       33807 max       28500 min
Histogram: 1 1 1 1 1 0 0 1 1 1

Total # of neighbors = 248439
Ave neighs/atom = 678.79508
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.9031
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-0.1778)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*13.9031
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_p all deform 100 xz delta ${delta} remap v units box flip no
fix deform_p all deform 100 xz delta 13.9031 remap v units box flip no
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos5.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom 100 dump/pos5_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos5 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.8 | 139.5 | 141.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   310.90845     -41120.255     -15262.46       3770.2978      15.724         13.9031        17.2465      
       100   310.7259      -41136.44      -1024.4777      3770.2978      15.724         13.9031        17.2465      
       200   383.725       -41051.007      8467.5958      3770.2978      15.724         13.9031        17.2465      
       300   372.41903     -40957.613      4814.5478      3770.2978      15.724         13.9031        17.2465      
       400   421.19867     -40972.729      3901.1239      3770.2978      15.724         13.9031        17.2465      
       500   392.83965     -40944.586      4176.3215      3770.2978      15.724         13.9031        17.2465      
       600   397.11343     -41004.525     -8454.4288      3770.2978      15.724         13.9031        17.2465      
       700   336.88151     -40968.163     -7600.5146      3770.2978      15.724         13.9031        17.2465      
       800   289.54301     -41001.183      6058.7434      3770.2978      15.724         13.9031        17.2465      
       900   311.88444     -41023.55       225.69622      3770.2978      15.724         13.9031        17.2465      
      1000   310.0978      -40998.136     -3699.7381      3770.2978      15.724         13.9031        17.2465      
      1100   333.45682     -40947.267     -4563.7922      3770.2978      15.724         13.9031        17.2465      
      1200   331.3857      -40968.517     -7721.1576      3770.2978      15.724         13.9031        17.2465      
      1300   368.45559     -40924.74      -2466.3154      3770.2978      15.724         13.9031        17.2465      
      1400   345.65595     -40841.889     -11308.617      3770.2978      15.724         13.9031        17.2465      
      1500   337.63041     -40844.102     -9507.4188      3770.2978      15.724         13.9031        17.2465      
      1600   373.74762     -40830.393     -3060.9392      3770.2978      15.724         13.9031        17.2465      
      1700   377.31431     -40742.102     -8955.3371      3770.2978      15.724         13.9031        17.2465      
      1800   383.06008     -40712.711     -22152.604      3770.2978      15.724         13.9031        17.2465      
      1900   390.06446     -40707.795     -5843.0246      3770.2978      15.724         13.9031        17.2465      
      2000   357.35756     -40446.764      720.94814      3770.2978      15.724         13.9031        17.2465      
      2100   395.93579     -40488.19      -10053.245      3770.2978      15.724         13.9031        17.2465      
      2200   423.49191     -40472.182     -2700.7268      3770.2978      15.724         13.9031        17.2465      
      2300   376.07179     -40486.012     -12774.672      3770.2978      15.724         13.9031        17.2465      
      2400   351.58779     -40433.155     -15309.478      3770.2978      15.724         13.9031        17.2465      
      2500   407.4549      -40438.857     -19570.179      3770.2978      15.724         13.9031        17.2465      
      2600   356.05715     -40388.885     -21602.758      3770.2978      15.724         13.9031        17.2465      
      2700   354.24866     -40323.79      -16540.384      3770.2978      15.724         13.9031        17.2465      
      2800   311.75491     -40251.232     -23926.994      3770.2978      15.724         13.9031        17.2465      
      2900   378.91232     -40158.276     -30877.186      3770.2978      15.724         13.9031        17.2465      
      3000   410.47157     -40151.928     -30100.81       3770.2978      15.724         13.9031        17.2465      
      3100   341.90394     -40089.978     -43397.733      3770.2978      15.724         13.9031        17.2465      
      3200   288.99004     -40014.666     -23046.253      3770.2978      15.724         13.9031        17.2465      
      3300   340.94339     -40005.257     -33696.785      3770.2978      15.724         13.9031        17.2465      
      3400   377.45488     -40019.591     -28040.601      3770.2978      15.724         13.9031        17.2465      
      3500   394.41129     -40055.34      -48271.863      3770.2978      15.724         13.9031        17.2465      
      3600   367.68646     -40006.388     -37773.375      3770.2978      15.724         13.9031        17.2465      
      3700   328.48286     -39939.464     -31292.926      3770.2978      15.724         13.9031        17.2465      
      3800   393.80955     -39975.571     -28611.04       3770.2978      15.724         13.9031        17.2465      
      3900   368.65396     -39984.648     -26079.717      3770.2978      15.724         13.9031        17.2465      
      4000   368.89047     -39957.182     -22228.688      3770.2978      15.724         13.9031        17.2465      
      4100   372.67074     -39910.862     -20007.733      3770.2978      15.724         13.9031        17.2465      
      4200   375.77422     -39913.668     -27113.826      3770.2978      15.724         13.9031        17.2465      
      4300   325.96534     -39864.837     -27950.537      3770.2978      15.724         13.9031        17.2465      
      4400   389.02405     -39856.025     -15746.179      3770.2978      15.724         13.9031        17.2465      
      4500   428.96661     -39965.33       1341.0416      3770.2978      15.724         13.9031        17.2465      
      4600   358.08996     -39999.855      6971.5803      3770.2978      15.724         13.9031        17.2465      
      4700   380.08775     -40050.693     -901.15802      3770.2978      15.724         13.9031        17.2465      
      4800   368.8808      -40086.243     -15448.896      3770.2978      15.724         13.9031        17.2465      
      4900   373.33272     -40138.049      2968.6887      3770.2978      15.724         13.9031        17.2465      
      5000   364.92101     -40193.058     -4885.8099      3770.2978      15.724         13.9031        17.2465      
Loop time of 186.351 on 16 procs for 5000 steps with 366 atoms

Performance: 1.159 ns/day, 20.706 hours/ns, 26.831 timesteps/s, 9.820 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 139.13     | 147.98     | 152.57     |  40.6 | 79.41
Bond    | 0.0011412  | 0.0014305  | 0.0017106  |   0.5 |  0.00
Neigh   | 12.57      | 13.47      | 14.096     |  11.9 |  7.23
Comm    | 2.8546     | 7.4315     | 16.306     | 181.4 |  3.99
Output  | 0.011473   | 0.013141   | 0.014184   |   0.7 |  0.01
Modify  | 16.699     | 17.331     | 18.221     |  10.3 |  9.30
Other   |            | 0.1193     |            |       |  0.06

Nlocal:          45.75 ave          51 max          37 min
Histogram: 1 0 1 0 0 1 1 1 1 2
Nghost:        4037.12 ave        4119 max        3966 min
Histogram: 2 1 1 0 0 0 0 3 0 1
Neighs:        31002.9 ave       34271 max       25409 min
Histogram: 1 0 1 0 0 1 1 1 1 2

Total # of neighbors = 248023
Ave neighs/atom = 677.65847
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.2465
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--7.584)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.724 13.9031 17.2465) with tilt (-7.584 0.1778 0.4371)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*17.2465
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_p all deform 100 xy delta ${delta} remap v units box flip no
fix deform_p all deform 100 xy delta 17.2465 remap v units box flip no

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos6.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom 100 dump/pos6_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos6 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.8 | 139.5 | 141.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   310.90845     -41120.255     -15262.46       3770.2978      15.724         13.9031        17.2465      
       100   313.73202     -41136.383     -821.39253      3770.2978      15.724         13.9031        17.2465      
       200   368.09881     -41014.596      1300.4189      3770.2978      15.724         13.9031        17.2465      
       300   405.81632     -40972.444      10364.028      3770.2978      15.724         13.9031        17.2465      
       400   453.85051     -40933.84       20994.41       3770.2978      15.724         13.9031        17.2465      
       500   420.93041     -40948.709      7319.5534      3770.2978      15.724         13.9031        17.2465      
       600   419.27698     -40943.383     -6416.5785      3770.2978      15.724         13.9031        17.2465      
       700   387.60756     -40881.446      7567.4444      3770.2978      15.724         13.9031        17.2465      
       800   413.28912     -40909.537      1385.421       3770.2978      15.724         13.9031        17.2465      
       900   423.80323     -40832.193     -7856.9215      3770.2978      15.724         13.9031        17.2465      
      1000   455.0689      -40846.541     -21519.768      3770.2978      15.724         13.9031        17.2465      
      1100   355.27764     -40712.011     -864.96123      3770.2978      15.724         13.9031        17.2465      
      1200   403.32807     -40683.361      3983.5005      3770.2978      15.724         13.9031        17.2465      
      1300   375.78082     -40642.313     -7024.4103      3770.2978      15.724         13.9031        17.2465      
      1400   323.88994     -40508.966     -8177.7475      3770.2978      15.724         13.9031        17.2465      
      1500   396.60688     -40496.971     -4539.7789      3770.2978      15.724         13.9031        17.2465      
      1600   381.61618     -40404.72      -1007.6655      3770.2978      15.724         13.9031        17.2465      
      1700   330.54421     -40376.23      -11914.801      3770.2978      15.724         13.9031        17.2465      
      1800   346.10142     -40280.673     -12346.267      3770.2978      15.724         13.9031        17.2465      
      1900   354.85437     -40195.797     -8441.583       3770.2978      15.724         13.9031        17.2465      
      2000   400.82759     -40156.04      -26827.76       3770.2978      15.724         13.9031        17.2465      
      2100   399.82213     -40084.809     -21032.908      3770.2978      15.724         13.9031        17.2465      
      2200   369.48415     -39999.509     -39174.239      3770.2978      15.724         13.9031        17.2465      
      2300   397.29893     -39910.652     -44228.556      3770.2978      15.724         13.9031        17.2465      
      2400   389.37139     -39846.702     -26361.072      3770.2978      15.724         13.9031        17.2465      
      2500   361.86433     -39718.747     -40073.214      3770.2978      15.724         13.9031        17.2465      
      2600   320.01414     -39564.631     -41191.678      3770.2978      15.724         13.9031        17.2465      
      2700   378.06792     -39472.682     -44762.474      3770.2978      15.724         13.9031        17.2465      
      2800   393.18389     -39401.526     -45473.912      3770.2978      15.724         13.9031        17.2465      
      2900   507.34809     -39468.839     -33756.031      3770.2978      15.724         13.9031        17.2465      
      3000   506.34313     -39603.227     -16761.519      3770.2978      15.724         13.9031        17.2465      
      3100   499.99985     -39592.901     -15505.779      3770.2978      15.724         13.9031        17.2465      
      3200   396.10383     -39636.608     -10432.185      3770.2978      15.724         13.9031        17.2465      
      3300   396.92224     -39661.953     -9445.1979      3770.2978      15.724         13.9031        17.2465      
      3400   410.09252     -39727.691     -7451.9635      3770.2978      15.724         13.9031        17.2465      
      3500   346.22963     -39696.966     -28175.121      3770.2978      15.724         13.9031        17.2465      
      3600   366.68922     -39727.937     -16413.191      3770.2978      15.724         13.9031        17.2465      
      3700   342.51316     -39713.945     -21110.783      3770.2978      15.724         13.9031        17.2465      
      3800   352.56809     -39736.478     -36384.487      3770.2978      15.724         13.9031        17.2465      
      3900   354.42121     -39691.586     -38922.261      3770.2978      15.724         13.9031        17.2465      
      4000   329.42252     -39634.668     -24242.139      3770.2978      15.724         13.9031        17.2465      
      4100   388.26295     -39678.524     -16701.369      3770.2978      15.724         13.9031        17.2465      
      4200   537.73188     -39593.039     -7980.7113      3770.2978      15.724         13.9031        17.2465      
      4300   523.40396     -39566.388      7596.0304      3770.2978      15.724         13.9031        17.2465      
      4400   407.01576     -39609.136     -14126.842      3770.2978      15.724         13.9031        17.2465      
      4500   389.12687     -39662.495     -29277.509      3770.2978      15.724         13.9031        17.2465      
      4600   387.73745     -39742.821      3450.0488      3770.2978      15.724         13.9031        17.2465      
      4700   368.58379     -39711.774     -10292.964      3770.2978      15.724         13.9031        17.2465      
      4800   425.3182      -39829.003     -12642.095      3770.2978      15.724         13.9031        17.2465      
      4900   437.91661     -39886.918      554.37594      3770.2978      15.724         13.9031        17.2465      
      5000   420.67832     -39936.964     -15543.278      3770.2978      15.724         13.9031        17.2465      
Loop time of 147.319 on 16 procs for 5000 steps with 366 atoms

Performance: 1.466 ns/day, 16.369 hours/ns, 33.940 timesteps/s, 12.422 katom-step/s
99.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 114.29     | 116.52     | 118.16     |  11.7 | 79.09
Bond    | 0.00092919 | 0.0011868  | 0.0014421  |   0.5 |  0.00
Neigh   | 11.554     | 11.724     | 11.859     |   3.2 |  7.96
Comm    | 2.2102     | 3.8541     | 6.0826     |  64.3 |  2.62
Output  | 0.0096665  | 0.011125   | 0.012087   |   0.8 |  0.01
Modify  | 14.961     | 15.098     | 15.267     |   2.8 | 10.25
Other   |            | 0.1102     |            |       |  0.07

Nlocal:          45.75 ave          53 max          41 min
Histogram: 1 0 2 2 1 1 0 0 0 1
Nghost:        3600.12 ave        3657 max        3540 min
Histogram: 1 0 1 1 1 1 1 0 1 1
Neighs:        31054.9 ave       35418 max       27872 min
Histogram: 1 0 2 2 1 1 0 0 0 1

Total # of neighbors = 248439
Ave neighs/atom = 678.79508
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:24:24
