LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 100
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 50
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 1.0                  # the deformation magnitude 0.01

variable FF string "SiOCHN_2018.ff C H O Si"   # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si
variable structure string 333-EXP-11-vasp

# Read the initial sctructure
# box tilt large
read_data       ${structure}.data
read_data       333-EXP-11-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.008 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
fix bondinfo all reaxff/bonds 1 bonds_opt.reaxff

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
dump dump_opt all custom 1 dump/dump_opt.lammpstrj id type q x y z
minimize 1.0e-6 1.0e-6 100 1000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -8.2 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 117.8 | 118.7 | 119.6 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0             -22962.516      0             -22962.516      123127.02    
        51   0             -26430.416      0             -26430.416     -10013.774    
Loop time of 3.36293 on 16 procs for 51 steps with 274 atoms

97.4% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
     -22962.5161588605   -26430.406322329  -26430.4158399655
  Force two-norm initial, final = 3932.9092 378.80192
  Force max component initial, final = 549.8429 172.76318
  Final line search alpha, max atom move = 0.00016237541 0.028052492
  Iterations, force evaluations = 51 115

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 1.9336     | 2.2202     | 2.4956     |  10.7 | 66.02
Bond    | 2.7465e-05 | 3.4447e-05 | 4.3695e-05 |   0.0 |  0.00
Neigh   | 0.014603   | 0.017186   | 0.024928   |   2.7 |  0.51
Comm    | 0.097895   | 0.37355    | 0.66001    |  26.1 | 11.11
Output  | 0.0070869  | 0.0095889  | 0.011332   |   1.6 |  0.29
Modify  | 0.72714    | 0.7347     | 0.738      |   0.4 | 21.85
Other   |            | 0.007641   |            |       |  0.23

Nlocal:          34.25 ave          38 max          27 min
Histogram: 1 0 0 0 0 2 0 1 3 1
Nghost:        2831.25 ave        2861 max        2807 min
Histogram: 2 2 0 0 0 0 1 2 0 1
Neighs:        18957.8 ave       20978 max       15113 min
Histogram: 1 0 0 0 0 2 0 1 3 1

Total # of neighbors = 151662
Ave neighs/atom = 553.51095
Ave special neighs/atom = 0
Neighbor list builds = 1
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-EXP-11-vasp_opt.data
System init for write_data ...
undump dump_opt
unfix bondinfo
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
dump dump_eq all custom ${nthermo} dump/dump_eq.lammpstrj id type q x y z
dump dump_eq all custom 100 dump/dump_eq.lammpstrj id type q x y z

# compute MSD
compute msd1 all msd
fix myMSD all ave/time ${nevery} ${nrepeat} ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 ${nrepeat} ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 10 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 10 100 c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out

run ${nequil}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.6 | 112.5 | 113.4 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -26430.416     -6799.9557      1.4594291      3472.1201    
       100   255.35038     -26362.322     -12117.236      1.4594291      3472.1201    
       200   328.85443     -26423.362      5987.3062      1.4594291      3472.1201    
       300   338.88392     -26491.038     -10064.58       1.4594291      3472.1201    
       400   329.84532     -26541.36      -5383.668       1.4594291      3472.1201    
       500   283.32051     -26557.033      12887.797      1.4594291      3472.1201    
       600   276.89074     -26582.96      -2830.4058      1.4594291      3472.1201    
       700   274.83647     -26603.932      5243.5528      1.4594291      3472.1201    
       800   270.06059     -26619.071      4922.9488      1.4594291      3472.1201    
       900   299.08617     -26640.82       4181.1269      1.4594291      3472.1201    
      1000   293.68032     -26626.471      5513.2573      1.4594291      3472.1201    
      1100   339.75535     -26681.891     -12799.367      1.4594291      3472.1201    
      1200   299.47788     -26682.379     -13106.313      1.4594291      3472.1201    
      1300   352.00986     -26751.418      2759.9027      1.4594291      3472.1201    
      1400   305.14031     -26750.011      10203.889      1.4594291      3472.1201    
      1500   380.89771     -26852.968     -136.05968      1.4594291      3472.1201    
      1600   322.04336     -26865.839     -17143.089      1.4594291      3472.1201    
      1700   332.16768     -26917.874      7427.4894      1.4594291      3472.1201    
      1800   345.58728     -26976.835     -108.80226      1.4594291      3472.1201    
      1900   315.84691     -27007.034     -5101.9906      1.4594291      3472.1201    
      2000   314.36445     -27050.034      2299.5513      1.4594291      3472.1201    
      2100   330.15359     -27109.014     -5077.048       1.4594291      3472.1201    
      2200   332.68137     -27160.265     -10458.082      1.4594291      3472.1201    
      2300   284.90681     -27159.165     -12481.838      1.4594291      3472.1201    
      2400   280.45007     -27163.617     -12889.801      1.4594291      3472.1201    
      2500   287.15688     -27174.164     -10907.588      1.4594291      3472.1201    
      2600   295.9191      -27172.918     -1680.991       1.4594291      3472.1201    
      2700   312.59148     -27179.954      10040.67       1.4594291      3472.1201    
      2800   333.44798     -27247.028      8816.5519      1.4594291      3472.1201    
      2900   278.03837     -27244.773      6579.2849      1.4594291      3472.1201    
      3000   317.56496     -27303.707     -3.8578742      1.4594291      3472.1201    
      3100   323.78987     -27317.097     -2813.1725      1.4594291      3472.1201    
      3200   288.97636     -27295.167      66.485912      1.4594291      3472.1201    
      3300   315.54634     -27319.293      7158.5297      1.4594291      3472.1201    
      3400   347.3912      -27332.767     -6049.1981      1.4594291      3472.1201    
      3500   339.82567     -27309.004      6993.4629      1.4594291      3472.1201    
      3600   281.68131     -27267.927     -8040.9949      1.4594291      3472.1201    
      3700   265.96736     -27286.917      2671.3126      1.4594291      3472.1201    
      3800   275.46797     -27297.68      -7513.1056      1.4594291      3472.1201    
      3900   288.09235     -27296.204     -10319.622      1.4594291      3472.1201    
      4000   292.39405     -27292.792     -12582.169      1.4594291      3472.1201    
      4100   287.23801     -27287.482     -9851.0487      1.4594291      3472.1201    
      4200   248.49962     -27262.105     -11328.612      1.4594291      3472.1201    
      4300   255.23822     -27273.713     -20621.08       1.4594291      3472.1201    
      4400   246.68483     -27283.895     -1376.9959      1.4594291      3472.1201    
      4500   286.18233     -27308.794     -4198.9539      1.4594291      3472.1201    
      4600   337.58775     -27328.669     -5316.9781      1.4594291      3472.1201    
      4700   314.37349     -27301.546     -6403.4106      1.4594291      3472.1201    
      4800   304.54013     -27308.775      51.950936      1.4594291      3472.1201    
      4900   301.83334     -27327.065      6288.4511      1.4594291      3472.1201    
      5000   327.1646      -27337.555     -12084.324      1.4594291      3472.1201    
Loop time of 179.615 on 16 procs for 5000 steps with 274 atoms

Performance: 1.203 ns/day, 19.957 hours/ns, 27.837 timesteps/s, 7.627 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 127.55     | 132.07     | 138.5      |  32.7 | 73.53
Bond    | 0.0014196  | 0.0017009  | 0.0018638  |   0.4 |  0.00
Neigh   | 10.018     | 10.274     | 10.544     |   4.7 |  5.72
Comm    | 12.289     | 18.637     | 23.001     |  86.9 | 10.38
Output  | 0.02725    | 0.031313   | 0.03565    |   1.7 |  0.02
Modify  | 17.177     | 17.641     | 17.909     |   5.4 |  9.82
Other   |            | 0.9609     |            |       |  0.53

Nlocal:          34.25 ave          42 max          24 min
Histogram: 1 0 0 2 0 1 0 2 1 1
Nghost:        2771.25 ave        2816 max        2719 min
Histogram: 1 1 1 0 1 0 1 0 2 1
Neighs:        18890.8 ave       22809 max       13563 min
Histogram: 1 0 0 1 1 1 0 2 1 1

Total # of neighbors = 151126
Ave neighs/atom = 551.55474
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333-EXP-11-vasp_eq.data
System init for write_data ...
undump dump_eq
unfix myMSD

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.8189
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 12.842
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 16.0755

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.4312
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 1.195
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -8.3798

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 16.8189
variable dlen equal lx-${len0}
variable dlen equal lx-16.8189
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*16.8189
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 16.8189 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 16.8189 xy delta -8.3798 xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 16.8189 xy delta -8.3798 xz delta 1.195 remap v units box flip no
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos1.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom 100 dump/pos1_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos1 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 112.3 | 114.4 | 116.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   327.1646      -27337.555     -12084.11       3472.1201      16.8189        12.842         16.0755      
       100   304.99798     -27287.968     -5278.3005      3541.5625      17.155278      12.842         16.0755      
       200   370.94804     -27139.205     -15860.137      3611.0049      17.491656      12.842         16.0755      
       300   478.90982     -27078.353      2318.7807      3680.4473      17.828034      12.842         16.0755      
       400   532.73937     -27135.387     -8879.9185      3749.8897      18.164412      12.842         16.0755      
       500   504.32368     -27176.005     -5472.5963      3819.3322      18.50079       12.842         16.0755      
       600   463.77456     -27161.512     -9121.976       3888.7746      18.837168      12.842         16.0755      
       700   496.58241     -27249.036     -12547.045      3958.217       19.173546      12.842         16.0755      
       800   421.45658     -27231.425     -8058.6651      4027.6594      19.509924      12.842         16.0755      
       900   440.34145     -27207.246     -22627.806      4097.1018      19.846302      12.842         16.0755      
      1000   371.29442     -27132.414     -13447.446      4166.5442      20.18268       12.842         16.0755      
      1100   371.26611     -27122.405     -24667.866      4235.9866      20.519058      12.842         16.0755      
      1200   406.63478     -27113.055     -19808.746      4305.429       20.855436      12.842         16.0755      
      1300   448.04252     -27108.268     -9205.7002      4374.8714      21.191814      12.842         16.0755      
      1400   430.74654     -27130.136     -10187.817      4444.3138      21.528192      12.842         16.0755      
      1500   381.6257      -27140.21      -4443.0144      4513.7562      21.86457       12.842         16.0755      
      1600   455.92753     -27188.177     -14004.776      4583.1986      22.200948      12.842         16.0755      
      1700   392.23099     -27118.936     -16934.149      4652.641       22.537326      12.842         16.0755      
      1800   389.18463     -27070.049     -14589.188      4722.0834      22.873704      12.842         16.0755      
      1900   376.00674     -27058.514     -6755.7365      4791.5258      23.210082      12.842         16.0755      
      2000   432.13082     -27021.063     -12939.046      4860.9682      23.54646       12.842         16.0755      
      2100   457.37621     -27027.382     -13591.743      4930.4106      23.882838      12.842         16.0755      
      2200   420.23463     -27045.984     -20971.222      4999.853       24.219216      12.842         16.0755      
      2300   408.93843     -27023.015     -12341.263      5069.2954      24.555594      12.842         16.0755      
      2400   461.52939     -27014.599     -12392.42       5138.7378      24.891972      12.842         16.0755      
      2500   546.19057     -27050.226     -11878.764      5208.1802      25.22835       12.842         16.0755      
      2600   431.61843     -26967.406     -23636.938      5277.6226      25.564728      12.842         16.0755      
      2700   441.38104     -27020.237     -24144.624      5347.065       25.901106      12.842         16.0755      
      2800   440.08049     -26982.064     -15426.557      5416.5074      26.237484      12.842         16.0755      
      2900   448.87371     -27000.876     -10620.764      5485.9498      26.573862      12.842         16.0755      
      3000   404.90495     -26992.184     -15873.321      5555.3922      26.91024       12.842         16.0755      
      3100   414.38903     -26991.09      -4735.7754      5624.8346      27.246618      12.842         16.0755      
      3200   400.39763     -26968.742     -12188.327      5694.277       27.582996      12.842         16.0755      
      3300   345.25277     -26948.291     -12953.793      5763.7194      27.919374      12.842         16.0755      
      3400   364.30929     -26979.718     -15114.408      5833.1618      28.255752      12.842         16.0755      
      3500   335.04643     -26943.395     -18587.006      5902.6042      28.59213       12.842         16.0755      
      3600   336.03128     -26912.138     -17684.196      5972.0466      28.928508      12.842         16.0755      
      3700   308.40757     -26905.679     -21307.018      6041.489       29.264886      12.842         16.0755      
      3800   333.01844     -26868.621     -24361.873      6110.9314      29.601264      12.842         16.0755      
      3900   327.78973     -26839.064     -19331.417      6180.3738      29.937642      12.842         16.0755      
      4000   317.21353     -26801.366     -21396.617      6249.8162      30.27402       12.842         16.0755      
      4100   319.27167     -26780.167     -21044.481      6319.2587      30.610398      12.842         16.0755      
      4200   392.60464     -26859.01      -15052.466      6388.7011      30.946776      12.842         16.0755      
      4300   380.80777     -26920.452     -9220.0962      6458.1435      31.283154      12.842         16.0755      
      4400   330.34387     -26920.456     -22009.911      6527.5859      31.619532      12.842         16.0755      
      4500   359.97935     -26910.797     -17054.955      6597.0283      31.95591       12.842         16.0755      
      4600   368.07887     -26909.255     -15330.568      6666.4707      32.292288      12.842         16.0755      
      4700   425.29535     -26897.293     -14742.202      6735.9131      32.628666      12.842         16.0755      
      4800   401.07024     -26910.779     -16721.863      6805.3555      32.965044      12.842         16.0755      
      4900   368.61827     -26922.493     -16275.812      6874.7979      33.301422      12.842         16.0755      
      5000   349.31038     -26893.209     -12589.328      6944.2403      33.6378        12.842         16.0755      
Loop time of 140.474 on 16 procs for 5000 steps with 274 atoms

Performance: 1.538 ns/day, 15.608 hours/ns, 35.594 timesteps/s, 9.753 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 95.099     | 99.024     | 103.32     |  34.7 | 70.49
Bond    | 0.0013698  | 0.0016572  | 0.0020269  |   0.4 |  0.00
Neigh   | 6.375      | 6.7166     | 7.006      |   8.0 |  4.78
Comm    | 13.154     | 17.313     | 21.151     |  83.3 | 12.32
Output  | 0.025234   | 0.030814   | 0.036057   |   2.2 |  0.02
Modify  | 16.017     | 16.39      | 16.904     |   6.4 | 11.67
Other   |            | 0.9987     |            |       |  0.71

Nlocal:          34.25 ave          50 max          24 min
Histogram: 2 1 0 0 2 2 0 0 0 1
Nghost:        2100.62 ave        2148 max        2042 min
Histogram: 1 2 0 1 0 0 0 1 0 3
Neighs:        9494.62 ave       12895 max        6801 min
Histogram: 2 0 1 0 1 2 1 0 0 1

Total # of neighbors = 75957
Ave neighs/atom = 277.21533
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 12.842
variable dlen equal ly-${len0}
variable dlen equal ly-12.842
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*12.842
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 12.842 yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 12.842 yz delta 0.4312 remap v units box flip no
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos2.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom 100 dump/pos2_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos2 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 112.3 | 114.4 | 116.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   327.1646      -27337.555     -12084.11       3472.1201      16.8189        12.842         16.0755      
       100   303.1488      -27287.615     -5334.5712      3541.5625      16.8189        13.09884       16.0755      
       200   394.57158     -27141.302     -19480.677      3611.0049      16.8189        13.35568       16.0755      
       300   521.49695     -27153.257     -10887.582      3680.4473      16.8189        13.61252       16.0755      
       400   554.04597     -27144.459     -9633.3879      3749.8897      16.8189        13.86936       16.0755      
       500   490.64843     -27145.075     -2078.1269      3819.3322      16.8189        14.1262        16.0755      
       600   421.94503     -27123.119     -1459.2511      3888.7746      16.8189        14.38304       16.0755      
       700   426.63188     -27169.697     -6815.1078      3958.217       16.8189        14.63988       16.0755      
       800   424.44917     -27134.247     -16536.718      4027.6594      16.8189        14.89672       16.0755      
       900   393.87884     -27135.608     -16666.743      4097.1018      16.8189        15.15356       16.0755      
      1000   450.53293     -27157.732     -3659.9682      4166.5442      16.8189        15.4104        16.0755      
      1100   462.69249     -27189.665     -561.05896      4235.9866      16.8189        15.66724       16.0755      
      1200   423.02908     -27188.434      1873.7573      4305.429       16.8189        15.92408       16.0755      
      1300   340.09068     -27177.901      4209.0661      4374.8714      16.8189        16.18092       16.0755      
      1400   351.62591     -27199.885     -2026.0623      4444.3138      16.8189        16.43776       16.0755      
      1500   416.44533     -27222.375     -10928.981      4513.7562      16.8189        16.6946        16.0755      
      1600   410.26382     -27178.552     -10252.868      4583.1986      16.8189        16.95144       16.0755      
      1700   349.18573     -27131.194     -8516.2342      4652.641       16.8189        17.20828       16.0755      
      1800   372.20565     -27198.859     -3548.5922      4722.0834      16.8189        17.46512       16.0755      
      1900   344.26466     -27185.566     -14246.65       4791.5258      16.8189        17.72196       16.0755      
      2000   391.06158     -27177.956     -10931.024      4860.9682      16.8189        17.9788        16.0755      
      2100   409.14117     -27165.261     -16163.564      4930.4106      16.8189        18.23564       16.0755      
      2200   331.34774     -27097.935     -15186.425      4999.853       16.8189        18.49248       16.0755      
      2300   350.5351      -27111.992     -21269.441      5069.2954      16.8189        18.74932       16.0755      
      2400   347.4345      -27109.092     -18842.306      5138.7378      16.8189        19.00616       16.0755      
      2500   348.34902     -27118.092     -14623.336      5208.1802      16.8189        19.263         16.0755      
      2600   310.22324     -27103.953     -14158.64       5277.6226      16.8189        19.51984       16.0755      
      2700   337.68421     -27095.16      -10904.298      5347.065       16.8189        19.77668       16.0755      
      2800   389.05923     -27171.65      -10572.125      5416.5074      16.8189        20.03352       16.0755      
      2900   320.71545     -27176.093     -18270.113      5485.9498      16.8189        20.29036       16.0755      
      3000   356.32607     -27172.617     -13895.023      5555.3922      16.8189        20.5472        16.0755      
      3100   368.97141     -27176.756     -12806.302      5624.8346      16.8189        20.80404       16.0755      
      3200   329.2719      -27157.151     -9221.4763      5694.277       16.8189        21.06088       16.0755      
      3300   362.61135     -27191.375      711.50793      5763.7194      16.8189        21.31772       16.0755      
      3400   341.35232     -27209.575     -5034.5185      5833.1618      16.8189        21.57456       16.0755      
      3500   323.12196     -27193.697     -8721.9856      5902.6042      16.8189        21.8314        16.0755      
      3600   326.817       -27204.814     -5656.149       5972.0466      16.8189        22.08824       16.0755      
      3700   330.76676     -27193.826     -15005.067      6041.489       16.8189        22.34508       16.0755      
      3800   370.44121     -27222.143     -13078.095      6110.9314      16.8189        22.60192       16.0755      
      3900   297.6387      -27151.752     -14146.766      6180.3738      16.8189        22.85876       16.0755      
      4000   328.8743      -27168.459     -1722.4189      6249.8162      16.8189        23.1156        16.0755      
      4100   312.84793     -27150.416     -11224.003      6319.2587      16.8189        23.37244       16.0755      
      4200   348.29682     -27130.73      -7769.761       6388.7011      16.8189        23.62928       16.0755      
      4300   372.21515     -27148.275     -12070.905      6458.1435      16.8189        23.88612       16.0755      
      4400   355.77134     -27172.532     -10414.024      6527.5859      16.8189        24.14296       16.0755      
      4500   330.14921     -27144.883     -14925.774      6597.0283      16.8189        24.3998        16.0755      
      4600   333.29898     -27161.61      -9332.5478      6666.4707      16.8189        24.65664       16.0755      
      4700   345.02591     -27157.202     -3636.5187      6735.9131      16.8189        24.91348       16.0755      
      4800   393.32889     -27177.704     -15355.322      6805.3555      16.8189        25.17032       16.0755      
      4900   386.97418     -27103.461     -12190.328      6874.7979      16.8189        25.42716       16.0755      
      5000   435.65572     -27131.938     -12871.339      6944.2403      16.8189        25.684         16.0755      
Loop time of 122.068 on 16 procs for 5000 steps with 274 atoms

Performance: 1.770 ns/day, 13.563 hours/ns, 40.961 timesteps/s, 11.223 katom-step/s
99.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 81.837     | 84.944     | 89.932     |  27.8 | 69.59
Bond    | 0.0013428  | 0.0016032  | 0.0018778  |   0.4 |  0.00
Neigh   | 5.9118     | 5.9805     | 6.0194     |   1.6 |  4.90
Comm    | 10.226     | 15.157     | 18.218     |  65.6 | 12.42
Output  | 0.026075   | 0.033181   | 0.03799    |   2.3 |  0.03
Modify  | 14.726     | 14.821     | 15         |   2.3 | 12.14
Other   |            | 1.131      |            |       |  0.93

Nlocal:          34.25 ave          43 max          16 min
Histogram: 1 0 0 1 0 1 0 1 2 2
Nghost:        1542.75 ave        1616 max        1476 min
Histogram: 4 0 0 0 0 0 0 0 2 2
Neighs:        9069.25 ave       11722 max        4452 min
Histogram: 1 0 1 0 0 1 0 2 2 1

Total # of neighbors = 72554
Ave neighs/atom = 264.79562
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 16.0755
variable dlen equal lz-${len0}
variable dlen equal lz-16.0755
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*16.0755
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 16.0755 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos3.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom 100 dump/pos3_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos3 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 112.3 | 114.4 | 116.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   327.1646      -27337.555     -12084.11       3472.1201      16.8189        12.842         16.0755      
       100   296.6854      -27282.432     -5371.92        3541.5625      16.8189        12.842         16.39701     
       200   397.81475     -27212.88      -6305.9753      3611.0049      16.8189        12.842         16.71852     
       300   462.26784     -27216.822     -8726.0209      3680.4473      16.8189        12.842         17.04003     
       400   474.44488     -27205.663     -9879.749       3749.8897      16.8189        12.842         17.36154     
       500   505.27471     -27275.832     -6417.9219      3819.3322      16.8189        12.842         17.68305     
       600   515.60473     -27350.312     -11409.531      3888.7746      16.8189        12.842         18.00456     
       700   376.84742     -27335.006     -14954.001      3958.217       16.8189        12.842         18.32607     
       800   420.05773     -27392.987     -10053.217      4027.6594      16.8189        12.842         18.64758     
       900   326.4712      -27318.395     -13712.026      4097.1018      16.8189        12.842         18.96909     
      1000   397.72635     -27393.449     -11502.84       4166.5442      16.8189        12.842         19.2906      
      1100   430.93155     -27406.423     -11560.962      4235.9866      16.8189        12.842         19.61211     
      1200   369.65711     -27307.28      -11610.085      4305.429       16.8189        12.842         19.93362     
      1300   358.3096      -27315.238     -15724.934      4374.8714      16.8189        12.842         20.25513     
      1400   408.94275     -27343.685     -13001.617      4444.3138      16.8189        12.842         20.57664     
      1500   375.33757     -27336.682     -22468.28       4513.7562      16.8189        12.842         20.89815     
      1600   353.1545      -27266.568     -19041.293      4583.1986      16.8189        12.842         21.21966     
      1700   319.23743     -27225.158     -19597.328      4652.641       16.8189        12.842         21.54117     
      1800   415.83193     -27294.692     -11648.139      4722.0834      16.8189        12.842         21.86268     
      1900   449.87849     -27328.046     -17198.736      4791.5258      16.8189        12.842         22.18419     
      2000   436.49298     -27310.822     -24022.627      4860.9682      16.8189        12.842         22.5057      
      2100   416.02844     -27260.014     -20528.362      4930.4106      16.8189        12.842         22.82721     
      2200   253.38494     -27194.216     -17094.952      4999.853       16.8189        12.842         23.14872     
      2300   401.57546     -27332.864     -17892.289      5069.2954      16.8189        12.842         23.47023     
      2400   322.87035     -27214.195     -30903.139      5138.7378      16.8189        12.842         23.79174     
      2500   355.36229     -27163.472     -26584.549      5208.1802      16.8189        12.842         24.11325     
      2600   336.58177     -27060.647     -17942.839      5277.6226      16.8189        12.842         24.43476     
      2700   405.917       -27077.577     -32052.549      5347.065       16.8189        12.842         24.75627     
      2800   359.92213     -26931.48      -31735.088      5416.5074      16.8189        12.842         25.07778     
      2900   416.39016     -26937.89      -32375.211      5485.9498      16.8189        12.842         25.39929     
      3000   434.69531     -26898.335     -21811.194      5555.3922      16.8189        12.842         25.7208      
      3100   346.52717     -26859.306     -25902.761      5624.8346      16.8189        12.842         26.04231     
      3200   370.80214     -26908.982     -29828.584      5694.277       16.8189        12.842         26.36382     
      3300   341.68748     -26872.096     -28091.918      5763.7194      16.8189        12.842         26.68533     
      3400   375.33805     -26883.31      -22112.456      5833.1618      16.8189        12.842         27.00684     
      3500   359.29145     -26824.288     -23181.611      5902.6042      16.8189        12.842         27.32835     
      3600   371.09469     -26895.004     -19579.59       5972.0466      16.8189        12.842         27.64986     
      3700   361.40472     -26923.041     -14627.718      6041.489       16.8189        12.842         27.97137     
      3800   317.91195     -26948.186     -16712.71       6110.9314      16.8189        12.842         28.29288     
      3900   324.19207     -26975.47      -17034.037      6180.3738      16.8189        12.842         28.61439     
      4000   355.5224      -26987.24      -13120.758      6249.8162      16.8189        12.842         28.9359      
      4100   323.52934     -26995.249     -10338.299      6319.2587      16.8189        12.842         29.25741     
      4200   357.06415     -27028.051     -16702.298      6388.7011      16.8189        12.842         29.57892     
      4300   315.21598     -27020.648     -9588.6523      6458.1435      16.8189        12.842         29.90043     
      4400   321.44348     -27071.601     -12422.463      6527.5859      16.8189        12.842         30.22194     
      4500   294.6431      -27088.047     -11589.841      6597.0283      16.8189        12.842         30.54345     
      4600   308.49206     -27097.856     -11266.951      6666.4707      16.8189        12.842         30.86496     
      4700   322.85951     -27115.428     -11715.76       6735.9131      16.8189        12.842         31.18647     
      4800   417.70506     -27245.687     -6246.3144      6805.3555      16.8189        12.842         31.50798     
      4900   391.78987     -27372.295     -1905.1842      6874.7979      16.8189        12.842         31.82949     
      5000   362.85421     -27441.354      43.454057      6944.2403      16.8189        12.842         32.151       
Loop time of 135.108 on 16 procs for 5000 steps with 274 atoms

Performance: 1.599 ns/day, 15.012 hours/ns, 37.008 timesteps/s, 10.140 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 74.204     | 88.998     | 100.38     |  82.0 | 65.87
Bond    | 0.001322   | 0.0015552  | 0.0018192  |   0.4 |  0.00
Neigh   | 5.5514     | 6.1121     | 6.726      |  14.0 |  4.52
Comm    | 9.5715     | 21.216     | 36.152     | 170.8 | 15.70
Output  | 0.028367   | 0.034698   | 0.038171   |   1.8 |  0.03
Modify  | 16.793     | 17.594     | 18.359     |  11.6 | 13.02
Other   |            | 1.151      |            |       |  0.85

Nlocal:          34.25 ave          56 max          13 min
Histogram: 1 2 0 0 1 1 0 1 0 2
Nghost:           1721 ave        2002 max        1467 min
Histogram: 1 2 1 0 0 0 1 1 1 1
Neighs:          10158 ave       17697 max        3519 min
Histogram: 1 1 2 1 0 0 0 1 0 2

Total # of neighbors = 81264
Ave neighs/atom = 296.58394
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 16.8189
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.4312)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.006 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*16.8189
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_p all deform 100 yz delta ${delta} remap v units box flip no
fix deform_p all deform 100 yz delta 16.8189 remap v units box flip no
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos4.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom 100 dump/pos4_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos4 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 112.3 | 114.4 | 116.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   327.1646      -27337.555     -12084.11       3472.1201      16.8189        12.842         16.0755      
       100   305.72993     -27285.976     -5329.4547      3472.1201      16.8189        12.842         16.0755      
       200   380.29578     -27170.337      1031.8997      3472.1201      16.8189        12.842         16.0755      
       300   488.12832     -27325.811     -8751.2907      3472.1201      16.8189        12.842         16.0755      
       400   428.58443     -27321.167     -5160.2338      3472.1201      16.8189        12.842         16.0755      
       500   403.32317     -27386.829     -3374.8991      3472.1201      16.8189        12.842         16.0755      
       600   410.47261     -27395.702     -1460.101       3472.1201      16.8189        12.842         16.0755      
       700   364.13303     -27424.44      -2032.5085      3472.1201      16.8189        12.842         16.0755      
       800   355.26934     -27487.041     -4394.1175      3472.1201      16.8189        12.842         16.0755      
       900   341.8813      -27504.201     -396.48839      3472.1201      16.8189        12.842         16.0755      
      1000   336.01401     -27516.44       1902.5128      3472.1201      16.8189        12.842         16.0755      
      1100   303.36392     -27499.146      828.08269      3472.1201      16.8189        12.842         16.0755      
      1200   337.37088     -27428.04      -6371.018       3472.1201      16.8189        12.842         16.0755      
      1300   376.77275     -27498.061     -3656.8907      3472.1201      16.8189        12.842         16.0755      
      1400   384.80669     -27533.36       2684.442       3472.1201      16.8189        12.842         16.0755      
      1500   383.45963     -27489.877     -6816.3212      3472.1201      16.8189        12.842         16.0755      
      1600   328.08555     -27502.567     -18852.709      3472.1201      16.8189        12.842         16.0755      
      1700   319.9835      -27484.838     -21278.051      3472.1201      16.8189        12.842         16.0755      
      1800   402.15236     -27596.18      -7587.1526      3472.1201      16.8189        12.842         16.0755      
      1900   381.11282     -27595.023     -5893.9371      3472.1201      16.8189        12.842         16.0755      
      2000   382.62566     -27666.228     -9581.49        3472.1201      16.8189        12.842         16.0755      
      2100   402.04331     -27694.977     -14478.394      3472.1201      16.8189        12.842         16.0755      
      2200   415.12941     -27652.447     -15457.212      3472.1201      16.8189        12.842         16.0755      
      2300   358.04846     -27657.949     -12316.06       3472.1201      16.8189        12.842         16.0755      
      2400   375.83684     -27640.9       -17994.017      3472.1201      16.8189        12.842         16.0755      
      2500   358.01121     -27640.065     -23482.419      3472.1201      16.8189        12.842         16.0755      
      2600   399.07698     -27634.2       -21700.759      3472.1201      16.8189        12.842         16.0755      
      2700   363.90504     -27619.217     -14965.167      3472.1201      16.8189        12.842         16.0755      
      2800   323.34698     -27596.87      -11809.668      3472.1201      16.8189        12.842         16.0755      
      2900   335.14873     -27609.841     -15600.985      3472.1201      16.8189        12.842         16.0755      
      3000   357.19775     -27583.345     -19453.744      3472.1201      16.8189        12.842         16.0755      
      3100   375.17479     -27629.766     -7074.1593      3472.1201      16.8189        12.842         16.0755      
      3200   390.8395      -27669.001     -18537.567      3472.1201      16.8189        12.842         16.0755      
      3300   368.54674     -27669.558     -11584.167      3472.1201      16.8189        12.842         16.0755      
      3400   330.66542     -27655.444     -27252.843      3472.1201      16.8189        12.842         16.0755      
      3500   354.91581     -27668.266     -23572.877      3472.1201      16.8189        12.842         16.0755      
      3600   404.04393     -27716.293     -19473.043      3472.1201      16.8189        12.842         16.0755      
      3700   390.55024     -27575.696     -18018.621      3472.1201      16.8189        12.842         16.0755      
      3800   372.4549      -27607.06      -18679.497      3472.1201      16.8189        12.842         16.0755      
      3900   349.25521     -27527.866     -20788.561      3472.1201      16.8189        12.842         16.0755      
      4000   355.33015     -27550.949     -21802.339      3472.1201      16.8189        12.842         16.0755      
      4100   338.65299     -27549.182     -19416.864      3472.1201      16.8189        12.842         16.0755      
      4200   360.47107     -27540.778     -10698.311      3472.1201      16.8189        12.842         16.0755      
      4300   350.20865     -27553.816     -17738.716      3472.1201      16.8189        12.842         16.0755      
      4400   339.58464     -27541.523     -20676.267      3472.1201      16.8189        12.842         16.0755      
      4500   375.70417     -27569.234     -8709.6573      3472.1201      16.8189        12.842         16.0755      
      4600   297.29185     -27556.206     -16362.42       3472.1201      16.8189        12.842         16.0755      
      4700   334.49372     -27588.97      -14307.7        3472.1201      16.8189        12.842         16.0755      
      4800   348.44788     -27535.888     -12641.825      3472.1201      16.8189        12.842         16.0755      
      4900   336.50607     -27552.259     -14705.586      3472.1201      16.8189        12.842         16.0755      
      5000   379.06591     -27643.37      -6127.2248      3472.1201      16.8189        12.842         16.0755      
Loop time of 220.691 on 16 procs for 5000 steps with 274 atoms

Performance: 0.979 ns/day, 24.521 hours/ns, 22.656 timesteps/s, 6.208 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 158.98     | 164.25     | 168.39     |  28.2 | 74.42
Bond    | 0.0014751  | 0.0017076  | 0.0019494  |   0.3 |  0.00
Neigh   | 12.753     | 13.239     | 13.602     |   7.5 |  6.00
Comm    | 17.316     | 21.542     | 26.98      |  78.5 |  9.76
Output  | 0.022523   | 0.026807   | 0.030389   |   1.7 |  0.01
Modify  | 20.036     | 20.541     | 21.199     |   7.6 |  9.31
Other   |            | 1.095      |            |       |  0.50

Nlocal:          34.25 ave          44 max          23 min
Histogram: 1 0 0 1 2 1 1 0 1 1
Nghost:        4381.88 ave        4531 max        4238 min
Histogram: 2 0 0 0 2 2 0 0 0 2
Neighs:        18904.1 ave       23711 max       12898 min
Histogram: 1 0 0 0 3 0 1 1 1 1

Total # of neighbors = 151233
Ave neighs/atom = 551.94526
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 12.842
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-1.195)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*12.842
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_p all deform 100 xz delta ${delta} remap v units box flip no
fix deform_p all deform 100 xz delta 12.842 remap v units box flip no
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos5.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom 100 dump/pos5_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos5 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 112.3 | 114.4 | 116.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   327.1646      -27337.555     -12084.11       3472.1201      16.8189        12.842         16.0755      
       100   300.32776     -27281.886     -5097.1977      3472.1201      16.8189        12.842         16.0755      
       200   357.14671     -27221.121      8538.5293      3472.1201      16.8189        12.842         16.0755      
       300   356.18401     -27276.606     -6588.7798      3472.1201      16.8189        12.842         16.0755      
       400   428.24008     -27356.348      2048.797       3472.1201      16.8189        12.842         16.0755      
       500   396.31362     -27332.827      359.86153      3472.1201      16.8189        12.842         16.0755      
       600   322.73123     -27307.489     -7876.9096      3472.1201      16.8189        12.842         16.0755      
       700   416.77734     -27425.221      8532.5661      3472.1201      16.8189        12.842         16.0755      
       800   376.76595     -27425.482      8913.9762      3472.1201      16.8189        12.842         16.0755      
       900   366.46921     -27425.567      796.86016      3472.1201      16.8189        12.842         16.0755      
      1000   433.13317     -27526.503      1643.9955      3472.1201      16.8189        12.842         16.0755      
      1100   387.09478     -27534.309      2995.7856      3472.1201      16.8189        12.842         16.0755      
      1200   318.58284     -27534.469     -4901.6431      3472.1201      16.8189        12.842         16.0755      
      1300   286.0459      -27517.632      529.15084      3472.1201      16.8189        12.842         16.0755      
      1400   310.52916     -27553.808     -6387.5646      3472.1201      16.8189        12.842         16.0755      
      1500   336.21225     -27596.842     -16615.511      3472.1201      16.8189        12.842         16.0755      
      1600   345.84961     -27642.948      26.957546      3472.1201      16.8189        12.842         16.0755      
      1700   370.15542     -27673.131     -636.0886       3472.1201      16.8189        12.842         16.0755      
      1800   360.28316     -27691.23      -7512.9642      3472.1201      16.8189        12.842         16.0755      
      1900   315.92698     -27684.776      470.90014      3472.1201      16.8189        12.842         16.0755      
      2000   315.25643     -27712.442     -9307.4872      3472.1201      16.8189        12.842         16.0755      
      2100   310.10644     -27735.177     -4237.6037      3472.1201      16.8189        12.842         16.0755      
      2200   375.86713     -27809.181     -2674.0598      3472.1201      16.8189        12.842         16.0755      
      2300   295.22185     -27740.647     -2256.2807      3472.1201      16.8189        12.842         16.0755      
      2400   369.26954     -27813.725     -6912.4323      3472.1201      16.8189        12.842         16.0755      
      2500   307.89903     -27828.795     -8792.3036      3472.1201      16.8189        12.842         16.0755      
      2600   319.03375     -27842.495      7390.7714      3472.1201      16.8189        12.842         16.0755      
      2700   324.20607     -27845.301      247.29783      3472.1201      16.8189        12.842         16.0755      
      2800   328.9866      -27832.265     -6708.564       3472.1201      16.8189        12.842         16.0755      
      2900   268.48617     -27771.862     -187.41624      3472.1201      16.8189        12.842         16.0755      
      3000   329.86689     -27800.987     -5172.4844      3472.1201      16.8189        12.842         16.0755      
      3100   359.77586     -27824.757     -12006.038      3472.1201      16.8189        12.842         16.0755      
      3200   337.37259     -27793.077      569.6604       3472.1201      16.8189        12.842         16.0755      
      3300   334.65676     -27792.061     -1089.1056      3472.1201      16.8189        12.842         16.0755      
      3400   321.21259     -27736.545     -406.80992      3472.1201      16.8189        12.842         16.0755      
      3500   373.71242     -27774.719     -6846.1983      3472.1201      16.8189        12.842         16.0755      
      3600   304.01875     -27709.021     -3776.4018      3472.1201      16.8189        12.842         16.0755      
      3700   335.54135     -27688.626     -15706.382      3472.1201      16.8189        12.842         16.0755      
      3800   355.17995     -27745.144     -10766.44       3472.1201      16.8189        12.842         16.0755      
      3900   305.26914     -27695.088     -807.63678      3472.1201      16.8189        12.842         16.0755      
      4000   308.35668     -27714.54       1326.3552      3472.1201      16.8189        12.842         16.0755      
      4100   310.11448     -27717.747      3179.617       3472.1201      16.8189        12.842         16.0755      
      4200   357.87222     -27764.154      1524.1481      3472.1201      16.8189        12.842         16.0755      
      4300   311.5785      -27709.358     -14005.921      3472.1201      16.8189        12.842         16.0755      
      4400   316.40783     -27743.845     -7797.2381      3472.1201      16.8189        12.842         16.0755      
      4500   366.02751     -27783.121     -12937.205      3472.1201      16.8189        12.842         16.0755      
      4600   372.65346     -27796.911     -12930.814      3472.1201      16.8189        12.842         16.0755      
      4700   305.57926     -27753.05      -10083.33       3472.1201      16.8189        12.842         16.0755      
      4800   297.43121     -27737.654      4575.9122      3472.1201      16.8189        12.842         16.0755      
      4900   331.337       -27767.323     -3765.6753      3472.1201      16.8189        12.842         16.0755      
      5000   322.8398      -27718.126     -16631.187      3472.1201      16.8189        12.842         16.0755      
Loop time of 202.719 on 16 procs for 5000 steps with 274 atoms

Performance: 1.066 ns/day, 22.524 hours/ns, 24.665 timesteps/s, 6.758 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 142.7      | 148.95     | 157.63     |  46.5 | 73.48
Bond    | 0.0014616  | 0.0017364  | 0.0020483  |   0.4 |  0.00
Neigh   | 10.747     | 11.121     | 11.512     |   9.0 |  5.49
Comm    | 14.113     | 22.587     | 28.729     | 119.3 | 11.14
Output  | 0.026521   | 0.03086    | 0.034344   |   1.6 |  0.02
Modify  | 18.488     | 19.028     | 19.562     |   8.8 |  9.39
Other   |            | 1.003      |            |       |  0.49

Nlocal:          34.25 ave          43 max          20 min
Histogram: 1 1 0 0 0 1 1 0 2 2
Nghost:        3345.75 ave        3441 max        3236 min
Histogram: 2 1 1 0 0 0 0 0 2 2
Neighs:        18865.4 ave       23482 max       11256 min
Histogram: 1 1 0 0 0 1 1 0 2 2

Total # of neighbors = 150923
Ave neighs/atom = 550.81387
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 16.0755
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--8.3798)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*16.0755
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_p all deform 100 xy delta ${delta} remap v units box flip no
fix deform_p all deform 100 xy delta 16.0755 remap v units box flip no

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos6.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom 100 dump/pos6_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos6 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 112.3 | 114.4 | 116.1 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   327.1646      -27337.555     -12084.11       3472.1201      16.8189        12.842         16.0755      
       100   304.12055     -27286.887     -5358.6746      3472.1201      16.8189        12.842         16.0755      
       200   375.74793     -27226.989     -9070.1601      3472.1201      16.8189        12.842         16.0755      
       300   428.68972     -27245.606     -12378.88       3472.1201      16.8189        12.842         16.0755      
       400   447.65929     -27277.72      -7120.415       3472.1201      16.8189        12.842         16.0755      
       500   485.34549     -27240.892     -11777.093      3472.1201      16.8189        12.842         16.0755      
       600   453.24971     -27223.664     -1145.0844      3472.1201      16.8189        12.842         16.0755      
       700   442.24123     -27200.867     -260.99203      3472.1201      16.8189        12.842         16.0755      
       800   394.97747     -27206.518      482.01622      3472.1201      16.8189        12.842         16.0755      
       900   458.2265      -27192.004     -2751.01        3472.1201      16.8189        12.842         16.0755      
      1000   385.92797     -27232.615      2899.2539      3472.1201      16.8189        12.842         16.0755      
      1100   389.37228     -27211.386     -2334.2558      3472.1201      16.8189        12.842         16.0755      
      1200   414.46347     -27170.963     -7550.2733      3472.1201      16.8189        12.842         16.0755      
      1300   396.81061     -27187.404     -758.832        3472.1201      16.8189        12.842         16.0755      
      1400   391.39903     -27220.042      4793.7235      3472.1201      16.8189        12.842         16.0755      
      1500   361.72131     -27194.27      -8670.1055      3472.1201      16.8189        12.842         16.0755      
      1600   384.45849     -27173.599     -21540.553      3472.1201      16.8189        12.842         16.0755      
      1700   361.96518     -27080.072     -28502.958      3472.1201      16.8189        12.842         16.0755      
      1800   413.22003     -27162.338      3448.7919      3472.1201      16.8189        12.842         16.0755      
      1900   461.45285     -27235.429      4256.9174      3472.1201      16.8189        12.842         16.0755      
      2000   442.62026     -27319.963     -425.16724      3472.1201      16.8189        12.842         16.0755      
      2100   352.97817     -27319.045     -1954.6557      3472.1201      16.8189        12.842         16.0755      
      2200   368.38555     -27342.189     -746.31155      3472.1201      16.8189        12.842         16.0755      
      2300   355.76396     -27381.979      2898.3054      3472.1201      16.8189        12.842         16.0755      
      2400   317.18849     -27385.531     -6410.7446      3472.1201      16.8189        12.842         16.0755      
      2500   419.4         -27479.709      3563.8631      3472.1201      16.8189        12.842         16.0755      
      2600   373.66063     -27503.187      3627.6847      3472.1201      16.8189        12.842         16.0755      
      2700   301.88631     -27481.781     -11414.179      3472.1201      16.8189        12.842         16.0755      
      2800   283.84907     -27486.566      78.939264      3472.1201      16.8189        12.842         16.0755      
      2900   296.89197     -27523.015      6424.3383      3472.1201      16.8189        12.842         16.0755      
      3000   312.55261     -27536.463     -4889.3129      3472.1201      16.8189        12.842         16.0755      
      3100   309.83226     -27547.834      3722.6154      3472.1201      16.8189        12.842         16.0755      
      3200   308.60892     -27563.845      5632.0397      3472.1201      16.8189        12.842         16.0755      
      3300   312.4351      -27529.096     -3000.657       3472.1201      16.8189        12.842         16.0755      
      3400   335.85743     -27530.524      12454.384      3472.1201      16.8189        12.842         16.0755      
      3500   330.14268     -27551.874     -2324.0108      3472.1201      16.8189        12.842         16.0755      
      3600   323.08016     -27568.963     -12596.011      3472.1201      16.8189        12.842         16.0755      
      3700   330.43888     -27627.392     -4566.3898      3472.1201      16.8189        12.842         16.0755      
      3800   293.35822     -27634.596      15488.541      3472.1201      16.8189        12.842         16.0755      
      3900   266.70909     -27613.795      12717.074      3472.1201      16.8189        12.842         16.0755      
      4000   300.94408     -27627.431      10574.028      3472.1201      16.8189        12.842         16.0755      
      4100   282.65216     -27635.777      3348.9806      3472.1201      16.8189        12.842         16.0755      
      4200   465.56922     -27645.186      2242.6871      3472.1201      16.8189        12.842         16.0755      
      4300   378.78084     -27637.289     -14494.433      3472.1201      16.8189        12.842         16.0755      
      4400   353.82676     -27676.44      -552.72827      3472.1201      16.8189        12.842         16.0755      
      4500   310.3319      -27719.35      -6637.4552      3472.1201      16.8189        12.842         16.0755      
      4600   314.39676     -27741.995     -1746.472       3472.1201      16.8189        12.842         16.0755      
      4700   363.00428     -27739.578      15663.725      3472.1201      16.8189        12.842         16.0755      
      4800   318.57803     -27765.194      25657.48       3472.1201      16.8189        12.842         16.0755      
      4900   346.53857     -27827.941      6856.1987      3472.1201      16.8189        12.842         16.0755      
      5000   350.4086      -27876.458      12158.236      3472.1201      16.8189        12.842         16.0755      
Loop time of 169.871 on 16 procs for 5000 steps with 274 atoms

Performance: 1.272 ns/day, 18.875 hours/ns, 29.434 timesteps/s, 8.065 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 106.96     | 124.37     | 132.78     |  81.7 | 73.21
Bond    | 0.0013645  | 0.0016193  | 0.0020851  |   0.5 |  0.00
Neigh   | 8.2706     | 9.4332     | 9.9578     |  20.7 |  5.55
Comm    | 9.2549     | 17.585     | 34.957     | 216.2 | 10.35
Output  | 0.018944   | 0.02217    | 0.024819   |   1.4 |  0.01
Modify  | 17.188     | 17.812     | 18.843     |  13.4 | 10.49
Other   |            | 0.6491     |            |       |  0.38

Nlocal:          34.25 ave          41 max          22 min
Histogram: 1 0 0 0 1 1 1 2 1 1
Nghost:         2763.5 ave        2833 max        2705 min
Histogram: 3 1 0 0 0 0 1 1 0 2
Neighs:        18851.4 ave       22207 max       12464 min
Histogram: 1 0 0 0 1 0 1 2 1 2

Total # of neighbors = 150811
Ave neighs/atom = 550.40511
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:19:35
