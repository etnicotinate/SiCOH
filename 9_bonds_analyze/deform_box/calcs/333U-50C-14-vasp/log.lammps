LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 100
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 50
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 1.0                  # the deformation magnitude 0.01

variable FF string "SiOCHN_2018.ff C H O Si"   # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si
variable structure string 333U-50C-14-vasp

# Read the initial sctructure
# box tilt large
read_data       ${structure}.data
read_data       333U-50C-14-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.006 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
fix bondinfo all reaxff/bonds 1 bonds_opt.reaxff

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
dump dump_opt all custom 1 dump/dump_opt.lammpstrj id type q x y z
minimize 1.0e-6 1.0e-6 100 1000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -4.92 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 139 | 140.2 | 141.6 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0             -33205.282      0             -33205.282      147799.14    
        29   0             -36311.508      0             -36311.508     -9301.2377    
Loop time of 2.96971 on 16 procs for 29 steps with 371 atoms

97.5% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
     -33205.2820362318  -36311.4827525602  -36311.5075094102
  Force two-norm initial, final = 4390.0473 146.81963
  Force max component initial, final = 1049.7545 45.103186
  Final line search alpha, max atom move = 0.0023498815 0.10598714
  Iterations, force evaluations = 29 61

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 1.8191     | 2.1287     | 2.2925     |  12.0 | 71.68
Bond    | 2.7116e-05 | 3.4095e-05 | 3.9667e-05 |   0.0 |  0.00
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.078215   | 0.24188    | 0.55172    |  35.5 |  8.14
Output  | 0.0060302  | 0.0087826  | 0.011428   |   1.9 |  0.30
Modify  | 0.58284    | 0.5831     | 0.58326    |   0.0 | 19.63
Other   |            | 0.007166   |            |       |  0.24

Nlocal:         46.375 ave          56 max          42 min
Histogram: 5 0 0 0 0 1 0 1 0 1
Nghost:        3405.88 ave        3455 max        3357 min
Histogram: 1 0 2 1 0 1 0 1 1 1
Neighs:        28984.4 ave       34744 max       26288 min
Histogram: 5 0 0 0 0 1 0 1 0 1

Total # of neighbors = 231875
Ave neighs/atom = 625
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-14-vasp_opt.data
System init for write_data ...
undump dump_opt
unfix bondinfo
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
dump dump_eq all custom ${nthermo} dump/dump_eq.lammpstrj id type q x y z
dump dump_eq all custom 100 dump/dump_eq.lammpstrj id type q x y z

# compute MSD
compute msd1 all msd
fix myMSD all ave/time ${nevery} ${nrepeat} ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 ${nrepeat} ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 10 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 10 100 c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out

run ${nequil}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 132.8 | 134 | 135.5 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -36311.507     -5645.0898      1.6093426      4136.956     
       100   221.9545      -36185.943     -4322.2698      1.6093426      4136.956     
       200   253.10467     -36157.659     -5472.0482      1.6093426      4136.956     
       300   318.19431     -36170.823     -3675.0132      1.6093426      4136.956     
       400   353.07209     -36247.078      5277.68        1.6093426      4136.956     
       500   365.55027     -36381.411      13949.272      1.6093426      4136.956     
       600   371.5621      -36502.327     -1806.8626      1.6093426      4136.956     
       700   344.50521     -36584.359      676.0044       1.6093426      4136.956     
       800   316.1462      -36642.896     -3791.4738      1.6093426      4136.956     
       900   305.37306     -36711.061      7009.4114      1.6093426      4136.956     
      1000   340.11777     -36842.988     -4213.2797      1.6093426      4136.956     
      1100   287.70353     -36860.21      -5634.5546      1.6093426      4136.956     
      1200   304.64586     -36918.546     -7670.5187      1.6093426      4136.956     
      1300   313.54265     -36957.707      2502.7004      1.6093426      4136.956     
      1400   297.06458     -36978.076     -1154.5262      1.6093426      4136.956     
      1500   286.59206     -36997.495      8432.2169      1.6093426      4136.956     
      1600   289.21053     -37007.131      6294.8731      1.6093426      4136.956     
      1700   307.28674     -37034.215     -7371.3655      1.6093426      4136.956     
      1800   310.23119     -37086.811      6328.578       1.6093426      4136.956     
      1900   297.04006     -37100.491      3248.39        1.6093426      4136.956     
      2000   275.15704     -37080.509      7055.7354      1.6093426      4136.956     
      2100   314.34974     -37100.367      5047.8436      1.6093426      4136.956     
      2200   325.4685      -37104.218     -550.52955      1.6093426      4136.956     
      2300   323.17874     -37139.31      -3247.0204      1.6093426      4136.956     
      2400   304.00507     -37160.642     -4553.5623      1.6093426      4136.956     
      2500   285.74343     -37167.371     -13134.682      1.6093426      4136.956     
      2600   261.86345     -37131.647     -1356.4581      1.6093426      4136.956     
      2700   285.57394     -37125.036      843.65213      1.6093426      4136.956     
      2800   322.8743      -37151.016      3050.675       1.6093426      4136.956     
      2900   292.22202     -37140.405      4045.9128      1.6093426      4136.956     
      3000   297.60787     -37161.426     -5999.6717      1.6093426      4136.956     
      3100   308.77319     -37177.112      1246.7677      1.6093426      4136.956     
      3200   311.45412     -37205.141      1641.762       1.6093426      4136.956     
      3300   306.82643     -37230.564      12304.077      1.6093426      4136.956     
      3400   293.9371      -37217.897     -2952.9014      1.6093426      4136.956     
      3500   315.71002     -37242.402     -1266.4109      1.6093426      4136.956     
      3600   307.36788     -37256.068      9379.0903      1.6093426      4136.956     
      3700   328.44846     -37309.373      5892.1033      1.6093426      4136.956     
      3800   309.88503     -37315.906      2651.5249      1.6093426      4136.956     
      3900   292.84422     -37309.487      6366.7432      1.6093426      4136.956     
      4000   311.86432     -37339.609     -6516.5011      1.6093426      4136.956     
      4100   295.74978     -37343.591      12116.096      1.6093426      4136.956     
      4200   289.56823     -37350.786     -14490.992      1.6093426      4136.956     
      4300   275.82906     -37353.263      8943.9884      1.6093426      4136.956     
      4400   307.85004     -37377.365      6375.2654      1.6093426      4136.956     
      4500   300.55719     -37339.965      3677.6525      1.6093426      4136.956     
      4600   317.32966     -37352.14       13809.662      1.6093426      4136.956     
      4700   307.91743     -37366.31       9059.341       1.6093426      4136.956     
      4800   314.83626     -37389.994      12919.737      1.6093426      4136.956     
      4900   285.02396     -37380.382      6768.8047      1.6093426      4136.956     
      5000   283.89497     -37388.901     -11905.736      1.6093426      4136.956     
Loop time of 238.551 on 16 procs for 5000 steps with 371 atoms

Performance: 0.905 ns/day, 26.506 hours/ns, 20.960 timesteps/s, 7.776 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 178.39     | 180.92     | 185.88     |  18.3 | 75.84
Bond    | 0.0015503  | 0.0018027  | 0.0020497  |   0.5 |  0.00
Neigh   | 13.074     | 13.417     | 13.68      |   5.8 |  5.62
Comm    | 16.31      | 21.31      | 23.894     |  53.3 |  8.93
Output  | 0.030679   | 0.037146   | 0.044118   |   2.1 |  0.02
Modify  | 21.453     | 21.875     | 22.291     |   5.6 |  9.17
Other   |            | 0.9857     |            |       |  0.41

Nlocal:         46.375 ave          51 max          42 min
Histogram: 1 1 1 0 0 1 3 0 0 1
Nghost:         3406.5 ave        3452 max        3351 min
Histogram: 1 1 0 1 0 1 1 1 0 2
Neighs:        28943.4 ave       31762 max       26442 min
Histogram: 1 1 1 0 0 1 3 0 0 1

Total # of neighbors = 231547
Ave neighs/atom = 624.1159
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333U-50C-14-vasp_eq.data
System init for write_data ...
undump dump_eq
unfix myMSD

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 17.3186
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 12.8149
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 18.6403

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.2054
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 0.4589
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -8.851

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 17.3186
variable dlen equal lx-${len0}
variable dlen equal lx-17.3186
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*17.3186
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 17.3186 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 17.3186 xy delta -8.851 xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 17.3186 xy delta -8.851 xz delta 0.4589 remap v units box flip no
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos1.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom 100 dump/pos1_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos1 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136 | 138.5 | 140 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   283.89497     -37388.901     -11905.33       4136.956       17.3186        12.8149        18.6403      
       100   304.64982     -37408.043     -776.86208      4219.6951      17.664972      12.8149        18.6403      
       200   420.98348     -37261.488     -14577.202      4302.4342      18.011344      12.8149        18.6403      
       300   469.41697     -37224.237      288.12819      4385.1734      18.357716      12.8149        18.6403      
       400   471.99725     -37214.452     -7493.56        4467.9125      18.704088      12.8149        18.6403      
       500   460.57705     -37228.291     -6687.1482      4550.6516      19.05046       12.8149        18.6403      
       600   450.71315     -37257.88      -10525.708      4633.3907      19.396832      12.8149        18.6403      
       700   436.05221     -37177.798      8286.6653      4716.1298      19.743204      12.8149        18.6403      
       800   455.13698     -37234.82      -4607.6824      4798.8689      20.089576      12.8149        18.6403      
       900   372.07702     -37200.444      1840.5507      4881.6081      20.435948      12.8149        18.6403      
      1000   391.34676     -37199.869     -9926.8957      4964.3472      20.78232       12.8149        18.6403      
      1100   429.45069     -37254.357     -17443.151      5047.0863      21.128692      12.8149        18.6403      
      1200   371.80309     -37204.239     -7181.161       5129.8254      21.475064      12.8149        18.6403      
      1300   389.30804     -37231.078     -13442.025      5212.5645      21.821436      12.8149        18.6403      
      1400   407.97977     -37249.634     -23433.736      5295.3037      22.167808      12.8149        18.6403      
      1500   341.48264     -37200.935     -25304.517      5378.0428      22.51418       12.8149        18.6403      
      1600   367.34584     -37159.15      -32979.896      5460.7819      22.860552      12.8149        18.6403      
      1700   393.11688     -37133.882     -14213.777      5543.521       23.206924      12.8149        18.6403      
      1800   341.98393     -37158.408     -11378.312      5626.2601      23.553296      12.8149        18.6403      
      1900   362.52014     -37182.776     -22563.917      5708.9993      23.899668      12.8149        18.6403      
      2000   405.48679     -37193.671     -15693.224      5791.7384      24.24604       12.8149        18.6403      
      2100   401.86286     -37182.907     -20866.752      5874.4775      24.592412      12.8149        18.6403      
      2200   357.80309     -37189.606     -20017.197      5957.2166      24.938784      12.8149        18.6403      
      2300   385.48037     -37215.687     -17615.199      6039.9557      25.285156      12.8149        18.6403      
      2400   379.79389     -37289.916     -15522.628      6122.6949      25.631528      12.8149        18.6403      
      2500   391.26785     -37381.505     -12091.051      6205.434       25.9779        12.8149        18.6403      
      2600   383.81209     -37423.27      -3076.6682      6288.1731      26.324272      12.8149        18.6403      
      2700   325.04092     -37467.882      2385.6761      6370.9122      26.670644      12.8149        18.6403      
      2800   332.66125     -37538.492     -3594.3827      6453.6513      27.017016      12.8149        18.6403      
      2900   373.912       -37629.076     -7234.3138      6536.3905      27.363388      12.8149        18.6403      
      3000   335.86739     -37677.145     -10307.218      6619.1296      27.70976       12.8149        18.6403      
      3100   324.84068     -37697.474     -7075.3898      6701.8687      28.056132      12.8149        18.6403      
      3200   308.39482     -37694.629     -3570.537       6784.6078      28.402504      12.8149        18.6403      
      3300   306.73182     -37653.704      2870.1697      6867.3469      28.748876      12.8149        18.6403      
      3400   303.44201     -37630.866     -2287.4211      6950.0861      29.095248      12.8149        18.6403      
      3500   338.83708     -37663.404     -1098.8072      7032.8252      29.44162       12.8149        18.6403      
      3600   323.4198      -37692.785      2551.6199      7115.5643      29.787992      12.8149        18.6403      
      3700   328.33001     -37679.218     -5871.1195      7198.3034      30.134364      12.8149        18.6403      
      3800   343.64301     -37689.592     -554.01937      7281.0425      30.480736      12.8149        18.6403      
      3900   273.00187     -37604.329     -10649.896      7363.7817      30.827108      12.8149        18.6403      
      4000   287.18196     -37606.025     -3027.0968      7446.5208      31.17348       12.8149        18.6403      
      4100   305.18928     -37601.236     -5132.5779      7529.2599      31.519852      12.8149        18.6403      
      4200   356.22936     -37642.361     -7683.3281      7611.999       31.866224      12.8149        18.6403      
      4300   363.85117     -37656.698     -9186.1881      7694.7381      32.212596      12.8149        18.6403      
      4400   349.07747     -37646.809     -7090.5864      7777.4773      32.558968      12.8149        18.6403      
      4500   398.80489     -37602.632     -8348.1602      7860.2164      32.90534       12.8149        18.6403      
      4600   381.97102     -37637.263     -5573.8695      7942.9555      33.251712      12.8149        18.6403      
      4700   334.13718     -37568.47      -9714.1123      8025.6946      33.598084      12.8149        18.6403      
      4800   399.50169     -37609.062     -11032.147      8108.4337      33.944456      12.8149        18.6403      
      4900   306.86296     -37511.088     -6001.888       8191.1729      34.290828      12.8149        18.6403      
      5000   367.2621      -37584.79      -5965.3661      8273.912       34.6372        12.8149        18.6403      
Loop time of 181.875 on 16 procs for 5000 steps with 371 atoms

Performance: 1.188 ns/day, 20.208 hours/ns, 27.491 timesteps/s, 10.199 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 124.15     | 132.54     | 139.22     |  37.9 | 72.87
Bond    | 0.001469   | 0.0017944  | 0.0020568  |   0.5 |  0.00
Neigh   | 8.3917     | 8.7433     | 9.0784     |   7.3 |  4.81
Comm    | 12.652     | 19.365     | 27.661     |  98.2 | 10.65
Output  | 0.029861   | 0.040971   | 0.04827    |   2.8 |  0.02
Modify  | 19.696     | 20.017     | 20.278     |   4.7 | 11.01
Other   |            | 1.168      |            |       |  0.64

Nlocal:         46.375 ave          59 max          35 min
Histogram: 1 1 1 2 0 0 0 1 1 1
Nghost:        2646.88 ave        2795 max        2510 min
Histogram: 1 0 1 2 0 1 1 1 0 1
Neighs:        14597.5 ave       17353 max       11692 min
Histogram: 1 1 0 2 0 1 0 0 2 1

Total # of neighbors = 116780
Ave neighs/atom = 314.77089
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 12.8149
variable dlen equal ly-${len0}
variable dlen equal ly-12.8149
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*12.8149
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 12.8149 yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 12.8149 yz delta 0.2054 remap v units box flip no
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos2.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom 100 dump/pos2_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos2 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136 | 138.5 | 140 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   283.89497     -37388.901     -11905.33       4136.956       17.3186        12.8149        18.6403      
       100   305.01178     -37406.878      121.04671      4219.6951      17.3186        13.071198      18.6403      
       200   389.21454     -37297.405     -14312.604      4302.4342      17.3186        13.327496      18.6403      
       300   476.53793     -37265.356      1020.5086      4385.1734      17.3186        13.583794      18.6403      
       400   487.52377     -37293.696     -18502.491      4467.9125      17.3186        13.840092      18.6403      
       500   493.67387     -37294.089     -13091.809      4550.6516      17.3186        14.09639       18.6403      
       600   397.62346     -37262.005     -1446.8478      4633.3907      17.3186        14.352688      18.6403      
       700   393.00073     -37267.382     -2882.6         4716.1298      17.3186        14.608986      18.6403      
       800   408.00666     -37282.78      -1728.5187      4798.8689      17.3186        14.865284      18.6403      
       900   356.64254     -37223.151     -4277.7429      4881.6081      17.3186        15.121582      18.6403      
      1000   361.66564     -37228.714     -4915.0838      4964.3472      17.3186        15.37788       18.6403      
      1100   378.90388     -37280.274     -10198.287      5047.0863      17.3186        15.634178      18.6403      
      1200   342.90492     -37247.069     -4988.816       5129.8254      17.3186        15.890476      18.6403      
      1300   381.29381     -37279.321     -6561.7789      5212.5645      17.3186        16.146774      18.6403      
      1400   407.78323     -37299.622     -11751.076      5295.3037      17.3186        16.403072      18.6403      
      1500   364.00287     -37222.674     -14955.323      5378.0428      17.3186        16.65937       18.6403      
      1600   352.45607     -37162.205     -14762.421      5460.7819      17.3186        16.915668      18.6403      
      1700   358.54099     -37219.554     -4220.4252      5543.521       17.3186        17.171966      18.6403      
      1800   328.2532      -37208.376     -18507.966      5626.2601      17.3186        17.428264      18.6403      
      1900   385.6093      -37249.087     -1938.3006      5708.9993      17.3186        17.684562      18.6403      
      2000   353.95576     -37247.11      -10054.151      5791.7384      17.3186        17.94086       18.6403      
      2100   379.23209     -37281.415     -5286.891       5874.4775      17.3186        18.197158      18.6403      
      2200   418.22868     -37319.88      -9689.3763      5957.2166      17.3186        18.453456      18.6403      
      2300   340.74325     -37263.35      -10096.963      6039.9557      17.3186        18.709754      18.6403      
      2400   341.7639      -37216.11      -14956.181      6122.6949      17.3186        18.966052      18.6403      
      2500   379.11851     -37280.998     -17267.087      6205.434       17.3186        19.22235       18.6403      
      2600   297.63657     -37224.127     -19390.474      6288.1731      17.3186        19.478648      18.6403      
      2700   340.73534     -37267.072     -18485.82       6370.9122      17.3186        19.734946      18.6403      
      2800   354.80831     -37243.061     -9774.3307      6453.6513      17.3186        19.991244      18.6403      
      2900   363.89774     -37277.602     -16140.032      6536.3905      17.3186        20.247542      18.6403      
      3000   352.34307     -37243.089     -16644.832      6619.1296      17.3186        20.50384       18.6403      
      3100   341.43155     -37182.102     -19993.597      6701.8687      17.3186        20.760138      18.6403      
      3200   286.17331     -37188.167     -13490.378      6784.6078      17.3186        21.016436      18.6403      
      3300   297.94068     -37192.774     -19017.343      6867.3469      17.3186        21.272734      18.6403      
      3400   326.55891     -37226.485     -12077.276      6950.0861      17.3186        21.529032      18.6403      
      3500   353.86908     -37291.077     -5976.9591      7032.8252      17.3186        21.78533       18.6403      
      3600   347.64634     -37301.57      -11560.575      7115.5643      17.3186        22.041628      18.6403      
      3700   330.49623     -37269.802     -13479.625      7198.3034      17.3186        22.297926      18.6403      
      3800   297.99482     -37238.781     -15446.583      7281.0425      17.3186        22.554224      18.6403      
      3900   301.33037     -37223.63      -12307.529      7363.7817      17.3186        22.810522      18.6403      
      4000   351.31467     -37315.353     -8137.2409      7446.5208      17.3186        23.06682       18.6403      
      4100   366.95557     -37359.989     -5639.2941      7529.2599      17.3186        23.323118      18.6403      
      4200   351.07685     -37404.58      -3991.4344      7611.999       17.3186        23.579416      18.6403      
      4300   348.90547     -37442.377     -8390.849       7694.7381      17.3186        23.835714      18.6403      
      4400   312.14095     -37398.438     -8389.3839      7777.4773      17.3186        24.092012      18.6403      
      4500   349.93624     -37454.488     -7611.3408      7860.2164      17.3186        24.34831       18.6403      
      4600   312.75325     -37460.305     -6938.4297      7942.9555      17.3186        24.604608      18.6403      
      4700   300.01007     -37484.094     -2746.6093      8025.6946      17.3186        24.860906      18.6403      
      4800   269.00923     -37473.467     -4560.997       8108.4337      17.3186        25.117204      18.6403      
      4900   283.82773     -37456.601     -2859.0374      8191.1729      17.3186        25.373502      18.6403      
      5000   282.89684     -37438.186     -7492.538       8273.912       17.3186        25.6298        18.6403      
Loop time of 159.714 on 16 procs for 5000 steps with 371 atoms

Performance: 1.352 ns/day, 17.746 hours/ns, 31.306 timesteps/s, 11.614 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 110.64     | 114.8      | 118.57     |  20.5 | 71.88
Bond    | 0.0014521  | 0.0017517  | 0.002115   |   0.6 |  0.00
Neigh   | 7.5981     | 7.8948     | 8.0877     |   5.3 |  4.94
Comm    | 12.803     | 16.357     | 20.421     |  52.5 | 10.24
Output  | 0.029674   | 0.037031   | 0.04273    |   2.0 |  0.02
Modify  | 19.229     | 19.436     | 19.697     |   3.3 | 12.17
Other   |            | 1.185      |            |       |  0.74

Nlocal:         46.375 ave          85 max          30 min
Histogram: 3 1 1 0 2 0 0 0 0 1
Nghost:           1849 ave        2072 max        1591 min
Histogram: 1 1 2 0 0 0 0 0 2 2
Neighs:        14455.5 ave       26746 max        8368 min
Histogram: 3 1 0 1 1 1 0 0 0 1

Total # of neighbors = 115644
Ave neighs/atom = 311.70889
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 18.6403
variable dlen equal lz-${len0}
variable dlen equal lz-18.6403
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*18.6403
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 18.6403 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos3.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom 100 dump/pos3_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos3 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136 | 138.5 | 140 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   283.89497     -37388.901     -11905.33       4136.956       17.3186        12.8149        18.6403      
       100   305.01781     -37407.909     -1.2238879      4219.6951      17.3186        12.8149        19.013106    
       200   447.37295     -37270.372     -10806.863      4302.4342      17.3186        12.8149        19.385912    
       300   481.74096     -37253.3       -1947.6809      4385.1734      17.3186        12.8149        19.758718    
       400   499.43983     -37256.858     -6618.8799      4467.9125      17.3186        12.8149        20.131524    
       500   481.62408     -37226.438     -10973.743      4550.6516      17.3186        12.8149        20.50433     
       600   429.90953     -37171.299      2652.3157      4633.3907      17.3186        12.8149        20.877136    
       700   460.19435     -37169.448     -13418.682      4716.1298      17.3186        12.8149        21.249942    
       800   438.17809     -37126.435     -7654.3779      4798.8689      17.3186        12.8149        21.622748    
       900   430.54997     -37146.939     -13349.875      4881.6081      17.3186        12.8149        21.995554    
      1000   433.65391     -37132.126     -19002.354      4964.3472      17.3186        12.8149        22.36836     
      1100   438.1331      -37154.639     -14482.845      5047.0863      17.3186        12.8149        22.741166    
      1200   413.09432     -37100.774     -26256.5        5129.8254      17.3186        12.8149        23.113972    
      1300   396.28579     -37025.379     -29639.139      5212.5645      17.3186        12.8149        23.486778    
      1400   380.03031     -37061.933     -37374.592      5295.3037      17.3186        12.8149        23.859584    
      1500   357.94522     -36906.713     -32332.779      5378.0428      17.3186        12.8149        24.23239     
      1600   355.99323     -36874.741     -35190.698      5460.7819      17.3186        12.8149        24.605196    
      1700   353.97992     -36768.314     -29240.757      5543.521       17.3186        12.8149        24.978002    
      1800   491.7294      -36849.08      -17887.646      5626.2601      17.3186        12.8149        25.350808    
      1900   462.25357     -36870.063     -20780.861      5708.9993      17.3186        12.8149        25.723614    
      2000   425.55625     -36896.63      -20701.418      5791.7384      17.3186        12.8149        26.09642     
      2100   480.19456     -36944.473     -22877.581      5874.4775      17.3186        12.8149        26.469226    
      2200   353.94061     -36834.094     -28463.13       5957.2166      17.3186        12.8149        26.842032    
      2300   401.7511      -36895.244     -28022.332      6039.9557      17.3186        12.8149        27.214838    
      2400   330.33488     -36870.368     -26885.681      6122.6949      17.3186        12.8149        27.587644    
      2500   281.29328     -36856.113     -19398.189      6205.434       17.3186        12.8149        27.96045     
      2600   314.63473     -36895.054     -14607.955      6288.1731      17.3186        12.8149        28.333256    
      2700   364.00035     -37001.622     -9590.2848      6370.9122      17.3186        12.8149        28.706062    
      2800   315.25361     -37040.723     -11230.212      6453.6513      17.3186        12.8149        29.078868    
      2900   329.44036     -37068.68      -16003.403      6536.3905      17.3186        12.8149        29.451674    
      3000   298.96355     -37034.111     -18732.161      6619.1296      17.3186        12.8149        29.82448     
      3100   384.68637     -37076.19      -12115.265      6701.8687      17.3186        12.8149        30.197286    
      3200   360.35113     -37072.715     -8103.9042      6784.6078      17.3186        12.8149        30.570092    
      3300   365.30443     -37213.62      -6734.1182      6867.3469      17.3186        12.8149        30.942898    
      3400   328.3192      -37222.147     -7648.2853      6950.0861      17.3186        12.8149        31.315704    
      3500   356.457       -37315.595     -9140.2708      7032.8252      17.3186        12.8149        31.68851     
      3600   277.19128     -37248.639     -10931.145      7115.5643      17.3186        12.8149        32.061316    
      3700   309.6738      -37244.947     -7690.5375      7198.3034      17.3186        12.8149        32.434122    
      3800   292.70835     -37250.809     -9588.458       7281.0425      17.3186        12.8149        32.806928    
      3900   250.94327     -37177.453     -10394.214      7363.7817      17.3186        12.8149        33.179734    
      4000   373.94767     -37252.268     -12205.873      7446.5208      17.3186        12.8149        33.55254     
      4100   405.52027     -37352.616     -13566.559      7529.2599      17.3186        12.8149        33.925346    
      4200   327.18389     -37376.541     -8618.9069      7611.999       17.3186        12.8149        34.298152    
      4300   294.093       -37382.829     -3918.6705      7694.7381      17.3186        12.8149        34.670958    
      4400   288.86862     -37451.011     -2426.9367      7777.4773      17.3186        12.8149        35.043764    
      4500   307.56552     -37458.403     -4468.7071      7860.2164      17.3186        12.8149        35.41657     
      4600   274.60672     -37446.544     -10431.604      7942.9555      17.3186        12.8149        35.789376    
      4700   366.32075     -37478.507     -12932.923      8025.6946      17.3186        12.8149        36.162182    
      4800   358.99647     -37494.794     -10064.619      8108.4337      17.3186        12.8149        36.534988    
      4900   288.67726     -37462.708     -8927.914       8191.1729      17.3186        12.8149        36.907794    
      5000   304.22034     -37421.263     -11244.111      8273.912       17.3186        12.8149        37.2806      
Loop time of 174.452 on 16 procs for 5000 steps with 371 atoms

Performance: 1.238 ns/day, 19.384 hours/ns, 28.661 timesteps/s, 10.633 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 119.81     | 125.21     | 131.08     |  34.8 | 71.78
Bond    | 0.001593   | 0.0017889  | 0.0020644  |   0.4 |  0.00
Neigh   | 8.0081     | 8.4868     | 8.8609     |   9.6 |  4.86
Comm    | 12.898     | 18.898     | 24.522     |  92.4 | 10.83
Output  | 0.026633   | 0.032946   | 0.03824    |   2.0 |  0.02
Modify  | 20.164     | 20.71      | 21.212     |   8.1 | 11.87
Other   |            | 1.109      |            |       |  0.64

Nlocal:         46.375 ave          73 max          14 min
Histogram: 1 1 1 1 0 0 0 1 1 2
Nghost:        2176.38 ave        2416 max        1914 min
Histogram: 2 2 0 0 0 0 0 0 0 4
Neighs:        16918.8 ave       29598 max        4200 min
Histogram: 1 3 0 0 0 0 0 0 1 3

Total # of neighbors = 135350
Ave neighs/atom = 364.8248
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 17.3186
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.2054)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*17.3186
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_p all deform 100 yz delta ${delta} remap v units box flip no
fix deform_p all deform 100 yz delta 17.3186 remap v units box flip no
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos4.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom 100 dump/pos4_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos4 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136 | 138.5 | 140 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   283.89497     -37388.901     -11905.33       4136.956       17.3186        12.8149        18.6403      
       100   304.65341     -37404.623      499.8402       4136.956       17.3186        12.8149        18.6403      
       200   334.29056     -37292.609     -4430.5215      4136.956       17.3186        12.8149        18.6403      
       300   404.54508     -37309.98       1175.5629      4136.956       17.3186        12.8149        18.6403      
       400   424.62657     -37353.194      10207.935      4136.956       17.3186        12.8149        18.6403      
       500   373.60579     -37359.445     -9053.2287      4136.956       17.3186        12.8149        18.6403      
       600   386.17366     -37426.819     -4581.8995      4136.956       17.3186        12.8149        18.6403      
       700   349.56241     -37446.655      2709.5592      4136.956       17.3186        12.8149        18.6403      
       800   406.06961     -37412.064      16635.99       4136.956       17.3186        12.8149        18.6403      
       900   341.12146     -37369.313      2738.987       4136.956       17.3186        12.8149        18.6403      
      1000   391.3577      -37401.504     -6869.6103      4136.956       17.3186        12.8149        18.6403      
      1100   374.67614     -37353.222     -6256.4942      4136.956       17.3186        12.8149        18.6403      
      1200   368.6143      -37317.103     -17079.396      4136.956       17.3186        12.8149        18.6403      
      1300   390.01998     -37322.857     -16895.499      4136.956       17.3186        12.8149        18.6403      
      1400   328.50442     -37332.402     -11267.137      4136.956       17.3186        12.8149        18.6403      
      1500   399.43136     -37329.423      542.92713      4136.956       17.3186        12.8149        18.6403      
      1600   389.95897     -37234.807     -6213.0426      4136.956       17.3186        12.8149        18.6403      
      1700   427.42095     -37300.316     -1938.2153      4136.956       17.3186        12.8149        18.6403      
      1800   393.94886     -37278.501     -5962.6609      4136.956       17.3186        12.8149        18.6403      
      1900   348.23738     -37273.235     -17030.918      4136.956       17.3186        12.8149        18.6403      
      2000   346.70911     -37257.06      -6383.6142      4136.956       17.3186        12.8149        18.6403      
      2100   303.80213     -37160.366     -9132.6725      4136.956       17.3186        12.8149        18.6403      
      2200   323.19813     -37180.695     -11801.344      4136.956       17.3186        12.8149        18.6403      
      2300   313.67274     -37193.584      313.6678       4136.956       17.3186        12.8149        18.6403      
      2400   353.16512     -37244.863      2335.0623      4136.956       17.3186        12.8149        18.6403      
      2500   314.61996     -37201.393      722.02304      4136.956       17.3186        12.8149        18.6403      
      2600   348.1882      -37202.192      4460.8236      4136.956       17.3186        12.8149        18.6403      
      2700   311.26787     -37103.191      2182.7581      4136.956       17.3186        12.8149        18.6403      
      2800   331.37323     -37167.518     -7641.2987      4136.956       17.3186        12.8149        18.6403      
      2900   319.85        -37200.583     -8207.3709      4136.956       17.3186        12.8149        18.6403      
      3000   325.43602     -37222.966     -3739.5332      4136.956       17.3186        12.8149        18.6403      
      3100   322.37618     -37221.292      3521.7163      4136.956       17.3186        12.8149        18.6403      
      3200   323.14628     -37221.311      3317.2328      4136.956       17.3186        12.8149        18.6403      
      3300   332.3577      -37240.574      19606.797      4136.956       17.3186        12.8149        18.6403      
      3400   293.05547     -37116.734     -3817.6959      4136.956       17.3186        12.8149        18.6403      
      3500   285.4843      -37188.355      9081.6505      4136.956       17.3186        12.8149        18.6403      
      3600   352.19529     -37301.668      1394.2764      4136.956       17.3186        12.8149        18.6403      
      3700   329.42758     -37247.743      2296.311       4136.956       17.3186        12.8149        18.6403      
      3800   295.68391     -37217.899     -4395.6558      4136.956       17.3186        12.8149        18.6403      
      3900   383.17436     -37305.294      9569.0728      4136.956       17.3186        12.8149        18.6403      
      4000   378.07141     -37253.913     -3922.3369      4136.956       17.3186        12.8149        18.6403      
      4100   340.41478     -37250.584     -3180.6253      4136.956       17.3186        12.8149        18.6403      
      4200   369.55708     -37333.896      540.16706      4136.956       17.3186        12.8149        18.6403      
      4300   332.24315     -37312.161      5102.7852      4136.956       17.3186        12.8149        18.6403      
      4400   348.87036     -37324.162      1601.2885      4136.956       17.3186        12.8149        18.6403      
      4500   302.32275     -37275.867      4838.2898      4136.956       17.3186        12.8149        18.6403      
      4600   320.81456     -37259.199      10530.547      4136.956       17.3186        12.8149        18.6403      
      4700   327.57115     -37353.888      1819.0803      4136.956       17.3186        12.8149        18.6403      
      4800   312.42118     -37407.873      1563.1112      4136.956       17.3186        12.8149        18.6403      
      4900   315.20514     -37319.444     -2017.9465      4136.956       17.3186        12.8149        18.6403      
      5000   379.99913     -37441.643      5164.4826      4136.956       17.3186        12.8149        18.6403      
Loop time of 277.223 on 16 procs for 5000 steps with 371 atoms

Performance: 0.779 ns/day, 30.803 hours/ns, 18.036 timesteps/s, 6.691 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 208.03     | 211.52     | 215.82     |  16.7 | 76.30
Bond    | 0.0015409  | 0.0018586  | 0.0022292  |   0.5 |  0.00
Neigh   | 16.352     | 16.84      | 17.262     |   6.3 |  6.07
Comm    | 18.935     | 23.503     | 27.07      |  53.2 |  8.48
Output  | 0.024115   | 0.029308   | 0.03364    |   1.8 |  0.01
Modify  | 23.725     | 24.271     | 25.043     |   8.5 |  8.75
Other   |            | 1.055      |            |       |  0.38

Nlocal:         46.375 ave          56 max          41 min
Histogram: 2 1 1 1 1 0 1 0 0 1
Nghost:        4833.25 ave        4887 max        4764 min
Histogram: 2 0 0 0 0 2 0 2 1 1
Neighs:        28988.4 ave       34830 max       25835 min
Histogram: 2 1 1 2 0 0 1 0 0 1

Total # of neighbors = 231907
Ave neighs/atom = 625.08625
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 12.8149
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-0.4589)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*12.8149
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_p all deform 100 xz delta ${delta} remap v units box flip no
fix deform_p all deform 100 xz delta 12.8149 remap v units box flip no
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos5.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom 100 dump/pos5_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos5 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136 | 138.5 | 140 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   283.89497     -37388.901     -11905.33       4136.956       17.3186        12.8149        18.6403      
       100   304.28114     -37405.855     -25.797221      4136.956       17.3186        12.8149        18.6403      
       200   338.89859     -37350.714      1164.8355      4136.956       17.3186        12.8149        18.6403      
       300   389.07391     -37371.8        4915.9301      4136.956       17.3186        12.8149        18.6403      
       400   387.96428     -37368.705      2639.9071      4136.956       17.3186        12.8149        18.6403      
       500   372.70316     -37426.55       8328.0845      4136.956       17.3186        12.8149        18.6403      
       600   363.15488     -37438.497      3874.0842      4136.956       17.3186        12.8149        18.6403      
       700   328.37724     -37414.836      4150.0125      4136.956       17.3186        12.8149        18.6403      
       800   348.47413     -37424.931      4789.3452      4136.956       17.3186        12.8149        18.6403      
       900   342.05588     -37401.098     -9699.0765      4136.956       17.3186        12.8149        18.6403      
      1000   320.87671     -37410.789     -7123.3964      4136.956       17.3186        12.8149        18.6403      
      1100   350.40463     -37460.493      5263.7175      4136.956       17.3186        12.8149        18.6403      
      1200   331.21679     -37401.265      6706.604       4136.956       17.3186        12.8149        18.6403      
      1300   334.08792     -37447.955     -16625.483      4136.956       17.3186        12.8149        18.6403      
      1400   326.08505     -37452.334      6365.0565      4136.956       17.3186        12.8149        18.6403      
      1500   314.25312     -37473.166      13327.298      4136.956       17.3186        12.8149        18.6403      
      1600   280.26473     -37441.007      4136.6139      4136.956       17.3186        12.8149        18.6403      
      1700   300.81898     -37458.084     -340.26265      4136.956       17.3186        12.8149        18.6403      
      1800   288.49129     -37401.027      7956.5824      4136.956       17.3186        12.8149        18.6403      
      1900   335.23021     -37367.203     -2377.6839      4136.956       17.3186        12.8149        18.6403      
      2000   323.86904     -37348.019      7382.1205      4136.956       17.3186        12.8149        18.6403      
      2100   323.0496      -37362.529      9389.4502      4136.956       17.3186        12.8149        18.6403      
      2200   334.20136     -37344.509      10871.858      4136.956       17.3186        12.8149        18.6403      
      2300   368.98897     -37317.792     -137.33964      4136.956       17.3186        12.8149        18.6403      
      2400   366.30186     -37339.092      1980.0753      4136.956       17.3186        12.8149        18.6403      
      2500   292.74087     -37289.082      3417.28        4136.956       17.3186        12.8149        18.6403      
      2600   347.7189      -37356.395      4513.8425      4136.956       17.3186        12.8149        18.6403      
      2700   298.20638     -37320.265      2918.3007      4136.956       17.3186        12.8149        18.6403      
      2800   340.36283     -37409.118     -3309.0074      4136.956       17.3186        12.8149        18.6403      
      2900   354.09598     -37394.676     -11851.071      4136.956       17.3186        12.8149        18.6403      
      3000   296.83478     -37356.229     -5899.9089      4136.956       17.3186        12.8149        18.6403      
      3100   385.82229     -37474.976     -5451.5449      4136.956       17.3186        12.8149        18.6403      
      3200   350.89332     -37442.543     -5963.325       4136.956       17.3186        12.8149        18.6403      
      3300   345.96765     -37399.81      -2274.3846      4136.956       17.3186        12.8149        18.6403      
      3400   361.2948      -37412.349     -2093.3186      4136.956       17.3186        12.8149        18.6403      
      3500   303.45744     -37343.345     -23685.188      4136.956       17.3186        12.8149        18.6403      
      3600   333.24745     -37397.608     -27988.037      4136.956       17.3186        12.8149        18.6403      
      3700   312.75435     -37371.411     -8089.6367      4136.956       17.3186        12.8149        18.6403      
      3800   292.8632      -37301.364      4176.3718      4136.956       17.3186        12.8149        18.6403      
      3900   288.90534     -37223.454     -23502.456      4136.956       17.3186        12.8149        18.6403      
      4000   342.43698     -37296.909     -18564.674      4136.956       17.3186        12.8149        18.6403      
      4100   324.29624     -37291.177     -9632.194       4136.956       17.3186        12.8149        18.6403      
      4200   356.4449      -37357.328     -7840.7619      4136.956       17.3186        12.8149        18.6403      
      4300   312.64097     -37277.909     -20824.96       4136.956       17.3186        12.8149        18.6403      
      4400   335.62308     -37313.485     -2877.4875      4136.956       17.3186        12.8149        18.6403      
      4500   325.537       -37305.514     -8210.2242      4136.956       17.3186        12.8149        18.6403      
      4600   294.69316     -37268.523     -1519.0658      4136.956       17.3186        12.8149        18.6403      
      4700   319.55823     -37288.28      -5736.3495      4136.956       17.3186        12.8149        18.6403      
      4800   388.61084     -37320.625     -12703.871      4136.956       17.3186        12.8149        18.6403      
      4900   412.42471     -37343.023     -28874.648      4136.956       17.3186        12.8149        18.6403      
      5000   364.92729     -37299.099     -32140.374      4136.956       17.3186        12.8149        18.6403      
Loop time of 253.151 on 16 procs for 5000 steps with 371 atoms

Performance: 0.853 ns/day, 28.128 hours/ns, 19.751 timesteps/s, 7.328 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 188.63     | 194.28     | 197.56     |  20.0 | 76.74
Bond    | 0.0016287  | 0.0018552  | 0.0021132  |   0.4 |  0.00
Neigh   | 13.796     | 14.027     | 14.263     |   4.0 |  5.54
Comm    | 17.387     | 20.795     | 26.285     |  59.6 |  8.21
Output  | 0.026123   | 0.033211   | 0.038892   |   2.1 |  0.01
Modify  | 22.758     | 23.072     | 23.439     |   4.2 |  9.11
Other   |            | 0.9419     |            |       |  0.37

Nlocal:         46.375 ave          53 max          43 min
Histogram: 2 0 0 3 2 0 0 0 0 1
Nghost:        3832.75 ave        3854 max        3811 min
Histogram: 2 0 0 0 2 1 0 1 1 1
Neighs:        28991.6 ave       32893 max       26716 min
Histogram: 2 0 0 3 2 0 0 0 0 1

Total # of neighbors = 231933
Ave neighs/atom = 625.15633
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 18.6403
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--8.851)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.3186 12.8149 18.6403) with tilt (-8.851 0.4589 0.2054)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  371 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*18.6403
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_p all deform 100 xy delta ${delta} remap v units box flip no
fix deform_p all deform 100 xy delta 18.6403 remap v units box flip no

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos6.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom 100 dump/pos6_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos6 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 136 | 138.5 | 140 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   283.89497     -37388.901     -11905.33       4136.956       17.3186        12.8149        18.6403      
       100   304.72491     -37405.312      237.47923      4136.956       17.3186        12.8149        18.6403      
       200   378.46926     -37250.259     -3642.1249      4136.956       17.3186        12.8149        18.6403      
       300   479.41184     -37292.754      1033.6015      4136.956       17.3186        12.8149        18.6403      
       400   491.42456     -37054.756      2125.1137      4136.956       17.3186        12.8149        18.6403      
       500   563.27182     -37245.815      793.46641      4136.956       17.3186        12.8149        18.6403      
       600   505.74939     -37310.602      1851.4817      4136.956       17.3186        12.8149        18.6403      
       700   437.13297     -37332.082      3269.2393      4136.956       17.3186        12.8149        18.6403      
       800   424.34973     -37278.041      190.41102      4136.956       17.3186        12.8149        18.6403      
       900   399.08334     -37260.656     -3137.3941      4136.956       17.3186        12.8149        18.6403      
      1000   414.17437     -37304.677     -7088.045       4136.956       17.3186        12.8149        18.6403      
      1100   367.20467     -37295.928     -3092.8309      4136.956       17.3186        12.8149        18.6403      
      1200   361.29189     -37280.735     -2096.9896      4136.956       17.3186        12.8149        18.6403      
      1300   361.86886     -37263.99      -8343.0051      4136.956       17.3186        12.8149        18.6403      
      1400   381.61669     -37187.736      15001.32       4136.956       17.3186        12.8149        18.6403      
      1500   418.58316     -37268.047     -282.86072      4136.956       17.3186        12.8149        18.6403      
      1600   391.27814     -37276.42      -9003.1725      4136.956       17.3186        12.8149        18.6403      
      1700   441.3948      -37356.318     -2048.492       4136.956       17.3186        12.8149        18.6403      
      1800   387.35991     -37311.896     -2962.9156      4136.956       17.3186        12.8149        18.6403      
      1900   399.21348     -37284.645     -3209.6033      4136.956       17.3186        12.8149        18.6403      
      2000   405.23033     -37263.45      -12694.943      4136.956       17.3186        12.8149        18.6403      
      2100   424.70328     -37307.716     -4801.9705      4136.956       17.3186        12.8149        18.6403      
      2200   405.16682     -37292.038     -27932.501      4136.956       17.3186        12.8149        18.6403      
      2300   375.66595     -37277.887     -14316.644      4136.956       17.3186        12.8149        18.6403      
      2400   445.10999     -37269.839     -20358.856      4136.956       17.3186        12.8149        18.6403      
      2500   371.87099     -37156.921     -4681.3147      4136.956       17.3186        12.8149        18.6403      
      2600   417.12613     -37206.467     -2282.3932      4136.956       17.3186        12.8149        18.6403      
      2700   380.80611     -37224.875      12433.563      4136.956       17.3186        12.8149        18.6403      
      2800   376.04215     -37217.366     -8392.9541      4136.956       17.3186        12.8149        18.6403      
      2900   376.8187      -37252.343      9948.6776      4136.956       17.3186        12.8149        18.6403      
      3000   425.86812     -37344.314      13392.128      4136.956       17.3186        12.8149        18.6403      
      3100   432.16973     -37264.416      9166.2437      4136.956       17.3186        12.8149        18.6403      
      3200   382.38783     -37355.947     -4064.6537      4136.956       17.3186        12.8149        18.6403      
      3300   398.73238     -37443.639      963.4062       4136.956       17.3186        12.8149        18.6403      
      3400   439.02905     -37449.306     -2317.8372      4136.956       17.3186        12.8149        18.6403      
      3500   482.32895     -37413.198      14438.239      4136.956       17.3186        12.8149        18.6403      
      3600   393.88132     -37474.205      510.3429       4136.956       17.3186        12.8149        18.6403      
      3700   367.53779     -37498.322     -10032.642      4136.956       17.3186        12.8149        18.6403      
      3800   325.20622     -37431.935     -7501.6755      4136.956       17.3186        12.8149        18.6403      
      3900   310.3347      -37351.468     -15027.732      4136.956       17.3186        12.8149        18.6403      
      4000   357.31151     -37422.216     -11258.331      4136.956       17.3186        12.8149        18.6403      
      4100   339.99894     -37362.687     -4096.4782      4136.956       17.3186        12.8149        18.6403      
      4200   346.17301     -37288.628     -14697.7        4136.956       17.3186        12.8149        18.6403      
      4300   428.70884     -37236.883     -4071.8905      4136.956       17.3186        12.8149        18.6403      
      4400   395.20953     -37144.606     -13512.236      4136.956       17.3186        12.8149        18.6403      
      4500   399.32825     -37182.332     -2755.8669      4136.956       17.3186        12.8149        18.6403      
      4600   453.4374      -37174.527     -4908.5397      4136.956       17.3186        12.8149        18.6403      
      4700   431.57343     -37137.718     -5383.9941      4136.956       17.3186        12.8149        18.6403      
      4800   501.14134     -37342.822     -12960.043      4136.956       17.3186        12.8149        18.6403      
      4900   477.68878     -37387.761     -6027.8771      4136.956       17.3186        12.8149        18.6403      
      5000   431.72937     -37253.9       -6318.6083      4136.956       17.3186        12.8149        18.6403      
Loop time of 194.656 on 16 procs for 5000 steps with 371 atoms

Performance: 1.110 ns/day, 21.628 hours/ns, 25.686 timesteps/s, 9.530 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 123.24     | 143.48     | 157.02     |  84.4 | 73.71
Bond    | 0.0012818  | 0.0015883  | 0.0019947  |   0.5 |  0.00
Neigh   | 9.5119     | 11.011     | 11.924     |  21.8 |  5.66
Comm    | 6.3927     | 19.956     | 40.213     | 226.7 | 10.25
Output  | 0.015264   | 0.017714   | 0.019456   |   0.9 |  0.01
Modify  | 19.08      | 20.012     | 21.513     |  16.3 | 10.28
Other   |            | 0.1821     |            |       |  0.09

Nlocal:         46.375 ave          56 max          41 min
Histogram: 2 1 0 1 2 1 0 0 0 1
Nghost:        3436.75 ave        3503 max        3379 min
Histogram: 2 2 0 0 0 0 0 3 0 1
Neighs:        29026.5 ave       34740 max       26109 min
Histogram: 2 1 1 2 0 1 0 0 0 1

Total # of neighbors = 232212
Ave neighs/atom = 625.90836
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:24:43
