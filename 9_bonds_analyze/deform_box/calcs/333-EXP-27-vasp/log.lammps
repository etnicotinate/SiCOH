LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 100
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 50
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 1.0                  # the deformation magnitude 0.01

variable FF string "SiOCHN_2018.ff C H O Si"   # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si
variable structure string 333-EXP-27-vasp

# Read the initial sctructure
# box tilt large
read_data       ${structure}.data
read_data       333-EXP-27-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.007 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
fix bondinfo all reaxff/bonds 1 bonds_opt.reaxff

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
dump dump_opt all custom 1 dump/dump_opt.lammpstrj id type q x y z
minimize 1.0e-6 1.0e-6 100 1000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -2.46 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.7 | 124.3 | 125.7 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0             -27051.653      0             -27051.653      123682.78    
        49   0             -29439.356      0             -29439.356     -3469.0375    
Loop time of 5.55 on 16 procs for 49 steps with 295 atoms

96.9% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
     -27051.6528083328  -29439.3518913318   -29439.356178561
  Force two-norm initial, final = 3631.1324 146.93029
  Force max component initial, final = 486.6291 55.266235
  Final line search alpha, max atom move = 0.00073568087 0.040658312
  Iterations, force evaluations = 49 147

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 3.6146     | 4.064      | 4.2556     |   9.5 | 73.22
Bond    | 4.3424e-05 | 6.7536e-05 | 8.3307e-05 |   0.0 |  0.00
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.24447    | 0.43705    | 0.88583    |  28.8 |  7.87
Output  | 0.007548   | 0.010905   | 0.013466   |   2.0 |  0.20
Modify  | 1.0243     | 1.0245     | 1.0247     |   0.0 | 18.46
Other   |            | 0.01349    |            |       |  0.24

Nlocal:         36.875 ave          42 max          32 min
Histogram: 1 0 1 1 1 0 1 2 0 1
Nghost:         2987.5 ave        3016 max        2961 min
Histogram: 2 0 1 1 0 0 1 1 1 1
Neighs:        22518.1 ave       25367 max       19741 min
Histogram: 1 0 1 1 1 1 0 2 0 1

Total # of neighbors = 180145
Ave neighs/atom = 610.66102
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-EXP-27-vasp_opt.data
System init for write_data ...
undump dump_opt
unfix bondinfo
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
dump dump_eq all custom ${nthermo} dump/dump_eq.lammpstrj id type q x y z
dump dump_eq all custom 100 dump/dump_eq.lammpstrj id type q x y z

# compute MSD
compute msd1 all msd
fix myMSD all ave/time ${nevery} ${nrepeat} ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 ${nrepeat} ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 10 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 10 100 c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out

run ${nequil}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 116.5 | 117.9 | 119.5 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -29439.356      65.518024      1.5382232      3400.2575    
       100   187.08162     -29308.37       4070.5581      1.5382232      3400.2575    
       200   255.57151     -29315.074      4255.5616      1.5382232      3400.2575    
       300   293.07295     -29301.835     -140.45273      1.5382232      3400.2575    
       400   327.64843     -29317.154     -1426.3568      1.5382232      3400.2575    
       500   315.51873     -29340.483     -13840.515      1.5382232      3400.2575    
       600   347.75274     -29422.238      14666.885      1.5382232      3400.2575    
       700   293.81913     -29439.344      1336.6341      1.5382232      3400.2575    
       800   283.12414     -29480.414     -11402.783      1.5382232      3400.2575    
       900   289.00064     -29516.525     -9093.7826      1.5382232      3400.2575    
      1000   292.58808     -29548.431      3125.6342      1.5382232      3400.2575    
      1100   277.26934     -29561.9        4240.2468      1.5382232      3400.2575    
      1200   280.19825     -29570.101     -2055.8437      1.5382232      3400.2575    
      1300   319.58596     -29587.34       912.87679      1.5382232      3400.2575    
      1400   321.40712     -29578.943     -12345.116      1.5382232      3400.2575    
      1500   313.69358     -29581.405     -1054.1159      1.5382232      3400.2575    
      1600   284.94756     -29578.581     -191.21679      1.5382232      3400.2575    
      1700   302.98216     -29609.129     -174.96728      1.5382232      3400.2575    
      1800   313.20256     -29637.945      27687.113      1.5382232      3400.2575    
      1900   310.49101     -29659.012      21035.264      1.5382232      3400.2575    
      2000   332.55785     -29699.621      4163.9188      1.5382232      3400.2575    
      2100   333.35088     -29734.851      2944.5421      1.5382232      3400.2575    
      2200   293.83223     -29719.757      7538.8185      1.5382232      3400.2575    
      2300   295.41632     -29740.878      3944.7341      1.5382232      3400.2575    
      2400   283.14023     -29744.124     -3187.706       1.5382232      3400.2575    
      2500   287.89997     -29748.777     -4064.2308      1.5382232      3400.2575    
      2600   306.37283     -29740.795     -2673.3292      1.5382232      3400.2575    
      2700   309.3842      -29727.4        4570.4754      1.5382232      3400.2575    
      2800   299.61879     -29737.141      7491.2261      1.5382232      3400.2575    
      2900   286.1898      -29739.881     -8026.6119      1.5382232      3400.2575    
      3000   286.28567     -29740.871     -7309.236       1.5382232      3400.2575    
      3100   290.95139     -29736.623     -9866.0759      1.5382232      3400.2575    
      3200   297.49612     -29734.846     -255.54043      1.5382232      3400.2575    
      3300   326.60104     -29755.064     -2570.8605      1.5382232      3400.2575    
      3400   299.53661     -29768.603     -3681.365       1.5382232      3400.2575    
      3500   295.74518     -29775.81      -6599.3617      1.5382232      3400.2575    
      3600   297.24399     -29775.091     -6466.9677      1.5382232      3400.2575    
      3700   315.37653     -29783.484     -1031.1665      1.5382232      3400.2575    
      3800   311.23252     -29762.203      421.27757      1.5382232      3400.2575    
      3900   304.49849     -29751.639     -7872.5219      1.5382232      3400.2575    
      4000   275.05614     -29754.26      -9945.8089      1.5382232      3400.2575    
      4100   282.31209     -29775.468     -5774.6751      1.5382232      3400.2575    
      4200   313.68029     -29795.044      11016.558      1.5382232      3400.2575    
      4300   308.95791     -29785.039      1866.3141      1.5382232      3400.2575    
      4400   288.9797      -29784.331     -4321.2979      1.5382232      3400.2575    
      4500   293.96844     -29815.713     -10715.596      1.5382232      3400.2575    
      4600   346.35925     -29861.933     -5243.0153      1.5382232      3400.2575    
      4700   326.0133      -29875.534      4931.9921      1.5382232      3400.2575    
      4800   291.23787     -29860.181     -739.97927      1.5382232      3400.2575    
      4900   279.51969     -29839.206     -6658.3231      1.5382232      3400.2575    
      5000   306.16998     -29839.406     -14588.036      1.5382232      3400.2575    
Loop time of 204.511 on 16 procs for 5000 steps with 295 atoms

Performance: 1.056 ns/day, 22.723 hours/ns, 24.449 timesteps/s, 7.212 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 139.41     | 150.46     | 157.86     |  46.3 | 73.57
Bond    | 0.0015184  | 0.0018096  | 0.0022284  |   0.5 |  0.00
Neigh   | 13.412     | 13.723     | 14.053     |   6.8 |  6.71
Comm    | 13.143     | 20.421     | 31.621     | 126.0 |  9.99
Output  | 0.028009   | 0.032265   | 0.036704   |   1.8 |  0.02
Modify  | 18.386     | 18.867     | 19.25      |   6.7 |  9.23
Other   |            | 1.007      |            |       |  0.49

Nlocal:         36.875 ave          43 max          31 min
Histogram: 2 0 1 0 0 2 1 0 1 1
Nghost:           2996 ave        3047 max        2950 min
Histogram: 1 0 2 1 0 1 2 0 0 1
Neighs:        22454.2 ave       25871 max       19151 min
Histogram: 2 0 1 0 1 1 1 0 1 1

Total # of neighbors = 179634
Ave neighs/atom = 608.92881
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333-EXP-27-vasp_eq.data
System init for write_data ...
undump dump_eq
unfix myMSD

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.1447
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.6088
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 16.498

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.5805
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal -0.6366
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -7.6974

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 15.1447
variable dlen equal lx-${len0}
variable dlen equal lx-15.1447
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.002 seconds
  read_restart CPU = 0.007 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*15.1447
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 15.1447 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 15.1447 xy delta -7.6974 xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 15.1447 xy delta -7.6974 xz delta -0.6366 remap v units box flip no
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos1.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom 100 dump/pos1_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos1 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.6 | 123.1 | 125 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   306.16998     -29839.406     -14588.076      3400.2575      15.1447        13.6088        16.498       
       100   307.31779     -29835.319      3259.6978      3468.2626      15.447594      13.6088        16.498       
       200   418.99776     -29731.454     -9147.9292      3536.2678      15.750488      13.6088        16.498       
       300   466.12222     -29642.474     -4789.1899      3604.2729      16.053382      13.6088        16.498       
       400   456.36051     -29640.2       -9273.5668      3672.2781      16.356276      13.6088        16.498       
       500   514.55806     -29697.72      -3275.1458      3740.2832      16.65917       13.6088        16.498       
       600   429.87662     -29643.981      1864.1515      3808.2884      16.962064      13.6088        16.498       
       700   451.04835     -29677.177     -10171.957      3876.2935      17.264958      13.6088        16.498       
       800   464.82765     -29692.014      9383.5839      3944.2987      17.567852      13.6088        16.498       
       900   425.67865     -29656.04      -2539.2279      4012.3038      17.870746      13.6088        16.498       
      1000   433.38881     -29633.217     -9497.6777      4080.309       18.17364       13.6088        16.498       
      1100   389.78202     -29636.616     -18615.324      4148.3141      18.476534      13.6088        16.498       
      1200   420.00681     -29666.068     -9610.4063      4216.3193      18.779428      13.6088        16.498       
      1300   371.87407     -29640.949     -5263.0061      4284.3244      19.082322      13.6088        16.498       
      1400   386.26143     -29625.912     -18142.108      4352.3296      19.385216      13.6088        16.498       
      1500   323.07413     -29525.844     -18230.217      4420.3347      19.68811       13.6088        16.498       
      1600   334.64332     -29503.77      -17005.006      4488.3399      19.991004      13.6088        16.498       
      1700   342.5823      -29487.182     -21385.419      4556.345       20.293898      13.6088        16.498       
      1800   308.66431     -29481.748     -18236.848      4624.3502      20.596792      13.6088        16.498       
      1900   310.42127     -29432.345     -30950.118      4692.3553      20.899686      13.6088        16.498       
      2000   350.53344     -29395.606     -25843.97       4760.3605      21.20258       13.6088        16.498       
      2100   377.28025     -29385.805     -24271.393      4828.3656      21.505474      13.6088        16.498       
      2200   339.91108     -29341.741     -30499.814      4896.3708      21.808368      13.6088        16.498       
      2300   307.39757     -29280.672     -27685.782      4964.3759      22.111262      13.6088        16.498       
      2400   325.72948     -29293.766     -27909.116      5032.3811      22.414156      13.6088        16.498       
      2500   351.76219     -29284.067     -22956.971      5100.3862      22.71705       13.6088        16.498       
      2600   348.45063     -29270.962     -24145.517      5168.3914      23.019944      13.6088        16.498       
      2700   324.11389     -29240.724     -29087.079      5236.3965      23.322838      13.6088        16.498       
      2800   331.83757     -29163.973     -30990.18       5304.4017      23.625732      13.6088        16.498       
      2900   334.01469     -29094.82      -31465.495      5372.4068      23.928626      13.6088        16.498       
      3000   367.52076     -29076.421     -26978.302      5440.412       24.23152       13.6088        16.498       
      3100   352.79463     -29075.149     -32015.093      5508.4171      24.534414      13.6088        16.498       
      3200   394.59797     -29117.394     -26801.533      5576.4223      24.837308      13.6088        16.498       
      3300   425.79287     -29168.921     -25716.814      5644.4274      25.140202      13.6088        16.498       
      3400   430.53689     -29275.073     -20139.045      5712.4326      25.443096      13.6088        16.498       
      3500   370.16071     -29301.973     -21842.526      5780.4377      25.74599       13.6088        16.498       
      3600   318.72974     -29292.025     -23108.345      5848.4429      26.048884      13.6088        16.498       
      3700   350.1522      -29315.71      -29090.547      5916.448       26.351778      13.6088        16.498       
      3800   351.84736     -29284.927     -16894.661      5984.4532      26.654672      13.6088        16.498       
      3900   412.37045     -29373.873     -22906.627      6052.4583      26.957566      13.6088        16.498       
      4000   356.01399     -29413.64      -24650.494      6120.4635      27.26046       13.6088        16.498       
      4100   330.86292     -29403.618     -22462.393      6188.4686      27.563354      13.6088        16.498       
      4200   311.6807      -29356.846     -20105.553      6256.4738      27.866248      13.6088        16.498       
      4300   391.5799      -29423.674     -14440.847      6324.4789      28.169142      13.6088        16.498       
      4400   357.5229      -29467.287     -11108.025      6392.4841      28.472036      13.6088        16.498       
      4500   415.79154     -29601.493     -12921.32       6460.4892      28.77493       13.6088        16.498       
      4600   362.5155      -29581.964     -9399.4355      6528.4944      29.077824      13.6088        16.498       
      4700   341.46628     -29621.529     -17101.743      6596.4995      29.380718      13.6088        16.498       
      4800   323.10726     -29623.52      -22560.637      6664.5047      29.683612      13.6088        16.498       
      4900   325.83429     -29674.201     -15537.267      6732.5098      29.986506      13.6088        16.498       
      5000   322.66717     -29676.452     -12237.76       6800.515       30.2894        13.6088        16.498       
Loop time of 155.085 on 16 procs for 5000 steps with 295 atoms

Performance: 1.393 ns/day, 17.232 hours/ns, 32.240 timesteps/s, 9.511 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 104.12     | 110.73     | 115.05     |  32.3 | 71.40
Bond    | 0.0015845  | 0.0017612  | 0.0022068  |   0.5 |  0.00
Neigh   | 7.6195     | 7.9017     | 8.155      |   6.7 |  5.10
Comm    | 13.823     | 17.899     | 24.55      |  78.8 | 11.54
Output  | 0.024644   | 0.030528   | 0.03371    |   1.8 |  0.02
Modify  | 17.035     | 17.478     | 17.881     |   6.3 | 11.27
Other   |            | 1.042      |            |       |  0.67

Nlocal:         36.875 ave          54 max           8 min
Histogram: 1 0 0 0 2 0 2 0 1 2
Nghost:           2186 ave        2453 max        1901 min
Histogram: 2 0 0 2 0 0 1 1 0 2
Neighs:        11262.4 ave       17024 max        2634 min
Histogram: 1 0 0 1 1 1 0 1 2 1

Total # of neighbors = 90099
Ave neighs/atom = 305.42034
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.6088
variable dlen equal ly-${len0}
variable dlen equal ly-13.6088
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*13.6088
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 13.6088 yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 13.6088 yz delta 0.5805 remap v units box flip no
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos2.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom 100 dump/pos2_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos2 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.6 | 123.1 | 125 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   306.16998     -29839.406     -14588.076      3400.2575      15.1447        13.6088        16.498       
       100   308.57016     -29835.267      3441.8476      3468.2626      15.1447        13.880976      16.498       
       200   385.0434      -29741.145     -4581.5643      3536.2678      15.1447        14.153152      16.498       
       300   492.78391     -29715.444      588.28813      3604.2729      15.1447        14.425328      16.498       
       400   478.23162     -29744.451     -4041.5196      3672.2781      15.1447        14.697504      16.498       
       500   446.62811     -29714.814      749.23269      3740.2832      15.1447        14.96968       16.498       
       600   396.08399     -29705.45      -10583.767      3808.2884      15.1447        15.241856      16.498       
       700   417.89181     -29697.338     -15016.496      3876.2935      15.1447        15.514032      16.498       
       800   405.10597     -29648.811     -15053.518      3944.2987      15.1447        15.786208      16.498       
       900   406.93874     -29653.926     -27945.914      4012.3038      15.1447        16.058384      16.498       
      1000   381.0042      -29637.029     -6420.1388      4080.309       15.1447        16.33056       16.498       
      1100   372.88265     -29609.022      148.24352      4148.3141      15.1447        16.602736      16.498       
      1200   329.4865      -29598.947     -5572.7771      4216.3193      15.1447        16.874912      16.498       
      1300   357.61083     -29597.671     -8506.5514      4284.3244      15.1447        17.147088      16.498       
      1400   347.42848     -29539.429     -14225.548      4352.3296      15.1447        17.419264      16.498       
      1500   392.49982     -29555.589     -12750.202      4420.3347      15.1447        17.69144       16.498       
      1600   385.95566     -29529.961     -20171.222      4488.3399      15.1447        17.963616      16.498       
      1700   405.65415     -29504.144     -22444.443      4556.345       15.1447        18.235792      16.498       
      1800   395.26483     -29488.318     -12011.982      4624.3502      15.1447        18.507968      16.498       
      1900   437.08012     -29533.59      -8962.2588      4692.3553      15.1447        18.780144      16.498       
      2000   415.89502     -29502.5       -5340.7425      4760.3605      15.1447        19.05232       16.498       
      2100   386.69181     -29517.11      -11342.972      4828.3656      15.1447        19.324496      16.498       
      2200   404.28211     -29472.434     -5348.7646      4896.3708      15.1447        19.596672      16.498       
      2300   391.98618     -29573.265      646.00215      4964.3759      15.1447        19.868848      16.498       
      2400   388.74973     -29621.182     -7183.6238      5032.3811      15.1447        20.141024      16.498       
      2500   418.95274     -29655.67       4802.4697      5100.3862      15.1447        20.4132        16.498       
      2600   365.91878     -29630.797      834.67476      5168.3914      15.1447        20.685376      16.498       
      2700   361.21515     -29624.649     -16974.103      5236.3965      15.1447        20.957552      16.498       
      2800   421.17936     -29650.931     -12565.014      5304.4017      15.1447        21.229728      16.498       
      2900   426.03192     -29674.629     -12916.443      5372.4068      15.1447        21.501904      16.498       
      3000   380.14527     -29618.675     -14032.44       5440.412       15.1447        21.77408       16.498       
      3100   377.44831     -29605.638     -8766.9216      5508.4171      15.1447        22.046256      16.498       
      3200   374.46842     -29628.92      -15826.758      5576.4223      15.1447        22.318432      16.498       
      3300   412.82311     -29580.649     -2544.9893      5644.4274      15.1447        22.590608      16.498       
      3400   388.24627     -29642.927     -4683.562       5712.4326      15.1447        22.862784      16.498       
      3500   397.03974     -29669.283     -12712.756      5780.4377      15.1447        23.13496       16.498       
      3600   407.20691     -29664.832     -6551.1126      5848.4429      15.1447        23.407136      16.498       
      3700   375.41447     -29648.791     -11136.83       5916.448       15.1447        23.679312      16.498       
      3800   341.09166     -29620.208     -5953.9294      5984.4532      15.1447        23.951488      16.498       
      3900   342.63632     -29638.769     -19370.658      6052.4583      15.1447        24.223664      16.498       
      4000   341.83522     -29607.345     -20891.59       6120.4635      15.1447        24.49584       16.498       
      4100   362.53292     -29635.405     -23059.77       6188.4686      15.1447        24.768016      16.498       
      4200   340.40476     -29596.292     -18540.259      6256.4738      15.1447        25.040192      16.498       
      4300   346.67688     -29591.058     -24426.096      6324.4789      15.1447        25.312368      16.498       
      4400   281.74149     -29485.744     -23426.174      6392.4841      15.1447        25.584544      16.498       
      4500   285.92255     -29470.617     -23968.951      6460.4892      15.1447        25.85672       16.498       
      4600   291.48252     -29453.257     -21205.19       6528.4944      15.1447        26.128896      16.498       
      4700   294.17318     -29445.282     -21749.333      6596.4995      15.1447        26.401072      16.498       
      4800   361.48616     -29455.904     -14008.198      6664.5047      15.1447        26.673248      16.498       
      4900   429.28573     -29550.312     -13007.423      6732.5098      15.1447        26.945424      16.498       
      5000   388.63034     -29557.627     -14438.252      6800.515       15.1447        27.2176        16.498       
Loop time of 139.274 on 16 procs for 5000 steps with 295 atoms

Performance: 1.551 ns/day, 15.475 hours/ns, 35.901 timesteps/s, 10.591 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 91.88      | 96.979     | 101.28     |  31.8 | 69.63
Bond    | 0.0014915  | 0.0017192  | 0.0021855  |   0.5 |  0.00
Neigh   | 7.6765     | 7.808      | 7.9428     |   3.1 |  5.61
Comm    | 12.82      | 16.966     | 22.287     |  76.3 | 12.18
Output  | 0.023555   | 0.028358   | 0.032125   |   1.8 |  0.02
Modify  | 16.073     | 16.301     | 16.464     |   3.0 | 11.70
Other   |            | 1.189      |            |       |  0.85

Nlocal:         36.875 ave          50 max          22 min
Histogram: 1 1 0 1 0 2 0 1 0 2
Nghost:        1631.88 ave        1814 max        1459 min
Histogram: 2 2 0 0 0 0 0 1 1 2
Neighs:          10961 ave       15756 max        5996 min
Histogram: 2 0 1 1 0 1 0 1 0 2

Total # of neighbors = 87688
Ave neighs/atom = 297.24746
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 16.498
variable dlen equal lz-${len0}
variable dlen equal lz-16.498
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*16.498
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 16.498 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos3.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom 100 dump/pos3_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos3 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.6 | 123.1 | 125 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   306.16998     -29839.406     -14588.076      3400.2575      15.1447        13.6088        16.498       
       100   308.595       -29835.973      2452.8894      3468.2626      15.1447        13.6088        16.82796     
       200   421.79171     -29781.185      3467.279       3536.2678      15.1447        13.6088        17.15792     
       300   389.38583     -29672.962      5853.3362      3604.2729      15.1447        13.6088        17.48788     
       400   446.28803     -29714.956     -11594.171      3672.2781      15.1447        13.6088        17.81784     
       500   426.98737     -29727.435      10089.89       3740.2832      15.1447        13.6088        18.1478      
       600   368.66079     -29674.151      9618.6479      3808.2884      15.1447        13.6088        18.47776     
       700   410.39856     -29731.607      965.82798      3876.2935      15.1447        13.6088        18.80772     
       800   417.87619     -29717.118     -14734.478      3944.2987      15.1447        13.6088        19.13768     
       900   418.68305     -29743.753     -15646.107      4012.3038      15.1447        13.6088        19.46764     
      1000   440.76903     -29701.139     -5138.6241      4080.309       15.1447        13.6088        19.7976      
      1100   413.56788     -29630.96      -21941.078      4148.3141      15.1447        13.6088        20.12756     
      1200   383.77243     -29504.133     -24221.02       4216.3193      15.1447        13.6088        20.45752     
      1300   419.21893     -29493.421     -20718.906      4284.3244      15.1447        13.6088        20.78748     
      1400   409.18144     -29509.746     -35388.798      4352.3296      15.1447        13.6088        21.11744     
      1500   436.18697     -29479.641     -32250.274      4420.3347      15.1447        13.6088        21.4474      
      1600   408.81301     -29434.303     -39137.765      4488.3399      15.1447        13.6088        21.77736     
      1700   386.97084     -29413.441     -32441.73       4556.345       15.1447        13.6088        22.10732     
      1800   356.75358     -29344.036     -34455.039      4624.3502      15.1447        13.6088        22.43728     
      1900   410.30004     -29369.143     -27937.092      4692.3553      15.1447        13.6088        22.76724     
      2000   396.81452     -29389.635     -28082.894      4760.3605      15.1447        13.6088        23.0972      
      2100   460.37984     -29477.822     -14657.517      4828.3656      15.1447        13.6088        23.42716     
      2200   365.13488     -29440.275     -15277.884      4896.3708      15.1447        13.6088        23.75712     
      2300   367.20966     -29475.501     -12470.47       4964.3759      15.1447        13.6088        24.08708     
      2400   413.37441     -29505.119     -13020.621      5032.3811      15.1447        13.6088        24.41704     
      2500   270.54159     -29363.627     -25366.912      5100.3862      15.1447        13.6088        24.747       
      2600   298.48514     -29394.457     -32664.339      5168.3914      15.1447        13.6088        25.07696     
      2700   314.47359     -29407.146     -27427.217      5236.3965      15.1447        13.6088        25.40692     
      2800   305.18792     -29398.291     -31553.171      5304.4017      15.1447        13.6088        25.73688     
      2900   398.00782     -29455.388     -13964.198      5372.4068      15.1447        13.6088        26.06684     
      3000   383.63966     -29506.636     -12089.195      5440.412       15.1447        13.6088        26.3968      
      3100   347.86084     -29493.664     -11212.896      5508.4171      15.1447        13.6088        26.72676     
      3200   391.87664     -29527.335     -7819.4989      5576.4223      15.1447        13.6088        27.05672     
      3300   347.8836      -29579.558     -8812.3582      5644.4274      15.1447        13.6088        27.38668     
      3400   280.33577     -29600.361     -9132.4295      5712.4326      15.1447        13.6088        27.71664     
      3500   290.04459     -29616.78      -13293.614      5780.4377      15.1447        13.6088        28.0466      
      3600   286.14061     -29583.148     -6260.2801      5848.4429      15.1447        13.6088        28.37656     
      3700   287.05287     -29597.98       1949.6736      5916.448       15.1447        13.6088        28.70652     
      3800   326.41427     -29604.232     -3477.5782      5984.4532      15.1447        13.6088        29.03648     
      3900   330.13289     -29619.487     -7676.9746      6052.4583      15.1447        13.6088        29.36644     
      4000   295.23025     -29574.282     -14969.653      6120.4635      15.1447        13.6088        29.6964      
      4100   287.49859     -29548.257     -10114.081      6188.4686      15.1447        13.6088        30.02636     
      4200   352.72437     -29585.539     -8871.1685      6256.4738      15.1447        13.6088        30.35632     
      4300   305.15548     -29518.997     -8959.26        6324.4789      15.1447        13.6088        30.68628     
      4400   288.27546     -29504.857     -13593.131      6392.4841      15.1447        13.6088        31.01624     
      4500   291.63762     -29497.154     -17858.013      6460.4892      15.1447        13.6088        31.3462      
      4600   290.90233     -29472.505     -12055.128      6528.4944      15.1447        13.6088        31.67616     
      4700   310.37002     -29491.846     -10811.036      6596.4995      15.1447        13.6088        32.00612     
      4800   333.31474     -29514.797     -15799.596      6664.5047      15.1447        13.6088        32.33608     
      4900   298.30766     -29469.109     -8436.8535      6732.5098      15.1447        13.6088        32.66604     
      5000   298.89013     -29494.528     -10827.579      6800.515       15.1447        13.6088        32.996       
Loop time of 151.644 on 16 procs for 5000 steps with 295 atoms

Performance: 1.424 ns/day, 16.849 hours/ns, 32.972 timesteps/s, 9.727 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 87.546     | 102.9      | 113.59     |  75.1 | 67.85
Bond    | 0.0014009  | 0.001677   | 0.0020182  |   0.5 |  0.00
Neigh   | 7.2481     | 7.9223     | 8.6609     |  15.1 |  5.22
Comm    | 11.039     | 21.847     | 37.368     | 165.4 | 14.41
Output  | 0.027537   | 0.034275   | 0.038599   |   2.1 |  0.02
Modify  | 16.959     | 17.784     | 18.5       |  11.9 | 11.73
Other   |            | 1.156      |            |       |  0.76

Nlocal:         36.875 ave          63 max          12 min
Histogram: 2 0 0 0 3 0 0 1 1 1
Nghost:        1927.38 ave        2256 max        1618 min
Histogram: 2 0 1 1 0 0 1 0 2 1
Neighs:          11812 ave       22191 max        2729 min
Histogram: 2 0 2 0 0 1 0 1 1 1

Total # of neighbors = 94496
Ave neighs/atom = 320.32542
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 15.1447
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.5805)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*15.1447
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_p all deform 100 yz delta ${delta} remap v units box flip no
fix deform_p all deform 100 yz delta 15.1447 remap v units box flip no
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos4.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom 100 dump/pos4_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos4 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.6 | 123.1 | 125 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   306.16998     -29839.406     -14588.076      3400.2575      15.1447        13.6088        16.498       
       100   312.61675     -29834.938      2465.6655      3400.2575      15.1447        13.6088        16.498       
       200   431.75163     -29755.122      5577.7614      3400.2575      15.1447        13.6088        16.498       
       300   434.42969     -29635.149      6624.3137      3400.2575      15.1447        13.6088        16.498       
       400   519.38325     -29553.883      2811.0308      3400.2575      15.1447        13.6088        16.498       
       500   385.77836     -29544.646      18168.552      3400.2575      15.1447        13.6088        16.498       
       600   380.33196     -29487.831      3470.3046      3400.2575      15.1447        13.6088        16.498       
       700   450.18754     -29625.476      8582.4862      3400.2575      15.1447        13.6088        16.498       
       800   345.23389     -29557.824      4811.5988      3400.2575      15.1447        13.6088        16.498       
       900   437.72402     -29604.525      1571.9833      3400.2575      15.1447        13.6088        16.498       
      1000   369.73597     -29598.049     -4681.026       3400.2575      15.1447        13.6088        16.498       
      1100   319.35614     -29600.265      546.57592      3400.2575      15.1447        13.6088        16.498       
      1200   326.42815     -29625.395     -1600.4196      3400.2575      15.1447        13.6088        16.498       
      1300   377.8128      -29604.658      1500.6812      3400.2575      15.1447        13.6088        16.498       
      1400   350.8         -29602.217     -1002.1556      3400.2575      15.1447        13.6088        16.498       
      1500   340.99733     -29598.341      8770.2665      3400.2575      15.1447        13.6088        16.498       
      1600   313.18767     -29581.785      6346.1558      3400.2575      15.1447        13.6088        16.498       
      1700   294.22951     -29568         -8341.2464      3400.2575      15.1447        13.6088        16.498       
      1800   352.49466     -29558.871     -2409.5948      3400.2575      15.1447        13.6088        16.498       
      1900   342.31186     -29482.544     -1906.8038      3400.2575      15.1447        13.6088        16.498       
      2000   338.56063     -29505.744     -8851.8357      3400.2575      15.1447        13.6088        16.498       
      2100   346.40652     -29511.852     -13826.633      3400.2575      15.1447        13.6088        16.498       
      2200   399.34461     -29482.025     -9744.4993      3400.2575      15.1447        13.6088        16.498       
      2300   396.13147     -29499.133     -15196.347      3400.2575      15.1447        13.6088        16.498       
      2400   293.36494     -29451.97      -17888.542      3400.2575      15.1447        13.6088        16.498       
      2500   344.304       -29469.052     -13768.33       3400.2575      15.1447        13.6088        16.498       
      2600   375.81523     -29489.691     -1920.6815      3400.2575      15.1447        13.6088        16.498       
      2700   333.81781     -29473.041     -11985.612      3400.2575      15.1447        13.6088        16.498       
      2800   361.20617     -29444.397     -3039.6616      3400.2575      15.1447        13.6088        16.498       
      2900   334.70567     -29423.537     -15253.277      3400.2575      15.1447        13.6088        16.498       
      3000   309.09625     -29386.584     -9691.7555      3400.2575      15.1447        13.6088        16.498       
      3100   337.22553     -29414.084     -16678.194      3400.2575      15.1447        13.6088        16.498       
      3200   305.18653     -29383.802     -26700.11       3400.2575      15.1447        13.6088        16.498       
      3300   282.80139     -29411.465     -21047.176      3400.2575      15.1447        13.6088        16.498       
      3400   346.04099     -29403.608     -20870.417      3400.2575      15.1447        13.6088        16.498       
      3500   381.03244     -29382.033     -18669.797      3400.2575      15.1447        13.6088        16.498       
      3600   309.37019     -29338.483     -20367.373      3400.2575      15.1447        13.6088        16.498       
      3700   363.04914     -29375.629     -22735.359      3400.2575      15.1447        13.6088        16.498       
      3800   374.67188     -29384.823     -12724.729      3400.2575      15.1447        13.6088        16.498       
      3900   373.6194      -29340.098     -16695.309      3400.2575      15.1447        13.6088        16.498       
      4000   399.0459      -29341.621     -11445.841      3400.2575      15.1447        13.6088        16.498       
      4100   342.94102     -29348.105     -16996.249      3400.2575      15.1447        13.6088        16.498       
      4200   367.25132     -29340.412     -18009.839      3400.2575      15.1447        13.6088        16.498       
      4300   344.23531     -29288.739     -18616.071      3400.2575      15.1447        13.6088        16.498       
      4400   363.31649     -29200.893     -33622.822      3400.2575      15.1447        13.6088        16.498       
      4500   330.48554     -29212.192     -32677.083      3400.2575      15.1447        13.6088        16.498       
      4600   347.0147      -29156.304      3328.2973      3400.2575      15.1447        13.6088        16.498       
      4700   518.05698     -29296.639     -8433.7916      3400.2575      15.1447        13.6088        16.498       
      4800   432.0619      -29345.685     -3541.9756      3400.2575      15.1447        13.6088        16.498       
      4900   405.14715     -29446.782      10610.587      3400.2575      15.1447        13.6088        16.498       
      5000   477.68578     -29519.181     -5099.9669      3400.2575      15.1447        13.6088        16.498       
Loop time of 232.742 on 16 procs for 5000 steps with 295 atoms

Performance: 0.928 ns/day, 25.860 hours/ns, 21.483 timesteps/s, 6.337 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 168.25     | 174.53     | 178.53     |  21.5 | 74.99
Bond    | 0.0015507  | 0.0018621  | 0.0023381  |   0.6 |  0.00
Neigh   | 15.324     | 15.758     | 15.996     |   5.0 |  6.77
Comm    | 16.15      | 20.424     | 26.76      |  63.9 |  8.78
Output  | 0.025575   | 0.03141    | 0.03519    |   2.0 |  0.01
Modify  | 20.519     | 20.931     | 21.326     |   6.6 |  8.99
Other   |            | 1.063      |            |       |  0.46

Nlocal:         36.875 ave          44 max          32 min
Histogram: 1 2 0 2 1 0 0 0 1 1
Nghost:        4152.88 ave        4166 max        4146 min
Histogram: 2 1 0 1 3 0 0 0 0 1
Neighs:          22395 ave       26442 max       19528 min
Histogram: 1 2 0 2 1 0 0 0 1 1

Total # of neighbors = 179160
Ave neighs/atom = 607.32203
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.6088
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz--0.6366)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*13.6088
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_p all deform 100 xz delta ${delta} remap v units box flip no
fix deform_p all deform 100 xz delta 13.6088 remap v units box flip no
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos5.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom 100 dump/pos5_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos5 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.6 | 123.1 | 125 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   306.16998     -29839.406     -14588.076      3400.2575      15.1447        13.6088        16.498       
       100   310.64936     -29832.917      2664.0599      3400.2575      15.1447        13.6088        16.498       
       200   375.52559     -29781.483      939.96488      3400.2575      15.1447        13.6088        16.498       
       300   426.02261     -29767.035     -1817.4362      3400.2575      15.1447        13.6088        16.498       
       400   455.65088     -29874.808     -1700.0205      3400.2575      15.1447        13.6088        16.498       
       500   428.99279     -29894.112      4409.2085      3400.2575      15.1447        13.6088        16.498       
       600   420.4117      -29894.155      188.14916      3400.2575      15.1447        13.6088        16.498       
       700   409.13974     -29871.725     -1438.6053      3400.2575      15.1447        13.6088        16.498       
       800   360.63141     -29912.85      -9177.7414      3400.2575      15.1447        13.6088        16.498       
       900   350.8901      -29958.546     -16277.914      3400.2575      15.1447        13.6088        16.498       
      1000   359.85275     -30004.868      1056.7721      3400.2575      15.1447        13.6088        16.498       
      1100   319.98314     -29964.585      8763.1209      3400.2575      15.1447        13.6088        16.498       
      1200   403.97478     -29994.002     -2645.484       3400.2575      15.1447        13.6088        16.498       
      1300   329.89087     -29955.962     -4729.9678      3400.2575      15.1447        13.6088        16.498       
      1400   454.77668     -30080.983     -1920.0787      3400.2575      15.1447        13.6088        16.498       
      1500   346.56549     -30022.717     -4312.5396      3400.2575      15.1447        13.6088        16.498       
      1600   337.37362     -30040.943     -392.33592      3400.2575      15.1447        13.6088        16.498       
      1700   313.79758     -29993.444      6671.0901      3400.2575      15.1447        13.6088        16.498       
      1800   362.53628     -29981.773      7407.4653      3400.2575      15.1447        13.6088        16.498       
      1900   296.8905      -29903.518     -8127.8901      3400.2575      15.1447        13.6088        16.498       
      2000   347.85525     -29951.051      4329.7527      3400.2575      15.1447        13.6088        16.498       
      2100   352.03528     -29954.73       5331.3801      3400.2575      15.1447        13.6088        16.498       
      2200   334.96725     -29864.273      4143.4363      3400.2575      15.1447        13.6088        16.498       
      2300   308.28634     -29883.381      5077.6471      3400.2575      15.1447        13.6088        16.498       
      2400   336.85276     -29911.076      7405.2547      3400.2575      15.1447        13.6088        16.498       
      2500   276.54725     -29773.314      13738.026      3400.2575      15.1447        13.6088        16.498       
      2600   303.27448     -29793.686      3657.8393      3400.2575      15.1447        13.6088        16.498       
      2700   335.38278     -29791.425      8354.3805      3400.2575      15.1447        13.6088        16.498       
      2800   307.04624     -29803.105      2818.7761      3400.2575      15.1447        13.6088        16.498       
      2900   337.48924     -29839.609     -3956.8856      3400.2575      15.1447        13.6088        16.498       
      3000   377.78431     -29849.962     -5056.6422      3400.2575      15.1447        13.6088        16.498       
      3100   359.4919      -29829.478     -13724.128      3400.2575      15.1447        13.6088        16.498       
      3200   337.47219     -29821.981      1756.9502      3400.2575      15.1447        13.6088        16.498       
      3300   321.11016     -29797.685      812.38712      3400.2575      15.1447        13.6088        16.498       
      3400   338.56423     -29774.509      12529.909      3400.2575      15.1447        13.6088        16.498       
      3500   351.85524     -29728.273     -2744.6334      3400.2575      15.1447        13.6088        16.498       
      3600   417.66153     -29533.926     -5218.849       3400.2575      15.1447        13.6088        16.498       
      3700   371.82748     -29550.378      5237.051       3400.2575      15.1447        13.6088        16.498       
      3800   361.3645      -29616.133     -6239.4761      3400.2575      15.1447        13.6088        16.498       
      3900   291.20138     -29573.29      -6287.204       3400.2575      15.1447        13.6088        16.498       
      4000   342.03686     -29600.121      12336.12       3400.2575      15.1447        13.6088        16.498       
      4100   340.75889     -29597.759      2629.8586      3400.2575      15.1447        13.6088        16.498       
      4200   327.98089     -29538.401     -2807.5851      3400.2575      15.1447        13.6088        16.498       
      4300   361.2862      -29483.032      6424.1037      3400.2575      15.1447        13.6088        16.498       
      4400   495.68312     -29445.329      253.49878      3400.2575      15.1447        13.6088        16.498       
      4500   409.18467     -29471.869     -3926.8796      3400.2575      15.1447        13.6088        16.498       
      4600   403.30859     -29459.781      895.69457      3400.2575      15.1447        13.6088        16.498       
      4700   334.77559     -29473.483     -7147.5081      3400.2575      15.1447        13.6088        16.498       
      4800   330.17039     -29455.872     -10355.123      3400.2575      15.1447        13.6088        16.498       
      4900   391.50191     -29558.94      -4254.6853      3400.2575      15.1447        13.6088        16.498       
      5000   322.67174     -29508.625     -25028.003      3400.2575      15.1447        13.6088        16.498       
Loop time of 217.581 on 16 procs for 5000 steps with 295 atoms

Performance: 0.993 ns/day, 24.176 hours/ns, 22.980 timesteps/s, 6.779 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 157.3      | 162.15     | 165.85     |  24.7 | 74.53
Bond    | 0.0016601  | 0.0018928  | 0.0023869  |   0.5 |  0.00
Neigh   | 12.927     | 13.168     | 13.407     |   4.8 |  6.05
Comm    | 17.579     | 21.134     | 26.021     |  67.2 |  9.71
Output  | 0.022274   | 0.027326   | 0.031143   |   2.0 |  0.01
Modify  | 19.673     | 19.996     | 20.378     |   4.8 |  9.19
Other   |            | 1.1        |            |       |  0.51

Nlocal:         36.875 ave          42 max          32 min
Histogram: 1 0 1 1 0 1 2 1 0 1
Nghost:        3502.12 ave        3534 max        3465 min
Histogram: 2 0 0 0 0 2 1 1 1 1
Neighs:        22464.1 ave       25556 max       19746 min
Histogram: 1 1 1 0 1 2 1 0 0 1

Total # of neighbors = 179713
Ave neighs/atom = 609.19661
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 16.498
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--7.6974)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.1447 13.6088 16.498) with tilt (-7.6974 -0.6366 0.5805)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  295 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*16.498
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_p all deform 100 xy delta ${delta} remap v units box flip no
fix deform_p all deform 100 xy delta 16.498 remap v units box flip no

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos6.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom 100 dump/pos6_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos6 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 120.6 | 123.1 | 125 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   306.16998     -29839.406     -14588.076      3400.2575      15.1447        13.6088        16.498       
       100   313.84254     -29834.891      1668.2754      3400.2575      15.1447        13.6088        16.498       
       200   500.0777      -29735.126      3127.1267      3400.2575      15.1447        13.6088        16.498       
       300   486.12937     -29570.465      8134.7662      3400.2575      15.1447        13.6088        16.498       
       400   546.60502     -29576.92       9327.5888      3400.2575      15.1447        13.6088        16.498       
       500   466.44356     -29645.509      9735.6371      3400.2575      15.1447        13.6088        16.498       
       600   418.52136     -29696.485      7940.1351      3400.2575      15.1447        13.6088        16.498       
       700   451.25506     -29669.803     -2835.2588      3400.2575      15.1447        13.6088        16.498       
       800   428.11551     -29669.112     -17168.545      3400.2575      15.1447        13.6088        16.498       
       900   400.51584     -29746.581      4401.692       3400.2575      15.1447        13.6088        16.498       
      1000   322.41226     -29735.633      17771.358      3400.2575      15.1447        13.6088        16.498       
      1100   341.19021     -29738.771     -10604.345      3400.2575      15.1447        13.6088        16.498       
      1200   322.9102      -29741.94      -12279.466      3400.2575      15.1447        13.6088        16.498       
      1300   370.49149     -29748.968     -7016.8397      3400.2575      15.1447        13.6088        16.498       
      1400   411.55964     -29771.901     -10938.537      3400.2575      15.1447        13.6088        16.498       
      1500   359.45101     -29795.322     -9988.3177      3400.2575      15.1447        13.6088        16.498       
      1600   312.61582     -29752.539     -6701.335       3400.2575      15.1447        13.6088        16.498       
      1700   335.39921     -29810.951     -2583.2927      3400.2575      15.1447        13.6088        16.498       
      1800   338.93062     -29799.981     -3457.2472      3400.2575      15.1447        13.6088        16.498       
      1900   342.81154     -29785.774     -2445.5517      3400.2575      15.1447        13.6088        16.498       
      2000   293.52197     -29773.342     -8467.3186      3400.2575      15.1447        13.6088        16.498       
      2100   302.22857     -29778.481     -15682.897      3400.2575      15.1447        13.6088        16.498       
      2200   322.53283     -29761.114      3612.6549      3400.2575      15.1447        13.6088        16.498       
      2300   301.14051     -29689.153      6324.3779      3400.2575      15.1447        13.6088        16.498       
      2400   314.73253     -29728.568      3452.2413      3400.2575      15.1447        13.6088        16.498       
      2500   330.99885     -29764.634     -9713.8969      3400.2575      15.1447        13.6088        16.498       
      2600   310.88129     -29767.861     -4442.3231      3400.2575      15.1447        13.6088        16.498       
      2700   290.16347     -29723.566      4479.2832      3400.2575      15.1447        13.6088        16.498       
      2800   333.84962     -29753.245      11265.233      3400.2575      15.1447        13.6088        16.498       
      2900   284.49409     -29737.663     -9592.0336      3400.2575      15.1447        13.6088        16.498       
      3000   328.82074     -29706.582     -6710.6734      3400.2575      15.1447        13.6088        16.498       
      3100   343.59079     -29731.009     -9541.5935      3400.2575      15.1447        13.6088        16.498       
      3200   395.26131     -29818.572     -11472.895      3400.2575      15.1447        13.6088        16.498       
      3300   316.80492     -29752.787     -1198.4727      3400.2575      15.1447        13.6088        16.498       
      3400   305.32239     -29767.369     -1621.6279      3400.2575      15.1447        13.6088        16.498       
      3500   350.50984     -29793.695      5016.902       3400.2575      15.1447        13.6088        16.498       
      3600   375.17037     -29835.31      -2778.0995      3400.2575      15.1447        13.6088        16.498       
      3700   409.93301     -29847.409     -10684.23       3400.2575      15.1447        13.6088        16.498       
      3800   323.58982     -29790.389     -446.95406      3400.2575      15.1447        13.6088        16.498       
      3900   341.83139     -29829.426     -2411.1122      3400.2575      15.1447        13.6088        16.498       
      4000   355.03164     -29848.409     -3322.3137      3400.2575      15.1447        13.6088        16.498       
      4100   391.93473     -29816.218     -10897.03       3400.2575      15.1447        13.6088        16.498       
      4200   365.78859     -29814.71       3558.4683      3400.2575      15.1447        13.6088        16.498       
      4300   365.30764     -29852.65      -6241.2193      3400.2575      15.1447        13.6088        16.498       
      4400   342.37494     -29808.822     -1057.0136      3400.2575      15.1447        13.6088        16.498       
      4500   390.13952     -29836.007     -2285.8932      3400.2575      15.1447        13.6088        16.498       
      4600   384.47022     -29807.239     -15001.962      3400.2575      15.1447        13.6088        16.498       
      4700   454.87535     -29807.819     -8277.4036      3400.2575      15.1447        13.6088        16.498       
      4800   342.68094     -29633.967     -12855.519      3400.2575      15.1447        13.6088        16.498       
      4900   430.63561     -29690.74      -18085.195      3400.2575      15.1447        13.6088        16.498       
      5000   442.28126     -29693.661     -3349.7746      3400.2575      15.1447        13.6088        16.498       
Loop time of 146.221 on 16 procs for 5000 steps with 295 atoms

Performance: 1.477 ns/day, 16.247 hours/ns, 34.195 timesteps/s, 10.087 katom-step/s
99.6% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 97.439     | 106.74     | 115.8      |  75.2 | 73.00
Bond    | 0.0011847  | 0.0013643  | 0.0017784  |   0.5 |  0.00
Neigh   | 8.8675     | 9.6905     | 10.519     |  22.8 |  6.63
Comm    | 5.3121     | 14.369     | 23.685     | 205.1 |  9.83
Output  | 0.011978   | 0.01336    | 0.014356   |   0.8 |  0.01
Modify  | 14.464     | 15.307     | 16.132     |  18.2 | 10.47
Other   |            | 0.09847    |            |       |  0.07

Nlocal:         36.875 ave          47 max          24 min
Histogram: 2 0 0 0 0 1 3 0 1 1
Nghost:        3039.38 ave        3099 max        2982 min
Histogram: 2 1 0 1 0 0 1 0 1 2
Neighs:        22364.4 ave       28000 max       14937 min
Histogram: 2 0 0 0 0 1 3 0 1 1

Total # of neighbors = 178915
Ave neighs/atom = 606.49153
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:20:53
