LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 100
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 50
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 1.0                  # the deformation magnitude 0.01

variable FF string "SiOCHN_2018.ff C H O Si"   # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si
variable structure string 333-RV-31-vasp

# Read the initial sctructure
# box tilt large
read_data       ${structure}.data
read_data       333-RV-31-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.007 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
fix bondinfo all reaxff/bonds 1 bonds_opt.reaxff

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
dump dump_opt all custom 1 dump/dump_opt.lammpstrj id type q x y z
minimize 1.0e-6 1.0e-6 100 1000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = 22.14 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.9 | 129.5 | 130.4 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0             -22769.99       0             -22769.99       192976.37    
        34   0             -25818.738      0             -25818.738      2455.5026    
Loop time of 3.90896 on 16 procs for 34 steps with 310 atoms

96.9% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
     -22769.9897651964  -25818.7225660054  -25818.7384760384
  Force two-norm initial, final = 4428.6909 181.46606
  Force max component initial, final = 538.14803 52.055921
  Final line search alpha, max atom move = 0.0015845443 0.082484914
  Iterations, force evaluations = 34 107

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.26       | 2.6108     | 2.9053     |  12.0 | 66.79
Bond    | 2.7761e-05 | 3.9487e-05 | 5.0456e-05 |   0.0 |  0.00
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.16467    | 0.4587     | 0.80871    |  28.7 | 11.73
Output  | 0.0054201  | 0.0074049  | 0.0088855  |   1.4 |  0.19
Modify  | 0.82369    | 0.82421    | 0.82443    |   0.0 | 21.09
Other   |            | 0.007766   |            |       |  0.20

Nlocal:          38.75 ave          46 max          34 min
Histogram: 1 2 0 1 2 0 1 0 0 1
Nghost:        3126.75 ave        3154 max        3097 min
Histogram: 1 0 1 1 1 2 0 0 1 1
Neighs:        24559.1 ave       28996 max       21632 min
Histogram: 1 2 0 1 2 0 1 0 0 1

Total # of neighbors = 196473
Ave neighs/atom = 633.78387
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-RV-31-vasp_opt.data
System init for write_data ...
undump dump_opt
unfix bondinfo
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
dump dump_eq all custom ${nthermo} dump/dump_eq.lammpstrj id type q x y z
dump dump_eq all custom 100 dump/dump_eq.lammpstrj id type q x y z

# compute MSD
compute msd1 all msd
fix myMSD all ave/time ${nevery} ${nrepeat} ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 ${nrepeat} ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 10 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 10 100 c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out

run ${nequil}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 122.6 | 123.3 | 124.2 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -25818.739      6130.4426      1.4204665      3436.9359    
       100   230.37429     -25718.994      3183.4811      1.4204665      3436.9359    
       200   257.12921     -25696.176      10478.949      1.4204665      3436.9359    
       300   302.2517      -25698.261      7482.6178      1.4204665      3436.9359    
       400   307.36238     -25685.638      5075.5         1.4204665      3436.9359    
       500   337.10398     -25752.483      21209.362      1.4204665      3436.9359    
       600   298.78205     -25770.382      15809.977      1.4204665      3436.9359    
       700   317.80517     -25815.441      7655.5433      1.4204665      3436.9359    
       800   319.97101     -25877.02       7348.7977      1.4204665      3436.9359    
       900   384.00757     -26005.86       6805.7402      1.4204665      3436.9359    
      1000   298.80078     -26000.16       8921.8687      1.4204665      3436.9359    
      1100   322.03111     -26082.02       4973.7328      1.4204665      3436.9359    
      1200   303.79601     -26101.512      3934.0412      1.4204665      3436.9359    
      1300   271.41949     -26111.94      -215.33493      1.4204665      3436.9359    
      1400   314.1387      -26175.905     -1594.8702      1.4204665      3436.9359    
      1500   314.65321     -26199.144     -1395.3498      1.4204665      3436.9359    
      1600   283.38664     -26192.194      4811.8806      1.4204665      3436.9359    
      1700   275.33706     -26198.903      4288.3529      1.4204665      3436.9359    
      1800   305.05412     -26247.102      6839.127       1.4204665      3436.9359    
      1900   291.00536     -26279.592      16056.336      1.4204665      3436.9359    
      2000   292.27878     -26313.603      12173.72       1.4204665      3436.9359    
      2100   313.94634     -26375.136      19086.47       1.4204665      3436.9359    
      2200   317.37793     -26416.13       14861.218      1.4204665      3436.9359    
      2300   357.77347     -26495.742      8189.0021      1.4204665      3436.9359    
      2400   297.31572     -26486.321      5064.5402      1.4204665      3436.9359    
      2500   322.87384     -26545.052      1729.9547      1.4204665      3436.9359    
      2600   362.6644      -26624.949      5800.7293      1.4204665      3436.9359    
      2700   362.63418     -26682.112     -1243.1873      1.4204665      3436.9359    
      2800   328.8457      -26732.98       3948.671       1.4204665      3436.9359    
      2900   295.55163     -26766.421      3883.395       1.4204665      3436.9359    
      3000   273.62077     -26788.711      15709.849      1.4204665      3436.9359    
      3100   282.36438     -26820.214      4687.2982      1.4204665      3436.9359    
      3200   298.87152     -26855.757      3947.139       1.4204665      3436.9359    
      3300   299.33562     -26875.302      14130.696      1.4204665      3436.9359    
      3400   330.79477     -26925.43       11690.647      1.4204665      3436.9359    
      3500   271.30755     -26895.785      778.93119      1.4204665      3436.9359    
      3600   293.85752     -26927.18       11435.163      1.4204665      3436.9359    
      3700   296.75116     -26935.874      8953.3228      1.4204665      3436.9359    
      3800   324.15333     -26984.762      4552.3923      1.4204665      3436.9359    
      3900   271.48386     -26964.901      4693.9337      1.4204665      3436.9359    
      4000   332.40349     -27026.288      9403.8197      1.4204665      3436.9359    
      4100   290.49206     -26999.657      6049.9433      1.4204665      3436.9359    
      4200   253.65626     -26989.622      13570.592      1.4204665      3436.9359    
      4300   369.95706     -27104.355      6370.0281      1.4204665      3436.9359    
      4400   368.00439     -27139.668      3118.4313      1.4204665      3436.9359    
      4500   331.81051     -27165.335      11853.902      1.4204665      3436.9359    
      4600   383.79076     -27279.429      11913.05       1.4204665      3436.9359    
      4700   319.63536     -27275.805      15326.26       1.4204665      3436.9359    
      4800   308.07027     -27311.295      9484.1496      1.4204665      3436.9359    
      4900   298.35782     -27343.814      8935.5913      1.4204665      3436.9359    
      5000   271.11972     -27346.793      4280.2272      1.4204665      3436.9359    
Loop time of 209.481 on 16 procs for 5000 steps with 310 atoms

Performance: 1.031 ns/day, 23.276 hours/ns, 23.868 timesteps/s, 7.399 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 151.91     | 155.19     | 159.63     |  19.3 | 74.08
Bond    | 0.0015114  | 0.0018554  | 0.0021853  |   0.5 |  0.00
Neigh   | 12.644     | 12.823     | 12.969     |   2.9 |  6.12
Comm    | 15.455     | 19.769     | 23.21      |  54.3 |  9.44
Output  | 0.029382   | 0.033931   | 0.038247   |   1.7 |  0.02
Modify  | 20.423     | 20.645     | 20.917     |   4.1 |  9.86
Other   |            | 1.015      |            |       |  0.48

Nlocal:          38.75 ave          46 max          33 min
Histogram: 3 0 1 0 0 1 1 0 0 2
Nghost:        3165.38 ave        3260 max        3074 min
Histogram: 1 1 1 0 1 1 0 2 0 1
Neighs:        24502.2 ave       28948 max       21007 min
Histogram: 3 0 1 0 0 1 1 0 0 2

Total # of neighbors = 196018
Ave neighs/atom = 632.31613
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333-RV-31-vasp_eq.data
System init for write_data ...
undump dump_eq
unfix myMSD

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.4114
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 12.7411
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.5034

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.3384
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal -1.8261
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -7.2027

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 15.4114
variable dlen equal lx-${len0}
variable dlen equal lx-15.4114
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*15.4114
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 15.4114 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 15.4114 xy delta -7.2027 xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 15.4114 xy delta -7.2027 xz delta -1.8261 remap v units box flip no
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos1.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom 100 dump/pos1_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos1 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.8 | 129.2 | 132.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   271.11972     -27346.793      4280.145       3436.9359      15.4114        12.7411        17.5034      
       100   300.76745     -27396.98       3904.0052      3505.6746      15.719628      12.7411        17.5034      
       200   394.53997     -27297.054      5338.0828      3574.4134      16.027856      12.7411        17.5034      
       300   444.03222     -27237.898     -3699.2228      3643.1521      16.336084      12.7411        17.5034      
       400   443.43767     -27243.785     -17629.491      3711.8908      16.644312      12.7411        17.5034      
       500   444.44539     -27302.123      2089.6542      3780.6295      16.95254       12.7411        17.5034      
       600   414.27384     -27379.979     -8096.5721      3849.3682      17.260768      12.7411        17.5034      
       700   423.28653     -27447.727      910.64009      3918.1069      17.568996      12.7411        17.5034      
       800   429.28158     -27461.623     -5178.3418      3986.8457      17.877224      12.7411        17.5034      
       900   366.57212     -27432.671     -10208.66       4055.5844      18.185452      12.7411        17.5034      
      1000   363.32331     -27498.272     -9784.7182      4124.3231      18.49368       12.7411        17.5034      
      1100   396.13122     -27548.798      306.67166      4193.0618      18.801908      12.7411        17.5034      
      1200   414.93762     -27559.233     -1700.0082      4261.8005      19.110136      12.7411        17.5034      
      1300   408.91256     -27528.752     -4281.0863      4330.5393      19.418364      12.7411        17.5034      
      1400   398.8493      -27537.03      -8816.1904      4399.278       19.726592      12.7411        17.5034      
      1500   441.66329     -27568.006      4500.6147      4468.0167      20.03482       12.7411        17.5034      
      1600   423.33329     -27583.435      4226.4674      4536.7554      20.343048      12.7411        17.5034      
      1700   357.96802     -27561.389      13820.811      4605.4941      20.651276      12.7411        17.5034      
      1800   340.65734     -27559.442      5627.8049      4674.2328      20.959504      12.7411        17.5034      
      1900   338.1583      -27606.558     -4467.1554      4742.9716      21.267732      12.7411        17.5034      
      2000   366.27939     -27637.623     -6499.0869      4811.7103      21.57596       12.7411        17.5034      
      2100   337.99867     -27606.841     -14955.323      4880.449       21.884188      12.7411        17.5034      
      2200   374.95353     -27619.239     -4032.4276      4949.1877      22.192416      12.7411        17.5034      
      2300   343.81848     -27611.882     -1950.3981      5017.9264      22.500644      12.7411        17.5034      
      2400   329.83885     -27649.949      674.35202      5086.6652      22.808872      12.7411        17.5034      
      2500   333.45646     -27677.814     -8682.4539      5155.4039      23.1171        12.7411        17.5034      
      2600   309.71543     -27650.872     -8768.5548      5224.1426      23.425328      12.7411        17.5034      
      2700   304.64895     -27655.012     -10390.418      5292.8813      23.733556      12.7411        17.5034      
      2800   334.04251     -27675.643     -9793.7924      5361.62        24.041784      12.7411        17.5034      
      2900   302.80153     -27669.245     -2709.472       5430.3587      24.350012      12.7411        17.5034      
      3000   314.49795     -27721.246     -9082.2724      5499.0975      24.65824       12.7411        17.5034      
      3100   309.73058     -27738.181     -10828.158      5567.8362      24.966468      12.7411        17.5034      
      3200   338.9546      -27767.883      423.76794      5636.5749      25.274696      12.7411        17.5034      
      3300   325.08625     -27758.739     -5038.6078      5705.3136      25.582924      12.7411        17.5034      
      3400   382.3155      -27789.065     -399.55065      5774.0523      25.891152      12.7411        17.5034      
      3500   337.93305     -27756.365     -6686.8267      5842.7911      26.19938       12.7411        17.5034      
      3600   343.28617     -27826.205     -388.49324      5911.5298      26.507608      12.7411        17.5034      
      3700   330.74333     -27818.234     -4954.7988      5980.2685      26.815836      12.7411        17.5034      
      3800   351.17719     -27828.895      3885.172       6049.0072      27.124064      12.7411        17.5034      
      3900   344.12278     -27805.748     -6936.7762      6117.7459      27.432292      12.7411        17.5034      
      4000   324.96778     -27756.11      -5256.3586      6186.4847      27.74052       12.7411        17.5034      
      4100   320.66943     -27754.407     -4546.9261      6255.2234      28.048748      12.7411        17.5034      
      4200   299.96352     -27783.242     -5532.3566      6323.9621      28.356976      12.7411        17.5034      
      4300   344.85505     -27854.299     -6623.184       6392.7008      28.665204      12.7411        17.5034      
      4400   343.4553      -27843.854     -3611.0726      6461.4395      28.973432      12.7411        17.5034      
      4500   335.21871     -27859.947     -8526.5254      6530.1782      29.28166       12.7411        17.5034      
      4600   327.76833     -27864.082      5124.0828      6598.917       29.589888      12.7411        17.5034      
      4700   359.34971     -27938.392     -3740.2295      6667.6557      29.898116      12.7411        17.5034      
      4800   323.17159     -27908.472     -6084.9989      6736.3944      30.206344      12.7411        17.5034      
      4900   300.75821     -27898.801     -8912.967       6805.1331      30.514572      12.7411        17.5034      
      5000   294.65636     -27891.168     -1827.5294      6873.8718      30.8228        12.7411        17.5034      
Loop time of 156.427 on 16 procs for 5000 steps with 310 atoms

Performance: 1.381 ns/day, 17.381 hours/ns, 31.964 timesteps/s, 9.909 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 106.64     | 111.22     | 114.82     |  26.3 | 71.10
Bond    | 0.0014237  | 0.0018112  | 0.0022384  |   0.6 |  0.00
Neigh   | 8.236      | 8.5333     | 8.8746     |   7.1 |  5.46
Comm    | 13.275     | 16.822     | 21.607     |  68.0 | 10.75
Output  | 0.024419   | 0.0291     | 0.032209   |   1.7 |  0.02
Modify  | 18.297     | 18.763     | 19.195     |   7.2 | 11.99
Other   |            | 1.061      |            |       |  0.68

Nlocal:          38.75 ave          64 max          20 min
Histogram: 2 0 0 2 1 1 1 0 0 1
Nghost:        2287.88 ave        2454 max        2098 min
Histogram: 1 0 1 1 0 1 2 0 0 2
Neighs:        12024.6 ave       20166 max        6270 min
Histogram: 2 0 0 2 1 1 1 0 0 1

Total # of neighbors = 96197
Ave neighs/atom = 310.3129
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 12.7411
variable dlen equal ly-${len0}
variable dlen equal ly-12.7411
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*12.7411
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 12.7411 yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 12.7411 yz delta 0.3384 remap v units box flip no
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos2.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom 100 dump/pos2_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos2 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.8 | 129.2 | 132.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   271.11972     -27346.793      4280.145       3436.9359      15.4114        12.7411        17.5034      
       100   301.0776      -27397.076      4101.694       3505.6746      15.4114        12.995922      17.5034      
       200   356.01989     -27324.755      9944.685       3574.4134      15.4114        13.250744      17.5034      
       300   403.86787     -27316.987     -3763.5424      3643.1521      15.4114        13.505566      17.5034      
       400   417.71291     -27260.181      24079.369      3711.8908      15.4114        13.760388      17.5034      
       500   383.88072     -27258.144     -7629.7044      3780.6295      15.4114        14.01521       17.5034      
       600   402.44343     -27298.092      3850.202       3849.3682      15.4114        14.270032      17.5034      
       700   418.1971      -27330.366     -9729.7103      3918.1069      15.4114        14.524854      17.5034      
       800   486.73867     -27392.419     -2696.4768      3986.8457      15.4114        14.779676      17.5034      
       900   398.52065     -27349.329     -9647.8881      4055.5844      15.4114        15.034498      17.5034      
      1000   388.07875     -27352.079     -4437.7156      4124.3231      15.4114        15.28932       17.5034      
      1100   395.8187      -27369.935      4041.4188      4193.0618      15.4114        15.544142      17.5034      
      1200   408.65817     -27453.241      2760.4881      4261.8005      15.4114        15.798964      17.5034      
      1300   399.37242     -27469.122      2933.3234      4330.5393      15.4114        16.053786      17.5034      
      1400   439.96838     -27519.105      1451.7861      4399.278       15.4114        16.308608      17.5034      
      1500   367.32669     -27514.216      5511.7039      4468.0167      15.4114        16.56343       17.5034      
      1600   340.93357     -27471.25      -13946.96       4536.7554      15.4114        16.818252      17.5034      
      1700   381.06184     -27458.041     -12416.876      4605.4941      15.4114        17.073074      17.5034      
      1800   367.48761     -27380.759     -13414.812      4674.2328      15.4114        17.327896      17.5034      
      1900   403.60814     -27432.3       -11537.833      4742.9716      15.4114        17.582718      17.5034      
      2000   406.49709     -27478.271     -4641.0928      4811.7103      15.4114        17.83754       17.5034      
      2100   388.49809     -27477.005      3092.3599      4880.449       15.4114        18.092362      17.5034      
      2200   347.51202     -27515.197     -4902.7648      4949.1877      15.4114        18.347184      17.5034      
      2300   314.14389     -27500.129      992.60558      5017.9264      15.4114        18.602006      17.5034      
      2400   351.87309     -27544.166     -7673.3079      5086.6652      15.4114        18.856828      17.5034      
      2500   339.50993     -27547.219     -11400.783      5155.4039      15.4114        19.11165       17.5034      
      2600   349.07954     -27559.477     -11447.839      5224.1426      15.4114        19.366472      17.5034      
      2700   304.4933      -27536.503     -8933.5389      5292.8813      15.4114        19.621294      17.5034      
      2800   299.55567     -27550.495     -4728.6038      5361.62        15.4114        19.876116      17.5034      
      2900   275.98979     -27548.507     -6648.8071      5430.3587      15.4114        20.130938      17.5034      
      3000   296.47578     -27562.644     -14952.591      5499.0975      15.4114        20.38576       17.5034      
      3100   301.0304      -27528.094     -13809.1        5567.8362      15.4114        20.640582      17.5034      
      3200   335.57479     -27552.859     -14809.53       5636.5749      15.4114        20.895404      17.5034      
      3300   312.49606     -27570.245     -12000.502      5705.3136      15.4114        21.150226      17.5034      
      3400   325.12017     -27581.154     -5757.4671      5774.0523      15.4114        21.405048      17.5034      
      3500   379.84437     -27631.313     -1292.6803      5842.7911      15.4114        21.65987       17.5034      
      3600   301.6738      -27575.61      -6418.7253      5911.5298      15.4114        21.914692      17.5034      
      3700   348.13278     -27618.183     -1843.7482      5980.2685      15.4114        22.169514      17.5034      
      3800   370.6175      -27655.202     -6587.4021      6049.0072      15.4114        22.424336      17.5034      
      3900   318.44166     -27659.287     -1643.9767      6117.7459      15.4114        22.679158      17.5034      
      4000   344.99285     -27768.749     -6270.9284      6186.4847      15.4114        22.93398       17.5034      
      4100   306.84941     -27717.417     -7478.8517      6255.2234      15.4114        23.188802      17.5034      
      4200   297.63764     -27711.748     -6964.3989      6323.9621      15.4114        23.443624      17.5034      
      4300   311.43587     -27660.692     -9574.4011      6392.7008      15.4114        23.698446      17.5034      
      4400   274.32115     -27615.503     -11118.878      6461.4395      15.4114        23.953268      17.5034      
      4500   340.48442     -27668.131     -15740.176      6530.1782      15.4114        24.20809       17.5034      
      4600   285.60475     -27602.654     -9157.9894      6598.917       15.4114        24.462912      17.5034      
      4700   342.65748     -27672.342     -13869.183      6667.6557      15.4114        24.717734      17.5034      
      4800   336.93405     -27679.94      -5201.4564      6736.3944      15.4114        24.972556      17.5034      
      4900   335.65231     -27724.575     -4081.8757      6805.1331      15.4114        25.227378      17.5034      
      5000   338.10376     -27740.829     -2898.6004      6873.8718      15.4114        25.4822        17.5034      
Loop time of 138.302 on 16 procs for 5000 steps with 310 atoms

Performance: 1.562 ns/day, 15.367 hours/ns, 36.153 timesteps/s, 11.207 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 94.447     | 96.337     | 99.4       |  18.0 | 69.66
Bond    | 0.0015708  | 0.0017528  | 0.0020708  |   0.4 |  0.00
Neigh   | 7.3026     | 7.5132     | 7.8364     |   7.0 |  5.43
Comm    | 12.609     | 15.56      | 17.506     |  44.9 | 11.25
Output  | 0.031105   | 0.037745   | 0.043067   |   2.2 |  0.03
Modify  | 17.295     | 17.763     | 18.018     |   6.4 | 12.84
Other   |            | 1.089      |            |       |  0.79

Nlocal:          38.75 ave          55 max          25 min
Histogram: 2 0 0 1 2 0 1 1 0 1
Nghost:        1779.75 ave        1939 max        1612 min
Histogram: 1 1 0 1 1 1 1 0 0 2
Neighs:        11951.6 ave       16926 max        7568 min
Histogram: 2 0 0 1 1 1 2 0 0 1

Total # of neighbors = 95613
Ave neighs/atom = 308.42903
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.5034
variable dlen equal lz-${len0}
variable dlen equal lz-17.5034
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*17.5034
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 17.5034 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos3.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom 100 dump/pos3_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos3 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.8 | 129.2 | 132.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   271.11972     -27346.793      4280.145       3436.9359      15.4114        12.7411        17.5034      
       100   296.99116     -27396.709      3952.569       3505.6746      15.4114        12.7411        17.853468    
       200   324.30399     -27300.258      15986.601      3574.4134      15.4114        12.7411        18.203536    
       300   395.54901     -27316.174      2213.5676      3643.1521      15.4114        12.7411        18.553604    
       400   380.66683     -27276.786      9395.3376      3711.8908      15.4114        12.7411        18.903672    
       500   366.05113     -27206.351      14086.502      3780.6295      15.4114        12.7411        19.25374     
       600   417.16251     -27284.999      583.30912      3849.3682      15.4114        12.7411        19.603808    
       700   419.34273     -27267.797      436.26755      3918.1069      15.4114        12.7411        19.953876    
       800   359.00086     -27233.158      2988.4465      3986.8457      15.4114        12.7411        20.303944    
       900   386.17099     -27302.263      9524.5398      4055.5844      15.4114        12.7411        20.654012    
      1000   410.00723     -27318.062      2712.0849      4124.3231      15.4114        12.7411        21.00408     
      1100   379.89295     -27345.619      7470.0967      4193.0618      15.4114        12.7411        21.354148    
      1200   361.83504     -27339.146      5010.8063      4261.8005      15.4114        12.7411        21.704216    
      1300   369.18858     -27342.419      5240.2647      4330.5393      15.4114        12.7411        22.054284    
      1400   387.45639     -27394.033      3962.4766      4399.278       15.4114        12.7411        22.404352    
      1500   362.9238      -27390.726      10154.115      4468.0167      15.4114        12.7411        22.75442     
      1600   369.50739     -27427.639      1341.4551      4536.7554      15.4114        12.7411        23.104488    
      1700   361.88359     -27403.303     -5091.7571      4605.4941      15.4114        12.7411        23.454556    
      1800   381.21446     -27393.512      5603.9852      4674.2328      15.4114        12.7411        23.804624    
      1900   349.86345     -27377.593      8259.2453      4742.9716      15.4114        12.7411        24.154692    
      2000   343.59495     -27430.003     -4826.8628      4811.7103      15.4114        12.7411        24.50476     
      2100   381.41967     -27374.533      979.29068      4880.449       15.4114        12.7411        24.854828    
      2200   342.02867     -27358.461     -3793.674       4949.1877      15.4114        12.7411        25.204896    
      2300   387.73207     -27294.043      4285.2609      5017.9264      15.4114        12.7411        25.554964    
      2400   398.51918     -27331.081      3234.6931      5086.6652      15.4114        12.7411        25.905032    
      2500   390.54645     -27293.67       5562.9033      5155.4039      15.4114        12.7411        26.2551      
      2600   415.12877     -27347.959     -2771.9893      5224.1426      15.4114        12.7411        26.605168    
      2700   469.02809     -27350.819     -10501.492      5292.8813      15.4114        12.7411        26.955236    
      2800   425.03488     -27325.066     -11261.756      5361.62        15.4114        12.7411        27.305304    
      2900   470.5636      -27382.784      3137.1656      5430.3587      15.4114        12.7411        27.655372    
      3000   392.85589     -27329.274     -2528.6983      5499.0975      15.4114        12.7411        28.00544     
      3100   390.02082     -27373.124     -10843.206      5567.8362      15.4114        12.7411        28.355508    
      3200   461.48116     -27380.795     -6334.7628      5636.5749      15.4114        12.7411        28.705576    
      3300   478.06839     -27396.027      1915.4542      5705.3136      15.4114        12.7411        29.055644    
      3400   422.49852     -27394.459     -4052.6883      5774.0523      15.4114        12.7411        29.405712    
      3500   471.14886     -27384.117     -4043.2844      5842.7911      15.4114        12.7411        29.75578     
      3600   396.94264     -27331.663      509.67393      5911.5298      15.4114        12.7411        30.105848    
      3700   424.11261     -27394.277     -44.316356      5980.2685      15.4114        12.7411        30.455916    
      3800   352.25513     -27414.245     -11990.104      6049.0072      15.4114        12.7411        30.805984    
      3900   385.24073     -27452.166     -5106.4875      6117.7459      15.4114        12.7411        31.156052    
      4000   341.55818     -27498.615     -9493.8044      6186.4847      15.4114        12.7411        31.50612     
      4100   356.21776     -27495.202     -2043.115       6255.2234      15.4114        12.7411        31.856188    
      4200   288.2052      -27443.237      272.90401      6323.9621      15.4114        12.7411        32.206256    
      4300   322.97728     -27524.638     -2267.7976      6392.7008      15.4114        12.7411        32.556324    
      4400   302.86218     -27524.799     -3707.168       6461.4395      15.4114        12.7411        32.906392    
      4500   330.96173     -27567.506     -6146.5313      6530.1782      15.4114        12.7411        33.25646     
      4600   296.98696     -27568.219     -3140.4359      6598.917       15.4114        12.7411        33.606528    
      4700   334.11341     -27631.784     -5978.9984      6667.6557      15.4114        12.7411        33.956596    
      4800   309.97135     -27648.249      5020.0902      6736.3944      15.4114        12.7411        34.306664    
      4900   270.14963     -27553.254      2166.3899      6805.1331      15.4114        12.7411        34.656732    
      5000   311.29776     -27578.047     -5284.8968      6873.8718      15.4114        12.7411        35.0068      
Loop time of 146.292 on 16 procs for 5000 steps with 310 atoms

Performance: 1.476 ns/day, 16.255 hours/ns, 34.178 timesteps/s, 10.595 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 95.478     | 102.7      | 107.43     |  37.0 | 70.20
Bond    | 0.0014177  | 0.0017582  | 0.0020981  |   0.5 |  0.00
Neigh   | 6.9623     | 7.4447     | 7.755      |   9.4 |  5.09
Comm    | 12.24      | 17.122     | 24.559     |  93.5 | 11.70
Output  | 0.024389   | 0.03106    | 0.035443   |   2.3 |  0.02
Modify  | 17.571     | 17.929     | 18.448     |   7.5 | 12.26
Other   |            | 1.067      |            |       |  0.73

Nlocal:          38.75 ave          49 max          30 min
Histogram: 1 1 2 0 1 0 0 1 1 1
Nghost:        1945.38 ave        2035 max        1842 min
Histogram: 2 0 0 2 0 0 0 1 1 2
Neighs:        12210.4 ave       16209 max        8884 min
Histogram: 1 2 0 0 2 1 0 0 1 1

Total # of neighbors = 97683
Ave neighs/atom = 315.10645
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 15.4114
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.3384)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*15.4114
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_p all deform 100 yz delta ${delta} remap v units box flip no
fix deform_p all deform 100 yz delta 15.4114 remap v units box flip no
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos4.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom 100 dump/pos4_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos4 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.8 | 129.2 | 132.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   271.11972     -27346.793      4280.145       3436.9359      15.4114        12.7411        17.5034      
       100   290.44934     -27385.74       3230.9214      3436.9359      15.4114        12.7411        17.5034      
       200   349.13535     -27325.102      24777.296      3436.9359      15.4114        12.7411        17.5034      
       300   446.74368     -27312.007      7222.254       3436.9359      15.4114        12.7411        17.5034      
       400   396.0901      -27344.271      13362.946      3436.9359      15.4114        12.7411        17.5034      
       500   352.30574     -27372.445     -5432.9395      3436.9359      15.4114        12.7411        17.5034      
       600   416.24741     -27425.081      4522.4939      3436.9359      15.4114        12.7411        17.5034      
       700   342.72115     -27451.366      10605.69       3436.9359      15.4114        12.7411        17.5034      
       800   330.46475     -27467.527      7086.9993      3436.9359      15.4114        12.7411        17.5034      
       900   343.82625     -27525.695     -1481.898       3436.9359      15.4114        12.7411        17.5034      
      1000   446.23121     -27578.473      3179.0279      3436.9359      15.4114        12.7411        17.5034      
      1100   450.40149     -27638.811      15036.641      3436.9359      15.4114        12.7411        17.5034      
      1200   397.54092     -27623.115      10518.886      3436.9359      15.4114        12.7411        17.5034      
      1300   427.80708     -27697.159      18720.467      3436.9359      15.4114        12.7411        17.5034      
      1400   303.46445     -27660.706     -2309.7908      3436.9359      15.4114        12.7411        17.5034      
      1500   360.4569      -27712.546      14248.87       3436.9359      15.4114        12.7411        17.5034      
      1600   361.48232     -27526.137      8559.2242      3436.9359      15.4114        12.7411        17.5034      
      1700   332.50676     -27585.242      828.38538      3436.9359      15.4114        12.7411        17.5034      
      1800   395.82822     -27657.876      11474.213      3436.9359      15.4114        12.7411        17.5034      
      1900   355.16327     -27684.264      12394.154      3436.9359      15.4114        12.7411        17.5034      
      2000   318.71608     -27721.481      6027.3449      3436.9359      15.4114        12.7411        17.5034      
      2100   320.39031     -27740.742      12803.465      3436.9359      15.4114        12.7411        17.5034      
      2200   317.45447     -27759.413     -530.66641      3436.9359      15.4114        12.7411        17.5034      
      2300   337.29736     -27777.564      6707.5728      3436.9359      15.4114        12.7411        17.5034      
      2400   342.98878     -27813.438      33072.757      3436.9359      15.4114        12.7411        17.5034      
      2500   326.60645     -27821.766      4001.6724      3436.9359      15.4114        12.7411        17.5034      
      2600   333.82832     -27786.356      4562.628       3436.9359      15.4114        12.7411        17.5034      
      2700   376.84379     -27771.5        23557.081      3436.9359      15.4114        12.7411        17.5034      
      2800   382.00803     -27807.343      727.53804      3436.9359      15.4114        12.7411        17.5034      
      2900   324.85261     -27837.643     -4173.9169      3436.9359      15.4114        12.7411        17.5034      
      3000   349.02327     -27825.408      6778.6221      3436.9359      15.4114        12.7411        17.5034      
      3100   310.97425     -27806.454     -2648.7884      3436.9359      15.4114        12.7411        17.5034      
      3200   333.42971     -27795.953      4702.3986      3436.9359      15.4114        12.7411        17.5034      
      3300   308.44678     -27797.567     -2205.8634      3436.9359      15.4114        12.7411        17.5034      
      3400   347.70387     -27823.114      5409.0522      3436.9359      15.4114        12.7411        17.5034      
      3500   354.03331     -27867.265     -8881.67        3436.9359      15.4114        12.7411        17.5034      
      3600   355.68019     -27876.073      6823.7891      3436.9359      15.4114        12.7411        17.5034      
      3700   347.57866     -27870.849      4529.8416      3436.9359      15.4114        12.7411        17.5034      
      3800   345.7605      -27895.183      9596.2474      3436.9359      15.4114        12.7411        17.5034      
      3900   354.44766     -27890.974     -1436.9726      3436.9359      15.4114        12.7411        17.5034      
      4000   312.94893     -27874.723      7420.6575      3436.9359      15.4114        12.7411        17.5034      
      4100   325.48418     -27860.452      9181.3532      3436.9359      15.4114        12.7411        17.5034      
      4200   327.4379      -27862.555     -1965.0458      3436.9359      15.4114        12.7411        17.5034      
      4300   308.0795      -27882.848      14944.931      3436.9359      15.4114        12.7411        17.5034      
      4400   319.95877     -27917.085      14716.861      3436.9359      15.4114        12.7411        17.5034      
      4500   303.20784     -27914.764      1892.0156      3436.9359      15.4114        12.7411        17.5034      
      4600   298.98676     -27945.982     -2415.7094      3436.9359      15.4114        12.7411        17.5034      
      4700   331.35245     -27945.328      10750.363      3436.9359      15.4114        12.7411        17.5034      
      4800   321.93041     -27924.942     -372.87434      3436.9359      15.4114        12.7411        17.5034      
      4900   295.21189     -27946.971      4197.5657      3436.9359      15.4114        12.7411        17.5034      
      5000   356.2312      -27977.958     -1316.3405      3436.9359      15.4114        12.7411        17.5034      
Loop time of 235.736 on 16 procs for 5000 steps with 310 atoms

Performance: 0.916 ns/day, 26.193 hours/ns, 21.210 timesteps/s, 6.575 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 173.02     | 175.44     | 179.23     |  14.6 | 74.42
Bond    | 0.0016266  | 0.0018867  | 0.0023346  |   0.6 |  0.00
Neigh   | 14.526     | 14.861     | 15.095     |   5.4 |  6.30
Comm    | 17.543     | 21.395     | 23.999     |  44.0 |  9.08
Output  | 0.02904    | 0.035717   | 0.04131    |   2.3 |  0.02
Modify  | 22.678     | 23.031     | 23.529     |   6.3 |  9.77
Other   |            | 0.969      |            |       |  0.41

Nlocal:          38.75 ave          46 max          29 min
Histogram: 2 0 0 0 1 0 1 1 2 1
Nghost:        4118.38 ave        4180 max        4058 min
Histogram: 4 0 0 0 0 0 0 0 1 3
Neighs:        24445.4 ave       28775 max       18479 min
Histogram: 2 0 0 0 1 0 1 1 1 2

Total # of neighbors = 195563
Ave neighs/atom = 630.84839
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 12.7411
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz--1.8261)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*12.7411
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_p all deform 100 xz delta ${delta} remap v units box flip no
fix deform_p all deform 100 xz delta 12.7411 remap v units box flip no
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos5.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom 100 dump/pos5_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos5 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.8 | 129.2 | 132.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   271.11972     -27346.793      4280.145       3436.9359      15.4114        12.7411        17.5034      
       100   301.45461     -27397.089      4073.5151      3436.9359      15.4114        12.7411        17.5034      
       200   310.46404     -27378.847      21412.128      3436.9359      15.4114        12.7411        17.5034      
       300   335.06287     -27390.882      11102.165      3436.9359      15.4114        12.7411        17.5034      
       400   323.37998     -27395.027      8649.3357      3436.9359      15.4114        12.7411        17.5034      
       500   353.43372     -27399.959      9900.4859      3436.9359      15.4114        12.7411        17.5034      
       600   357.09702     -27363.394     -8898.9174      3436.9359      15.4114        12.7411        17.5034      
       700   330.87858     -27342.115      12813.02       3436.9359      15.4114        12.7411        17.5034      
       800   358.94231     -27381.554      11205.105      3436.9359      15.4114        12.7411        17.5034      
       900   346.58411     -27315.341      7504.912       3436.9359      15.4114        12.7411        17.5034      
      1000   372.69991     -27381.669      4395.0005      3436.9359      15.4114        12.7411        17.5034      
      1100   373.0192      -27231.908      7092.5676      3436.9359      15.4114        12.7411        17.5034      
      1200   365.73398     -27281.006      13265.67       3436.9359      15.4114        12.7411        17.5034      
      1300   320.25045     -27301.318      7247.3429      3436.9359      15.4114        12.7411        17.5034      
      1400   350.58376     -27331.077      17585.219      3436.9359      15.4114        12.7411        17.5034      
      1500   418.74038     -27390.54       3431.4994      3436.9359      15.4114        12.7411        17.5034      
      1600   313.35841     -27386.567      9208.913       3436.9359      15.4114        12.7411        17.5034      
      1700   386.66724     -27528.846      10375.196      3436.9359      15.4114        12.7411        17.5034      
      1800   388.71117     -27511.102      4985.4968      3436.9359      15.4114        12.7411        17.5034      
      1900   340.36167     -27550.401      7469.5243      3436.9359      15.4114        12.7411        17.5034      
      2000   289.00307     -27578.881     -2843.1193      3436.9359      15.4114        12.7411        17.5034      
      2100   320.98543     -27614.795      3745.786       3436.9359      15.4114        12.7411        17.5034      
      2200   350.68945     -27646.568      12612.02       3436.9359      15.4114        12.7411        17.5034      
      2300   327.42873     -27673.812      135.32638      3436.9359      15.4114        12.7411        17.5034      
      2400   292.12812     -27679.636      8652.1254      3436.9359      15.4114        12.7411        17.5034      
      2500   260.55369     -27673.039      9660.0855      3436.9359      15.4114        12.7411        17.5034      
      2600   276.46326     -27698.214     -2914.2739      3436.9359      15.4114        12.7411        17.5034      
      2700   318.52064     -27674.451      17942.913      3436.9359      15.4114        12.7411        17.5034      
      2800   386.93065     -27665.423      4233.1532      3436.9359      15.4114        12.7411        17.5034      
      2900   339.53247     -27719.007      6488.5723      3436.9359      15.4114        12.7411        17.5034      
      3000   297.83717     -27774.873      8537.1204      3436.9359      15.4114        12.7411        17.5034      
      3100   309.52628     -27819.512     -4561.6663      3436.9359      15.4114        12.7411        17.5034      
      3200   321.47259     -27807.837      3951.9493      3436.9359      15.4114        12.7411        17.5034      
      3300   279.67948     -27792.386      3301.6408      3436.9359      15.4114        12.7411        17.5034      
      3400   288.01327     -27829.5        345.83094      3436.9359      15.4114        12.7411        17.5034      
      3500   328.56977     -27878.416      4756.7865      3436.9359      15.4114        12.7411        17.5034      
      3600   365.09718     -27896.416      13127.538      3436.9359      15.4114        12.7411        17.5034      
      3700   369.10127     -27901.24       14958.458      3436.9359      15.4114        12.7411        17.5034      
      3800   315.3567      -27890.279      12652.27       3436.9359      15.4114        12.7411        17.5034      
      3900   325.65906     -27908.664      16897.834      3436.9359      15.4114        12.7411        17.5034      
      4000   289.72829     -27900.603      13477.828      3436.9359      15.4114        12.7411        17.5034      
      4100   342.71571     -27945.571      7264.4942      3436.9359      15.4114        12.7411        17.5034      
      4200   325.87429     -27936.562      1583.6763      3436.9359      15.4114        12.7411        17.5034      
      4300   332.42186     -27930.485      13667.695      3436.9359      15.4114        12.7411        17.5034      
      4400   321.61218     -27908.856      437.29932      3436.9359      15.4114        12.7411        17.5034      
      4500   321.93237     -27901.194      2810.9909      3436.9359      15.4114        12.7411        17.5034      
      4600   349.61461     -27936.854      8255.3448      3436.9359      15.4114        12.7411        17.5034      
      4700   347.64739     -27930.769      12531.93       3436.9359      15.4114        12.7411        17.5034      
      4800   353.65492     -27935.559      3402.8035      3436.9359      15.4114        12.7411        17.5034      
      4900   303.43553     -27914.881      2068.8878      3436.9359      15.4114        12.7411        17.5034      
      5000   316.05636     -27928.034      9881.0803      3436.9359      15.4114        12.7411        17.5034      
Loop time of 219.123 on 16 procs for 5000 steps with 310 atoms

Performance: 0.986 ns/day, 24.347 hours/ns, 22.818 timesteps/s, 7.074 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 156.72     | 161.8      | 166.94     |  27.2 | 73.84
Bond    | 0.0016058  | 0.0019557  | 0.0023887  |   0.6 |  0.00
Neigh   | 13.853     | 14.12      | 14.513     |   5.2 |  6.44
Comm    | 15.691     | 20.644     | 25.965     |  75.2 |  9.42
Output  | 0.022564   | 0.026565   | 0.029329   |   1.5 |  0.01
Modify  | 21.187     | 21.534     | 21.942     |   5.4 |  9.83
Other   |            | 0.9984     |            |       |  0.46

Nlocal:          38.75 ave          45 max          29 min
Histogram: 1 0 0 1 0 1 2 0 2 1
Nghost:        3480.75 ave        3551 max        3392 min
Histogram: 2 0 0 1 0 1 0 2 0 2
Neighs:        24506.9 ave       28177 max       18641 min
Histogram: 1 0 0 1 0 1 1 1 2 1

Total # of neighbors = 196055
Ave neighs/atom = 632.43548
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.5034
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--7.2027)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*17.5034
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_p all deform 100 xy delta ${delta} remap v units box flip no
fix deform_p all deform 100 xy delta 17.5034 remap v units box flip no

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos6.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom 100 dump/pos6_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos6 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 125.8 | 129.2 | 132.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   271.11972     -27346.793      4280.145       3436.9359      15.4114        12.7411        17.5034      
       100   300.27246     -27396.412      4362.4287      3436.9359      15.4114        12.7411        17.5034      
       200   387.71061     -27275.487      12511.977      3436.9359      15.4114        12.7411        17.5034      
       300   452.57909     -27287.991      12158.624      3436.9359      15.4114        12.7411        17.5034      
       400   486.03798     -27241.12       20741.912      3436.9359      15.4114        12.7411        17.5034      
       500   468.56748     -27332.055      13313.397      3436.9359      15.4114        12.7411        17.5034      
       600   459.51369     -27375.89       15440.812      3436.9359      15.4114        12.7411        17.5034      
       700   438.89253     -27450.374      17271.021      3436.9359      15.4114        12.7411        17.5034      
       800   421.32419     -27556.099      8019.7031      3436.9359      15.4114        12.7411        17.5034      
       900   379.69993     -27569.44       5474.7378      3436.9359      15.4114        12.7411        17.5034      
      1000   469.80209     -27534.148      16594.3        3436.9359      15.4114        12.7411        17.5034      
      1100   459.90696     -27538.421      6511.1615      3436.9359      15.4114        12.7411        17.5034      
      1200   357.69961     -27519.156      8728.9414      3436.9359      15.4114        12.7411        17.5034      
      1300   360.91267     -27579.521      8053.6199      3436.9359      15.4114        12.7411        17.5034      
      1400   390.69048     -27629.47       8574.7059      3436.9359      15.4114        12.7411        17.5034      
      1500   399.29774     -27694.515      2288.2714      3436.9359      15.4114        12.7411        17.5034      
      1600   403.92009     -27679.389      1975.2781      3436.9359      15.4114        12.7411        17.5034      
      1700   380.93224     -27687.145     -4860.5098      3436.9359      15.4114        12.7411        17.5034      
      1800   371.72436     -27680.085     -786.80005      3436.9359      15.4114        12.7411        17.5034      
      1900   386.64722     -27670.507     -4320.6063      3436.9359      15.4114        12.7411        17.5034      
      2000   415.68353     -27744.115      6190.6152      3436.9359      15.4114        12.7411        17.5034      
      2100   411.98235     -27777.713      175.15068      3436.9359      15.4114        12.7411        17.5034      
      2200   398.93602     -27814.584      8114.1384      3436.9359      15.4114        12.7411        17.5034      
      2300   340.97861     -27734.489      11978.366      3436.9359      15.4114        12.7411        17.5034      
      2400   347.71327     -27751.423      6186.9137      3436.9359      15.4114        12.7411        17.5034      
      2500   354.75669     -27770.085     -7788.7081      3436.9359      15.4114        12.7411        17.5034      
      2600   404.41897     -27781.488      1838.9768      3436.9359      15.4114        12.7411        17.5034      
      2700   404.86942     -27777.106     -6764.1202      3436.9359      15.4114        12.7411        17.5034      
      2800   308.20518     -27778.546     -9801.2414      3436.9359      15.4114        12.7411        17.5034      
      2900   313.58211     -27790.243      19142.235      3436.9359      15.4114        12.7411        17.5034      
      3000   330.47871     -27816.329      6772.6611      3436.9359      15.4114        12.7411        17.5034      
      3100   384.51805     -27761.515      2400.4254      3436.9359      15.4114        12.7411        17.5034      
      3200   347.86207     -27764.804     -2564.6192      3436.9359      15.4114        12.7411        17.5034      
      3300   358.60096     -27738.665     -4101.4771      3436.9359      15.4114        12.7411        17.5034      
      3400   404.76976     -27791.098      4515.0874      3436.9359      15.4114        12.7411        17.5034      
      3500   312.79553     -27703.882      2863.3908      3436.9359      15.4114        12.7411        17.5034      
      3600   338.4884      -27829.787     -876.58691      3436.9359      15.4114        12.7411        17.5034      
      3700   375.95056     -27842.154      15709.204      3436.9359      15.4114        12.7411        17.5034      
      3800   331.44529     -27810.849      6774.9959      3436.9359      15.4114        12.7411        17.5034      
      3900   286.47524     -27779.838      9376.8464      3436.9359      15.4114        12.7411        17.5034      
      4000   328.34269     -27795.545      12955.478      3436.9359      15.4114        12.7411        17.5034      
      4100   344.97968     -27746.577      6933.7755      3436.9359      15.4114        12.7411        17.5034      
      4200   398.65764     -27644.077      571.61731      3436.9359      15.4114        12.7411        17.5034      
      4300   465.76743     -27771.575     -10667.365      3436.9359      15.4114        12.7411        17.5034      
      4400   434.53548     -27800.928      2552.8685      3436.9359      15.4114        12.7411        17.5034      
      4500   381.38367     -27764.653     -7509.0836      3436.9359      15.4114        12.7411        17.5034      
      4600   371.16592     -27778.122     -17116.597      3436.9359      15.4114        12.7411        17.5034      
      4700   410.52826     -27767.955      902.69613      3436.9359      15.4114        12.7411        17.5034      
      4800   300.73182     -27719.83       7864.2345      3436.9359      15.4114        12.7411        17.5034      
      4900   344.68533     -27787.237     -8695.8273      3436.9359      15.4114        12.7411        17.5034      
      5000   365.1581      -27772.707     -8905.5943      3436.9359      15.4114        12.7411        17.5034      
Loop time of 207.467 on 16 procs for 5000 steps with 310 atoms

Performance: 1.041 ns/day, 23.052 hours/ns, 24.100 timesteps/s, 7.471 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 147.29     | 152.04     | 155.81     |  25.2 | 73.28
Bond    | 0.0016219  | 0.0019168  | 0.0022647  |   0.5 |  0.00
Neigh   | 12.996     | 13.192     | 13.479     |   3.7 |  6.36
Comm    | 15.839     | 19.637     | 24.324     |  70.8 |  9.47
Output  | 0.023789   | 0.028864   | 0.032198   |   1.9 |  0.01
Modify  | 21.387     | 21.648     | 21.872     |   3.4 | 10.43
Other   |            | 0.9187     |            |       |  0.44

Nlocal:          38.75 ave          44 max          30 min
Histogram: 1 0 1 0 0 0 3 0 1 2
Nghost:        3385.38 ave        3409 max        3346 min
Histogram: 1 1 0 0 0 2 0 0 2 2
Neighs:        24498.9 ave       27931 max       19194 min
Histogram: 1 1 0 0 0 0 3 0 1 2

Total # of neighbors = 195991
Ave neighs/atom = 632.22903
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:21:57
