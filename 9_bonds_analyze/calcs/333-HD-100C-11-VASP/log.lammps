LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 100
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 50
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 1.0                  # the deformation magnitude 0.01

variable FF string "SiOCHN_2018.ff C H O Si"   # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si
variable structure string 333-HD-100C-11-VASP

# Read the initial sctructure
# box tilt large
read_data       ${structure}.data
read_data       333-HD-100C-11-VASP.data
Reading data file ...
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.006 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
fix bondinfo all reaxff/bonds 1 bonds_opt.reaxff

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
dump dump_opt all custom 1 dump/dump_opt.lammpstrj id type q x y z
minimize 1.0e-6 1.0e-6 100 1000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -29.52 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.9 | 146.7 | 150.2 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0             -40625.304      0             -40625.304      20658.281    
        41   0             -41414.148      0             -41414.148      7268.4029    
Loop time of 7.62962 on 16 procs for 41 steps with 366 atoms

97.0% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
     -40625.3037353297  -41414.1104117509  -41414.1483360596
  Force two-norm initial, final = 1618.1727 364.43939
  Force max component initial, final = 407.82721 191.17519
  Final line search alpha, max atom move = 1.9735258e-05 0.0037728917
  Iterations, force evaluations = 41 134

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 5.086      | 5.8277     | 6.1693     |  13.4 | 76.38
Bond    | 6.8551e-05 | 8.145e-05  | 9.3901e-05 |   0.0 |  0.00
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.12825    | 0.4714     | 1.2124     |  47.1 |  6.18
Output  | 0.0090603  | 0.014877   | 0.019107   |   2.3 |  0.19
Modify  | 1.3014     | 1.3018     | 1.3021     |   0.0 | 17.06
Other   |            | 0.01376    |            |       |  0.18

Nlocal:          45.75 ave          53 max          35 min
Histogram: 1 0 1 0 1 1 0 1 1 2
Nghost:        3574.38 ave        3679 max        3484 min
Histogram: 2 0 1 1 0 1 1 0 1 1
Neighs:          32768 ave       37783 max       25274 min
Histogram: 1 0 1 0 1 1 0 1 1 2

Total # of neighbors = 262144
Ave neighs/atom = 716.24044
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-HD-100C-11-VASP_opt.data
System init for write_data ...
undump dump_opt
unfix bondinfo
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
dump dump_eq all custom ${nthermo} dump/dump_eq.lammpstrj id type q x y z
dump dump_eq all custom 100 dump/dump_eq.lammpstrj id type q x y z

# compute MSD
compute msd1 all msd
fix myMSD all ave/time ${nevery} ${nrepeat} ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 ${nrepeat} ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 10 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 10 100 c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out

run ${nequil}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.7 | 140.5 | 144 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -41414.148      11432.247      1.9939932      3583.6077    
       100   206.11508     -41271.96      -171.84047      1.9939932      3583.6077    
       200   239.53485     -41245.684      4633.2381      1.9939932      3583.6077    
       300   278.18458     -41220.794      3205.2076      1.9939932      3583.6077    
       400   272.44355     -41155.968      8233.4994      1.9939932      3583.6077    
       500   325.91879     -41174.018      6816.5         1.9939932      3583.6077    
       600   313.36994     -41152.334      13757.013      1.9939932      3583.6077    
       700   318.4775      -41183.163      20835.218      1.9939932      3583.6077    
       800   291.12002     -41191.443      15371.571      1.9939932      3583.6077    
       900   289.89687     -41208.077      14366.136      1.9939932      3583.6077    
      1000   298.2519      -41202.594      22470.35       1.9939932      3583.6077    
      1100   297.11457     -41181.564      15042.195      1.9939932      3583.6077    
      1200   302.17193     -41180.431      2139.6233      1.9939932      3583.6077    
      1300   290.03564     -41171.139      20840.74       1.9939932      3583.6077    
      1400   286.15536     -41169.315      5106.3239      1.9939932      3583.6077    
      1500   307.98657     -41184.316      14226.194      1.9939932      3583.6077    
      1600   295.93722     -41170.687      11096.794      1.9939932      3583.6077    
      1700   295.25747     -41184.992      831.63267      1.9939932      3583.6077    
      1800   281.64458     -41192.481      14083.831      1.9939932      3583.6077    
      1900   298.46737     -41217.715      13105.375      1.9939932      3583.6077    
      2000   295.17647     -41193.667      12574.359      1.9939932      3583.6077    
      2100   318.28824     -41184.742      14281.496      1.9939932      3583.6077    
      2200   294.04188     -41156.802      25745.597      1.9939932      3583.6077    
      2300   300.62321     -41185.656      7835.433       1.9939932      3583.6077    
      2400   279.32693     -41177.241      3351.0743      1.9939932      3583.6077    
      2500   267.26249     -41154.864      11482.398      1.9939932      3583.6077    
      2600   302.49801     -41189.317      24788.357      1.9939932      3583.6077    
      2700   296.94815     -41185.365      18873.483      1.9939932      3583.6077    
      2800   289.98199     -41178.27       10790.139      1.9939932      3583.6077    
      2900   303.82838     -41177.645      15787.312      1.9939932      3583.6077    
      3000   311.11197     -41156.846      11128.801      1.9939932      3583.6077    
      3100   328.94596     -41168.316      14504.661      1.9939932      3583.6077    
      3200   299.38846     -41176.041      10901.905      1.9939932      3583.6077    
      3300   306.60234     -41195.481      23357.829      1.9939932      3583.6077    
      3400   289.59763     -41180.229      6105.363       1.9939932      3583.6077    
      3500   294.85915     -41184.806      18204.273      1.9939932      3583.6077    
      3600   303.8472      -41181.403      1071.9638      1.9939932      3583.6077    
      3700   318.31752     -41170.591      1551.9258      1.9939932      3583.6077    
      3800   324.67362     -41181.526      6306.8706      1.9939932      3583.6077    
      3900   295.48749     -41189.827      12470.367      1.9939932      3583.6077    
      4000   293.82271     -41190.118      12231.204      1.9939932      3583.6077    
      4100   306.14166     -41186.289      18736.306      1.9939932      3583.6077    
      4200   333.5146      -41198.523      4572.9372      1.9939932      3583.6077    
      4300   285.79424     -41160.353      9550.4542      1.9939932      3583.6077    
      4400   289.03943     -41191.763      6310.0734      1.9939932      3583.6077    
      4500   293.23422     -41201.222      21140.337      1.9939932      3583.6077    
      4600   293.532       -41194.045      23803.481      1.9939932      3583.6077    
      4700   300.23927     -41183.349      23508.918      1.9939932      3583.6077    
      4800   305.52006     -41170.791      15193.805      1.9939932      3583.6077    
      4900   335.07115     -41203.329      16774.341      1.9939932      3583.6077    
      5000   295.54433     -41196.6        10628.852      1.9939932      3583.6077    
Loop time of 284.623 on 16 procs for 5000 steps with 366 atoms

Performance: 0.759 ns/day, 31.625 hours/ns, 17.567 timesteps/s, 6.430 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 211.61     | 217.15     | 222        |  19.3 | 76.29
Bond    | 0.0015954  | 0.0019326  | 0.0025672  |   0.6 |  0.00
Neigh   | 18.173     | 18.863     | 19.473     |   9.6 |  6.63
Comm    | 18.9       | 23.702     | 29.271     |  57.9 |  8.33
Output  | 0.030285   | 0.03484    | 0.040323   |   1.7 |  0.01
Modify  | 23.283     | 23.832     | 24.395     |   6.4 |  8.37
Other   |            | 1.037      |            |       |  0.36

Nlocal:          45.75 ave          51 max          37 min
Histogram: 1 0 0 1 1 1 0 0 2 2
Nghost:        3605.25 ave        3680 max        3527 min
Histogram: 1 1 0 1 0 3 0 0 0 2
Neighs:          32759 ave       36667 max       26640 min
Histogram: 1 0 0 1 1 1 0 0 3 1

Total # of neighbors = 262072
Ave neighs/atom = 716.04372
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333-HD-100C-11-VASP_eq.data
System init for write_data ...
undump dump_eq
unfix myMSD

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.0372
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.535
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.6074

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.0807
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal -0.1585
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -7.4931

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 15.0372
variable dlen equal lx-${len0}
variable dlen equal lx-15.0372
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*15.0372
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 15.0372 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 15.0372 xy delta -7.4931 xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 15.0372 xy delta -7.4931 xz delta -0.1585 remap v units box flip no
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos1.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom 100 dump/pos1_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos1 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.6 | 146.1 | 148.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   295.54433     -41196.6        10630.055      3583.6077      15.0372        13.535         17.6074      
       100   293.7586      -41212.13      -465.12083      3655.2799      15.337944      13.535         17.6074      
       200   384.38083     -41048.304     -8936.584       3726.9521      15.638688      13.535         17.6074      
       300   453.09253     -40946.968     -3888.3913      3798.6242      15.939432      13.535         17.6074      
       400   401.95461     -40933.207     -9799.3102      3870.2964      16.240176      13.535         17.6074      
       500   415.83674     -40865.634     -27310.41       3941.9685      16.54092       13.535         17.6074      
       600   495.09916     -40867.344     -32880.069      4013.6407      16.841664      13.535         17.6074      
       700   489.22201     -40857.806     -32863.1        4085.3128      17.142408      13.535         17.6074      
       800   481.10659     -40788.059     -37256.224      4156.985       17.443152      13.535         17.6074      
       900   446.15728     -40714.684     -33224.368      4228.6571      17.743896      13.535         17.6074      
      1000   337.46897     -40614.865     -40302.082      4300.3293      18.04464       13.535         17.6074      
      1100   372.53733     -40540.673     -48002.017      4372.0015      18.345384      13.535         17.6074      
      1200   392.61454     -40487.571     -59551.815      4443.6736      18.646128      13.535         17.6074      
      1300   378.32818     -40321.776     -70343.822      4515.3458      18.946872      13.535         17.6074      
      1400   406.67625     -40220.111     -75194.58       4587.0179      19.247616      13.535         17.6074      
      1500   348.62212     -40072.372     -82025.267      4658.6901      19.54836       13.535         17.6074      
      1600   348.52574     -39908.984     -77142.351      4730.3622      19.849104      13.535         17.6074      
      1700   388.35015     -39840.155     -84119.773      4802.0344      20.149848      13.535         17.6074      
      1800   334.40665     -39666.633     -88368.099      4873.7065      20.450592      13.535         17.6074      
      1900   335.18685     -39523.147     -90592.623      4945.3787      20.751336      13.535         17.6074      
      2000   325.02781     -39351.826     -88894.685      5017.0508      21.05208       13.535         17.6074      
      2100   349.95014     -39238.432     -87639.26       5088.723       21.352824      13.535         17.6074      
      2200   408.51343     -39242.395     -74124.444      5160.3952      21.653568      13.535         17.6074      
      2300   450.19997     -39296.826     -74100.729      5232.0673      21.954312      13.535         17.6074      
      2400   425.37597     -39316.117     -72398.88       5303.7395      22.255056      13.535         17.6074      
      2500   418.30997     -39325.35      -66254.636      5375.4116      22.5558        13.535         17.6074      
      2600   457.7036      -39407.868     -60144.462      5447.0838      22.856544      13.535         17.6074      
      2700   488.17609     -39448.401     -35568.6        5518.7559      23.157288      13.535         17.6074      
      2800   538.37735     -39725.566     -33415.812      5590.4281      23.458032      13.535         17.6074      
      2900   427.80269     -39756.336     -32793.77       5662.1002      23.758776      13.535         17.6074      
      3000   380.05363     -39748.725     -32204.332      5733.7724      24.05952       13.535         17.6074      
      3100   465.49111     -39823.145     -39630.835      5805.4445      24.360264      13.535         17.6074      
      3200   459.93742     -39926.49      -32041.228      5877.1167      24.661008      13.535         17.6074      
      3300   436.25742     -39982.951     -31210.959      5948.7889      24.961752      13.535         17.6074      
      3400   397.06161     -40005.408     -22339.21       6020.461       25.262496      13.535         17.6074      
      3500   392.28756     -40049.668     -31808.8        6092.1332      25.56324       13.535         17.6074      
      3600   369.26054     -40017.965     -34453.216      6163.8053      25.863984      13.535         17.6074      
      3700   347.24938     -39961.993     -32401.258      6235.4775      26.164728      13.535         17.6074      
      3800   344.20166     -39948.216     -29337.806      6307.1496      26.465472      13.535         17.6074      
      3900   340.08472     -39918.295     -32728.862      6378.8218      26.766216      13.535         17.6074      
      4000   385.06195     -39878.376     -41952.461      6450.4939      27.06696       13.535         17.6074      
      4100   342.02403     -39729.801     -27999.068      6522.1661      27.367704      13.535         17.6074      
      4200   294.48015     -39628.024     -43548.089      6593.8383      27.668448      13.535         17.6074      
      4300   331.81404     -39602.178     -44404.921      6665.5104      27.969192      13.535         17.6074      
      4400   314.60273     -39500.464     -37118.053      6737.1826      28.269936      13.535         17.6074      
      4500   309.93474     -39495.752     -44877.997      6808.8547      28.57068       13.535         17.6074      
      4600   314.45488     -39421.635     -41476.63       6880.5269      28.871424      13.535         17.6074      
      4700   313.01492     -39318.493     -44024.286      6952.199       29.172168      13.535         17.6074      
      4800   297.89651     -39211.098     -46877.553      7023.8712      29.472912      13.535         17.6074      
      4900   300.63334     -39132.697     -40024.149      7095.5433      29.773656      13.535         17.6074      
      5000   349.4803      -39187.81      -41989.621      7167.2155      30.0744        13.535         17.6074      
Loop time of 203.245 on 16 procs for 5000 steps with 366 atoms

Performance: 1.063 ns/day, 22.583 hours/ns, 24.601 timesteps/s, 9.004 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 145.15     | 150.19     | 153.08     |  21.8 | 73.90
Bond    | 0.0015729  | 0.0018188  | 0.0021297  |   0.4 |  0.00
Neigh   | 10.643     | 10.903     | 11.322     |   7.6 |  5.36
Comm    | 17.263     | 19.987     | 24.774     |  57.9 |  9.83
Output  | 0.029771   | 0.03586    | 0.040463   |   1.6 |  0.02
Modify  | 20.565     | 20.903     | 21.337     |   6.1 | 10.28
Other   |            | 1.221      |            |       |  0.60

Nlocal:          45.75 ave          61 max          27 min
Histogram: 1 1 1 0 0 1 1 0 1 2
Nghost:        2585.38 ave        2781 max        2357 min
Histogram: 1 1 1 1 0 0 0 0 2 2
Neighs:        16380.8 ave       22545 max        9452 min
Histogram: 1 1 1 0 1 0 1 0 2 1

Total # of neighbors = 131046
Ave neighs/atom = 358.04918
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.535
variable dlen equal ly-${len0}
variable dlen equal ly-13.535
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*13.535
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 13.535 yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 13.535 yz delta 0.0807 remap v units box flip no
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos2.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom 100 dump/pos2_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos2 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.6 | 146.1 | 148.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   295.54433     -41196.6        10630.055      3583.6077      15.0372        13.535         17.6074      
       100   294.34989     -41212.375      1166.4701      3655.2799      15.0372        13.8057        17.6074      
       200   354.71064     -41070.356     -7182.1815      3726.9521      15.0372        14.0764        17.6074      
       300   441.1804      -41022.319     -677.11988      3798.6242      15.0372        14.3471        17.6074      
       400   402.55745     -40946.799     -16783.848      3870.2964      15.0372        14.6178        17.6074      
       500   413.3697      -40879.721     -21611.615      3941.9685      15.0372        14.8885        17.6074      
       600   420.91843     -40874.952     -18588.541      4013.6407      15.0372        15.1592        17.6074      
       700   405.59306     -40826.993     -24839.936      4085.3128      15.0372        15.4299        17.6074      
       800   344.03951     -40739.991     -37214.678      4156.985       15.0372        15.7006        17.6074      
       900   369.51868     -40683.938     -43784.765      4228.6571      15.0372        15.9713        17.6074      
      1000   404.57546     -40574.056     -49243.996      4300.3293      15.0372        16.242         17.6074      
      1100   415.89195     -40474.478     -46036.384      4372.0015      15.0372        16.5127        17.6074      
      1200   329.8959      -40307.646     -66182.189      4443.6736      15.0372        16.7834        17.6074      
      1300   397.36401     -40231.499     -68854.514      4515.3458      15.0372        17.0541        17.6074      
      1400   381.26947     -40091.618     -73448.892      4587.0179      15.0372        17.3248        17.6074      
      1500   378.92737     -39954.82      -85082.933      4658.6901      15.0372        17.5955        17.6074      
      1600   358.25771     -39710.615     -84361.251      4730.3622      15.0372        17.8662        17.6074      
      1700   439.85166     -39643.072     -67726.288      4802.0344      15.0372        18.1369        17.6074      
      1800   472.88078     -39624.872     -74042.839      4873.7065      15.0372        18.4076        17.6074      
      1900   418.61679     -39510.189     -68712.364      4945.3787      15.0372        18.6783        17.6074      
      2000   501.55597     -39557.885     -70647.971      5017.0508      15.0372        18.949         17.6074      
      2100   571.89447     -39816.89      -46509.642      5088.723       15.0372        19.2197        17.6074      
      2200   490.51235     -39991.117     -20478.495      5160.3952      15.0372        19.4904        17.6074      
      2300   436.8458      -40110.412     -31564.05       5232.0673      15.0372        19.7611        17.6074      
      2400   429.24963     -40313.618     -17341.263      5303.7395      15.0372        20.0318        17.6074      
      2500   376.91871     -40437.796     -12081.329      5375.4116      15.0372        20.3025        17.6074      
      2600   300.75628     -40461.405     -16871.558      5447.0838      15.0372        20.5732        17.6074      
      2700   281.77008     -40441.732     -15121.563      5518.7559      15.0372        20.8439        17.6074      
      2800   281.70748     -40428.637     -18129.173      5590.4281      15.0372        21.1146        17.6074      
      2900   292.26971     -40391.601     -21559.791      5662.1002      15.0372        21.3853        17.6074      
      3000   388.56235     -40471.112     -7679.8481      5733.7724      15.0372        21.656         17.6074      
      3100   370.68152     -40611.005     -3937.8369      5805.4445      15.0372        21.9267        17.6074      
      3200   277.72051     -40655.746      3047.8655      5877.1167      15.0372        22.1974        17.6074      
      3300   283.36763     -40724.441     -86.012934      5948.7889      15.0372        22.4681        17.6074      
      3400   305.32712     -40778.037      1097.1955      6020.461       15.0372        22.7388        17.6074      
      3500   282.78737     -40746.917     -2483.0266      6092.1332      15.0372        23.0095        17.6074      
      3600   323.48936     -40760.127      5359.0247      6163.8053      15.0372        23.2802        17.6074      
      3700   340.11173     -40743.3       -4690.2688      6235.4775      15.0372        23.5509        17.6074      
      3800   313.17473     -40696.805     -3038.5516      6307.1496      15.0372        23.8216        17.6074      
      3900   295.62034     -40708.068     -1115.7941      6378.8218      15.0372        24.0923        17.6074      
      4000   304.72149     -40756.89       3657.2496      6450.4939      15.0372        24.363         17.6074      
      4100   258.72543     -40737.31      -5837.2442      6522.1661      15.0372        24.6337        17.6074      
      4200   270.64307     -40760.988     -3197.1222      6593.8383      15.0372        24.9044        17.6074      
      4300   318.92902     -40801.271     -1465.8301      6665.5104      15.0372        25.1751        17.6074      
      4400   327.49438     -40785.051      6310.6198      6737.1826      15.0372        25.4458        17.6074      
      4500   317.18424     -40753.809     -4459.6843      6808.8547      15.0372        25.7165        17.6074      
      4600   307.69337     -40741.53      -737.47392      6880.5269      15.0372        25.9872        17.6074      
      4700   290.90007     -40755.153      4101.9215      6952.199       15.0372        26.2579        17.6074      
      4800   292.88056     -40793.442     -3603.4346      7023.8712      15.0372        26.5286        17.6074      
      4900   288.04216     -40794.913      3376.6451      7095.5433      15.0372        26.7993        17.6074      
      5000   278.85358     -40765.122     -7071.7104      7167.2155      15.0372        27.07          17.6074      
Loop time of 192.65 on 16 procs for 5000 steps with 366 atoms

Performance: 1.121 ns/day, 21.406 hours/ns, 25.954 timesteps/s, 9.499 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 131.88     | 138.01     | 145.08     |  36.5 | 71.64
Bond    | 0.0015186  | 0.001838   | 0.002155   |   0.5 |  0.00
Neigh   | 10.065     | 10.709     | 11.441     |  16.0 |  5.56
Comm    | 14.043     | 20.841     | 27.149     |  93.3 | 10.82
Output  | 0.027891   | 0.036161   | 0.041374   |   2.3 |  0.02
Modify  | 21.084     | 21.845     | 22.548     |  11.2 | 11.34
Other   |            | 1.204      |            |       |  0.63

Nlocal:          45.75 ave          82 max          12 min
Histogram: 3 0 0 1 0 0 0 1 2 1
Nghost:        2018.38 ave        2456 max        1573 min
Histogram: 4 0 0 0 0 0 0 0 0 4
Neighs:        19308.9 ave       34589 max        4601 min
Histogram: 3 0 1 0 0 0 0 0 2 2

Total # of neighbors = 154471
Ave neighs/atom = 422.05191
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.6074
variable dlen equal lz-${len0}
variable dlen equal lz-17.6074
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.006 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*17.6074
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 17.6074 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos3.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom 100 dump/pos3_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos3 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.6 | 146.1 | 148.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   295.54433     -41196.6        10630.055      3583.6077      15.0372        13.535         17.6074      
       100   295.50991     -41214.332     -1603.7035      3655.2799      15.0372        13.535         17.959548    
       200   401.33647     -41026.023     -8915.1171      3726.9521      15.0372        13.535         18.311696    
       300   491.32269     -40915.625      2007.6014      3798.6242      15.0372        13.535         18.663844    
       400   449.29774     -40915.745     -6516.9577      3870.2964      15.0372        13.535         19.015992    
       500   502.52692     -40879.531     -13728.024      3941.9685      15.0372        13.535         19.36814     
       600   465.48753     -40819.074     -12732.808      4013.6407      15.0372        13.535         19.720288    
       700   412.77424     -40733.835     -30682.571      4085.3128      15.0372        13.535         20.072436    
       800   458.44186     -40739.361     -29037.401      4156.985       15.0372        13.535         20.424584    
       900   435.38463     -40666.33      -43372.411      4228.6571      15.0372        13.535         20.776732    
      1000   468.46069     -40602.875     -43108.671      4300.3293      15.0372        13.535         21.12888     
      1100   467.9655      -40539.876     -53893.368      4372.0015      15.0372        13.535         21.481028    
      1200   384.0334      -40372.218     -57856.001      4443.6736      15.0372        13.535         21.833176    
      1300   339.4877      -40232.156     -51518.822      4515.3458      15.0372        13.535         22.185324    
      1400   365.87623     -40151.402     -50678.465      4587.0179      15.0372        13.535         22.537472    
      1500   381.12036     -40073.775     -62525.162      4658.6901      15.0372        13.535         22.88962     
      1600   414.10856     -39966.175     -64379.45       4730.3622      15.0372        13.535         23.241768    
      1700   406.65535     -39859.826     -67792.473      4802.0344      15.0372        13.535         23.593916    
      1800   433.6313      -39859.112     -55480.957      4873.7065      15.0372        13.535         23.946064    
      1900   486.43313     -39873.81      -46907.463      4945.3787      15.0372        13.535         24.298212    
      2000   461.58728     -39840.704     -48865.484      5017.0508      15.0372        13.535         24.65036     
      2100   443.54587     -39838.216     -40960.364      5088.723       15.0372        13.535         25.002508    
      2200   413.90642     -39766.556     -51418.782      5160.3952      15.0372        13.535         25.354656    
      2300   389.06233     -39690.468     -50331.941      5232.0673      15.0372        13.535         25.706804    
      2400   479.64485     -39733.568     -32166.27       5303.7395      15.0372        13.535         26.058952    
      2500   543.29248     -39904.654     -22259.003      5375.4116      15.0372        13.535         26.4111      
      2600   512.61808     -40033.558     -24004.593      5447.0838      15.0372        13.535         26.763248    
      2700   542.38791     -40269.492     -11641.28       5518.7559      15.0372        13.535         27.115396    
      2800   486.63484     -40431.216     -3956.0666      5590.4281      15.0372        13.535         27.467544    
      2900   409.55449     -40512.724      8214.1361      5662.1002      15.0372        13.535         27.819692    
      3000   447.77169     -40611.478      586.20347      5733.7724      15.0372        13.535         28.17184     
      3100   346.16287     -40593.242     -7580.18        5805.4445      15.0372        13.535         28.523988    
      3200   392.76088     -40603.201      1234.6412      5877.1167      15.0372        13.535         28.876136    
      3300   402.28139     -40608.274      857.21452      5948.7889      15.0372        13.535         29.228284    
      3400   398.31334     -40641.948     -1062.5607      6020.461       15.0372        13.535         29.580432    
      3500   391.74808     -40631.688      5273.8254      6092.1332      15.0372        13.535         29.93258     
      3600   364.82121     -40621.779      3209.3104      6163.8053      15.0372        13.535         30.284728    
      3700   354.6898      -40623.675      1799.9109      6235.4775      15.0372        13.535         30.636876    
      3800   361.74699     -40615.018      3696.0935      6307.1496      15.0372        13.535         30.989024    
      3900   349.67962     -40606.915      5593.7565      6378.8218      15.0372        13.535         31.341172    
      4000   329.05264     -40637.156      997.64782      6450.4939      15.0372        13.535         31.69332     
      4100   346.09057     -40668.348      3455.8086      6522.1661      15.0372        13.535         32.045468    
      4200   337.44073     -40668.536      6172.7045      6593.8383      15.0372        13.535         32.397616    
      4300   321.4588      -40666.742      3235.5507      6665.5104      15.0372        13.535         32.749764    
      4400   342.88361     -40673.058      258.52004      6737.1826      15.0372        13.535         33.101912    
      4500   298.70496     -40643.96      -1042.1093      6808.8547      15.0372        13.535         33.45406     
      4600   301.14818     -40635.405      744.6262       6880.5269      15.0372        13.535         33.806208    
      4700   328.94917     -40686.8        526.82241      6952.199       15.0372        13.535         34.158356    
      4800   312.29919     -40655.209     -2015.6135      7023.8712      15.0372        13.535         34.510504    
      4900   313.83115     -40643.549      1017.2707      7095.5433      15.0372        13.535         34.862652    
      5000   319.52489     -40636.452      4478.9716      7167.2155      15.0372        13.535         35.2148      
Loop time of 203.428 on 16 procs for 5000 steps with 366 atoms

Performance: 1.062 ns/day, 22.603 hours/ns, 24.579 timesteps/s, 8.996 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 145.22     | 150.71     | 155.16     |  23.5 | 74.08
Bond    | 0.0015685  | 0.0019406  | 0.0024331  |   0.6 |  0.00
Neigh   | 10.53      | 10.598     | 10.693     |   1.6 |  5.21
Comm    | 15.773     | 20.156     | 25.524     |  62.8 |  9.91
Output  | 0.025122   | 0.030552   | 0.035154   |   1.7 |  0.02
Modify  | 20.641     | 20.849     | 21.016     |   3.0 | 10.25
Other   |            | 1.086      |            |       |  0.53

Nlocal:          45.75 ave          63 max          24 min
Histogram: 1 0 1 0 2 0 0 2 1 1
Nghost:        2340.25 ave        2558 max        2127 min
Histogram: 2 2 0 0 0 0 0 0 2 2
Neighs:          20470 ave       28430 max       11517 min
Histogram: 1 1 1 1 0 0 0 0 2 2

Total # of neighbors = 163760
Ave neighs/atom = 447.43169
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 15.0372
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.0807)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*15.0372
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_p all deform 100 yz delta ${delta} remap v units box flip no
fix deform_p all deform 100 yz delta 15.0372 remap v units box flip no
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos4.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom 100 dump/pos4_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos4 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.6 | 146.1 | 148.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   295.54433     -41196.6        10630.055      3583.6077      15.0372        13.535         17.6074      
       100   295.35412     -41211.08      -979.74357      3583.6077      15.0372        13.535         17.6074      
       200   325.95838     -41108.631      166.28517      3583.6077      15.0372        13.535         17.6074      
       300   399.50027     -41040.72       8629.5301      3583.6077      15.0372        13.535         17.6074      
       400   400.65651     -40967.209      12198.519      3583.6077      15.0372        13.535         17.6074      
       500   379.97515     -40939.941      7022.2826      3583.6077      15.0372        13.535         17.6074      
       600   393.52663     -41018.666      5374.3054      3583.6077      15.0372        13.535         17.6074      
       700   396.77916     -41037.722      12919.268      3583.6077      15.0372        13.535         17.6074      
       800   365.99776     -41007.421     -1855.0965      3583.6077      15.0372        13.535         17.6074      
       900   354.63894     -40987.637     -8788.3483      3583.6077      15.0372        13.535         17.6074      
      1000   370.72782     -40914.724     -1199.1586      3583.6077      15.0372        13.535         17.6074      
      1100   337.36104     -40952.97       10588.56       3583.6077      15.0372        13.535         17.6074      
      1200   358.08381     -40922.029      933.13782      3583.6077      15.0372        13.535         17.6074      
      1300   369.58292     -40891.867      4166.938       3583.6077      15.0372        13.535         17.6074      
      1400   360.55892     -40845.123     -4033.0772      3583.6077      15.0372        13.535         17.6074      
      1500   343.61096     -40827.478     -8310.49        3583.6077      15.0372        13.535         17.6074      
      1600   344.7248      -40798.551      4127.9273      3583.6077      15.0372        13.535         17.6074      
      1700   301.39226     -40776.996      17975.289      3583.6077      15.0372        13.535         17.6074      
      1800   299.84995     -40734.561      8433.7526      3583.6077      15.0372        13.535         17.6074      
      1900   339.07159     -40772.746      5683.1151      3583.6077      15.0372        13.535         17.6074      
      2000   317.11233     -40695.554     -6577.5904      3583.6077      15.0372        13.535         17.6074      
      2100   289.81144     -40671.872      6840.5861      3583.6077      15.0372        13.535         17.6074      
      2200   278.98089     -40636.09       6889.3821      3583.6077      15.0372        13.535         17.6074      
      2300   282.35092     -40579.401     -2466.7388      3583.6077      15.0372        13.535         17.6074      
      2400   303.10805     -40520.438     -1823.7464      3583.6077      15.0372        13.535         17.6074      
      2500   335.79204     -40425.736      2729.3368      3583.6077      15.0372        13.535         17.6074      
      2600   299.57084     -40335.51      -2616.5299      3583.6077      15.0372        13.535         17.6074      
      2700   309.11858     -40337.95      -6951.5288      3583.6077      15.0372        13.535         17.6074      
      2800   328.46127     -40234.605      2017.0067      3583.6077      15.0372        13.535         17.6074      
      2900   443.80844     -40352.286      7635.987       3583.6077      15.0372        13.535         17.6074      
      3000   415.27739     -40395.633     -8234.3913      3583.6077      15.0372        13.535         17.6074      
      3100   357.44694     -40415.928     -2630.8973      3583.6077      15.0372        13.535         17.6074      
      3200   387.35813     -40387.427      29320.073      3583.6077      15.0372        13.535         17.6074      
      3300   368.34848     -40352.661      13638.905      3583.6077      15.0372        13.535         17.6074      
      3400   355.13849     -40326.766     -10035.995      3583.6077      15.0372        13.535         17.6074      
      3500   403.72539     -40310.135     -13540.58       3583.6077      15.0372        13.535         17.6074      
      3600   371.37402     -40266.825     -10262.765      3583.6077      15.0372        13.535         17.6074      
      3700   333.27042     -40211.817     -7901.999       3583.6077      15.0372        13.535         17.6074      
      3800   326.4936      -40123.325     -13470.413      3583.6077      15.0372        13.535         17.6074      
      3900   397.81251     -40131.381     -22026.807      3583.6077      15.0372        13.535         17.6074      
      4000   399.08988     -40104.858      2519.2308      3583.6077      15.0372        13.535         17.6074      
      4100   359.43309     -40072.183     -12495.478      3583.6077      15.0372        13.535         17.6074      
      4200   360.03358     -40034.779     -31767.811      3583.6077      15.0372        13.535         17.6074      
      4300   407.86053     -40013.067     -4008.5135      3583.6077      15.0372        13.535         17.6074      
      4400   368.73165     -40010.105     -25632.593      3583.6077      15.0372        13.535         17.6074      
      4500   317.72385     -39937.22      -21819.831      3583.6077      15.0372        13.535         17.6074      
      4600   347.6375      -39847.914     -18955.2        3583.6077      15.0372        13.535         17.6074      
      4700   350.96241     -39808.633     -15692.988      3583.6077      15.0372        13.535         17.6074      
      4800   387.90574     -39858.156     -22186.107      3583.6077      15.0372        13.535         17.6074      
      4900   397.25745     -39929.996     -21988.605      3583.6077      15.0372        13.535         17.6074      
      5000   412.5792      -39984.599      527.64575      3583.6077      15.0372        13.535         17.6074      
Loop time of 306.769 on 16 procs for 5000 steps with 366 atoms

Performance: 0.704 ns/day, 34.085 hours/ns, 16.299 timesteps/s, 5.965 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 215.57     | 228.94     | 242.01     |  71.4 | 74.63
Bond    | 0.0016275  | 0.0018569  | 0.0022484  |   0.5 |  0.00
Neigh   | 19.001     | 20.335     | 21.572     |  22.1 |  6.63
Comm    | 17.772     | 30.734     | 44.043     | 194.3 | 10.02
Output  | 0.025372   | 0.030926   | 0.035606   |   1.7 |  0.01
Modify  | 24.881     | 25.987     | 27.2       |  18.9 |  8.47
Other   |            | 0.7446     |            |       |  0.24

Nlocal:          45.75 ave          51 max          39 min
Histogram: 1 1 0 1 0 0 1 2 1 1
Nghost:        4686.88 ave        4783 max        4587 min
Histogram: 1 1 1 1 0 1 0 1 0 2
Neighs:        32798.4 ave       36616 max       27950 min
Histogram: 1 1 0 1 0 0 1 2 1 1

Total # of neighbors = 262387
Ave neighs/atom = 716.90437
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.535
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz--0.1585)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*13.535
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_p all deform 100 xz delta ${delta} remap v units box flip no
fix deform_p all deform 100 xz delta 13.535 remap v units box flip no
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos5.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom 100 dump/pos5_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos5 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.6 | 146.1 | 148.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   295.54433     -41196.6        10630.055      3583.6077      15.0372        13.535         17.6074      
       100   296.01813     -41211.631      80.424186      3583.6077      15.0372        13.535         17.6074      
       200   380.24337     -41068.128     -1149.1559      3583.6077      15.0372        13.535         17.6074      
       300   472.18829     -40971.747      18277.553      3583.6077      15.0372        13.535         17.6074      
       400   458.52529     -41013.792      12317.603      3583.6077      15.0372        13.535         17.6074      
       500   491.6695      -41032.081      30624.692      3583.6077      15.0372        13.535         17.6074      
       600   463.20248     -40968.243      19188.561      3583.6077      15.0372        13.535         17.6074      
       700   421.91074     -40925.344      15659.633      3583.6077      15.0372        13.535         17.6074      
       800   507.30521     -40925.853     -4667.6157      3583.6077      15.0372        13.535         17.6074      
       900   474.19469     -40901.049      7564.8147      3583.6077      15.0372        13.535         17.6074      
      1000   424.06664     -40894.296      2814.3636      3583.6077      15.0372        13.535         17.6074      
      1100   370.8525      -40916.172      18283.525      3583.6077      15.0372        13.535         17.6074      
      1200   331.53209     -40904.364      12859.227      3583.6077      15.0372        13.535         17.6074      
      1300   367.57154     -40888.635      4591.1365      3583.6077      15.0372        13.535         17.6074      
      1400   352.86957     -40923.638      20627.672      3583.6077      15.0372        13.535         17.6074      
      1500   365.29291     -40923.904      6194.1262      3583.6077      15.0372        13.535         17.6074      
      1600   365.75354     -40881.723      7053.8696      3583.6077      15.0372        13.535         17.6074      
      1700   340.82644     -40756.764      22559.038      3583.6077      15.0372        13.535         17.6074      
      1800   419.11207     -40762.455     -10035.589      3583.6077      15.0372        13.535         17.6074      
      1900   338.80493     -40720.277     -1091.8997      3583.6077      15.0372        13.535         17.6074      
      2000   387.58205     -40638.167      11069.871      3583.6077      15.0372        13.535         17.6074      
      2100   410.87025     -40569.352     -12146.968      3583.6077      15.0372        13.535         17.6074      
      2200   339.82231     -40551.927     -12059.354      3583.6077      15.0372        13.535         17.6074      
      2300   351.82277     -40518.171     -13541.944      3583.6077      15.0372        13.535         17.6074      
      2400   359.32657     -40454.902     -5892.4569      3583.6077      15.0372        13.535         17.6074      
      2500   370.5044      -40250.503     -7351.6934      3583.6077      15.0372        13.535         17.6074      
      2600   360.05526     -40290.839     -24886.747      3583.6077      15.0372        13.535         17.6074      
      2700   336.24912     -40259.306     -13016.4        3583.6077      15.0372        13.535         17.6074      
      2800   340.58169     -40256.529     -2203.1295      3583.6077      15.0372        13.535         17.6074      
      2900   352.91704     -40257.19       5699.1924      3583.6077      15.0372        13.535         17.6074      
      3000   436.39578     -40282.814     -1156.5249      3583.6077      15.0372        13.535         17.6074      
      3100   412.46536     -40295.583      851.99066      3583.6077      15.0372        13.535         17.6074      
      3200   399.88433     -40290.551      2855.4533      3583.6077      15.0372        13.535         17.6074      
      3300   345.61556     -40231.417      20897.822      3583.6077      15.0372        13.535         17.6074      
      3400   351.18963     -40205.827     -5665.0982      3583.6077      15.0372        13.535         17.6074      
      3500   308.58382     -40150.407     -11731.084      3583.6077      15.0372        13.535         17.6074      
      3600   301.12942     -40078.089     -34128.308      3583.6077      15.0372        13.535         17.6074      
      3700   313.38442     -40025.434     -25484.999      3583.6077      15.0372        13.535         17.6074      
      3800   346.08982     -40012.991      9967.2447      3583.6077      15.0372        13.535         17.6074      
      3900   375.69054     -40088.443     -5690.6236      3583.6077      15.0372        13.535         17.6074      
      4000   360.13551     -40086.329     -8647.2321      3583.6077      15.0372        13.535         17.6074      
      4100   364.73317     -40077.665      12480.258      3583.6077      15.0372        13.535         17.6074      
      4200   364.41679     -40023.031     -1114.5308      3583.6077      15.0372        13.535         17.6074      
      4300   411.13681     -40005.728     -18954.127      3583.6077      15.0372        13.535         17.6074      
      4400   385.96662     -40077.888     -15910.707      3583.6077      15.0372        13.535         17.6074      
      4500   379.45439     -40109.001      25075.058      3583.6077      15.0372        13.535         17.6074      
      4600   402.1774      -40106.84       103.65668      3583.6077      15.0372        13.535         17.6074      
      4700   348.90666     -40121.675      8313.4931      3583.6077      15.0372        13.535         17.6074      
      4800   327.64449     -40139.609      19417.71       3583.6077      15.0372        13.535         17.6074      
      4900   332.47719     -40107.067     -14971.762      3583.6077      15.0372        13.535         17.6074      
      5000   349.86336     -40147.343      11110.583      3583.6077      15.0372        13.535         17.6074      
Loop time of 181.9 on 16 procs for 5000 steps with 366 atoms

Performance: 1.187 ns/day, 20.211 hours/ns, 27.488 timesteps/s, 10.060 katom-step/s
99.7% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 142.56     | 145.69     | 148.71     |  18.7 | 80.09
Bond    | 0.0010318  | 0.0012061  | 0.001632   |   0.6 |  0.00
Neigh   | 13.248     | 13.577     | 14         |   6.6 |  7.46
Comm    | 2.4493     | 5.4947     | 8.6384     |  96.7 |  3.02
Output  | 0.010099   | 0.011659   | 0.01258    |   0.7 |  0.01
Modify  | 16.589     | 17.007     | 17.331     |   5.8 |  9.35
Other   |            | 0.1213     |            |       |  0.07

Nlocal:          45.75 ave          51 max          36 min
Histogram: 1 0 0 0 0 1 2 1 2 1
Nghost:        4184.25 ave        4250 max        4132 min
Histogram: 2 2 0 0 0 1 1 0 0 2
Neighs:        32745.6 ave       36351 max       25938 min
Histogram: 1 0 0 0 0 1 2 1 2 1

Total # of neighbors = 261965
Ave neighs/atom = 715.75137
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.6074
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--7.4931)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*17.6074
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_p all deform 100 xy delta ${delta} remap v units box flip no
fix deform_p all deform 100 xy delta 17.6074 remap v units box flip no

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos6.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom 100 dump/pos6_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos6 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.6 | 146.1 | 148.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   295.54433     -41196.6        10630.055      3583.6077      15.0372        13.535         17.6074      
       100   298.17796     -41210.468     -212.85499      3583.6077      15.0372        13.535         17.6074      
       200   352.3104      -41031.591      8225.6714      3583.6077      15.0372        13.535         17.6074      
       300   410.25759     -40982.557      16059.529      3583.6077      15.0372        13.535         17.6074      
       400   420.66439     -40943.466      11870.654      3583.6077      15.0372        13.535         17.6074      
       500   443.13499     -40890.246      4225.5608      3583.6077      15.0372        13.535         17.6074      
       600   438.19752     -40895.493      26056.131      3583.6077      15.0372        13.535         17.6074      
       700   429.04436     -40870.007      9117.5658      3583.6077      15.0372        13.535         17.6074      
       800   377.25334     -40801.144      22664.674      3583.6077      15.0372        13.535         17.6074      
       900   331.0486      -40742.569      10046.116      3583.6077      15.0372        13.535         17.6074      
      1000   362.78724     -40714.525      12956.608      3583.6077      15.0372        13.535         17.6074      
      1100   328.06509     -40641.591      12550.494      3583.6077      15.0372        13.535         17.6074      
      1200   364.36959     -40545.461     -2429.8835      3583.6077      15.0372        13.535         17.6074      
      1300   433.68656     -40499.981      20504.012      3583.6077      15.0372        13.535         17.6074      
      1400   425.79663     -40440.668      16687.413      3583.6077      15.0372        13.535         17.6074      
      1500   392.49137     -40348.821     -7452.5519      3583.6077      15.0372        13.535         17.6074      
      1600   412.49937     -40344.755      294.99806      3583.6077      15.0372        13.535         17.6074      
      1700   379.92059     -40255.93      -11301.029      3583.6077      15.0372        13.535         17.6074      
      1800   375.40762     -40188.948     -10017.515      3583.6077      15.0372        13.535         17.6074      
      1900   343.89701     -40050.454     -24676.872      3583.6077      15.0372        13.535         17.6074      
      2000   385.702       -39989.647     -16440.129      3583.6077      15.0372        13.535         17.6074      
      2100   413.90962     -39890.906     -18296.81       3583.6077      15.0372        13.535         17.6074      
      2200   450.15256     -39912.214      8029.0812      3583.6077      15.0372        13.535         17.6074      
      2300   410.90575     -39934.162     -8123.6867      3583.6077      15.0372        13.535         17.6074      
      2400   399.04107     -39846.354      7177.8337      3583.6077      15.0372        13.535         17.6074      
      2500   478.50836     -39975.477     -16163.538      3583.6077      15.0372        13.535         17.6074      
      2600   511.09604     -40098.885     -1536.5158      3583.6077      15.0372        13.535         17.6074      
      2700   499.6511      -40276.401      1792.1076      3583.6077      15.0372        13.535         17.6074      
      2800   473.8728      -40340.858      19711.388      3583.6077      15.0372        13.535         17.6074      
      2900   401.87655     -40386.567     -59.801287      3583.6077      15.0372        13.535         17.6074      
      3000   474.74857     -40325.725     -3920.4149      3583.6077      15.0372        13.535         17.6074      
      3100   481.54814     -40303.056      7556.8968      3583.6077      15.0372        13.535         17.6074      
      3200   422.85119     -40321.949      2122.624       3583.6077      15.0372        13.535         17.6074      
      3300   339.53136     -40224.864     -667.6977       3583.6077      15.0372        13.535         17.6074      
      3400   348.33875     -40126.62      -20803.173      3583.6077      15.0372        13.535         17.6074      
      3500   405.2961      -40221.102     -14790.285      3583.6077      15.0372        13.535         17.6074      
      3600   304.51518     -40114.544      5652.3621      3583.6077      15.0372        13.535         17.6074      
      3700   340.96173     -40173.454      1371.244       3583.6077      15.0372        13.535         17.6074      
      3800   349.97502     -40127.428      7962.0189      3583.6077      15.0372        13.535         17.6074      
      3900   348.17444     -40099.354     -12602.506      3583.6077      15.0372        13.535         17.6074      
      4000   339.71194     -40093.608     -1648.4986      3583.6077      15.0372        13.535         17.6074      
      4100   388.92972     -40053.707     -14053.748      3583.6077      15.0372        13.535         17.6074      
      4200   405.85333     -39995.66      -19008.265      3583.6077      15.0372        13.535         17.6074      
      4300   396.18793     -39968.315     -26604.894      3583.6077      15.0372        13.535         17.6074      
      4400   390.51177     -39874.969     -611.23225      3583.6077      15.0372        13.535         17.6074      
      4500   424.93868     -39847.629      1091.3842      3583.6077      15.0372        13.535         17.6074      
      4600   440.70062     -39934.616     -2730.2152      3583.6077      15.0372        13.535         17.6074      
      4700   442.73553     -40016.636     -17114.645      3583.6077      15.0372        13.535         17.6074      
      4800   417.77543     -39982.646     -17087.13       3583.6077      15.0372        13.535         17.6074      
      4900   441.71452     -40029.811      2276.8932      3583.6077      15.0372        13.535         17.6074      
      5000   392.74128     -40046.024     -11408.498      3583.6077      15.0372        13.535         17.6074      
Loop time of 156.134 on 16 procs for 5000 steps with 366 atoms

Performance: 1.383 ns/day, 17.348 hours/ns, 32.024 timesteps/s, 11.721 katom-step/s
99.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 116.79     | 121.24     | 125.48     |  27.0 | 77.65
Bond    | 0.00090554 | 0.0010834  | 0.0013554  |   0.5 |  0.00
Neigh   | 12.302     | 12.535     | 12.825     |   5.1 |  8.03
Comm    | 1.7298     | 5.9713     | 10.425     | 122.2 |  3.82
Output  | 0.0095658  | 0.011196   | 0.012077   |   0.7 |  0.01
Modify  | 15.977     | 16.262     | 16.489     |   4.3 | 10.42
Other   |            | 0.1125     |            |       |  0.07

Nlocal:          45.75 ave          55 max          37 min
Histogram: 1 0 1 3 0 0 1 0 1 1
Nghost:        3779.12 ave        3876 max        3679 min
Histogram: 1 1 2 0 0 0 0 2 0 2
Neighs:        32692.4 ave       38958 max       26608 min
Histogram: 1 0 1 2 1 0 1 0 0 2

Total # of neighbors = 261539
Ave neighs/atom = 714.58743
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:25:37
