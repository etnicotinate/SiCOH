LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 100
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 50
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 1.0                  # the deformation magnitude 0.01

variable FF string "SiOCHN_2018.ff C H O Si"   # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si
variable structure string 333-HD-100C-20-VASP

# Read the initial sctructure
# box tilt large
read_data       ${structure}.data
read_data       333-HD-100C-20-VASP.data
Reading data file ...
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.012 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
fix bondinfo all reaxff/bonds 1 bonds_opt.reaxff

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
dump dump_opt all custom 1 dump/dump_opt.lammpstrj id type q x y z
minimize 1.0e-6 1.0e-6 100 1000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -29.52 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 145.1 | 147 | 148.6 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0             -39804.227      0             -39804.227      14609.438    
        32   0             -41317.078      0             -41317.078     -16126.917    
Loop time of 3.80654 on 16 procs for 32 steps with 366 atoms

97.5% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
     -39804.2272229453  -41317.0507088839  -41317.0775886207
  Force two-norm initial, final = 1976.3585 197.73134
  Force max component initial, final = 493.19191 81.985407
  Final line search alpha, max atom move = 0.00030287097 0.024831
  Iterations, force evaluations = 32 81

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.2471     | 2.5974     | 2.7916     |  10.7 | 68.24
Bond    | 2.4042e-05 | 3.0183e-05 | 3.8262e-05 |   0.0 |  0.00
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.25579    | 0.44921    | 0.79982    |  25.8 | 11.80
Output  | 0.0052984  | 0.00725    | 0.0081797  |   1.0 |  0.19
Modify  | 0.74659    | 0.74686    | 0.74717    |   0.0 | 19.62
Other   |            | 0.005767   |            |       |  0.15

Nlocal:          45.75 ave          58 max          36 min
Histogram: 1 0 2 1 1 1 1 0 0 1
Nghost:        3580.38 ave        3618 max        3535 min
Histogram: 1 2 0 1 0 0 0 0 2 2
Neighs:        32033.9 ave       39916 max       25708 min
Histogram: 1 0 2 1 1 1 1 0 0 1

Total # of neighbors = 256271
Ave neighs/atom = 700.19399
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333-HD-100C-20-VASP_opt.data
System init for write_data ...
undump dump_opt
unfix bondinfo
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
dump dump_eq all custom ${nthermo} dump/dump_eq.lammpstrj id type q x y z
dump dump_eq all custom 100 dump/dump_eq.lammpstrj id type q x y z

# compute MSD
compute msd1 all msd
fix myMSD all ave/time ${nevery} ${nrepeat} ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 ${nrepeat} ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 10 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 10 100 c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out

run ${nequil}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 139 | 140.8 | 142.4 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -41317.077     -12049.683      1.9525358      3659.697     
       100   219.17293     -41190.103     -7947.6842      1.9525358      3659.697     
       200   219.0684      -41131.112     -11727.995      1.9525358      3659.697     
       300   274.92305     -41126.811     -1437.2044      1.9525358      3659.697     
       400   291.57279     -41088.967     -11947.627      1.9525358      3659.697     
       500   313.50943     -41065.891     -4570.2625      1.9525358      3659.697     
       600   326.9424      -41071.931     -3088.3238      1.9525358      3659.697     
       700   305.49438     -41076.336     -2136.7635      1.9525358      3659.697     
       800   281.08273     -41071.3       -1594.0773      1.9525358      3659.697     
       900   298.97558     -41095.048     -2293.1859      1.9525358      3659.697     
      1000   294.58695     -41085.464     -15776.743      1.9525358      3659.697     
      1100   297.07084     -41085.977     -9172.5878      1.9525358      3659.697     
      1200   297.31425     -41076.694      1322.9711      1.9525358      3659.697     
      1300   321.03319     -41085.921     -7057.5969      1.9525358      3659.697     
      1400   302.19649     -41071.572      5491.8025      1.9525358      3659.697     
      1500   281.85365     -41075.822     -12054.849      1.9525358      3659.697     
      1600   292.5003      -41092.554     -2580.2252      1.9525358      3659.697     
      1700   300.9173      -41085.138      1461.28        1.9525358      3659.697     
      1800   312.82249     -41064.974     -15914.054      1.9525358      3659.697     
      1900   297.83126     -41041.851     -7039.9894      1.9525358      3659.697     
      2000   325.68173     -41084.419      5192.102       1.9525358      3659.697     
      2100   297.59927     -41074.878      3546.8963      1.9525358      3659.697     
      2200   281.30208     -41069.233     -4244.9732      1.9525358      3659.697     
      2300   293.81541     -41084.667      1176.7458      1.9525358      3659.697     
      2400   307.03828     -41092.213     -1617.1717      1.9525358      3659.697     
      2500   303.63357     -41078.13      -12866.463      1.9525358      3659.697     
      2600   302.66446     -41065.809     -1283.9405      1.9525358      3659.697     
      2700   331.20593     -41076.975      6607.655       1.9525358      3659.697     
      2800   297.77892     -41065.701     -7982.553       1.9525358      3659.697     
      2900   301.45128     -41088.853     -1690.1469      1.9525358      3659.697     
      3000   287.35972     -41071.181     -3622.4257      1.9525358      3659.697     
      3100   286.78812     -41056.737      74.066707      1.9525358      3659.697     
      3200   316.11325     -41062.941      921.35717      1.9525358      3659.697     
      3300   337.11846     -41053.137     -13610.894      1.9525358      3659.697     
      3400   327.59002     -41085.209     -7426.953       1.9525358      3659.697     
      3500   293.03357     -41070.524      5639.7147      1.9525358      3659.697     
      3600   286.11487     -41070.127      1911.7921      1.9525358      3659.697     
      3700   292.29414     -41075.174     -5573.136       1.9525358      3659.697     
      3800   325.84535     -41106.279     -13428.601      1.9525358      3659.697     
      3900   310.11989     -41087.613     -14831.524      1.9525358      3659.697     
      4000   311.94744     -41090.223     -3779.8826      1.9525358      3659.697     
      4100   297.91273     -41083.112      4196.5644      1.9525358      3659.697     
      4200   273.24817     -41073.699     -3640.6803      1.9525358      3659.697     
      4300   289.24852     -41094.708     -2961.2467      1.9525358      3659.697     
      4400   299.8504      -41076.164      1640.382       1.9525358      3659.697     
      4500   310.83535     -41068.83      -1590.0071      1.9525358      3659.697     
      4600   314.03843     -41080.339      323.00824      1.9525358      3659.697     
      4700   297.90919     -41087.007     -8689.3337      1.9525358      3659.697     
      4800   289.90697     -41083.915     -3952.6175      1.9525358      3659.697     
      4900   306.40687     -41097.356     -11849.487      1.9525358      3659.697     
      5000   309.1513      -41091.293     -3497.2028      1.9525358      3659.697     
Loop time of 275.957 on 16 procs for 5000 steps with 366 atoms

Performance: 0.783 ns/day, 30.662 hours/ns, 18.119 timesteps/s, 6.631 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 206.51     | 213.45     | 217.01     |  23.8 | 77.35
Bond    | 0.0016516  | 0.0019116  | 0.0022097  |   0.4 |  0.00
Neigh   | 16.122     | 16.616     | 16.905     |   5.6 |  6.02
Comm    | 18.364     | 22.046     | 28.793     |  72.7 |  7.99
Output  | 0.031339   | 0.037557   | 0.043634   |   1.8 |  0.01
Modify  | 22.397     | 22.898     | 23.308     |   5.6 |  8.30
Other   |            | 0.9026     |            |       |  0.33

Nlocal:          45.75 ave          53 max          36 min
Histogram: 1 0 1 0 1 1 1 1 0 2
Nghost:        3575.38 ave        3608 max        3539 min
Histogram: 1 0 3 0 0 0 0 1 1 2
Neighs:          32036 ave       36903 max       25689 min
Histogram: 1 0 1 1 0 1 1 1 0 2

Total # of neighbors = 256288
Ave neighs/atom = 700.24044
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333-HD-100C-20-VASP_eq.data
System init for write_data ...
undump dump_eq
unfix myMSD

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.1249
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.4224
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 16.909

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal -0.6491
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 0.6162
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -8.2539

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 16.1249
variable dlen equal lx-${len0}
variable dlen equal lx-16.1249
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*16.1249
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 16.1249 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 16.1249 xy delta -8.2539 xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 16.1249 xy delta -8.2539 xz delta 0.6162 remap v units box flip no
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos1.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom 100 dump/pos1_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos1 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.8 | 145.2 | 146.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   309.1513      -41091.293     -3497.5017      3659.697       16.1249        13.4224        16.909       
       100   314.65066     -41086.575     -11111.78       3732.891       16.447398      13.4224        16.909       
       200   405.30039     -40905.197     -8734.0699      3806.0849      16.769896      13.4224        16.909       
       300   479.47981     -40861.742     -21234.228      3879.2788      17.092394      13.4224        16.909       
       400   449.26128     -40729.205     -30379.952      3952.4728      17.414892      13.4224        16.909       
       500   456.27112     -40646.447     -25237.643      4025.6667      17.73739       13.4224        16.909       
       600   505.81246     -40660.589     -42180.263      4098.8607      18.059888      13.4224        16.909       
       700   444.95731     -40548.372     -47286.353      4172.0546      18.382386      13.4224        16.909       
       800   431.57083     -40481.15      -49642.104      4245.2485      18.704884      13.4224        16.909       
       900   408.89632     -40420.055     -54746.437      4318.4425      19.027382      13.4224        16.909       
      1000   382.51042     -40272.369     -59971.286      4391.6364      19.34988       13.4224        16.909       
      1100   408.97432     -40100.143     -75006.123      4464.8304      19.672378      13.4224        16.909       
      1200   395.65938     -39913.52      -83150.152      4538.0243      19.994876      13.4224        16.909       
      1300   373.65367     -39802.811     -90573.537      4611.2182      20.317374      13.4224        16.909       
      1400   400.5923      -39732.094     -93150.239      4684.4122      20.639872      13.4224        16.909       
      1500   445.11553     -39703.28      -71191.497      4757.6061      20.96237       13.4224        16.909       
      1600   391.87881     -39716.802     -72011.575      4830.8001      21.284868      13.4224        16.909       
      1700   341.7639      -39610.098     -65440.817      4903.994       21.607366      13.4224        16.909       
      1800   364.03547     -39543.807     -78488.762      4977.1879      21.929864      13.4224        16.909       
      1900   390.44074     -39504.21      -72150.196      5050.3819      22.252362      13.4224        16.909       
      2000   632.87019     -39867.9       -52743.802      5123.5758      22.57486       13.4224        16.909       
      2100   498.16859     -39975.775     -53361.698      5196.7698      22.897358      13.4224        16.909       
      2200   418.16354     -39932.686     -42346.466      5269.9637      23.219856      13.4224        16.909       
      2300   409.48587     -39897.476     -56047.781      5343.1576      23.542354      13.4224        16.909       
      2400   386.62036     -39896.959     -59406.059      5416.3516      23.864852      13.4224        16.909       
      2500   343.44252     -39840.964     -56337.576      5489.5455      24.18735       13.4224        16.909       
      2600   336.61072     -39845.403     -46830.107      5562.7395      24.509848      13.4224        16.909       
      2700   340.35562     -39890.593     -46632.043      5635.9334      24.832346      13.4224        16.909       
      2800   379.44935     -39911.534     -50411.619      5709.1273      25.154844      13.4224        16.909       
      2900   367.85664     -39909.61      -55334.616      5782.3213      25.477342      13.4224        16.909       
      3000   348.89698     -39903.049     -36278.728      5855.5152      25.79984       13.4224        16.909       
      3100   310.24082     -39920.165     -36172.19       5928.7092      26.122338      13.4224        16.909       
      3200   348.39414     -40020.943     -30399.026      6001.9031      26.444836      13.4224        16.909       
      3300   336.86814     -40100.271     -21355.463      6075.097       26.767334      13.4224        16.909       
      3400   302.66521     -40101.529     -27230.422      6148.291       27.089832      13.4224        16.909       
      3500   314.80838     -40106.597     -29213.605      6221.4849      27.41233       13.4224        16.909       
      3600   303.13223     -40059.507     -30128.044      6294.6789      27.734828      13.4224        16.909       
      3700   313.93406     -40057.574     -30061.854      6367.8728      28.057326      13.4224        16.909       
      3800   295.1668      -40007.508     -29221.016      6441.0667      28.379824      13.4224        16.909       
      3900   299.23661     -39982.305     -26325.035      6514.2607      28.702322      13.4224        16.909       
      4000   259.99309     -39886.935     -30827.252      6587.4546      29.02482       13.4224        16.909       
      4100   284.80115     -39830.898     -33839.241      6660.6486      29.347318      13.4224        16.909       
      4200   299.84412     -39791.299     -39872.572      6733.8425      29.669816      13.4224        16.909       
      4300   290.36108     -39736.058     -35154.045      6807.0364      29.992314      13.4224        16.909       
      4400   317.01741     -39765.195     -35292.287      6880.2304      30.314812      13.4224        16.909       
      4500   295.97333     -39708.355     -33314.588      6953.4243      30.63731       13.4224        16.909       
      4600   364.28954     -39719.001     -23711.266      7026.6183      30.959808      13.4224        16.909       
      4700   379.1418      -39863.634     -22223.327      7099.8122      31.282306      13.4224        16.909       
      4800   331.27702     -39907.681     -20908.245      7173.0061      31.604804      13.4224        16.909       
      4900   286.30658     -39907.549     -27648.025      7246.2001      31.927302      13.4224        16.909       
      5000   275.78693     -39879.795     -25395.06       7319.394       32.2498        13.4224        16.909       
Loop time of 206.308 on 16 procs for 5000 steps with 366 atoms

Performance: 1.047 ns/day, 22.923 hours/ns, 24.236 timesteps/s, 8.870 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 152.09     | 155.03     | 157.79     |  15.4 | 75.14
Bond    | 0.0014746  | 0.0018846  | 0.0021472  |   0.5 |  0.00
Neigh   | 10.53      | 10.829     | 11.147     |   6.7 |  5.25
Comm    | 15.584     | 18.507     | 21.434     |  45.9 |  8.97
Output  | 0.02628    | 0.032768   | 0.037233   |   1.8 |  0.02
Modify  | 20.374     | 20.84      | 21.235     |   6.0 | 10.10
Other   |            | 1.072      |            |       |  0.52

Nlocal:          45.75 ave          64 max          34 min
Histogram: 1 3 0 0 2 0 0 0 1 1
Nghost:        2643.62 ave        2868 max        2448 min
Histogram: 2 2 0 0 0 0 1 1 0 2
Neighs:        16603.1 ave       22485 max       11519 min
Histogram: 1 1 2 0 0 2 0 0 1 1

Total # of neighbors = 132825
Ave neighs/atom = 362.90984
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.4224
variable dlen equal ly-${len0}
variable dlen equal ly-13.4224
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*13.4224
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 13.4224 yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 13.4224 yz delta -0.6491 remap v units box flip no
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos2.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom 100 dump/pos2_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos2 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.8 | 145.2 | 146.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   309.1513      -41091.293     -3497.5017      3659.697       16.1249        13.4224        16.909       
       100   312.76413     -41087.213     -11481.452      3732.891       16.1249        13.690848      16.909       
       200   353.76506     -40993.204     -1250.8388      3806.0849      16.1249        13.959296      16.909       
       300   399.3317      -40955.355     -22841.727      3879.2788      16.1249        14.227744      16.909       
       400   401.58732     -40920.495     -30414.206      3952.4728      16.1249        14.496192      16.909       
       500   394.98202     -40828.434     -32586.905      4025.6667      16.1249        14.76464       16.909       
       600   451.41803     -40791.148     -40147.183      4098.8607      16.1249        15.033088      16.909       
       700   396.44077     -40678.522     -39942.323      4172.0546      16.1249        15.301536      16.909       
       800   363.81385     -40589.331     -54422.112      4245.2485      16.1249        15.569984      16.909       
       900   399.8582      -40525.034     -48784.055      4318.4425      16.1249        15.838432      16.909       
      1000   389.16203     -40434.953     -53361.755      4391.6364      16.1249        16.10688       16.909       
      1100   411.19367     -40344.879     -72627.842      4464.8304      16.1249        16.375328      16.909       
      1200   413.57239     -40222.057     -74153.481      4538.0243      16.1249        16.643776      16.909       
      1300   379.83784     -40117.135     -85991.724      4611.2182      16.1249        16.912224      16.909       
      1400   323.60825     -39911.252     -98669.181      4684.4122      16.1249        17.180672      16.909       
      1500   354.05295     -39851.177     -92063.193      4757.6061      16.1249        17.44912       16.909       
      1600   406.16055     -39738.131     -86547.875      4830.8001      16.1249        17.717568      16.909       
      1700   324.88841     -39579.842     -88057.573      4903.994       16.1249        17.986016      16.909       
      1800   338.30038     -39431.867     -109086.09      4977.1879      16.1249        18.254464      16.909       
      1900   408.76644     -39325.145     -92571.486      5050.3819      16.1249        18.522912      16.909       
      2000   434.76494     -39232.894     -93959.966      5123.5758      16.1249        18.79136       16.909       
      2100   367.23163     -39056.926     -103606.71      5196.7698      16.1249        19.059808      16.909       
      2200   343.72741     -38842.053     -101039.36      5269.9637      16.1249        19.328256      16.909       
      2300   460.13209     -38813.378     -99259.094      5343.1576      16.1249        19.596704      16.909       
      2400   548.81688     -38914.779     -91738.747      5416.3516      16.1249        19.865152      16.909       
      2500   491.57397     -38813.778     -91778.244      5489.5455      16.1249        20.1336        16.909       
      2600   456.46269     -38832.807     -80696.187      5562.7395      16.1249        20.402048      16.909       
      2700   447.10809     -38924.429     -77160.07       5635.9334      16.1249        20.670496      16.909       
      2800   598.80731     -39177.173     -59599.382      5709.1273      16.1249        20.938944      16.909       
      2900   675.74676     -39625.066     -36247.226      5782.3213      16.1249        21.207392      16.909       
      3000   496.1901      -39807.226     -24864.745      5855.5152      16.1249        21.47584       16.909       
      3100   402.84029     -39899.835     -40405.834      5928.7092      16.1249        21.744288      16.909       
      3200   299.61596     -39836.044     -31003.123      6001.9031      16.1249        22.012736      16.909       
      3300   323.49811     -39835.231     -48139.486      6075.097       16.1249        22.281184      16.909       
      3400   296.61578     -39740.329     -48405.061      6148.291       16.1249        22.549632      16.909       
      3500   357.73539     -39719.117     -45014.294      6221.4849      16.1249        22.81808       16.909       
      3600   345.71683     -39657.323     -46446.73       6294.6789      16.1249        23.086528      16.909       
      3700   309.50721     -39616.838     -50013.574      6367.8728      16.1249        23.354976      16.909       
      3800   350.65575     -39706.093     -37785.931      6441.0667      16.1249        23.623424      16.909       
      3900   358.64316     -39830.562     -34392.584      6514.2607      16.1249        23.891872      16.909       
      4000   312.83397     -39824.927     -34676.793      6587.4546      16.1249        24.16032       16.909       
      4100   307.81092     -39829.924     -29606.639      6660.6486      16.1249        24.428768      16.909       
      4200   247.59732     -39761.13      -30010.131      6733.8425      16.1249        24.697216      16.909       
      4300   264.23959     -39709.899     -30138.597      6807.0364      16.1249        24.965664      16.909       
      4400   311.29177     -39733.191     -29668.66       6880.2304      16.1249        25.234112      16.909       
      4500   292.00536     -39752.686     -30546.563      6953.4243      16.1249        25.50256       16.909       
      4600   435.06276     -39971.094     -18990.76       7026.6183      16.1249        25.771008      16.909       
      4700   345.20497     -40068.839     -12996.323      7099.8122      16.1249        26.039456      16.909       
      4800   301.34685     -40179.981     -9985.2741      7173.0061      16.1249        26.307904      16.909       
      4900   250.26326     -40174.752     -12784.019      7246.2001      16.1249        26.576352      16.909       
      5000   315.75475     -40233.791     -7982.9088      7319.394       16.1249        26.8448        16.909       
Loop time of 182.694 on 16 procs for 5000 steps with 366 atoms

Performance: 1.182 ns/day, 20.299 hours/ns, 27.368 timesteps/s, 10.017 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 126.99     | 133.16     | 137.9      |  32.8 | 72.89
Bond    | 0.0014681  | 0.0018351  | 0.0021078  |   0.4 |  0.00
Neigh   | 9.0159     | 9.3897     | 9.6982     |   7.6 |  5.14
Comm    | 13.942     | 18.741     | 24.994     |  87.5 | 10.26
Output  | 0.025568   | 0.030953   | 0.035475   |   1.8 |  0.02
Modify  | 19.82      | 20.308     | 20.644     |   6.2 | 11.12
Other   |            | 1.061      |            |       |  0.58

Nlocal:          45.75 ave          62 max          25 min
Histogram: 1 0 1 0 2 1 0 1 0 2
Nghost:         2001.5 ave        2176 max        1801 min
Histogram: 3 1 0 0 0 0 0 0 0 4
Neighs:        17865.5 ave       24784 max       10858 min
Histogram: 2 0 2 0 0 0 1 1 0 2

Total # of neighbors = 142924
Ave neighs/atom = 390.50273
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 16.909
variable dlen equal lz-${len0}
variable dlen equal lz-16.909
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.005 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*16.909
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 16.909 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos3.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom 100 dump/pos3_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos3 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.8 | 145.2 | 146.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   309.1513      -41091.293     -3497.5017      3659.697       16.1249        13.4224        16.909       
       100   311.79252     -41086.348     -11116.014      3732.891       16.1249        13.4224        17.24718     
       200   385.98996     -40959.324     -1947.2877      3806.0849      16.1249        13.4224        17.58536     
       300   437.67372     -40865.849     -20341.3        3879.2788      16.1249        13.4224        17.92354     
       400   441.5174      -40787.244     -20863.906      3952.4728      16.1249        13.4224        18.26172     
       500   443.48785     -40804.028     -38408.304      4025.6667      16.1249        13.4224        18.5999      
       600   431.90787     -40677.814     -41835.961      4098.8607      16.1249        13.4224        18.93808     
       700   455.21383     -40647.654     -52946.563      4172.0546      16.1249        13.4224        19.27626     
       800   456.31156     -40590.734     -48391.653      4245.2485      16.1249        13.4224        19.61444     
       900   376.33867     -40469.513     -59067.846      4318.4425      16.1249        13.4224        19.95262     
      1000   397.3686      -40417.629     -73408.51       4391.6364      16.1249        13.4224        20.2908      
      1100   396.64679     -40329.492     -82313.848      4464.8304      16.1249        13.4224        20.62898     
      1200   371.36455     -40202.584     -83713.108      4538.0243      16.1249        13.4224        20.96716     
      1300   330.76672     -40092.589     -91385.937      4611.2182      16.1249        13.4224        21.30534     
      1400   333.2322      -39937.209     -91556.886      4684.4122      16.1249        13.4224        21.64352     
      1500   391.51386     -39845.355     -72799.455      4757.6061      16.1249        13.4224        21.9817      
      1600   427.07844     -39868.013     -72386.923      4830.8001      16.1249        13.4224        22.31988     
      1700   317.35445     -39664.282     -66359.965      4903.994       16.1249        13.4224        22.65806     
      1800   408.15985     -39785.549     -60750.7        4977.1879      16.1249        13.4224        22.99624     
      1900   396.81612     -39894.785     -49208.274      5050.3819      16.1249        13.4224        23.33442     
      2000   434.59871     -40004.696     -37465.038      5123.5758      16.1249        13.4224        23.6726      
      2100   405.26995     -40076.662     -31043.502      5196.7698      16.1249        13.4224        24.01078     
      2200   494.75778     -40300.156     -17291.725      5269.9637      16.1249        13.4224        24.34896     
      2300   414.19045     -40442.829     -2943.4156      5343.1576      16.1249        13.4224        24.68714     
      2400   364.11412     -40513.296     -4314.8129      5416.3516      16.1249        13.4224        25.02532     
      2500   330.79495     -40576.558     -944.721        5489.5455      16.1249        13.4224        25.3635      
      2600   315.32819     -40630.97      -3865.1333      5562.7395      16.1249        13.4224        25.70168     
      2700   308.66122     -40674.751     -2266.0932      5635.9334      16.1249        13.4224        26.03986     
      2800   271.47971     -40671.306     -10959.382      5709.1273      16.1249        13.4224        26.37804     
      2900   262.03108     -40671.417     -9851.2869      5782.3213      16.1249        13.4224        26.71622     
      3000   280.08379     -40681.447     -3962.6908      5855.5152      16.1249        13.4224        27.0544      
      3100   261.82506     -40644.38      -10459.433      5928.7092      16.1249        13.4224        27.39258     
      3200   268.64653     -40641.628     -5017.8453      6001.9031      16.1249        13.4224        27.73076     
      3300   286.06016     -40689.23      -3348.1164      6075.097       16.1249        13.4224        28.06894     
      3400   315.59712     -40714.816     -12011.765      6148.291       16.1249        13.4224        28.40712     
      3500   329.55854     -40737.208     -8999.9565      6221.4849      16.1249        13.4224        28.7453      
      3600   291.56159     -40661.979     -3646.1224      6294.6789      16.1249        13.4224        29.08348     
      3700   265.45803     -40655.425     -2730.2459      6367.8728      16.1249        13.4224        29.42166     
      3800   253.70592     -40686.586     -3801.0179      6441.0667      16.1249        13.4224        29.75984     
      3900   298.96787     -40744.035     -4292.8323      6514.2607      16.1249        13.4224        30.09802     
      4000   311.35721     -40722.791      570.78198      6587.4546      16.1249        13.4224        30.4362      
      4100   291.00558     -40639.345     -7896.9165      6660.6486      16.1249        13.4224        30.77438     
      4200   263.77938     -40621.699     -11882.629      6733.8425      16.1249        13.4224        31.11256     
      4300   248.37002     -40581.666     -9100.0693      6807.0364      16.1249        13.4224        31.45074     
      4400   311.54303     -40697.238     -7705.9989      6880.2304      16.1249        13.4224        31.78892     
      4500   280.45788     -40717.293     -2768.5825      6953.4243      16.1249        13.4224        32.1271      
      4600   282.83083     -40692.942     -439.71365      7026.6183      16.1249        13.4224        32.46528     
      4700   313.60967     -40694.839     -7777.8515      7099.8122      16.1249        13.4224        32.80346     
      4800   338.95252     -40716.514     -4225.6696      7173.0061      16.1249        13.4224        33.14164     
      4900   283.95318     -40687.707     -6572.6443      7246.2001      16.1249        13.4224        33.47982     
      5000   291.59799     -40657.49      -3704.5374      7319.394       16.1249        13.4224        33.818       
Loop time of 206.929 on 16 procs for 5000 steps with 366 atoms

Performance: 1.044 ns/day, 22.992 hours/ns, 24.163 timesteps/s, 8.844 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 141.49     | 150.26     | 159.99     |  57.1 | 72.61
Bond    | 0.0014918  | 0.0019127  | 0.002183   |   0.5 |  0.00
Neigh   | 9.0971     | 9.6799     | 10.291     |  15.7 |  4.68
Comm    | 13.067     | 22.898     | 31.85      | 149.2 | 11.07
Output  | 0.028164   | 0.034314   | 0.039091   |   1.7 |  0.02
Modify  | 22.471     | 23.056     | 23.733     |  10.9 | 11.14
Other   |            | 1.001      |            |       |  0.48

Nlocal:          45.75 ave          79 max          13 min
Histogram: 3 1 0 0 0 0 0 0 0 4
Nghost:        2235.25 ave        2684 max        1798 min
Histogram: 4 0 0 0 0 0 0 0 0 4
Neighs:        21018.4 ave       38329 max        3758 min
Histogram: 3 1 0 0 0 0 0 0 0 4

Total # of neighbors = 168147
Ave neighs/atom = 459.41803
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 16.1249
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz--0.6491)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*16.1249
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_p all deform 100 yz delta ${delta} remap v units box flip no
fix deform_p all deform 100 yz delta 16.1249 remap v units box flip no
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos4.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom 100 dump/pos4_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos4 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.8 | 145.2 | 146.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   309.1513      -41091.293     -3497.5017      3659.697       16.1249        13.4224        16.909       
       100   313.94566     -41085.974     -11191.859      3659.697       16.1249        13.4224        16.909       
       200   369.51784     -40937.193      246.06364      3659.697       16.1249        13.4224        16.909       
       300   516.19206     -40795.753     -1862.4044      3659.697       16.1249        13.4224        16.909       
       400   461.38064     -40834.345     -1695.6954      3659.697       16.1249        13.4224        16.909       
       500   456.3828      -40915.149     -16472.255      3659.697       16.1249        13.4224        16.909       
       600   460.95506     -40865.363     -8532.5183      3659.697       16.1249        13.4224        16.909       
       700   344.45004     -40789.782      2111.007       3659.697       16.1249        13.4224        16.909       
       800   378.21903     -40871.615     -9259.5715      3659.697       16.1249        13.4224        16.909       
       900   387.53453     -40787.56      -12379.769      3659.697       16.1249        13.4224        16.909       
      1000   401.95117     -40728.051     -10356.665      3659.697       16.1249        13.4224        16.909       
      1100   360.49782     -40685.417      652.91787      3659.697       16.1249        13.4224        16.909       
      1200   352.91498     -40639.118     -13005.251      3659.697       16.1249        13.4224        16.909       
      1300   440.60429     -40610.288     -13883.329      3659.697       16.1249        13.4224        16.909       
      1400   462.64996     -40540.21      -11248.709      3659.697       16.1249        13.4224        16.909       
      1500   405.1705      -40530.874     -14548.779      3659.697       16.1249        13.4224        16.909       
      1600   347.77307     -40449.839     -20086.724      3659.697       16.1249        13.4224        16.909       
      1700   363.8106      -40476.78      -18800.538      3659.697       16.1249        13.4224        16.909       
      1800   387.18033     -40408.799     -26905.189      3659.697       16.1249        13.4224        16.909       
      1900   365.17213     -40363.892     -29566.733      3659.697       16.1249        13.4224        16.909       
      2000   346.36545     -40246.733     -19699.58       3659.697       16.1249        13.4224        16.909       
      2100   323.39883     -40223.495     -25328.116      3659.697       16.1249        13.4224        16.909       
      2200   304.4565      -40200.368     -30972.556      3659.697       16.1249        13.4224        16.909       
      2300   348.18906     -40149.336     -46898.639      3659.697       16.1249        13.4224        16.909       
      2400   352.09017     -39997.489     -27609.505      3659.697       16.1249        13.4224        16.909       
      2500   319.4536      -39879.847     -23848.564      3659.697       16.1249        13.4224        16.909       
      2600   349.62687     -39917.9       -31229.104      3659.697       16.1249        13.4224        16.909       
      2700   351.226       -39953.993     -31913.367      3659.697       16.1249        13.4224        16.909       
      2800   429.86754     -39867.87      -3393.743       3659.697       16.1249        13.4224        16.909       
      2900   398.18294     -39931.038     -32908.142      3659.697       16.1249        13.4224        16.909       
      3000   438.93789     -39983.099     -16013.312      3659.697       16.1249        13.4224        16.909       
      3100   374.47551     -40019.189     -2550.1432      3659.697       16.1249        13.4224        16.909       
      3200   336.30804     -39963.423     -24007.062      3659.697       16.1249        13.4224        16.909       
      3300   368.59197     -39917.801     -29410.401      3659.697       16.1249        13.4224        16.909       
      3400   352.40706     -39925.665     -30297.517      3659.697       16.1249        13.4224        16.909       
      3500   413.04233     -39983.472     -12887.473      3659.697       16.1249        13.4224        16.909       
      3600   361.84492     -40026.478     -6578.5566      3659.697       16.1249        13.4224        16.909       
      3700   365.02848     -40134.223     -11917.214      3659.697       16.1249        13.4224        16.909       
      3800   312.90585     -40087.408     -16245.091      3659.697       16.1249        13.4224        16.909       
      3900   327.23694     -40044.2       -19984.012      3659.697       16.1249        13.4224        16.909       
      4000   323.55301     -40031.32      -13199.601      3659.697       16.1249        13.4224        16.909       
      4100   309.73537     -40035.259     -34345.564      3659.697       16.1249        13.4224        16.909       
      4200   295.17768     -40017.849     -26229.166      3659.697       16.1249        13.4224        16.909       
      4300   327.34112     -39978.741     -25814.583      3659.697       16.1249        13.4224        16.909       
      4400   333.70946     -39942.453     -37978.222      3659.697       16.1249        13.4224        16.909       
      4500   407.33611     -39923.065     -17831.065      3659.697       16.1249        13.4224        16.909       
      4600   435.72568     -40099.14      -14749.238      3659.697       16.1249        13.4224        16.909       
      4700   419.7664      -40174.704      6744.6986      3659.697       16.1249        13.4224        16.909       
      4800   401.43615     -40231.806     -5210.4134      3659.697       16.1249        13.4224        16.909       
      4900   363.3954      -40214.932     -11053.757      3659.697       16.1249        13.4224        16.909       
      5000   356.52075     -40174.028     -24946.852      3659.697       16.1249        13.4224        16.909       
Loop time of 317.226 on 16 procs for 5000 steps with 366 atoms

Performance: 0.681 ns/day, 35.247 hours/ns, 15.762 timesteps/s, 5.769 katom-step/s
99.2% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 237.74     | 244.5      | 252.78     |  31.0 | 77.07
Bond    | 0.0015816  | 0.0019974  | 0.0023353  |   0.5 |  0.00
Neigh   | 18.45      | 19.024     | 19.578     |   8.0 |  6.00
Comm    | 17.811     | 26.315     | 33.236     |  96.3 |  8.30
Output  | 0.023225   | 0.028187   | 0.032204   |   1.6 |  0.01
Modify  | 25.56      | 26.338     | 27.082     |   8.7 |  8.30
Other   |            | 1.019      |            |       |  0.32

Nlocal:          45.75 ave          57 max          36 min
Histogram: 2 0 0 1 2 1 0 0 1 1
Nghost:        4948.62 ave        5036 max        4858 min
Histogram: 3 1 0 0 0 0 0 0 0 4
Neighs:        31942.8 ave       39287 max       25614 min
Histogram: 2 0 0 1 2 1 0 0 1 1

Total # of neighbors = 255542
Ave neighs/atom = 698.20219
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.4224
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-0.6162)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*13.4224
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_p all deform 100 xz delta ${delta} remap v units box flip no
fix deform_p all deform 100 xz delta 13.4224 remap v units box flip no
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos5.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom 100 dump/pos5_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos5 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.8 | 145.2 | 146.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   309.1513      -41091.293     -3497.5017      3659.697       16.1249        13.4224        16.909       
       100   314.12958     -41087.701     -11244.151      3659.697       16.1249        13.4224        16.909       
       200   388.5514      -40990.156     -393.2185       3659.697       16.1249        13.4224        16.909       
       300   399.15391     -40934.169     -4264.8019      3659.697       16.1249        13.4224        16.909       
       400   445.27816     -40935.159     -8999.7337      3659.697       16.1249        13.4224        16.909       
       500   382.53516     -40918.785      21.856102      3659.697       16.1249        13.4224        16.909       
       600   390.38425     -40939.453     -3783.8253      3659.697       16.1249        13.4224        16.909       
       700   321.48288     -40957.549     -8839.3722      3659.697       16.1249        13.4224        16.909       
       800   307.97751     -40960.32      -4981.8214      3659.697       16.1249        13.4224        16.909       
       900   333.54061     -40933.891      6081.3298      3659.697       16.1249        13.4224        16.909       
      1000   363.64732     -40955.191     -13400.121      3659.697       16.1249        13.4224        16.909       
      1100   318.56466     -40857.15       5640.8055      3659.697       16.1249        13.4224        16.909       
      1200   358.3033      -40891.329      749.77358      3659.697       16.1249        13.4224        16.909       
      1300   331.92435     -40852.169      3211.1212      3659.697       16.1249        13.4224        16.909       
      1400   348.49784     -40828.493      5209.5624      3659.697       16.1249        13.4224        16.909       
      1500   339.98829     -40784.996     -228.887        3659.697       16.1249        13.4224        16.909       
      1600   321.47944     -40715.291     -3360.4777      3659.697       16.1249        13.4224        16.909       
      1700   342.82048     -40732.123     -1064.0696      3659.697       16.1249        13.4224        16.909       
      1800   376.21924     -40720.909      875.94817      3659.697       16.1249        13.4224        16.909       
      1900   315.09318     -40642.9       -8795.1202      3659.697       16.1249        13.4224        16.909       
      2000   304.98862     -40652.784     -3680.6926      3659.697       16.1249        13.4224        16.909       
      2100   319.1415      -40599.556     -19031.954      3659.697       16.1249        13.4224        16.909       
      2200   347.04773     -40513.408     -14549.514      3659.697       16.1249        13.4224        16.909       
      2300   378.70486     -40416.033     -16033.849      3659.697       16.1249        13.4224        16.909       
      2400   306.05604     -40371.178     -19187.294      3659.697       16.1249        13.4224        16.909       
      2500   287.48345     -40318.574     -7776.7156      3659.697       16.1249        13.4224        16.909       
      2600   371.1634      -40299.029     -29017.22       3659.697       16.1249        13.4224        16.909       
      2700   339.69696     -40296.906     -13691.584      3659.697       16.1249        13.4224        16.909       
      2800   308.55733     -40268.559     -24808.661      3659.697       16.1249        13.4224        16.909       
      2900   294.7256      -40186.299     -38269.114      3659.697       16.1249        13.4224        16.909       
      3000   324.13628     -40202.045     -34750.721      3659.697       16.1249        13.4224        16.909       
      3100   335.26799     -40171.008     -22804.775      3659.697       16.1249        13.4224        16.909       
      3200   396.01107     -40271.154      8002.8549      3659.697       16.1249        13.4224        16.909       
      3300   450.37382     -40392.281      17664.137      3659.697       16.1249        13.4224        16.909       
      3400   386.06569     -40400.454      3597.3896      3659.697       16.1249        13.4224        16.909       
      3500   337.34171     -40375.873     -3178.6074      3659.697       16.1249        13.4224        16.909       
      3600   286.35717     -40305.319     -1048.2938      3659.697       16.1249        13.4224        16.909       
      3700   303.69953     -40289.568     -5097.7365      3659.697       16.1249        13.4224        16.909       
      3800   286.55676     -40239.97      -15431.463      3659.697       16.1249        13.4224        16.909       
      3900   279.2837      -40194.335     -17081.204      3659.697       16.1249        13.4224        16.909       
      4000   291.37006     -40155.535     -12036.867      3659.697       16.1249        13.4224        16.909       
      4100   310.0254      -40150.744      5201.1378      3659.697       16.1249        13.4224        16.909       
      4200   331.71481     -40097.611     -8025.7748      3659.697       16.1249        13.4224        16.909       
      4300   355.52236     -40060.426     -21938.806      3659.697       16.1249        13.4224        16.909       
      4400   384.83929     -40146.923     -15398.434      3659.697       16.1249        13.4224        16.909       
      4500   317.58719     -40088.936     -26013.917      3659.697       16.1249        13.4224        16.909       
      4600   318.86895     -40038.81      -4386.823       3659.697       16.1249        13.4224        16.909       
      4700   431.49815     -39983.183     -4523.5305      3659.697       16.1249        13.4224        16.909       
      4800   415.74624     -40100.481     -2215.1195      3659.697       16.1249        13.4224        16.909       
      4900   470.72058     -40199.18       17458.425      3659.697       16.1249        13.4224        16.909       
      5000   362.29129     -40137.851     -443.43837      3659.697       16.1249        13.4224        16.909       
Loop time of 279.232 on 16 procs for 5000 steps with 366 atoms

Performance: 0.774 ns/day, 31.026 hours/ns, 17.906 timesteps/s, 6.554 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 188.75     | 209.53     | 224.09     |  77.5 | 75.04
Bond    | 0.0014772  | 0.001781   | 0.0021034  |   0.5 |  0.00
Neigh   | 15.279     | 16.924     | 18.062     |  22.3 |  6.06
Comm    | 13.143     | 27.683     | 48.419     | 212.2 |  9.91
Output  | 0.017883   | 0.021002   | 0.023387   |   1.1 |  0.01
Modify  | 23.463     | 24.614     | 26.177     |  18.0 |  8.81
Other   |            | 0.4614     |            |       |  0.17

Nlocal:          45.75 ave          52 max          37 min
Histogram: 1 1 0 0 1 0 1 1 1 2
Nghost:        4162.25 ave        4209 max        4114 min
Histogram: 1 1 0 2 0 0 1 1 1 1
Neighs:        32012.8 ave       36208 max       26247 min
Histogram: 1 1 0 1 0 0 1 2 0 2

Total # of neighbors = 256102
Ave neighs/atom = 699.73224
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 16.909
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--8.2539)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*16.909
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_p all deform 100 xy delta ${delta} remap v units box flip no
fix deform_p all deform 100 xy delta 16.909 remap v units box flip no

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos6.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom 100 dump/pos6_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos6 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 143.8 | 145.2 | 146.5 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   309.1513      -41091.293     -3497.5017      3659.697       16.1249        13.4224        16.909       
       100   311.98879     -41081.31      -10925.013      3659.697       16.1249        13.4224        16.909       
       200   370.1668      -40963.178      6272.2028      3659.697       16.1249        13.4224        16.909       
       300   401.55482     -40915.963      2463.901       3659.697       16.1249        13.4224        16.909       
       400   416.9924      -40759.02      -4414.0699      3659.697       16.1249        13.4224        16.909       
       500   464.63849     -40840.32      -7416.8012      3659.697       16.1249        13.4224        16.909       
       600   429.8214      -40863.36       2717.7699      3659.697       16.1249        13.4224        16.909       
       700   394.34901     -40842.199     -4957.5844      3659.697       16.1249        13.4224        16.909       
       800   378.03934     -40821.842      2204.46        3659.697       16.1249        13.4224        16.909       
       900   394.61254     -40810.847     -2644.5255      3659.697       16.1249        13.4224        16.909       
      1000   423.48542     -40750.326     -4917.8696      3659.697       16.1249        13.4224        16.909       
      1100   354.13901     -40688.864     -9192.8864      3659.697       16.1249        13.4224        16.909       
      1200   303.15212     -40622.871     -3789.5067      3659.697       16.1249        13.4224        16.909       
      1300   301.6979      -40477.754     -6267.7823      3659.697       16.1249        13.4224        16.909       
      1400   293.91911     -40398.493     -21818.58       3659.697       16.1249        13.4224        16.909       
      1500   324.66232     -40313.182     -13594.784      3659.697       16.1249        13.4224        16.909       
      1600   348.11053     -40232.262     -15674.629      3659.697       16.1249        13.4224        16.909       
      1700   340.2562      -40144.408     -23596.426      3659.697       16.1249        13.4224        16.909       
      1800   363.11265     -40080.825     -2335.1586      3659.697       16.1249        13.4224        16.909       
      1900   338.28005     -40007.907     -20995.22       3659.697       16.1249        13.4224        16.909       
      2000   346.83908     -39924.337     -25769.552      3659.697       16.1249        13.4224        16.909       
      2100   378.24912     -39842.505     -45750.377      3659.697       16.1249        13.4224        16.909       
      2200   324.61993     -39741.556     -32258.842      3659.697       16.1249        13.4224        16.909       
      2300   392.50533     -39675.906     -36581.846      3659.697       16.1249        13.4224        16.909       
      2400   424.16129     -39645.479     -40246.989      3659.697       16.1249        13.4224        16.909       
      2500   442.68972     -39697.762     -34230.175      3659.697       16.1249        13.4224        16.909       
      2600   452.16022     -39703.609     -14716.693      3659.697       16.1249        13.4224        16.909       
      2700   444.41331     -39735.813     -43712.854      3659.697       16.1249        13.4224        16.909       
      2800   419.73792     -39727.596     -26042.202      3659.697       16.1249        13.4224        16.909       
      2900   499.95502     -39765.422     -23496.254      3659.697       16.1249        13.4224        16.909       
      3000   473.43117     -39824.868     -4225.0459      3659.697       16.1249        13.4224        16.909       
      3100   451.04093     -39853.053     -43903.48       3659.697       16.1249        13.4224        16.909       
      3200   435.9192      -39884.857     -12252.056      3659.697       16.1249        13.4224        16.909       
      3300   360.25033     -39862.41      -13623.852      3659.697       16.1249        13.4224        16.909       
      3400   330.72896     -39800.789     -26752.092      3659.697       16.1249        13.4224        16.909       
      3500   349.34702     -39735.852     -33246.486      3659.697       16.1249        13.4224        16.909       
      3600   351.82247     -39667.44      -10964.012      3659.697       16.1249        13.4224        16.909       
      3700   406.09609     -39641.887     -28505.729      3659.697       16.1249        13.4224        16.909       
      3800   427.10765     -39701.001     -26697.457      3659.697       16.1249        13.4224        16.909       
      3900   416.81399     -39773.516     -19383.685      3659.697       16.1249        13.4224        16.909       
      4000   428.28259     -39865.894     -22108.171      3659.697       16.1249        13.4224        16.909       
      4100   362.93768     -39859.033     -36579.076      3659.697       16.1249        13.4224        16.909       
      4200   328.60344     -39796.132     -23430.607      3659.697       16.1249        13.4224        16.909       
      4300   364.67561     -39824.309     -30586.823      3659.697       16.1249        13.4224        16.909       
      4400   369.46141     -39759.183     -38407.075      3659.697       16.1249        13.4224        16.909       
      4500   410.85935     -39752.571     -7824.0973      3659.697       16.1249        13.4224        16.909       
      4600   376.26975     -39709.96      -9824.6576      3659.697       16.1249        13.4224        16.909       
      4700   348.50756     -39684.286     -43207.003      3659.697       16.1249        13.4224        16.909       
      4800   386.3501      -39741.284     -6903.1364      3659.697       16.1249        13.4224        16.909       
      4900   437.41968     -39654.534     -1137.7873      3659.697       16.1249        13.4224        16.909       
      5000   387.69663     -39636.815     -10604.697      3659.697       16.1249        13.4224        16.909       
Loop time of 141.52 on 16 procs for 5000 steps with 366 atoms

Performance: 1.526 ns/day, 15.724 hours/ns, 35.331 timesteps/s, 12.931 katom-step/s
99.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 108.25     | 109.89     | 112.52     |  11.5 | 77.65
Bond    | 0.0008354  | 0.0010409  | 0.0013291  |   0.6 |  0.00
Neigh   | 11.66      | 11.791     | 11.935     |   2.8 |  8.33
Comm    | 1.8427     | 4.4717     | 6.1215     |  57.0 |  3.16
Output  | 0.010319   | 0.011719   | 0.012543   |   0.7 |  0.01
Modify  | 15.109     | 15.245     | 15.365     |   2.4 | 10.77
Other   |            | 0.1106     |            |       |  0.08

Nlocal:          45.75 ave          54 max          39 min
Histogram: 2 0 1 1 1 0 1 0 0 2
Nghost:        3576.25 ave        3602 max        3536 min
Histogram: 1 0 1 0 1 0 1 1 0 3
Neighs:        32038.2 ave       37631 max       27446 min
Histogram: 2 0 1 1 1 1 0 0 0 2

Total # of neighbors = 256306
Ave neighs/atom = 700.28962
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:26:55
