LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 100
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 50
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 1.0                  # the deformation magnitude 0.01

variable FF string "SiOCHN_2018.ff C H O Si"   # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si
variable structure string 333U-50C-33-vasp

# Read the initial sctructure
# box tilt large
read_data       ${structure}.data
read_data       333U-50C-33-vasp.data
Reading data file ...
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.008 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
fix bondinfo all reaxff/bonds 1 bonds_opt.reaxff

# Energy minimization
print "*****Minimization starts.*****"
*****Minimization starts.*****
dump dump_opt all custom 1 dump/dump_opt.lammpstrj id type q x y z
minimize 1.0e-6 1.0e-6 100 1000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

WARNING: Fix qeq/reaxff group is not charge neutral, net charge = -6.56 (src/REAXFF/fix_qeq_reaxff.cpp:392)
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 134.9 | 135.7 | 136.8 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0             -32797.121      0             -32797.121      172056.5     
        60   0             -35629.376      0             -35629.376     -956.28233    
Loop time of 10.7448 on 16 procs for 60 steps with 365 atoms

97.5% CPU use with 8 MPI tasks x 2 OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
     -32797.1208236905  -35629.3428634309  -35629.3763555484
  Force two-norm initial, final = 4765.6281 337.16778
  Force max component initial, final = 1232.8275 160.03361
  Final line search alpha, max atom move = 0.00042633883 0.068228544
  Iterations, force evaluations = 60 251

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 5.9743     | 6.6929     | 8.4172     |  37.4 | 62.29
Bond    | 6.1704e-05 | 8.0851e-05 | 0.00010559 |   0.0 |  0.00
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.24455    | 1.969      | 2.6887     |  68.9 | 18.33
Output  | 0.010788   | 0.015213   | 0.018007   |   2.1 |  0.14
Modify  | 2.0516     | 2.0528     | 2.0539     |   0.1 | 19.11
Other   |            | 0.01479    |            |       |  0.14

Nlocal:         45.625 ave          49 max          40 min
Histogram: 1 0 0 1 0 1 1 2 1 1
Nghost:        3279.12 ave        3312 max        3249 min
Histogram: 2 1 1 0 0 0 0 2 0 2
Neighs:          29963 ave       32093 max       26502 min
Histogram: 1 0 0 1 0 1 1 2 1 1

Total # of neighbors = 239704
Ave neighs/atom = 656.72329
Ave special neighs/atom = 0
Neighbor list builds = 0
Dangerous builds = 0
min_style cg
# Save the optimized structure
write_data ${structure}_opt.data
write_data 333U-50C-33-vasp_opt.data
System init for write_data ...
undump dump_opt
unfix bondinfo
velocity        all create ${temp} ${seed} dist gaussian
velocity        all create 300 ${seed} dist gaussian
velocity        all create 300 123456 dist gaussian

# Equilibration
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50

if "$(is_defined(fix,avgp))" then "unfix avgp"
unfix avgp
if "$(is_defined(fix,avgl))" then "unfix avgl"
thermo_style custom step temp pe press density vol
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:903)
dump dump_eq all custom ${nthermo} dump/dump_eq.lammpstrj id type q x y z
dump dump_eq all custom 100 dump/dump_eq.lammpstrj id type q x y z

# compute MSD
compute msd1 all msd
fix myMSD all ave/time ${nevery} ${nrepeat} ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 ${nrepeat} ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 10 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out
fix myMSD all ave/time 10 10 100 c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp file msd.out

run ${nequil}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 128.7 | 129.6 | 130.5 Mbytes
   Step          Temp          PotEng         Press         Density         Volume    
         0   300           -35629.377      2872.3532      1.701333       3885.8921    
       100   226.72995     -35509.907      9251.6317      1.701333       3885.8921    
       200   262.72449     -35491.434     -219.24957      1.701333       3885.8921    
       300   286.25069     -35468.094     -8784.5181      1.701333       3885.8921    
       400   316.44433     -35467.186     -11502.82       1.701333       3885.8921    
       500   313.89347     -35466.538      3771.0604      1.701333       3885.8921    
       600   301.57823     -35479.45       5812.0681      1.701333       3885.8921    
       700   321.80241     -35527.997     -4853.0746      1.701333       3885.8921    
       800   285.09461     -35517.077      361.38063      1.701333       3885.8921    
       900   286.62383     -35534.487     -1229.9443      1.701333       3885.8921    
      1000   315.83915     -35575.562      5428.1345      1.701333       3885.8921    
      1100   309.03036     -35582.297      8177.9481      1.701333       3885.8921    
      1200   288.01628     -35591.686      11055.669      1.701333       3885.8921    
      1300   299.19899     -35619.17       1750.5783      1.701333       3885.8921    
      1400   310.71407     -35640.288      850.56034      1.701333       3885.8921    
      1500   321.68463     -35663.488     -12640.92       1.701333       3885.8921    
      1600   300.76051     -35684.688      4016.1469      1.701333       3885.8921    
      1700   289.62653     -35695.77       1192.12        1.701333       3885.8921    
      1800   305.18027     -35744.067     -6863.9923      1.701333       3885.8921    
      1900   289.17649     -35750.667      13361.422      1.701333       3885.8921    
      2000   301.5489      -35774.329      18073.09       1.701333       3885.8921    
      2100   294.50561     -35776.018     -1947.7174      1.701333       3885.8921    
      2200   341.94394     -35821.128      13317.307      1.701333       3885.8921    
      2300   338.46387     -35857.064     -1719.18        1.701333       3885.8921    
      2400   295.19255     -35846.673      8070.4775      1.701333       3885.8921    
      2500   306.37701     -35876.629     -1446.0106      1.701333       3885.8921    
      2600   348.3304      -35946.615      3709.2197      1.701333       3885.8921    
      2700   325.16265     -35971.481      13892.241      1.701333       3885.8921    
      2800   332.02665     -36049.932      6587.0564      1.701333       3885.8921    
      2900   371.1259      -36163.805      4137.3187      1.701333       3885.8921    
      3000   341.71432     -36210.423      5980.345       1.701333       3885.8921    
      3100   383.26831     -36332.499      10407.822      1.701333       3885.8921    
      3200   307.78439     -36311.688      6044.0547      1.701333       3885.8921    
      3300   330.23958     -36380.309     -539.65352      1.701333       3885.8921    
      3400   253.84145     -36313.14      -6517.3316      1.701333       3885.8921    
      3500   311.54571     -36377.311      5728.7173      1.701333       3885.8921    
      3600   330.36963     -36373.254     -2421.5363      1.701333       3885.8921    
      3700   305.99799     -36324.613      1517.2095      1.701333       3885.8921    
      3800   309.79107     -36359.734     -1066.1202      1.701333       3885.8921    
      3900   300.00355     -36390.478      7895.6323      1.701333       3885.8921    
      4000   312.42185     -36425.271      4513.7215      1.701333       3885.8921    
      4100   297.32796     -36420.708     -4739.5584      1.701333       3885.8921    
      4200   337.33828     -36494.414      2018.3906      1.701333       3885.8921    
      4300   281.47654     -36452.992      5211.2361      1.701333       3885.8921    
      4400   278.30663     -36458.228     -13845.1        1.701333       3885.8921    
      4500   298.35769     -36484.147     -3254.9369      1.701333       3885.8921    
      4600   304.41266     -36480.21       603.48341      1.701333       3885.8921    
      4700   306.85411     -36461.862     -3116.8324      1.701333       3885.8921    
      4800   291.75153     -36466.254      7400.4069      1.701333       3885.8921    
      4900   313.2838      -36519.776     -10511.766      1.701333       3885.8921    
      5000   313.73063     -36525.089      170.17189      1.701333       3885.8921    
Loop time of 218.089 on 16 procs for 5000 steps with 365 atoms

Performance: 0.990 ns/day, 24.232 hours/ns, 22.926 timesteps/s, 8.368 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 125.48     | 147.24     | 180.83     | 204.6 | 67.52
Bond    | 0.0012359  | 0.0015738  | 0.00194    |   0.6 |  0.00
Neigh   | 10.491     | 12.511     | 15.533     |  61.1 |  5.74
Comm    | 2.4381     | 36.017     | 57.796     | 413.7 | 16.51
Output  | 0.017463   | 0.019367   | 0.021607   |   1.1 |  0.01
Modify  | 19.161     | 22.196     | 24.235     |  46.0 | 10.18
Other   |            | 0.09963    |            |       |  0.05

Nlocal:         45.625 ave          48 max          42 min
Histogram: 1 0 0 1 0 0 4 0 1 1
Nghost:        3330.12 ave        3394 max        3265 min
Histogram: 1 0 2 0 0 2 0 2 0 1
Neighs:        29983.8 ave       31383 max       27676 min
Histogram: 1 0 0 1 0 0 3 1 1 1

Total # of neighbors = 239870
Ave neighs/atom = 657.17808
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
# Save the equilibrated structure
write_data ${structure}_eq.data
write_data 333U-50C-33-vasp_eq.data
System init for write_data ...
undump dump_eq
unfix myMSD

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.3172
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.8463
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 18.3222

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal -0.1382
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 0.2463
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -7.7318

# Write restart
write_restart equil.res
System init for write_restart ...

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 15.3172
variable dlen equal lx-${len0}
variable dlen equal lx-15.3172
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*15.3172
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 15.3172 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 15.3172 xy delta -7.7318 xz delta ${deltaxz} remap v units box flip no
fix deform_p all deform 100 x delta 0 15.3172 xy delta -7.7318 xz delta 0.2463 remap v units box flip no
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos1.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos1 all custom 100 dump/pos1_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos1 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.9 | 138.2 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   313.73063     -36525.089      170.07028      3885.8921      15.3172        13.8463        18.3222      
       100   271.31784     -36484.379     -7183.6839      3963.61        15.623544      13.8463        18.3222      
       200   435.77547     -36411.525      3328.3652      4041.3278      15.929888      13.8463        18.3222      
       300   471.0473      -36312.583     -10901.27       4119.0456      16.236232      13.8463        18.3222      
       400   433.62703     -36250.724     -11332.243      4196.7635      16.542576      13.8463        18.3222      
       500   421.6733      -36265.989     -10661.105      4274.4813      16.84892       13.8463        18.3222      
       600   442.87652     -36270.693     -13232.943      4352.1992      17.155264      13.8463        18.3222      
       700   455.74901     -36267.031     -31767.392      4429.917       17.461608      13.8463        18.3222      
       800   483.31742     -36329.04      -21746.467      4507.6349      17.767952      13.8463        18.3222      
       900   437.01816     -36385.635     -12313.241      4585.3527      18.074296      13.8463        18.3222      
      1000   495.27776     -36433.134     -14182.07       4663.0705      18.38064       13.8463        18.3222      
      1100   410.22115     -36349.921     -20949.701      4740.7884      18.686984      13.8463        18.3222      
      1200   427.88615     -36375.018     -24083.927      4818.5062      18.993328      13.8463        18.3222      
      1300   507.74717     -36481.8       -12007.208      4896.2241      19.299672      13.8463        18.3222      
      1400   409.93965     -36432.365     -14010.449      4973.9419      19.606016      13.8463        18.3222      
      1500   370.74877     -36403.142     -20669.345      5051.6598      19.91236       13.8463        18.3222      
      1600   394.3657      -36470.391     -20679.233      5129.3776      20.218704      13.8463        18.3222      
      1700   368.35769     -36458.23      -21420.408      5207.0954      20.525048      13.8463        18.3222      
      1800   417.5232      -36485.719     -16256.291      5284.8133      20.831392      13.8463        18.3222      
      1900   368.63895     -36426.879     -20870.302      5362.5311      21.137736      13.8463        18.3222      
      2000   341.8442      -36423.794     -30428.545      5440.249       21.44408       13.8463        18.3222      
      2100   409.58069     -36445.831     -17549.895      5517.9668      21.750424      13.8463        18.3222      
      2200   354.5679      -36421.881     -18031.423      5595.6847      22.056768      13.8463        18.3222      
      2300   400.8994      -36462.258     -13871.716      5673.4025      22.363112      13.8463        18.3222      
      2400   361.9332      -36415.493     -19594.743      5751.1203      22.669456      13.8463        18.3222      
      2500   417.67958     -36466.343     -6392.5179      5828.8382      22.9758        13.8463        18.3222      
      2600   400.20313     -36487.695     -15700.242      5906.556       23.282144      13.8463        18.3222      
      2700   336.86936     -36371.024     -19209.9        5984.2739      23.588488      13.8463        18.3222      
      2800   397.30147     -36358.572     -19733.409      6061.9917      23.894832      13.8463        18.3222      
      2900   379.73039     -36338.883     -24216.932      6139.7095      24.201176      13.8463        18.3222      
      3000   362.6578      -36274.8       -25979.397      6217.4274      24.50752       13.8463        18.3222      
      3100   336.16008     -36207.771     -18693.186      6295.1452      24.813864      13.8463        18.3222      
      3200   371.45447     -36169.599     -22415.258      6372.8631      25.120208      13.8463        18.3222      
      3300   388.47864     -36188.822     -22409.031      6450.5809      25.426552      13.8463        18.3222      
      3400   374.90971     -36180.842     -28753.049      6528.2988      25.732896      13.8463        18.3222      
      3500   390.01608     -36179.921     -23149.23       6606.0166      26.03924       13.8463        18.3222      
      3600   371.45961     -36123.578     -23459.925      6683.7344      26.345584      13.8463        18.3222      
      3700   395.18928     -36183.306     -24724.752      6761.4523      26.651928      13.8463        18.3222      
      3800   322.99138     -36061.995     -23723.553      6839.1701      26.958272      13.8463        18.3222      
      3900   400.12737     -36079.843     -31055.37       6916.888       27.264616      13.8463        18.3222      
      4000   368.65931     -36034.7       -28478.008      6994.6058      27.57096       13.8463        18.3222      
      4100   496.4051      -36174.146     -29494.526      7072.3237      27.877304      13.8463        18.3222      
      4200   413.44243     -36192.012     -29654.077      7150.0415      28.183648      13.8463        18.3222      
      4300   378.86763     -36191.589     -25639.468      7227.7593      28.489992      13.8463        18.3222      
      4400   402.37777     -36214.919     -22500.36       7305.4772      28.796336      13.8463        18.3222      
      4500   364.94359     -36136.428     -28768.686      7383.195       29.10268       13.8463        18.3222      
      4600   371.23364     -36175.34      -19649.413      7460.9129      29.409024      13.8463        18.3222      
      4700   334.89486     -36224.333     -20638.874      7538.6307      29.715368      13.8463        18.3222      
      4800   346.78524     -36264.978     -13638.234      7616.3486      30.021712      13.8463        18.3222      
      4900   399.67306     -36397.881     -10052.226      7694.0664      30.328056      13.8463        18.3222      
      5000   408.65437     -36501.049     -8600.7876      7771.7842      30.6344        13.8463        18.3222      
Loop time of 159.353 on 16 procs for 5000 steps with 365 atoms

Performance: 1.355 ns/day, 17.706 hours/ns, 31.377 timesteps/s, 11.453 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 88.828     | 110.43     | 130.47     | 173.0 | 69.30
Bond    | 0.0012729  | 0.0015454  | 0.001955   |   0.7 |  0.00
Neigh   | 6.3072     | 7.9633     | 9.6297     |  46.8 |  5.00
Comm    | 1.9198     | 21.95      | 43.533     | 387.8 | 13.77
Output  | 0.015152   | 0.017591   | 0.01886    |   0.9 |  0.01
Modify  | 17.208     | 18.892     | 20.576     |  30.7 | 11.86
Other   |            | 0.1011     |            |       |  0.06

Nlocal:         45.625 ave          62 max          14 min
Histogram: 1 0 0 0 1 1 1 1 1 2
Nghost:        2429.62 ave        2595 max        2208 min
Histogram: 1 1 0 2 0 0 0 0 1 3
Neighs:        14712.6 ave       20890 max        4689 min
Histogram: 1 0 0 1 1 0 2 1 0 2

Total # of neighbors = 117701
Ave neighs/atom = 322.46849
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.8463
variable dlen equal ly-${len0}
variable dlen equal ly-13.8463
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*13.8463
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 13.8463 yz delta ${deltayz} remap v units box flip no
fix deform_p all deform 100 y delta 0 13.8463 yz delta -0.1382 remap v units box flip no
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos2.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos2 all custom 100 dump/pos2_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos2 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.9 | 138.2 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   313.73063     -36525.089      170.07028      3885.8921      15.3172        13.8463        18.3222      
       100   270.726       -36483.679     -5720.7354      3963.61        15.3172        14.123226      18.3222      
       200   378.62509     -36445.92      -11283.567      4041.3278      15.3172        14.400152      18.3222      
       300   437.53766     -36411.802      9128.6537      4119.0456      15.3172        14.677078      18.3222      
       400   380.88951     -36403.864      18216.147      4196.7635      15.3172        14.954004      18.3222      
       500   348.61316     -36388.864     -8261.3959      4274.4813      15.3172        15.23093       18.3222      
       600   373.82757     -36381.819     -16951.739      4352.1992      15.3172        15.507856      18.3222      
       700   294.29625     -36291.789     -14645.332      4429.917       15.3172        15.784782      18.3222      
       800   355.13024     -36293.966     -13187.527      4507.6349      15.3172        16.061708      18.3222      
       900   348.1739      -36272.706     -19091.014      4585.3527      15.3172        16.338634      18.3222      
      1000   317.22866     -36242.853     -22580.387      4663.0705      15.3172        16.61556       18.3222      
      1100   314.16899     -36226.222     -20539.948      4740.7884      15.3172        16.892486      18.3222      
      1200   398.25894     -36293.087     -20540.084      4818.5062      15.3172        17.169412      18.3222      
      1300   385.11543     -36281.459     -16306.629      4896.2241      15.3172        17.446338      18.3222      
      1400   408.66538     -36368.972     -19148.251      4973.9419      15.3172        17.723264      18.3222      
      1500   388.24591     -36361.084     -17613.141      5051.6598      15.3172        18.00019       18.3222      
      1600   337.67556     -36300.596     -22373.091      5129.3776      15.3172        18.277116      18.3222      
      1700   385.86695     -36355.526     -7610.7061      5207.0954      15.3172        18.554042      18.3222      
      1800   367.62185     -36343.673     -21181.954      5284.8133      15.3172        18.830968      18.3222      
      1900   306.27822     -36275.603     -23761.397      5362.5311      15.3172        19.107894      18.3222      
      2000   388.93498     -36326.611     -16866.216      5440.249       15.3172        19.38482       18.3222      
      2100   335.95477     -36303.882     -24535.707      5517.9668      15.3172        19.661746      18.3222      
      2200   344.48826     -36279.221     -28162.932      5595.6847      15.3172        19.938672      18.3222      
      2300   348.78924     -36233.6       -27649.128      5673.4025      15.3172        20.215598      18.3222      
      2400   408.53469     -36264.677     -31216.786      5751.1203      15.3172        20.492524      18.3222      
      2500   417.87608     -36248.201     -27431.681      5828.8382      15.3172        20.76945       18.3222      
      2600   314.1251      -36111.59      -25854.104      5906.556       15.3172        21.046376      18.3222      
      2700   379.71175     -36136.688     -22553.473      5984.2739      15.3172        21.323302      18.3222      
      2800   378.25102     -36155.546     -24974.089      6061.9917      15.3172        21.600228      18.3222      
      2900   397.68804     -36188.198     -25889.014      6139.7095      15.3172        21.877154      18.3222      
      3000   326.84246     -36106.58      -28129.022      6217.4274      15.3172        22.15408       18.3222      
      3100   373.75295     -36100.138     -21028.596      6295.1452      15.3172        22.431006      18.3222      
      3200   325.364       -36039.712     -26911.221      6372.8631      15.3172        22.707932      18.3222      
      3300   321.41868     -35950.64      -29100.252      6450.5809      15.3172        22.984858      18.3222      
      3400   355.71104     -35968.31      -22256.107      6528.2988      15.3172        23.261784      18.3222      
      3500   396.01442     -35945.669     -24329.449      6606.0166      15.3172        23.53871       18.3222      
      3600   331.66883     -35841.932     -30639.983      6683.7344      15.3172        23.815636      18.3222      
      3700   383.40048     -35859.013     -28777.049      6761.4523      15.3172        24.092562      18.3222      
      3800   385.63949     -35910.738     -22015.819      6839.1701      15.3172        24.369488      18.3222      
      3900   371.82114     -35940.026     -23189.263      6916.888       15.3172        24.646414      18.3222      
      4000   349.85329     -35939.53      -23876.465      6994.6058      15.3172        24.92334       18.3222      
      4100   375.54368     -35922.463     -21097.633      7072.3237      15.3172        25.200266      18.3222      
      4200   351.68109     -35875.954     -26180.708      7150.0415      15.3172        25.477192      18.3222      
      4300   289.93609     -35781.276     -20399.944      7227.7593      15.3172        25.754118      18.3222      
      4400   397.7524      -35964.067     -22544.173      7305.4772      15.3172        26.031044      18.3222      
      4500   446.21654     -36114.28      -12159.876      7383.195       15.3172        26.30797       18.3222      
      4600   406.98448     -36213.838     -1877.3024      7460.9129      15.3172        26.584896      18.3222      
      4700   372.51316     -36302.166     -5118.9519      7538.6307      15.3172        26.861822      18.3222      
      4800   367.06995     -36384.691     -5391.3824      7616.3486      15.3172        27.138748      18.3222      
      4900   386.68158     -36472.058     -3596.978       7694.0664      15.3172        27.415674      18.3222      
      5000   328.53856     -36491.995     -5552.9856      7771.7842      15.3172        27.6926        18.3222      
Loop time of 151.662 on 16 procs for 5000 steps with 365 atoms

Performance: 1.424 ns/day, 16.851 hours/ns, 32.968 timesteps/s, 12.033 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 77.979     | 107.18     | 119.12     | 150.0 | 70.67
Bond    | 0.0012865  | 0.0015768  | 0.0020452  |   0.7 |  0.00
Neigh   | 6.0185     | 8.2812     | 9.6425     |  42.7 |  5.46
Comm    | 5.2392     | 17.195     | 46.405     | 374.5 | 11.34
Output  | 0.016012   | 0.018484   | 0.019748   |   0.9 |  0.01
Modify  | 17.53      | 18.883     | 21.156     |  28.4 | 12.45
Other   |            | 0.09967    |            |       |  0.07

Nlocal:         45.625 ave          76 max          17 min
Histogram: 3 0 0 1 0 0 1 0 1 2
Nghost:           1893 ave        2241 max        1575 min
Histogram: 4 0 0 0 0 0 0 0 1 3
Neighs:          15803 ave       28292 max        4396 min
Histogram: 3 1 0 0 0 0 0 1 1 2

Total # of neighbors = 126424
Ave neighs/atom = 346.36712
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 18.3222
variable dlen equal lz-${len0}
variable dlen equal lz-18.3222
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*18.3222
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 18.3222 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos3.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos3 all custom 100 dump/pos3_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos3 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.9 | 138.2 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   313.73063     -36525.089      170.07028      3885.8921      15.3172        13.8463        18.3222      
       100   272.23894     -36485.968     -4622.7283      3963.61        15.3172        13.8463        18.688644    
       200   422.25173     -36394.434     -9552.0913      4041.3278      15.3172        13.8463        19.055088    
       300   471.42394     -36345.863     -1753.2441      4119.0456      15.3172        13.8463        19.421532    
       400   452.6843      -36282.989      6485.2177      4196.7635      15.3172        13.8463        19.787976    
       500   450.46298     -36274.872      2132.499       4274.4813      15.3172        13.8463        20.15442     
       600   443.64978     -36295.734     -14845.315      4352.1992      15.3172        13.8463        20.520864    
       700   433.05645     -36320.415     -13227.366      4429.917       15.3172        13.8463        20.887308    
       800   379.06757     -36250.528     -12681.532      4507.6349      15.3172        13.8463        21.253752    
       900   349.14097     -36262.396     -29858.465      4585.3527      15.3172        13.8463        21.620196    
      1000   480.80409     -36410.906     -16737.785      4663.0705      15.3172        13.8463        21.98664     
      1100   379.46021     -36311.559     -25791.62       4740.7884      15.3172        13.8463        22.353084    
      1200   395.22838     -36272.686     -38121.329      4818.5062      15.3172        13.8463        22.719528    
      1300   411.94303     -36292.981     -17486.323      4896.2241      15.3172        13.8463        23.085972    
      1400   353.73645     -36334.651     -26012.319      4973.9419      15.3172        13.8463        23.452416    
      1500   402.02269     -36465.301     -12482.63       5051.6598      15.3172        13.8463        23.81886     
      1600   387.32233     -36464.947     -21274.376      5129.3776      15.3172        13.8463        24.185304    
      1700   352.95374     -36347.19      -29357.877      5207.0954      15.3172        13.8463        24.551748    
      1800   396.86191     -36480.52      -21654.377      5284.8133      15.3172        13.8463        24.918192    
      1900   346.65355     -36460.943     -19264.509      5362.5311      15.3172        13.8463        25.284636    
      2000   404.60109     -36480.674     -20110.414      5440.249       15.3172        13.8463        25.65108     
      2100   347.74386     -36480.343     -20119.486      5517.9668      15.3172        13.8463        26.017524    
      2200   300.91719     -36450.067     -22017.358      5595.6847      15.3172        13.8463        26.383968    
      2300   304.16612     -36445.203     -21870.078      5673.4025      15.3172        13.8463        26.750412    
      2400   313.46455     -36390.4       -22273.689      5751.1203      15.3172        13.8463        27.116856    
      2500   381.63956     -36478.715     -28135.935      5828.8382      15.3172        13.8463        27.4833      
      2600   353.7583      -36335.132     -22570.555      5906.556       15.3172        13.8463        27.849744    
      2700   404.84447     -36441.574     -26785.828      5984.2739      15.3172        13.8463        28.216188    
      2800   460.294       -36520.84      -24706.755      6061.9917      15.3172        13.8463        28.582632    
      2900   401.91601     -36503.563     -11151.34       6139.7095      15.3172        13.8463        28.949076    
      3000   366.19396     -36546.426     -6711.9799      6217.4274      15.3172        13.8463        29.31552     
      3100   314.43174     -36582.685      2744.3854      6295.1452      15.3172        13.8463        29.681964    
      3200   318.98233     -36651.875      8696.4292      6372.8631      15.3172        13.8463        30.048408    
      3300   264.14369     -36657.068     -5369.2683      6450.5809      15.3172        13.8463        30.414852    
      3400   299.55183     -36701.906      3700.1195      6528.2988      15.3172        13.8463        30.781296    
      3500   336.89076     -36721.97       6894.6601      6606.0166      15.3172        13.8463        31.14774     
      3600   312.15376     -36726.362      3843.3832      6683.7344      15.3172        13.8463        31.514184    
      3700   277.99808     -36742.205      5180.5175      6761.4523      15.3172        13.8463        31.880628    
      3800   278.54841     -36751.618      202.083        6839.1701      15.3172        13.8463        32.247072    
      3900   246.51515     -36709.364     -4944.58        6916.888       15.3172        13.8463        32.613516    
      4000   306.26302     -36763.048      1764.8272      6994.6058      15.3172        13.8463        32.97996     
      4100   243.46931     -36733.553      175.50866      7072.3237      15.3172        13.8463        33.346404    
      4200   335.57242     -36834.8       -1318.5828      7150.0415      15.3172        13.8463        33.712848    
      4300   289.57697     -36774.847     -4189.5133      7227.7593      15.3172        13.8463        34.079292    
      4400   270.42883     -36771.397     -1035.0045      7305.4772      15.3172        13.8463        34.445736    
      4500   306.50038     -36732.668      352.98315      7383.195       15.3172        13.8463        34.81218     
      4600   325.4227      -36770.154     -813.85691      7460.9129      15.3172        13.8463        35.178624    
      4700   284.48657     -36762.387     -1819.7924      7538.6307      15.3172        13.8463        35.545068    
      4800   288.57471     -36762.99       539.55338      7616.3486      15.3172        13.8463        35.911512    
      4900   288.6342      -36747.545     -1100.4759      7694.0664      15.3172        13.8463        36.277956    
      5000   305.7154      -36736.052      6147.3525      7771.7842      15.3172        13.8463        36.6444      
Loop time of 164.022 on 16 procs for 5000 steps with 365 atoms

Performance: 1.317 ns/day, 18.225 hours/ns, 30.484 timesteps/s, 11.127 katom-step/s
99.4% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 82.376     | 119.05     | 132.81     | 147.9 | 72.58
Bond    | 0.0012706  | 0.0016096  | 0.0020805  |   0.7 |  0.00
Neigh   | 6.4704     | 9.1978     | 10.113     |  40.1 |  5.61
Comm    | 2.1611     | 15.961     | 52.676     | 404.6 |  9.73
Output  | 0.015878   | 0.018277   | 0.019615   |   0.9 |  0.01
Modify  | 18.821     | 19.698     | 22.396     |  26.9 | 12.01
Other   |            | 0.09703    |            |       |  0.06

Nlocal:         45.625 ave          75 max          14 min
Histogram: 2 2 0 0 0 0 0 0 1 3
Nghost:           2101 ave        2422 max        1776 min
Histogram: 2 2 0 0 0 0 0 0 2 2
Neighs:        18240.6 ave       32694 max        3534 min
Histogram: 4 0 0 0 0 0 0 0 0 4

Total # of neighbors = 145925
Ave neighs/atom = 399.79452
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 15.3172
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz--0.1382)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*15.3172
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_p all deform 100 yz delta ${delta} remap v units box flip no
fix deform_p all deform 100 yz delta 15.3172 remap v units box flip no
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos4.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos4 all custom 100 dump/pos4_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos4 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.9 | 138.2 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   313.73063     -36525.089      170.07028      3885.8921      15.3172        13.8463        18.3222      
       100   272.19891     -36483.73      -3502.3138      3885.8921      15.3172        13.8463        18.3222      
       200   372.6161      -36458.49      -7271.2445      3885.8921      15.3172        13.8463        18.3222      
       300   410.72427     -36472.44       21413.847      3885.8921      15.3172        13.8463        18.3222      
       400   438.86584     -36478.985      22147.779      3885.8921      15.3172        13.8463        18.3222      
       500   401.55095     -36438.042      2922.6454      3885.8921      15.3172        13.8463        18.3222      
       600   379.90018     -36487.269     -3426.6215      3885.8921      15.3172        13.8463        18.3222      
       700   416.97806     -36583.877      5762.3972      3885.8921      15.3172        13.8463        18.3222      
       800   340.21578     -36570.015      8986.9787      3885.8921      15.3172        13.8463        18.3222      
       900   330.73603     -36612.92       13513.365      3885.8921      15.3172        13.8463        18.3222      
      1000   297.09847     -36556.429     -2141.8727      3885.8921      15.3172        13.8463        18.3222      
      1100   328.96367     -36590.851      5126.2544      3885.8921      15.3172        13.8463        18.3222      
      1200   379.36407     -36605.771      15807.513      3885.8921      15.3172        13.8463        18.3222      
      1300   385.15458     -36660.186      4348.7525      3885.8921      15.3172        13.8463        18.3222      
      1400   386.30704     -36756.101      7694.7698      3885.8921      15.3172        13.8463        18.3222      
      1500   326.84749     -36778.551     -1609.7507      3885.8921      15.3172        13.8463        18.3222      
      1600   335.98723     -36815.108      9114.1949      3885.8921      15.3172        13.8463        18.3222      
      1700   310.74928     -36853.525      13550.746      3885.8921      15.3172        13.8463        18.3222      
      1800   349.11884     -36886.82       3836.9686      3885.8921      15.3172        13.8463        18.3222      
      1900   336.79809     -36883.353      4899.984       3885.8921      15.3172        13.8463        18.3222      
      2000   259.44986     -36809.804     -12660.33       3885.8921      15.3172        13.8463        18.3222      
      2100   319.82408     -36872.281     -5615.4307      3885.8921      15.3172        13.8463        18.3222      
      2200   336.57209     -36783.777     -3302.7155      3885.8921      15.3172        13.8463        18.3222      
      2300   331.05058     -36766.159     -10294.585      3885.8921      15.3172        13.8463        18.3222      
      2400   304.21112     -36774.169     -7005.3516      3885.8921      15.3172        13.8463        18.3222      
      2500   367.49269     -36720.022     -3281.5386      3885.8921      15.3172        13.8463        18.3222      
      2600   341.62096     -36732.701      5407.4462      3885.8921      15.3172        13.8463        18.3222      
      2700   308.76301     -36714.993     -4990.7068      3885.8921      15.3172        13.8463        18.3222      
      2800   419.05913     -36892.778     -8094.4397      3885.8921      15.3172        13.8463        18.3222      
      2900   371.02107     -36870.292     -15660.545      3885.8921      15.3172        13.8463        18.3222      
      3000   322.41469     -36836.628     -16046.375      3885.8921      15.3172        13.8463        18.3222      
      3100   308.48903     -36850.868      2334.1859      3885.8921      15.3172        13.8463        18.3222      
      3200   276.38448     -36884.26      -2139.7689      3885.8921      15.3172        13.8463        18.3222      
      3300   350.0632      -36967.215      6527.1545      3885.8921      15.3172        13.8463        18.3222      
      3400   302.34573     -36901.275      11380.261      3885.8921      15.3172        13.8463        18.3222      
      3500   326.25366     -36962.598      2124.799       3885.8921      15.3172        13.8463        18.3222      
      3600   326.09101     -36918.954      1423.235       3885.8921      15.3172        13.8463        18.3222      
      3700   357.10709     -36922.96      -3015.8529      3885.8921      15.3172        13.8463        18.3222      
      3800   289.6975      -36884.149     -6513.836       3885.8921      15.3172        13.8463        18.3222      
      3900   308.47944     -36911.91      -11851.228      3885.8921      15.3172        13.8463        18.3222      
      4000   353.52699     -36970.108      8894.7932      3885.8921      15.3172        13.8463        18.3222      
      4100   381.92281     -36955.38       231.32247      3885.8921      15.3172        13.8463        18.3222      
      4200   321.57177     -36905.822     -3265.2775      3885.8921      15.3172        13.8463        18.3222      
      4300   324.86966     -36895.41      -9711.7491      3885.8921      15.3172        13.8463        18.3222      
      4400   337.19373     -36916.777     -5651.8292      3885.8921      15.3172        13.8463        18.3222      
      4500   309.33484     -36832.61       4313.2299      3885.8921      15.3172        13.8463        18.3222      
      4600   313.33109     -36852.087     -13343.401      3885.8921      15.3172        13.8463        18.3222      
      4700   302.63819     -36848.025     -4392.4876      3885.8921      15.3172        13.8463        18.3222      
      4800   279.17904     -36811.413     -7113.4798      3885.8921      15.3172        13.8463        18.3222      
      4900   290.23972     -36802.499      8299.7901      3885.8921      15.3172        13.8463        18.3222      
      5000   348.15906     -36750.205      571.53546      3885.8921      15.3172        13.8463        18.3222      
Loop time of 252.639 on 16 procs for 5000 steps with 365 atoms

Performance: 0.855 ns/day, 28.071 hours/ns, 19.791 timesteps/s, 7.224 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 141.33     | 192.12     | 210.02     | 170.5 | 76.04
Bond    | 0.0014348  | 0.0017075  | 0.0021477  |   0.6 |  0.00
Neigh   | 12.457     | 16.867     | 18.663     |  49.6 |  6.68
Comm    | 2.6687     | 20.571     | 71.309     | 520.5 |  8.14
Output  | 0.015934   | 0.018123   | 0.019602   |   0.9 |  0.01
Modify  | 21.14      | 22.941     | 27.399     |  43.1 |  9.08
Other   |            | 0.1223     |            |       |  0.05

Nlocal:         45.625 ave          53 max          38 min
Histogram: 1 0 1 1 1 0 2 0 1 1
Nghost:        4320.62 ave        4457 max        4205 min
Histogram: 2 1 1 0 0 1 1 0 1 1
Neighs:        29934.1 ave       34315 max       25401 min
Histogram: 1 0 1 1 1 1 1 0 1 1

Total # of neighbors = 239473
Ave neighs/atom = 656.09041
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.8463
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-0.2463)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*13.8463
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_p all deform 100 xz delta ${delta} remap v units box flip no
fix deform_p all deform 100 xz delta 13.8463 remap v units box flip no
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos5.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos5 all custom 100 dump/pos5_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos5 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.9 | 138.2 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   313.73063     -36525.089      170.07028      3885.8921      15.3172        13.8463        18.3222      
       100   271.61054     -36483.186     -4522.0893      3885.8921      15.3172        13.8463        18.3222      
       200   374.0559      -36401.077      12953.535      3885.8921      15.3172        13.8463        18.3222      
       300   499.3466      -36461.796      23995.769      3885.8921      15.3172        13.8463        18.3222      
       400   400.31178     -36413.673     -7669.5014      3885.8921      15.3172        13.8463        18.3222      
       500   387.09499     -36449.41       683.77034      3885.8921      15.3172        13.8463        18.3222      
       600   419.10429     -36490.89      -15408.899      3885.8921      15.3172        13.8463        18.3222      
       700   392.08413     -36554.766     -17517.202      3885.8921      15.3172        13.8463        18.3222      
       800   408.87269     -36530.801      451.11943      3885.8921      15.3172        13.8463        18.3222      
       900   390.10584     -36531.362     -2741.2082      3885.8921      15.3172        13.8463        18.3222      
      1000   353.77888     -36507.094      7969.4947      3885.8921      15.3172        13.8463        18.3222      
      1100   400.31347     -36515.819      23448.193      3885.8921      15.3172        13.8463        18.3222      
      1200   368.91362     -36523.481     -5612.7963      3885.8921      15.3172        13.8463        18.3222      
      1300   359.11513     -36537.712     -11231.156      3885.8921      15.3172        13.8463        18.3222      
      1400   377.10999     -36605.145     -20495.024      3885.8921      15.3172        13.8463        18.3222      
      1500   386.1231      -36650.316     -6704.9469      3885.8921      15.3172        13.8463        18.3222      
      1600   317.3656      -36642.175      7123.6767      3885.8921      15.3172        13.8463        18.3222      
      1700   341.51353     -36705.739      2760.4081      3885.8921      15.3172        13.8463        18.3222      
      1800   356.54305     -36820.022      10839.267      3885.8921      15.3172        13.8463        18.3222      
      1900   327.16651     -36823.458      6565.822       3885.8921      15.3172        13.8463        18.3222      
      2000   342.22599     -36864.66       2380.2669      3885.8921      15.3172        13.8463        18.3222      
      2100   297.60901     -36888.069     -6692.5611      3885.8921      15.3172        13.8463        18.3222      
      2200   330.04625     -36906.403      11884.142      3885.8921      15.3172        13.8463        18.3222      
      2300   322.70361     -36885.567      8773.105       3885.8921      15.3172        13.8463        18.3222      
      2400   325.64648     -36909.281     -2708.8505      3885.8921      15.3172        13.8463        18.3222      
      2500   304.26394     -36896.214     -14213.9        3885.8921      15.3172        13.8463        18.3222      
      2600   312.45586     -36910.808     -8401.7681      3885.8921      15.3172        13.8463        18.3222      
      2700   332.74121     -36917.026      3658.2415      3885.8921      15.3172        13.8463        18.3222      
      2800   351.01833     -36974.248     -7214.4698      3885.8921      15.3172        13.8463        18.3222      
      2900   304.89565     -36953.806     -8516.3804      3885.8921      15.3172        13.8463        18.3222      
      3000   290.8528      -36944.896     -4097.1661      3885.8921      15.3172        13.8463        18.3222      
      3100   302.56373     -37021.77      -5023.3709      3885.8921      15.3172        13.8463        18.3222      
      3200   324.39248     -37068.874      2035.1281      3885.8921      15.3172        13.8463        18.3222      
      3300   294.91045     -37055.219     -4999.8077      3885.8921      15.3172        13.8463        18.3222      
      3400   331.11748     -37100.672      2044.4617      3885.8921      15.3172        13.8463        18.3222      
      3500   272.12535     -37085.633      4802.836       3885.8921      15.3172        13.8463        18.3222      
      3600   294.5131      -37109.117     -423.508        3885.8921      15.3172        13.8463        18.3222      
      3700   292.06321     -37078.362      3854.049       3885.8921      15.3172        13.8463        18.3222      
      3800   278.64027     -37051.843      8400.5985      3885.8921      15.3172        13.8463        18.3222      
      3900   346.72375     -37136.256      2151.6372      3885.8921      15.3172        13.8463        18.3222      
      4000   352.97062     -37092.562      9544.7828      3885.8921      15.3172        13.8463        18.3222      
      4100   362.85819     -37089.081     -8604.4747      3885.8921      15.3172        13.8463        18.3222      
      4200   333.01202     -37051.139      755.31391      3885.8921      15.3172        13.8463        18.3222      
      4300   312.09105     -37083.282      5369.9482      3885.8921      15.3172        13.8463        18.3222      
      4400   331.21571     -37070.483      2115.3356      3885.8921      15.3172        13.8463        18.3222      
      4500   323.86544     -37051.975      7476.7358      3885.8921      15.3172        13.8463        18.3222      
      4600   304.92613     -37056.028     -6157.0257      3885.8921      15.3172        13.8463        18.3222      
      4700   302.9993      -37028.258      9046.7728      3885.8921      15.3172        13.8463        18.3222      
      4800   281.19542     -36953.794     -94.677397      3885.8921      15.3172        13.8463        18.3222      
      4900   363.53904     -37074.815     -1780.2529      3885.8921      15.3172        13.8463        18.3222      
      5000   355.44661     -37087.575      5971.4781      3885.8921      15.3172        13.8463        18.3222      
Loop time of 236.118 on 16 procs for 5000 steps with 365 atoms

Performance: 0.915 ns/day, 26.235 hours/ns, 21.176 timesteps/s, 7.729 katom-step/s
99.3% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 134.58     | 175.55     | 196.17     | 177.5 | 74.35
Bond    | 0.0013139  | 0.0016255  | 0.0019849  |   0.7 |  0.00
Neigh   | 10.634     | 13.816     | 15.658     |  50.2 |  5.85
Comm    | 3.2422     | 23.861     | 64.794     | 481.2 | 10.11
Output  | 0.01484    | 0.016973   | 0.018299   |   0.9 |  0.01
Modify  | 20.906     | 22.752     | 25.968     |  39.5 |  9.64
Other   |            | 0.1163     |            |       |  0.05

Nlocal:         45.625 ave          55 max          37 min
Histogram: 1 0 0 2 1 2 0 1 0 1
Nghost:        3824.62 ave        3867 max        3783 min
Histogram: 2 1 0 1 0 0 1 1 0 2
Neighs:          29956 ave       35727 max       24622 min
Histogram: 1 0 0 2 3 0 0 1 0 1

Total # of neighbors = 239648
Ave neighs/atom = 656.56986
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 18.3222
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--7.7318)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.3172 13.8463 18.3222) with tilt (-7.7318 0.2463 -0.1382)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 1*${len0}
variable delta equal 1*18.3222
variable deltaxy equal ${up}*xy
variable deltaxy equal 1*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 1*xz
variable deltayz equal ${up}*yz
variable deltayz equal 1*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_p all deform 100 xy delta ${delta} remap v units box flip no
fix deform_p all deform 100 xy delta 18.3222 remap v units box flip no

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
# Save bond information
fix bondinfo all reaxff/bonds ${nthermo} bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos${dir}.reaxff
fix bondinfo all reaxff/bonds 100 bonds/bonds.pos6.reaxff
# Reset neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)

# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check no

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol lx ly lz
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50
Resetting global fix info from restart file:
  fix style: nvt, fix ID: fnvt


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom ${nthermo} dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom 100 dump/pos${dir}_deform.lammpstrj id type q x y z element
dump dump_pos6 all custom 100 dump/pos6_deform.lammpstrj id type q x y z element
dump_modify dump_pos${dir} element C H O Si
dump_modify dump_pos6 element C H O Si
run ${nrun}
run 5000
All restart file global fix info was re-assigned
Unused restart file peratom fix info:
  fix style: STORE/ATOM, fix ID: msd1_COMPUTE_STORE
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = no
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 4
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 133.7 | 135.9 | 138.2 Mbytes
   Step          Temp          PotEng         Press          Volume           Lx             Ly             Lz      
         0   313.73063     -36525.089      170.07028      3885.8921      15.3172        13.8463        18.3222      
       100   273.60312     -36484.093     -1859.1613      3885.8921      15.3172        13.8463        18.3222      
       200   387.96351     -36418.471      4319.5434      3885.8921      15.3172        13.8463        18.3222      
       300   391.8278      -36414.404      19089.731      3885.8921      15.3172        13.8463        18.3222      
       400   380.79441     -36448.471      3199.2407      3885.8921      15.3172        13.8463        18.3222      
       500   398.91575     -36395.174     -7254.8411      3885.8921      15.3172        13.8463        18.3222      
       600   448.22546     -36416.368     -8128.6157      3885.8921      15.3172        13.8463        18.3222      
       700   362.22602     -36242.799     -7798.5679      3885.8921      15.3172        13.8463        18.3222      
       800   414.18431     -36463.09      -11026.231      3885.8921      15.3172        13.8463        18.3222      
       900   365.33316     -36420.414     -5365.035       3885.8921      15.3172        13.8463        18.3222      
      1000   338.4058      -36360.183      7442.0596      3885.8921      15.3172        13.8463        18.3222      
      1100   333.75359     -36396.868      11144.413      3885.8921      15.3172        13.8463        18.3222      
      1200   320.24636     -36378.151     -16646.38       3885.8921      15.3172        13.8463        18.3222      
      1300   320.3419      -36463.933     -10895.141      3885.8921      15.3172        13.8463        18.3222      
      1400   346.04655     -36452.794      1727.5569      3885.8921      15.3172        13.8463        18.3222      
      1500   357.62388     -36480.585      2170.5051      3885.8921      15.3172        13.8463        18.3222      
      1600   318.86636     -36381.673      3739.8748      3885.8921      15.3172        13.8463        18.3222      
      1700   331.99457     -36396.93      -9401.5565      3885.8921      15.3172        13.8463        18.3222      
      1800   295.79075     -36378.879     -313.85384      3885.8921      15.3172        13.8463        18.3222      
      1900   369.58349     -36498.813      1420.3775      3885.8921      15.3172        13.8463        18.3222      
      2000   369.26616     -36550.256     -5094.1729      3885.8921      15.3172        13.8463        18.3222      
      2100   371.53332     -36607.708      11479.601      3885.8921      15.3172        13.8463        18.3222      
      2200   369.20143     -36647.711     -7758.1815      3885.8921      15.3172        13.8463        18.3222      
      2300   358.31961     -36665.911     -3568.8241      3885.8921      15.3172        13.8463        18.3222      
      2400   305.76178     -36619.655      4630.7079      3885.8921      15.3172        13.8463        18.3222      
      2500   333.62179     -36649.391      93.945545      3885.8921      15.3172        13.8463        18.3222      
      2600   349.44454     -36669.434     -17431.613      3885.8921      15.3172        13.8463        18.3222      
      2700   335.88259     -36636.333     -11056.319      3885.8921      15.3172        13.8463        18.3222      
      2800   433.42535     -36718.764     -12635.721      3885.8921      15.3172        13.8463        18.3222      
      2900   519.548       -36857.412      4164.1969      3885.8921      15.3172        13.8463        18.3222      
      3000   466.8707      -36937.823      539.91318      3885.8921      15.3172        13.8463        18.3222      
      3100   431.08148     -36970.88      -15703.942      3885.8921      15.3172        13.8463        18.3222      
      3200   397.78476     -36970.201      3173.384       3885.8921      15.3172        13.8463        18.3222      
      3300   420.35375     -36940.467      2644.5864      3885.8921      15.3172        13.8463        18.3222      
      3400   344.28846     -36809.731     -17670.159      3885.8921      15.3172        13.8463        18.3222      
      3500   332.60935     -36868.884     -2161.9721      3885.8921      15.3172        13.8463        18.3222      
      3600   358.33894     -36935.361      11533          3885.8921      15.3172        13.8463        18.3222      
      3700   307.39934     -36880.753      5160.5962      3885.8921      15.3172        13.8463        18.3222      
      3800   345.6329      -36907.751     -9609.0342      3885.8921      15.3172        13.8463        18.3222      
      3900   338.451       -36907.41       647.59023      3885.8921      15.3172        13.8463        18.3222      
      4000   382.78367     -36917.507     -13546.368      3885.8921      15.3172        13.8463        18.3222      
      4100   345.49998     -36849.281      654.693        3885.8921      15.3172        13.8463        18.3222      
      4200   325.4963      -36832.99      -318.91916      3885.8921      15.3172        13.8463        18.3222      
      4300   389.0279      -36917.619      6109.3835      3885.8921      15.3172        13.8463        18.3222      
      4400   362.21991     -36920.749     -9366.6256      3885.8921      15.3172        13.8463        18.3222      
      4500   358.26417     -36937.435      6126.2103      3885.8921      15.3172        13.8463        18.3222      
      4600   288.81381     -36864.166      13737.944      3885.8921      15.3172        13.8463        18.3222      
      4700   346.01464     -36956.329      11368.514      3885.8921      15.3172        13.8463        18.3222      
      4800   342.55555     -36898.785      6722.7853      3885.8921      15.3172        13.8463        18.3222      
      4900   293.8728      -36792.996      6894.7424      3885.8921      15.3172        13.8463        18.3222      
      5000   331.42634     -36826.529      2952.7734      3885.8921      15.3172        13.8463        18.3222      
Loop time of 171.93 on 16 procs for 5000 steps with 365 atoms

Performance: 1.256 ns/day, 19.103 hours/ns, 29.082 timesteps/s, 10.615 katom-step/s
99.5% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 114.5      | 125.09     | 140.65     |  93.6 | 72.76
Bond    | 0.0010041  | 0.001357   | 0.0017341  |   0.7 |  0.00
Neigh   | 9.5769     | 10.473     | 11.804     |  29.0 |  6.09
Comm    | 1.9964     | 17.568     | 28.157     | 249.6 | 10.22
Output  | 0.012552   | 0.014092   | 0.015218   |   0.7 |  0.01
Modify  | 17.356     | 18.681     | 19.584     |  21.9 | 10.87
Other   |            | 0.1006     |            |       |  0.06

Nlocal:         45.625 ave          52 max          37 min
Histogram: 1 0 1 1 0 0 1 2 0 2
Nghost:         3534.5 ave        3588 max        3460 min
Histogram: 1 0 1 1 0 0 1 1 2 1
Neighs:        29930.5 ave       34343 max       24634 min
Histogram: 1 1 0 1 0 1 2 0 0 2

Total # of neighbors = 239444
Ave neighs/atom = 656.01096
Ave special neighs/atom = 0
Neighbor list builds = 500
Dangerous builds not checked
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:22:45
