# Initialization
units           real
dimension       3
boundary        p p s
atom_style      full
timestep        0.5   # fs

variable       T equal 300.0   # temperature
variable       Tl equal 300.0   # temperature
variable       Th equal 400.0   # temperature
variable       Td equal 50.0  # damping time
variable       P equal 1.0  # pressure
variable       nthermo equal 10 # steps for thermo output
variable       nequil equal 100*${nthermo}  #  equilibration steps
variable       nrun equal 30*${nthermo}  #  equilibration steps
variable       seed string 12345  # random seed


# Read the initial sctructure
box tilt large
variable structure string 333SiO2-1-UFF-c
read_data       ${structure}.data

# Assign the force field 
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
# pair_coeff * * SiOCHN_2018.ff C H O Si
# pair_coeff * * PDMSDecomp.ff Si O
# pair_coeff * * CHONSi.ff C H O Si
pair_coeff * * CHOFe.ff O Si

fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix myask2 all acks2/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# fix bondinfo all reaxff/bonds ${nthermo} bonds.reaxff

neighbor        2 bin
neigh_modify    every 10 delay 0 check no 

# Print system info
thermo          ${nthermo}
thermo_style    custom step temp 

# equilibration at T
print "*****Equilibration starts.*****"
velocity        all create ${T} ${seed}
# fix             equil1 all npt temp ${T} ${T} ${Td} tri ${P} ${P} ${Td}
fix             equil1 all nvt temp ${T} ${T} ${Td}
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
run             ${nequil} 
unfix             equil1
reset_timestep 0

fix             run1 all nvt temp ${Tl} ${Th} ${Td}
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
run             ${nrun} start 0 stop 900
run             ${nrun} start 0 stop 900
