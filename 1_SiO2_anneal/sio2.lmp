# Initialization
units           real
dimension       3
boundary        p p p
atom_style      full
timestep        0.5   # fs
neighbor        2 bin
neigh_modify    every 10 delay 0 check no 

# Read the initial sctructure
read_data       m-c-nb.data

# Assign the force field 
pair_style reaxff NULL safezone 3.0 mincap 150
# pair_coeff * * CHONSSi.ff O Si
# pair_coeff * * CHOSiNa.ff O Si
pair_coeff * * SiOCHN_2018.ff O Si
# pair_coeff * * PDMSDecomp.ff Si O
# pair_coeff * * CHOFe.ff O Si

fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400

# Print system info
thermo          100
thermo_style    custom step temp press density pe etotal
# Save trajectory
#dump dump1 all custom 500 dump_opt.lammpstrj id type x y z q
dump dump1 all custom 200 dump_all.lammpstrj id type x y z q

# Energy minimization
print "*****Minimization starts.*****"
velocity        all create 300.0 12345 dist gaussian
minimize 1.0e-6 1.0e-6 100 1000
min_style cg
# Save the optimized structure
write_data sio2_opt.data
# Save trajectory
# dump dump_equil all custom 500 dump_equil.lammpstrj id type x y z q

# equilibration at 300K
print "*****Equilibration starts.*****"
fix             equil1 all nvt temp 300.0 300.0 50.0
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
run             5000   
# Save trajectory
# dump dump2 all custom 500 dump_heat.lammpstrj id type x y z q

# Heat to 600K 
print "*****Heat starts.*****"
unfix           equil1
fix             heat1 all npt temp 300.0 600.0 100.0 iso 1.0 1.0 100.0
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
run             3000
# Save trajectory
# dump dump3 all custom 500 dump_cool.lammpstrj id type x y z q

# cool down to 300K 
print "*****Cool starts.*****"
unfix           heat1
fix             cool1 all npt temp 600.0 300.0 100.0 iso 1.0 1.0 100.0
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
run             3000

# equilibration at 300K
print "*****Equilibration starts.*****"
velocity        all create 300.0 12345
unfix             cool1
fix             equil2 all nvt temp 300.0 300.0 50.0
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
run             5000  

print "*****Done.*****"


