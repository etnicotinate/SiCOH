LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
# boundary        s s s
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 0.1
variable FF string "SiOCHN_2018.ff C H O Si"          # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff C H O Si
# pair_coeff * * CHOSiNa.ff C H O Si
# pair_coeff * * SiOCHN_2018.ff C H O Si
# pair_coeff * * PDMSDecomp.ff C H O Si
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-9_eq

read_data       ${structure}.data
read_data       333U-50C-9_eq.data
Reading data file ...
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  386 atoms
  reading velocities ...
  386 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.011 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400

# # Energy minimization
# print "*****Minimization starts.*****"
# minimize 1.0e-6 1.0e-6 100 1000
# min_style cg
# # Save the optimized structure
# write_data ${structure}_opt.data
# velocity        all create ${temp} ${seed} dist gaussian

# # Equilibration
# include ff.mod.lmp
# if "$(is_defined(fix,avgp))" then "unfix avgp"
# if "$(is_defined(fix,avgl))" then "unfix avgl"
# thermo_style custom step temp pe press density vol
# run ${nequil}
# # Save the equilibrated structure
# write_data ${structure}_eq.data

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.6078
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.4502
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.3502

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.0034
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal -1.0717
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -9.4505

# Write restart
write_restart equil.res
System init for write_restart ...
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 16.6078
variable dlen equal lx-${len0}
variable dlen equal lx-16.6078
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.6078
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.094505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.010717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -3.4e-05
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.166078 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.166078 xy delta 0.094505 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.166078 xy delta 0.094505 xz delta 0.010717 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz 100 dump/neg_deform1.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144 | 146.1 | 148.3 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   299.62481     -39709.007      23288.44       3875.657     
       100   305.81312     -39717.586      18432.547      3874.8819    
       200   275.62551     -39701.233      6857.9399      3874.1067    
       300   281.06192     -39721.56       4351.2555      3873.3316    
       400   284.04447     -39707.289      8341.2722      3872.5565    
       500   299.47395     -39691.31       16702.013      3871.7813    
       600   325.90801     -39715.819      21751.232      3871.0062    
       700   282.59716     -39686.26       11003.954      3870.2311    
       800   281.25858     -39703.685      2834.1116      3869.4559    
       900   285.9517      -39702.093     -946.95923      3868.6808    
      1000   307.57924     -39689.781     -328.20627      3867.9057    
      1100   301.99075     -39659.112      12490.163      3867.1305    
      1200   315.01437     -39694.13       13155.724      3866.3554    
      1300   318.96925     -39725.161      7353.5138      3865.5803    
      1400   294.23848     -39710.922      16109.737      3864.8052    
      1500   281.40982     -39695.481      6356.6505      3864.03      
      1600   289.48057     -39682.953      15452.414      3863.2549    
      1700   318.85561     -39685.782     -7507.0926      3862.4798    
      1800   310.40801     -39684.954     -818.57324      3861.7046    
      1900   306.47189     -39709.263      5930.8612      3860.9295    
      2000   310.09235     -39721.416      11334.095      3860.1544    
      2100   299.06526     -39709.338      17537.967      3859.3792    
      2200   281.71353     -39695.3        7052.2828      3858.6041    
      2300   312.47742     -39729.578     -4725.148       3857.829     
      2400   307.39542     -39715.784      4309.6735      3857.0538    
      2500   316.14794     -39705.232      16727.777      3856.2787    
      2600   317.50314     -39706.665      901.73021      3855.5036    
      2700   293.44694     -39706.677      21266.461      3854.7284    
      2800   281.27823     -39711.466      6839.4463      3853.9533    
      2900   288.83163     -39708.164      17597.175      3853.1782    
      3000   313.15211     -39719.55       24111.369      3852.4031    
      3100   307.04234     -39710.157      11859.617      3851.6279    
      3200   287.53112     -39683.203      10833.575      3850.8528    
      3300   302.79873     -39697.466      7311.0324      3850.0777    
      3400   280.87263     -39698.303      4000.9325      3849.3025    
      3500   302.23578     -39738.048      8057.4402      3848.5274    
      3600   291.69805     -39724.64       5162.2328      3847.7523    
      3700   304.05881     -39704.05      -6281.9601      3846.9771    
      3800   314.26163     -39695.498      12807.479      3846.202     
      3900   293.52845     -39678.778      8332.0398      3845.4269    
      4000   285.84593     -39700.543      25084.523      3844.6517    
      4100   288.57128     -39710.828      23009.379      3843.8766    
      4200   310.28392     -39727.626      9216.4519      3843.1015    
      4300   288.717       -39694.596      7358.2064      3842.3263    
      4400   298.73706     -39696.479     -12805.875      3841.5512    
      4500   302.64931     -39713.157      6735.8581      3840.7761    
      4600   288.54674     -39718.438      13828.602      3840.0009    
      4700   295.96424     -39722.248      18058.793      3839.2258    
      4800   292.6382      -39696.18       14126.526      3838.4507    
      4900   308.91295     -39699.447      8606.2931      3837.6756    
      5000   308.92012     -39695.285      3334.6271      3836.9004    
Loop time of 154.519 on 16 procs for 5000 steps with 386 atoms

Performance: 1.398 ns/day, 17.169 hours/ns, 32.358 timesteps/s, 12.490 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 124.05     | 127.66     | 133.5      |  25.8 | 82.62
Bond    | 0.01035    | 0.010997   | 0.011664   |   0.4 |  0.01
Neigh   | 1.8372     | 1.8813     | 1.9217     |   1.7 |  1.22
Comm    | 2.6844     | 8.5069     | 12.106     |  99.7 |  5.51
Output  | 0.010604   | 0.035837   | 0.077619   |  11.7 |  0.02
Modify  | 16.262     | 16.3       | 16.344     |   0.6 | 10.55
Other   |            | 0.1248     |            |       |  0.08

Nlocal:          48.25 ave          55 max          42 min
Histogram: 1 2 0 1 1 0 0 1 0 2
Nghost:        3762.12 ave        3818 max        3711 min
Histogram: 2 0 1 1 0 0 1 1 1 1
Neighs:        33980.9 ave       38532 max       29751 min
Histogram: 1 2 0 1 1 0 0 1 0 2

Total # of neighbors = 271847
Ave neighs/atom = 704.26684
Ave special neighs/atom = 0
Neighbor list builds = 71
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.6078
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.166078 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.166078 xy delta -0.094505 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.166078 xy delta -0.094505 xz delta -0.010717 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz 100 dump/pos_deform1.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144 | 146.1 | 148.3 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   299.62481     -39709.007      23288.44       3875.657     
       100   305.80325     -39717.592      18428.841      3876.4321    
       200   275.71117     -39701.491      6325.6964      3877.2073    
       300   281.32369     -39722.001      4450.594       3877.9824    
       400   285.03613     -39708.108      7797.7585      3878.7575    
       500   298.03733     -39689.85       17004.313      3879.5327    
       600   326.49661     -39717.058      20390.528      3880.3078    
       700   284.93152     -39689.423     -289.77284      3881.0829    
       800   284.02389     -39708.827      666.66132      3881.858     
       900   291.73965     -39711.924      3312.6829      3882.6332    
      1000   311.83194     -39698.21       5122.6506      3883.4083    
      1100   310.78815     -39672.709      9063.2414      3884.1834    
      1200   298.89574     -39681.867      16233.641      3884.9586    
      1300   314.78592     -39726.262      5351.8929      3885.7337    
      1400   292.33448     -39710.261      4248.7939      3886.5088    
      1500   307.86833     -39722.59       2387.7666      3887.284     
      1600   302.30007     -39712.612      4684.9191      3888.0591    
      1700   327.64459     -39718.548      5138.2487      3888.8342    
      1800   312.82503     -39694.153      830.16712      3889.6094    
      1900   315.93353     -39723.926      15477.768      3890.3845    
      2000   297.55644     -39717.611      11281.246      3891.1596    
      2100   310.50258     -39724.933     -605.52423      3891.9348    
      2200   302.03281     -39712.119      4228.7175      3892.7099    
      2300   287.68611     -39702.14      -4527.7076      3893.485     
      2400   285.96248     -39696.161      7859.5257      3894.2601    
      2500   308.17287     -39710.108      12597.535      3895.0353    
      2600   310.69007     -39709.605      11799.452      3895.8104    
      2700   308.73588     -39728.749      1683.578       3896.5855    
      2800   286.24838     -39732.277      11491.248      3897.3607    
      2900   294.39571     -39730.976      6970.1648      3898.1358    
      3000   305.68144     -39722          5040.8448      3898.9109    
      3100   298.20242     -39701.194      10712.531      3899.6861    
      3200   304.8093      -39701.965      8357.3635      3900.4612    
      3300   312.76567     -39710.87       4564.393       3901.2363    
      3400   306.54358     -39726.532      18296.391      3902.0115    
      3500   295.04229     -39725.953      7131.615       3902.7866    
      3600   309.56345     -39721.299      5878.6856      3903.5617    
      3700   305.24367     -39685.681      3303.2656      3904.3369    
      3800   285.85905     -39669.481      1222.0618      3905.112     
      3900   301.96839     -39701.669      9308.1335      3905.8871    
      4000   303.84662     -39713.058      6402.1188      3906.6622    
      4100   307.41083     -39719.431      7607.7217      3907.4374    
      4200   293.58311     -39705.777      10449.668      3908.2125    
      4300   316.42372     -39711.933      4332.2716      3908.9876    
      4400   307.72078     -39689.447      10686.948      3909.7628    
      4500   313.55311     -39716.729     -8211.5928      3910.5379    
      4600   290.16159     -39711.188      7314.229       3911.313     
      4700   289.66094     -39712.48       3570.3851      3912.0882    
      4800   312.5391      -39707.954      5194.371       3912.8633    
      4900   303.65121     -39678.249      6219.1101      3913.6384    
      5000   286.8449      -39675.297     -1686.0419      3914.4136    
Loop time of 139.312 on 16 procs for 5000 steps with 386 atoms

Performance: 1.550 ns/day, 15.479 hours/ns, 35.891 timesteps/s, 13.854 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 115.73     | 119.12     | 121.77     |  18.2 | 85.51
Bond    | 0.010759   | 0.011228   | 0.011587   |   0.2 |  0.01
Neigh   | 1.6246     | 1.6553     | 1.7231     |   2.3 |  1.19
Comm    | 1.3544     | 3.9986     | 7.3901     |  99.3 |  2.87
Output  | 0.010652   | 0.03247    | 0.078857   |  12.9 |  0.02
Modify  | 14.246     | 14.321     | 14.362     |   0.9 | 10.28
Other   |            | 0.1683     |            |       |  0.12

Nlocal:          48.25 ave          58 max          42 min
Histogram: 2 1 0 2 0 1 1 0 0 1
Nghost:        3487.75 ave        3528 max        3453 min
Histogram: 2 1 0 0 1 2 0 0 1 1
Neighs:        33245.1 ave       39577 max       29180 min
Histogram: 2 1 0 2 0 1 1 0 0 1

Total # of neighbors = 265961
Ave neighs/atom = 689.01813
Ave special neighs/atom = 0
Neighbor list builds = 70
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.4502
variable dlen equal ly-${len0}
variable dlen equal ly-13.4502
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4502
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.094505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.010717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -3.4e-05
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.134502 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.134502 yz delta -3.4e-05 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz 100 dump/neg_deform2.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144 | 146.1 | 148.3 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   299.62481     -39709.007      23288.44       3875.657     
       100   305.81358     -39717.59       18436.675      3874.8819    
       200   275.75172     -39701.547      6803.5826      3874.1067    
       300   281.14806     -39721.539      4272.8458      3873.3316    
       400   284.26529     -39706.568      8363.7548      3872.5565    
       500   299.18819     -39690.913      17648.63       3871.7813    
       600   324.77905     -39715.267      21303.732      3871.0062    
       700   283.64901     -39688.206      8529.3938      3870.2311    
       800   281.08808     -39704.688      8185.7965      3869.4559    
       900   281.18182     -39696.48       1983.9904      3868.6808    
      1000   314.6027      -39702.449      7374.0143      3867.9057    
      1100   304.92985     -39662.073      15012.869      3867.1305    
      1200   321.97759     -39692.199      13925.234      3866.3554    
      1300   316.87917     -39714.585      2970.032       3865.5803    
      1400   289.34749     -39701.749      15698.656      3864.8052    
      1500   301.23732     -39724.268      14162.043      3864.03      
      1600   279.1096      -39703.206      11481.196      3863.2549    
      1700   299.83428     -39692.323      11098.469      3862.4798    
      1800   315.64858     -39697.15      -4291.4665      3861.7046    
      1900   310.54111     -39707.562      17697.781      3860.9295    
      2000   283.0046      -39693.78       22769.079      3860.1544    
      2100   300.40796     -39718.882      9882.7259      3859.3792    
      2200   309.97629     -39723.654      2774.9511      3858.6041    
      2300   305.6341      -39701.035     -742.00057      3857.829     
      2400   306.55483     -39685.264      11699.358      3857.0538    
      2500   307.35195     -39694.221      23714.084      3856.2787    
      2600   285.6316      -39696.442      15760.696      3855.5036    
      2700   283.46204     -39710.372      29808.809      3854.7284    
      2800   284.48074     -39698.592      18311.843      3853.9533    
      2900   304.20902     -39711.197      20734.732      3853.1782    
      3000   297.45974     -39699.54       5202.0457      3852.4031    
      3100   297.50842     -39692.516      16194.311      3851.6279    
      3200   305.19102     -39692.654      6631.5896      3850.8528    
      3300   321.89841     -39685.363     -319.92646      3850.0777    
      3400   293.27127     -39654.03       9791.6555      3849.3025    
      3500   308.41598     -39706.041      9573.5624      3848.5274    
      3600   291.40834     -39703.88      -2693.8067      3847.7523    
      3700   290.20549     -39692.794      7715.62        3846.9771    
      3800   309.34699     -39695.387      16073.677      3846.202     
      3900   298.13874     -39687.726      14100.782      3845.4269    
      4000   284.83113     -39713.19       2122.4102      3844.6517    
      4100   308.76781     -39736.765     -615.16889      3843.8766    
      4200   291.9324      -39699.719      5698.9384      3843.1015    
      4300   296.94945     -39687.654      19254.962      3842.3263    
      4400   307.71857     -39698.012      15540.224      3841.5512    
      4500   304.48189     -39695.784      8732.3254      3840.7761    
      4600   304.11239     -39697.633      24385.65       3840.0009    
      4700   287.7727      -39682.218      26516.02       3839.2258    
      4800   301.56063     -39698.693      9905.8942      3838.4507    
      4900   291.86515     -39691.505      4725.2014      3837.6756    
      5000   304.73858     -39705.855      13162.592      3836.9004    
Loop time of 152.255 on 16 procs for 5000 steps with 386 atoms

Performance: 1.419 ns/day, 16.917 hours/ns, 32.840 timesteps/s, 12.676 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 124.33     | 127.39     | 133.36     |  25.2 | 83.67
Bond    | 0.010363   | 0.011004   | 0.01187    |   0.6 |  0.01
Neigh   | 1.8937     | 1.9302     | 1.9838     |   1.9 |  1.27
Comm    | 1.011      | 6.9672     | 10.018     | 107.5 |  4.58
Output  | 0.010381   | 0.034866   | 0.076077   |  11.6 |  0.02
Modify  | 15.75      | 15.8       | 15.838     |   0.6 | 10.38
Other   |            | 0.1251     |            |       |  0.08

Nlocal:          48.25 ave          54 max          39 min
Histogram: 1 0 1 0 0 1 2 0 1 2
Nghost:        3772.12 ave        3840 max        3703 min
Histogram: 1 1 0 1 1 1 1 0 0 2
Neighs:          33966 ave       37858 max       27765 min
Histogram: 1 0 1 0 0 1 2 0 1 2

Total # of neighbors = 271728
Ave neighs/atom = 703.95855
Ave special neighs/atom = 0
Neighbor list builds = 73
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4502
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.134502 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.134502 yz delta 3.4e-05 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz 100 dump/pos_deform2.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144 | 146.1 | 148.3 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   299.62481     -39709.007      23288.44       3875.657     
       100   305.80279     -39717.588      18424.739      3876.4321    
       200   275.65917     -39701.319      6409.9321      3877.2073    
       300   280.96959     -39721.997      4408.3566      3877.9824    
       400   284.64792     -39708.797      7270.4517      3878.7575    
       500   298.92769     -39691.455      16915.143      3879.5327    
       600   326.06443     -39717.157      21182.702      3880.3078    
       700   284.4615      -39688.2        3764.4569      3881.0829    
       800   284.37635     -39709.956      2052.939       3881.858     
       900   288.59522     -39711.547      2087.9768      3882.6332    
      1000   313.74009     -39703.472      1083.0531      3883.4083    
      1100   300.89698     -39667.244      9364.1469      3884.1834    
      1200   302.60452     -39692.981      15486.495      3884.9586    
      1300   306.6421      -39720.43       4857.8645      3885.7337    
      1400   307.34852     -39726.151      11078.722      3886.5088    
      1500   305.85568     -39719.762      7978.8914      3887.284     
      1600   296.48847     -39704.819      5499.4435      3888.0591    
      1700   312.43928     -39700.923      8058.5586      3888.8342    
      1800   313.29543     -39698.056     -2287.785       3889.6094    
      1900   294.28475     -39704.036      9654.2711      3890.3845    
      2000   285.31856     -39715.79       4449.3042      3891.1596    
      2100   287.53762     -39712.619      8636.8111      3891.9348    
      2200   312.90232     -39722.3       -10619.213      3892.7099    
      2300   288.86171     -39694.442     -11974.537      3893.485     
      2400   309.23292     -39718.317      2794.5145      3894.2601    
      2500   282.97069     -39694.166      20725.643      3895.0353    
      2600   306.65258     -39713.913      13455.831      3895.8104    
      2700   303.59086     -39697.676      1582.752       3896.5855    
      2800   310.72567     -39704.164      2580.4495      3897.3607    
      2900   274.59499     -39691.401     -4383.0947      3898.1358    
      3000   280.61763     -39706.691      20440.188      3898.9109    
      3100   314.71828     -39729.996      5010.3073      3899.6861    
      3200   323.27968     -39707.871      6554.1692      3900.4612    
      3300   312.62477     -39661.824      23957.791      3901.2363    
      3400   315.65536     -39689.908      10200.638      3902.0115    
      3500   307.4792      -39706.559      6522.5781      3902.7866    
      3600   285.11793     -39692.562      1441.6539      3903.5617    
      3700   302.44517     -39716.335      2089.9779      3904.3369    
      3800   299.65802     -39721.382      6131.4893      3905.112     
      3900   294.5125      -39727.433      14127.161      3905.8871    
      4000   296.81344     -39726.488      12728.084      3906.6622    
      4100   282.77816     -39679.806      8541.7133      3907.4374    
      4200   330.192       -39714.605      15193.219      3908.2125    
      4300   299.84871     -39695.065      15532.769      3908.9876    
      4400   295.39513     -39704.75       281.70536      3909.7628    
      4500   302.3484      -39718.881      8619.3727      3910.5379    
      4600   299.39423     -39716.748      1056.7055      3911.313     
      4700   292.64464     -39702.644      3929.8814      3912.0882    
      4800   311.47646     -39709.984      8633.8268      3912.8633    
      4900   298.0797      -39700.498      7722.4256      3913.6384    
      5000   265.68342     -39702.659      3546.9284      3914.4136    
Loop time of 139.366 on 16 procs for 5000 steps with 386 atoms

Performance: 1.550 ns/day, 15.485 hours/ns, 35.877 timesteps/s, 13.848 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 115.75     | 119.24     | 121.9      |  16.3 | 85.56
Bond    | 0.010708   | 0.011155   | 0.011444   |   0.2 |  0.01
Neigh   | 1.8325     | 1.8666     | 1.9391     |   2.2 |  1.34
Comm    | 1.1436     | 3.813      | 7.3015     |  91.1 |  2.74
Output  | 0.010618   | 0.03249    | 0.078438   |  12.7 |  0.02
Modify  | 14.155     | 14.231     | 14.272     |   0.9 | 10.21
Other   |            | 0.1692     |            |       |  0.12

Nlocal:          48.25 ave          52 max          40 min
Histogram: 1 0 0 0 0 1 1 2 1 2
Nghost:        3500.75 ave        3515 max        3474 min
Histogram: 1 0 0 1 0 0 1 2 2 1
Neighs:        33281.8 ave       35657 max       27833 min
Histogram: 1 0 0 0 0 1 1 2 1 2

Total # of neighbors = 266254
Ave neighs/atom = 689.7772
Ave special neighs/atom = 0
Neighbor list builds = 79
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.3502
variable dlen equal lz-${len0}
variable dlen equal lz-17.3502
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.3502
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.094505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.010717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -3.4e-05
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -0.173502 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz 100 dump/neg_deform3.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144 | 146.1 | 148.3 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   299.62481     -39709.007      23288.44       3875.657     
       100   305.80576     -39717.587      18434.475      3874.8819    
       200   275.54177     -39701.286      6683.2895      3874.1067    
       300   281.03241     -39721.831      4974.9698      3873.3316    
       400   284.85936     -39709.09       8466.3396      3872.5565    
       500   298.27523     -39690.573      18856.174      3871.7813    
       600   325.40749     -39716.426      20682.716      3871.0062    
       700   280.32033     -39683.977     -2154.7546      3870.2311    
       800   289.82944     -39713.38       9311.5706      3869.4559    
       900   285.34579     -39706.379      2749.5833      3868.6808    
      1000   311.55262     -39695.25      -77.580383      3867.9057    
      1100   304.66178     -39672.015      16926.328      3867.1305    
      1200   299.96952     -39684.544      24994.083      3866.3554    
      1300   307.9264      -39716.35       12844.238      3865.5803    
      1400   298.35512     -39709.315      7244.7146      3864.8052    
      1500   304.56702     -39717.824     -3725.7741      3864.03      
      1600   292.71667     -39712.024      11938.697      3863.2549    
      1700   299.35365     -39720.711      3445.8373      3862.4798    
      1800   301.25661     -39710.614      10131.963      3861.7046    
      1900   289.39096     -39681.18       11535.175      3860.9295    
      2000   299.84004     -39679.5        17808.323      3860.1544    
      2100   333.9726      -39696.059      3494.8323      3859.3792    
      2200   285.9266      -39664.152      3436.6062      3858.6041    
      2300   305.53503     -39718.62       10670.949      3857.829     
      2400   310.51309     -39724.946      19456.632      3857.0538    
      2500   291.6702      -39693.661      20681.51       3856.2787    
      2600   313.32193     -39693.856      8009.9175      3855.5036    
      2700   314.74728     -39680.257      6578.0978      3854.7284    
      2800   292.90945     -39691.807      14715.698      3853.9533    
      2900   303.61158     -39723.476      6486.3641      3853.1782    
      3000   291.29928     -39704.462      10165.763      3852.4031    
      3100   300.24222     -39699.685      12403.254      3851.6279    
      3200   324.07256     -39704.791      8375.4179      3850.8528    
      3300   299.64365     -39675.885      9697.1907      3850.0777    
      3400   289.41879     -39695.173      9896.2347      3849.3025    
      3500   293.19495     -39717.297      10552.293      3848.5274    
      3600   301.63722     -39721.412      13384.576      3847.7523    
      3700   300.29988     -39687.986      18935.896      3846.9771    
      3800   307.0633      -39676.531      2255.8407      3846.202     
      3900   292.03475     -39694.096      7271.8457      3845.4269    
      4000   288.75418     -39718.622      251.18467      3844.6517    
      4100   294.58417     -39724.414      10878.393      3843.8766    
      4200   300.85453     -39706.98       23740.76       3843.1015    
      4300   315.21832     -39702.796      14187.794      3842.3263    
      4400   300.76616     -39692.827      14978.966      3841.5512    
      4500   286.5928      -39700.031      13554.6        3840.7761    
      4600   279.6839      -39723.843      17005.532      3840.0009    
      4700   265.61308     -39732.097      17303.839      3839.2258    
      4800   280.58454     -39708.208      13377.45       3838.4507    
      4900   286.00672     -39693.357      20589.079      3837.6756    
      5000   327.60815     -39722.61       14768.553      3836.9004    
Loop time of 152.154 on 16 procs for 5000 steps with 386 atoms

Performance: 1.420 ns/day, 16.906 hours/ns, 32.861 timesteps/s, 12.685 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 124.04     | 126.85     | 133.16     |  26.6 | 83.37
Bond    | 0.010061   | 0.01087    | 0.011667   |   0.6 |  0.01
Neigh   | 1.7279     | 1.7658     | 1.8143     |   1.9 |  1.16
Comm    | 1.0125     | 7.3022     | 10.108     | 110.4 |  4.80
Output  | 0.010239   | 0.034728   | 0.075878   |  11.6 |  0.02
Modify  | 16.02      | 16.065     | 16.105     |   0.6 | 10.56
Other   |            | 0.1238     |            |       |  0.08

Nlocal:          48.25 ave          54 max          39 min
Histogram: 1 0 0 0 1 2 1 0 1 2
Nghost:         3741.5 ave        3810 max        3679 min
Histogram: 2 0 1 1 0 0 2 0 1 1
Neighs:        33991.9 ave       37983 max       27691 min
Histogram: 1 0 0 1 0 2 1 0 1 2

Total # of neighbors = 271935
Ave neighs/atom = 704.49482
Ave special neighs/atom = 0
Neighbor list builds = 67
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.3502
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 0.173502 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz 100 dump/pos_deform3.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144 | 146.1 | 148.3 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   299.62481     -39709.007      23288.44       3875.657     
       100   305.81056     -39717.592      18426.807      3876.4321    
       200   275.81838     -39701.765      6484.3269      3877.2073    
       300   281.36551     -39721.93       3352.0281      3877.9824    
       400   284.15279     -39706.214      6867.2674      3878.7575    
       500   299.848       -39691.952      16441.309      3879.5327    
       600   324.9286      -39716.395      19117.277      3880.3078    
       700   282.39313     -39688.876      10250.846      3881.0829    
       800   282.32206     -39708.467      3478.0391      3881.858     
       900   287.07854     -39706.543      4543.8725      3882.6332    
      1000   310.42254     -39689.622      1209.3019      3883.4083    
      1100   312.63445     -39682.912      11131.308      3884.1834    
      1200   302.18028     -39694.734      12008.389      3884.9586    
      1300   299.58395     -39713.757      4398.2225      3885.7337    
      1400   296.57144     -39711.707      10146.825      3886.5088    
      1500   319.29535     -39736.537      20040.182      3887.284     
      1600   286.66004     -39711.673      16799.328      3888.0591    
      1700   310.57959     -39730.608      7265.87        3888.8342    
      1800   313.42711     -39707.081      6408.7848      3889.6094    
      1900   306.23631     -39685.953      19017.603      3890.3845    
      2000   295.93793     -39693.562      16374.719      3891.1596    
      2100   294.23145     -39722.577      5005.7647      3891.9348    
      2200   292.01671     -39714.002     -3500.3951      3892.7099    
      2300   302.87418     -39707.731      5166.794       3893.485     
      2400   320.84636     -39711.353      8531.7534      3894.2601    
      2500   292.76031     -39686.498      9744.3541      3895.0353    
      2600   287.53275     -39715.331      7573.3819      3895.8104    
      2700   291.23167     -39730.946      23500.194      3896.5855    
      2800   300.60425     -39729.436      16970.225      3897.3607    
      2900   296.86327     -39712.145     -6736.0374      3898.1358    
      3000   286.95866     -39681.664     -1663.6373      3898.9109    
      3100   321.23048     -39703.03      -4861.3846      3899.6861    
      3200   302.88657     -39701.419      9129.5189      3900.4612    
      3300   285.89435     -39717.287      287.23963      3901.2363    
      3400   285.17867     -39714.079      656.07491      3902.0115    
      3500   289.57908     -39706.104      7720.5337      3902.7866    
      3600   310.51911     -39713.003     -460.59094      3903.5617    
      3700   320.1848      -39696.161      2990.2281      3904.3369    
      3800   323.04477     -39677.344      8799.1855      3905.112     
      3900   298.12588     -39688.831      13148.352      3905.8871    
      4000   296.93096     -39703.67       12930.369      3906.6622    
      4100   303.34466     -39710.293     -16540.965      3907.4374    
      4200   299.8074      -39708.319      7549.089       3908.2125    
      4300   314.2273      -39726.6        3498.5491      3908.9876    
      4400   285.28107     -39701.085      10693.686      3909.7628    
      4500   298.57477     -39728.329      2990.218       3910.5379    
      4600   280.98169     -39720.795      1885.1817      3911.313     
      4700   291.11071     -39712.771     -5435.4613      3912.0882    
      4800   314.31444     -39708.863      1997.8802      3912.8633    
      4900   300.56151     -39697.17       74.253693      3913.6384    
      5000   291.62405     -39696.685     -8101.561       3914.4136    
Loop time of 150.506 on 16 procs for 5000 steps with 386 atoms

Performance: 1.435 ns/day, 16.723 hours/ns, 33.221 timesteps/s, 12.823 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 121.78     | 124.99     | 131.41     |  28.0 | 83.05
Bond    | 0.010158   | 0.01068    | 0.011208   |   0.3 |  0.01
Neigh   | 2.0513     | 2.1018     | 2.168      |   2.1 |  1.40
Comm    | 1.0108     | 7.4139     | 10.622     | 114.9 |  4.93
Output  | 0.010207   | 0.035785   | 0.078507   |  11.9 |  0.02
Modify  | 15.766     | 15.831     | 15.882     |   0.8 | 10.52
Other   |            | 0.1235     |            |       |  0.08

Nlocal:          48.25 ave          56 max          44 min
Histogram: 3 0 1 0 1 2 0 0 0 1
Nghost:        3691.38 ave        3728 max        3660 min
Histogram: 1 2 1 0 1 0 0 0 2 1
Neighs:        33283.9 ave       38229 max       30438 min
Histogram: 3 0 1 0 1 1 1 0 0 1

Total # of neighbors = 266271
Ave neighs/atom = 689.82124
Ave special neighs/atom = 0
Neighbor list builds = 80
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 16.6078
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.0034)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.6078
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.094505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.010717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -3.4e-05
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -0.166078 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz 100 dump/neg_deform4.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144 | 146.1 | 148.3 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   299.62481     -39709.007      23288.44       3875.657     
       100   305.8079      -39717.592      18430.21       3875.657     
       200   275.69531     -39701.378      6562.2519      3875.657     
       300   281.17103     -39721.782      4251.0711      3875.657     
       400   284.63537     -39707.85       7968.9139      3875.657     
       500   299.79261     -39692.19       17348.598      3875.657     
       600   326.38998     -39717.633      22426.91       3875.657     
       700   282.41512     -39687.88       3931.7505      3875.657     
       800   285.82403     -39711.884      5712.2663      3875.657     
       900   286.03062     -39706.887      3965.7656      3875.657     
      1000   311.19512     -39698.931      3656.4431      3875.657     
      1100   300.67744     -39663.262      11980.06       3875.657     
      1200   312.61214     -39694.696      18704.049      3875.657     
      1300   310.54291     -39715.493      7538.4247      3875.657     
      1400   293.93892     -39704.927      25167.878      3875.657     
      1500   299.1748      -39716.536      15450.838      3875.657     
      1600   299.08423     -39729.533      8949.4444      3875.657     
      1700   299.05637     -39720.965      13939.858      3875.657     
      1800   294.95548     -39683.937      4359.3464      3875.657     
      1900   309.02216     -39691.878      8870.8948      3875.657     
      2000   318.8543      -39723.074      23711.255      3875.657     
      2100   294.99765     -39720.012      1998.5882      3875.657     
      2200   277.874       -39700.112      4677.2892      3875.657     
      2300   291.57492     -39703.088      1508.8141      3875.657     
      2400   322.23098     -39718.889      20591.006      3875.657     
      2500   306.1111      -39696.717      18866.888      3875.657     
      2600   292.41847     -39703.305      19395.909      3875.657     
      2700   283.47736     -39718.698      9620.3781      3875.657     
      2800   297.56753     -39722.475      16327.732      3875.657     
      2900   306.69373     -39714.673      6242.9517      3875.657     
      3000   304.34076     -39710.26       7932.3493      3875.657     
      3100   319.92968     -39727.048      18299.994      3875.657     
      3200   298.2227      -39706.552      14179.06       3875.657     
      3300   295.57202     -39701.346      11984.717      3875.657     
      3400   287.84185     -39694.117      9215.8976      3875.657     
      3500   290.72477     -39699.751      3573.8429      3875.657     
      3600   315.33309     -39713.649      7964.8889      3875.657     
      3700   307.5558      -39692.334      421.11027      3875.657     
      3800   287.04273     -39680.402      5738.2089      3875.657     
      3900   294.30332     -39710.674      4680.9895      3875.657     
      4000   285.9412      -39720.947      10708.587      3875.657     
      4100   286.21122     -39717.491      15692.589      3875.657     
      4200   302.93362     -39690.806      6218.0434      3875.657     
      4300   312.41727     -39695.765      1396.7784      3875.657     
      4400   306.91934     -39705.633      6733.3759      3875.657     
      4500   286.43087     -39702.326      13318.195      3875.657     
      4600   292.92632     -39712.138      2105.1139      3875.657     
      4700   319.80027     -39706.274      14721.264      3875.657     
      4800   305.64315     -39673.504      3375.9755      3875.657     
      4900   301.66321     -39689.225      13624.093      3875.657     
      5000   282.9533      -39688.407      8954.2751      3875.657     
Loop time of 151.437 on 16 procs for 5000 steps with 386 atoms

Performance: 1.426 ns/day, 16.826 hours/ns, 33.017 timesteps/s, 12.745 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 122.99     | 125.96     | 132.51     |  26.7 | 83.18
Bond    | 0.010187   | 0.010811   | 0.012005   |   0.5 |  0.01
Neigh   | 2.0643     | 2.1005     | 2.1204     |   1.5 |  1.39
Comm    | 1.0179     | 7.5518     | 10.515     | 108.6 |  4.99
Output  | 0.010266   | 0.034963   | 0.077601   |  11.8 |  0.02
Modify  | 15.626     | 15.656     | 15.695     |   0.6 | 10.34
Other   |            | 0.1244     |            |       |  0.08

Nlocal:          48.25 ave          54 max          43 min
Histogram: 2 0 1 1 0 1 1 0 0 2
Nghost:         3725.5 ave        3765 max        3688 min
Histogram: 1 0 2 0 1 1 1 1 0 1
Neighs:        33626.2 ave       37563 max       30032 min
Histogram: 2 0 1 1 0 1 1 0 0 2

Total # of neighbors = 269010
Ave neighs/atom = 696.9171
Ave special neighs/atom = 0
Neighbor list builds = 80
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.6078
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 0.166078 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz 100 dump/pos_deform4.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144 | 146.1 | 148.3 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   299.62481     -39709.007      23288.44       3875.657     
       100   305.80847     -39717.586      18431.337      3875.657     
       200   275.61493     -39701.447      6644.2617      3875.657     
       300   281.09236     -39721.567      4578.1035      3875.657     
       400   284.51409     -39707.608      7904.7487      3875.657     
       500   300.45792     -39692.735      17316.006      3875.657     
       600   324.15225     -39715.79       22561.316      3875.657     
       700   283.55026     -39689.269      3860.0299      3875.657     
       800   285.24074     -39711.189      3709.7485      3875.657     
       900   283.24288     -39703.261      3327.0451      3875.657     
      1000   314.93685     -39696.414      2942.4986      3875.657     
      1100   304.08231     -39671.587      6187.4825      3875.657     
      1200   308.16378     -39695.862      8038.5799      3875.657     
      1300   307.22631     -39718.198      9063.2059      3875.657     
      1400   294.43994     -39711.589      12479.152      3875.657     
      1500   304.86734     -39729.484      10517.075      3875.657     
      1600   279.44858     -39718.848     -3028.3441      3875.657     
      1700   284.38146     -39727.173      3139.7491      3875.657     
      1800   298.03308     -39707.294      10251.718      3875.657     
      1900   313.20953     -39706.758      19077.147      3875.657     
      2000   303.13426     -39702.993      4172.4859      3875.657     
      2100   307.88085     -39719.937      715.29017      3875.657     
      2200   302.7264      -39735.846      11845.005      3875.657     
      2300   277.35647     -39729.42      -4057.9852      3875.657     
      2400   293.6989      -39729.906      9876.7287      3875.657     
      2500   315.23655     -39723.969      19392.406      3875.657     
      2600   293.69484     -39698.825      16822.818      3875.657     
      2700   296.66081     -39703.064      11945.112      3875.657     
      2800   291.88623     -39691.346      3881.6266      3875.657     
      2900   309.06805     -39701.488      11093.429      3875.657     
      3000   311.57451     -39702.035      12851.175      3875.657     
      3100   299.17966     -39703.504      11073.569      3875.657     
      3200   293.10573     -39720.66       10450.647      3875.657     
      3300   279.84657     -39710.106      7624.8784      3875.657     
      3400   301.06529     -39695.704      15388.197      3875.657     
      3500   312.60449     -39701.609      9254.0922      3875.657     
      3600   313.30314     -39716.356      5857.7914      3875.657     
      3700   290.00621     -39706.204     -6530.7755      3875.657     
      3800   272.44909     -39693.312     -6601.4239      3875.657     
      3900   294.86401     -39680.975      4491.1809      3875.657     
      4000   319.89471     -39698.679      10477.787      3875.657     
      4100   303.89468     -39700.983      22218.934      3875.657     
      4200   283.96224     -39696.577      25564.941      3875.657     
      4300   302.11501     -39718.572      6162.5582      3875.657     
      4400   301.99894     -39709.183      9092.8031      3875.657     
      4500   306.32354     -39697.859     -1073.9357      3875.657     
      4600   312.80373     -39703.997      11920.773      3875.657     
      4700   307.87622     -39721.606      6591.6119      3875.657     
      4800   291.2634      -39717.359      8279.7557      3875.657     
      4900   296.4528      -39728.215      25946.954      3875.657     
      5000   284.17345     -39720.343      15174.582      3875.657     
Loop time of 140.524 on 16 procs for 5000 steps with 386 atoms

Performance: 1.537 ns/day, 15.614 hours/ns, 35.581 timesteps/s, 13.734 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 116.98     | 120.08     | 122.85     |  16.4 | 85.45
Bond    | 0.010548   | 0.010976   | 0.011418   |   0.3 |  0.01
Neigh   | 1.8842     | 1.9023     | 1.9542     |   1.5 |  1.35
Comm    | 1.238      | 4.0134     | 7.1125     |  89.7 |  2.86
Output  | 0.010515   | 0.032822   | 0.078695   |  12.7 |  0.02
Modify  | 14.258     | 14.317     | 14.347     |   0.6 | 10.19
Other   |            | 0.1691     |            |       |  0.12

Nlocal:          48.25 ave          53 max          43 min
Histogram: 1 1 0 1 0 0 1 2 1 1
Nghost:        3518.38 ave        3551 max        3492 min
Histogram: 1 1 0 2 1 1 0 1 0 1
Neighs:        33617.6 ave       36692 max       30168 min
Histogram: 2 0 0 1 0 0 1 3 0 1

Total # of neighbors = 268941
Ave neighs/atom = 696.73834
Ave special neighs/atom = 0
Neighbor list builds = 80
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.4502
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz--1.0717)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4502
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.094505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.010717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -3.4e-05
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -0.134502 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz 100 dump/neg_deform5.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144 | 146.1 | 148.3 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   299.62481     -39709.007      23288.44       3875.657     
       100   305.80867     -39717.587      18430.901      3875.657     
       200   275.61284     -39701.441      6547.2255      3875.657     
       300   281.24433     -39721.535      4165.8952      3875.657     
       400   284.3751      -39707.483      8044.6737      3875.657     
       500   300.0762      -39692.286      16840.833      3875.657     
       600   326.65823     -39717.891      22633.958      3875.657     
       700   282.60723     -39688.239      2787.9198      3875.657     
       800   288.59972     -39713.988      6149.3242      3875.657     
       900   283.83276     -39702.277      1924.617       3875.657     
      1000   316.94896     -39698.322      1385.1053      3875.657     
      1100   310.23076     -39676.749      13631.944      3875.657     
      1200   308.35208     -39693.07       18411.564      3875.657     
      1300   302.41453     -39708.73       3351.6255      3875.657     
      1400   284.88215     -39694.41       8376.8161      3875.657     
      1500   304.31003     -39716.585      705.45528      3875.657     
      1600   288.32609     -39715.781      10446.302      3875.657     
      1700   301.55549     -39735.116      6097.0441      3875.657     
      1800   297.42281     -39701.46       8704.6101      3875.657     
      1900   309.41827     -39696.941      18378.009      3875.657     
      2000   288.46544     -39681.999      3712.3761      3875.657     
      2100   295.93031     -39707.524     -7805.9975      3875.657     
      2200   283.42175     -39708.058     -5343.2936      3875.657     
      2300   287.74874     -39740.358     -5902.042       3875.657     
      2400   280.40596     -39726.325      5008.6355      3875.657     
      2500   287.31073     -39699.64       10357.652      3875.657     
      2600   303.57265     -39704.758     -1766.6283      3875.657     
      2700   297.3334      -39690.914      18582.555      3875.657     
      2800   315.17882     -39705.181      7550.5713      3875.657     
      2900   289.72636     -39691.319      4339.0507      3875.657     
      3000   305.36571     -39739.099      3160.4296      3875.657     
      3100   294.08986     -39731.432      9094.3092      3875.657     
      3200   294.43557     -39706.018      2764.7093      3875.657     
      3300   314.17927     -39711.656     -1366.6949      3875.657     
      3400   308.34542     -39707.403      12623.44       3875.657     
      3500   306.13887     -39720.881      5881.2631      3875.657     
      3600   297.53541     -39727.526      8102.0029      3875.657     
      3700   291.02412     -39728.293      10503.531      3875.657     
      3800   282.57749     -39700.044      22073.566      3875.657     
      3900   297.34989     -39684.822      19493.137      3875.657     
      4000   302.23013     -39682.507      8793.2822      3875.657     
      4100   318.69967     -39718.042      9054.9524      3875.657     
      4200   288.91331     -39709.325      23191.726      3875.657     
      4300   280.69332     -39701.034      18073.926      3875.657     
      4400   310.09145     -39718.04       6402.6772      3875.657     
      4500   307.76156     -39663.758      8564.9111      3875.657     
      4600   316.76488     -39679.049      3340.4144      3875.657     
      4700   295.50272     -39690.771      10116.839      3875.657     
      4800   291.68781     -39702.839     -3453.2192      3875.657     
      4900   309.64199     -39730.809     -3664.7176      3875.657     
      5000   300.00278     -39713.119      3177.0616      3875.657     
Loop time of 151.603 on 16 procs for 5000 steps with 386 atoms

Performance: 1.425 ns/day, 16.845 hours/ns, 32.981 timesteps/s, 12.731 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 123.08     | 125.99     | 132.75     |  28.5 | 83.11
Bond    | 0.010261   | 0.01074    | 0.011534   |   0.4 |  0.01
Neigh   | 1.7491     | 1.7801     | 1.7998     |   1.4 |  1.17
Comm    | 1.0005     | 7.7461     | 10.665     | 114.9 |  5.11
Output  | 0.010409   | 0.034947   | 0.075997   |  11.5 |  0.02
Modify  | 15.89      | 15.914     | 15.948     |   0.5 | 10.50
Other   |            | 0.1226     |            |       |  0.08

Nlocal:          48.25 ave          54 max          40 min
Histogram: 1 0 0 2 0 1 1 0 1 2
Nghost:        3708.62 ave        3755 max        3676 min
Histogram: 1 1 1 2 0 1 1 0 0 1
Neighs:        33612.6 ave       37366 max       28092 min
Histogram: 1 0 0 2 0 1 1 0 1 2

Total # of neighbors = 268901
Ave neighs/atom = 696.63472
Ave special neighs/atom = 0
Neighbor list builds = 68
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4502
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 0.134502 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz 100 dump/pos_deform5.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144 | 146.1 | 148.3 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   299.62481     -39709.007      23288.44       3875.657     
       100   305.80764     -39717.592      18430.465      3875.657     
       200   275.71489     -39701.416      6622.1248      3875.657     
       300   281.12851     -39721.924      4617.8521      3875.657     
       400   284.50012     -39707.786      7933.3704      3875.657     
       500   299.53507     -39692.106      17663.92       3875.657     
       600   324.09526     -39714.126      21754.999      3875.657     
       700   286.05162     -39688.72       2932.4632      3875.657     
       800   285.669       -39710.683      2205.5483      3875.657     
       900   283.75781     -39703.879      2981.5533      3875.657     
      1000   309.40107     -39709.156     -968.40773      3875.657     
      1100   312.56325     -39667.432      18009.94       3875.657     
      1200   327.21103     -39685.093      14306.334      3875.657     
      1300   328.24381     -39717.873      6537.5713      3875.657     
      1400   297.1469      -39710.616      7629.2509      3875.657     
      1500   295.70753     -39725.999      7412.3346      3875.657     
      1600   278.07802     -39704.258      4474.2899      3875.657     
      1700   303.01149     -39698.668     -3580.3065      3875.657     
      1800   300.58286     -39690.719      6880.1834      3875.657     
      1900   298.47942     -39699.235      7937.543       3875.657     
      2000   303.22963     -39718.966      6769.9317      3875.657     
      2100   290.91106     -39722.054      18043.897      3875.657     
      2200   273.62563     -39723.286      6696.3426      3875.657     
      2300   285.72088     -39721.767      14991.392      3875.657     
      2400   309.63947     -39717.819      15573.966      3875.657     
      2500   307.04389     -39701.091      562.8105       3875.657     
      2600   314.01967     -39697.069      20194.315      3875.657     
      2700   290.13595     -39689.01       8615.4416      3875.657     
      2800   284.47525     -39711.295      11557.22       3875.657     
      2900   271.93223     -39701.666      2553.9725      3875.657     
      3000   286.92265     -39708.916     -3651.0914      3875.657     
      3100   302.34142     -39715.303      4313.0285      3875.657     
      3200   307.59208     -39714.683     -1651.1531      3875.657     
      3300   301.23421     -39696.458      536.09532      3875.657     
      3400   324.24072     -39696.603      10880.49       3875.657     
      3500   318.26257     -39692.795     -1121.8297      3875.657     
      3600   297.67136     -39710.266      3908.5348      3875.657     
      3700   293.40351     -39709.944      5789.1957      3875.657     
      3800   288.38314     -39699.763      8303.7271      3875.657     
      3900   303.54529     -39700.401      749.26347      3875.657     
      4000   324.71702     -39700.105      5340.8738      3875.657     
      4100   295.60729     -39689.794     -3891.0711      3875.657     
      4200   283.19829     -39698.757      3707.9774      3875.657     
      4300   309.29102     -39720.305      11956.18       3875.657     
      4400   321.80394     -39723.321      7077.3257      3875.657     
      4500   309.17744     -39706.964      4782.9934      3875.657     
      4600   283.50572     -39673.583      14432.495      3875.657     
      4700   289.14136     -39679.309      13086.949      3875.657     
      4800   309.14733     -39714.46       1255.9143      3875.657     
      4900   278.48717     -39704.857      404.76884      3875.657     
      5000   293.01273     -39719.293      8590.5144      3875.657     
Loop time of 127.567 on 16 procs for 5000 steps with 386 atoms

Performance: 1.693 ns/day, 14.174 hours/ns, 39.195 timesteps/s, 15.129 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 105.35     | 108.07     | 109.86     |  14.8 | 84.72
Bond    | 0.0087121  | 0.0093929  | 0.010195   |   0.4 |  0.01
Neigh   | 1.7842     | 1.8119     | 1.8815     |   2.0 |  1.42
Comm    | 1.633      | 3.433      | 6.1529     |  83.0 |  2.69
Output  | 0.011382   | 0.033035   | 0.079041   |  12.7 |  0.03
Modify  | 13.969     | 14.046     | 14.087     |   0.9 | 11.01
Other   |            | 0.1605     |            |       |  0.13

Nlocal:          48.25 ave          52 max          42 min
Histogram: 1 0 1 0 0 2 0 0 0 4
Nghost:        3525.38 ave        3549 max        3493 min
Histogram: 1 0 0 2 0 1 1 1 0 2
Neighs:        33595.9 ave       36069 max       29462 min
Histogram: 1 1 0 0 2 0 0 0 0 4

Total # of neighbors = 268767
Ave neighs/atom = 696.28756
Ave special neighs/atom = 0
Neighbor list builds = 78
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.3502
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--9.4505)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.3502
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -9.4504999999999999005, deltaxy = 0.094505
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.071700000000000097, deltaxz = 0.010717
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.0033999999999999998106, deltayz = -3.4e-05
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -0.173502 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz 100 dump/neg_deform6.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144 | 146.1 | 148.3 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   299.62481     -39709.007      23288.44       3875.657     
       100   305.79907     -39717.595      18434.096      3875.657     
       200   275.75238     -39701.29       6543.0719      3875.657     
       300   280.97754     -39721.486      4428.1926      3875.657     
       400   284.54499     -39708.248      7910.374       3875.657     
       500   300.02216     -39692.128      16320.777      3875.657     
       600   326.33177     -39717.77       22952.377      3875.657     
       700   286.20456     -39691.166      1299.2203      3875.657     
       800   285.30198     -39711.065      5513.058       3875.657     
       900   283.19715     -39703.325      6288.5074      3875.657     
      1000   317.55566     -39699.59       2083.8613      3875.657     
      1100   303.57176     -39675.912      20703.125      3875.657     
      1200   308.27143     -39699.75       11593.076      3875.657     
      1300   307.64859     -39724.429      9034.0265      3875.657     
      1400   286.66634     -39704.275      13856.497      3875.657     
      1500   304.17826     -39710.953      13357.832      3875.657     
      1600   302.90173     -39691.457      7788.6806      3875.657     
      1700   334.78787     -39690.485      9421.2451      3875.657     
      1800   309.57449     -39680.64       9440.5772      3875.657     
      1900   309.36052     -39706.902      16473.568      3875.657     
      2000   297.85488     -39707.535      22713.29       3875.657     
      2100   288.99736     -39701.251      2500.2754      3875.657     
      2200   283.18308     -39697.574     -8901.1039      3875.657     
      2300   299.98        -39713.734     -250.78455      3875.657     
      2400   313.86112     -39708.235      12059.578      3875.657     
      2500   294.48474     -39669.438      15489.899      3875.657     
      2600   315.03918     -39703.173      10580.666      3875.657     
      2700   294.32781     -39714.675     -3022.481       3875.657     
      2800   284.70801     -39707.864      4818.024       3875.657     
      2900   296.67665     -39703.218      2846.7065      3875.657     
      3000   317.49002     -39704.128      12377.331      3875.657     
      3100   295.05724     -39680.868     -579.47061      3875.657     
      3200   285.65735     -39686.012      15873.541      3875.657     
      3300   307.21572     -39727.588      16808.81       3875.657     
      3400   296.67599     -39718.936     -530.54403      3875.657     
      3500   305.75985     -39723.756      10059.634      3875.657     
      3600   310.04559     -39722.341      11247.663      3875.657     
      3700   310.46602     -39721.856      5670.7592      3875.657     
      3800   297.2869      -39707.043      2999.8306      3875.657     
      3900   310.4967      -39715.945      2600.3235      3875.657     
      4000   292.6773      -39681.956     -8298.7026      3875.657     
      4100   312.22435     -39692.279      4115.1991      3875.657     
      4200   295.3691      -39685.791      16531.814      3875.657     
      4300   287.73018     -39708.784      11180.88       3875.657     
      4400   293.9675      -39727.154     -4436.5831      3875.657     
      4500   303.5782      -39727.258      7664.755       3875.657     
      4600   294.55066     -39702.536      6663.8453      3875.657     
      4700   299.91983     -39706.506      13814.131      3875.657     
      4800   306.21797     -39713.016      8338.9886      3875.657     
      4900   305.26923     -39709.121      8372.2914      3875.657     
      5000   299.67158     -39708.9        9514.9532      3875.657     
Loop time of 134.054 on 16 procs for 5000 steps with 386 atoms

Performance: 1.611 ns/day, 14.895 hours/ns, 37.298 timesteps/s, 14.397 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 107.01     | 110.04     | 115.87     |  27.5 | 82.09
Bond    | 0.0081201  | 0.0089179  | 0.010162   |   0.6 |  0.01
Neigh   | 1.7929     | 1.822      | 1.8442     |   1.4 |  1.36
Comm    | 0.95618    | 6.7646     | 9.7816     | 110.5 |  5.05
Output  | 0.010933   | 0.035568   | 0.076477   |  11.5 |  0.03
Modify  | 15.237     | 15.264     | 15.296     |   0.6 | 11.39
Other   |            | 0.1151     |            |       |  0.09

Nlocal:          48.25 ave          57 max          41 min
Histogram: 1 1 1 1 1 0 1 0 1 1
Nghost:        3733.88 ave        3803 max        3679 min
Histogram: 1 1 1 0 2 1 1 0 0 1
Neighs:        33632.2 ave       39507 max       28781 min
Histogram: 1 1 1 1 1 0 1 1 0 1

Total # of neighbors = 269058
Ave neighs/atom = 697.04145
Ave special neighs/atom = 0
Neighbor list builds = 71
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.6078 13.4502 17.3502) with tilt (-9.4505 -1.0717 0.0034)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  386 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.3502
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 0.173502 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz 100 dump/pos_deform6.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 144 | 146.1 | 148.3 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   299.62481     -39709.007      23288.44       3875.657     
       100   305.81734     -39717.583      18427.424      3875.657     
       200   275.64409     -39701.553      6637.0988      3875.657     
       300   281.31121     -39721.898      4407.7008      3875.657     
       400   284.5376      -39707.418      8069.4365      3875.657     
       500   299.67288     -39691.695      17971.815      3875.657     
       600   326.28585     -39715.96       20225.207      3875.657     
       700   282.47054     -39686.108      8266.0514      3875.657     
       800   285.08527     -39709.406      7530.692       3875.657     
       900   285.95924     -39705.214      1784.1473      3875.657     
      1000   298.10442     -39702.148     -3923.8344      3875.657     
      1100   306.66077     -39669.123      6758.7552      3875.657     
      1200   334.61093     -39690.038      14503.752      3875.657     
      1300   318.019       -39706.968      5049.8351      3875.657     
      1400   286.87463     -39693.726      7354.4891      3875.657     
      1500   299.56327     -39721.636      1472.0468      3875.657     
      1600   275.82901     -39700.394      11985.349      3875.657     
      1700   299.06643     -39696.084      3721.8395      3875.657     
      1800   305.75463     -39684.531     -2389.6677      3875.657     
      1900   292.3667      -39681.671      8507.6205      3875.657     
      2000   309.54681     -39714.145      6431.609       3875.657     
      2100   291.52721     -39697.916     -1572.0102      3875.657     
      2200   296.35721     -39701.98       6862.2517      3875.657     
      2300   307.72142     -39709.677     -1500.5566      3875.657     
      2400   300.76144     -39704.062      1286.0492      3875.657     
      2500   293.69765     -39697.248      10339.531      3875.657     
      2600   294.09211     -39696.627      16606.827      3875.657     
      2700   308.68577     -39721.31       3802.8654      3875.657     
      2800   287.31824     -39718.343      941.72002      3875.657     
      2900   293.78668     -39737.566      6424.2495      3875.657     
      3000   293.5388      -39712.133      15283.902      3875.657     
      3100   301.89933     -39692.807      12487.568      3875.657     
      3200   311.62219     -39710.641      20787.612      3875.657     
      3300   288.73829     -39708.659      6197.0454      3875.657     
      3400   276.73273     -39698.245      11642.881      3875.657     
      3500   301.93684     -39701.919      14662.261      3875.657     
      3600   308.28672     -39674.834      7319.2329      3875.657     
      3700   323.99733     -39706.749      12931.927      3875.657     
      3800   311.70125     -39718.084      16998.606      3875.657     
      3900   319.26153     -39737.795      26715.297      3875.657     
      4000   295.67032     -39715.303      15624.661      3875.657     
      4100   302.65042     -39710.01       9009.6585      3875.657     
      4200   326.62898     -39702.115      8092.9472      3875.657     
      4300   291.89295     -39673.999      6550.9106      3875.657     
      4400   311.6427      -39719.229      11607.882      3875.657     
      4500   281.90678     -39697.55       6118.9557      3875.657     
      4600   300.92471     -39711.916      4136.6639      3875.657     
      4700   309.77963     -39716.014      3458.673       3875.657     
      4800   295.79878     -39706.828      12382.041      3875.657     
      4900   290.27736     -39725.665      14213.372      3875.657     
      5000   272.05283     -39726.006      8632.8059      3875.657     
Loop time of 123.621 on 16 procs for 5000 steps with 386 atoms

Performance: 1.747 ns/day, 13.736 hours/ns, 40.446 timesteps/s, 15.612 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 102.19     | 104.69     | 106.54     |  14.5 | 84.69
Bond    | 0.0082846  | 0.0089248  | 0.009367   |   0.4 |  0.01
Neigh   | 1.6201     | 1.6488     | 1.7058     |   1.8 |  1.33
Comm    | 1.4476     | 3.3115     | 5.8015     |  81.8 |  2.68
Output  | 0.011583   | 0.033409   | 0.078774   |  12.4 |  0.03
Modify  | 13.708     | 13.772     | 13.812     |   0.8 | 11.14
Other   |            | 0.1574     |            |       |  0.13

Nlocal:          48.25 ave          55 max          39 min
Histogram: 1 0 0 1 0 2 2 1 0 1
Nghost:           3519 ave        3555 max        3483 min
Histogram: 2 0 0 0 1 0 4 0 0 1
Neighs:        33623.9 ave       38105 max       27451 min
Histogram: 1 0 0 1 0 2 1 2 0 1

Total # of neighbors = 268991
Ave neighs/atom = 696.86788
Ave special neighs/atom = 0
Neighbor list builds = 71
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:28:38
