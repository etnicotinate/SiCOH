LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
# boundary        s s s
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 0.1
variable FF string "SiOCHN_2018.ff C H O Si"          # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff C H O Si
# pair_coeff * * CHOSiNa.ff C H O Si
# pair_coeff * * SiOCHN_2018.ff C H O Si
# pair_coeff * * PDMSDecomp.ff C H O Si
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# Read the initial sctructure
# box tilt large
variable structure string 333-RV-31_eq

read_data       ${structure}.data
read_data       333-RV-31_eq.data
Reading data file ...
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  310 atoms
  reading velocities ...
  310 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.015 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400

# # Energy minimization
# print "*****Minimization starts.*****"
# minimize 1.0e-6 1.0e-6 100 1000
# min_style cg
# # Save the optimized structure
# write_data ${structure}_opt.data
# velocity        all create ${temp} ${seed} dist gaussian

# # Equilibration
# include ff.mod.lmp
# if "$(is_defined(fix,avgp))" then "unfix avgp"
# if "$(is_defined(fix,avgl))" then "unfix avgl"
# thermo_style custom step temp pe press density vol
# run ${nequil}
# # Save the equilibrated structure
# write_data ${structure}_eq.data

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.4114
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 12.7411
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.5034

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.3384
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal -1.8261
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -7.2027

# Write restart
write_restart equil.res
System init for write_restart ...
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 15.4114
variable dlen equal lx-${len0}
variable dlen equal lx-15.4114
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.4114
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.2027000000000001023, deltaxy = 0.072027
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.8261000000000000565, deltaxz = 0.018261
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.33839999999999997859, deltayz = -0.003384
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.154114 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.154114 xy delta 0.072027 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.154114 xy delta 0.072027 xz delta 0.018261 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz 100 dump/neg_deform1.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 124.1 | 126.8 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   296.39562     -29291.64       4312.9669      3436.9359    
       100   296.40859     -29300.657      5782.5949      3436.2485    
       200   294.68018     -29331.029     -12872.941      3435.5611    
       300   308.54176     -29349.641      6001.8719      3434.8738    
       400   271.75772     -29307.435      5222.3028      3434.1864    
       500   300.13127     -29312.997      2755.8226      3433.499     
       600   298.26671     -29300.681      11818.316      3432.8116    
       700   322.52199     -29323.769     -4831.4508      3432.1242    
       800   329.58513     -29339.779      6906.3217      3431.4368    
       900   293.49904     -29318.671     -6309.4602      3430.7494    
      1000   280.24242     -29307.136      668.64651      3430.062     
      1100   299.8483      -29317.012      9335.4451      3429.3747    
      1200   313.10467     -29317.505      1489.9317      3428.6873    
      1300   276.72304     -29285.477     -5954.1349      3427.9999    
      1400   304.84418     -29313.497      3461.6219      3427.3125    
      1500   314.7183      -29336.5        11222.286      3426.6251    
      1600   299.28292     -29343.876      3817.3214      3425.9377    
      1700   286.29887     -29339.564      509.42812      3425.2503    
      1800   297.34398     -29334.375      136.75435      3424.5629    
      1900   290.12254     -29316.601      9238.3397      3423.8756    
      2000   297.2002      -29311.064      5873.3056      3423.1882    
      2100   293.69263     -29310.052      22777.255      3422.5008    
      2200   288.59831     -29328.958      7932.2775      3421.8134    
      2300   266.93793     -29321.374      1330.4906      3421.126     
      2400   289.68398     -29312.307      11398.951      3420.4386    
      2500   309.30472     -29320.294      13372.167      3419.7512    
      2600   297.66153     -29314.728      5465.4788      3419.0639    
      2700   287.85653     -29322.243      8729.1814      3418.3765    
      2800   295.85622     -29349.372      5538.858       3417.6891    
      2900   288.87917     -29332.073      2951.142       3417.0017    
      3000   325.32144     -29332.071     -2574.179       3416.3143    
      3100   310.03907     -29313.897      9689.5164      3415.6269    
      3200   296.50473     -29302.999      14718.92       3414.9395    
      3300   298.77245     -29323.732     -1751.4508      3414.2521    
      3400   285.13851     -29332.806      4925.2011      3413.5648    
      3500   292.16831     -29336.218     -2883.967       3412.8774    
      3600   321.04022     -29339.1        4896.6899      3412.19      
      3700   287.13184     -29307.393     -1446.8286      3411.5026    
      3800   309.39178     -29325.26      -268.7259       3410.8152    
      3900   290.66319     -29303.108      10922.464      3410.1278    
      4000   317.80774     -29327.629      10792.944      3409.4404    
      4100   291.44997     -29324.428      11563.243      3408.753     
      4200   294.11352     -29337.765     -1315.7275      3408.0657    
      4300   304.93429     -29339.514     -6539.9283      3407.3783    
      4400   305.35767     -29308.361      2182.6855      3406.6909    
      4500   306.70218     -29304.237     -14285.914      3406.0035    
      4600   299.91426     -29319.745      5223.8691      3405.3161    
      4700   302.79722     -29331.258      4388.8761      3404.6287    
      4800   293.66198     -29320.967      15536.263      3403.9413    
      4900   293.20955     -29320.151     -1217.9558      3403.2539    
      5000   287.2606      -29301.292     -8454.2189      3402.5666    
Loop time of 183.762 on 16 procs for 5000 steps with 310 atoms

Performance: 1.175 ns/day, 20.418 hours/ns, 27.209 timesteps/s, 8.435 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 111.4      | 144.12     | 161.4      | 169.7 | 78.43
Bond    | 0.012723   | 0.013582   | 0.014596   |   0.6 |  0.01
Neigh   | 1.7152     | 2.1683     | 2.4388     |  19.0 |  1.18
Comm    | 2.9472     | 20.221     | 52.914     | 452.7 | 11.00
Output  | 0.015805   | 0.040158   | 0.088396   |  13.1 |  0.02
Modify  | 16.787     | 17.081     | 17.563     |   7.1 |  9.30
Other   |            | 0.1208     |            |       |  0.07

Nlocal:          38.75 ave          45 max          34 min
Histogram: 2 0 0 1 2 2 0 0 0 1
Nghost:        3175.38 ave        3226 max        3129 min
Histogram: 2 0 0 0 3 1 0 0 1 1
Neighs:        24728.9 ave       28460 max       21757 min
Histogram: 1 1 0 0 3 2 0 0 0 1

Total # of neighbors = 197831
Ave neighs/atom = 638.16452
Ave special neighs/atom = 0
Neighbor list builds = 87
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.4114
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.154114 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.154114 xy delta -0.072027 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.154114 xy delta -0.072027 xz delta -0.018261 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz 100 dump/pos_deform1.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 124.2 | 126.8 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   296.39562     -29291.64       4312.9669      3436.9359    
       100   296.3908      -29300.664      5783.1233      3437.6233    
       200   294.508       -29331.073     -13009.728      3438.3107    
       300   308.39364     -29349.854      5466.4145      3438.9981    
       400   270.97243     -29307.53       5180.3921      3439.6855    
       500   299.96118     -29314.172      2782.1162      3440.3729    
       600   300.13888     -29304.086      11644.015      3441.0602    
       700   321.69582     -29324.244     -5870.6486      3441.7476    
       800   330.00729     -29341.689      301.30163      3442.435     
       900   296.49694     -29322.537     -7974.1962      3443.1224    
      1000   288.71789     -29313.399     -2061.2516      3443.8098    
      1100   302.95346     -29318.84       3213.2702      3444.4972    
      1200   308.26022     -29316.165      7531.4092      3445.1846    
      1300   284.85014     -29284.821     -16067.906      3445.872     
      1400   300.27589     -29305.897      3432.7315      3446.5593    
      1500   313.86746     -29344.911     -5644.9991      3447.2467    
      1600   304.66011     -29352.896      1958.7851      3447.9341    
      1700   282.54265     -29332.661     -4357.9725      3448.6215    
      1800   308.89016     -29323.869     -8735.6465      3449.3089    
      1900   319.44559     -29325.719      7189.0814      3449.9963    
      2000   306.41252     -29321.025      5480.1723      3450.6837    
      2100   303.38925     -29332.249      25042.301      3451.371     
      2200   301.49644     -29343.086     -188.68579      3452.0584    
      2300   270.59792     -29333.393     -4195.8948      3452.7458    
      2400   293.74162     -29341.87       1833.1741      3453.4332    
      2500   298.54696     -29316.673      6464.8454      3454.1206    
      2600   296.6403      -29303.792      965.67269      3454.808     
      2700   306.44728     -29324.879      1418.6304      3455.4954    
      2800   275.61        -29315.193      546.40719      3456.1828    
      2900   280.94418     -29311.288      11814.564      3456.8701    
      3000   313.24096     -29304.837      2643.4179      3457.5575    
      3100   331.05929     -29327.231     -11373.93       3458.2449    
      3200   302.64544     -29318.472     -6568.3671      3458.9323    
      3300   306.78519     -29333.042      5200.7773      3459.6197    
      3400   300.60968     -29328.365     -1340.6011      3460.3071    
      3500   300.76283     -29323.889      7394.465       3460.9945    
      3600   305.77656     -29326.563      1909.4808      3461.6819    
      3700   303.66784     -29318.832      2873.9342      3462.3692    
      3800   333.22122     -29341.287     -5586.1211      3463.0566    
      3900   308.50788     -29328.003      5152.6211      3463.744     
      4000   282.46446     -29322.299      4933.3092      3464.4314    
      4100   282.10188     -29327.211     -12807.941      3465.1188    
      4200   293.7734      -29326.163      3365.5978      3465.8062    
      4300   323.05256     -29321.469      1420.0935      3466.4936    
      4400   291.09479     -29293.863      10391.369      3467.181     
      4500   302.60615     -29322.654     -7568.3748      3467.8683    
      4600   297.08622     -29331.302      5769.6345      3468.5557    
      4700   298.31697     -29349.225      5899.9437      3469.2431    
      4800   264.56337     -29349.951      4777.5418      3469.9305    
      4900   274.66679     -29347.616      4037.7097      3470.6179    
      5000   296.58395     -29339.419     -8652.1081      3471.3053    
Loop time of 182.094 on 16 procs for 5000 steps with 310 atoms

Performance: 1.186 ns/day, 20.233 hours/ns, 27.458 timesteps/s, 8.512 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 109.41     | 145.26     | 160.47     | 167.9 | 79.77
Bond    | 0.01292    | 0.01389    | 0.015086   |   0.6 |  0.01
Neigh   | 1.6717     | 2.16       | 2.3766     |  18.9 |  1.19
Comm    | 2.4266     | 17.63      | 53.446     | 481.5 |  9.68
Output  | 0.014874   | 0.03629    | 0.085215   |  13.5 |  0.02
Modify  | 16.636     | 16.874     | 17.383     |   7.1 |  9.27
Other   |            | 0.1219     |            |       |  0.07

Nlocal:          38.75 ave          44 max          35 min
Histogram: 1 1 0 2 2 0 1 0 0 1
Nghost:        3135.25 ave        3184 max        3098 min
Histogram: 2 1 0 0 1 1 2 0 0 1
Neighs:        24275.5 ave       27289 max       22165 min
Histogram: 2 0 0 2 2 0 1 0 0 1

Total # of neighbors = 194204
Ave neighs/atom = 626.46452
Ave special neighs/atom = 0
Neighbor list builds = 86
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 12.7411
variable dlen equal ly-${len0}
variable dlen equal ly-12.7411
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.7411
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.2027000000000001023, deltaxy = 0.072027
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.8261000000000000565, deltaxz = 0.018261
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.33839999999999997859, deltayz = -0.003384
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.127411 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.127411 yz delta -0.003384 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz 100 dump/neg_deform2.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 124.1 | 126.8 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   296.39562     -29291.64       4312.9669      3436.9359    
       100   296.40406     -29300.661      5785.2088      3436.2485    
       200   294.59235     -29331.134     -12802.092      3435.5611    
       300   308.1031      -29349.714      5906.9347      3434.8738    
       400   270.97202     -29307.083      5564.0234      3434.1864    
       500   300.52266     -29313.964      2910.5907      3433.499     
       600   300.24088     -29303.216      12047.801      3432.8116    
       700   320.7034      -29322.961     -5785.3938      3432.1242    
       800   330.77923     -29341.778      2298.3273      3431.4368    
       900   295.41287     -29320.462     -6458.4541      3430.7494    
      1000   281.70342     -29307.574     -672.16178      3430.062     
      1100   305.60129     -29324.082      6454.3699      3429.3747    
      1200   299.18998     -29309.57      -1017.7939      3428.6873    
      1300   299.75567     -29277.815     -13012.076      3427.9999    
      1400   317.28131     -29283.481      3344.3038      3427.3125    
      1500   321.22466     -29326.217      3988.172       3426.6251    
      1600   312.20022     -29332.102      13340.492      3425.9377    
      1700   287.78889     -29323.417     -22.238177      3425.2503    
      1800   291.58345     -29328.115      459.87985      3424.5629    
      1900   292.9342      -29305.406      5617.5744      3423.8756    
      2000   307.62275     -29298.343      4140.2937      3423.1882    
      2100   301.87609     -29300.202      15417.25       3422.5008    
      2200   302.2583      -29311.43       10413.306      3421.8134    
      2300   301.71956     -29319.393      3898.8452      3421.126     
      2400   278.60549     -29300.712      4340.1188      3420.4386    
      2500   309.52492     -29327.574      16705.276      3419.7512    
      2600   308.09636     -29329.299      8378.9443      3419.0639    
      2700   289.5562      -29321.186      3788.766       3418.3765    
      2800   255.80673     -29306.667      5756.3381      3417.6891    
      2900   283.28371     -29334.632      7408.8564      3417.0017    
      3000   300.83105     -29322.635     -9477.801       3416.3143    
      3100   300.63991     -29306.103      780.877        3415.6269    
      3200   306.6953      -29319.128      4173.4582      3414.9395    
      3300   277.00285     -29313.19       15515.06       3414.2521    
      3400   299.25391     -29331.211      10946.49       3413.5648    
      3500   292.57658     -29282.39       813.24147      3412.8774    
      3600   322.88477     -29307.836      17071.968      3412.19      
      3700   306.86984     -29319.443     -6074.6307      3411.5026    
      3800   297.87601     -29330.736      18102.248      3410.8152    
      3900   296.66527     -29328.504      13310.576      3410.1278    
      4000   313.29741     -29321.914      2983.6875      3409.4404    
      4100   326.1861      -29317.069      3315.9091      3408.753     
      4200   312.58211     -29314.256     -5745.3589      3408.0657    
      4300   298.62439     -29315.797     -710.38914      3407.3783    
      4400   289.04529     -29316.754     -2439.6368      3406.6909    
      4500   289.21711     -29314.555      13387.508      3406.0035    
      4600   329.35017     -29320.732     -5839.0985      3405.3161    
      4700   326.36343     -29307.768      22678.235      3404.6287    
      4800   330.98623     -29336.359     -2518.8914      3403.9413    
      4900   291.70076     -29312.366     -996.59073      3403.2539    
      5000   265.27363     -29300.784     -6781.1476      3402.5666    
Loop time of 184.79 on 16 procs for 5000 steps with 310 atoms

Performance: 1.169 ns/day, 20.532 hours/ns, 27.058 timesteps/s, 8.388 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 111.12     | 147.65     | 162.67     | 167.5 | 79.90
Bond    | 0.012425   | 0.01386    | 0.015193   |   0.7 |  0.01
Neigh   | 1.6797     | 2.1643     | 2.3954     |  19.0 |  1.17
Comm    | 2.5825     | 17.606     | 54.112     | 484.5 |  9.53
Output  | 0.014966   | 0.036529   | 0.084648   |  13.2 |  0.02
Modify  | 16.947     | 17.2       | 17.708     |   7.1 |  9.31
Other   |            | 0.1217     |            |       |  0.07

Nlocal:          38.75 ave          43 max          34 min
Histogram: 1 0 1 1 0 2 1 0 1 1
Nghost:        3172.25 ave        3237 max        3107 min
Histogram: 2 0 0 0 2 1 1 0 1 1
Neighs:        24726.2 ave       27140 max       21889 min
Histogram: 1 0 1 1 0 1 2 0 0 2

Total # of neighbors = 197810
Ave neighs/atom = 638.09677
Ave special neighs/atom = 0
Neighbor list builds = 85
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.7411
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.127411 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.127411 yz delta 0.003384 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz 100 dump/pos_deform2.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 124.2 | 126.8 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   296.39562     -29291.64       4312.9669      3436.9359    
       100   296.40164     -29300.659      5781.8812      3437.6233    
       200   294.49067     -29330.976     -13058.022      3438.3107    
       300   308.77704     -29349.824      5468.2597      3438.9981    
       400   271.76916     -29307.915      4766.1313      3439.6855    
       500   299.90024     -29313.402      2831.9167      3440.3729    
       600   298.85731     -29302.16       12096.339      3441.0602    
       700   322.24041     -29324.228     -5814.9046      3441.7476    
       800   329.61074     -29340.183      5230.4753      3442.435     
       900   297.44055     -29322.878     -5204.2259      3443.1224    
      1000   279.54869     -29305.803      427.45998      3443.8098    
      1100   303.18155     -29320.783      7601.1756      3444.4972    
      1200   304.97048     -29312.736      1975.4018      3445.1846    
      1300   277.98179     -29281.049     -12817.048      3445.872     
      1400   284.26318     -29294.716      1579.7884      3446.5593    
      1500   297.63909     -29343.038      6035.5603      3447.2467    
      1600   305.39048     -29358.702      13732.308      3447.9341    
      1700   295.6011      -29335.243      1773.4501      3448.6215    
      1800   303.47808     -29315.166      4438.8612      3449.3089    
      1900   313.94914     -29318.585      11647.47       3449.9963    
      2000   285.56207     -29298.747      8984.6799      3450.6837    
      2100   290.88198     -29326.502      20845.156      3451.371     
      2200   292.99146     -29348.809      17461.366      3452.0584    
      2300   277.75203     -29321.715     -3544.8699      3452.7458    
      2400   316.86507     -29322.822      4835.9617      3453.4332    
      2500   308.99686     -29310.935      5400.5722      3454.1206    
      2600   306.55371     -29319.104     -219.92111      3454.808     
      2700   294.64829     -29329.837      8164.0129      3455.4954    
      2800   291.86548     -29330.847      2663.7944      3456.1828    
      2900   294.26956     -29304.218     -3029.9277      3456.8701    
      3000   316.88315     -29306.184      2109.6346      3457.5575    
      3100   301.30139     -29301.696      5851.0092      3458.2449    
      3200   282.94709     -29302.759     -5060.0639      3458.9323    
      3300   292.99321     -29328.343     -5960.1379      3459.6197    
      3400   282.79182     -29323.952     -3511.2311      3460.3071    
      3500   302.74438     -29304.693     -7141.7312      3460.9945    
      3600   317.64918     -29311.356     -5339.8294      3461.6819    
      3700   310.92459     -29327.231     -2817.5989      3462.3692    
      3800   272.70872     -29302.19      -6200.9524      3463.0566    
      3900   294.26378     -29308.924     -688.6927       3463.744     
      4000   319.2451      -29301.921     -19426.863      3464.4314    
      4100   320.18994     -29295.108     -4866.0562      3465.1188    
      4200   305.07901     -29325.083      7695.1519      3465.8062    
      4300   291.50238     -29322.13       2008.7279      3466.4936    
      4400   297.81903     -29319.745      7839.0657      3467.181     
      4500   294.12411     -29296.17      -10799.698      3467.8683    
      4600   312.70784     -29306.112      15476.127      3468.5557    
      4700   307.26598     -29330.418     -379.51186      3469.2431    
      4800   291.88216     -29338.38      -2428.6586      3469.9305    
      4900   290.34858     -29328.422      9787.8303      3470.6179    
      5000   310.66565     -29324.617     -2358.4787      3471.3053    
Loop time of 182.626 on 16 procs for 5000 steps with 310 atoms

Performance: 1.183 ns/day, 20.292 hours/ns, 27.378 timesteps/s, 8.487 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 109.08     | 145.47     | 160.66     | 169.7 | 79.66
Bond    | 0.012292   | 0.013667   | 0.015221   |   0.8 |  0.01
Neigh   | 1.6713     | 2.1564     | 2.3788     |  19.1 |  1.18
Comm    | 2.6361     | 17.812     | 54.174     | 484.5 |  9.75
Output  | 0.014728   | 0.037327   | 0.086264   |  13.3 |  0.02
Modify  | 16.784     | 17.014     | 17.526     |   7.1 |  9.32
Other   |            | 0.121      |            |       |  0.07

Nlocal:          38.75 ave          43 max          34 min
Histogram: 1 1 0 1 0 1 2 0 1 1
Nghost:        3105.25 ave        3150 max        3055 min
Histogram: 2 0 0 1 0 0 2 1 1 1
Neighs:        24254.8 ave       26675 max       21450 min
Histogram: 1 1 0 1 0 1 1 1 0 2

Total # of neighbors = 194038
Ave neighs/atom = 625.92903
Ave special neighs/atom = 0
Neighbor list builds = 86
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.5034
variable dlen equal lz-${len0}
variable dlen equal lz-17.5034
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.5034
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.2027000000000001023, deltaxy = 0.072027
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.8261000000000000565, deltaxz = 0.018261
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.33839999999999997859, deltayz = -0.003384
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -0.175034 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz 100 dump/neg_deform3.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 124.1 | 126.8 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   296.39562     -29291.64       4312.9669      3436.9359    
       100   296.4092      -29300.666      5787.1423      3436.2485    
       200   294.51203     -29330.843     -13105.617      3435.5611    
       300   308.94044     -29350.428      5908.6953      3434.8738    
       400   271.44614     -29307.447      5453.3918      3434.1864    
       500   300.04049     -29313.501      3246.2953      3433.499     
       600   299.25771     -29302.166      13460.028      3432.8116    
       700   324.18958     -29325.889     -4597.9349      3432.1242    
       800   335.45155     -29346.122      3596.0391      3431.4368    
       900   295.21474     -29321.173     -7301.3547      3430.7494    
      1000   282.53874     -29308.563     -3990.965       3430.062     
      1100   303.33538     -29319.321      6210.5158      3429.3747    
      1200   304.99214     -29311.549      1853.1864      3428.6873    
      1300   295.83705     -29291.762     -10917.271      3427.9999    
      1400   306.76849     -29290.207      8889.4916      3427.3125    
      1500   311.15234     -29307.163     -3408.736       3426.6251    
      1600   308.77618     -29337.034      9860.0296      3425.9377    
      1700   309.37807     -29351.136     -3261.7767      3425.2503    
      1800   299.70948     -29333.693     -12856.729      3424.5629    
      1900   303.22903     -29310.481      9734.7349      3423.8756    
      2000   303.02833     -29300.448      10940.963      3423.1882    
      2100   310.16771     -29314.648      20459.376      3422.5008    
      2200   304.1278      -29323.85       11937.471      3421.8134    
      2300   292.64139     -29319.387     -5895.0716      3421.126     
      2400   280.95041     -29304.321      6682.335       3420.4386    
      2500   299.28566     -29318.518      4100.8223      3419.7512    
      2600   327.91509     -29342.443      9659.47        3419.0639    
      2700   300.57532     -29314.221      24267.725      3418.3765    
      2800   300.93316     -29309.604      8527.9802      3417.6891    
      2900   298.63041     -29309.365      3907.4967      3417.0017    
      3000   290.22129     -29317.936      13091.573      3416.3143    
      3100   293.87952     -29331.55      -3757.5715      3415.6269    
      3200   292.72573     -29314.022      9002.9823      3414.9395    
      3300   312.37824     -29308.459      10030.219      3414.2521    
      3400   322.07429     -29319.67       7168.694       3413.5648    
      3500   281.4414      -29303.013      25418.012      3412.8774    
      3600   289.74279     -29311.866     -2421.7716      3412.19      
      3700   303.49814     -29322.465      4162.0979      3411.5026    
      3800   312.929       -29324.239     -7532.302       3410.8152    
      3900   322.44721     -29311.259     -15681.612      3410.1278    
      4000   326.89153     -29302.871     -2540.437       3409.4404    
      4100   311.25225     -29320.955      7300.7694      3408.753     
      4200   288.23946     -29323.279      5999.1318      3408.0657    
      4300   295.77328     -29334.618     -9164.1579      3407.3783    
      4400   284.26391     -29309.409      8528.7877      3406.6909    
      4500   328.54246     -29329.335     -11582.578      3406.0035    
      4600   313.16681     -29314.296     -2116.433       3405.3161    
      4700   272.4366      -29310.623      7487.1656      3404.6287    
      4800   293.88324     -29344.084      15457.125      3403.9413    
      4900   287.08312     -29323.527      1382.9299      3403.2539    
      5000   306.81649     -29320.233      3742.0022      3402.5666    
Loop time of 185.15 on 16 procs for 5000 steps with 310 atoms

Performance: 1.167 ns/day, 20.572 hours/ns, 27.005 timesteps/s, 8.372 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 110.54     | 147.67     | 162.48     | 172.0 | 79.76
Bond    | 0.012289   | 0.013576   | 0.0147     |   0.7 |  0.01
Neigh   | 1.6683     | 2.1633     | 2.3891     |  19.4 |  1.17
Comm    | 3.0838     | 17.861     | 54.971     | 494.2 |  9.65
Output  | 0.014672   | 0.036274   | 0.083927   |  13.2 |  0.02
Modify  | 17.044     | 17.285     | 17.799     |   7.2 |  9.34
Other   |            | 0.1187     |            |       |  0.06

Nlocal:          38.75 ave          45 max          35 min
Histogram: 2 2 1 0 0 0 0 0 2 1
Nghost:        3182.12 ave        3230 max        3140 min
Histogram: 2 1 0 1 0 0 2 0 1 1
Neighs:        24750.9 ave       28389 max       22478 min
Histogram: 3 2 0 0 0 0 0 0 2 1

Total # of neighbors = 198007
Ave neighs/atom = 638.73226
Ave special neighs/atom = 0
Neighbor list builds = 85
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.5034
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 0.175034 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz 100 dump/pos_deform3.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 124.1 | 126.8 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   296.39562     -29291.64       4312.9669      3436.9359    
       100   296.39956     -29300.659      5781.9942      3437.6233    
       200   294.55548     -29331.247     -12698.814      3438.3107    
       300   308.09229     -29349.169      5547.906       3438.9981    
       400   271.24171     -29307.369      4889.1463      3439.6855    
       500   301.70627     -29314.959      2088.8231      3440.3729    
       600   299.79395     -29302.787      16350.593      3441.0602    
       700   319.24412     -29321.521     -7055.5176      3441.7476    
       800   332.41197     -29343.042      5526.5276      3442.435     
       900   295.73923     -29320.198     -6960.1475      3443.1224    
      1000   281.0313      -29306.148      1647.0337      3443.8098    
      1100   294.71129     -29311.764      8441.0373      3444.4972    
      1200   301.70276     -29305.84      -1706.1718      3445.1846    
      1300   280.64185     -29281.303     -15178.992      3445.872     
      1400   276.34271     -29314.063      1305.918       3446.5593    
      1500   299.96104     -29345.644      1233.5887      3447.2467    
      1600   324.48462     -29352.901      10711.081      3447.9341    
      1700   315.81083     -29332.84      -167.28999      3448.6215    
      1800   308.02829     -29305.312      3949.1497      3449.3089    
      1900   314.12246     -29289.406      946.87345      3449.9963    
      2000   302.73227     -29292.775      1488.072       3450.6837    
      2100   278.38207     -29306.697      15233.743      3451.371     
      2200   285.37566     -29311.045      18412.717      3452.0584    
      2300   302.72403     -29314.114      15104.005      3452.7458    
      2400   314.83993     -29304.639     -4453.9798      3453.4332    
      2500   327.57332     -29307.733     -5889.0455      3454.1206    
      2600   291.90214     -29308.009      2560.8056      3454.808     
      2700   292.63639     -29325.961      6526.0626      3455.4954    
      2800   294.67639     -29330.074      989.58944      3456.1828    
      2900   293.10951     -29320.818     -4793.082       3456.8701    
      3000   312.15447     -29312.131      5980.5878      3457.5575    
      3100   311.75718     -29298.24      -248.09658      3458.2449    
      3200   309.67398     -29305.117     -8243.2313      3458.9323    
      3300   284.16455     -29320.802     -1017.9257      3459.6197    
      3400   290.84609     -29328.046      991.24588      3460.3071    
      3500   309.58173     -29330.571     -2209.832       3460.9945    
      3600   314.57307     -29312.824      5720.4127      3461.6819    
      3700   310.50322     -29302.289      8724.4396      3462.3692    
      3800   293.25167     -29308.438      7620.1949      3463.0566    
      3900   292.0436      -29331.108     -4863.9227      3463.744     
      4000   279.69029     -29314.477     -12662.154      3464.4314    
      4100   299.30969     -29318.336     -5295.3646      3465.1188    
      4200   306.41302     -29309.997     -3119.3285      3465.8062    
      4300   304.48927     -29309.066      2170.3776      3466.4936    
      4400   305.27634     -29335.586     -3921.7959      3467.181     
      4500   282.89076     -29330.734      1782.1071      3467.8683    
      4600   295.72621     -29337.354      4975.4003      3468.5557    
      4700   307.49704     -29316.641      3855.8595      3469.2431    
      4800   311.80502     -29312.119     -2587.4713      3469.9305    
      4900   294.06789     -29298.52      -5864.5997      3470.6179    
      5000   314.206       -29330.582     -6280.8374      3471.3053    
Loop time of 180.651 on 16 procs for 5000 steps with 310 atoms

Performance: 1.196 ns/day, 20.072 hours/ns, 27.678 timesteps/s, 8.580 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 108.89     | 140.37     | 160.29     | 179.6 | 77.70
Bond    | 0.012196   | 0.013384   | 0.014184   |   0.5 |  0.01
Neigh   | 1.6226     | 2.0487     | 2.3026     |  20.9 |  1.13
Comm    | 2.324      | 22.21      | 53.675     | 451.3 | 12.29
Output  | 0.014599   | 0.036996   | 0.086395   |  13.5 |  0.02
Modify  | 15.581     | 15.855     | 16.307     |   7.8 |  8.78
Other   |            | 0.1167     |            |       |  0.06

Nlocal:          38.75 ave          44 max          34 min
Histogram: 1 1 0 1 1 2 0 0 0 2
Nghost:        3123.38 ave        3170 max        3064 min
Histogram: 1 1 0 1 1 0 1 0 1 2
Neighs:          24228 ave       27423 max       21380 min
Histogram: 1 1 1 1 1 1 0 0 0 2

Total # of neighbors = 193824
Ave neighs/atom = 625.23871
Ave special neighs/atom = 0
Neighbor list builds = 85
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 15.4114
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.3384)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.4114
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.2027000000000001023, deltaxy = 0.072027
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.8261000000000000565, deltaxz = 0.018261
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.33839999999999997859, deltayz = -0.003384
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -0.154114 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz 100 dump/neg_deform4.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 124.1 | 126.8 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   296.39562     -29291.64       4312.9669      3436.9359    
       100   296.40588     -29300.667      5783.4822      3436.9359    
       200   294.36499     -29330.97      -13026.326      3436.9359    
       300   308.37344     -29349.836      5765.2563      3436.9359    
       400   271.67794     -29307.833      4983.9095      3436.9359    
       500   300.11537     -29313.846      2647.3428      3436.9359    
       600   299.11664     -29302.716      11690.313      3436.9359    
       700   321.78591     -29324.204     -5315.322       3436.9359    
       800   331.86262     -29342.844      4316.7225      3436.9359    
       900   295.40884     -29320.942     -6710.4431      3436.9359    
      1000   283.40646     -29309.478      655.33745      3436.9359    
      1100   298.38875     -29315.611      8888.4396      3436.9359    
      1200   310.30958     -29315.172     -2290.4313      3436.9359    
      1300   281.04198     -29281.385     -7778.6818      3436.9359    
      1400   290.89812     -29311.52      -629.33266      3436.9359    
      1500   305.0264      -29348.978      10674.946      3436.9359    
      1600   299.80086     -29344.76       11489.326      3436.9359    
      1700   302.44314     -29325.677     -3232.9927      3436.9359    
      1800   315.54545     -29315.735      3764.0137      3436.9359    
      1900   302.60729     -29306.057      4966.0506      3436.9359    
      2000   311.3865      -29314.664      8067.0188      3436.9359    
      2100   288.65347     -29321.385      13588.743      3436.9359    
      2200   275.04229     -29325.117      9008.4675      3436.9359    
      2300   299.47473     -29334.078     -5278.3254      3436.9359    
      2400   310.62391     -29329.352     -2174.7178      3436.9359    
      2500   272.83153     -29290.226     -5920.8852      3436.9359    
      2600   297.99988     -29305.846      2470.8842      3436.9359    
      2700   292.39249     -29308.262      5580.5388      3436.9359    
      2800   276.5842      -29321.173      9843.7687      3436.9359    
      2900   284.68853     -29336.815      6831.5379      3436.9359    
      3000   304.63505     -29321.395      5777.6212      3436.9359    
      3100   300.43102     -29310.036      7222.6489      3436.9359    
      3200   312.35461     -29330.533      3516.8521      3436.9359    
      3300   289.93039     -29319.236      1970.7164      3436.9359    
      3400   283.23685     -29317.603      14554.768      3436.9359    
      3500   300.03442     -29315.012      5464.7118      3436.9359    
      3600   335.84433     -29327.401     -3288.4249      3436.9359    
      3700   312.54954     -29312.113      22477.486      3436.9359    
      3800   284.35546     -29318.288     -9008.7741      3436.9359    
      3900   310.24648     -29349.069      5392.2764      3436.9359    
      4000   307.42072     -29335.427      15152.611      3436.9359    
      4100   310.74607     -29323.971      5022.2298      3436.9359    
      4200   297.80255     -29315.43      -228.12246      3436.9359    
      4300   285.00513     -29335.531      2038.895       3436.9359    
      4400   292.08663     -29348.862     -7049.7877      3436.9359    
      4500   289.78425     -29325.128      7838.4113      3436.9359    
      4600   312.23516     -29329.555     -7319.527       3436.9359    
      4700   304.05359     -29321.132      5028.2846      3436.9359    
      4800   287.92396     -29319.26       13731.127      3436.9359    
      4900   290.71346     -29323.043     -2174.2112      3436.9359    
      5000   303.8046      -29304.329      9073.3498      3436.9359    
Loop time of 181.613 on 16 procs for 5000 steps with 310 atoms

Performance: 1.189 ns/day, 20.179 hours/ns, 27.531 timesteps/s, 8.535 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 108.84     | 140.3      | 160.74     | 187.1 | 77.25
Bond    | 0.012042   | 0.013255   | 0.014134   |   0.5 |  0.01
Neigh   | 1.6975     | 2.1249     | 2.416      |  22.1 |  1.17
Comm    | 2.2947     | 22.715     | 54.15      | 464.9 | 12.51
Output  | 0.014604   | 0.036093   | 0.085231   |  13.5 |  0.02
Modify  | 16.008     | 16.31      | 16.755     |   8.2 |  8.98
Other   |            | 0.1188     |            |       |  0.07

Nlocal:          38.75 ave          42 max          36 min
Histogram: 1 2 0 2 0 0 1 0 0 2
Nghost:        3143.38 ave        3189 max        3092 min
Histogram: 1 1 0 1 0 1 2 0 0 2
Neighs:        24495.2 ave       26431 max       22884 min
Histogram: 1 2 0 2 0 0 1 0 0 2

Total # of neighbors = 195962
Ave neighs/atom = 632.13548
Ave special neighs/atom = 0
Neighbor list builds = 88
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.4114
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 0.154114 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz 100 dump/pos_deform4.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 124.2 | 126.8 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   296.39562     -29291.64       4312.9669      3436.9359    
       100   296.40284     -29300.658      5785.7122      3436.9359    
       200   294.70478     -29331.193     -12810.263      3436.9359    
       300   308.51863     -29349.787      5684.5194      3436.9359    
       400   270.8846      -29307.089      5302.6367      3436.9359    
       500   300.42276     -29313.84       2801.2922      3436.9359    
       600   299.87988     -29303.015      11684.459      3436.9359    
       700   322.0123      -29323.882     -5297.3699      3436.9359    
       800   329.20078     -29339.992      4916.4554      3436.9359    
       900   296.68001     -29322.261     -8077.365       3436.9359    
      1000   282.53271     -29307.75      -1070.5491      3436.9359    
      1100   303.23465     -29319.275      7206.2847      3436.9359    
      1200   307.28108     -29312.973     -1655.4069      3436.9359    
      1300   293.86377     -29281.222     -12831.97       3436.9359    
      1400   324.07057     -29281.792      807.57296      3436.9359    
      1500   338.30778     -29319.401      4088.1055      3436.9359    
      1600   328.30773     -29341.587      12266.771      3436.9359    
      1700   291.60529     -29328.168     -196.42135      3436.9359    
      1800   306.07165     -29347.529      1578.1041      3436.9359    
      1900   297.27091     -29330.691      5078.2502      3436.9359    
      2000   295.61655     -29299.42      -4002.9081      3436.9359    
      2100   303.45084     -29302.297      20383.833      3436.9359    
      2200   301.17098     -29313.91       1412.7856      3436.9359    
      2300   294.13428     -29321.299     -5813.7736      3436.9359    
      2400   315.53095     -29339.026     -3596.7945      3436.9359    
      2500   312.3822      -29335.238     -3147.3645      3436.9359    
      2600   309.55003     -29336.134     -4445.7183      3436.9359    
      2700   310.76499     -29345.075     -5343.2989      3436.9359    
      2800   260.90657     -29323.432     -3558.0166      3436.9359    
      2900   280.48045     -29332.305      6577.0736      3436.9359    
      3000   284.71041     -29305.303     -8149.9198      3436.9359    
      3100   314.51235     -29320.703      11399.224      3436.9359    
      3200   308.22716     -29313.034      2832.5999      3436.9359    
      3300   316.21651     -29337.835     -17054.357      3436.9359    
      3400   278.06381     -29331.869      9783.1793      3436.9359    
      3500   297.46034     -29345.964     -3698.1194      3436.9359    
      3600   298.15979     -29334.86       4819.5169      3436.9359    
      3700   268.01738     -29288.648     -6149.4046      3436.9359    
      3800   298.80312     -29312.378     -1651.7044      3436.9359    
      3900   303.22534     -29321.434      12607.638      3436.9359    
      4000   297.14105     -29326.638      4869.0811      3436.9359    
      4100   283.11521     -29328.784      2896.3664      3436.9359    
      4200   293.83119     -29336.868      2112.6852      3436.9359    
      4300   323.88214     -29339.398      6425.8236      3436.9359    
      4400   298.85067     -29299.353      13057.569      3436.9359    
      4500   301.75219     -29305.015      3362.0107      3436.9359    
      4600   307.05825     -29339.954      5314.4161      3436.9359    
      4700   274.02725     -29328.778      10248.103      3436.9359    
      4800   298.02003     -29338.054      3168.9543      3436.9359    
      4900   285.32179     -29305.853      2420.3984      3436.9359    
      5000   314.5383      -29316.27       5622.6961      3436.9359    
Loop time of 181.226 on 16 procs for 5000 steps with 310 atoms

Performance: 1.192 ns/day, 20.136 hours/ns, 27.590 timesteps/s, 8.553 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 109.71     | 140.54     | 161.04     | 184.3 | 77.55
Bond    | 0.012284   | 0.013633   | 0.014488   |   0.7 |  0.01
Neigh   | 1.6245     | 2.0194     | 2.2697     |  20.6 |  1.11
Comm    | 2.0453     | 22.514     | 53.319     | 460.4 | 12.42
Output  | 0.014759   | 0.037833   | 0.085796   |  13.1 |  0.02
Modify  | 15.712     | 15.981     | 16.403     |   7.6 |  8.82
Other   |            | 0.12       |            |       |  0.07

Nlocal:          38.75 ave          45 max          31 min
Histogram: 1 0 0 2 0 2 0 1 0 2
Nghost:        3177.62 ave        3264 max        3084 min
Histogram: 1 1 0 1 0 1 2 0 1 1
Neighs:        24504.5 ave       28258 max       19743 min
Histogram: 1 0 0 2 1 1 0 1 0 2

Total # of neighbors = 196036
Ave neighs/atom = 632.37419
Ave special neighs/atom = 0
Neighbor list builds = 83
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 12.7411
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz--1.8261)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.7411
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.2027000000000001023, deltaxy = 0.072027
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.8261000000000000565, deltaxz = 0.018261
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.33839999999999997859, deltayz = -0.003384
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -0.127411 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz 100 dump/neg_deform5.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 124.1 | 126.8 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   296.39562     -29291.64       4312.9669      3436.9359    
       100   296.39704     -29300.659      5784.8601      3436.9359    
       200   294.5418      -29331.079     -12948.824      3436.9359    
       300   308.48182     -29349.866      5730.3349      3436.9359    
       400   271.2386      -29307.529      5334.682       3436.9359    
       500   300.45475     -29314.221      3062.3352      3436.9359    
       600   299.79028     -29303.198      13338.991      3436.9359    
       700   319.71641     -29322.309     -7030.8856      3436.9359    
       800   330.01657     -29341.041      6783.9822      3436.9359    
       900   296.51014     -29322.265     -9100.3138      3436.9359    
      1000   282.98626     -29309.107      2635.8422      3436.9359    
      1100   296.68805     -29313.519      5878.1637      3436.9359    
      1200   314.29191     -29318.799     -3199.1615      3436.9359    
      1300   291.33074     -29288.352     -12003.37       3436.9359    
      1400   304.80356     -29299.809      6109.2496      3436.9359    
      1500   310.64404     -29325.897      4460.4003      3436.9359    
      1600   294.41473     -29335.82       756.0616       3436.9359    
      1700   296.15473     -29344.009     -2996.2816      3436.9359    
      1800   300.49668     -29331.956      1644.9516      3436.9359    
      1900   299.55084     -29304.374      2840.0855      3436.9359    
      2000   311.08581     -29307.844      6893.5563      3436.9359    
      2100   291.54387     -29300.273      14075.138      3436.9359    
      2200   285.96981     -29309.618     -1560.6803      3436.9359    
      2300   288.18513     -29314.206      5558.2198      3436.9359    
      2400   297.08057     -29318.651     -1124.406       3436.9359    
      2500   311.41812     -29325.693      4103.2564      3436.9359    
      2600   305.68641     -29322.529      6386.0959      3436.9359    
      2700   291.25425     -29320.06       1755.9429      3436.9359    
      2800   259.34343     -29306.896      7442.1328      3436.9359    
      2900   288.80217     -29326.473      3745.1284      3436.9359    
      3000   314.46562     -29316.989      9631.5158      3436.9359    
      3100   295.36424     -29297.189      595.03242      3436.9359    
      3200   306.83784     -29319.284     -8007.896       3436.9359    
      3300   280.56484     -29323.433      3454.0846      3436.9359    
      3400   294.80237     -29341.296     -660.34049      3436.9359    
      3500   292.04372     -29325.114     -496.55149      3436.9359    
      3600   285.01262     -29309.894     -1927.241       3436.9359    
      3700   299.1125      -29312.265      3106.6882      3436.9359    
      3800   307.3916      -29312.491      3490.7391      3436.9359    
      3900   305.7468      -29299.826      14826.114      3436.9359    
      4000   315.41191     -29318.634     -3065.1593      3436.9359    
      4100   323.45301     -29352.33       3193.9506      3436.9359    
      4200   290.37864     -29337.479      7078.6881      3436.9359    
      4300   280.37384     -29315.428      11713.86       3436.9359    
      4400   317.81209     -29334.865      1684.8425      3436.9359    
      4500   310.63449     -29330.013      9729.8277      3436.9359    
      4600   296.28257     -29321.449      3312.8317      3436.9359    
      4700   301.76077     -29331.812      10031.081      3436.9359    
      4800   299.09515     -29327.94       2725.7838      3436.9359    
      4900   303.60314     -29316.591     -10809.389      3436.9359    
      5000   323.44264     -29320.268     -1706.993       3436.9359    
Loop time of 182.14 on 16 procs for 5000 steps with 310 atoms

Performance: 1.186 ns/day, 20.238 hours/ns, 27.451 timesteps/s, 8.510 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 109.47     | 140.69     | 161.27     | 186.5 | 77.24
Bond    | 0.012544   | 0.013728   | 0.014462   |   0.5 |  0.01
Neigh   | 1.8181     | 2.2716     | 2.5663     |  22.2 |  1.25
Comm    | 2.167      | 22.72      | 53.932     | 463.9 | 12.47
Output  | 0.014599   | 0.036737   | 0.085965   |  13.5 |  0.02
Modify  | 15.975     | 16.288     | 16.753     |   8.5 |  8.94
Other   |            | 0.119      |            |       |  0.07

Nlocal:          38.75 ave          43 max          34 min
Histogram: 1 1 0 1 2 0 0 0 1 2
Nghost:        3154.88 ave        3216 max        3082 min
Histogram: 1 1 0 1 0 0 3 0 0 2
Neighs:        24494.6 ave       27114 max       21588 min
Histogram: 1 1 0 1 2 0 0 0 1 2

Total # of neighbors = 195957
Ave neighs/atom = 632.11935
Ave special neighs/atom = 0
Neighbor list builds = 93
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.7411
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 0.127411 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz 100 dump/pos_deform5.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 124.2 | 126.8 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   296.39562     -29291.64       4312.9669      3436.9359    
       100   296.40205     -29300.662      5780.8189      3436.9359    
       200   294.53198     -29331.047     -12894.101      3436.9359    
       300   308.42307     -29349.742      5768.6394      3436.9359    
       400   271.33234     -29307.41       4959.1209      3436.9359    
       500   299.92696     -29313.309      2497.7529      3436.9359    
       600   299.70129     -29302.833      11920.021      3436.9359    
       700   323.07161     -29324.997     -5112.9883      3436.9359    
       800   332.40432     -29342.997      2387.1259      3436.9359    
       900   296.45271     -29321.843     -8403.2294      3436.9359    
      1000   281.77704     -29306.891     -1940.3772      3436.9359    
      1100   301.09906     -29317.616      6335.5101      3436.9359    
      1200   306.61754     -29316.013      2563.2115      3436.9359    
      1300   291.79393     -29296.419     -1303.0052      3436.9359    
      1400   300.36855     -29309.675     -9354.6988      3436.9359    
      1500   298.91721     -29324.335      9613.1647      3436.9359    
      1600   300.63262     -29340.624      890.75357      3436.9359    
      1700   280.6534      -29322.481      9809.7208      3436.9359    
      1800   305.47128     -29315.203      1357.1996      3436.9359    
      1900   319.41688     -29314.105     -929.59669      3436.9359    
      2000   291.61228     -29293.959      3032.229       3436.9359    
      2100   303.11449     -29321.225      13844.318      3436.9359    
      2200   283.22818     -29311.118     -2354.1253      3436.9359    
      2300   320.25818     -29329.345     -8042.4482      3436.9359    
      2400   311.65448     -29300.356     -249.70132      3436.9359    
      2500   309.42174     -29304.082     -5818.8614      3436.9359    
      2600   298.61501     -29322.506     -1707.2994      3436.9359    
      2700   274.27812     -29303.27      -594.53588      3436.9359    
      2800   313.62197     -29333.96       5910.672       3436.9359    
      2900   297.89119     -29301.049     -8539.0824      3436.9359    
      3000   316.52243     -29292.051     -302.77202      3436.9359    
      3100   314.78119     -29297.72      -7163.7212      3436.9359    
      3200   304.2326      -29320.125      1993.0038      3436.9359    
      3300   302.29303     -29326.09       5259.583       3436.9359    
      3400   295.49619     -29319.316      5339.0995      3436.9359    
      3500   292.86192     -29310.994      8748.7432      3436.9359    
      3600   319.00661     -29312.07       8042.3736      3436.9359    
      3700   323.71137     -29316.082     -2596.6785      3436.9359    
      3800   296.83808     -29325.833      8399.6338      3436.9359    
      3900   295.13487     -29332.398     -968.07455      3436.9359    
      4000   288.49574     -29314.72       8069.6532      3436.9359    
      4100   303.38274     -29314.585      8437.9823      3436.9359    
      4200   296.79087     -29306.54       8217.4816      3436.9359    
      4300   275.26974     -29308.991      6214.9325      3436.9359    
      4400   295.23459     -29339.561     -679.20763      3436.9359    
      4500   291.10262     -29325.542     -1320.8204      3436.9359    
      4600   308.9194      -29315.631      4892.5558      3436.9359    
      4700   314.76548     -29310.115     -2689.3467      3436.9359    
      4800   289.99315     -29297.147      4078.9986      3436.9359    
      4900   326.20897     -29337.223      2765.5831      3436.9359    
      5000   300.19671     -29316.85       2167.617       3436.9359    
Loop time of 181.446 on 16 procs for 5000 steps with 310 atoms

Performance: 1.190 ns/day, 20.161 hours/ns, 27.556 timesteps/s, 8.543 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 109.14     | 140.26     | 161.09     | 187.2 | 77.30
Bond    | 0.012299   | 0.013647   | 0.014744   |   0.7 |  0.01
Neigh   | 1.6364     | 2.0392     | 2.3047     |  20.8 |  1.12
Comm    | 1.9985     | 22.788     | 53.891     | 464.2 | 12.56
Output  | 0.014695   | 0.037595   | 0.086323   |  13.3 |  0.02
Modify  | 15.891     | 16.185     | 16.601     |   7.7 |  8.92
Other   |            | 0.1192     |            |       |  0.07

Nlocal:          38.75 ave          45 max          36 min
Histogram: 3 0 1 2 0 1 0 0 0 1
Nghost:        3134.62 ave        3183 max        3076 min
Histogram: 1 0 2 0 0 1 1 1 0 2
Neighs:        24472.4 ave       28059 max       22794 min
Histogram: 3 0 1 2 0 1 0 0 0 1

Total # of neighbors = 195779
Ave neighs/atom = 631.54516
Ave special neighs/atom = 0
Neighbor list builds = 84
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.5034
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--7.2027)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.5034
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.2027000000000001023, deltaxy = 0.072027
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -1.8261000000000000565, deltaxz = 0.018261
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.33839999999999997859, deltayz = -0.003384
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -0.175034 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz 100 dump/neg_deform6.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 124.1 | 126.8 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   296.39562     -29291.64       4312.9669      3436.9359    
       100   296.39726     -29300.66       5781.7456      3436.9359    
       200   294.50326     -29331.04      -12870.244      3436.9359    
       300   308.42128     -29349.416      5618.4936      3436.9359    
       400   271.0285      -29307.132      5136.7439      3436.9359    
       500   300.15861     -29313.722      2566.5318      3436.9359    
       600   300.20894     -29303.195      11053.128      3436.9359    
       700   321.43494     -29322.792     -4286.8612      3436.9359    
       800   329.70675     -29340.155      3896.3558      3436.9359    
       900   294.7611      -29319.281     -9621.6003      3436.9359    
      1000   288.35211     -29312.752     -919.97507      3436.9359    
      1100   306.52067     -29322.793      9874.3545      3436.9359    
      1200   303.78522     -29312.69       391.30211      3436.9359    
      1300   282.04016     -29275.777     -4543.5722      3436.9359    
      1400   330.22062     -29291.485      366.39137      3436.9359    
      1500   330.5186      -29315.294     -5458.7658      3436.9359    
      1600   324.29373     -29340.084     -1425.8534      3436.9359    
      1700   286.85916     -29322.253     -10823.575      3436.9359    
      1800   289.10697     -29327.675     -4437.2709      3436.9359    
      1900   301.37945     -29326.147     -1177.5834      3436.9359    
      2000   303.01971     -29297.939      3330.6288      3436.9359    
      2100   305.75661     -29301.092      15666.978      3436.9359    
      2200   318.05558     -29329.623     -497.58165      3436.9359    
      2300   298.21022     -29319.644     -2171.4521      3436.9359    
      2400   313.62901     -29336.245     -1878.1491      3436.9359    
      2500   304.77955     -29331.955      17438.917      3436.9359    
      2600   300.28506     -29332.492     -250.70153      3436.9359    
      2700   264.98915     -29312.099      3312.469       3436.9359    
      2800   296.55275     -29336.488     -1634.8449      3436.9359    
      2900   290.10057     -29304.772     -556.39563      3436.9359    
      3000   318.24242     -29318.475      807.07773      3436.9359    
      3100   303.56631     -29315.999     -1374.9911      3436.9359    
      3200   307.68137     -29335.656      5119.8215      3436.9359    
      3300   289.90668     -29353.063     -4140.6217      3436.9359    
      3400   293.57084     -29355.172      6752.6433      3436.9359    
      3500   297.67653     -29343.12       8048.1645      3436.9359    
      3600   296.48334     -29328.147     -2884.5373      3436.9359    
      3700   290.63919     -29315.82       10185.519      3436.9359    
      3800   308.99266     -29323.686      3885.1477      3436.9359    
      3900   294.11761     -29296.406      11989.363      3436.9359    
      4000   326.33255     -29304.252     -7220.779       3436.9359    
      4100   305.11644     -29297.716     -984.5692       3436.9359    
      4200   301.62357     -29323.35      -5713.5231      3436.9359    
      4300   281.36512     -29307.759      14200.405      3436.9359    
      4400   309.09794     -29325.721     -9482.6942      3436.9359    
      4500   323.85984     -29330.78       16391.416      3436.9359    
      4600   297.57409     -29302.116      9899.9353      3436.9359    
      4700   320.4728      -29328.636      3030.6787      3436.9359    
      4800   298.95709     -29335.623     -3266.2988      3436.9359    
      4900   287.50153     -29330.584     -11125.766      3436.9359    
      5000   284.39821     -29309.91      -4810.3471      3436.9359    
Loop time of 182.568 on 16 procs for 5000 steps with 310 atoms

Performance: 1.183 ns/day, 20.285 hours/ns, 27.387 timesteps/s, 8.490 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 109.5      | 140.82     | 162.22     | 188.3 | 77.13
Bond    | 0.012831   | 0.013813   | 0.014477   |   0.5 |  0.01
Neigh   | 1.6769     | 2.1043     | 2.3858     |  21.6 |  1.15
Comm    | 1.8399     | 23.23      | 54.537     | 463.4 | 12.72
Output  | 0.014873   | 0.037502   | 0.087094   |  13.4 |  0.02
Modify  | 15.944     | 16.243     | 16.69      |   8.0 |  8.90
Other   |            | 0.1185     |            |       |  0.06

Nlocal:          38.75 ave          44 max          32 min
Histogram: 1 0 0 2 0 2 0 1 0 2
Nghost:         3181.5 ave        3240 max        3134 min
Histogram: 2 1 0 0 2 1 0 0 1 1
Neighs:        24510.8 ave       27769 max       20393 min
Histogram: 1 0 0 2 0 2 0 1 0 2

Total # of neighbors = 196086
Ave neighs/atom = 632.53548
Ave special neighs/atom = 0
Neighbor list builds = 86
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.4114 12.7411 17.5034) with tilt (-7.2027 -1.8261 0.3384)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  310 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.5034
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 0.175034 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz 100 dump/pos_deform6.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 121.4 | 124.2 | 126.8 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   296.39562     -29291.64       4312.9669      3436.9359    
       100   296.40846     -29300.66       5785.3173      3436.9359    
       200   294.54621     -29331.054     -12982.562      3436.9359    
       300   308.531       -29350.087      5827.2024      3436.9359    
       400   271.60972     -29307.717      5203.3755      3436.9359    
       500   299.91563     -29313.512      3091.0727      3436.9359    
       600   298.85385     -29302.284      13374.274      3436.9359    
       700   321.90677     -29324.541     -7228.4794      3436.9359    
       800   330.18981     -29341.445      5290.1303      3436.9359    
       900   293.98498     -29320.347     -9002.7763      3436.9359    
      1000   281.40842     -29307.391      1541.9808      3436.9359    
      1100   299.14716     -29315.964      3929.7635      3436.9359    
      1200   304.94825     -29311.095     -994.79681      3436.9359    
      1300   284.12957     -29283.914     -8817.2885      3436.9359    
      1400   289.36271     -29304.705      1514.7719      3436.9359    
      1500   302.83538     -29344.747      10412.027      3436.9359    
      1600   304.13905     -29358.246      10334.233      3436.9359    
      1700   293.06961     -29343.55       2218.1016      3436.9359    
      1800   306.62817     -29326.455      9438.0762      3436.9359    
      1900   301.24022     -29309.86       1414.9118      3436.9359    
      2000   309.5138      -29322.367     -8589.3613      3436.9359    
      2100   282.25648     -29307.785      12742.37       3436.9359    
      2200   281.23519     -29329.186      9918.0337      3436.9359    
      2300   291.26674     -29353.423     -342.01446      3436.9359    
      2400   306.97709     -29342.072     -1039.5414      3436.9359    
      2500   306.13627     -29326.042     -4349.9791      3436.9359    
      2600   325.02225     -29347.521      4084.6571      3436.9359    
      2700   291.12136     -29323.961      1359.6625      3436.9359    
      2800   291.14028     -29328.752      3639.0083      3436.9359    
      2900   307.33097     -29343.048     -141.48121      3436.9359    
      3000   299.37407     -29319.993     -9531.817       3436.9359    
      3100   313.24686     -29312.237     -2747.7649      3436.9359    
      3200   315.4361      -29315.974     -21613.616      3436.9359    
      3300   282.14187     -29319.891      17674.784      3436.9359    
      3400   302.69269     -29354.631     -486.19582      3436.9359    
      3500   294.90361     -29333.537      6252.9486      3436.9359    
      3600   308.81581     -29328.143      1916.4701      3436.9359    
      3700   305.24541     -29316.602      11394.36       3436.9359    
      3800   307.23777     -29328.867     -2535.7131      3436.9359    
      3900   280.25882     -29307.704      4024.5543      3436.9359    
      4000   302.97422     -29327.904      7421.8411      3436.9359    
      4100   302.55451     -29316.432     -10144.025      3436.9359    
      4200   321.34494     -29327.335      7063.6428      3436.9359    
      4300   294.46895     -29307.85       10138.745      3436.9359    
      4400   296.92882     -29326.635      3568.1851      3436.9359    
      4500   287.43449     -29331.995      1040.1057      3436.9359    
      4600   263.31817     -29329.923     -10697.29       3436.9359    
      4700   277.45383     -29335.899      4658.691       3436.9359    
      4800   307.51883     -29326.854      714.11832      3436.9359    
      4900   288.07426     -29302.664      2371.4705      3436.9359    
      5000   317.17403     -29325.722      2607.1714      3436.9359    
Loop time of 181.583 on 16 procs for 5000 steps with 310 atoms

Performance: 1.190 ns/day, 20.176 hours/ns, 27.536 timesteps/s, 8.536 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 108.69     | 140.19     | 161.17     | 187.8 | 77.21
Bond    | 0.012316   | 0.013607   | 0.014431   |   0.6 |  0.01
Neigh   | 1.623      | 2.0516     | 2.3178     |  21.3 |  1.13
Comm    | 2.0826     | 23.038     | 54.521     | 463.1 | 12.69
Output  | 0.015077   | 0.038686   | 0.090638   |  13.8 |  0.02
Modify  | 15.848     | 16.13      | 16.576     |   7.8 |  8.88
Other   |            | 0.1197     |            |       |  0.07

Nlocal:          38.75 ave          45 max          33 min
Histogram: 2 0 0 1 1 2 0 0 1 1
Nghost:        3134.88 ave        3176 max        3091 min
Histogram: 1 0 1 0 3 0 1 0 0 2
Neighs:        24509.6 ave       28164 max       20946 min
Histogram: 2 0 0 1 1 1 1 0 1 1

Total # of neighbors = 196077
Ave neighs/atom = 632.50645
Ave special neighs/atom = 0
Neighbor list builds = 85
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:36:31
