LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
# boundary        s s s
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 0.1
variable FF string "SiOCHN_2018.ff C H O Si"          # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff C H O Si
# pair_coeff * * CHOSiNa.ff C H O Si
# pair_coeff * * SiOCHN_2018.ff C H O Si
# pair_coeff * * PDMSDecomp.ff C H O Si
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# Read the initial sctructure
# box tilt large
variable structure string 333-HD-100C-20_eq

read_data       ${structure}.data
read_data       333-HD-100C-20_eq.data
Reading data file ...
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  366 atoms
  reading velocities ...
  366 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.010 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400

# # Energy minimization
# print "*****Minimization starts.*****"
# minimize 1.0e-6 1.0e-6 100 1000
# min_style cg
# # Save the optimized structure
# write_data ${structure}_opt.data
# velocity        all create ${temp} ${seed} dist gaussian

# # Equilibration
# include ff.mod.lmp
# if "$(is_defined(fix,avgp))" then "unfix avgp"
# if "$(is_defined(fix,avgl))" then "unfix avgl"
# thermo_style custom step temp pe press density vol
# run ${nequil}
# # Save the equilibrated structure
# write_data ${structure}_eq.data

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.1249
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.4224
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 16.909

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal -0.6491
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 0.6162
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -8.2539

# Write restart
write_restart equil.res
System init for write_restart ...
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 16.1249
variable dlen equal lx-${len0}
variable dlen equal lx-16.1249
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.1249
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.2538999999999997925, deltaxy = 0.082539
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.61619999999999996998, deltaxz = -0.006162
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6491000000000000103, deltayz = 0.006491
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.161249 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.161249 xy delta 0.082539 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.161249 xy delta 0.082539 xz delta -0.006162 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz 100 dump/neg_deform1.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.7 | 140.4 | 141.9 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   320.26895     -41083.125     -8623.3128      3659.697     
       100   312.33133     -41084.377     -2405.6779      3658.9651    
       200   291.99358     -41097.26      -5521.5457      3658.2331    
       300   286.89675     -41092.733      9977.1381      3657.5012    
       400   295.73234     -41086.438      1160.9296      3656.7693    
       500   309.2159      -41092         -11095.867      3656.0373    
       600   290.99318     -41074.937     -9907.8753      3655.3054    
       700   280.65943     -41080.861      2457.1155      3654.5734    
       800   284.1946      -41105.375      249.09887      3653.8415    
       900   276.16238     -41088.672     -5671.8525      3653.1096    
      1000   294.55564     -41072.377      2404.4923      3652.3776    
      1100   302.07659     -41073.518      3123.9932      3651.6457    
      1200   291.78891     -41077.936      3740.3862      3650.9137    
      1300   302.98548     -41107.508     -4591.9814      3650.1818    
      1400   287.29063     -41100.831      1326.347       3649.4499    
      1500   298.02052     -41090.527      287.8158       3648.7179    
      1600   312.31288     -41072.046     -1323.1587      3647.986     
      1700   305.95151     -41066.989     -2866.2994      3647.254     
      1800   296.00587     -41085.422     -3931.2385      3646.5221    
      1900   278.72145     -41078.888     -2600.0061      3645.7902    
      2000   307.00949     -41101.846      449.89051      3645.0582    
      2100   304.66598     -41098.009     -4609.3825      3644.3263    
      2200   279.74879     -41071.624     -9246.1858      3643.5943    
      2300   304.76071     -41092.221     -6038.2993      3642.8624    
      2400   313.36168     -41101.495      1833.0425      3642.1305    
      2500   293.37235     -41091.934     -6369.3534      3641.3985    
      2600   293.60608     -41101.168     -873.2837       3640.6666    
      2700   291.70594     -41099.55      -412.95654      3639.9346    
      2800   306.58114     -41093.014     -1277.4656      3639.2027    
      2900   306.942       -41079.65       6736.9944      3638.4708    
      3000   299.35257     -41082.579      9093.6063      3637.7388    
      3100   289.82051     -41105.446      24068.339      3637.0069    
      3200   283.11375     -41105.366     -3233.3643      3636.2749    
      3300   279.31926     -41083.081     -4368.9134      3635.543     
      3400   286.89537     -41074.515      18328.883      3634.8111    
      3500   283.57991     -41068.344     -369.7238       3634.0791    
      3600   295.5734      -41086.076      3190.3805      3633.3472    
      3700   300.54252     -41101.318     -7416.6046      3632.6153    
      3800   282.17463     -41087.954     -10566.153      3631.8833    
      3900   285.74768     -41096.749     -2446.203       3631.1514    
      4000   307.69759     -41105.648     -13010.501      3630.4194    
      4100   334.0421      -41104.476      3566.707       3629.6875    
      4200   314.22107     -41084.517     -952.71819      3628.9556    
      4300   298.29456     -41089.513      19232.019      3628.2236    
      4400   296.17457     -41100.273      3896.0414      3627.4917    
      4500   310.59749     -41114.467     -3146.202       3626.7597    
      4600   312.60014     -41107.62       9206.4615      3626.0278    
      4700   297.14895     -41082.855     -2992.7145      3625.2959    
      4800   319.68151     -41077.562      5721.926       3624.5639    
      4900   315.49573     -41072.784      7344.6144      3623.832     
      5000   305.77583     -41096.466      933.29123      3623.1       
Loop time of 233.524 on 16 procs for 5000 steps with 366 atoms

Performance: 0.925 ns/day, 25.947 hours/ns, 21.411 timesteps/s, 7.836 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 148.86     | 167.71     | 209.45     | 174.3 | 71.82
Bond    | 0.012011   | 0.012946   | 0.013966   |   0.5 |  0.01
Neigh   | 1.4027     | 1.5853     | 2.0515     |  18.3 |  0.68
Comm    | 3.1164     | 44.919     | 63.707     | 336.8 | 19.24
Output  | 0.014072   | 0.03555    | 0.079167   |  12.2 |  0.02
Modify  | 18.7       | 19.144     | 19.379     |   5.4 |  8.20
Other   |            | 0.1224     |            |       |  0.05

Nlocal:          45.75 ave          52 max          37 min
Histogram: 1 0 0 0 2 0 2 1 1 1
Nghost:        3608.12 ave        3639 max        3577 min
Histogram: 2 2 0 0 0 0 0 0 2 2
Neighs:        32407.8 ave       36640 max       26598 min
Histogram: 1 0 0 2 0 0 2 1 1 1

Total # of neighbors = 259262
Ave neighs/atom = 708.36612
Ave special neighs/atom = 0
Neighbor list builds = 57
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.1249
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.161249 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.161249 xy delta -0.082539 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.161249 xy delta -0.082539 xz delta 0.006162 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz 100 dump/pos_deform1.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.7 | 140.4 | 141.9 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   320.26895     -41083.125     -8623.3128      3659.697     
       100   312.32975     -41084.376     -2404.8778      3660.4289    
       200   292.54935     -41097.746     -5834.4553      3661.1609    
       300   286.15379     -41091.651      10048.063      3661.8928    
       400   299.39918     -41090.058      273.39653      3662.6248    
       500   303.59356     -41083.469     -438.39353      3663.3567    
       600   289.76437     -41071.898     -14535.075      3664.0886    
       700   291.79245     -41091.344     -2073.5303      3664.8206    
       800   281.35811     -41103.446     -9691.7168      3665.5525    
       900   285.81654     -41094.875     -8127.1204      3666.2845    
      1000   299.37939     -41077.615      120.34083      3667.0164    
      1100   309.85818     -41081.841      4194.1376      3667.7483    
      1200   277.46066     -41067.516      4477.7711      3668.4803    
      1300   303.81218     -41100.182     -5369.9615      3669.2122    
      1400   287.24707     -41092.801     -9411.2629      3669.9442    
      1500   288.75665     -41102.935     -11011.199      3670.6761    
      1600   315.35127     -41105.545     -4825.0693      3671.408     
      1700   318.94491     -41089.381     -6348.3351      3672.14      
      1800   311.21989     -41081.745     -2872.8029      3672.8719    
      1900   280.52975     -41076.122      1576.6242      3673.6039    
      2000   275.22742     -41085.292      835.98661      3674.3358    
      2100   283.80549     -41084.399     -7708.5748      3675.0677    
      2200   298.40551     -41087.626     -4340.4672      3675.7997    
      2300   297.63189     -41075.669     -8584.3317      3676.5316    
      2400   302.67269     -41074.403     -3520.5578      3677.2636    
      2500   297.92327     -41075.848     -11072.397      3677.9955    
      2600   301.61308     -41103.584     -7387.7815      3678.7274    
      2700   285.06486     -41087.214      4619.4757      3679.4594    
      2800   313.87623     -41088.834     -8687.6066      3680.1913    
      2900   306.00868     -41066.576     -12830.784      3680.9233    
      3000   313.32646     -41078.053     -12358.71       3681.6552    
      3100   308.13127     -41085.963     -7463.5685      3682.3871    
      3200   286.66687     -41078.235     -390.36189      3683.1191    
      3300   268.3547      -41092.988     -2168.3358      3683.851     
      3400   295.78241     -41113.05      -1524.197       3684.5829    
      3500   305.72996     -41093.112     -9630.0615      3685.3149    
      3600   309.09041     -41086.312     -21788.533      3686.0468    
      3700   303.40391     -41069.652     -16354.485      3686.7788    
      3800   313.64326     -41076.804     -1094.3333      3687.5107    
      3900   296.87365     -41071.657      6147.7251      3688.2426    
      4000   293.38958     -41091.672     -5304.3636      3688.9746    
      4100   293.02541     -41096.979     -9500.8851      3689.7065    
      4200   295.2291      -41074.591     -5771.1089      3690.4385    
      4300   297.44353     -41047.074     -14590.169      3691.1704    
      4400   311.66468     -41061.156     -7457.2198      3691.9023    
      4500   304.43022     -41067.257     -4270.4531      3692.6343    
      4600   303.63626     -41094.336     -7390.9407      3693.3662    
      4700   291.25877     -41100.354      2983.8459      3694.0982    
      4800   300.58234     -41101.589     -16523.267      3694.8301    
      4900   297.00685     -41083.547     -11584.33       3695.562     
      5000   317.37242     -41086.324     -478.66846      3696.294     
Loop time of 231.417 on 16 procs for 5000 steps with 366 atoms

Performance: 0.933 ns/day, 25.713 hours/ns, 21.606 timesteps/s, 7.908 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 147.45     | 163.84     | 208.74     | 199.9 | 70.80
Bond    | 0.012337   | 0.013316   | 0.014964   |   0.8 |  0.01
Neigh   | 1.3243     | 1.4956     | 1.9361     |  19.2 |  0.65
Comm    | 1.6789     | 46.62      | 63.013     | 374.7 | 20.15
Output  | 0.014511   | 0.036216   | 0.080631   |  12.3 |  0.02
Modify  | 18.831     | 19.251     | 19.453     |   5.5 |  8.32
Other   |            | 0.1653     |            |       |  0.07

Nlocal:          45.75 ave          54 max          39 min
Histogram: 1 0 2 1 1 1 0 0 1 1
Nghost:        3514.75 ave        3541 max        3490 min
Histogram: 1 3 0 0 0 0 1 0 1 2
Neighs:        31699.8 ave       37305 max       27270 min
Histogram: 1 2 0 1 1 1 0 0 1 1

Total # of neighbors = 253598
Ave neighs/atom = 692.89071
Ave special neighs/atom = 0
Neighbor list builds = 55
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.4224
variable dlen equal ly-${len0}
variable dlen equal ly-13.4224
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4224
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.2538999999999997925, deltaxy = 0.082539
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.61619999999999996998, deltaxz = -0.006162
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6491000000000000103, deltayz = 0.006491
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.134224 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.134224 yz delta 0.006491 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz 100 dump/neg_deform2.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.7 | 140.4 | 141.9 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   320.26895     -41083.125     -8623.3128      3659.697     
       100   312.32958     -41084.378     -2405.6597      3658.9651    
       200   292.44761     -41097.313     -5634.2781      3658.2331    
       300   286.99935     -41092.256      9746.6077      3657.5012    
       400   300.52019     -41090.331      461.71367      3656.7693    
       500   308.36064     -41088.833      2848.6253      3656.0373    
       600   296.09596     -41077.165     -9161.2526      3655.3054    
       700   297.12414     -41091.965      4878.0095      3654.5734    
       800   294.96151     -41107.09       5025.1902      3653.8415    
       900   280.35201     -41083.61      -6448.8543      3653.1096    
      1000   306.96439     -41080.852     -152.18514      3652.3776    
      1100   309.12861     -41077.448      4547.9         3651.6457    
      1200   290.99768     -41076.446     -6084.3877      3650.9137    
      1300   308.8038      -41110.672     -4172.3764      3650.1818    
      1400   291.98096     -41100.453      3016.9811      3649.4499    
      1500   289.10801     -41085.721     -5250.7129      3648.7179    
      1600   290.8083      -41077.319      163.57284      3647.986     
      1700   317.66752     -41095.871     -579.77522      3647.254     
      1800   288.58932     -41060.363      2335.5361      3646.5221    
      1900   276.97663     -41060.954      3485.1715      3645.7902    
      2000   296.87764     -41111.308     -5877.1613      3645.0582    
      2100   281.1122      -41107.141     -1355.5709      3644.3263    
      2200   299.07295     -41104.771      6173.1401      3643.5943    
      2300   297.27858     -41084.39      -6383.1442      3642.8624    
      2400   297.48494     -41082.821     -2156.4832      3642.1305    
      2500   305.25008     -41092.633     -2084.5226      3641.3985    
      2600   294.7078      -41073.285     -9123.5186      3640.6666    
      2700   330.01991     -41081.177     -10810.359      3639.9346    
      2800   312.11918     -41053.12       548.10308      3639.2027    
      2900   307.71107     -41085.837      14071.466      3638.4708    
      3000   289.2252      -41080.25      -2479.7105      3637.7388    
      3100   294.40729     -41086.367      258.98327      3637.0069    
      3200   297.92285     -41090.635     -9948.7828      3636.2749    
      3300   297.89393     -41077.666      1447.2612      3635.543     
      3400   332.13189     -41088.521      4705.0281      3634.8111    
      3500   299.71334     -41054.164     -3768.2375      3634.0791    
      3600   292.38852     -41082.906     -2766.2068      3633.3472    
      3700   294.084       -41100.028     -3338.7078      3632.6153    
      3800   304.85008     -41101.201     -5529.7855      3631.8833    
      3900   298.27638     -41079.218     -12284.033      3631.1514    
      4000   316.99884     -41082.533      1876.1119      3630.4194    
      4100   325.08642     -41095.656     -2360.8377      3629.6875    
      4200   291.84313     -41096.497     -6294.7376      3628.9556    
      4300   300.77237     -41111.074      798.68389      3628.2236    
      4400   287.61963     -41084.033     -2415.2468      3627.4917    
      4500   306.81662     -41073.051      2416.7279      3626.7597    
      4600   319.99403     -41078.024     -11359.424      3626.0278    
      4700   298.76201     -41073.003      1229.8256      3625.2959    
      4800   300.97665     -41101.101      4130.5037      3624.5639    
      4900   284.70303     -41087.709     -9121.8613      3623.832     
      5000   296.47247     -41092.733     -4888.851       3623.1       
Loop time of 234.723 on 16 procs for 5000 steps with 366 atoms

Performance: 0.920 ns/day, 26.080 hours/ns, 21.302 timesteps/s, 7.796 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 149.53     | 167.52     | 211.69     | 195.0 | 71.37
Bond    | 0.011914   | 0.013135   | 0.014565   |   0.7 |  0.01
Neigh   | 1.3481     | 1.5212     | 1.9774     |  19.9 |  0.65
Comm    | 2.0365     | 46.264     | 64.186     | 371.2 | 19.71
Output  | 0.014354   | 0.035457   | 0.078608   |  12.0 |  0.02
Modify  | 18.818     | 19.249     | 19.477     |   5.7 |  8.20
Other   |            | 0.1217     |            |       |  0.05

Nlocal:          45.75 ave          52 max          33 min
Histogram: 1 0 0 0 1 0 2 0 3 1
Nghost:        3619.25 ave        3650 max        3592 min
Histogram: 1 0 2 0 3 0 0 0 1 1
Neighs:        32333.8 ave       36417 max       23806 min
Histogram: 1 0 0 0 1 0 2 0 2 2

Total # of neighbors = 258670
Ave neighs/atom = 706.74863
Ave special neighs/atom = 0
Neighbor list builds = 55
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4224
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.134224 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.134224 yz delta -0.006491 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz 100 dump/pos_deform2.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.7 | 140.4 | 141.9 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   320.26895     -41083.125     -8623.3128      3659.697     
       100   312.33149     -41084.375     -2404.9009      3660.4289    
       200   292.03894     -41097.688     -5768.3745      3661.1609    
       300   286.60366     -41093.092      9862.0618      3661.8928    
       400   299.31937     -41091.292      765.15567      3662.6248    
       500   309.61798     -41089.928     -5655.2698      3663.3567    
       600   298.39547     -41077.21      -13902.801      3664.0886    
       700   291.12062     -41076.838      3164.5811      3664.8206    
       800   291.25704     -41094.913      2701.9335      3665.5525    
       900   286.02853     -41094.168     -10454.538      3666.2845    
      1000   296.27277     -41083.711     -5053.1885      3667.0164    
      1100   310.82446     -41077.982      2882.4456      3667.7483    
      1200   315.78365     -41091.121     -5828.0993      3668.4803    
      1300   296.4095      -41085.033      720.73339      3669.2122    
      1400   270.14576     -41088.202      6066.2748      3669.9442    
      1500   284.39233     -41117.154     -3288.7995      3670.6761    
      1600   286.60955     -41105.488     -1019.5523      3671.408     
      1700   285.44737     -41088.177     -4097.4879      3672.14      
      1800   315.80772     -41095.546     -2042.7406      3672.8719    
      1900   309.16876     -41079.496     -13248.789      3673.6039    
      2000   297.34931     -41072.259     -9664.2469      3674.3358    
      2100   299.70277     -41080.99       2759.7653      3675.0677    
      2200   292.11145     -41073.691     -12462.124      3675.7997    
      2300   325.33908     -41097.533      478.92728      3676.5316    
      2400   297.20077     -41070.521     -8179.5289      3677.2636    
      2500   277.30762     -41076.391     -3552.9761      3677.9955    
      2600   282.12648     -41093.236      7034.6462      3678.7274    
      2700   311.21934     -41102.647     -861.41555      3679.4594    
      2800   300.72962     -41063.862     -16830.2        3680.1913    
      2900   309.48156     -41080.193      3157.5265      3680.9233    
      3000   305.71062     -41089.732     -3820.2024      3681.6552    
      3100   292.38908     -41086.28      -1579.04        3682.3871    
      3200   299.31168     -41093.9       -1841.3596      3683.1191    
      3300   301.30225     -41064.192     -2393.7976      3683.851     
      3400   310.2999      -41068.519     -2695.5937      3684.5829    
      3500   285.2577      -41058.382     -1857.9911      3685.3149    
      3600   284.64714     -41086.096     -13027.548      3686.0468    
      3700   281.34542     -41095.403     -5179.8839      3686.7788    
      3800   296.56029     -41100.509      1461.1344      3687.5107    
      3900   311.36395     -41101.227     -5258.5786      3688.2426    
      4000   312.03738     -41089.145     -7734.0566      3688.9746    
      4100   307.67107     -41069.493     -3885.3942      3689.7065    
      4200   342.06352     -41072.684     -577.43672      3690.4385    
      4300   311.86962     -41054.64      -1472.7627      3691.1704    
      4400   319.12879     -41090.452     -9582.6614      3691.9023    
      4500   296.64517     -41082.909      3976.9045      3692.6343    
      4600   301.65214     -41089.022     -4587.9468      3693.3662    
      4700   283.76032     -41065.202     -8015.0804      3694.0982    
      4800   312.31044     -41068.196     -10562.914      3694.8301    
      4900   333.04085     -41073.341     -4883.7222      3695.562     
      5000   301.35277     -41056.164     -11650.761      3696.294     
Loop time of 234.488 on 16 procs for 5000 steps with 366 atoms

Performance: 0.921 ns/day, 26.054 hours/ns, 21.323 timesteps/s, 7.804 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 145.75     | 170.9      | 210.41     | 224.4 | 72.88
Bond    | 0.012446   | 0.013201   | 0.014915   |   0.7 |  0.01
Neigh   | 1.4046     | 1.664      | 2.0731     |  20.8 |  0.71
Comm    | 2.4842     | 42.034     | 67.213     | 452.4 | 17.93
Output  | 0.016107   | 0.043615   | 0.1002     |  14.2 |  0.02
Modify  | 19.271     | 19.651     | 19.964     |   6.3 |  8.38
Other   |            | 0.1827     |            |       |  0.08

Nlocal:          45.75 ave          51 max          38 min
Histogram: 1 0 0 2 0 0 1 2 1 1
Nghost:         3505.5 ave        3539 max        3476 min
Histogram: 1 2 0 1 0 1 0 2 0 1
Neighs:        31742.2 ave       35321 max       26544 min
Histogram: 1 0 0 2 0 0 1 2 1 1

Total # of neighbors = 253938
Ave neighs/atom = 693.81967
Ave special neighs/atom = 0
Neighbor list builds = 59
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 16.909
variable dlen equal lz-${len0}
variable dlen equal lz-16.909
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.909
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.2538999999999997925, deltaxy = 0.082539
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.61619999999999996998, deltaxz = -0.006162
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6491000000000000103, deltayz = 0.006491
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -0.16909 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz 100 dump/neg_deform3.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.7 | 140.4 | 141.9 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   320.26895     -41083.125     -8623.3128      3659.697     
       100   312.33038     -41084.37      -2406.1401      3658.9651    
       200   292.64791     -41097.591     -5822.4069      3658.2331    
       300   285.78852     -41091.414      9142.2973      3657.5012    
       400   299.16555     -41090.315     -1258.4258      3656.7693    
       500   307.32073     -41088.893     -4550.2712      3656.0373    
       600   293.6755      -41076.623     -10555.128      3655.3054    
       700   293.8512      -41087.145      5182.4232      3654.5734    
       800   279.09847     -41082.93       1189.0889      3653.8415    
       900   280.92981     -41076.191     -1685.9884      3653.1096    
      1000   296.18486     -41064.048     -762.71893      3652.3776    
      1100   298.07261     -41058.635      7670.1283      3651.6457    
      1200   313.06185     -41092.891      2507.5825      3650.9137    
      1300   316.71964     -41111.291      4704.8813      3650.1818    
      1400   284.35393     -41084.542      7806.5222      3649.4499    
      1500   316.39359     -41108.275     -2801.4518      3648.7179    
      1600   306.82634     -41085.759      2064.84        3647.986     
      1700   298.12219     -41071.799      12615.776      3647.254     
      1800   305.80397     -41084.124      2465.2836      3646.5221    
      1900   278.09146     -41092.059      8293.6485      3645.7902    
      2000   295.87344     -41117.777     -5009.3437      3645.0582    
      2100   294.18764     -41088.875     -3731.593       3644.3263    
      2200   303.64192     -41079.235      178.73032      3643.5943    
      2300   295.23951     -41070.013     -607.05617      3642.8624    
      2400   304.16625     -41094.253      2863.8714      3642.1305    
      2500   279.27377     -41099.199     -1010.8174      3641.3985    
      2600   290.59102     -41109.909      2709.1732      3640.6666    
      2700   294.51893     -41095.272      3961.3937      3639.9346    
      2800   290.12318     -41078.441     -1624.6206      3639.2027    
      2900   313.46882     -41103.504      10222.718      3638.4708    
      3000   289.63666     -41098.334      4721.5126      3637.7388    
      3100   273.23421     -41111.692      11557.158      3637.0069    
      3200   290.14684     -41115.804      8778.5279      3636.2749    
      3300   288.69662     -41091.527     -3169.5841      3635.543     
      3400   289.22829     -41080.951     -737.33662      3634.8111    
      3500   305.95904     -41089.793     -3893.2166      3634.0791    
      3600   297.48288     -41077.493     -11619.383      3633.3472    
      3700   321.72434     -41096.043      11915.039      3632.6153    
      3800   299.51898     -41084.873      1575.3018      3631.8833    
      3900   301.06758     -41109.887      15746.847      3631.1514    
      4000   296.20349     -41109.779      5812.1013      3630.4194    
      4100   310.25747     -41095.34       4797.8699      3629.6875    
      4200   301.77063     -41070.768     -473.25492      3628.9556    
      4300   288.1885      -41061.313      1666.6548      3628.2236    
      4400   308.47693     -41094.399      2585.1049      3627.4917    
      4500   296.61405     -41097.881     -1356.1166      3626.7597    
      4600   275.85331     -41098.27       1002.7986      3626.0278    
      4700   284.60483     -41121.632      2203.3188      3625.2959    
      4800   295.16346     -41104.132     -1748.4892      3624.5639    
      4900   299.52913     -41084.999     -1472.0245      3623.832     
      5000   283.16152     -41062.936     -12624.295      3623.1       
Loop time of 237.312 on 16 procs for 5000 steps with 366 atoms

Performance: 0.910 ns/day, 26.368 hours/ns, 21.069 timesteps/s, 7.711 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 149.79     | 177.2      | 211.97     | 206.9 | 74.67
Bond    | 0.012256   | 0.013193   | 0.015345   |   0.8 |  0.01
Neigh   | 1.3629     | 1.6451     | 2.0186     |  20.4 |  0.69
Comm    | 3.8212     | 38.654     | 66.08      | 442.9 | 16.29
Output  | 0.015912   | 0.042686   | 0.097874   |  14.0 |  0.02
Modify  | 19.257     | 19.632     | 19.972     |   6.3 |  8.27
Other   |            | 0.1285     |            |       |  0.05

Nlocal:          45.75 ave          53 max          39 min
Histogram: 2 1 0 0 1 0 0 3 0 1
Nghost:        3605.12 ave        3624 max        3580 min
Histogram: 2 0 0 1 0 1 0 0 3 1
Neighs:        32366.9 ave       37330 max       27986 min
Histogram: 2 1 0 0 1 0 2 0 1 1

Total # of neighbors = 258935
Ave neighs/atom = 707.47268
Ave special neighs/atom = 0
Neighbor list builds = 56
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.909
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 0.16909 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz 100 dump/pos_deform3.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.7 | 140.4 | 141.9 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   320.26895     -41083.125     -8623.3128      3659.697     
       100   312.33077     -41084.383     -2404.285       3660.4289    
       200   292.15627     -41097.335     -5670.3795      3661.1609    
       300   287.24791     -41092.958      9443.8701      3661.8928    
       400   297.2906      -41087.703      2303.9257      3662.6248    
       500   306.79589     -41086.604     -5973.6425      3663.3567    
       600   296.31374     -41074.279     -8135.6448      3664.0886    
       700   286.29891     -41080.282     -2035.8108      3664.8206    
       800   285.8087      -41105.956      7996.1758      3665.5525    
       900   279.39584     -41090.222     -7393.5674      3666.2845    
      1000   300.16848     -41080.47      -567.58718      3667.0164    
      1100   297.40813     -41070.708      2724.1071      3667.7483    
      1200   292.92342     -41077.775      2609.4411      3668.4803    
      1300   301.81659     -41097.567     -10808.557      3669.2122    
      1400   281.13667     -41082.415     -5772.9748      3669.9442    
      1500   289.42795     -41100.01       5188.6353      3670.6761    
      1600   300.79778     -41104.292     -583.91999      3671.408     
      1700   302.33756     -41075.427     -13826.667      3672.14      
      1800   303.06531     -41065.786     -2719.6062      3672.8719    
      1900   296.88216     -41063.586     -1715.3671      3673.6039    
      2000   308.52585     -41110.987     -5288.5423      3674.3358    
      2100   297.57023     -41114.372     -10827.063      3675.0677    
      2200   288.73765     -41096.91      -5127.148       3675.7997    
      2300   300.39394     -41093.854     -15105.753      3676.5316    
      2400   304.10775     -41080.087     -9650.4675      3677.2636    
      2500   283.43636     -41054.432     -5475.4773      3677.9955    
      2600   295.22036     -41069.984     -9884.7426      3678.7274    
      2700   311.92117     -41091.77      -124.43255      3679.4594    
      2800   274.45488     -41077.495     -2269.1904      3680.1913    
      2900   276.98218     -41095.568     -3628.5579      3680.9233    
      3000   309.35243     -41104.362     -1124.2783      3681.6552    
      3100   314.12505     -41097.493     -4793.9412      3682.3871    
      3200   308.55745     -41084.8       -3008.0467      3683.1191    
      3300   299.287       -41080.33       2495.5529      3683.851     
      3400   286.24111     -41086.038     -2296.6557      3684.5829    
      3500   278.64229     -41100.328     -7350.0634      3685.3149    
      3600   270.18604     -41087.235      7862.0272      3686.0468    
      3700   301.37325     -41077.517     -10681.273      3686.7788    
      3800   307.0638      -41080.812      2630.2345      3687.5107    
      3900   305.92275     -41089.212     -14627.83       3688.2426    
      4000   295.24673     -41093.946     -2307.1983      3688.9746    
      4100   286.91214     -41095.783      4912.2945      3689.7065    
      4200   282.67174     -41091.817     -3375.8457      3690.4385    
      4300   303.43073     -41081.478     -22.710679      3691.1704    
      4400   300.36749     -41061.133     -4658.2973      3691.9023    
      4500   313.06022     -41074.851      13563.865      3692.6343    
      4600   295.8091      -41079.518      1900.5583      3693.3662    
      4700   278.50797     -41087.906     -13456.846      3694.0982    
      4800   284.45152     -41094.067     -5980.8774      3694.8301    
      4900   310.68804     -41104.446     -13926.659      3695.562     
      5000   304.97424     -41090.161     -14527.188      3696.294     
Loop time of 232.543 on 16 procs for 5000 steps with 366 atoms

Performance: 0.929 ns/day, 25.838 hours/ns, 21.501 timesteps/s, 7.869 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 147.8      | 171.45     | 208.93     | 192.7 | 73.73
Bond    | 0.011937   | 0.01306    | 0.015163   |   0.8 |  0.01
Neigh   | 1.3868     | 1.6513     | 2.0763     |  19.9 |  0.71
Comm    | 2.7094     | 40.242     | 63.834     | 398.0 | 17.31
Output  | 0.015491   | 0.042334   | 0.097916   |  14.2 |  0.02
Modify  | 18.617     | 19.02      | 19.335     |   6.3 |  8.18
Other   |            | 0.1241     |            |       |  0.05

Nlocal:          45.75 ave          51 max          36 min
Histogram: 1 0 0 0 1 0 2 0 3 1
Nghost:           3529 ave        3560 max        3501 min
Histogram: 2 0 0 0 2 1 1 1 0 1
Neighs:        31738.1 ave       35288 max       25443 min
Histogram: 1 0 0 0 1 2 0 1 2 1

Total # of neighbors = 253905
Ave neighs/atom = 693.72951
Ave special neighs/atom = 0
Neighbor list builds = 58
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 16.1249
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz--0.6491)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.1249
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.2538999999999997925, deltaxy = 0.082539
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.61619999999999996998, deltaxz = -0.006162
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6491000000000000103, deltayz = 0.006491
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -0.161249 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz 100 dump/neg_deform4.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.7 | 140.4 | 141.9 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   320.26895     -41083.125     -8623.3128      3659.697     
       100   312.33377     -41084.375     -2405.2617      3659.697     
       200   292.47352     -41097.479     -5664.1616      3659.697     
       300   285.85781     -41091.497      10434.141      3659.697     
       400   300.47509     -41091.203      1688.2966      3659.697     
       500   309.33434     -41090.251     -4743.9027      3659.697     
       600   288.01875     -41070.123     -13611.054      3659.697     
       700   286.96954     -41080.848      4598.3955      3659.697     
       800   282.91568     -41088.174     -1699.2346      3659.697     
       900   293.67677     -41093.941     -2378.3594      3659.697     
      1000   286.90195     -41064.392     -7811.6839      3659.697     
      1100   306.90251     -41065.233      13835.324      3659.697     
      1200   319.49075     -41088.598      2011.3864      3659.697     
      1300   317.84495     -41108.394     -9743.6283      3659.697     
      1400   285.81759     -41083.759      471.82198      3659.697     
      1500   307.31012     -41094.552     -5761.5662      3659.697     
      1600   308.16795     -41084.287      7978.9381      3659.697     
      1700   320.26931     -41083.308     -5441.8225      3659.697     
      1800   328.69314     -41064.431     -3422.0177      3659.697     
      1900   312.02295     -41047.637     -1161.7885      3659.697     
      2000   309.18682     -41081.613     -2449.3977      3659.697     
      2100   282.98422     -41064.264     -8595.17        3659.697     
      2200   301.44614     -41093.747     -5975.1813      3659.697     
      2300   299.60374     -41116.679      4121.4509      3659.697     
      2400   274.21465     -41102.743      3428.2847      3659.697     
      2500   308.18385     -41099.475     -7293.0598      3659.697     
      2600   309.01973     -41079.007     -8224.4959      3659.697     
      2700   311.42916     -41082.831     -1707.7452      3659.697     
      2800   304.49326     -41096.635      438.12002      3659.697     
      2900   276.37749     -41085.389     -9143.7702      3659.697     
      3000   296.30414     -41104.716     -5864.0104      3659.697     
      3100   317.31275     -41087.58      -3800.7377      3659.697     
      3200   320.72438     -41077.638     -77.382102      3659.697     
      3300   284.72559     -41060.085     -2396.8286      3659.697     
      3400   288.65211     -41084.181      4259.5059      3659.697     
      3500   278.18631     -41082.886     -5262.176       3659.697     
      3600   289.95138     -41078.526     -4734.8871      3659.697     
      3700   321.51204     -41072.496     -2257.2368      3659.697     
      3800   313.4014      -41065.665      5625.1588      3659.697     
      3900   305.25314     -41079.204     -6283.9583      3659.697     
      4000   302.37656     -41088.123     -6383.2822      3659.697     
      4100   311.65728     -41104.983      1737.216       3659.697     
      4200   289.49265     -41077.314     -2081.0109      3659.697     
      4300   315.67226     -41063.108      4777.7239      3659.697     
      4400   312.57698     -41058.818     -2426.6903      3659.697     
      4500   291.96818     -41060.131     -6030.4286      3659.697     
      4600   298.568       -41085.783     -10769.049      3659.697     
      4700   305.04486     -41099.021     -8134.9593      3659.697     
      4800   302.50392     -41097.906     -10843.939      3659.697     
      4900   294.60818     -41080.981     -1402.1183      3659.697     
      5000   323.86583     -41087.217     -10435.715      3659.697     
Loop time of 233.541 on 16 procs for 5000 steps with 366 atoms

Performance: 0.925 ns/day, 25.949 hours/ns, 21.410 timesteps/s, 7.836 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 146.97     | 172.22     | 209.69     | 219.1 | 73.74
Bond    | 0.012361   | 0.013362   | 0.015019   |   0.7 |  0.01
Neigh   | 1.3294     | 1.5807     | 1.9768     |  21.5 |  0.68
Comm    | 2.9516     | 40.467     | 65.78      | 452.2 | 17.33
Output  | 0.015413   | 0.042133   | 0.09768    |  14.1 |  0.02
Modify  | 18.709     | 19.092     | 19.394     |   6.6 |  8.17
Other   |            | 0.1229     |            |       |  0.05

Nlocal:          45.75 ave          50 max          38 min
Histogram: 1 0 1 0 0 2 0 0 1 3
Nghost:        3570.62 ave        3626 max        3520 min
Histogram: 1 0 1 2 0 1 2 0 0 1
Neighs:        32041.9 ave       34922 max       27049 min
Histogram: 1 0 1 0 0 2 0 0 1 3

Total # of neighbors = 256335
Ave neighs/atom = 700.36885
Ave special neighs/atom = 0
Neighbor list builds = 55
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.1249
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 0.161249 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz 100 dump/pos_deform4.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.7 | 140.4 | 141.9 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   320.26895     -41083.125     -8623.3128      3659.697     
       100   312.32734     -41084.378     -2405.3165      3659.697     
       200   292.21457     -41097.485     -5658.3359      3659.697     
       300   285.93038     -41091.778      10414.04       3659.697     
       400   298.1789      -41089.151      1265.2152      3659.697     
       500   305.76152     -41087.57       1041.2465      3659.697     
       600   292.11427     -41075.484     -12312.289      3659.697     
       700   286.0072      -41078.85      -7277.1846      3659.697     
       800   296.68995     -41100.064      1284.7725      3659.697     
       900   293.32044     -41088.16       4892.515       3659.697     
      1000   306.40215     -41077.423     -5529.1534      3659.697     
      1100   317.36065     -41077.122      2006.802       3659.697     
      1200   293.66659     -41072.176      2452.2588      3659.697     
      1300   315.45215     -41110.407     -12830.847      3659.697     
      1400   275.87491     -41071.075     -1220.4615      3659.697     
      1500   314.89568     -41100.476     -14569.626      3659.697     
      1600   319.47994     -41095.73       4294.5902      3659.697     
      1700   295.74379     -41074.194      10658.29       3659.697     
      1800   292.5717      -41086.497     -4852.8245      3659.697     
      1900   279.95348     -41090.926     -9178.1701      3659.697     
      2000   281.61828     -41090.818     -2897.6362      3659.697     
      2100   286.8953      -41063.037      1744.0598      3659.697     
      2200   292.19896     -41058.201      7245.7111      3659.697     
      2300   293.65103     -41061.605     -48.237073      3659.697     
      2400   306.6423      -41087.404      9442.6973      3659.697     
      2500   274.66462     -41089.06      -1450.3356      3659.697     
      2600   292.46692     -41106.424     -8140.3122      3659.697     
      2700   301.03407     -41100.048      2982.7596      3659.697     
      2800   294.54975     -41076.112      3757.8872      3659.697     
      2900   299.1636      -41067.515     -5705.4816      3659.697     
      3000   308.22114     -41066.06      -10034.474      3659.697     
      3100   312.97329     -41078.926     -13982.784      3659.697     
      3200   299.9945      -41077.003     -147.96045      3659.697     
      3300   313.35271     -41097.363      1834.9196      3659.697     
      3400   283.05131     -41080.781     -16006.73       3659.697     
      3500   273.17622     -41068.625     -11515.841      3659.697     
      3600   310.01932     -41080.036      8627.3374      3659.697     
      3700   326.5201      -41077.948     -7469.1286      3659.697     
      3800   295.54401     -41063.566     -642.40478      3659.697     
      3900   309.02815     -41088.144      4237.8108      3659.697     
      4000   298.89029     -41083.563      1413.8519      3659.697     
      4100   291.14141     -41075.472      2398.1276      3659.697     
      4200   304.38471     -41066.69      -2257.6136      3659.697     
      4300   325.91584     -41063.224     -12752.073      3659.697     
      4400   307.61804     -41058.117     -6445.1515      3659.697     
      4500   291.72323     -41074.082     -4141.9509      3659.697     
      4600   280.236       -41068.392     -958.05198      3659.697     
      4700   296.37874     -41081.054      11394.312      3659.697     
      4800   333.00504     -41104.528      3938.4074      3659.697     
      4900   301.04173     -41064.606     -14140.738      3659.697     
      5000   323.75913     -41091.35      -2844.825       3659.697     
Loop time of 235.703 on 16 procs for 5000 steps with 366 atoms

Performance: 0.916 ns/day, 26.189 hours/ns, 21.213 timesteps/s, 7.764 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 148.74     | 167.84     | 211.22     | 200.4 | 71.21
Bond    | 0.012457   | 0.013392   | 0.014618   |   0.7 |  0.01
Neigh   | 1.3406     | 1.5458     | 1.9704     |  18.7 |  0.66
Comm    | 2.8738     | 46.294     | 65.435     | 381.7 | 19.64
Output  | 0.015881   | 0.044089   | 0.10234    |  14.6 |  0.02
Modify  | 19.384     | 19.78      | 20.008     |   5.3 |  8.39
Other   |            | 0.1842     |            |       |  0.08

Nlocal:          45.75 ave          52 max          38 min
Histogram: 1 0 2 0 0 1 1 1 0 2
Nghost:         3534.5 ave        3555 max        3521 min
Histogram: 2 1 1 1 1 0 0 0 1 1
Neighs:          32051 ave       36323 max       26850 min
Histogram: 1 0 2 0 0 1 1 1 0 2

Total # of neighbors = 256408
Ave neighs/atom = 700.56831
Ave special neighs/atom = 0
Neighbor list builds = 56
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.4224
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-0.6162)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.4224
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.2538999999999997925, deltaxy = 0.082539
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.61619999999999996998, deltaxz = -0.006162
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6491000000000000103, deltayz = 0.006491
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -0.134224 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz 100 dump/neg_deform5.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.7 | 140.4 | 141.9 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   320.26895     -41083.125     -8623.3128      3659.697     
       100   312.32323     -41084.375     -2405.0283      3659.697     
       200   291.98782     -41097.529     -5461.6683      3659.697     
       300   285.36433     -41091.242      10767.662      3659.697     
       400   298.80869     -41089.835      2040.6557      3659.697     
       500   306.12931     -41086.344      3243.1003      3659.697     
       600   289.24744     -41069.081     -10431.022      3659.697     
       700   296.04349     -41090.447     -605.58154      3659.697     
       800   293.48129     -41109.597      1970.6958      3659.697     
       900   288.62798     -41099.785      7479.6471      3659.697     
      1000   301.93344     -41083.214     -1123.6281      3659.697     
      1100   305.8246      -41075.349      12426.683      3659.697     
      1200   309.57063     -41094.551     -463.87243      3659.697     
      1300   307.19793     -41105.171     -3029.6417      3659.697     
      1400   271.16971     -41071.659      1976.8092      3659.697     
      1500   291.13781     -41080.043     -6858.6179      3659.697     
      1600   305.86721     -41086         -10916.601      3659.697     
      1700   285.74191     -41064.382     -5269.3471      3659.697     
      1800   319.7115      -41106.592      3220.1487      3659.697     
      1900   305.47088     -41103.896     -651.81338      3659.697     
      2000   290.88461     -41110.395      1737.9121      3659.697     
      2100   289.68599     -41119.38      -4540.195       3659.697     
      2200   305.01667     -41105.54      -764.12109      3659.697     
      2300   304.44459     -41077.576      3021.1737      3659.697     
      2400   291.56406     -41061.852      11315.623      3659.697     
      2500   290.93114     -41078.794     -5850.911       3659.697     
      2600   282.18036     -41088.822     -5.5479737      3659.697     
      2700   281.65036     -41084.406      354.94442      3659.697     
      2800   315.45518     -41077.095      5212.7152      3659.697     
      2900   317.61751     -41078.294     -4206.5796      3659.697     
      3000   295.75431     -41081.691      9824.7351      3659.697     
      3100   288.57453     -41086.558      2420.2121      3659.697     
      3200   308.91403     -41102.398      7397.9933      3659.697     
      3300   320.30644     -41100.454      6197.1051      3659.697     
      3400   336.27956     -41079.887      111.1846       3659.697     
      3500   308.55216     -41052.253     -11636.071      3659.697     
      3600   316.24344     -41088.465     -6115.4406      3659.697     
      3700   310.5171      -41096.468      1439.1601      3659.697     
      3800   288.74346     -41088.209     -909.90838      3659.697     
      3900   287.22599     -41085.386     -3857.0399      3659.697     
      4000   315.29293     -41089.731      1816.3095      3659.697     
      4100   325.16584     -41082.068     -6964.2863      3659.697     
      4200   289.84415     -41061.72      -6164.4037      3659.697     
      4300   296.29331     -41083.844      1284.0502      3659.697     
      4400   298.33538     -41083.829     -6466.2013      3659.697     
      4500   295.22991     -41070.111      6.0587245      3659.697     
      4600   318.12558     -41082.908     -732.45082      3659.697     
      4700   300.81408     -41077.876     -4630.5322      3659.697     
      4800   290.00405     -41096.86       937.02909      3659.697     
      4900   282.29903     -41096.843      2718.2962      3659.697     
      5000   278.1767      -41076.034     -2189.6246      3659.697     
Loop time of 235.758 on 16 procs for 5000 steps with 366 atoms

Performance: 0.916 ns/day, 26.195 hours/ns, 21.208 timesteps/s, 7.762 katom-step/s
99.1% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 147.86     | 172.78     | 212.53     | 222.4 | 73.29
Bond    | 0.012245   | 0.013298   | 0.01528    |   0.8 |  0.01
Neigh   | 1.3078     | 1.5496     | 1.9313     |  21.1 |  0.66
Comm    | 2.0895     | 41.805     | 66.788     | 452.3 | 17.73
Output  | 0.015888   | 0.042276   | 0.096607   |  13.9 |  0.02
Modify  | 19.088     | 19.44      | 19.708     |   6.1 |  8.25
Other   |            | 0.1285     |            |       |  0.05

Nlocal:          45.75 ave          55 max          35 min
Histogram: 1 0 0 1 2 1 0 0 2 1
Nghost:        3583.62 ave        3621 max        3531 min
Histogram: 1 0 1 0 0 1 3 0 1 1
Neighs:        32038.4 ave       38072 max       24968 min
Histogram: 1 0 1 1 1 1 0 0 2 1

Total # of neighbors = 256307
Ave neighs/atom = 700.29235
Ave special neighs/atom = 0
Neighbor list builds = 54
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.4224
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 0.134224 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz 100 dump/pos_deform5.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.7 | 140.4 | 141.9 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   320.26895     -41083.125     -8623.3128      3659.697     
       100   312.33787     -41084.378     -2405.8345      3659.697     
       200   292.43329     -41097.642     -5999.8758      3659.697     
       300   286.14896     -41091.996      10103.133      3659.697     
       400   299.22489     -41090.42       904.08414      3659.697     
       500   306.82006     -41088.032      2768.9886      3659.697     
       600   286.43751     -41067.193     -12811.32       3659.697     
       700   300.1551      -41088.095      1833.5808      3659.697     
       800   289.11467     -41082.733     -10770.058      3659.697     
       900   297.04544     -41085.971      289.87271      3659.697     
      1000   300.74689     -41070.274     -3314.2657      3659.697     
      1100   314.98769     -41069.486      17078.69       3659.697     
      1200   320.11521     -41099.149     -10569.799      3659.697     
      1300   300.8135      -41101.891      1232.0394      3659.697     
      1400   287.79576     -41087.309      5185.5643      3659.697     
      1500   291.65622     -41075.057     -16035.996      3659.697     
      1600   306.44184     -41068.527      4342.8399      3659.697     
      1700   314.92386     -41078.389     -7827.2334      3659.697     
      1800   274.56145     -41074.341     -10336.894      3659.697     
      1900   283.19497     -41090.114      286.49437      3659.697     
      2000   282.92738     -41069.771      10683.828      3659.697     
      2100   300.59902     -41069.249     -6369.6435      3659.697     
      2200   312.19449     -41074.211      227.36455      3659.697     
      2300   303.81358     -41078.546      4878.2699      3659.697     
      2400   284.4852      -41095.228      9535.7518      3659.697     
      2500   276.05422     -41083.506     -4232.0153      3659.697     
      2600   293.46337     -41081.207     -4464.8293      3659.697     
      2700   300.64434     -41075.259     -2103.5886      3659.697     
      2800   294.56927     -41065.933     -10076.989      3659.697     
      2900   282.93522     -41058.293     -5088.0493      3659.697     
      3000   302.34543     -41083.228      9760.5059      3659.697     
      3100   294.91724     -41084.316     -1082.2695      3659.697     
      3200   295.85477     -41087.985     -8116.4121      3659.697     
      3300   307.44089     -41082.793     -3184.8288      3659.697     
      3400   304.25349     -41059.896     -6902.2792      3659.697     
      3500   317.61372     -41093.986     -6298.4839      3659.697     
      3600   300.66807     -41099.909     -3049.4051      3659.697     
      3700   291.11363     -41088.095      3428.0933      3659.697     
      3800   308.8362      -41097.104      95.144162      3659.697     
      3900   288.23609     -41065.254     -18625.307      3659.697     
      4000   325.75717     -41071.247     -3184.4202      3659.697     
      4100   328.75939     -41070.765      1655.3742      3659.697     
      4200   298.10838     -41072.791     -7348.5889      3659.697     
      4300   310.07123     -41095.756     -3217.0069      3659.697     
      4400   301.7831      -41090.39      -5177.5528      3659.697     
      4500   300.85443     -41097.762     -6198.8744      3659.697     
      4600   292.21826     -41095.427      616.64644      3659.697     
      4700   286.18011     -41081.311     -5452.5374      3659.697     
      4800   315.6879      -41081.908     -7620.521       3659.697     
      4900   305.34446     -41060.158      3731.0682      3659.697     
      5000   321.21997     -41093.742      10810.933      3659.697     
Loop time of 187.73 on 16 procs for 5000 steps with 366 atoms

Performance: 1.151 ns/day, 20.859 hours/ns, 26.634 timesteps/s, 9.748 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 143.51     | 152.54     | 167.47     |  84.5 | 81.26
Bond    | 0.011844   | 0.012539   | 0.013747   |   0.6 |  0.01
Neigh   | 1.2984     | 1.4089     | 1.5749     |   8.3 |  0.75
Comm    | 2.1327     | 17.042     | 26.054     | 252.8 |  9.08
Output  | 0.012388   | 0.035503   | 0.083354   |  13.3 |  0.02
Modify  | 16.36      | 16.507     | 16.637     |   2.6 |  8.79
Other   |            | 0.1807     |            |       |  0.10

Nlocal:          45.75 ave          51 max          39 min
Histogram: 1 0 1 1 0 1 0 2 1 1
Nghost:        3529.25 ave        3537 max        3523 min
Histogram: 3 0 0 0 0 2 1 1 0 1
Neighs:        32053.8 ave       35729 max       27542 min
Histogram: 1 0 1 1 0 1 0 2 1 1

Total # of neighbors = 256430
Ave neighs/atom = 700.62842
Ave special neighs/atom = 0
Neighbor list builds = 54
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 16.909
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--8.2539)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.909
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.2538999999999997925, deltaxy = 0.082539
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 0.61619999999999996998, deltaxz = -0.006162
print "yz = $(yz), deltayz = ${deltayz}"
yz = -0.6491000000000000103, deltayz = 0.006491
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -0.16909 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz 100 dump/neg_deform6.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.7 | 140.4 | 141.9 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   320.26895     -41083.125     -8623.3128      3659.697     
       100   312.32826     -41084.375     -2405.0186      3659.697     
       200   292.34342     -41097.801     -5598.203       3659.697     
       300   286.86498     -41093.289      9910.1005      3659.697     
       400   299.61946     -41090.924      1117.4401      3659.697     
       500   306.78438     -41088.472     -2430.4141      3659.697     
       600   289.98017     -41073.613     -8721.7111      3659.697     
       700   280.33518     -41073.477      1236.6786      3659.697     
       800   285.26236     -41085.976      1204.2272      3659.697     
       900   292.50692     -41087.389     -738.38128      3659.697     
      1000   294.15978     -41068.004     -8649.3235      3659.697     
      1100   304.84302     -41061.297      16161.838      3659.697     
      1200   296.33287     -41060.358      53.392534      3659.697     
      1300   301.67807     -41099.803     -13598.873      3659.697     
      1400   271.32351     -41079.537     -9939.268       3659.697     
      1500   297.54411     -41093.578     -12991.756      3659.697     
      1600   308.67574     -41088.172     -451.25079      3659.697     
      1700   300.21161     -41070.988     -6023.6629      3659.697     
      1800   304.9654      -41087.7        7901.8499      3659.697     
      1900   288.58431     -41101.003     -9256.3737      3659.697     
      2000   282.25178     -41103.147     -1847.9278      3659.697     
      2100   297.60503     -41101.967     -3973.1353      3659.697     
      2200   289.39521     -41062.653      13762.329      3659.697     
      2300   304.02758     -41072.245      3752.8256      3659.697     
      2400   305.93767     -41088.593     -3915.6595      3659.697     
      2500   281.95706     -41083.773      2816.5452      3659.697     
      2600   298.48705     -41104.992     -6202.8722      3659.697     
      2700   277.20226     -41063.477      457.11904      3659.697     
      2800   320.75883     -41073.904     -2922.0568      3659.697     
      2900   304.69673     -41069.499      116.71398      3659.697     
      3000   292.14881     -41079.619      2660.038       3659.697     
      3100   290.03688     -41090.505      955.29222      3659.697     
      3200   303.88692     -41103.062      756.61133      3659.697     
      3300   326.87295     -41089.566     -900.74545      3659.697     
      3400   311.97741     -41062.806      4655.5829      3659.697     
      3500   310.66428     -41080.089     -1533.1804      3659.697     
      3600   294.05073     -41081.634     -1910.5791      3659.697     
      3700   300.20549     -41095.013     -10256.446      3659.697     
      3800   292.94686     -41087.422     -2620.9646      3659.697     
      3900   304.57193     -41093.42      -4014.9518      3659.697     
      4000   325.776       -41075.072     -361.8992       3659.697     
      4100   315.2309      -41062.08       4905.8169      3659.697     
      4200   323.87872     -41105.521      10205.116      3659.697     
      4300   291.04601     -41087.17       6329.9322      3659.697     
      4400   283.09331     -41083.822     -5176.7         3659.697     
      4500   304.20173     -41095.853     -10337.32       3659.697     
      4600   313.02346     -41075.426      8109.2963      3659.697     
      4700   315.50672     -41067.303      1982.9792      3659.697     
      4800   293.86711     -41065.194     -7033.1879      3659.697     
      4900   283.028       -41076.745     -3949.2882      3659.697     
      5000   296.32048     -41090.876      2163.4374      3659.697     
Loop time of 161.504 on 16 procs for 5000 steps with 366 atoms

Performance: 1.337 ns/day, 17.945 hours/ns, 30.959 timesteps/s, 11.331 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 138.52     | 141.48     | 143.53     |  11.8 | 87.60
Bond    | 0.011314   | 0.012335   | 0.013704   |   0.7 |  0.01
Neigh   | 1.3683     | 1.4227     | 1.4848     |   3.3 |  0.88
Comm    | 1.3464     | 3.3953     | 6.3256     |  75.4 |  2.10
Output  | 0.010309   | 0.03077    | 0.073384   |  12.7 |  0.02
Modify  | 14.986     | 15.03      | 15.099     |   1.1 |  9.31
Other   |            | 0.134      |            |       |  0.08

Nlocal:          45.75 ave          51 max          36 min
Histogram: 1 0 0 0 2 0 0 1 2 2
Nghost:        3591.25 ave        3634 max        3547 min
Histogram: 1 1 0 0 2 1 1 1 0 1
Neighs:          32061 ave       35596 max       25686 min
Histogram: 1 0 0 0 2 0 0 3 0 2

Total # of neighbors = 256488
Ave neighs/atom = 700.78689
Ave special neighs/atom = 0
Neighbor list builds = 57
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.1249 13.4224 16.909) with tilt (-8.2539 0.6162 -0.6491)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.909
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 0.16909 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz 100 dump/pos_deform6.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 138.7 | 140.4 | 141.9 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   320.26895     -41083.125     -8623.3128      3659.697     
       100   312.33285     -41084.377     -2405.089       3659.697     
       200   292.28276     -41097.315     -5506.5464      3659.697     
       300   285.8489      -41091.044      9553.5679      3659.697     
       400   300.14908     -41090.607      2580.2588      3659.697     
       500   309.66196     -41089.68      -1907.112       3659.697     
       600   290.49414     -41071.252     -7937.2374      3659.697     
       700   286.08989     -41080.378     -1310.7382      3659.697     
       800   288.40864     -41102.757      2692.677       3659.697     
       900   283.87638     -41093.773      2055.7664      3659.697     
      1000   301.16692     -41080.058     -4982.4933      3659.697     
      1100   289.56541     -41058.158      2657.4788      3659.697     
      1200   306.87022     -41091.195     -5055.3403      3659.697     
      1300   293.30937     -41089.333     -10019.066      3659.697     
      1400   279.38275     -41087.307     -6764.1674      3659.697     
      1500   289.2409      -41108         -12484.653      3659.697     
      1600   299.94378     -41094.414     -7330.8613      3659.697     
      1700   294.28731     -41067.46       1930.8694      3659.697     
      1800   296.22991     -41062.401     -1379.5754      3659.697     
      1900   298.87931     -41065.56      -11520.932      3659.697     
      2000   294.46483     -41088.405     -8113.1208      3659.697     
      2100   295.19252     -41105.176      383.45304      3659.697     
      2200   293.583       -41088.87       1846.5218      3659.697     
      2300   314.49234     -41084.454     -5906.1206      3659.697     
      2400   294.4359      -41065.928     -15693.072      3659.697     
      2500   309.72548     -41090.848     -3309.4221      3659.697     
      2600   295.41008     -41083.412     -7799.1788      3659.697     
      2700   289.5606      -41098.053     -4083.7081      3659.697     
      2800   280.37227     -41106.903     -3835.2312      3659.697     
      2900   301.78367     -41105.918      8780.4837      3659.697     
      3000   293.32577     -41073.28      -2677.3115      3659.697     
      3100   299.6234      -41074.8        8313.7632      3659.697     
      3200   317.69464     -41099.043     -13630.072      3659.697     
      3300   284.54802     -41082.871     -18719.733      3659.697     
      3400   287.13937     -41112.056     -5871.2104      3659.697     
      3500   280.06065     -41099.507     -6040.9486      3659.697     
      3600   306.79675     -41087.596     -11169.65       3659.697     
      3700   303.42908     -41079.567     -4380.6847      3659.697     
      3800   307.60559     -41070.468      534.99801      3659.697     
      3900   318.65231     -41090.346     -1743.71        3659.697     
      4000   307.73835     -41108.698     -1949.0382      3659.697     
      4100   281.70649     -41088.557      2016.7412      3659.697     
      4200   288.40204     -41075.964      584.56365      3659.697     
      4300   296.18249     -41078.499     -1903.8021      3659.697     
      4400   311.89001     -41095.161     -5942.5387      3659.697     
      4500   294.96532     -41079.997     -4244.3873      3659.697     
      4600   281.26057     -41083.132     -12497.137      3659.697     
      4700   286.48266     -41104.038      7276.1513      3659.697     
      4800   293.8774      -41097.473     -9570.294       3659.697     
      4900   299.48131     -41073.169     -15867.789      3659.697     
      5000   310.72521     -41074.073      704.65462      3659.697     
Loop time of 144.915 on 16 procs for 5000 steps with 366 atoms

Performance: 1.491 ns/day, 16.102 hours/ns, 34.503 timesteps/s, 12.628 katom-step/s
98.7% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 123.73     | 125.21     | 127.6      |  11.2 | 86.40
Bond    | 0.010207   | 0.010979   | 0.011978   |   0.5 |  0.01
Neigh   | 1.3826     | 1.4296     | 1.49       |   3.4 |  0.99
Comm    | 1.1236     | 3.4987     | 5          |  66.9 |  2.41
Output  | 0.010139   | 0.031092   | 0.074666   |  12.9 |  0.02
Modify  | 14.521     | 14.567     | 14.637     |   1.2 | 10.05
Other   |            | 0.165      |            |       |  0.11

Nlocal:          45.75 ave          54 max          39 min
Histogram: 1 0 1 1 3 0 0 1 0 1
Nghost:        3569.12 ave        3586 max        3542 min
Histogram: 1 0 0 1 1 1 0 1 1 2
Neighs:        32047.8 ave       37662 max       27443 min
Histogram: 1 0 1 1 3 0 0 1 0 1

Total # of neighbors = 256382
Ave neighs/atom = 700.49727
Ave special neighs/atom = 0
Neighbor list builds = 58
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:43:24
