LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
# boundary        s s s
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 0.1
variable FF string "SiOCHN_2018.ff C H O Si"          # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff C H O Si
# pair_coeff * * CHOSiNa.ff C H O Si
# pair_coeff * * SiOCHN_2018.ff C H O Si
# pair_coeff * * PDMSDecomp.ff C H O Si
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# Read the initial sctructure
# box tilt large
variable structure string 333U-50C-26_eq

read_data       ${structure}.data
read_data       333U-50C-26_eq.data
Reading data file ...
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  365 atoms
  reading velocities ...
  365 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.010 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400

# # Energy minimization
# print "*****Minimization starts.*****"
# minimize 1.0e-6 1.0e-6 100 1000
# min_style cg
# # Save the optimized structure
# write_data ${structure}_opt.data
# velocity        all create ${temp} ${seed} dist gaussian

# # Equilibration
# include ff.mod.lmp
# if "$(is_defined(fix,avgp))" then "unfix avgp"
# if "$(is_defined(fix,avgl))" then "unfix avgl"
# thermo_style custom step temp pe press density vol
# run ${nequil}
# # Save the equilibrated structure
# write_data ${structure}_eq.data

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 17.6144
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 14.9838
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.4642

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.8795
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 2.088
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -6.9346

# Write restart
write_restart equil.res
System init for write_restart ...
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 17.6144
variable dlen equal lx-${len0}
variable dlen equal lx-17.6144
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.6144
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.9345999999999996533, deltaxy = 0.069346
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 2.0880000000000000782, deltaxz = -0.02088
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.87949999999999994849, deltayz = -0.008795
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.176144 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.176144 xy delta 0.069346 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.176144 xy delta 0.069346 xz delta -0.02088 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz 100 dump/neg_deform1.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.1 | 112 | 113.2 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34809     -37409.389      1263.4014      4609.3376    
       100   277.61554     -37385.688      6848.5082      4608.4157    
       200   339.15999     -37426.539     -4174.9304      4607.4939    
       300   341.11511     -37412.13       831.36671      4606.572     
       400   299.01892     -37405.055     -9951.1228      4605.6501    
       500   313.15359     -37433.869      3023.6551      4604.7283    
       600   289.18243     -37397.6       -9032.7853      4603.8064    
       700   315.95135     -37410.835     -8441.9395      4602.8845    
       800   321.05097     -37411.517     -113.76151      4601.9627    
       900   296.14624     -37411.16      -6714.8534      4601.0408    
      1000   299.99027     -37436.23       400.70268      4600.1189    
      1100   279.47223     -37406.223      6696.3476      4599.1971    
      1200   323.12953     -37424.504     -7357.4418      4598.2752    
      1300   305.01594     -37397.283     -4874.6947      4597.3533    
      1400   288.97978     -37391.207     -9083.1634      4596.4315    
      1500   301.52144     -37408.23      -6282.4858      4595.5096    
      1600   307.12083     -37437.822     -3081.6745      4594.5877    
      1700   282.50746     -37436.048      8223.9913      4593.6659    
      1800   289.4949      -37425.363      6700.3427      4592.744     
      1900   298.77327     -37419.878     -6493.883       4591.8221    
      2000   301.3179      -37416.289      7821.6397      4590.9003    
      2100   301.9363      -37410.273     -14090.009      4589.9784    
      2200   296.21799     -37409.667      2460.1405      4589.0565    
      2300   276.61063     -37407.276     -7570.8474      4588.1346    
      2400   287.50238     -37426.574     -5097.6377      4587.2128    
      2500   293.97877     -37404.289      3323.1576      4586.2909    
      2600   309.13235     -37398.065      1129.5831      4585.369     
      2700   303.06048     -37399.236     -4159.0186      4584.4472    
      2800   302.27265     -37422.826      5109.9832      4583.5253    
      2900   291.2045      -37422.007      5925.2747      4582.6034    
      3000   290.56826     -37412.583      4520.9497      4581.6816    
      3100   317.43552     -37432.11      -8587.762       4580.7597    
      3200   303.95274     -37414.387      2094.4762      4579.8378    
      3300   303.71787     -37416.725     -5250.2306      4578.916     
      3400   299.05816     -37408.482     -1714.1871      4577.9941    
      3500   301.6374      -37400.434      4922.2097      4577.0722    
      3600   307.02732     -37402.522     -1359.8683      4576.1504    
      3700   325.40569     -37417.227      9769.8525      4575.2285    
      3800   297.53867     -37415.01       4398.5979      4574.3066    
      3900   299.65856     -37434.878     -6594.2073      4573.3848    
      4000   303.38054     -37433.868      5656.5398      4572.4629    
      4100   308.54454     -37418.893      1013.0652      4571.541     
      4200   311.22363     -37388.835     -7673.3243      4570.6192    
      4300   292.16237     -37370.368     -12716.131      4569.6973    
      4400   303.67202     -37434.16       595.13265      4568.7754    
      4500   284.9035      -37415.185     -5603.5434      4567.8536    
      4600   294.5736      -37406.221     -10466.52       4566.9317    
      4700   316.28857     -37411.377     -11323.34       4566.0098    
      4800   298.06826     -37396.835     -11025.344      4565.088     
      4900   295.16056     -37424.017     -6586.6084      4564.1661    
      5000   289.81953     -37434.846      1772.7429      4563.2442    
Loop time of 167.479 on 16 procs for 5000 steps with 365 atoms

Performance: 1.290 ns/day, 18.609 hours/ns, 29.854 timesteps/s, 10.897 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 93.63      | 129.75     | 144.96     | 174.8 | 77.47
Bond    | 0.012735   | 0.01356    | 0.014478   |   0.4 |  0.01
Neigh   | 1.4876     | 1.9797     | 2.201      |  19.1 |  1.18
Comm    | 3.3346     | 18.517     | 54.633     | 462.9 | 11.06
Output  | 0.015982   | 0.042309   | 0.095685   |  13.6 |  0.03
Modify  | 16.817     | 17.053     | 17.548     |   6.6 | 10.18
Other   |            | 0.1193     |            |       |  0.07

Nlocal:         45.625 ave          53 max          40 min
Histogram: 2 1 0 2 0 1 0 0 0 2
Nghost:        2841.75 ave        2869 max        2816 min
Histogram: 2 0 2 0 0 1 0 1 0 2
Neighs:        25267.6 ave       29291 max       22183 min
Histogram: 2 1 0 1 1 1 0 0 0 2

Total # of neighbors = 202141
Ave neighs/atom = 553.81096
Ave special neighs/atom = 0
Neighbor list builds = 86
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.6144
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.176144 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.176144 xy delta -0.069346 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.176144 xy delta -0.069346 xz delta 0.02088 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz 100 dump/pos_deform1.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.2 | 112.1 | 113.2 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34809     -37409.389      1263.4014      4609.3376    
       100   277.61758     -37385.684      6846.2566      4610.2595    
       200   338.8914      -37426.133     -4471.0041      4611.1813    
       300   341.01789     -37411.44       827.69959      4612.1032    
       400   298.33404     -37403.52      -11120.25       4613.0251    
       500   314.38943     -37434.234      3832.3602      4613.9469    
       600   288.15186     -37395.965     -8796.282       4614.8688    
       700   318.00095     -37410.16      -9730.0209      4615.7907    
       800   323.21396     -37408.87       1215.0949      4616.7125    
       900   292.90347     -37407.461     -12038.652      4617.6344    
      1000   310.04986     -37447.183      2043.0479      4618.5563    
      1100   276.63927     -37403.403      5481.1707      4619.4781    
      1200   321.94095     -37424.693     -2647.6876      4620.4       
      1300   307.82855     -37404.877      1516.957       4621.3219    
      1400   288.26197     -37390.734     -2258.3527      4622.2437    
      1500   311.14511     -37420.073     -3671.3766      4623.1656    
      1600   303.86303     -37432.412     -6474.8812      4624.0875    
      1700   294.24794     -37443.042      889.6875       4625.0093    
      1800   283.09078     -37411.482      628.04404      4625.9312    
      1900   297.21576     -37401.616      5142.2048      4626.8531    
      2000   317.68636     -37417.794     -5187.9336      4627.775     
      2100   302.84584     -37404.516     -6211.1346      4628.6968    
      2200   273.31205     -37402.859      2977.5821      4629.6187    
      2300   286.02022     -37418.559     -11418.273      4630.5406    
      2400   298.45506     -37424.852     -6608.5275      4631.4624    
      2500   305.95021     -37425.73       1038.9606      4632.3843    
      2600   300.57207     -37408.365     -5010.2997      4633.3062    
      2700   293.64572     -37389.008     -8310.3018      4634.228     
      2800   296.88665     -37407.975     -8413.3341      4635.1499    
      2900   286.23268     -37431.471     -4745.3555      4636.0718    
      3000   289.21015     -37420.128     -10145.096      4636.9936    
      3100   300.68363     -37408.253     -16464.656      4637.9155    
      3200   317.45194     -37415.609     -2207.442       4638.8374    
      3300   317.29145     -37428.509     -3627.8165      4639.7592    
      3400   278.70809     -37410.781     -6779.1544      4640.6811    
      3500   286.27321     -37415.287     -4545.0328      4641.603     
      3600   306.21259     -37430.621     -1781.2348      4642.5248    
      3700   297.15968     -37408.646     -2176.4874      4643.4467    
      3800   302.68907     -37392.593      9891.0369      4644.3686    
      3900   312.9         -37414.558     -6065.7065      4645.2904    
      4000   281.79932     -37422.104     -6878.3123      4646.2123    
      4100   274.5904      -37406.82      -2225.2514      4647.1342    
      4200   315.44521     -37429.323     -4689.3896      4648.056     
      4300   317.95047     -37417.242     -10783.297      4648.9779    
      4400   287.4451      -37386.951     -5044.6295      4649.8998    
      4500   293.55271     -37425.909     -3177.1375      4650.8216    
      4600   285.58262     -37436.644      4901.9993      4651.7435    
      4700   306.79976     -37446.527     -10252.146      4652.6654    
      4800   292.97362     -37418.379     -1656.9901      4653.5872    
      4900   308.55614     -37427.154     -9174.6328      4654.5091    
      5000   293.03713     -37410.771      1182.6639      4655.431     
Loop time of 163.869 on 16 procs for 5000 steps with 365 atoms

Performance: 1.318 ns/day, 18.208 hours/ns, 30.512 timesteps/s, 11.137 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 97.664     | 124.12     | 143.61     | 165.9 | 75.74
Bond    | 0.012714   | 0.01368    | 0.014798   |   0.5 |  0.01
Neigh   | 1.358      | 1.7184     | 1.9777     |  18.8 |  1.05
Comm    | 1.8604     | 21.347     | 47.827     | 400.0 | 13.03
Output  | 0.014588   | 0.037341   | 0.080851   |  11.7 |  0.02
Modify  | 16.245     | 16.517     | 16.896     |   6.1 | 10.08
Other   |            | 0.1184     |            |       |  0.07

Nlocal:         45.625 ave          55 max          39 min
Histogram: 2 1 0 1 1 0 2 0 0 1
Nghost:        2793.25 ave        2824 max        2769 min
Histogram: 2 1 1 0 1 0 0 0 2 1
Neighs:        24775.2 ave       29379 max       21268 min
Histogram: 2 0 1 1 1 0 2 0 0 1

Total # of neighbors = 198202
Ave neighs/atom = 543.01918
Ave special neighs/atom = 0
Neighbor list builds = 78
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 14.9838
variable dlen equal ly-${len0}
variable dlen equal ly-14.9838
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.9838
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.9345999999999996533, deltaxy = 0.069346
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 2.0880000000000000782, deltaxz = -0.02088
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.87949999999999994849, deltayz = -0.008795
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.149838 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.149838 yz delta -0.008795 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz 100 dump/neg_deform2.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.1 | 112 | 113.2 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34809     -37409.389      1263.4014      4609.3376    
       100   277.61558     -37385.682      6848.6735      4608.4157    
       200   339.18119     -37426.313     -4094.7411      4607.4939    
       300   341.23144     -37411.726      1205.7153      4606.572     
       400   298.12312     -37403.106     -12337.631      4605.6501    
       500   311.23414     -37430.889      3156.7518      4604.7283    
       600   287.35269     -37395.049     -7919.7053      4603.8064    
       700   316.87508     -37409.573     -12146.123      4602.8845    
       800   320.56324     -37409.865      2531.5515      4601.9627    
       900   289.41142     -37404.702     -7659.0233      4601.0408    
      1000   303.85104     -37437.144      1073.1814      4600.1189    
      1100   286.28489     -37409.5        5866.6958      4599.1971    
      1200   312.93441     -37409.287     -1954.8749      4598.2752    
      1300   315.82855     -37405.112     -9745.1019      4597.3533    
      1400   274.72646     -37369.826     -5135.8428      4596.4315    
      1500   307.78136     -37406.206     -10381.273      4595.5096    
      1600   342.09024     -37434.108     -10076.887      4594.5877    
      1700   312.72342     -37396.681      11347.27       4593.6659    
      1800   277.49288     -37382.529     -5095.1384      4592.744     
      1900   277.48216     -37401.607      6539.8016      4591.8221    
      2000   295.50126     -37410.441     -1046.2018      4590.9003    
      2100   330.83048     -37423.013      1627.6825      4589.9784    
      2200   309.58808     -37380.775      1460.2417      4589.0565    
      2300   307.49232     -37381.295      4639.7324      4588.1346    
      2400   298.88483     -37401.045      3685.5382      4587.2128    
      2500   299.81431     -37421.716     -11956.975      4586.2909    
      2600   286.60899     -37415.846      2084.4344      4585.369     
      2700   298.40466     -37421.964     -4795.2095      4584.4472    
      2800   320.78795     -37411.967     -4361.2046      4583.5253    
      2900   299.48997     -37378.266      14073.254      4582.6034    
      3000   327.59154     -37423.096      6657.5821      4581.6816    
      3100   273.72526     -37386.299     -5634.2911      4580.7597    
      3200   295.69977     -37413.18       2115.8788      4579.8378    
      3300   293.72643     -37407.303      2946.9563      4578.916     
      3400   320.94292     -37434.431      6261.194       4577.9941    
      3500   306.11795     -37414.707      6046.0443      4577.0722    
      3600   303.25936     -37399.323     -10654.74       4576.1504    
      3700   320.68928     -37407.148     -4268.7573      4575.2285    
      3800   302.4374      -37397.565     -13382.173      4574.3066    
      3900   292.87332     -37414.826      10580.426      4573.3848    
      4000   293.44892     -37423.511     -10917.803      4572.4629    
      4100   291.45029     -37403.215      1266.1244      4571.541     
      4200   310.43059     -37388.137     -17049.91       4570.6192    
      4300   319.70391     -37400.651     -4236.2441      4569.6973    
      4400   291.84742     -37392.769     -20809.114      4568.7754    
      4500   294.78456     -37412.326     -1060.8706      4567.8536    
      4600   290.86032     -37406.17       2074.6538      4566.9317    
      4700   303.30204     -37390.021      1131.9321      4566.0098    
      4800   309.61671     -37382.042     -11636.84       4565.088     
      4900   319.1475      -37403.335     -11069.448      4564.1661    
      5000   304.25813     -37400.313      4326.9617      4563.2442    
Loop time of 167.938 on 16 procs for 5000 steps with 365 atoms

Performance: 1.286 ns/day, 18.660 hours/ns, 29.773 timesteps/s, 10.867 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 99.466     | 130.88     | 145.68     | 124.3 | 77.94
Bond    | 0.01287    | 0.013733   | 0.014663   |   0.5 |  0.01
Neigh   | 1.3966     | 1.8534     | 2.0411     |  14.7 |  1.10
Comm    | 3.2668     | 18.056     | 49.47      | 334.9 | 10.75
Output  | 0.01564    | 0.042231   | 0.096639   |  13.8 |  0.03
Modify  | 16.772     | 16.972     | 17.464     |   5.0 | 10.11
Other   |            | 0.1168     |            |       |  0.07

Nlocal:         45.625 ave          51 max          41 min
Histogram: 1 1 1 1 0 1 0 0 2 1
Nghost:        2850.88 ave        2916 max        2790 min
Histogram: 2 1 1 0 0 0 1 0 2 1
Neighs:          25291 ave       27804 max       22906 min
Histogram: 2 0 1 1 0 1 0 0 2 1

Total # of neighbors = 202328
Ave neighs/atom = 554.32329
Ave special neighs/atom = 0
Neighbor list builds = 80
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.9838
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.149838 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.149838 yz delta 0.008795 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz 100 dump/pos_deform2.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.2 | 112.1 | 113.2 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34809     -37409.389      1263.4014      4609.3376    
       100   277.61761     -37385.69       6845.8983      4610.2595    
       200   338.84836     -37426.302     -4558.8922      4611.1813    
       300   340.95664     -37411.875      148.08881      4612.1032    
       400   298.55609     -37404.477     -10278.735      4613.0251    
       500   313.2998      -37433.662      1930.226       4613.9469    
       600   285.58548     -37393.029     -7942.6807      4614.8688    
       700   318.81464     -37412.083     -9002.7717      4615.7907    
       800   318.72571     -37406.884     -1467.9241      4616.7125    
       900   288.86871     -37405.188     -8548.2439      4617.6344    
      1000   306.84834     -37444.902      2106.317       4618.5563    
      1100   281.70593     -37409.508      339.70794      4619.4781    
      1200   315.30782     -37419.091     -1629.6367      4620.4       
      1300   318.53421     -37413.794     -542.40382      4621.3219    
      1400   283.62222     -37383.774     -5321.585       4622.2437    
      1500   292.69542     -37397.154     -10866.934      4623.1656    
      1600   301.7467      -37411.138     -1355.0749      4624.0875    
      1700   301.2035      -37413.544      1045.37        4625.0093    
      1800   275.25359     -37407.206     -7053.6637      4625.9312    
      1900   275.19559     -37422.716      2750.9273      4626.8531    
      2000   301.76437     -37433.245     -8243.4249      4627.775     
      2100   299.24788     -37405.953     -12845.26       4628.6968    
      2200   301.82859     -37404.63      -2686.7163      4629.6187    
      2300   299.3642      -37411.06      -6131.6156      4630.5406    
      2400   285.62987     -37413.576     -7395.1079      4631.4624    
      2500   289.67881     -37437.054     -7970.5553      4632.3843    
      2600   293.37203     -37419.953      5356.7049      4633.3062    
      2700   286.97178     -37387.781     -11205.273      4634.228     
      2800   327.68398     -37427.903     -3825.4389      4635.1499    
      2900   297.99213     -37404.265     -5837.5281      4636.0718    
      3000   288.31305     -37418.97      -3387.2006      4636.9936    
      3100   286.20448     -37445.384     -2199.3639      4637.9155    
      3200   261.82534     -37437.145      350.69831      4638.8374    
      3300   294.65733     -37454.174     -2517.4168      4639.7592    
      3400   287.54528     -37408.589     -289.14987      4640.6811    
      3500   298.11276     -37401.363     -6428.5139      4641.603     
      3600   312.09356     -37404.347      1790.3321      4642.5248    
      3700   310.98928     -37401.697     -5352.7545      4643.4467    
      3800   300.52584     -37409.988     -7686.0842      4644.3686    
      3900   288.37798     -37425.019     -1851.6492      4645.2904    
      4000   286.05437     -37424.812     -3619.5645      4646.2123    
      4100   293.79248     -37415.519     -7884.3347      4647.1342    
      4200   294.92891     -37406.697     -4060.3806      4648.056     
      4300   312.50395     -37422.312      10964.635      4648.9779    
      4400   298.37078     -37398.631      4910.0491      4649.8998    
      4500   304.45641     -37396.611     -7487.1801      4650.8216    
      4600   315.7937      -37397.279      1142.0025      4651.7435    
      4700   309.13921     -37400.725      2830.411       4652.6654    
      4800   275.40304     -37400.013     -5606.6786      4653.5872    
      4900   307.97014     -37436.748     -5818.4858      4654.5091    
      5000   295.35324     -37407.607     -1425.4018      4655.431     
Loop time of 166.902 on 16 procs for 5000 steps with 365 atoms

Performance: 1.294 ns/day, 18.545 hours/ns, 29.958 timesteps/s, 10.935 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 98.38      | 129.66     | 144.49     | 159.3 | 77.69
Bond    | 0.012978   | 0.013698   | 0.014564   |   0.5 |  0.01
Neigh   | 1.2775     | 1.7022     | 1.866      |  17.8 |  1.02
Comm    | 3.4185     | 18.238     | 49.506     | 424.9 | 10.93
Output  | 0.015542   | 0.043833   | 0.10051    |  14.1 |  0.03
Modify  | 16.943     | 17.127     | 17.592     |   5.7 | 10.26
Other   |            | 0.118      |            |       |  0.07

Nlocal:         45.625 ave          51 max          41 min
Histogram: 1 3 0 0 0 0 1 0 1 2
Nghost:        2800.38 ave        2852 max        2747 min
Histogram: 1 1 0 0 2 1 1 0 1 1
Neighs:        24797.4 ave       27653 max       22378 min
Histogram: 2 2 0 0 0 0 1 1 0 2

Total # of neighbors = 198379
Ave neighs/atom = 543.50411
Ave special neighs/atom = 0
Neighbor list builds = 74
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.4642
variable dlen equal lz-${len0}
variable dlen equal lz-17.4642
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.4642
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.9345999999999996533, deltaxy = 0.069346
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 2.0880000000000000782, deltaxz = -0.02088
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.87949999999999994849, deltayz = -0.008795
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -0.174642 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz 100 dump/neg_deform3.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.1 | 112 | 113.2 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34809     -37409.389      1263.4014      4609.3376    
       100   277.61586     -37385.685      6848.8432      4608.4157    
       200   339.16886     -37426.392     -4365.8843      4607.4939    
       300   340.98101     -37411.796      965.95009      4606.572     
       400   298.062       -37403.714     -11998.707      4605.6501    
       500   310.75438     -37431.043      3428.9024      4604.7283    
       600   286.26093     -37393.939     -8022.9916      4603.8064    
       700   317.39496     -37410.369     -10725.898      4602.8845    
       800   321.90654     -37413.827     -58.741679      4601.9627    
       900   290.87146     -37412.531     -6588.946       4601.0408    
      1000   298.02759     -37432.968      2784.3931      4600.1189    
      1100   287.42065     -37409.943      5277.5467      4599.1971    
      1200   314.89304     -37414.574     -6729.6064      4598.2752    
      1300   314.70733     -37409.764     -6022.6559      4597.3533    
      1400   279.9068      -37379.773     -12492.704      4596.4315    
      1500   303.73976     -37406.56      -4250.486       4595.5096    
      1600   313.74509     -37428.473      2457.5369      4594.5877    
      1700   276.80087     -37412.922      3003.304       4593.6659    
      1800   286.9183      -37422.855      4218.8024      4592.744     
      1900   304.02695     -37411.082      474.68339      4591.8221    
      2000   312.42025     -37406.151     -9856.9831      4590.9003    
      2100   298.69344     -37398.119     -8781.5128      4589.9784    
      2200   303.64693     -37414.751      966.3324       4589.0565    
      2300   288.61655     -37408.788      4215.9868      4588.1346    
      2400   296.19405     -37413.737      2935.9011      4587.2128    
      2500   307.42737     -37424.233     -4426.6416      4586.2909    
      2600   295.97864     -37409.064     -5297.3738      4585.369     
      2700   307.51003     -37420.785     -14353.693      4584.4472    
      2800   286.96393     -37413.497     -1831.2164      4583.5253    
      2900   293.40085     -37432.147     -3190.4434      4582.6034    
      3000   298.67116     -37425.666     -6394.4425      4581.6816    
      3100   300.14647     -37402.382     -11786.961      4580.7597    
      3200   324.27514     -37417.959     -6203.9675      4579.8378    
      3300   292.79859     -37406.731     -11257.354      4578.916     
      3400   272.98022     -37415.589     -6831.7656      4577.9941    
      3500   287.72408     -37427.816     -9609.3244      4577.0722    
      3600   295.84802     -37418.861      945.18056      4576.1504    
      3700   313.16956     -37420.996     -6041.8215      4575.2285    
      3800   295.78804     -37403.4       -5096.9106      4574.3066    
      3900   282.79906     -37420.795     -4380.8886      4573.3848    
      4000   289.66831     -37445.692     -968.56908      4572.4629    
      4100   291.45195     -37438.91      -2032.1761      4571.541     
      4200   302.64457     -37443.087      503.68164      4570.6192    
      4300   292.91629     -37433.733     -5645.4966      4569.6973    
      4400   312.22007     -37431.713      945.63065      4568.7754    
      4500   311.73403     -37404.431     -5089.1725      4567.8536    
      4600   320.30667     -37414.41       4027.2283      4566.9317    
      4700   278.3367      -37404.938      3399.0936      4566.0098    
      4800   297.84212     -37440.977     -10719.815      4565.088     
      4900   295.36673     -37444.884     -1411.4477      4564.1661    
      5000   307.7394      -37460.853     -2662.8503      4563.2442    
Loop time of 165.056 on 16 procs for 5000 steps with 365 atoms

Performance: 1.309 ns/day, 18.340 hours/ns, 30.293 timesteps/s, 11.057 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 98.93      | 127.6      | 144.92     | 153.8 | 77.30
Bond    | 0.012646   | 0.013478   | 0.01429    |   0.5 |  0.01
Neigh   | 1.5332     | 2.0037     | 2.2379     |  19.2 |  1.21
Comm    | 1.5319     | 18.852     | 47.521     | 400.0 | 11.42
Output  | 0.0147     | 0.036393   | 0.080093   |  11.9 |  0.02
Modify  | 16.189     | 16.44      | 16.94      |   7.1 |  9.96
Other   |            | 0.1151     |            |       |  0.07

Nlocal:         45.625 ave          53 max          40 min
Histogram: 2 0 2 1 0 0 1 0 1 1
Nghost:        2825.25 ave        2855 max        2791 min
Histogram: 2 1 1 0 0 0 0 0 1 3
Neighs:        25281.9 ave       28994 max       22309 min
Histogram: 2 0 2 0 1 0 1 0 1 1

Total # of neighbors = 202255
Ave neighs/atom = 554.12329
Ave special neighs/atom = 0
Neighbor list builds = 88
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.4642
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 0.174642 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz 100 dump/pos_deform3.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.1 | 112 | 113.2 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34809     -37409.389      1263.4014      4609.3376    
       100   277.6173      -37385.688      6845.8271      4610.2595    
       200   338.82198     -37426.268     -4268.2461      4611.1813    
       300   341.13048     -37411.814      566.58509      4612.1032    
       400   297.84072     -37403.14      -9691.8609      4613.0251    
       500   313.5092      -37433.182      2961.658       4613.9469    
       600   286.60375     -37393.854     -9240.5196      4614.8688    
       700   316.84554     -37411.027     -11854.036      4615.7907    
       800   319.57673     -37408.545     -651.02155      4616.7125    
       900   292.48356     -37409.381     -9541.5655      4617.6344    
      1000   293.94054     -37429.329     -150.00218      4618.5563    
      1100   283.84467     -37405.74       4866.596       4619.4781    
      1200   329.50761     -37428.249     -4169.679       4620.4       
      1300   309.75051     -37400.68      -4213.8327      4621.3219    
      1400   275.0001      -37370.043     -1776.6797      4622.2437    
      1500   306.2644      -37405.718     -12737.866      4623.1656    
      1600   313.11191     -37432.721      1488.3837      4624.0875    
      1700   299.60534     -37444.15       5401.7013      4625.0093    
      1800   271.34859     -37395.773     -143.53333      4625.9312    
      1900   307.16038     -37413.843      6030.7301      4626.8531    
      2000   311.90305     -37414.729      2759.014       4627.775     
      2100   291.68579     -37406.93      -8593.0103      4628.6968    
      2200   282.94857     -37427.251      2681.6412      4629.6187    
      2300   288.63507     -37435.564     -2011.87        4630.5406    
      2400   290.46458     -37386.667     -9032.6119      4631.4624    
      2500   302.56297     -37386.767     -8913.4408      4632.3843    
      2600   310.82105     -37392.486     -881.82721      4633.3062    
      2700   316.1385      -37427.455     -6392.5227      4634.228     
      2800   282.49502     -37408.051     -17270.208      4635.1499    
      2900   300.95143     -37427.634     -6998.0554      4636.0718    
      3000   287.53088     -37399.227      4327.6944      4636.9936    
      3100   328.83639     -37407.176     -6180.6599      4637.9155    
      3200   315.54197     -37401.014     -6275.7866      4638.8374    
      3300   300.02954     -37410.399      6726.3245      4639.7592    
      3400   287.38423     -37405.879     -7641.9199      4640.6811    
      3500   316.9517      -37439.408     -6297.064       4641.603     
      3600   291.40206     -37411.907     -145.16912      4642.5248    
      3700   310.15152     -37416.539     -13509.61       4643.4467    
      3800   303.54423     -37393.35      -13686.507      4644.3686    
      3900   294.14692     -37386.5       -5685.5092      4645.2904    
      4000   292.61305     -37413.252     -3959.2084      4646.2123    
      4100   271.80159     -37411.734     -357.7151       4647.1342    
      4200   299.97976     -37430.732     -15669.279      4648.056     
      4300   294.59944     -37406.777      2846.0893      4648.9779    
      4400   294.20628     -37395.791      4287.3445      4649.8998    
      4500   304.15425     -37408.054     -3768.3047      4650.8216    
      4600   312.34392     -37426.379      12.862843      4651.7435    
      4700   270.10656     -37413.26       1999.676       4652.6654    
      4800   271.36652     -37425.84      -14106.387      4653.5872    
      4900   278.04596     -37407.622     -4536.9372      4654.5091    
      5000   304.39895     -37411.598      1018.6796      4655.431     
Loop time of 163.238 on 16 procs for 5000 steps with 365 atoms

Performance: 1.323 ns/day, 18.138 hours/ns, 30.630 timesteps/s, 11.180 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 98.552     | 124.6      | 143.59     | 169.2 | 76.33
Bond    | 0.012794   | 0.013608   | 0.014799   |   0.5 |  0.01
Neigh   | 1.3839     | 1.7764     | 2.0222     |  21.0 |  1.09
Comm    | 1.3751     | 20.362     | 46.411     | 418.3 | 12.47
Output  | 0.014667   | 0.036711   | 0.080623   |  11.9 |  0.02
Modify  | 16.068     | 16.336     | 16.76      |   7.3 | 10.01
Other   |            | 0.114      |            |       |  0.07

Nlocal:         45.625 ave          55 max          37 min
Histogram: 1 1 1 1 1 0 0 1 1 1
Nghost:        2810.88 ave        2849 max        2779 min
Histogram: 1 2 1 0 1 0 0 1 1 1
Neighs:        24796.9 ave       29397 max       20496 min
Histogram: 1 1 1 1 1 0 0 1 1 1

Total # of neighbors = 198375
Ave neighs/atom = 543.49315
Ave special neighs/atom = 0
Neighbor list builds = 80
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 17.6144
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.8795)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.6144
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.9345999999999996533, deltaxy = 0.069346
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 2.0880000000000000782, deltaxz = -0.02088
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.87949999999999994849, deltayz = -0.008795
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -0.176144 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz 100 dump/neg_deform4.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.1 | 112 | 113.2 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34809     -37409.389      1263.4014      4609.3376    
       100   277.6164      -37385.684      6847.2069      4609.3376    
       200   339.09039     -37426.316     -4453.638       4609.3376    
       300   341.00717     -37411.501      1019.2549      4609.3376    
       400   297.65215     -37402.658     -11330.28       4609.3376    
       500   311.50114     -37430.815      3936.7991      4609.3376    
       600   286.82666     -37393.721     -7942.5574      4609.3376    
       700   320.22552     -37413.038     -9126.1263      4609.3376    
       800   323.4817      -37414.315     -1714.2503      4609.3376    
       900   296.52002     -37417.715     -8975.4521      4609.3376    
      1000   300.45497     -37438.21       4241.1104      4609.3376    
      1100   295.18478     -37418.62       4424.3932      4609.3376    
      1200   312.32334     -37413.808     -8671.5276      4609.3376    
      1300   311.60496     -37406.419     -6985.3683      4609.3376    
      1400   295.51233     -37393.972     -4773.875       4609.3376    
      1500   315.4802      -37414.133     -10975.469      4609.3376    
      1600   310.57678     -37414.962     -5407.6474      4609.3376    
      1700   301.58279     -37409.252      3600.7981      4609.3376    
      1800   276.77475     -37388.074     -360.93409      4609.3376    
      1900   302.4313      -37416.1        3185.2615      4609.3376    
      2000   319.27178     -37399.8       -9442.579       4609.3376    
      2100   322.38044     -37389.743     -3334.4358      4609.3376    
      2200   304.85771     -37404.628     -2571.7158      4609.3376    
      2300   300.75829     -37421.41      -3582.3325      4609.3376    
      2400   281.94578     -37408.946      1897.2709      4609.3376    
      2500   295.06724     -37407.614      5637.1536      4609.3376    
      2600   321.61143     -37405.691     -3832.5959      4609.3376    
      2700   321.74224     -37407.612     -2702.6063      4609.3376    
      2800   301.39366     -37406.108     -6415.9874      4609.3376    
      2900   309.39067     -37422.488     -11294.927      4609.3376    
      3000   304.62505     -37420.294     -5830.8694      4609.3376    
      3100   310.52279     -37431.956     -6221.7598      4609.3376    
      3200   278.6377      -37412.704      431.34871      4609.3376    
      3300   295.67354     -37434.718     -2973.0971      4609.3376    
      3400   302.81532     -37415.032      4780.9168      4609.3376    
      3500   309.45632     -37405.706      7313.2456      4609.3376    
      3600   305.69519     -37407.328      6982.9335      4609.3376    
      3700   282.67423     -37398.798     -12192.888      4609.3376    
      3800   273.39112     -37424.819     -4154.7904      4609.3376    
      3900   280.38766     -37426.62      -7335.114       4609.3376    
      4000   290.82751     -37418.36      -3919.6431      4609.3376    
      4100   282.8755      -37396.597     -2037.824       4609.3376    
      4200   314.75165     -37420.379     -3720.7401      4609.3376    
      4300   308.11517     -37412.339      617.26378      4609.3376    
      4400   272.36238     -37393.243     -12568.205      4609.3376    
      4500   291.11326     -37434.237      655.8167       4609.3376    
      4600   299.48534     -37433.016     -7413.0874      4609.3376    
      4700   309.47544     -37410.62      -622.78759      4609.3376    
      4800   311.69712     -37407.247     -6771.8089      4609.3376    
      4900   283.37985     -37388.154     -15912.074      4609.3376    
      5000   306.59634     -37430.96       12673.874      4609.3376    
Loop time of 162.849 on 16 procs for 5000 steps with 365 atoms

Performance: 1.326 ns/day, 18.094 hours/ns, 30.703 timesteps/s, 11.207 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 98.959     | 124.77     | 142.95     | 172.7 | 76.62
Bond    | 0.012561   | 0.013486   | 0.014604   |   0.5 |  0.01
Neigh   | 1.3845     | 1.7668     | 2.0217     |  21.4 |  1.08
Comm    | 1.814      | 19.984     | 45.795     | 431.2 | 12.27
Output  | 0.014609   | 0.036574   | 0.080327   |  11.9 |  0.02
Modify  | 15.89      | 16.166     | 16.58      |   7.4 |  9.93
Other   |            | 0.1142     |            |       |  0.07

Nlocal:         45.625 ave          52 max          40 min
Histogram: 1 3 0 0 1 0 0 0 0 3
Nghost:        2824.88 ave        2850 max        2809 min
Histogram: 3 0 1 1 0 1 0 0 1 1
Neighs:        25012.6 ave       28185 max       22008 min
Histogram: 1 2 1 0 1 0 0 0 0 3

Total # of neighbors = 200101
Ave neighs/atom = 548.22192
Ave special neighs/atom = 0
Neighbor list builds = 80
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.6144
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 0.176144 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz 100 dump/pos_deform4.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.2 | 112.1 | 113.2 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34809     -37409.389      1263.4014      4609.3376    
       100   277.61676     -37385.688      6847.4642      4609.3376    
       200   338.92343     -37426.35      -4184.216       4609.3376    
       300   341.04506     -37412.036      642.44234      4609.3376    
       400   298.64834     -37404.359     -9233.771       4609.3376    
       500   313.46335     -37434.075      2847.857       4609.3376    
       600   287.97427     -37396.027     -9438.1678      4609.3376    
       700   315.73164     -37410.499     -10646.33       4609.3376    
       800   323.67851     -37413.126      304.70265      4609.3376    
       900   294.65459     -37412.562     -8287.0444      4609.3376    
      1000   299.45817     -37434.23      -1276.511       4609.3376    
      1100   292.76607     -37416.617      7823.1269      4609.3376    
      1200   317.70928     -37415.679     -3538.8409      4609.3376    
      1300   326.56196     -37417.391     -5687.132       4609.3376    
      1400   279.97927     -37375.088     -8326.2519      4609.3376    
      1500   297.77198     -37396.729     -11030.891      4609.3376    
      1600   336.34724     -37451.003     -3845.6815      4609.3376    
      1700   274.05138     -37415.038      2648.3235      4609.3376    
      1800   267.97152     -37429.895      3651.6807      4609.3376    
      1900   292.16301     -37438.18      -1863.869       4609.3376    
      2000   286.55044     -37409.595     -12633.52       4609.3376    
      2100   293.38338     -37403.025     -8471.0722      4609.3376    
      2200   306.19476     -37411.629     -6488.6043      4609.3376    
      2300   300.14323     -37408.02      -4073.0001      4609.3376    
      2400   297.7569      -37420.686     -2145.5178      4609.3376    
      2500   280.40337     -37416.69       3948.4668      4609.3376    
      2600   291.71822     -37426.245      1021.5291      4609.3376    
      2700   308.70648     -37413.961     -14528.715      4609.3376    
      2800   311.8503      -37403.759      1412.3655      4609.3376    
      2900   301.87275     -37402.094     -3672.7953      4609.3376    
      3000   285.38807     -37407.705     -7418.0216      4609.3376    
      3100   283.27851     -37424.605      2812.0599      4609.3376    
      3200   288.75482     -37427.089     -8566.755       4609.3376    
      3300   296.41106     -37392.5       -6378.103       4609.3376    
      3400   300.31036     -37384.841     -8207.2956      4609.3376    
      3500   315.01235     -37414.67       6965.3981      4609.3376    
      3600   287.49624     -37405.719      3716.7443      4609.3376    
      3700   288.82031     -37411.459     -2464.3104      4609.3376    
      3800   319.22147     -37420.131     -7194.4565      4609.3376    
      3900   315.91953     -37388.615     -7816.8138      4609.3376    
      4000   323.50166     -37412.373     -3700.4227      4609.3376    
      4100   309.46578     -37418.025      1835.8329      4609.3376    
      4200   296.82982     -37409.431     -2671.7439      4609.3376    
      4300   310.83918     -37419.705      2417.0621      4609.3376    
      4400   298.22064     -37399.826      2103.3241      4609.3376    
      4500   302.46909     -37414.433     -4069.2765      4609.3376    
      4600   286.51229     -37418.416     -1220.1704      4609.3376    
      4700   281.13246     -37425.141      2557.6229      4609.3376    
      4800   290.44827     -37426.275     -3778.6316      4609.3376    
      4900   303.84138     -37402.072      6480.6662      4609.3376    
      5000   308.39073     -37406.519     -9596.4869      4609.3376    
Loop time of 160.805 on 16 procs for 5000 steps with 365 atoms

Performance: 1.343 ns/day, 17.867 hours/ns, 31.094 timesteps/s, 11.349 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 98.89      | 122.57     | 140.03     | 148.1 | 76.22
Bond    | 0.012335   | 0.013472   | 0.014415   |   0.5 |  0.01
Neigh   | 1.2563     | 1.5819     | 1.8328     |  19.2 |  0.98
Comm    | 3.3475     | 20.791     | 44.478     | 359.3 | 12.93
Output  | 0.014561   | 0.036389   | 0.080878   |  12.1 |  0.02
Modify  | 15.421     | 15.694     | 16.046     |   6.5 |  9.76
Other   |            | 0.1169     |            |       |  0.07

Nlocal:         45.625 ave          56 max          37 min
Histogram: 1 0 2 1 2 0 0 0 1 1
Nghost:        2830.75 ave        2860 max        2802 min
Histogram: 2 1 1 0 0 0 0 1 1 2
Neighs:        25011.8 ave       30201 max       20554 min
Histogram: 1 0 2 1 2 0 0 0 1 1

Total # of neighbors = 200094
Ave neighs/atom = 548.20274
Ave special neighs/atom = 0
Neighbor list builds = 72
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 14.9838
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-2.088)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*14.9838
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.9345999999999996533, deltaxy = 0.069346
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 2.0880000000000000782, deltaxz = -0.02088
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.87949999999999994849, deltayz = -0.008795
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -0.149838 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz 100 dump/neg_deform5.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.1 | 112 | 113.2 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34809     -37409.389      1263.4014      4609.3376    
       100   277.61497     -37385.687      6847.5666      4609.3376    
       200   338.99957     -37426.326     -4254.7262      4609.3376    
       300   340.94048     -37411.766      775.69969      4609.3376    
       400   298.75384     -37404.363     -9628.612       4609.3376    
       500   313.71719     -37434.094      2984.8898      4609.3376    
       600   288.8192      -37397.164     -9488.3303      4609.3376    
       700   317.647       -37412.778     -9949.4882      4609.3376    
       800   321.15603     -37410.772     -16.653055      4609.3376    
       900   294.65346     -37408.872     -6269.911       4609.3376    
      1000   296.06108     -37431.681      1408.6553      4609.3376    
      1100   287.74805     -37414.317      9497.1378      4609.3376    
      1200   313.70997     -37414.08      -3391.3735      4609.3376    
      1300   311.0826      -37400.251     -6567.6969      4609.3376    
      1400   287.54596     -37383.431     -5274.5716      4609.3376    
      1500   283.10132     -37386.729     -10262.936      4609.3376    
      1600   314.7726      -37434.578     -749.1504       4609.3376    
      1700   291.77934     -37432.768      50.932057      4609.3376    
      1800   274.17449     -37420.515      1719.0711      4609.3376    
      1900   311.16736     -37431.462      1069.4357      4609.3376    
      2000   294.11076     -37395.217     -3162.3545      4609.3376    
      2100   309.43173     -37410.142     -10981.218      4609.3376    
      2200   304.41729     -37419.771     -2450.2403      4609.3376    
      2300   273.27111     -37405.394     -3307.4101      4609.3376    
      2400   289.9859      -37435.859     -6319.6167      4609.3376    
      2500   282.3928      -37410.959     -8057.0905      4609.3376    
      2600   296.92428     -37398.103     -14150.943      4609.3376    
      2700   317.79786     -37414.067     -12213.412      4609.3376    
      2800   286.40328     -37399.594      968.59715      4609.3376    
      2900   300.1271      -37437.524     -99.543293      4609.3376    
      3000   289.56839     -37423.386      17.505984      4609.3376    
      3100   293.90126     -37418.146     -3886.6265      4609.3376    
      3200   317.39256     -37435.502     -12664.641      4609.3376    
      3300   274.51666     -37379.724      3449.4109      4609.3376    
      3400   311.32616     -37393.575     -5015.9514      4609.3376    
      3500   327.10337     -37397.347     -9576.6888      4609.3376    
      3600   289.33631     -37391.575      2366.0285      4609.3376    
      3700   302.86957     -37419.424     -13942.456      4609.3376    
      3800   291.4326      -37410.869      801.68739      4609.3376    
      3900   299.36301     -37401.278     -4141.437       4609.3376    
      4000   315.42521     -37402.725     -10816.102      4609.3376    
      4100   298.05032     -37411.668     -980.44717      4609.3376    
      4200   274.52041     -37411.061     -6341.794       4609.3376    
      4300   295.82119     -37424.234     -68.039914      4609.3376    
      4400   313.25408     -37424.805     -14094.153      4609.3376    
      4500   308.07644     -37408.982     -1146.4635      4609.3376    
      4600   313.96152     -37423.873     -1087.3601      4609.3376    
      4700   268.21515     -37415.691     -5517.4378      4609.3376    
      4800   282.78995     -37423.14      -2371.6163      4609.3376    
      4900   287.7508      -37402.177      960.55731      4609.3376    
      5000   289.34501     -37389.436     -9953.2373      4609.3376    
Loop time of 159.613 on 16 procs for 5000 steps with 365 atoms

Performance: 1.353 ns/day, 17.735 hours/ns, 31.326 timesteps/s, 11.434 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 97.898     | 119.09     | 139.91     | 176.5 | 74.61
Bond    | 0.012525   | 0.013567   | 0.01471    |   0.5 |  0.01
Neigh   | 1.4343     | 1.7702     | 2.1117     |  23.2 |  1.11
Comm    | 2.3522     | 23.154     | 44.349     | 400.1 | 14.51
Output  | 0.014278   | 0.036016   | 0.079603   |  12.0 |  0.02
Modify  | 15.071     | 15.433     | 15.796     |   8.2 |  9.67
Other   |            | 0.1129     |            |       |  0.07

Nlocal:         45.625 ave          53 max          40 min
Histogram: 1 1 0 2 1 1 1 0 0 1
Nghost:        2802.38 ave        2834 max        2772 min
Histogram: 1 1 0 1 1 2 0 0 0 2
Neighs:        25008.2 ave       28664 max       22074 min
Histogram: 1 1 0 2 1 1 1 0 0 1

Total # of neighbors = 200066
Ave neighs/atom = 548.12603
Ave special neighs/atom = 0
Neighbor list builds = 83
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*14.9838
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 0.149838 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz 100 dump/pos_deform5.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.2 | 112.1 | 113.2 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34809     -37409.389      1263.4014      4609.3376    
       100   277.61821     -37385.686      6846.9688      4609.3376    
       200   338.99353     -37426.299     -4343.2048      4609.3376    
       300   341.04146     -37411.681      835.57338      4609.3376    
       400   298.93446     -37404.685     -11843.765      4609.3376    
       500   313.03195     -37433.334      4105.7422      4609.3376    
       600   287.56776     -37395.688     -7645.9225      4609.3376    
       700   318.78706     -37413.933     -9517.5116      4609.3376    
       800   323.12794     -37412.772     -396.98524      4609.3376    
       900   297.10678     -37410.746     -7789.0287      4609.3376    
      1000   297.91839     -37433.796      1196.6523      4609.3376    
      1100   284.16995     -37410.265      4882.8275      4609.3376    
      1200   317.67803     -37418.113     -3899.1787      4609.3376    
      1300   310.88507     -37403.064     -7335.8138      4609.3376    
      1400   288.10654     -37382.106     -5130.1462      4609.3376    
      1500   303.74781     -37397.542     -10228.832      4609.3376    
      1600   320.58667     -37424.106     -4242.2615      4609.3376    
      1700   284.95807     -37408.021     -624.42681      4609.3376    
      1800   297.20838     -37430.114     -486.49981      4609.3376    
      1900   294.87752     -37409.074      4206.5908      4609.3376    
      2000   314.61481     -37398.08      -11271.886      4609.3376    
      2100   318.40292     -37405.127     -8244.7535      4609.3376    
      2200   290.52027     -37391.863     -1961.0905      4609.3376    
      2300   285.5182      -37397.86      -3014.9059      4609.3376    
      2400   294.62277     -37407.861      2612.3895      4609.3376    
      2500   291.24074     -37393.071      5453.9221      4609.3376    
      2600   320.05136     -37389.456      3957.7301      4609.3376    
      2700   306.06881     -37395.874     -15111.592      4609.3376    
      2800   307.0663      -37419.352     -9746.3102      4609.3376    
      2900   303.74832     -37426.643      2227.5413      4609.3376    
      3000   285.48175     -37412.741     -4988.4052      4609.3376    
      3100   304.63838     -37413.08      -3749.3759      4609.3376    
      3200   315.0103      -37389.963      3411.8859      4609.3376    
      3300   313.99834     -37397.733     -11338.72       4609.3376    
      3400   301.55933     -37407.594     -15664.098      4609.3376    
      3500   294.71703     -37413.401     -12039.701      4609.3376    
      3600   295.27746     -37413.969     -1229.1316      4609.3376    
      3700   309.92308     -37416.705     -5569.6089      4609.3376    
      3800   328.09214     -37395.078     -7551.0325      4609.3376    
      3900   327.14727     -37395.65      -8764.4624      4609.3376    
      4000   307.3793      -37395.973      349.14114      4609.3376    
      4100   309.54649     -37418.7       -3609.1013      4609.3376    
      4200   282.59521     -37406.077     -11862.567      4609.3376    
      4300   282.6982      -37414.07       391.87616      4609.3376    
      4400   300.21202     -37408.063      10675.145      4609.3376    
      4500   310.0584      -37392.423      10043.28       4609.3376    
      4600   296.34814     -37388.054     -5644.7342      4609.3376    
      4700   307.61997     -37420.073      496.52375      4609.3376    
      4800   297.82979     -37423.962     -4958.6066      4609.3376    
      4900   289.30439     -37408.908      5382.8338      4609.3376    
      5000   298.97328     -37412.638      11448.935      4609.3376    
Loop time of 159.958 on 16 procs for 5000 steps with 365 atoms

Performance: 1.350 ns/day, 17.773 hours/ns, 31.258 timesteps/s, 11.409 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 97.906     | 118.95     | 140.03     | 175.1 | 74.36
Bond    | 0.012803   | 0.013735   | 0.014649   |   0.4 |  0.01
Neigh   | 1.3747     | 1.6878     | 2.0169     |  22.7 |  1.06
Comm    | 2.4384     | 23.503     | 44.549     | 393.9 | 14.69
Output  | 0.014409   | 0.035913   | 0.079884   |  12.1 |  0.02
Modify  | 15.303     | 15.651     | 15.99      |   7.8 |  9.78
Other   |            | 0.1166     |            |       |  0.07

Nlocal:         45.625 ave          54 max          39 min
Histogram: 1 1 2 0 1 0 0 1 1 1
Nghost:        2810.25 ave        2834 max        2784 min
Histogram: 1 0 2 1 0 0 1 0 2 1
Neighs:          25000 ave       29201 max       21493 min
Histogram: 1 1 1 2 0 0 0 1 1 1

Total # of neighbors = 200000
Ave neighs/atom = 547.94521
Ave special neighs/atom = 0
Neighbor list builds = 79
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.4642
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--6.9346)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.4642
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -6.9345999999999996533, deltaxy = 0.069346
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 2.0880000000000000782, deltaxz = -0.02088
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.87949999999999994849, deltayz = -0.008795
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -0.174642 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz 100 dump/neg_deform6.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.1 | 112 | 113.2 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34809     -37409.389      1263.4014      4609.3376    
       100   277.61861     -37385.681      6848.242       4609.3376    
       200   338.99968     -37426.307     -4503.0871      4609.3376    
       300   340.64719     -37411.308      669.84033      4609.3376    
       400   299.42665     -37404.319     -12471.694      4609.3376    
       500   313.49955     -37433.427      4398.4278      4609.3376    
       600   288.04282     -37396.041     -7344.5481      4609.3376    
       700   321.58594     -37417.627     -7557.0483      4609.3376    
       800   325.34098     -37416.638     -2450.9681      4609.3376    
       900   292.90294     -37406.555     -4647.8469      4609.3376    
      1000   297.49272     -37431.316      4386.3556      4609.3376    
      1100   280.99076     -37402.729      8567.004       4609.3376    
      1200   321.58037     -37418.436     -8160.4127      4609.3376    
      1300   312.32517     -37403.641     -3773.8348      4609.3376    
      1400   284.3678      -37381.004     -5962.8538      4609.3376    
      1500   284.44184     -37393.049     -11973.732      4609.3376    
      1600   320.40037     -37445.898     -3580.7718      4609.3376    
      1700   285.45774     -37433.015      3247.1361      4609.3376    
      1800   275.72959     -37421.751      5995.1089      4609.3376    
      1900   309.48178     -37426.557      5747.3485      4609.3376    
      2000   313.18425     -37417.181     -3981.596       4609.3376    
      2100   300.77587     -37410.154     -11711.919      4609.3376    
      2200   288.51122     -37407.731      2353.3197      4609.3376    
      2300   272.42727     -37410.889     -6896.6742      4609.3376    
      2400   284.56063     -37414.773      2259.4373      4609.3376    
      2500   309.73674     -37404.223      4240.6318      4609.3376    
      2600   311.49029     -37406.254      8055.5403      4609.3376    
      2700   299.14156     -37417.042     -4374.6751      4609.3376    
      2800   292.55985     -37422.099     -12617.982      4609.3376    
      2900   307.5824      -37432.417     -10244.941      4609.3376    
      3000   311.40396     -37398.629     -2277.778       4609.3376    
      3100   304.44025     -37377.148     -9938.247       4609.3376    
      3200   309.65671     -37405.381      2439.8434      4609.3376    
      3300   307.88089     -37414.521      11.493953      4609.3376    
      3400   311.9482      -37423.809      1712.964       4609.3376    
      3500   305.38688     -37433.187     -1446.2191      4609.3376    
      3600   272.67651     -37435.722      3259.8294      4609.3376    
      3700   291.10833     -37453.035     -4032.4811      4609.3376    
      3800   291.72941     -37428.643     -5686.5796      4609.3376    
      3900   292.85768     -37411.907     -9042.7212      4609.3376    
      4000   320.51699     -37429.331     -5412.5673      4609.3376    
      4100   307.79504     -37407.723      3919.3688      4609.3376    
      4200   319.78009     -37417.756      778.0857       4609.3376    
      4300   309.46898     -37431.828     -9179.9614      4609.3376    
      4400   279.22831     -37424.127      5984.4111      4609.3376    
      4500   283.09486     -37421.091     -13382.917      4609.3376    
      4600   307.34344     -37419.176     -5071.3016      4609.3376    
      4700   317.06012     -37421.811     -326.76915      4609.3376    
      4800   320.33651     -37433.372     -1256.9331      4609.3376    
      4900   292.6753      -37422.071     -11502.255      4609.3376    
      5000   290.4371      -37443.258     -1454.8501      4609.3376    
Loop time of 160.575 on 16 procs for 5000 steps with 365 atoms

Performance: 1.345 ns/day, 17.842 hours/ns, 31.138 timesteps/s, 11.365 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 98.881     | 119.87     | 140.35     | 175.3 | 74.65
Bond    | 0.01291    | 0.013673   | 0.014988   |   0.5 |  0.01
Neigh   | 1.2884     | 1.5845     | 1.8948     |  21.9 |  0.99
Comm    | 2.9488     | 23.421     | 44.413     | 396.4 | 14.59
Output  | 0.014155   | 0.035734   | 0.07918    |  12.0 |  0.02
Modify  | 15.206     | 15.537     | 15.855     |   7.3 |  9.68
Other   |            | 0.1143     |            |       |  0.07

Nlocal:         45.625 ave          53 max          40 min
Histogram: 2 2 0 1 0 0 0 1 0 2
Nghost:        2835.88 ave        2866 max        2804 min
Histogram: 1 0 3 0 0 0 2 0 0 2
Neighs:        24997.1 ave       28626 max       22135 min
Histogram: 2 2 0 0 1 0 0 0 1 2

Total # of neighbors = 199977
Ave neighs/atom = 547.88219
Ave special neighs/atom = 0
Neighbor list builds = 74
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (17.6144 14.9838 17.4642) with tilt (-6.9346 2.088 0.8795)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  365 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.4642
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 0.174642 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz 100 dump/pos_deform6.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 111.2 | 112.1 | 113.2 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   294.34809     -37409.389      1263.4014      4609.3376    
       100   277.61457     -37385.691      6846.5753      4609.3376    
       200   339.01197     -37426.302     -4155.6384      4609.3376    
       300   341.33423     -37412.056      903.62503      4609.3376    
       400   298.86765     -37405.059     -9691.2657      4609.3376    
       500   313.62524     -37434.194      2671.1438      4609.3376    
       600   287.3314      -37395.807     -8388.4454      4609.3376    
       700   314.41359     -37406.379     -9685.5636      4609.3376    
       800   320.82133     -37408.4        2443.1632      4609.3376    
       900   289.99672     -37408.042     -12579.762      4609.3376    
      1000   302.52389     -37441.342      2568.8828      4609.3376    
      1100   290.25911     -37418.605      6252.1096      4609.3376    
      1200   311.89299     -37413.43      -2244.5153      4609.3376    
      1300   326.44138     -37422.353     -11279.898      4609.3376    
      1400   281.35607     -37380.634     -55.857765      4609.3376    
      1500   297.44684     -37399.069     -11421.903      4609.3376    
      1600   317.80545     -37435.082     -5195.8371      4609.3376    
      1700   282.5007      -37424.785      5376.4282      4609.3376    
      1800   271.25736     -37406.85      -3917.304       4609.3376    
      1900   310.36122     -37418.313     -8295.7491      4609.3376    
      2000   295.97799     -37391.205      2165.029       4609.3376    
      2100   306.96128     -37403.753     -8535.3692      4609.3376    
      2200   294.91917     -37415.897      9876.7309      4609.3376    
      2300   292.94257     -37433.052     -3914.037       4609.3376    
      2400   297.59692     -37431.561      1494.4143      4609.3376    
      2500   285.40066     -37406.681     -3324.598       4609.3376    
      2600   299.45435     -37406.33      -12316.418      4609.3376    
      2700   318.60223     -37414.842     -9283.0505      4609.3376    
      2800   301.9082      -37392.863     -812.53926      4609.3376    
      2900   292.97781     -37405.79      -2035.3946      4609.3376    
      3000   290.27846     -37429.847     -10815.116      4609.3376    
      3100   289.0791      -37430.41      -5306.983       4609.3376    
      3200   301.85247     -37428.84      -12398.016      4609.3376    
      3300   323.93423     -37422.771     -4182.6576      4609.3376    
      3400   307.81791     -37408.714      1141.5655      4609.3376    
      3500   318.21804     -37429.193     -6730.0083      4609.3376    
      3600   298.00511     -37422.721      2791.2371      4609.3376    
      3700   292.874       -37421.472     -9922.1319      4609.3376    
      3800   287.36055     -37409.806     -4439.6301      4609.3376    
      3900   318.33905     -37423.529     -4342.9814      4609.3376    
      4000   284.38286     -37391.85      -2164.4677      4609.3376    
      4100   302.11109     -37434.512     -6447.669       4609.3376    
      4200   265.6098      -37419.413     -814.28155      4609.3376    
      4300   275.40361     -37461.764     -12793.351      4609.3376    
      4400   264.50955     -37431.208     -9354.6579      4609.3376    
      4500   267.53761     -37412.023     -8964.0198      4609.3376    
      4600   302.13401     -37428.215     -3237.1044      4609.3376    
      4700   311.9018      -37416.682     -284.55669      4609.3376    
      4800   321.58962     -37416.263     -7846.8225      4609.3376    
      4900   310.05408     -37408.569     -9121.4387      4609.3376    
      5000   287.11888     -37420.601      5679.2413      4609.3376    
Loop time of 162.819 on 16 procs for 5000 steps with 365 atoms

Performance: 1.327 ns/day, 18.091 hours/ns, 30.709 timesteps/s, 11.209 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 98.29      | 119.34     | 140.02     | 158.1 | 73.30
Bond    | 0.01268    | 0.013522   | 0.014976   |   0.6 |  0.01
Neigh   | 1.2283     | 1.51       | 1.794      |  18.6 |  0.93
Comm    | 4.88       | 25.547     | 46.604     | 341.9 | 15.69
Output  | 0.015164   | 0.041405   | 0.094446   |  13.6 |  0.03
Modify  | 15.948     | 16.248     | 16.549     |   5.8 |  9.98
Other   |            | 0.1165     |            |       |  0.07

Nlocal:         45.625 ave          54 max          37 min
Histogram: 1 0 1 0 2 1 1 1 0 1
Nghost:        2820.75 ave        2848 max        2804 min
Histogram: 3 1 1 0 0 1 0 0 0 2
Neighs:        25015.5 ave       29318 max       20474 min
Histogram: 1 0 0 1 2 1 1 1 0 1

Total # of neighbors = 200124
Ave neighs/atom = 548.28493
Ave special neighs/atom = 0
Neighbor list builds = 71
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:32:42
