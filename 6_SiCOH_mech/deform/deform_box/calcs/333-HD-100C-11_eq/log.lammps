LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
# boundary        s s s
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 0.1
variable FF string "SiOCHN_2018.ff C H O Si"          # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff C H O Si
# pair_coeff * * CHOSiNa.ff C H O Si
# pair_coeff * * SiOCHN_2018.ff C H O Si
# pair_coeff * * PDMSDecomp.ff C H O Si
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# Read the initial sctructure
# box tilt large
variable structure string 333-HD-100C-11_eq

read_data       ${structure}.data
read_data       333-HD-100C-11_eq.data
Reading data file ...
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  366 atoms
  reading velocities ...
  366 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.008 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400

# # Energy minimization
# print "*****Minimization starts.*****"
# minimize 1.0e-6 1.0e-6 100 1000
# min_style cg
# # Save the optimized structure
# write_data ${structure}_opt.data
# velocity        all create ${temp} ${seed} dist gaussian

# # Equilibration
# include ff.mod.lmp
# if "$(is_defined(fix,avgp))" then "unfix avgp"
# if "$(is_defined(fix,avgl))" then "unfix avgl"
# thermo_style custom step temp pe press density vol
# run ${nequil}
# # Save the equilibrated structure
# write_data ${structure}_eq.data

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 15.0372
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 13.535
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 17.6074

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.0807
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal -0.1585
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -7.4931

# Write restart
write_restart equil.res
System init for write_restart ...
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 15.0372
variable dlen equal lx-${len0}
variable dlen equal lx-15.0372
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.0372
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.074931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.001585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.000807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.150372 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.150372 xy delta 0.074931 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.150372 xy delta 0.074931 xz delta 0.001585 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz 100 dump/neg_deform1.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.6 | 140.3 | 143.4 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   326.30211     -41200.028      8430.9844      3583.6077    
       100   298.0651      -41179.183      19158.21       3582.891     
       200   293.51454     -41207.143      19050.351      3582.1743    
       300   280.23109     -41204.393      27269.946      3581.4576    
       400   287.39233     -41195.54       22260.647      3580.7409    
       500   288.20376     -41179.841      3196.4811      3580.0241    
       600   301.02725     -41183.687      13830.755      3579.3074    
       700   312.26447     -41192.358      16808.824      3578.5907    
       800   280.49101     -41182.351      19523.282      3577.874     
       900   282.46994     -41209.383     -3008.7199      3577.1573    
      1000   279.08152     -41194.153      8334.2051      3576.4405    
      1100   305.10578     -41193.406      20245.747      3575.7238    
      1200   301.92103     -41191.012      4343.5188      3575.0071    
      1300   301.75016     -41197.348      4660.4124      3574.2904    
      1400   306.09532     -41195.537      15855.612      3573.5736    
      1500   298.85338     -41181.861      16955.636      3572.8569    
      1600   307.30914     -41185.955      21016.022      3572.1402    
      1700   277.47096     -41163.169      15723.783      3571.4235    
      1800   293.01116     -41181.94       6867.6334      3570.7068    
      1900   329.498       -41213.3        12171.185      3569.99      
      2000   299.65615     -41182.242      14262.512      3569.2733    
      2100   303.62862     -41202.725      11771.768      3568.5566    
      2200   290.8961      -41205.827      15989.34       3567.8399    
      2300   294.33709     -41200.579      7750.1561      3567.1232    
      2400   318.39702     -41189.323      22187.952      3566.4064    
      2500   305.19186     -41179.973      17544.754      3565.6897    
      2600   312.30828     -41202.233      7706.7426      3564.973     
      2700   277.13729     -41184.7        5912.4783      3564.2563    
      2800   299.6444      -41201.739      20403.108      3563.5395    
      2900   316.0222      -41175.647      20110.411      3562.8228    
      3000   309.49686     -41163.197      11703.934      3562.1061    
      3100   313.19991     -41193.202      12943.937      3561.3894    
      3200   289.23334     -41193.533      3568.2321      3560.6727    
      3300   301.39842     -41205.632      16208.868      3559.9559    
      3400   310.34817     -41194.347      22274.899      3559.2392    
      3500   315.35262     -41190.962      17869.294      3558.5225    
      3600   287.75158     -41175.486      24178.093      3557.8058    
      3700   292.66445     -41188.257      22282.179      3557.089     
      3800   285.96171     -41174.44       15329.065      3556.3723    
      3900   296.52124     -41174.55       7860.2897      3555.6556    
      4000   306.06209     -41179.095      16280.931      3554.9389    
      4100   303.61945     -41201.078      11708.991      3554.2222    
      4200   292.91623     -41208.418      1756.7622      3553.5054    
      4300   305.24531     -41211.018      23150.936      3552.7887    
      4400   316.56858     -41185.674      12215.33       3552.072     
      4500   316.04438     -41173.112      14538.83       3551.3553    
      4600   313.73946     -41179.882      27230.145      3550.6386    
      4700   312.67905     -41199.276      12412.602      3549.9218    
      4800   282.4148      -41187.038      8650.3557      3549.2051    
      4900   286.3127      -41187.628      25139.857      3548.4884    
      5000   302.23293     -41194.873      93.435297      3547.7717    
Loop time of 253.933 on 16 procs for 5000 steps with 366 atoms

Performance: 0.851 ns/day, 28.215 hours/ns, 19.690 timesteps/s, 7.207 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 180.42     | 210.43     | 226.56     | 108.5 | 82.87
Bond    | 0.012782   | 0.013619   | 0.014711   |   0.7 |  0.01
Neigh   | 1.894      | 2.099      | 2.2751     |   8.8 |  0.83
Comm    | 3.57       | 19.79      | 49.812     | 354.0 |  7.79
Output  | 0.016826   | 0.044438   | 0.10124    |  14.1 |  0.02
Modify  | 21.278     | 21.422     | 21.607     |   2.8 |  8.44
Other   |            | 0.1345     |            |       |  0.05

Nlocal:          45.75 ave          52 max          37 min
Histogram: 1 0 1 1 0 0 1 1 2 1
Nghost:        3616.62 ave        3736 max        3499 min
Histogram: 1 0 1 1 1 1 1 1 0 1
Neighs:        33122.1 ave       37459 max       26836 min
Histogram: 1 0 1 1 0 0 1 1 1 2

Total # of neighbors = 264977
Ave neighs/atom = 723.98087
Ave special neighs/atom = 0
Neighbor list builds = 56
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.0372
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.150372 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.150372 xy delta -0.074931 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.150372 xy delta -0.074931 xz delta -0.001585 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz 100 dump/pos_deform1.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.6 | 140.3 | 143.4 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   326.30211     -41200.028      8430.9844      3583.6077    
       100   298.05067     -41179.183      19150.348      3584.3245    
       200   292.31555     -41205.367      17712.447      3585.0412    
       300   282.72782     -41207.493      25121.473      3585.7579    
       400   287.64244     -41196.643      7220.6008      3586.4746    
       500   303.59043     -41197.474     -4082.9826      3587.1914    
       600   299.35713     -41182.956      6491.4543      3587.9081    
       700   300.46214     -41177.113      11006.954      3588.6248    
       800   314.54589     -41176.951      7239.0559      3589.3415    
       900   312.16554     -41181.586      18367.603      3590.0582    
      1000   296.74814     -41191.173      5472.0332      3590.775     
      1100   282.99803     -41190.722      5008.2063      3591.4917    
      1200   297.30897     -41199.825      283.41555      3592.2084    
      1300   315.81925     -41184.856      23968.225      3592.9251    
      1400   329.05635     -41188.356      10202.843      3593.6418    
      1500   306.06928     -41181.351      11057.763      3594.3586    
      1600   305.20483     -41195.224      11154.648      3595.0753    
      1700   289.86997     -41186.792      3320.9352      3595.792     
      1800   291.60877     -41187.84       14340.294      3596.5087    
      1900   305.00041     -41174.913      26535.588      3597.2255    
      2000   314.82793     -41176.851     -5872.4864      3597.9422    
      2100   303.62415     -41187.325      6774.7214      3598.6589    
      2200   283.71589     -41186.606      18038.843      3599.3756    
      2300   289.23401     -41187.862      23707.02       3600.0923    
      2400   303.89169     -41186.356      10471.284      3600.8091    
      2500   320.74738     -41195.194      11388.478      3601.5258    
      2600   295.57401     -41173.464      9579.263       3602.2425    
      2700   316.07224     -41200.381     -1858.6414      3602.9592    
      2800   300.13739     -41194.449      8742.4539      3603.6759    
      2900   292.18148     -41205.196     -1515.544       3604.3927    
      3000   290.98986     -41205.412      8597.4548      3605.1094    
      3100   297.60262     -41187.202      1851.0834      3605.8261    
      3200   313.62055     -41177.904      9960.0601      3606.5428    
      3300   309.15299     -41169.899      12310.025      3607.2596    
      3400   299.64633     -41186.108      6421.912       3607.9763    
      3500   303.08885     -41209.267      2213.1242      3608.693     
      3600   280.45616     -41176.711     -176.68375      3609.4097    
      3700   302.02879     -41181.09       11183.123      3610.1264    
      3800   302.87839     -41172.232      2593.8746      3610.8432    
      3900   305.2718      -41179.525      3905.8235      3611.5599    
      4000   285.70435     -41188.02       10430.788      3612.2766    
      4100   268.97939     -41187.25       10065.405      3612.9933    
      4200   278.93777     -41179.257      7965.6699      3613.7101    
      4300   312.25891     -41193.661      2050.8884      3614.4268    
      4400   286.68429     -41161.487      9948.4256      3615.1435    
      4500   304.84087     -41185.881      3473.9215      3615.8602    
      4600   309.09277     -41200.261      20334.96       3616.5769    
      4700   268.78579     -41180.364      14891.057      3617.2937    
      4800   301.46944     -41222.415      6644.9708      3618.0104    
      4900   300.32222     -41208.726     -6289.9004      3618.7271    
      5000   302.12334     -41181.449     -5225.2528      3619.4438    
Loop time of 264.011 on 16 procs for 5000 steps with 366 atoms

Performance: 0.818 ns/day, 29.335 hours/ns, 18.939 timesteps/s, 6.932 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 206.66     | 218.54     | 231.32     |  50.3 | 82.78
Bond    | 0.013207   | 0.014494   | 0.015825   |   0.8 |  0.01
Neigh   | 1.9514     | 2.0495     | 2.1676     |   5.0 |  0.78
Comm    | 8.4284     | 21.265     | 33.159     | 161.4 |  8.05
Output  | 0.022245   | 0.049854   | 0.10581    |  13.3 |  0.02
Modify  | 21.733     | 21.845     | 21.958     |   1.6 |  8.27
Other   |            | 0.2428     |            |       |  0.09

Nlocal:          45.75 ave          53 max          40 min
Histogram: 1 1 2 1 0 0 1 0 1 1
Nghost:        3559.25 ave        3655 max        3471 min
Histogram: 1 1 1 0 2 0 1 1 0 1
Neighs:        32474.4 ave       37392 max       28453 min
Histogram: 1 1 2 0 1 0 0 1 1 1

Total # of neighbors = 259795
Ave neighs/atom = 709.8224
Ave special neighs/atom = 0
Neighbor list builds = 54
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 13.535
variable dlen equal ly-${len0}
variable dlen equal ly-13.535
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.535
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.074931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.001585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.000807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.13535 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.13535 yz delta -0.000807 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz 100 dump/neg_deform2.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.6 | 140.3 | 143.4 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   326.30211     -41200.028      8430.9844      3583.6077    
       100   298.04305     -41179.183      19157.904      3582.891     
       200   291.96223     -41205.232      17916.497      3582.1743    
       300   281.41015     -41205.816      29496.238      3581.4576    
       400   291.08578     -41199.706      9485.7683      3580.7409    
       500   296.30049     -41188.616     -5504.5027      3580.0241    
       600   300.6062      -41184.203      6907.4604      3579.3074    
       700   296.89888     -41182.594      10850.51       3578.5907    
       800   290.48961     -41200.176      24023.878      3577.874     
       900   285.99613     -41218.976      6842.7652      3577.1573    
      1000   279.09029     -41194.447      22415.443      3576.4405    
      1100   310.53282     -41198.254      20238.983      3575.7238    
      1200   317.577       -41206.192      9192.0878      3575.0071    
      1300   305.51058     -41197.371      24362.794      3574.2904    
      1400   295.00054     -41186.017      23220.989      3573.5736    
      1500   279.9929      -41202.818     -2916.526       3572.8569    
      1600   279.57078     -41206.894      951.27182      3572.1402    
      1700   283.18664     -41183.642     -1253.7191      3571.4235    
      1800   295.31941     -41180.588      14978.73       3570.7068    
      1900   304.74666     -41180.917      2043.0317      3569.99      
      2000   319.51265     -41205.957      662.83299      3569.2733    
      2100   282.54516     -41197.529      16103.079      3568.5566    
      2200   288.17603     -41204.146      9479.7006      3567.8399    
      2300   280.9362      -41184.453      12344.095      3567.1232    
      2400   298.3226      -41190.479      1672.8492      3566.4064    
      2500   292.00117     -41170.765      12985.227      3565.6897    
      2600   293.92293     -41170.538      9026.1007      3564.973     
      2700   303.83984     -41201.873      4238.0163      3564.2563    
      2800   287.2132      -41210.279      9490.9852      3563.5395    
      2900   281.94939     -41202.191      7340.73        3562.8228    
      3000   303.61636     -41199.38       14283.516      3562.1061    
      3100   315.93018     -41193.844      4059.2424      3561.3894    
      3200   312.18385     -41198.125      21941.211      3560.6727    
      3300   277.65398     -41176.261      18184.026      3559.9559    
      3400   301.89265     -41200.086      20145.566      3559.2392    
      3500   292.33454     -41184.748      17879.754      3558.5225    
      3600   298.60491     -41190.26       13915.332      3557.8058    
      3700   290.29478     -41168.996      12101.239      3557.089     
      3800   329.18942     -41197.26       12862.519      3556.3723    
      3900   316.4782      -41192.468      24324.794      3555.6556    
      4000   292.64029     -41195.664      17957.429      3554.9389    
      4100   296.16546     -41202.352      11548.48       3554.2222    
      4200   292.33929     -41185.861      20538.062      3553.5054    
      4300   322.47791     -41184.485      4399.7258      3552.7887    
      4400   321.69465     -41181.016      13651.097      3552.072     
      4500   297.32534     -41194.895      18234.202      3551.3553    
      4600   285.32105     -41188.245      15436.762      3550.6386    
      4700   304.94379     -41198.966      13626.889      3549.9218    
      4800   316.34035     -41200.691      16986.514      3549.2051    
      4900   301.04721     -41182.66       5570.7011      3548.4884    
      5000   308.76759     -41203.277      11442.158      3547.7717    
Loop time of 271.103 on 16 procs for 5000 steps with 366 atoms

Performance: 0.797 ns/day, 30.123 hours/ns, 18.443 timesteps/s, 6.750 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 218.54     | 229.37     | 236.96     |  37.6 | 84.61
Bond    | 0.013874   | 0.01493    | 0.015797   |   0.6 |  0.01
Neigh   | 2.1373     | 2.2197     | 2.3692     |   4.8 |  0.82
Comm    | 9.4778     | 17.027     | 27.876     | 137.9 |  6.28
Output  | 0.026435   | 0.052762   | 0.10651    |  12.4 |  0.02
Modify  | 22.029     | 22.167     | 22.235     |   1.7 |  8.18
Other   |            | 0.2526     |            |       |  0.09

Nlocal:          45.75 ave          52 max          37 min
Histogram: 1 0 0 0 1 0 4 1 0 1
Nghost:        3612.12 ave        3718 max        3517 min
Histogram: 1 1 0 2 0 1 1 1 0 1
Neighs:        33128.9 ave       37420 max       26862 min
Histogram: 1 0 0 0 1 0 4 1 0 1

Total # of neighbors = 265031
Ave neighs/atom = 724.12842
Ave special neighs/atom = 0
Neighbor list builds = 57
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.535
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.13535 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.13535 yz delta 0.000807 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz 100 dump/pos_deform2.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.6 | 140.3 | 143.4 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   326.30211     -41200.028      8430.9844      3583.6077    
       100   298.07282     -41179.183      19150.656      3584.3245    
       200   293.64345     -41207.012      18680.058      3585.0412    
       300   280.86781     -41204.767      28000.015      3585.7579    
       400   287.54088     -41196.318      7148.0543      3586.4746    
       500   304.62174     -41195.614     -5478.9951      3587.1914    
       600   290.68416     -41171.879      2167.3236      3587.9081    
       700   310.30562     -41188.783      23368.532      3588.6248    
       800   312.23289     -41174.052      19007.809      3589.3415    
       900   286.03903     -41139.316      8171.3183      3590.0582    
      1000   304.47174     -41186.463      5859.2081      3590.775     
      1100   293.67459     -41189.459      10180.078      3591.4917    
      1200   287.81421     -41180.304      17240.088      3592.2084    
      1300   309.4594      -41187.248      20009.033      3592.9251    
      1400   298.29227     -41148.736      8136.8703      3593.6418    
      1500   320.19588     -41171.966      1075.5442      3594.3586    
      1600   289.84083     -41184.268      13009.745      3595.0753    
      1700   312.48794     -41213.527      8066.4425      3595.792     
      1800   297.21818     -41191.098      7770.8959      3596.5087    
      1900   303.70582     -41179.081     -3779.7409      3597.2255    
      2000   305.57411     -41156.23       26433.128      3597.9422    
      2100   314.44174     -41176.767      21914.057      3598.6589    
      2200   298.40457     -41200.543      8737.0272      3599.3756    
      2300   314.02174     -41221.817      5013.0651      3600.0923    
      2400   287.58096     -41185.181     -2233.668       3600.8091    
      2500   309.8935      -41184.995      5803.8729      3601.5258    
      2600   317.04671     -41181.14       23513.691      3602.2425    
      2700   302.50768     -41173.954      3186.1597      3602.9592    
      2800   283.6076      -41199.009      12006.718      3603.6759    
      2900   290.2864      -41204.754     -2550.8643      3604.3927    
      3000   306.50734     -41201.44       16436.491      3605.1094    
      3100   305.28433     -41181.021      1698.0824      3605.8261    
      3200   338.85078     -41211.516     -5664.9145      3606.5428    
      3300   285.16158     -41186.379      12162.546      3607.2596    
      3400   297.72935     -41214.833     -4088.7162      3607.9763    
      3500   287.35096     -41192.437      5838.9366      3608.693     
      3600   287.09386     -41176.163      15284.459      3609.4097    
      3700   318.5511      -41190.254     -3108.9495      3610.1264    
      3800   313.60848     -41181.882     -2365.1324      3610.8432    
      3900   277.05702     -41180.983      1023.7592      3611.5599    
      4000   276.53586     -41187.552      14641.762      3612.2766    
      4100   290.46677     -41190.112      13816.905      3612.9933    
      4200   305.64469     -41183.984      13945.416      3613.7101    
      4300   303.89629     -41174.434      4986.4357      3614.4268    
      4400   311.0401      -41189.587      3658.4896      3615.1435    
      4500   302.07914     -41186.486      2417.3295      3615.8602    
      4600   303.60686     -41194.398      985.35966      3616.5769    
      4700   304.38172     -41196.278      10845.465      3617.2937    
      4800   296.66012     -41188.681      14013.891      3618.0104    
      4900   310.00953     -41204.148      7177.4506      3618.7271    
      5000   272.47162     -41168.769      19417.047      3619.4438    
Loop time of 266.529 on 16 procs for 5000 steps with 366 atoms

Performance: 0.810 ns/day, 29.614 hours/ns, 18.760 timesteps/s, 6.866 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 215.83     | 221.54     | 227.64     |  28.5 | 83.12
Bond    | 0.013297   | 0.01478    | 0.015768   |   0.7 |  0.01
Neigh   | 1.9985     | 2.1199     | 2.2534     |   4.7 |  0.80
Comm    | 14.521     | 20.748     | 26.525     |  94.1 |  7.78
Output  | 0.023344   | 0.050101   | 0.10437    |  12.9 |  0.02
Modify  | 21.74      | 21.826     | 21.898     |   1.2 |  8.19
Other   |            | 0.2309     |            |       |  0.09

Nlocal:          45.75 ave          56 max          32 min
Histogram: 1 0 0 0 1 2 1 2 0 1
Nghost:        3537.38 ave        3652 max        3429 min
Histogram: 1 1 1 0 1 1 0 2 0 1
Neighs:        32433.4 ave       39375 max       22851 min
Histogram: 1 0 0 0 1 2 1 2 0 1

Total # of neighbors = 259467
Ave neighs/atom = 708.92623
Ave special neighs/atom = 0
Neighbor list builds = 56
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 17.6074
variable dlen equal lz-${len0}
variable dlen equal lz-17.6074
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.6074
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.074931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.001585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.000807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -0.176074 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz 100 dump/neg_deform3.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.6 | 140.3 | 143.4 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   326.30211     -41200.028      8430.9844      3583.6077    
       100   298.06085     -41179.183      19158.151      3582.891     
       200   290.4107      -41203.237      17558.23       3582.1743    
       300   287.49569     -41212.071      14558.001      3581.4576    
       400   281.15949     -41189.219      3685.4584      3580.7409    
       500   290.85728     -41181.649      1925.75        3580.0241    
       600   307.97078     -41190.835      10638.601      3579.3074    
       700   296.90341     -41174.075      9789.5242      3578.5907    
       800   302.11678     -41173.292      21461.932      3577.874     
       900   309.09456     -41190.072      13925.864      3577.1573    
      1000   293.38535     -41195.821      5826.5182      3576.4405    
      1100   286.66778     -41199.082      26712.927      3575.7238    
      1200   274.57465     -41177.607     -5052.516       3575.0071    
      1300   308.88563     -41180.585      15424.547      3574.2904    
      1400   303.67493     -41167.816      19432.179      3573.5736    
      1500   292.48111     -41175.637      3555.0051      3572.8569    
      1600   310.73865     -41209.474      11370.672      3572.1402    
      1700   296.90213     -41204.394      12788.563      3571.4235    
      1800   285.12081     -41189.389      6467.3206      3570.7068    
      1900   296.45817     -41185.569      10210.689      3569.99      
      2000   327.24725     -41207.81       23417.703      3569.2733    
      2100   311.06002     -41201.949      9142.51        3568.5566    
      2200   287.2628      -41195.196      25854.203      3567.8399    
      2300   285.32402     -41233.098      5895.928       3567.1232    
      2400   294.93202     -41227.115      9112.0751      3566.4064    
      2500   291.17667     -41192.161      8261.1955      3565.6897    
      2600   322.82804     -41204.615      19280.273      3564.973     
      2700   302.51339     -41175.572      11532.751      3564.2563    
      2800   306.39801     -41180.431      13332.38       3563.5395    
      2900   286.22663     -41181.233      11246.369      3562.8228    
      3000   274.93571     -41189.114      9459.4756      3562.1061    
      3100   307.99355     -41213.137      14564.38       3561.3894    
      3200   321.72804     -41195.57       4878.6864      3560.6727    
      3300   293.86266     -41168.88       23880.555      3559.9559    
      3400   298.89946     -41191.4        11744.14       3559.2392    
      3500   300.10675     -41208.107     -2510.4196      3558.5225    
      3600   300.68059     -41214.344      6517.5738      3557.8058    
      3700   310.07221     -41196.376      12703.651      3557.089     
      3800   316.71225     -41175.4        30522.31       3556.3723    
      3900   305.8203      -41161.337      11791.02       3555.6556    
      4000   307.61902     -41196.283      11135.865      3554.9389    
      4100   295.3564      -41201.711      1664.7365      3554.2222    
      4200   300.59205     -41200.322      4499.5721      3553.5054    
      4300   296.43456     -41181.998      5204.9175      3552.7887    
      4400   301.46819     -41171.23       4749.8429      3552.072     
      4500   327.44366     -41196.118      8123.2394      3551.3553    
      4600   292.70274     -41186.963      32744.32       3550.6386    
      4700   299.82097     -41212.982      1073.2077      3549.9218    
      4800   289.68512     -41199.67      -2405.8746      3549.2051    
      4900   308.1428      -41192.685      7341.1189      3548.4884    
      5000   317.7049      -41178.421      23974.444      3547.7717    
Loop time of 270.368 on 16 procs for 5000 steps with 366 atoms

Performance: 0.799 ns/day, 30.041 hours/ns, 18.493 timesteps/s, 6.769 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 221.05     | 226.68     | 233.75     |  25.7 | 83.84
Bond    | 0.013157   | 0.014778   | 0.01582    |   0.8 |  0.01
Neigh   | 1.9561     | 2.0208     | 2.1358     |   4.1 |  0.75
Comm    | 12.138     | 19.24      | 24.916     |  88.3 |  7.12
Output  | 0.022523   | 0.048624   | 0.1016     |  12.7 |  0.02
Modify  | 22.043     | 22.129     | 22.236     |   1.4 |  8.18
Other   |            | 0.2296     |            |       |  0.08

Nlocal:          45.75 ave          53 max          36 min
Histogram: 1 0 1 1 0 0 0 4 0 1
Nghost:        3608.25 ave        3703 max        3521 min
Histogram: 1 1 1 0 0 2 0 2 0 1
Neighs:        33127.2 ave       38544 max       26201 min
Histogram: 1 0 1 1 0 0 1 3 0 1

Total # of neighbors = 265018
Ave neighs/atom = 724.0929
Ave special neighs/atom = 0
Neighbor list builds = 53
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.6074
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 0.176074 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz 100 dump/pos_deform3.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.6 | 140.3 | 143.4 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   326.30211     -41200.028      8430.9844      3583.6077    
       100   298.05486     -41179.183      19150.406      3584.3245    
       200   292.98139     -41206.36       19285.71       3585.0412    
       300   281.38073     -41205.634      29998.194      3585.7579    
       400   288.50241     -41196.338      10958.313      3586.4746    
       500   300.22048     -41192.515     -4885.5601      3587.1914    
       600   296.56242     -41177.422      3734.5771      3587.9081    
       700   300.57042     -41173.042      26541.28       3588.6248    
       800   311.87066     -41154.567      21447.864      3589.3415    
       900   311.48084     -41137.165      23407.756      3590.0582    
      1000   284.20827     -41137.379      27532.705      3590.775     
      1100   306.88721     -41179.639      8574.438       3591.4917    
      1200   292.5233      -41180.596      8000.3473      3592.2084    
      1300   299.44978     -41204.226      7713.0474      3592.9251    
      1400   288.19473     -41205.01       12963.695      3593.6418    
      1500   300.40601     -41210.889      157.89499      3594.3586    
      1600   303.83191     -41179.518      11779.599      3595.0753    
      1700   298.61079     -41164.018      12290.746      3595.792     
      1800   314.20154     -41196.532      19679.632      3596.5087    
      1900   279.39041     -41183.321      9399.8408      3597.2255    
      2000   288.22469     -41194.232      17795.923      3597.9422    
      2100   281.90014     -41179.026      4763.4445      3598.6589    
      2200   294.09024     -41183.847      4003.4033      3599.3756    
      2300   308.35887     -41202.473     -3519.5054      3600.0923    
      2400   288.43871     -41194.4        12085.285      3600.8091    
      2500   291.34411     -41198.754      6326.6196      3601.5258    
      2600   301.30782     -41209.159      4991.6765      3602.2425    
      2700   309.16328     -41196.634      3647.5553      3602.9592    
      2800   310.80522     -41183.213      13707.252      3603.6759    
      2900   296.93901     -41178.322     -6233.6693      3604.3927    
      3000   288.53351     -41200.982      6228.8424      3605.1094    
      3100   285.70784     -41210.446      14932.999      3605.8261    
      3200   289.022       -41201.797      6398.2552      3606.5428    
      3300   280.50854     -41182.527      16115.431      3607.2596    
      3400   309.31986     -41201.225      9122.4846      3607.9763    
      3500   303.11859     -41189.124      3621.7844      3608.693     
      3600   314.7405      -41210.273      11320.205      3609.4097    
      3700   280.82299     -41211.523      8313.7629      3610.1264    
      3800   287.02904     -41224.004      7011.8671      3610.8432    
      3900   305.32392     -41227.737      884.67251      3611.5599    
      4000   303.6264      -41206.803      10436.397      3612.2766    
      4100   286.17651     -41173.029      8268.7614      3612.9933    
      4200   302.86302     -41183.904      14553.289      3613.7101    
      4300   297.47684     -41190.579      2551.7948      3614.4268    
      4400   278.76526     -41206.205      2486.8832      3615.1435    
      4500   282.42196     -41225.428     -814.12423      3615.8602    
      4600   276.41916     -41202.479      5428.7014      3616.5769    
      4700   297.89822     -41198.703      6643.014       3617.2937    
      4800   307.44243     -41192.018      3474.8715      3618.0104    
      4900   289.35888     -41180.084     -206.95315      3618.7271    
      5000   288.08943     -41195.947      15701.266      3619.4438    
Loop time of 266.232 on 16 procs for 5000 steps with 366 atoms

Performance: 0.811 ns/day, 29.581 hours/ns, 18.781 timesteps/s, 6.874 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 211.34     | 225        | 233.59     |  51.0 | 84.51
Bond    | 0.013512   | 0.015363   | 0.017466   |   1.0 |  0.01
Neigh   | 1.9496     | 2.0912     | 2.2194     |   6.1 |  0.79
Comm    | 8.4307     | 17.032     | 30.765     | 185.8 |  6.40
Output  | 0.02594    | 0.053373   | 0.10888    |  12.8 |  0.02
Modify  | 21.695     | 21.798     | 21.903     |   1.5 |  8.19
Other   |            | 0.2378     |            |       |  0.09

Nlocal:          45.75 ave          55 max          38 min
Histogram: 2 0 1 0 0 3 0 1 0 1
Nghost:        3570.62 ave        3656 max        3499 min
Histogram: 1 1 0 2 0 1 2 0 0 1
Neighs:          32472 ave       38674 max       27081 min
Histogram: 2 0 1 0 0 3 0 1 0 1

Total # of neighbors = 259776
Ave neighs/atom = 709.77049
Ave special neighs/atom = 0
Neighbor list builds = 55
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 15.0372
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.0807)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*15.0372
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.074931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.001585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.000807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -0.150372 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz 100 dump/neg_deform4.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.6 | 140.3 | 143.4 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   326.30211     -41200.028      8430.9844      3583.6077    
       100   298.05605     -41179.183      19154.253      3583.6077    
       200   292.6792      -41206.142      18529.88       3583.6077    
       300   280.45569     -41204.591      24818.209      3583.6077    
       400   282.84081     -41191.205      5148.9587      3583.6077    
       500   289.2281      -41180.789     -2808.5951      3583.6077    
       600   303.1377      -41186.342      13349.49       3583.6077    
       700   304.69688     -41192.54       10312.205      3583.6077    
       800   283.10195     -41203.175      22314.974      3583.6077    
       900   280.3681      -41215.497     -1240.4834      3583.6077    
      1000   280.06362     -41193.03       16113.741      3583.6077    
      1100   315.25602     -41206.026      20631.131      3583.6077    
      1200   297.43741     -41182.47       6384.4504      3583.6077    
      1300   305.79825     -41187.907      13280.885      3583.6077    
      1400   302.68378     -41200.771      1922.0395      3583.6077    
      1500   276.83623     -41199.991      7325.9923      3583.6077    
      1600   298.26355     -41210.281     -1194.4738      3583.6077    
      1700   296.58948     -41184.876      12431.416      3583.6077    
      1800   298.00298     -41176.357      8438.1561      3583.6077    
      1900   289.84961     -41161.382      25367.101      3583.6077    
      2000   325.16323     -41192.785      5398.8545      3583.6077    
      2100   304.15626     -41179.667      16602.956      3583.6077    
      2200   304.08585     -41214.739      16768.162      3583.6077    
      2300   289.80712     -41204.946      8313.6227      3583.6077    
      2400   303.80768     -41207.672      17289.747      3583.6077    
      2500   308.55875     -41185.01       10887.656      3583.6077    
      2600   306.85788     -41170.595      19460.676      3583.6077    
      2700   310.76763     -41192.568      5672.8609      3583.6077    
      2800   288.94977     -41211.681      27127.722      3583.6077    
      2900   286.49925     -41203.837      13171.481      3583.6077    
      3000   302.76162     -41189.981      15041.081      3583.6077    
      3100   308.01846     -41180.175      27185.523      3583.6077    
      3200   306.33301     -41181.949     -5115.1541      3583.6077    
      3300   318.33382     -41207.84       27244.673      3583.6077    
      3400   293.64827     -41209.774      13738.841      3583.6077    
      3500   295.96935     -41219.323      7610.116       3583.6077    
      3600   283.85352     -41191.518      11069.454      3583.6077    
      3700   310.02513     -41181.883      5687.3084      3583.6077    
      3800   288.70392     -41162.86       2479.9249      3583.6077    
      3900   299.62276     -41189.16       32358.34       3583.6077    
      4000   304.45051     -41209.644      3266.1676      3583.6077    
      4100   285.43499     -41208.131      21704.233      3583.6077    
      4200   282.83909     -41194.421      12092.148      3583.6077    
      4300   306.9479      -41184.395      8132.8369      3583.6077    
      4400   291.54085     -41166.694     -832.20217      3583.6077    
      4500   305.44558     -41184.73       28283.529      3583.6077    
      4600   284.40178     -41183.263      4543.3736      3583.6077    
      4700   289.41358     -41206.182      9699.2919      3583.6077    
      4800   289.28115     -41182.037      3231.9114      3583.6077    
      4900   320.36666     -41187.832      13392.208      3583.6077    
      5000   309.74763     -41193.129      2338.4731      3583.6077    
Loop time of 268.042 on 16 procs for 5000 steps with 366 atoms

Performance: 0.806 ns/day, 29.782 hours/ns, 18.654 timesteps/s, 6.827 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 205.26     | 222.68     | 231.93     |  56.2 | 83.08
Bond    | 0.013856   | 0.014996   | 0.016299   |   0.8 |  0.01
Neigh   | 1.9312     | 2.0289     | 2.1673     |   5.4 |  0.76
Comm    | 11.879     | 21.147     | 38.54      | 182.5 |  7.89
Output  | 0.024941   | 0.049798   | 0.098935   |  11.9 |  0.02
Modify  | 21.767     | 21.885     | 21.962     |   1.6 |  8.16
Other   |            | 0.2401     |            |       |  0.09

Nlocal:          45.75 ave          53 max          36 min
Histogram: 1 0 0 0 1 3 1 0 1 1
Nghost:        3578.12 ave        3702 max        3479 min
Histogram: 1 1 1 1 1 0 2 0 0 1
Neighs:        32757.2 ave       37978 max       25887 min
Histogram: 1 0 0 1 0 3 1 0 1 1

Total # of neighbors = 262058
Ave neighs/atom = 716.00546
Ave special neighs/atom = 0
Neighbor list builds = 54
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*15.0372
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 0.150372 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz 100 dump/pos_deform4.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.6 | 140.3 | 143.4 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   326.30211     -41200.028      8430.9844      3583.6077    
       100   298.05965     -41179.183      19154.303      3583.6077    
       200   292.66823     -41205.866      18225.173      3583.6077    
       300   283.41452     -41207.444      25283.224      3583.6077    
       400   288.31128     -41196.682      11746.277      3583.6077    
       500   305.87162     -41197.535      5843.493       3583.6077    
       600   289.3752      -41169.167      14205.419      3583.6077    
       700   314.72232     -41188.887      8793.0934      3583.6077    
       800   296.14519     -41170.375      7121.4094      3583.6077    
       900   300.1677      -41206.438     -1455.328       3583.6077    
      1000   272.56434     -41190.685      1568.7512      3583.6077    
      1100   299.97923     -41204.352      4087.3367      3583.6077    
      1200   337.91671     -41221.022      24573.63       3583.6077    
      1300   313.12617     -41199.899      13575.126      3583.6077    
      1400   297.14872     -41196.987      15997.779      3583.6077    
      1500   298.52208     -41217.904     -7929.9236      3583.6077    
      1600   281.01967     -41234.044     -6774.0801      3583.6077    
      1700   290.9047      -41238.961      24964.992      3583.6077    
      1800   294.47503     -41221.354      21361.797      3583.6077    
      1900   281.07437     -41185.859      6036.8102      3583.6077    
      2000   321.24657     -41208.966      5813.6357      3583.6077    
      2100   331.57476     -41220.429      10820.807      3583.6077    
      2200   295.94578     -41190.563      4384.6015      3583.6077    
      2300   288.89144     -41198.365      4060.7164      3583.6077    
      2400   286.14174     -41194.234      15328.542      3583.6077    
      2500   325.71171     -41211.616      14640.927      3583.6077    
      2600   313.91558     -41185.02       21138.59       3583.6077    
      2700   308.66238     -41185.268     -653.9682       3583.6077    
      2800   302.46729     -41214.396      3120.3537      3583.6077    
      2900   295.17738     -41210.393      9516.1241      3583.6077    
      3000   307.81962     -41210.971      15816.498      3583.6077    
      3100   308.55548     -41177.757      6599.9         3583.6077    
      3200   312.40705     -41164.052      9640.8153      3583.6077    
      3300   331.2018      -41201.691      4020.0271      3583.6077    
      3400   307.01622     -41201.905      13275.839      3583.6077    
      3500   288.86183     -41193.531      24373.265      3583.6077    
      3600   294.53518     -41195.782      8585.7453      3583.6077    
      3700   308.15676     -41187.558     -7213.1576      3583.6077    
      3800   317.48283     -41171.968      16395.967      3583.6077    
      3900   311.57527     -41171.124      789.78016      3583.6077    
      4000   287.54261     -41189.365      8896.4986      3583.6077    
      4100   296.98205     -41204.58       7245.8423      3583.6077    
      4200   294.70894     -41199.094      4072.5556      3583.6077    
      4300   280.15502     -41175.966      10603.299      3583.6077    
      4400   300.63066     -41173.488      4600.0309      3583.6077    
      4500   311.60366     -41176.35       9380.8357      3583.6077    
      4600   297.16069     -41194.46       16552.271      3583.6077    
      4700   290.85885     -41202.224      17339.882      3583.6077    
      4800   298.78021     -41206.045      10914.216      3583.6077    
      4900   302.10279     -41195.747      17612.404      3583.6077    
      5000   297.74278     -41159.85       9550.9285      3583.6077    
Loop time of 235.875 on 16 procs for 5000 steps with 366 atoms

Performance: 0.916 ns/day, 26.208 hours/ns, 21.198 timesteps/s, 7.758 katom-step/s
99.0% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 156.75     | 183.85     | 208.68     | 136.8 | 77.94
Bond    | 0.012313   | 0.013374   | 0.014624   |   0.7 |  0.01
Neigh   | 1.5376     | 1.8728     | 2.1697     |  16.3 |  0.79
Comm    | 5.314      | 30.149     | 57.271     | 337.9 | 12.78
Output  | 0.015663   | 0.03695    | 0.080644   |  12.0 |  0.02
Modify  | 19.514     | 19.805     | 20.126     |   5.1 |  8.40
Other   |            | 0.1495     |            |       |  0.06

Nlocal:          45.75 ave          51 max          40 min
Histogram: 1 1 0 2 0 1 0 0 1 2
Nghost:           3566 ave        3686 max        3459 min
Histogram: 1 1 1 0 2 0 0 2 0 1
Neighs:        32774.8 ave       36341 max       28630 min
Histogram: 1 1 0 2 0 1 0 0 1 2

Total # of neighbors = 262198
Ave neighs/atom = 716.38798
Ave special neighs/atom = 0
Neighbor list builds = 55
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 13.535
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz--0.1585)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*13.535
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.074931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.001585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.000807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -0.13535 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz 100 dump/neg_deform5.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.6 | 140.3 | 143.4 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   326.30211     -41200.028      8430.9844      3583.6077    
       100   298.05717     -41179.183      19154.268      3583.6077    
       200   292.0943      -41205.559      18931.708      3583.6077    
       300   284.57923     -41209.759      35017.132      3583.6077    
       400   284.76612     -41193.502      7267.4735      3583.6077    
       500   302.67212     -41195.22      -10958.311      3583.6077    
       600   304.38465     -41188.36       9137.4852      3583.6077    
       700   320.2519      -41204.851      8550.6688      3583.6077    
       800   290.08395     -41187.276      13396.664      3583.6077    
       900   285.7944      -41212.641     -2019.3243      3583.6077    
      1000   292.92206     -41216.766      8219.4839      3583.6077    
      1100   314.57854     -41207.786      16581.562      3583.6077    
      1200   298.47508     -41184.184      19715.51       3583.6077    
      1300   309.38475     -41194.068     -1900.4747      3583.6077    
      1400   312.18146     -41196.526      8296.4873      3583.6077    
      1500   294.5356      -41191.248      17670.759      3583.6077    
      1600   286.36615     -41202.097      2217.876       3583.6077    
      1700   285.80767     -41192.615      7468.2346      3583.6077    
      1800   306.35507     -41186.643      10296.266      3583.6077    
      1900   302.96154     -41183.056      6880.4159      3583.6077    
      2000   277.31786     -41161.226      20797.007      3583.6077    
      2100   310.81355     -41199.288      12482.295      3583.6077    
      2200   310.20854     -41208.916     -2836.8855      3583.6077    
      2300   306.40398     -41207.227      9284.7539      3583.6077    
      2400   308.25996     -41208.218      1658.254       3583.6077    
      2500   315.98604     -41198.199      32231.223      3583.6077    
      2600   316.80796     -41174.448      20208.153      3583.6077    
      2700   300.05878     -41167.914      7952.3876      3583.6077    
      2800   296.12432     -41198.685      13790.209      3583.6077    
      2900   288.81408     -41195.541     -7663.8054      3583.6077    
      3000   311.14784     -41215.865      16402.32       3583.6077    
      3100   315.45196     -41209.117     -6516.8125      3583.6077    
      3200   312.27542     -41173.713      14599.717      3583.6077    
      3300   309.49947     -41160.709      19955.725      3583.6077    
      3400   314.04141     -41191.589      2291.1646      3583.6077    
      3500   299.80334     -41198.604      1912.6219      3583.6077    
      3600   299.55616     -41201.375      26181.765      3583.6077    
      3700   296.05506     -41195.122      14997.55       3583.6077    
      3800   314.38034     -41195.447      15127.921      3583.6077    
      3900   325.914       -41189.338      5339.9935      3583.6077    
      4000   295.22158     -41173.266      4827.2833      3583.6077    
      4100   298.28514     -41207.181      7210.4938      3583.6077    
      4200   291.42959     -41200.893      12589.652      3583.6077    
      4300   309.68494     -41208.958      15962.428      3583.6077    
      4400   318.7896      -41187.612      15911.874      3583.6077    
      4500   328.6732      -41186.746      10128.297      3583.6077    
      4600   304.07523     -41175.349      14895.321      3583.6077    
      4700   304.16717     -41191.099      8478.0765      3583.6077    
      4800   299.94296     -41196.903      19403.057      3583.6077    
      4900   281.40435     -41193.548      4668.6765      3583.6077    
      5000   298.34113     -41221.427      1268.1956      3583.6077    
Loop time of 159.521 on 16 procs for 5000 steps with 366 atoms

Performance: 1.354 ns/day, 17.725 hours/ns, 31.344 timesteps/s, 11.472 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 134.74     | 137.73     | 140.36     |  17.4 | 86.34
Bond    | 0.011031   | 0.011873   | 0.01309    |   0.6 |  0.01
Neigh   | 1.5052     | 1.6157     | 1.7015     |   4.7 |  1.01
Comm    | 1.6848     | 4.3064     | 7.3367     |  99.2 |  2.70
Output  | 0.010817   | 0.031286   | 0.073782   |  12.5 |  0.02
Modify  | 15.636     | 15.701     | 15.782     |   1.3 |  9.84
Other   |            | 0.1266     |            |       |  0.08

Nlocal:          45.75 ave          54 max          38 min
Histogram: 1 2 0 0 0 1 3 0 0 1
Nghost:        3577.62 ave        3670 max        3486 min
Histogram: 1 1 1 0 1 1 1 0 1 1
Neighs:        32763.2 ave       38354 max       27297 min
Histogram: 1 1 1 0 0 1 1 2 0 1

Total # of neighbors = 262106
Ave neighs/atom = 716.13661
Ave special neighs/atom = 0
Neighbor list builds = 57
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*13.535
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 0.13535 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz 100 dump/pos_deform5.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.6 | 140.3 | 143.4 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   326.30211     -41200.028      8430.9844      3583.6077    
       100   298.05852     -41179.183      19154.287      3583.6077    
       200   292.18201     -41205.158      17088.221      3583.6077    
       300   283.70062     -41207.606      28911.008      3583.6077    
       400   287.87072     -41196.135      10203.221      3583.6077    
       500   299.48493     -41191.463     -13231.148      3583.6077    
       600   308.6684      -41191.511      8901.1999      3583.6077    
       700   304.70574     -41186.076      17525.085      3583.6077    
       800   307.40445     -41174.202      7317.5365      3583.6077    
       900   301.13259     -41164.986      8063.1983      3583.6077    
      1000   307.89627     -41193.486      18210.231      3583.6077    
      1100   311.03508     -41217.168      16553.803      3583.6077    
      1200   279.56122     -41196.714      4377.7047      3583.6077    
      1300   294.33335     -41199.839      28631.278      3583.6077    
      1400   300.36115     -41166.842      25138.332      3583.6077    
      1500   288.09228     -41157.331      7868.2224      3583.6077    
      1600   289.91676     -41183.23       6029.3189      3583.6077    
      1700   294.75641     -41205.131      20744.902      3583.6077    
      1800   280.0961      -41191.3        11974.885      3583.6077    
      1900   307.70713     -41189.322      16827.533      3583.6077    
      2000   322.10482     -41185.247      1742.1238      3583.6077    
      2100   297.0465      -41170.947      6947.4946      3583.6077    
      2200   307.64387     -41200.653      3793.6571      3583.6077    
      2300   298.59903     -41199.472      18143.015      3583.6077    
      2400   283.66732     -41191.142      17536.164      3583.6077    
      2500   300.15143     -41202.869      15582.114      3583.6077    
      2600   308.57342     -41192.39       1825.6352      3583.6077    
      2700   307.25128     -41181.183      8128.5901      3583.6077    
      2800   299.89361     -41177.307      17523.308      3583.6077    
      2900   293.78382     -41189.798      8103.4392      3583.6077    
      3000   277.63239     -41191.713      19950.026      3583.6077    
      3100   292.7977      -41206.4        5198.8378      3583.6077    
      3200   310.6269      -41190.731      8520.882       3583.6077    
      3300   318.86327     -41184.67       3701.3541      3583.6077    
      3400   295.45437     -41174.627      16214.251      3583.6077    
      3500   290.69655     -41185.58       22349.001      3583.6077    
      3600   290.97143     -41188.737      12547.565      3583.6077    
      3700   311.78865     -41187.201      7998.6035      3583.6077    
      3800   307.32554     -41166.432      11684.355      3583.6077    
      3900   294.67166     -41175.328      15478.56       3583.6077    
      4000   301.49698     -41203.687      10042.304      3583.6077    
      4100   313.75594     -41218.865      12387.233      3583.6077    
      4200   309.85707     -41201.997      2200.3559      3583.6077    
      4300   298.72802     -41155.179      5359.3171      3583.6077    
      4400   303.60506     -41136.188      3744.1756      3583.6077    
      4500   322.74404     -41172.548      13616.274      3583.6077    
      4600   304.48915     -41169.159     -490.20704      3583.6077    
      4700   319.66438     -41204.847      9669.0311      3583.6077    
      4800   292.65153     -41200.087      17427.627      3583.6077    
      4900   283.78975     -41201.815      17993.361      3583.6077    
      5000   301.95919     -41205.401      12560.511      3583.6077    
Loop time of 154.534 on 16 procs for 5000 steps with 366 atoms

Performance: 1.398 ns/day, 17.170 hours/ns, 32.355 timesteps/s, 11.842 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 129.66     | 132.16     | 135.83     |  18.6 | 85.52
Bond    | 0.010188   | 0.011502   | 0.012657   |   0.7 |  0.01
Neigh   | 1.4858     | 1.5811     | 1.6627     |   4.2 |  1.02
Comm    | 1.2175     | 4.884      | 7.4218     |  97.5 |  3.16
Output  | 0.010408   | 0.030957   | 0.073508   |  12.6 |  0.02
Modify  | 15.686     | 15.743     | 15.809     |   1.2 | 10.19
Other   |            | 0.127      |            |       |  0.08

Nlocal:          45.75 ave          51 max          37 min
Histogram: 1 0 0 0 1 1 1 2 1 1
Nghost:        3573.12 ave        3665 max        3502 min
Histogram: 1 1 1 1 0 2 1 0 0 1
Neighs:        32771.4 ave       36296 max       26706 min
Histogram: 1 0 0 0 1 1 1 1 2 1

Total # of neighbors = 262171
Ave neighs/atom = 716.31421
Ave special neighs/atom = 0
Neighbor list builds = 56
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 17.6074
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--7.4931)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*17.6074
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -7.4931000000000000938, deltaxy = 0.074931
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = -0.158500000000000002, deltaxz = 0.001585
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.08069999999999999396, deltayz = -0.000807
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -0.176074 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz 100 dump/neg_deform6.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.6 | 140.3 | 143.4 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   326.30211     -41200.028      8430.9844      3583.6077    
       100   298.06535     -41179.183      19154.382      3583.6077    
       200   292.59675     -41205.834      17942.483      3583.6077    
       300   279.39201     -41203.305      29513.845      3583.6077    
       400   285.68467     -41194.073      10494.216      3583.6077    
       500   302.60786     -41195.477     -12249.286      3583.6077    
       600   297.93415     -41179.522      15874.055      3583.6077    
       700   302.92256     -41184.31       24753.42       3583.6077    
       800   286.03673     -41193.524      9730.44        3583.6077    
       900   297.18012     -41230.042      4954.3454      3583.6077    
      1000   276.71315     -41190.992      13703.19       3583.6077    
      1100   309.27225     -41199.76       9964.5421      3583.6077    
      1200   295.64228     -41185.813      9694.8562      3583.6077    
      1300   308.53402     -41203.549      832.63316      3583.6077    
      1400   305.73663     -41215.364      3170.5266      3583.6077    
      1500   289.22463     -41224.252      1097.3887      3583.6077    
      1600   308.11738     -41229.623      10275.564      3583.6077    
      1700   300.51821     -41198.659      5997.588       3583.6077    
      1800   303.17069     -41192.325      12139.11       3583.6077    
      1900   306.01794     -41187.3        5586.8742      3583.6077    
      2000   289.96124     -41172.397      10653.983      3583.6077    
      2100   301.74038     -41177.814      20646.312      3583.6077    
      2200   311.87254     -41181.167      24023.162      3583.6077    
      2300   306.89922     -41184.8        6449.1295      3583.6077    
      2400   308.51036     -41208.933      2190.9971      3583.6077    
      2500   299.332       -41211.019      12334.203      3583.6077    
      2600   283.29597     -41187.775      182.19965      3583.6077    
      2700   318.53932     -41189.402      4264.2188      3583.6077    
      2800   326.56289     -41184.761      13476.779      3583.6077    
      2900   304.02647     -41180.52       22253.934      3583.6077    
      3000   303.53815     -41206.983      16872.118      3583.6077    
      3100   298.85505     -41208.289      6892.237       3583.6077    
      3200   294.70654     -41191.535      5316.2232      3583.6077    
      3300   316.5604      -41201.644      8770.1677      3583.6077    
      3400   285.48333     -41174.85       22493.732      3583.6077    
      3500   297.96188     -41201.57      -2138.7491      3583.6077    
      3600   285.75597     -41196.725      19720.372      3583.6077    
      3700   296.70482     -41193.789      12549.268      3583.6077    
      3800   295.49709     -41165.075      15918.566      3583.6077    
      3900   316.12393     -41176.592      1890.3447      3583.6077    
      4000   305.65253     -41182.847      18312.812      3583.6077    
      4100   310.61872     -41194.762      11705.75       3583.6077    
      4200   308.44056     -41197.364      8989.3668      3583.6077    
      4300   300.25757     -41196.451      6260.9009      3583.6077    
      4400   295.29729     -41206.358      8196.2962      3583.6077    
      4500   280.24354     -41202.821      3941.6693      3583.6077    
      4600   292.89008     -41190.761      22935.939      3583.6077    
      4700   311.81087     -41189.207     -2716.2535      3583.6077    
      4800   300.02064     -41176.351     -4739.6664      3583.6077    
      4900   305.59587     -41195.5        11019.943      3583.6077    
      5000   289.93192     -41209.159      26029.86       3583.6077    
Loop time of 137.822 on 16 procs for 5000 steps with 366 atoms

Performance: 1.567 ns/day, 15.314 hours/ns, 36.279 timesteps/s, 13.278 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 112.75     | 116.27     | 119.77     |  22.5 | 84.36
Bond    | 0.0088786  | 0.0094206  | 0.010575   |   0.5 |  0.01
Neigh   | 1.43       | 1.5284     | 1.6164     |   4.4 |  1.11
Comm    | 1.2379     | 4.7183     | 8.2826     | 112.1 |  3.42
Output  | 0.011281   | 0.031219   | 0.072279   |  12.2 |  0.02
Modify  | 15.098     | 15.156     | 15.211     |   1.1 | 11.00
Other   |            | 0.1103     |            |       |  0.08

Nlocal:          45.75 ave          55 max          39 min
Histogram: 1 1 1 1 1 1 1 0 0 1
Nghost:        3606.38 ave        3731 max        3493 min
Histogram: 1 1 0 2 0 1 1 1 0 1
Neighs:        32801.2 ave       39014 max       27967 min
Histogram: 1 1 1 1 1 1 1 0 0 1

Total # of neighbors = 262410
Ave neighs/atom = 716.96721
Ave special neighs/atom = 0
Neighbor list builds = 55
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (15.0372 13.535 17.6074) with tilt (-7.4931 -0.1585 0.0807)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  366 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.002 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*17.6074
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 0.176074 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz 100 dump/pos_deform6.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 4 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 137.6 | 140.3 | 143.4 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   326.30211     -41200.028      8430.9844      3583.6077    
       100   298.05067     -41179.183      19154.178      3583.6077    
       200   293.02187     -41206.455      18767.116      3583.6077    
       300   281.94992     -41205.866      27825.637      3583.6077    
       400   282.68433     -41190.906      10908.518      3583.6077    
       500   289.49384     -41179.46      -1453.7867      3583.6077    
       600   305.1428      -41186.276      3087.2685      3583.6077    
       700   295.14258     -41175.115      20880.986      3583.6077    
       800   305.6715      -41187.907      12267.769      3583.6077    
       900   291.08282     -41200.299     -3446.1829      3583.6077    
      1000   285.06536     -41201.034     -3307.226       3583.6077    
      1100   314.68765     -41208.19       386.15513      3583.6077    
      1200   296.01673     -41171.089      5439.3669      3583.6077    
      1300   311.16839     -41181.139      12778.277      3583.6077    
      1400   296.54193     -41191.273      46073.479      3583.6077    
      1500   281.23813     -41201.584      3039.5707      3583.6077    
      1600   308.77893     -41218.272      19640.456      3583.6077    
      1700   301.07629     -41193.483      17953.465      3583.6077    
      1800   299.58218     -41186.845      5497.0504      3583.6077    
      1900   286.44491     -41177.806      8082.6474      3583.6077    
      2000   266.5163      -41172.921      10565.587      3583.6077    
      2100   318.47794     -41230.193      8093.3015      3583.6077    
      2200   297.66209     -41205.183      18496.176      3583.6077    
      2300   295.58675     -41186.512     -2354.9217      3583.6077    
      2400   294.84391     -41163.868      8574.4738      3583.6077    
      2500   322.1094      -41184.21       23475.581      3583.6077    
      2600   307.44084     -41209.356      3732.0378      3583.6077    
      2700   301.08849     -41215.393      15410.456      3583.6077    
      2800   284.99931     -41191.322      11659.272      3583.6077    
      2900   298.76906     -41185.604      12590.451      3583.6077    
      3000   320.9317      -41195.986      18383.03       3583.6077    
      3100   295.43733     -41179.628      3033.5838      3583.6077    
      3200   289.95913     -41203.363      824.0732       3583.6077    
      3300   290.67119     -41203.957      20924.646      3583.6077    
      3400   306.9482      -41197.609      20436.148      3583.6077    
      3500   305.4049      -41186.341      10624.286      3583.6077    
      3600   317.54328     -41181.602     -1798.1246      3583.6077    
      3700   330.51546     -41173.43       7190.6975      3583.6077    
      3800   294.49487     -41152.931      10268.319      3583.6077    
      3900   303.62472     -41195.865      5692.5928      3583.6077    
      4000   308.17176     -41212.235      6866.5311      3583.6077    
      4100   283.79517     -41185.335      9931.8602      3583.6077    
      4200   309.53829     -41194.482      23758.813      3583.6077    
      4300   324.85506     -41183.102      7933.7603      3583.6077    
      4400   320.93853     -41184.419      615.91643      3583.6077    
      4500   300.15169     -41205.153      16373.575      3583.6077    
      4600   299.14269     -41210.701      6861.3484      3583.6077    
      4700   298.74703     -41208.593      19436.424      3583.6077    
      4800   320.41063     -41207.652     -8659.8973      3583.6077    
      4900   310.31394     -41178.497      10287.554      3583.6077    
      5000   309.35358     -41182.554      8870.5929      3583.6077    
Loop time of 137.253 on 16 procs for 5000 steps with 366 atoms

Performance: 1.574 ns/day, 15.250 hours/ns, 36.429 timesteps/s, 13.333 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 111.45     | 115.28     | 119.14     |  25.5 | 83.99
Bond    | 0.008679   | 0.0092386  | 0.010185   |   0.5 |  0.01
Neigh   | 1.438      | 1.5386     | 1.6249     |   4.4 |  1.12
Comm    | 1.2684     | 5.1024     | 8.9659     | 121.5 |  3.72
Output  | 0.011302   | 0.03132    | 0.072543   |  12.2 |  0.02
Modify  | 15.126     | 15.182     | 15.242     |   1.0 | 11.06
Other   |            | 0.1116     |            |       |  0.08

Nlocal:          45.75 ave          51 max          35 min
Histogram: 1 0 0 0 1 0 1 0 4 1
Nghost:        3578.12 ave        3665 max        3499 min
Histogram: 1 1 1 0 2 0 1 1 0 1
Neighs:        32789.9 ave       36536 max       25236 min
Histogram: 1 0 0 0 1 0 1 1 3 1

Total # of neighbors = 262319
Ave neighs/atom = 716.71858
Ave special neighs/atom = 0
Neighbor list builds = 56
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:44:47
