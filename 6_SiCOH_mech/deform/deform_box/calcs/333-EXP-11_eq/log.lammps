LAMMPS (2 Aug 2023 - Update 2)
  using 2 OpenMP thread(s) per MPI task
# Initialization
units           real
dimension       3
boundary        p p p
# boundary        s s s
atom_style      full
timestep        0.5   # fs

# Define MD parameters
variable nevery equal 10                  # sampling interval
variable nrepeat equal 10                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 10*${nrepeat} 
variable nfreq equal 10*10 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 100           
# 1 ps : 1e3 fs / 0.5 fs = 2e3 steps
variable nequil equal 50*${nthermo}       # steps of equilibration run 10
variable nequil equal 50*100       
variable nrun equal 50*${nthermo}          # stpes of equilibrated run 10
variable nrun equal 50*100          
variable temp equal 300.0                # temperature of initial sample
variable tdamp equal 50.0                 # time constant for thermostat
variable seed equal 123456                # seed for thermostat
variable ufac equal 1.01325e-4         # pressure unit conversion, from atm to Gpa
variable up equal 0.01                  # the deformation magnitude 0.1
variable FF string "SiOCHN_2018.ff C H O Si"          # force field args for pair_coeff
# pair_coeff * * CHONSSi.ff C H O Si
# pair_coeff * * CHOSiNa.ff C H O Si
# pair_coeff * * SiOCHN_2018.ff C H O Si
# pair_coeff * * PDMSDecomp.ff C H O Si
# pair_coeff * * CHONSi.ff C H O Si
# pair_coeff * * CHOFe.ff O Si

# Read the initial sctructure
# box tilt large
variable structure string 333-EXP-11_eq

read_data       ${structure}.data
read_data       333-EXP-11_eq.data
Reading data file ...
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  274 atoms
  reading velocities ...
  274 velocities
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_data CPU = 0.014 seconds

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)
# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400

# # Energy minimization
# print "*****Minimization starts.*****"
# minimize 1.0e-6 1.0e-6 100 1000
# min_style cg
# # Save the optimized structure
# write_data ${structure}_opt.data
# velocity        all create ${temp} ${seed} dist gaussian

# # Equilibration
# include ff.mod.lmp
# if "$(is_defined(fix,avgp))" then "unfix avgp"
# if "$(is_defined(fix,avgl))" then "unfix avgl"
# thermo_style custom step temp pe press density vol
# run ${nequil}
# # Save the equilibrated structure
# write_data ${structure}_eq.data

# use tmp to save initial length and tilt
variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 16.8189
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 12.842
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 16.0755

variable tmp equal yz
variable yz0 equal ${tmp}
variable yz0 equal 0.4312
variable tmp equal xz
variable xz0 equal ${tmp}
variable xz0 equal 1.195
variable tmp equal xy
variable xy0 equal ${tmp}
variable xy0 equal -8.3798

# Write restart
write_restart equil.res
System init for write_restart ...
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none

# dir: direction
# uxx Perturbation
variable dir equal 1
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
variable len0 equal ${lx0}
variable len0 equal 16.8189
variable dlen equal lx-${len0}
variable dlen equal lx-16.8189
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.005 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.8189
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.168189 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.168189 xy delta 0.083798 xz delta ${deltaxz} remap v units box flip no
fix deform_n all deform 100 x delta 0 -0.168189 xy delta 0.083798 xz delta -0.01195 remap v units box flip no
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg1 all custom/gz 100 dump/neg_deform1.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Your simulation uses code contributions which should be cited:

- pair reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 number =  {4--5},
 pages =   {245--259}
}

- fix qeq/reaxff command: doi:10.1016/j.parco.2011.08.005

@Article{Aktulga12,
 author = {H. M. Aktulga and J. C. Fogarty and S. A. Pandit and A. Y. Grama},
 title = {Parallel Reactive Molecular Dynamics: {N}umerical Methods and Algorithmic Techniques},
 journal = {Parallel Computing},
 year =    2012,
 volume =  38,
 pages =   {245--259}
}

CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE-CITE

Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109 | 111.4 | 113.2 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   287.77099     -28418.746     -8186.1241      3472.1201    
       100   300.0737      -28423.633     -15304.095      3471.4257    
       200   312.9277      -28441.619     -6165.4632      3470.7313    
       300   282.64224     -28439.49       3931.8428      3470.0369    
       400   298.71775     -28458.043      2116.2997      3469.3424    
       500   315.23988     -28452.937     -8980.0392      3468.648     
       600   305.68726     -28422.781     -19392.859      3467.9536    
       700   281.07067     -28402.596     -11487.533      3467.2592    
       800   312.34438     -28425.609     -15232.204      3466.5647    
       900   325.41841     -28447.118      10719.886      3465.8703    
      1000   285.27275     -28448.272      1117.7271      3465.1759    
      1100   280.24725     -28442.401     -12862.736      3464.4815    
      1200   300.95165     -28440.804     -10262.024      3463.7871    
      1300   305.09341     -28425.939     -7592.2778      3463.0926    
      1400   311.92336     -28427.899     -9865.7921      3462.3982    
      1500   298.15752     -28421.418     -14777.043      3461.7038    
      1600   292.36537     -28439.132     -12281.853      3461.0094    
      1700   287.51858     -28457.205     -4944.519       3460.3149    
      1800   274.05419     -28436.05      -10133.996      3459.6205    
      1900   309.62359     -28434.102     -4681.9188      3458.9261    
      2000   300.28483     -28425.062      7876.4435      3458.2317    
      2100   285.8254      -28424.569     -6417.354       3457.5372    
      2200   295.41146     -28435.346      87.118369      3456.8428    
      2300   313.33235     -28444.451     -15656.571      3456.1484    
      2400   309.1082      -28415.682     -14213.349      3455.454     
      2500   319.70417     -28413.441     -2152.0666      3454.7595    
      2600   320.52704     -28424.93      -1296.0843      3454.0651    
      2700   270.79503     -28416.444     -10300.487      3453.3707    
      2800   308.10611     -28450.55       2246.8727      3452.6763    
      2900   318.363       -28448.175     -17786.074      3451.9818    
      3000   296.84213     -28430.347     -11801.243      3451.2874    
      3100   299.28559     -28430.789     -11245.844      3450.593     
      3200   296.0474      -28411.719     -17450.519      3449.8986    
      3300   332.68486     -28430.969     -6287.1839      3449.2041    
      3400   301.61799     -28421.714      4447.8346      3448.5097    
      3500   305.37704     -28446.489      4292.1081      3447.8153    
      3600   291.29513     -28437.246     -7174.738       3447.1209    
      3700   292.96661     -28432.981     -13054.683      3446.4264    
      3800   296.98261     -28426.73      -15899.367      3445.732     
      3900   302.50399     -28430.37      -10043.87       3445.0376    
      4000   285.45433     -28413.882     -11448.224      3444.3432    
      4100   289.67044     -28404.911     -9950.2418      3443.6488    
      4200   324.69045     -28418.096     -7344.2286      3442.9543    
      4300   314.19193     -28422.849     -8347.6406      3442.2599    
      4400   279.43121     -28424.748     -2652.3982      3441.5655    
      4500   290.72025     -28429.237     -4396.1209      3440.8711    
      4600   307.39391     -28421.946     -9580.2601      3440.1766    
      4700   305.81278     -28412.953     -1353.0579      3439.4822    
      4800   302.74762     -28425.039      8541.7161      3438.7878    
      4900   311.28714     -28436.835      438.6061       3438.0934    
      5000   277.71983     -28411.159     -3862.253       3437.3989    
Loop time of 159.448 on 16 procs for 5000 steps with 274 atoms

Performance: 1.355 ns/day, 17.716 hours/ns, 31.358 timesteps/s, 8.592 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 90.021     | 111.25     | 141.76     | 199.1 | 69.77
Bond    | 0.012021   | 0.013412   | 0.015117   |   0.9 |  0.01
Neigh   | 1.2319     | 1.4728     | 1.8963     |  21.2 |  0.92
Comm    | 1.4632     | 31.975     | 53.211     | 371.3 | 20.05
Output  | 0.012462   | 0.028171   | 0.063427   |  12.0 |  0.02
Modify  | 14.19      | 14.602     | 14.85      |   6.7 |  9.16
Other   |            | 0.1088     |            |       |  0.07

Nlocal:          34.25 ave          38 max          23 min
Histogram: 1 0 0 0 0 1 0 0 4 2
Nghost:        2839.62 ave        2892 max        2778 min
Histogram: 2 0 0 0 2 0 2 0 0 2
Neighs:        19114.1 ave       21168 max       13144 min
Histogram: 1 0 0 0 0 1 0 0 4 2

Total # of neighbors = 152913
Ave neighs/atom = 558.07664
Ave special neighs/atom = 0
Neighbor list builds = 83
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg1

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.8189
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.168189 xy delta ${deltaxy} xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.168189 xy delta -0.083798 xz delta ${deltaxz} remap v units box
fix deform_p all deform 100 x delta 0 0.168189 xy delta -0.083798 xz delta 0.01195 remap v units box
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 1 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos1.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos1.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos1 all custom/gz 100 dump/pos_deform1.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109 | 111.4 | 113.3 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   287.77099     -28418.746     -8186.1241      3472.1201    
       100   300.05642     -28423.63      -15275.27       3472.8146    
       200   312.7792      -28441.201     -6482.236       3473.509     
       300   282.49598     -28438.868      3396.6808      3474.2034    
       400   298.00046     -28456.887      1125.6738      3474.8978    
       500   317.56399     -28453.937     -10135.126      3475.5923    
       600   307.55726     -28423.836     -21318.183      3476.2867    
       700   277.44882     -28398.981     -12734.062      3476.9811    
       800   312.56821     -28424.946     -16890.543      3477.6755    
       900   321.23839     -28441.065      7063.1741      3478.37      
      1000   283.92331     -28443.98       213.51238      3479.0644    
      1100   287.3268      -28445.974     -12920.82       3479.7588    
      1200   290.93254     -28433.259     -8608.9013      3480.4532    
      1300   298.3852      -28422.437     -7848.8338      3481.1477    
      1400   318.45359     -28436.485     -8767.3277      3481.8421    
      1500   296.67135     -28420.102     -15392.429      3482.5365    
      1600   293.30338     -28429.51      -20652.736      3483.2309    
      1700   298.36881     -28451.232     -924.63352      3483.9253    
      1800   278.06222     -28441.645     -8695.944       3484.6198    
      1900   307.15117     -28435.319     -2680.1078      3485.3142    
      2000   300.55436     -28418.218     -4089.7451      3486.0086    
      2100   294.13729     -28421.244     -20812.25       3486.703     
      2200   280.47345     -28428.095     -3154.9094      3487.3975    
      2300   304.43697     -28449.517     -19366.331      3488.0919    
      2400   306.34211     -28420.144     -5046.2142      3488.7863    
      2500   329.77884     -28424.655     -5462.3824      3489.4807    
      2600   304.94158     -28414.336     -9044.06        3490.1752    
      2700   291.57129     -28430.063     -6596.3362      3490.8696    
      2800   286.05044     -28432.379     -17271.928      3491.564     
      2900   299.26309     -28433.455     -19807.015      3492.2584    
      3000   317.93561     -28438.94      -11146.467      3492.9529    
      3100   290.33559     -28412.93      -6481.6519      3493.6473    
      3200   322.61942     -28413.435     -45.90736       3494.3417    
      3300   333.26012     -28408.357      3301.1127      3495.0361    
      3400   308.41362     -28416.67       279.00605      3495.7306    
      3500   306.63615     -28433.178     -1761.5867      3496.425     
      3600   290.50275     -28429.501     -4769.2129      3497.1194    
      3700   289.66872     -28435.637     -7236.5099      3497.8138    
      3800   310.95883     -28432.447     -11889.366      3498.5083    
      3900   315.0233      -28415.25      -12006.197      3499.2027    
      4000   294.88004     -28407.269     -6834.4819      3499.8971    
      4100   294.11695     -28425.024     -9619.6685      3500.5915    
      4200   279.13642     -28425.076     -8811.0784      3501.2859    
      4300   283.96475     -28414.207     -11541.712      3501.9804    
      4400   339.08095     -28424.315      3032.6497      3502.6748    
      4500   301.90453     -28412.455      97.071239      3503.3692    
      4600   295.56167     -28430.096     -14126.356      3504.0636    
      4700   295.12253     -28435.922      7149.6273      3504.7581    
      4800   312.67444     -28443.974     -379.86289      3505.4525    
      4900   313.1071      -28416.363     -12492.269      3506.1469    
      5000   305.16289     -28399.717     -10945.118      3506.8413    
Loop time of 161.316 on 16 procs for 5000 steps with 274 atoms

Performance: 1.339 ns/day, 17.924 hours/ns, 30.995 timesteps/s, 8.493 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 93.667     | 118.79     | 141.64     | 170.4 | 73.64
Bond    | 0.012464   | 0.013923   | 0.015566   |   0.8 |  0.01
Neigh   | 1.3052     | 1.5814     | 1.9089     |  18.0 |  0.98
Comm    | 3.1481     | 25.996     | 51.114     | 364.2 | 16.12
Output  | 0.014938   | 0.033617   | 0.076119   |  13.2 |  0.02
Modify  | 14.439     | 14.767     | 15.054     |   5.9 |  9.15
Other   |            | 0.1354     |            |       |  0.08

Nlocal:          34.25 ave          39 max          21 min
Histogram: 1 0 0 0 0 1 0 0 5 1
Nghost:        2800.75 ave        2823 max        2771 min
Histogram: 1 1 0 2 0 0 0 0 1 3
Neighs:          18756 ave       21301 max       11814 min
Histogram: 1 0 0 0 0 1 0 0 5 1

Total # of neighbors = 150048
Ave neighs/atom = 547.62044
Ave special neighs/atom = 0
Neighbor list builds = 84
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos1

# Delete dir to make sure it is not reused
variable dir delete
# uyy Perturbation
variable dir equal 2
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
variable len0 equal ${ly0}
variable len0 equal 12.842
variable dlen equal ly-${len0}
variable dlen equal ly-12.842
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.001 seconds
  read_restart CPU = 0.005 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.842
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.12842 yz delta ${deltayz} remap v units box flip no
fix deform_n all deform 100 y delta 0 -0.12842 yz delta -0.004312 remap v units box flip no
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg2 all custom/gz 100 dump/neg_deform2.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109 | 111.4 | 113.2 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   287.77099     -28418.746     -8186.1241      3472.1201    
       100   300.05513     -28423.632     -15296.613      3471.4257    
       200   312.88208     -28441.506     -6300.8754      3470.7313    
       300   282.75666     -28439.56       3807.9963      3470.0369    
       400   298.8638      -28458.296      1197.7211      3469.3424    
       500   315.44856     -28453.256     -9024.3067      3468.648     
       600   305.99575     -28423.338     -20876.15       3467.9536    
       700   281.1229      -28402.976     -11770.906      3467.2592    
       800   307.51611     -28421.961     -16305.724      3466.5647    
       900   324.39675     -28443.979      9170.8414      3465.8703    
      1000   288.07968     -28448.276      1300.8027      3465.1759    
      1100   283.20512     -28445.415     -10684.996      3464.4815    
      1200   304.46802     -28445.581     -11914.6        3463.7871    
      1300   305.32914     -28427.992     -10730.831      3463.0926    
      1400   300.52022     -28417.97      -18017.286      3462.3982    
      1500   312.38737     -28427.999     -20073.236      3461.7038    
      1600   315.12058     -28445.827     -11034.735      3461.0094    
      1700   284.98962     -28449.979      1901.6067      3460.3149    
      1800   270.53674     -28442.401     -11501.216      3459.6205    
      1900   295.45199     -28434.802     -347.09452      3458.9261    
      2000   314.38571     -28440.477      8296.7246      3458.2317    
      2100   291.40797     -28427.054     -7687.9953      3457.5372    
      2200   284.98895     -28423.799     -9442.9218      3456.8428    
      2300   302.87694     -28428.683     -14302.62       3456.1484    
      2400   319.97632     -28422.79      -14475.43       3455.454     
      2500   316.90859     -28414.059      661.26182      3454.7595    
      2600   298.0613      -28426.474     -13066.815      3454.0651    
      2700   276.60381     -28431.225      2791.6608      3453.3707    
      2800   278.98617     -28425.586     -2293.1845      3452.6763    
      2900   302.68166     -28433.097     -8602.6873      3451.9818    
      3000   296.44492     -28406.023     -14474.878      3451.2874    
      3100   339.08254     -28420.929     -15481.715      3450.593     
      3200   312.77497     -28428.728     -21378.56       3449.8986    
      3300   292.58192     -28433.94      -4833.8577      3449.2041    
      3400   280.26825     -28423.875     -12346.118      3448.5097    
      3500   313.62735     -28437.725     -9226.297       3447.8153    
      3600   316.19039     -28419.26      -595.49756      3447.1209    
      3700   299.87105     -28414.341     -18780.272      3446.4264    
      3800   291.13812     -28435.595      2274.0856      3445.732     
      3900   296.84992     -28442.372      4059.5358      3445.0376    
      4000   296.95798     -28436.746     -411.49988      3444.3432    
      4100   300.9264      -28430.944     -42.709098      3443.6488    
      4200   301.09523     -28428.96      -4762.9442      3442.9543    
      4300   293.79545     -28429.048     -12699.176      3442.2599    
      4400   279.01323     -28436.595     -7473.4746      3441.5655    
      4500   310.26507     -28465.16       3973.2186      3440.8711    
      4600   308.83737     -28444.837     -10519.158      3440.1766    
      4700   315.53085     -28426.072     -11303.737      3439.4822    
      4800   317.83489     -28437.894     -5108.0898      3438.7878    
      4900   283.22736     -28424.635     -13137.955      3438.0934    
      5000   299.6871      -28443.182     -6985.305       3437.3989    
Loop time of 173.931 on 16 procs for 5000 steps with 274 atoms

Performance: 1.242 ns/day, 19.326 hours/ns, 28.747 timesteps/s, 7.877 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 129.52     | 136.92     | 145.8      |  51.7 | 78.72
Bond    | 0.013725   | 0.014889   | 0.016154   |   0.6 |  0.01
Neigh   | 1.501      | 1.6022     | 1.7301     |   5.1 |  0.92
Comm    | 10.317     | 19.192     | 26.622     | 138.3 | 11.03
Output  | 0.023263   | 0.041384   | 0.082036   |  11.5 |  0.02
Modify  | 15.775     | 15.913     | 16.034     |   1.8 |  9.15
Other   |            | 0.2521     |            |       |  0.14

Nlocal:          34.25 ave          41 max          18 min
Histogram: 1 0 0 0 0 1 1 1 1 3
Nghost:        2838.62 ave        2906 max        2774 min
Histogram: 2 1 1 0 0 0 0 1 2 1
Neighs:        19126.2 ave       22871 max       10342 min
Histogram: 1 0 0 0 0 2 0 1 1 3

Total # of neighbors = 153010
Ave neighs/atom = 558.43066
Ave special neighs/atom = 0
Neighbor list builds = 79
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg2

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.842
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 ${delta} yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.12842 yz delta ${deltayz} remap v units box
fix deform_p all deform 100 y delta 0 0.12842 yz delta 0.004312 remap v units box
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 2 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos2.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos2.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos2 all custom/gz 100 dump/pos_deform2.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109 | 111.4 | 113.3 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   287.77099     -28418.746     -8186.1241      3472.1201    
       100   300.07431     -28423.632     -15282.722      3472.8146    
       200   312.84225     -28441.22      -6349.7128      3473.509     
       300   282.21328     -28438.906      3506.4968      3474.2034    
       400   297.9347      -28456.945      2032.2089      3474.8978    
       500   317.62806     -28453.964     -9829.1631      3475.5923    
       600   307.42112     -28423.877     -20453.662      3476.2867    
       700   277.16047     -28398.958     -11853.48       3476.9811    
       800   313.70547     -28425.13      -16163.078      3477.6755    
       900   325.71296     -28440.347      8841.9967      3478.37      
      1000   283.8261      -28437.566      1279.3341      3479.0644    
      1100   284.53334     -28442.332     -12210.174      3479.7588    
      1200   300.16128     -28437.566     -11077.966      3480.4532    
      1300   298.51842     -28415.784     -7281.5327      3481.1477    
      1400   317.54407     -28428.803     -4947.556       3481.8421    
      1500   291.15888     -28411.518     -13225.416      3482.5365    
      1600   305.79419     -28434.057     -16448.681      3483.2309    
      1700   292.32345     -28445.352      5510.7903      3483.9253    
      1800   290.40168     -28459.655     -6316.9953      3484.6198    
      1900   285.65863     -28433.89      -10362.366      3485.3142    
      2000   306.52692     -28437.651      3136.3489      3486.0086    
      2100   292.68743     -28424.893     -12714.246      3486.703     
      2200   294.3797      -28422.131     -4430.9767      3487.3975    
      2300   306.41714     -28427.833     -13531.19       3488.0919    
      2400   308.56966     -28433.892     -12316.112      3488.7863    
      2500   298.04        -28440.48      -314.68054      3489.4807    
      2600   282.92028     -28432.467     -13015.237      3490.1752    
      2700   304.62878     -28439.148     -22201.046      3490.8696    
      2800   292.21691     -28403.772     -19076.378      3491.564     
      2900   311.55505     -28414.89      -8995.6777      3492.2584    
      3000   286.16758     -28423.274      1491.7722      3492.9529    
      3100   290.71895     -28437.341     -11063.544      3493.6473    
      3200   299.27561     -28435.643     -4147.0498      3494.3417    
      3300   288.49569     -28414.151     -12527.267      3495.0361    
      3400   318.32412     -28426.397     -10519.649      3495.7306    
      3500   293.25917     -28420.798     -17139.568      3496.425     
      3600   294.25601     -28442.19       1839.2088      3497.1194    
      3700   294.36622     -28437.508     -4720.0394      3497.8138    
      3800   323.05114     -28433.223     -7724.8971      3498.5083    
      3900   310.67237     -28418.409     -9162.8836      3499.2027    
      4000   298.96548     -28419.354     -8582.0351      3499.8971    
      4100   280.75312     -28410.368     -17535.732      3500.5915    
      4200   312.80589     -28438.261     -11557.513      3501.2859    
      4300   292.79147     -28417.658     -12366.436      3501.9804    
      4400   299.44784     -28402.615     -7756.0375      3502.6748    
      4500   309.96418     -28403.303     -9752.0374      3503.3692    
      4600   315.78747     -28431.146     -17779.601      3504.0636    
      4700   310.41248     -28446.398     -12875.309      3504.7581    
      4800   303.00695     -28440.272     -7256.3672      3505.4525    
      4900   292.09848     -28425.609     -3016.2475      3506.1469    
      5000   298.04051     -28401.777     -4377.7365      3506.8413    
Loop time of 170.309 on 16 procs for 5000 steps with 274 atoms

Performance: 1.268 ns/day, 18.923 hours/ns, 29.358 timesteps/s, 8.044 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 128.78     | 134.31     | 142.2      |  34.3 | 78.86
Bond    | 0.013991   | 0.015111   | 0.016974   |   0.8 |  0.01
Neigh   | 1.5118     | 1.5663     | 1.6215     |   2.6 |  0.92
Comm    | 11.045     | 19.008     | 24.556     |  91.9 | 11.16
Output  | 0.022694   | 0.040274   | 0.078713   |  11.3 |  0.02
Modify  | 15.04      | 15.114     | 15.187     |   1.1 |  8.87
Other   |            | 0.254      |            |       |  0.15

Nlocal:          34.25 ave          41 max          18 min
Histogram: 1 0 0 0 0 1 0 2 3 1
Nghost:        2782.25 ave        2836 max        2720 min
Histogram: 1 1 0 1 1 0 1 1 0 2
Neighs:        18724.1 ave       22256 max       10163 min
Histogram: 1 0 0 0 0 1 0 2 3 1

Total # of neighbors = 149793
Ave neighs/atom = 546.68978
Ave special neighs/atom = 0
Neighbor list builds = 79
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos2

# Delete dir to make sure it is not reused
variable dir delete
# uzz Perturbation
variable dir equal 3
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
variable len0 equal ${lz0}
variable len0 equal 16.0755
variable dlen equal lz-${len0}
variable dlen equal lz-16.0755
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.0755
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 ${delta} remap v units box flip no
fix deform_n all deform 100 z delta 0 -0.160755 remap v units box flip no
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg3 all custom/gz 100 dump/neg_deform3.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109 | 111.4 | 113.2 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   287.77099     -28418.746     -8186.1241      3472.1201    
       100   300.06051     -28423.634     -15293.487      3471.4257    
       200   312.77305     -28441.435     -6227.8263      3470.7313    
       300   282.73576     -28439.624      3709.5127      3470.0369    
       400   298.8467      -28458.373      1341.4139      3469.3424    
       500   315.99954     -28454.392     -9675.6026      3468.648     
       600   306.06898     -28423.962     -19877.695      3467.9536    
       700   281.56017     -28403.919     -12205.148      3467.2592    
       800   313.18485     -28427.135     -16230.544      3466.5647    
       900   321.51077     -28446.591      9106.2647      3465.8703    
      1000   285.77059     -28450.375     -897.44254      3465.1759    
      1100   281.72216     -28443.46      -9835.4346      3464.4815    
      1200   306.12716     -28445.799     -7016.8934      3463.7871    
      1300   306.2347      -28430.786     -10447.644      3463.0926    
      1400   309.76059     -28428.791     -6732.7894      3462.3982    
      1500   300.09698     -28418.985     -15839.212      3461.7038    
      1600   300.07799     -28430.305     -16974.706      3461.0094    
      1700   306.12568     -28463.468     -5256.86        3460.3149    
      1800   269.92302     -28437.35      -5906.9871      3459.6205    
      1900   294.82408     -28432.012     -71.740133      3458.9261    
      2000   299.59797     -28424.697      18409.99       3458.2317    
      2100   298.38992     -28427.348     -3900.3095      3457.5372    
      2200   307.47806     -28444.785     -10971.662      3456.8428    
      2300   284.51925     -28433.406     -13452.629      3456.1484    
      2400   293.35835     -28433.629     -12349.469      3455.454     
      2500   339.46769     -28445.998      3679.484       3454.7595    
      2600   305.72671     -28418.252      467.68998      3454.0651    
      2700   301.28197     -28432.615     -894.80684      3453.3707    
      2800   287.59306     -28441.793     -6858.4986      3452.6763    
      2900   280.55471     -28445.423     -16318.892      3451.9818    
      3000   295.70764     -28445.012     -15189.662      3451.2874    
      3100   312.90122     -28432.674     -20809.01       3450.593     
      3200   295.67555     -28407.71      -15629.683      3449.8986    
      3300   322.73926     -28432.497     -14365.621      3449.2041    
      3400   297.10332     -28438.68      -3720.9406      3448.5097    
      3500   280.46705     -28439.664     -14573.924      3447.8153    
      3600   284.36565     -28436.393     -10777.826      3447.1209    
      3700   293.34246     -28429.346     -3622.3381      3446.4264    
      3800   317.31913     -28444.303     -15497.192      3445.732     
      3900   292.68232     -28424.15      -6988.0873      3445.0376    
      4000   289.72106     -28410.078     -7110.3092      3444.3432    
      4100   345.42026     -28422.873     -3378.035       3443.6488    
      4200   337.56574     -28429.723     -5629.5551      3442.9543    
      4300   317.29813     -28436.341      4238.1779      3442.2599    
      4400   275.87796     -28414.133     -12956.36       3441.5655    
      4500   287.71391     -28429.321      4489.1601      3440.8711    
      4600   295.31544     -28426.645     -9324.7691      3440.1766    
      4700   305.11569     -28418.113      4130.5086      3439.4822    
      4800   303.75829     -28401.109     -161.50343      3438.7878    
      4900   316.53199     -28420.908     -6781.2329      3438.0934    
      5000   290.77468     -28432.318      1572.2509      3437.3989    
Loop time of 174.313 on 16 procs for 5000 steps with 274 atoms

Performance: 1.239 ns/day, 19.368 hours/ns, 28.684 timesteps/s, 7.859 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 128.16     | 139.59     | 148.29     |  57.9 | 80.08
Bond    | 0.013741   | 0.014986   | 0.016302   |   0.6 |  0.01
Neigh   | 1.5964     | 1.682      | 1.7841     |   4.6 |  0.96
Comm    | 8.6086     | 17.324     | 28.756     | 165.0 |  9.94
Output  | 0.022436   | 0.040416   | 0.080228   |  11.5 |  0.02
Modify  | 15.291     | 15.406     | 15.537     |   2.0 |  8.84
Other   |            | 0.2569     |            |       |  0.15

Nlocal:          34.25 ave          40 max          23 min
Histogram: 1 0 0 0 0 1 1 2 2 1
Nghost:        2827.88 ave        2878 max        2763 min
Histogram: 1 1 0 0 2 0 0 2 0 2
Neighs:        19118.2 ave       22004 max       13081 min
Histogram: 1 0 0 0 0 1 1 2 2 1

Total # of neighbors = 152946
Ave neighs/atom = 558.19708
Ave special neighs/atom = 0
Neighbor list builds = 81
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg3

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.0755
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 ${delta} remap v units box
fix deform_p all deform 100 z delta 0 0.160755 remap v units box
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 3 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos3.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos3.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos3 all custom/gz 100 dump/pos_deform3.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109 | 111.4 | 113.2 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   287.77099     -28418.746     -8186.1241      3472.1201    
       100   300.06877     -28423.63      -15286.032      3472.8146    
       200   312.93108     -28441.284     -6448.6261      3473.509     
       300   282.32541     -28438.868      3596.3297      3474.2034    
       400   298.02797     -28456.888      1899.631       3474.8978    
       500   316.5503      -28452.214     -9316.7001      3475.5923    
       600   307.39742     -28423.15      -20820.066      3476.2867    
       700   276.95838     -28398.13      -12527.344      3476.9811    
       800   312.17497     -28424.175     -16765.025      3477.6755    
       900   325.05612     -28442.218      7681.6581      3478.37      
      1000   283.26041     -28441.788      618.95914      3479.0644    
      1100   286.34997     -28445.13      -14222.571      3479.7588    
      1200   292.77202     -28432.727     -10615.829      3480.4532    
      1300   292.138       -28413.148     -7998.3948      3481.1477    
      1400   316.78299     -28427.947     -7634.7975      3481.8421    
      1500   290.49544     -28410.35      -14377.425      3482.5365    
      1600   299.09419     -28425.165     -11860.131      3483.2309    
      1700   308.40077     -28448.391     -556.11345      3483.9253    
      1800   286.87497     -28439.094     -9170.1925      3484.6198    
      1900   286.14082     -28415.448     -7987.3761      3485.3142    
      2000   317.45813     -28423.875     -145.06339      3486.0086    
      2100   306.41831     -28425.387     -4162.0343      3486.703     
      2200   288.6357      -28418.121     -14338.611      3487.3975    
      2300   300.37747     -28431.661     -11915.348      3488.0919    
      2400   307.17405     -28448.372     -3975.321       3488.7863    
      2500   276.88373     -28443.639     -877.22832      3489.4807    
      2600   281.51906     -28435.045     -4043.782       3490.1752    
      2700   294.5826      -28419.922     -18698.458      3490.8696    
      2800   296.84821     -28417.46      -24853.318      3491.564     
      2900   289.1579      -28423.35      -17189.842      3492.2584    
      3000   266.94564     -28422.295     -15571.51       3492.9529    
      3100   278.70086     -28435.71      -11766.639      3493.6473    
      3200   295.57973     -28418.462     -14258.95       3494.3417    
      3300   318.05724     -28422.109     -15940.55       3495.0361    
      3400   298.9062      -28412.819      473.17925      3495.7306    
      3500   295.97972     -28428.069     -7157.7175      3496.425     
      3600   274.04693     -28428.109     -17252.854      3497.1194    
      3700   270.16145     -28433.023     -15676.572      3497.8138    
      3800   303.2578      -28429.442     -13925.078      3498.5083    
      3900   294.2216      -28405.46      -13688.14       3499.2027    
      4000   323.03484     -28421.144     -12385.665      3499.8971    
      4100   301.64845     -28421.189     -23564.952      3500.5915    
      4200   304.3529      -28442.749      1005.2133      3501.2859    
      4300   264.59409     -28409.938      1862.3099      3501.9804    
      4400   292.28949     -28419.007     -9533.7937      3502.6748    
      4500   285.19083     -28406.656     -10718.553      3503.3692    
      4600   283.29998     -28405.135     -11116.114      3504.0636    
      4700   309.50027     -28435.156     -1969.5683      3504.7581    
      4800   291.84235     -28439.428     -8194.7393      3505.4525    
      4900   279.61728     -28432.919     -15957.379      3506.1469    
      5000   294.17926     -28409.162     -9306.268       3506.8413    
Loop time of 171.036 on 16 procs for 5000 steps with 274 atoms

Performance: 1.263 ns/day, 19.004 hours/ns, 29.234 timesteps/s, 8.010 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 123        | 135.57     | 143.99     |  60.7 | 79.26
Bond    | 0.014013   | 0.01507    | 0.016266   |   0.6 |  0.01
Neigh   | 1.4494     | 1.5533     | 1.6537     |   5.6 |  0.91
Comm    | 10.019     | 18.436     | 31.016     | 164.8 | 10.78
Output  | 0.02332    | 0.042016   | 0.083711   |  11.8 |  0.02
Modify  | 15.024     | 15.174     | 15.314     |   2.1 |  8.87
Other   |            | 0.2469     |            |       |  0.14

Nlocal:          34.25 ave          39 max          18 min
Histogram: 1 0 0 0 0 0 1 0 1 5
Nghost:        2788.38 ave        2837 max        2728 min
Histogram: 1 3 0 0 0 0 0 0 0 4
Neighs:        18734.8 ave       21080 max       10140 min
Histogram: 1 0 0 0 0 0 1 0 1 5

Total # of neighbors = 149878
Ave neighs/atom = 547
Ave special neighs/atom = 0
Neighbor list builds = 77
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos3

# Delete dir to make sure it is not reused
variable dir delete
# uyz Perturbation
variable dir equal 4
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
variable len0 equal ${lx0}
variable len0 equal 16.8189
variable dlen equal 2*(yz-${yz0})
variable dlen equal 2*(yz-0.4312)
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.8189
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta ${delta} remap v units box flip no
fix deform_n all deform 100 yz delta -0.168189 remap v units box flip no
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg4 all custom/gz 100 dump/neg_deform4.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109 | 111.4 | 113.2 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   287.77099     -28418.746     -8186.1241      3472.1201    
       100   300.06559     -28423.63      -15289.205      3472.1201    
       200   313.01343     -28441.399     -6280.7949      3472.1201    
       300   282.74372     -28439.259      3623.0593      3472.1201    
       400   298.19462     -28457.609      1447.7356      3472.1201    
       500   316.29007     -28453.609     -9864.19        3472.1201    
       600   306.08844     -28423.253     -20750.568      3472.1201    
       700   279.37649     -28401.118     -12562.481      3472.1201    
       800   313.92943     -28425.721     -15304.423      3472.1201    
       900   327.34663     -28447.815      9144.0767      3472.1201    
      1000   283.28149     -28445.575      1750.06        3472.1201    
      1100   283.32086     -28442.177     -10860.428      3472.1201    
      1200   300.59944     -28439.578     -10662.155      3472.1201    
      1300   302.80835     -28422.545     -12539.224      3472.1201    
      1400   313.5079      -28427.944     -11996.998      3472.1201    
      1500   305.1707      -28424.575     -16733.571      3472.1201    
      1600   307.07989     -28437.558     -16076.229      3472.1201    
      1700   288.88983     -28450.254     -3735.1038      3472.1201    
      1800   279.03502     -28449.821     -7024.5107      3472.1201    
      1900   281.7913      -28429.626     -6893.0313      3472.1201    
      2000   297.40275     -28428.645      682.81213      3472.1201    
      2100   288.80298     -28420.359     -8086.5286      3472.1201    
      2200   307.53516     -28421.779     -3989.0489      3472.1201    
      2300   337.39024     -28425.592     -6674.8594      3472.1201    
      2400   309.43627     -28409.432     -10778.922      3472.1201    
      2500   278.18602     -28421.292      11039.933      3472.1201    
      2600   303.72896     -28439.145     -19755.066      3472.1201    
      2700   280.70382     -28411.195     -6934.3337      3472.1201    
      2800   310.77642     -28426.5       -9436.3672      3472.1201    
      2900   321.29797     -28429.971     -5729.765       3472.1201    
      3000   319.07802     -28427.634     -3119.7708      3472.1201    
      3100   303.76132     -28438.174     -4974.9893      3472.1201    
      3200   292.76751     -28446.462     -5162.5219      3472.1201    
      3300   290.96951     -28436.267     -12336.907      3472.1201    
      3400   307.9913      -28428.279     -3307.186       3472.1201    
      3500   312.27026     -28424.577     -5939.8363      3472.1201    
      3600   304.7726      -28422.456      2266.5727      3472.1201    
      3700   290.90421     -28422.51      -10724.746      3472.1201    
      3800   304.59948     -28435.11       6220.8279      3472.1201    
      3900   300.67721     -28414.604     -10976.954      3472.1201    
      4000   317.25704     -28412.595     -4762.5121      3472.1201    
      4100   312.32175     -28416.728     -17568.045      3472.1201    
      4200   283.05888     -28424.38      -8798.1526      3472.1201    
      4300   301.23018     -28438.518     -9780.7032      3472.1201    
      4400   312.27159     -28434.121     -12959.596      3472.1201    
      4500   327.9602      -28438.601     -14476.017      3472.1201    
      4600   308.25525     -28440.413     -2024.3193      3472.1201    
      4700   295.11252     -28453.884     -959.26135      3472.1201    
      4800   272.97174     -28429.665     -11944.3        3472.1201    
      4900   306.66821     -28431.768     -9080.3368      3472.1201    
      5000   310.02777     -28427.037     -11857.177      3472.1201    
Loop time of 172.722 on 16 procs for 5000 steps with 274 atoms

Performance: 1.251 ns/day, 19.191 hours/ns, 28.948 timesteps/s, 7.932 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 131.63     | 138.11     | 145.05     |  34.8 | 79.96
Bond    | 0.01332    | 0.014787   | 0.016149   |   0.6 |  0.01
Neigh   | 1.5996     | 1.6538     | 1.7761     |   4.2 |  0.96
Comm    | 10.25      | 17.227     | 23.738     |  99.0 |  9.97
Output  | 0.023945   | 0.041906   | 0.081942   |  11.3 |  0.02
Modify  | 15.248     | 15.403     | 15.525     |   2.1 |  8.92
Other   |            | 0.2711     |            |       |  0.16

Nlocal:          34.25 ave          40 max          25 min
Histogram: 1 0 0 0 1 1 1 1 2 1
Nghost:        2807.62 ave        2858 max        2742 min
Histogram: 1 1 0 0 1 1 1 1 0 2
Neighs:        18927.9 ave       21970 max       14065 min
Histogram: 1 0 0 0 1 2 0 2 1 1

Total # of neighbors = 151423
Ave neighs/atom = 552.63869
Ave special neighs/atom = 0
Neighbor list builds = 81
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg4

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.8189
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta ${delta} remap v units box
fix deform_p all deform 100 yz delta 0.168189 remap v units box
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 4 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos4.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos4.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos4 all custom/gz 100 dump/pos_deform4.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109 | 111.4 | 113.3 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   287.77099     -28418.746     -8186.1241      3472.1201    
       100   300.06369     -28423.634     -15290.359      3472.1201    
       200   312.77175     -28441.33      -6415.8775      3472.1201    
       300   282.25437     -28439.128      3687.6491      3472.1201    
       400   298.55174     -28457.537      1780.5149      3472.1201    
       500   315.82962     -28452.751     -9147.4349      3472.1201    
       600   307.578       -28423.956     -20136.04       3472.1201    
       700   279.47991     -28401.199     -12556.457      3472.1201    
       800   312.40139     -28426.017     -16747.214      3472.1201    
       900   323.16626     -28443.845      7637.8912      3472.1201    
      1000   280.24454     -28441.285      2012.4756      3472.1201    
      1100   288.60739     -28447.996     -12636.983      3472.1201    
      1200   300.50497     -28441.069     -11942.542      3472.1201    
      1300   298.26173     -28422.965     -7521.1434      3472.1201    
      1400   307.48543     -28427.233     -13513.974      3472.1201    
      1500   296.06713     -28418.243     -14713.003      3472.1201    
      1600   297.84784     -28429.294     -15573.4        3472.1201    
      1700   287.9693      -28440.901     -1512.7264      3472.1201    
      1800   290.03827     -28444.738     -8918.3584      3472.1201    
      1900   306.8718      -28431.366     -5930.4697      3472.1201    
      2000   306.6956      -28422.222     -1966.5463      3472.1201    
      2100   319.00152     -28441.734     -6052.5235      3472.1201    
      2200   278.88111     -28423.611     -9248.8207      3472.1201    
      2300   289.70471     -28431.296     -10447.854      3472.1201    
      2400   292.16887     -28423.388     -6390.8338      3472.1201    
      2500   312.91887     -28432.042      5444.2898      3472.1201    
      2600   313.55406     -28433.766     -6517.4934      3472.1201    
      2700   286.32584     -28421.845     -2824.4107      3472.1201    
      2800   315.65363     -28461.542     -225.53798      3472.1201    
      2900   279.65722     -28454.198     -12577.69       3472.1201    
      3000   276.87018     -28435.911     -11535.356      3472.1201    
      3100   289.29893     -28429.755     -10258.419      3472.1201    
      3200   302.94463     -28430.352     -9759.425       3472.1201    
      3300   299.59752     -28422.081     -2334.8363      3472.1201    
      3400   333.5175      -28434.977     -18072.556      3472.1201    
      3500   313.33655     -28412.208     -7130.7685      3472.1201    
      3600   288.23107     -28421.468     -1681.8948      3472.1201    
      3700   301.55987     -28442.463      84.345668      3472.1201    
      3800   299.39716     -28440.926      11053.319      3472.1201    
      3900   298.88286     -28436.261      10619.49       3472.1201    
      4000   322.57778     -28443.784     -19352.022      3472.1201    
      4100   313.96293     -28417.921     -24131.399      3472.1201    
      4200   316.40899     -28420.471     -18198.123      3472.1201    
      4300   299.23833     -28438.258     -17079.02       3472.1201    
      4400   290.06865     -28437.076      1534.5809      3472.1201    
      4500   294.85026     -28436.325     -205.85838      3472.1201    
      4600   318.047       -28437.824     -3988.4565      3472.1201    
      4700   313.41053     -28432.631     -21514.21       3472.1201    
      4800   282.15382     -28437.289     -9949.8939      3472.1201    
      4900   300.21226     -28462.062      3944.3227      3472.1201    
      5000   289.19191     -28440.428     -12298.05       3472.1201    
Loop time of 172.594 on 16 procs for 5000 steps with 274 atoms

Performance: 1.251 ns/day, 19.177 hours/ns, 28.970 timesteps/s, 7.938 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 126.35     | 137.43     | 146.48     |  54.3 | 79.62
Bond    | 0.013502   | 0.014984   | 0.016315   |   0.6 |  0.01
Neigh   | 1.578      | 1.6379     | 1.7733     |   4.8 |  0.95
Comm    | 8.8629     | 17.877     | 28.969     | 150.6 | 10.36
Output  | 0.023701   | 0.041825   | 0.082278   |  11.4 |  0.02
Modify  | 15.219     | 15.348     | 15.383     |   1.3 |  8.89
Other   |            | 0.2478     |            |       |  0.14

Nlocal:          34.25 ave          38 max          20 min
Histogram: 1 0 0 0 0 0 1 0 2 4
Nghost:        2824.62 ave        2878 max        2775 min
Histogram: 3 1 0 0 0 0 0 0 2 2
Neighs:        18912.6 ave       20888 max       11355 min
Histogram: 1 0 0 0 0 0 1 0 1 5

Total # of neighbors = 151301
Ave neighs/atom = 552.19343
Ave special neighs/atom = 0
Neighbor list builds = 80
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos4

# Delete dir to make sure it is not reused
variable dir delete
# uxz Perturbation
variable dir equal 5
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
variable len0 equal ${ly0}
variable len0 equal 12.842
variable dlen equal 2*(xz-${xz0})
variable dlen equal 2*(xz-1.195)
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*12.842
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta ${delta} remap v units box flip no
fix deform_n all deform 100 xz delta -0.12842 remap v units box flip no
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg5 all custom/gz 100 dump/neg_deform5.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109 | 111.4 | 113.2 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   287.77099     -28418.746     -8186.1241      3472.1201    
       100   300.07148     -28423.633     -15288.888      3472.1201    
       200   312.85914     -28441.394     -6379.3366      3472.1201    
       300   282.50223     -28439.198      3615.673       3472.1201    
       400   298.32024     -28457.575      1453.0016      3472.1201    
       500   316.24869     -28453.256     -9582.5992      3472.1201    
       600   306.20845     -28423.04      -20348.016      3472.1201    
       700   280.04663     -28401.599     -12811.849      3472.1201    
       800   312.65899     -28425.438     -16664.418      3472.1201    
       900   326.81583     -28447.362      7526.5109      3472.1201    
      1000   284.85914     -28447.507      1015.2577      3472.1201    
      1100   277.79528     -28440.337     -12299.125      3472.1201    
      1200   299.48077     -28439.965     -9085.6082      3472.1201    
      1300   302.67911     -28424.872     -8519.5086      3472.1201    
      1400   312.48487     -28428.951     -12363.745      3472.1201    
      1500   298.85297     -28421.54      -16099.065      3472.1201    
      1600   297.97478     -28438.719     -15530.927      3472.1201    
      1700   274.3735      -28443.011     -3059.1086      3472.1201    
      1800   288.26468     -28438.957     -7664.2538      3472.1201    
      1900   301.61779     -28427.407      4634.1891      3472.1201    
      2000   315.68487     -28435.355      3643.5331      3472.1201    
      2100   309.12747     -28440.726     -4982.5655      3472.1201    
      2200   278.32989     -28429.598     -8675.1212      3472.1201    
      2300   309.98161     -28441.285     -16423.55       3472.1201    
      2400   324.04069     -28423.339     -16944.881      3472.1201    
      2500   300.41642     -28409.013      3625.4791      3472.1201    
      2600   306.00087     -28424.472      18.559903      3472.1201    
      2700   282.41567     -28418.715     -287.42355      3472.1201    
      2800   262.33155     -28428.245     -10292.149      3472.1201    
      2900   276.75848     -28443.04      -13786.265      3472.1201    
      3000   292.26383     -28424.72      -13776.072      3472.1201    
      3100   302.47384     -28418.843     -7483.1686      3472.1201    
      3200   327.83171     -28439.516      799.42221      3472.1201    
      3300   288.65414     -28423.229     -6506.4397      3472.1201    
      3400   296.10998     -28439.067     -18420.09       3472.1201    
      3500   264.75464     -28419.156     -16971.747      3472.1201    
      3600   296.44995     -28426.65      -16517.552      3472.1201    
      3700   316.64432     -28420.31      -3334.249       3472.1201    
      3800   288.45715     -28405.637     -3971.5614      3472.1201    
      3900   306.18721     -28443.502     -7383.3329      3472.1201    
      4000   294.82537     -28434.605     -3759.7247      3472.1201    
      4100   285.22153     -28421.794     -20539.82       3472.1201    
      4200   303.64648     -28424.803     -9429.2033      3472.1201    
      4300   337.25932     -28421.245      406.83159      3472.1201    
      4400   330.1729      -28404.427      546.67141      3472.1201    
      4500   308.20333     -28408.195     -2134.2179      3472.1201    
      4600   296.36077     -28416.789     -9449.3826      3472.1201    
      4700   294.57435     -28431.687     -20061.239      3472.1201    
      4800   276.4605      -28415.785     -7214.5483      3472.1201    
      4900   301.90911     -28422.715     -3303.1207      3472.1201    
      5000   325.82514     -28413.001      1621.6337      3472.1201    
Loop time of 172.403 on 16 procs for 5000 steps with 274 atoms

Performance: 1.253 ns/day, 19.156 hours/ns, 29.002 timesteps/s, 7.946 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 127.9      | 137.94     | 147.95     |  54.1 | 80.01
Bond    | 0.013691   | 0.015055   | 0.01638    |   0.6 |  0.01
Neigh   | 1.394      | 1.4805     | 1.5932     |   4.9 |  0.86
Comm    | 7.4066     | 17.4       | 27.42      | 152.1 | 10.09
Output  | 0.021646   | 0.039511   | 0.079579   |  11.6 |  0.02
Modify  | 15.235     | 15.313     | 15.444     |   1.6 |  8.88
Other   |            | 0.2145     |            |       |  0.12

Nlocal:          34.25 ave          39 max          19 min
Histogram: 1 0 0 0 0 0 1 1 1 4
Nghost:        2810.62 ave        2871 max        2740 min
Histogram: 1 1 0 2 0 0 0 2 0 2
Neighs:        18941.5 ave       21540 max       10801 min
Histogram: 1 0 0 0 0 0 1 2 1 3

Total # of neighbors = 151532
Ave neighs/atom = 553.0365
Ave special neighs/atom = 0
Neighbor list builds = 73
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg5

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.003 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*12.842
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta ${delta} remap v units box
fix deform_p all deform 100 xz delta 0.12842 remap v units box
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 5 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos5.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos5.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos5 all custom/gz 100 dump/pos_deform5.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109 | 111.4 | 113.3 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   287.77099     -28418.746     -8186.1241      3472.1201    
       100   300.05777     -28423.63      -15290.544      3472.1201    
       200   312.831       -28441.314     -6298.0417      3472.1201    
       300   282.56204     -28439.267      3720.3344      3472.1201    
       400   298.43026     -28457.699      1731.6972      3472.1201    
       500   316.39491     -28453.305     -9498.4326      3472.1201    
       600   308.07263     -28424.67      -20446.748      3472.1201    
       700   278.45943     -28400.615     -12236.802      3472.1201    
       800   313.75466     -28426.999     -16573.736      3472.1201    
       900   320.12541     -28441.555      8786.9765      3472.1201    
      1000   280.99648     -28441.396      1944.3536      3472.1201    
      1100   293.02536     -28448.796     -11466.193      3472.1201    
      1200   296.22204     -28436.121     -11428.176      3472.1201    
      1300   302.41975     -28423.549     -9823.5822      3472.1201    
      1400   314.02694     -28429.873     -13843.244      3472.1201    
      1500   295.04431     -28417.516     -14518.647      3472.1201    
      1600   307.48728     -28442.171     -10599.625      3472.1201    
      1700   285.28168     -28443.094      8483.0342      3472.1201    
      1800   278.30293     -28444.985     -5021.6265      3472.1201    
      1900   295.28963     -28432.955     -4347.5823      3472.1201    
      2000   322.79933     -28435.683      2598.3944      3472.1201    
      2100   297.25982     -28424.76      -13169.06       3472.1201    
      2200   293.54184     -28434.686     -10140.608      3472.1201    
      2300   302.60154     -28447.789     -9444.9822      3472.1201    
      2400   267.49507     -28424.464     -10166.082      3472.1201    
      2500   305.43784     -28437.532      12740.748      3472.1201    
      2600   307.13579     -28420.222     -12354.371      3472.1201    
      2700   285.6237      -28412.883     -17603.18       3472.1201    
      2800   302.30588     -28439.716     -11977.212      3472.1201    
      2900   285.81973     -28448.848     -11084.535      3472.1201    
      3000   271.34399     -28446.102     -368.52924      3472.1201    
      3100   305.49274     -28441.588      248.22969      3472.1201    
      3200   315.16691     -28437.505     -4085.6816      3472.1201    
      3300   279.98424     -28406.144     -4822.9313      3472.1201    
      3400   313.00669     -28424.168     -12407.03       3472.1201    
      3500   335.73834     -28429.175     -15237.878      3472.1201    
      3600   291.61041     -28407.396     -10946.656      3472.1201    
      3700   294.1324      -28433.475     -13874.477      3472.1201    
      3800   305.29678     -28452.502     -8247.934       3472.1201    
      3900   275.41048     -28433.73      -8948.0536      3472.1201    
      4000   294.29355     -28425.981     -11416.113      3472.1201    
      4100   329.89325     -28429.555     -5494.9364      3472.1201    
      4200   325.40208     -28436.45      -9786.3797      3472.1201    
      4300   286.39481     -28424.61      -21700.142      3472.1201    
      4400   308.47693     -28449.511     -557.53474      3472.1201    
      4500   306.94758     -28451.992     -1112.2843      3472.1201    
      4600   297.20263     -28443.808      7751.4978      3472.1201    
      4700   323.8985      -28430.84       189.7133       3472.1201    
      4800   318.09787     -28419.525     -16505.418      3472.1201    
      4900   314.33803     -28437.04      -10794.365      3472.1201    
      5000   273.55757     -28419.746     -12006.044      3472.1201    
Loop time of 172.844 on 16 procs for 5000 steps with 274 atoms

Performance: 1.250 ns/day, 19.205 hours/ns, 28.928 timesteps/s, 7.926 katom-step/s
98.8% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 125.7      | 136.68     | 146.56     |  60.2 | 79.08
Bond    | 0.013501   | 0.015059   | 0.016473   |   0.7 |  0.01
Neigh   | 1.4949     | 1.596      | 1.7382     |   5.8 |  0.92
Comm    | 9.1219     | 19.017     | 30.009     | 161.6 | 11.00
Output  | 0.026814   | 0.045329   | 0.086369   |  11.2 |  0.03
Modify  | 15.133     | 15.252     | 15.324     |   1.7 |  8.82
Other   |            | 0.2358     |            |       |  0.14

Nlocal:          34.25 ave          41 max          21 min
Histogram: 1 0 0 0 1 0 1 1 2 2
Nghost:        2812.12 ave        2876 max        2747 min
Histogram: 2 0 1 1 0 0 0 1 2 1
Neighs:        18924.1 ave       22587 max       11864 min
Histogram: 1 0 0 0 1 0 1 2 2 1

Total # of neighbors = 151393
Ave neighs/atom = 552.5292
Ave special neighs/atom = 0
Neighbor list builds = 79
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos5

# Delete dir to make sure it is not reused
variable dir delete
# uxy Perturbation
variable dir equal 6
include displace.mod.lmp
# Find which length (epsilon) to calculate
if "${dir} == 1" then    "variable len0 equal ${lx0}"    "variable dlen equal lx-${len0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"    "variable dlen equal ly-${len0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"    "variable dlen equal lz-${len0}"
if "${dir} == 4" then    "variable len0 equal ${lx0}"    "variable dlen equal 2*(yz-${yz0})"
if "${dir} == 5" then    "variable len0 equal ${ly0}"    "variable dlen equal 2*(xz-${xz0})"
if "${dir} == 6" then    "variable len0 equal ${lz0}"    "variable dlen equal 2*(xy-${xy0})"
variable len0 equal ${lz0}
variable len0 equal 16.0755
variable dlen equal 2*(xy-${xy0})
variable dlen equal 2*(xy--8.3798)

# strain vector (epsilon)
variable eps equal v_dlen/v_len0

# stress vector (sigma)
variable sig1 equal -f_avgp[1]*${ufac}
variable sig1 equal -f_avgp[1]*0.000101325
variable sig2 equal -f_avgp[2]*${ufac}
variable sig2 equal -f_avgp[2]*0.000101325
variable sig3 equal -f_avgp[3]*${ufac}
variable sig3 equal -f_avgp[3]*0.000101325
variable sig4 equal -f_avgp[6]*${ufac}
variable sig4 equal -f_avgp[6]*0.000101325
variable sig5 equal -f_avgp[5]*${ufac}
variable sig5 equal -f_avgp[5]*0.000101325
variable sig6 equal -f_avgp[4]*${ufac}
variable sig6 equal -f_avgp[4]*0.000101325

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Negative deformation
variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*16.0755
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
print "*****debug*****"
*****debug*****
print "xy = $(xy), deltaxy = ${deltaxy}"
xy = -8.3797999999999994714, deltaxy = 0.083798
print "xz = $(xz), deltaxz = ${deltaxz}"
xz = 1.1950000000000000622, deltaxz = -0.01195
print "yz = $(yz), deltayz = ${deltayz}"
yz = 0.43120000000000002771, deltayz = -0.004312
print "*****"
*****

if "${dir} == 1" then    "fix deform_n all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box flip no"
if "${dir} == 2" then    "fix deform_n all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box flip no"
if "${dir} == 3" then    "fix deform_n all deform ${nthermo} z delta 0 ${delta} remap v units box flip no"
if "${dir} == 4" then    "fix deform_n all deform ${nthermo} yz delta ${delta} remap v units box flip no"
if "${dir} == 5" then    "fix deform_n all deform ${nthermo} xz delta ${delta} remap v units box flip no"
if "${dir} == 6" then    "fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no"
fix deform_n all deform ${nthermo} xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta ${delta} remap v units box flip no
fix deform_n all deform 100 xy delta -0.160755 remap v units box flip no

# Run MD for Negative deformation
print "*****Negative-deform ${dir} starts.*****"
*****Negative-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.neg${dir}.out"
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg${dir}.out screen no
print "# Stress and strain vectors, ${structure}, negative deformation ${dir}"       file stress_strain/stress_strain.neg6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.neg6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# save trajectory
# if "$(is_defined(dump,dump_neg${dir1}))" then "undump dump_neg${dir1}"
dump dump_neg${dir} all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz ${nthermo} dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz 100 dump/neg_deform${dir}.lammpstrj.gz id type q x y z
dump dump_neg6 all custom/gz 100 dump/neg_deform6.lammpstrj.gz id type q x y z
# variable dir1 equal ${dir}
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109 | 111.4 | 113.2 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   287.77099     -28418.746     -8186.1241      3472.1201    
       100   300.05315     -28423.626     -15287.652      3472.1201    
       200   312.81801     -28441.398     -6248.7808      3472.1201    
       300   282.55115     -28438.994      3667.0223      3472.1201    
       400   298.66537     -28457.826      1668.1206      3472.1201    
       500   316.37909     -28454.017     -9404.376       3472.1201    
       600   307.05506     -28424.053     -20495.022      3472.1201    
       700   279.70833     -28401.292     -12438.974      3472.1201    
       800   310.77621     -28424.506     -16732.469      3472.1201    
       900   325.96516     -28446.888      8404.0186      3472.1201    
      1000   284.02059     -28445.339      2823.2329      3472.1201    
      1100   289.93036     -28448.931     -11322.079      3472.1201    
      1200   301.76222     -28444.678     -10977.847      3472.1201    
      1300   300.33966     -28424.336     -9006.7711      3472.1201    
      1400   300.2906      -28420.305     -13144.631      3472.1201    
      1500   314.22198     -28432.328     -21539.096      3472.1201    
      1600   294.53297     -28428.508     -7618.9766      3472.1201    
      1700   286.36463     -28439.697     -2907.1507      3472.1201    
      1800   273.11739     -28438.979     -10944.503      3472.1201    
      1900   318.27594     -28454.228     -4994.4969      3472.1201    
      2000   303.875       -28421.49       8129.7584      3472.1201    
      2100   297.77037     -28415.817     -583.14386      3472.1201    
      2200   310.40633     -28448.587      1624.4542      3472.1201    
      2300   286.19425     -28437.31      -17572.305      3472.1201    
      2400   293.48833     -28435.649     -16458.052      3472.1201    
      2500   296.70409     -28426.391     -3476.8234      3472.1201    
      2600   309.76539     -28422.776     -15742.211      3472.1201    
      2700   302.86763     -28418.095     -4431.7155      3472.1201    
      2800   314.94461     -28434.348     -4670.7354      3472.1201    
      2900   302.18617     -28429.952     -11268.722      3472.1201    
      3000   281.50792     -28421.316     -12247.221      3472.1201    
      3100   286.07223     -28429.859     -19221.821      3472.1201    
      3200   279.91387     -28416.627     -4740.8926      3472.1201    
      3300   320.93769     -28420.45      -11606.899      3472.1201    
      3400   343.24741     -28433.943     -11075.113      3472.1201    
      3500   290.51491     -28418.666     -9329.2549      3472.1201    
      3600   298.66855     -28434.417     -13320.748      3472.1201    
      3700   298.91667     -28435.952     -4244.5762      3472.1201    
      3800   306.90112     -28435.547     -7681.3431      3472.1201    
      3900   292.94578     -28405.328     -6735.3543      3472.1201    
      4000   330.6062      -28418.003     -1550.4471      3472.1201    
      4100   323.47818     -28432.816     -15234.742      3472.1201    
      4200   295.08392     -28436.505     -1350.4748      3472.1201    
      4300   299.2285      -28441.326     -2766.2197      3472.1201    
      4400   305.77065     -28444.52      -1779.2117      3472.1201    
      4500   301.45683     -28436.485     -6637.0489      3472.1201    
      4600   321.56216     -28435.702     -6315.6025      3472.1201    
      4700   317.75965     -28420.552     -8838.8353      3472.1201    
      4800   292.25508     -28419.49      -12048.548      3472.1201    
      4900   296.31994     -28446.978     -865.26769      3472.1201    
      5000   308.15152     -28453.077     -14873.041      3472.1201    
Loop time of 174.049 on 16 procs for 5000 steps with 274 atoms

Performance: 1.241 ns/day, 19.339 hours/ns, 28.728 timesteps/s, 7.871 katom-step/s
98.7% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 127.02     | 139.16     | 149.99     |  58.9 | 79.96
Bond    | 0.013482   | 0.015022   | 0.016261   |   0.6 |  0.01
Neigh   | 1.667      | 1.744      | 1.8901     |   5.5 |  1.00
Comm    | 6.555      | 17.426     | 29.57      | 166.9 | 10.01
Output  | 0.023845   | 0.041932   | 0.082491   |  11.4 |  0.02
Modify  | 15.276     | 15.413     | 15.537     |   1.9 |  8.86
Other   |            | 0.2461     |            |       |  0.14

Nlocal:          34.25 ave          40 max          22 min
Histogram: 1 0 0 0 0 2 0 1 2 2
Nghost:        2828.25 ave        2901 max        2746 min
Histogram: 2 0 1 1 0 0 0 2 0 2
Neighs:        18911.8 ave       22039 max       12407 min
Histogram: 1 0 0 0 0 2 0 1 2 2

Total # of neighbors = 151294
Ave neighs/atom = 552.16788
Ave special neighs/atom = 0
Neighbor list builds = 85
Dangerous builds = 0
unfix deform_n
unfix data
undump dump_neg${dir}
undump dump_neg6

# Reset box and simulation parameters
clear
  using 2 OpenMP thread(s) per MPI task
# box tilt large
read_restart equil.res
Reading restart file ...
  restart file = 2 Aug 2023, LAMMPS = 2 Aug 2023
  restoring atom style full from restart
  triclinic box = (0 0 0) to (16.8189 12.842 16.0755) with tilt (-8.3798 1.195 0.4312)
WARNING: Triclinic box skew is large. LAMMPS will run inefficiently. (src/domain.cpp:220)
  2 by 2 by 2 MPI processor grid
  pair style reaxff stores no restart info
  274 atoms
Finding 1-2 1-3 1-4 neighbors ...
  special bond factors lj:    0        0        0       
  special bond factors coul:  0        0        0       
     0 = max # of 1-2 neighbors
     0 = max # of 1-3 neighbors
     0 = max # of 1-4 neighbors
     1 = max # of special neighbors
  special bonds CPU = 0.000 seconds
  read_restart CPU = 0.004 seconds

# Positive deformation
variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*16.0755
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "fix deform_p all deform ${nthermo} x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap v units box"
if "${dir} == 2" then    "fix deform_p all deform ${nthermo} y delta 0 ${delta} yz delta ${deltayz} remap v units box"
if "${dir} == 3" then    "fix deform_p all deform ${nthermo} z delta 0 ${delta} remap v units box"
if "${dir} == 4" then    "fix deform_p all deform ${nthermo} yz delta ${delta} remap v units box"
if "${dir} == 5" then    "fix deform_p all deform ${nthermo} xz delta ${delta} remap v units box"
if "${dir} == 6" then    "fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box"
fix deform_p all deform ${nthermo} xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta ${delta} remap v units box
fix deform_p all deform 100 xy delta 0.160755 remap v units box

# Run deformation MD
print "*****Positive-deform ${dir} starts.*****"
*****Positive-deform 6 starts.*****
include ff.mod.lmp
# Setup forcefield, system
# undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avgp))" then "unfix avgp"
if "$(is_defined(fix,avgl))" then "unfix avgl"
reset_timestep 0

# Assign the force field
pair_style reaxff NULL safezone 3.0 mincap 150
pair_coeff * * ${FF}
pair_coeff * * SiOCHN_2018.ff C H O Si
WARNING: Van der Waals parameters for element SI indicate inner wall+shielding, but earlier atoms indicate a different van der Waals method. This may cause division-by-zero errors. Keeping van der Waals setting for earlier atoms. (src/REAXFF/reaxff_ffield.cpp:251)


# charge method for reaxff
fix myqeq all qeq/reaxff 1 0.0 10.0 1.0e-6 reaxff maxiter 400
# Setup neighbor style
neighbor        2 bin
neigh_modify    every 10 delay 0 check yes

# Setup output
thermo		${nthermo}
thermo		100
thermo_style custom step temp pe press vol
# thermo_style custom step vol lx ly lz yz xz xy
thermo_modify norm no
# thermo_modify line multi

# Sample pressure (and length vector)
fix avgp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 ${nfreq} c_thermo_press mode vector
fix avgp all ave/time  10 10 100 c_thermo_press mode vector
# variable lx equal lx
# variable ly equal ly
# variable lz equal lz
# fix avgl all ave/time  ${nevery} ${nrepeat} ${nfreq} v_lx v_ly v_lz

# nvt
fix fnvt all nvt temp ${temp} ${temp} ${tdamp}
fix fnvt all nvt temp 300 ${temp} ${tdamp}
fix fnvt all nvt temp 300 300 ${tdamp}
fix fnvt all nvt temp 300 300 50


# Save stress, strain to "./stress_strain/stress_strain.pos${dir}.out"
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos${dir}.out screen no
print "# Stress and strain vectors, ${structure}, positive deformation ${dir}"       file stress_strain/stress_strain.pos6.out screen no
fix data all print ${nfreq} "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos${dir}.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"
fix data all print 100 "${eps} ${sig1} ${sig2} ${sig3} ${sig4} ${sig5} ${sig6}"       append stress_strain/stress_strain.pos6.out screen no       title "# eps sig1 sig2 sig3 sig4 sig5 sig6"

# # compute MSD and RDF
# compute msd1 all msd
# fix myMSD all ave/time ${nthermo} 1 ${nthermo} c_msd1[1] c_msd1[2] c_msd1[3] c_msd1[4] c_thermo_temp #     file stress_strain/msd_${dir}.out #     title2 "# TimeStep MSD_X MSD_Y MSD_Z MSD_Total Temperture"
# C-C C-Si Si-O C-H Si-Si
# compute rdf1 all rdf 100 1 1 1 4 3 4 1 2 4 4 cutoff 5.0
# fix myRDF all ave/time ${nthermo} 1 ${nthermo} c_rdf1[*] #     file stress_strain/rdf_${dir}.out mode vector #     title3 "# Row r g1(r) coor1(r) ..."

# save trajectory
# if "$(is_defined(dump,dump_pos${dir1}))" then "undump dump_pos${dir1}"
dump dump_pos${dir} all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz ${nthermo} dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz 100 dump/pos_deform${dir}.lammpstrj.gz id type q x y z
dump dump_pos6 all custom/gz 100 dump/pos_deform6.lammpstrj.gz id type q x y z
run ${nrun}
run 5000
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 5 3 3
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair reaxff, perpetual
      attributes: half, newton off, ghost
      pair build: half/bin/newtoff/ghost
      stencil: full/ghost/bin/3d
      bin: standard
  (2) fix qeq/reaxff, perpetual, copy from (1)
      attributes: half, newton off
      pair build: copy
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 109 | 111.4 | 113.3 Mbytes
   Step          Temp          PotEng         Press          Volume    
         0   287.77099     -28418.746     -8186.1241      3472.1201    
       100   300.0764      -28423.638     -15291.88       3472.1201    
       200   312.88256     -28441.331     -6440.8611      3472.1201    
       300   282.48757     -28439.421      3640.8882      3472.1201    
       400   298.05091     -28457.363      1542.9208      3472.1201    
       500   316.55975     -28452.967     -9735.6777      3472.1201    
       600   306.94248     -28423.575     -20158.143      3472.1201    
       700   279.20266     -28401.034     -12153.44       3472.1201    
       800   313.88096     -28426.669     -16686.04       3472.1201    
       900   324.40691     -28446.334      8850.2149      3472.1201    
      1000   283.57809     -28446.005     -825.401        3472.1201    
      1100   278.9048      -28439.768     -12207.586      3472.1201    
      1200   299.18814     -28439.228     -9847.8969      3472.1201    
      1300   300.79674     -28422.783     -7609.3508      3472.1201    
      1400   304.05484     -28420.643     -8184.5263      3472.1201    
      1500   303.76267     -28423.774     -21033.359      3472.1201    
      1600   299.47405     -28435.07      -17676.293      3472.1201    
      1700   279.57771     -28437.508     -3558.1251      3472.1201    
      1800   270.76807     -28437.64      -8478.7145      3472.1201    
      1900   299.89588     -28431.349     -7148.5167      3472.1201    
      2000   304.26683     -28423.185      2442.669       3472.1201    
      2100   284.55085     -28412.044     -10273.975      3472.1201    
      2200   300.43534     -28433.395     -13054.016      3472.1201    
      2300   294.26824     -28447.475     -11287.267      3472.1201    
      2400   270.84747     -28436.885     -8245.0029      3472.1201    
      2500   312.87534     -28441.173      2018.7693      3472.1201    
      2600   311.50262     -28423.793     -16450.546      3472.1201    
      2700   293.98077     -28412.822     -15305.729      3472.1201    
      2800   306.03689     -28439.837     -21144.278      3472.1201    
      2900   288.6456      -28444.125     -3677.8494      3472.1201    
      3000   284.51749     -28451.476      1015.597       3472.1201    
      3100   317.87711     -28442.253     -11312.416      3472.1201    
      3200   299.92481     -28414.009     -12636.655      3472.1201    
      3300   321.02336     -28433.817     -13662.26       3472.1201    
      3400   284.02667     -28415.53      -20528.707      3472.1201    
      3500   303.57135     -28448.576     -12147.229      3472.1201    
      3600   273.45711     -28442.624     -18140.352      3472.1201    
      3700   264.63795     -28429.488     -12256.022      3472.1201    
      3800   296.73937     -28418.636     -16629.2        3472.1201    
      3900   298.81185     -28413.08      -8454.3762      3472.1201    
      4000   294.03231     -28411.896     -5601.6994      3472.1201    
      4100   301.76846     -28432.424     -21190.641      3472.1201    
      4200   292.82059     -28445.792     -12075.961      3472.1201    
      4300   278.79368     -28433.638     -4016.0032      3472.1201    
      4400   322.23231     -28432.262     -7373.761       3472.1201    
      4500   307.90631     -28411.665     -6251.556       3472.1201    
      4600   301.1214      -28418.946     -9674.5306      3472.1201    
      4700   286.28858     -28429.05      -16244.564      3472.1201    
      4800   289.1553      -28439.313      606.73122      3472.1201    
      4900   292.88371     -28441.075     -7030.2826      3472.1201    
      5000   274.7985      -28416.552     -5279.2581      3472.1201    
Loop time of 162.143 on 16 procs for 5000 steps with 274 atoms

Performance: 1.332 ns/day, 18.016 hours/ns, 30.837 timesteps/s, 8.449 katom-step/s
98.9% CPU use with 8 MPI tasks x 2 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 97.661     | 123.07     | 142.46     | 170.7 | 75.90
Bond    | 0.012189   | 0.013789   | 0.014923   |   0.8 |  0.01
Neigh   | 1.2035     | 1.5905     | 1.8303     |  20.3 |  0.98
Comm    | 2.9811     | 22.343     | 47.725     | 400.5 | 13.78
Output  | 0.017091   | 0.034912   | 0.075683   |  12.3 |  0.02
Modify  | 14.684     | 14.945     | 15.379     |   7.3 |  9.22
Other   |            | 0.1431     |            |       |  0.09

Nlocal:          34.25 ave          41 max          20 min
Histogram: 1 0 0 0 0 1 1 2 1 2
Nghost:        2804.75 ave        2850 max        2745 min
Histogram: 1 1 1 1 0 0 0 0 1 3
Neighs:        18939.6 ave       22591 max       11368 min
Histogram: 1 0 0 0 0 1 2 1 1 2

Total # of neighbors = 151517
Ave neighs/atom = 552.98175
Ave special neighs/atom = 0
Neighbor list builds = 80
Dangerous builds = 0
unfix deform_p
unfix data
undump dump_pos${dir}
undump dump_pos6

# Delete dir to make sure it is not reused
variable dir delete

# Calc and output
# include calc.mod.lmp

Total wall time: 0:33:58
